var De=Object.defineProperty,Le=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ve=(a,t,s)=>t in a?De(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,be=(a,t)=>{for(var s in t||(t={}))Ve.call(t,s)&&ve(a,s,t[s]);if(he)for(var s of he(t))Re.call(t,s)&&ve(a,s,t[s]);return a},ge=(a,t)=>Le(a,Ie(t));import{_ as p}from"../../../../../chunks/preload-helper-ec9aa979.js";import{S as Ae,i as Me,s as Ce,v as Q,w as Z,x as W,p as w,n as I,A as X,j as z,e as V,t as ee,l as S,c as R,a as A,g as te,d as P,b as x,M as pe,f as je,F as f,O as xe,h as ke,o as ne,L as ye,u as ze,m as ie}from"../../../../../chunks/vendor-35134e52.js";import{a as Se,L as Ue}from"../../../../../chunks/observation_data-51629536.js";import{b as qe}from"../../../../../chunks/paths-28a87002.js";import{s as Be}from"../../../../../chunks/settings-8f2b275b.js";import{d as He}from"../../../../../chunks/mapUtils-e9636914.js";import{O as Ne}from"../../../../../chunks/observation_basic-da086332.js";import{T as $e}from"../../../../../chunks/taxa_card_side-ae51ed8f.js";import{p as Ee}from"../../../../../chunks/formatUtils-b852786f.js";import{P as Fe}from"../../../../../chunks/project_header-30b6b382.js";function Ge(a){switch(a){case"../../../../../lib/data/cedar-creek-reserve/observations.csv":return p(()=>import("../../../../../chunks/observations-cd1c9750.js"),[]);case"../../../../../lib/data/ciencia-ciudadana-peru-bats/observations.csv":return p(()=>import("../../../../../chunks/observations-12342442.js"),[]);case"../../../../../lib/data/ciencia-ciudadana-peru-bees/observations.csv":return p(()=>import("../../../../../chunks/observations-500a5170.js"),[]);case"../../../../../lib/data/clarkstown-high-school-north/observations.csv":return p(()=>import("../../../../../chunks/observations-7e615f63.js"),[]);case"../../../../../lib/data/go-sea/observations.csv":return p(()=>import("../../../../../chunks/observations-6fba9f9e.js"),[]);case"../../../../../lib/data/los-angeles-bioblitz/observations.csv":return p(()=>import("../../../../../chunks/observations-85254984.js"),[]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function Je(a){switch(a){case"../../../../../lib/data/cedar-creek-reserve/users.csv":return p(()=>import("../../../../../chunks/users-a95b995e.js"),[]);case"../../../../../lib/data/ciencia-ciudadana-peru-bats/users.csv":return p(()=>import("../../../../../chunks/users-44c615ec.js"),[]);case"../../../../../lib/data/ciencia-ciudadana-peru-bees/users.csv":return p(()=>import("../../../../../chunks/users-280deaa4.js"),[]);case"../../../../../lib/data/clarkstown-high-school-north/users.csv":return p(()=>import("../../../../../chunks/users-fb306347.js"),[]);case"../../../../../lib/data/go-sea/users.csv":return p(()=>import("../../../../../chunks/users-59a261af.js"),[]);case"../../../../../lib/data/los-angeles-bioblitz/users.csv":return p(()=>import("../../../../../chunks/users-ee6c1fc1.js"),[]);default:return new Promise(function(t,s){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function Oe(a,t,s){const r=a.slice();return r[16]=t[s],r}function we(a){let t,s;return t=new Ue({}),{c(){Q(t.$$.fragment)},l(r){Z(t.$$.fragment,r)},m(r,i){W(t,r,i),s=!0},i(r){s||(w(t.$$.fragment,r),s=!0)},o(r){I(t.$$.fragment,r),s=!1},d(r){X(t,r)}}}function Pe(a){let t,s;return t=new $e({props:{taxon:a[16],taxaPath:a[14]}}),{c(){Q(t.$$.fragment)},l(r){Z(t.$$.fragment,r)},m(r,i){W(t,r,i),s=!0},p(r,i){const b={};i&256&&(b.taxon=r[16]),t.$set(b)},i(r){s||(w(t.$$.fragment,r),s=!0)},o(r){I(t.$$.fragment,r),s=!1},d(r){X(t,r)}}}function Ke(a){let t,s,r,i,b,D,g=a[0].user_login+"",M,v,h,j=Ee("observation",a[1].length)+"",y,l,k,E,F,O,G,o,L,U,Y,c,T,se,J,C,ae,K,re,ce;t=new Fe({props:{org:a[4],project:a[3],activeTab:Qe}}),E=new Ne({props:{observation:a[10],projectPath:a[2],taxon:a[16]}}),E.$on("zoomToObservation",a[12]);let m=a[6]&&we();var q=a[7];function ue(e){return{props:{mapOptions:e[13],observations:e[1],mapCenter:e[5],project:e[3],taxon:e[16],limitTaxaToSpecies:!1}}}q&&(o=new q(ue(a)),o.$on("doneLoading",a[19]),o.$on("markerClick",a[11]));let B=a[8],u=[];for(let e=0;e<B.length;e+=1)u[e]=Pe(Oe(a,B,e));const Te=e=>I(u[e],1,1,()=>{u[e]=null});return{c(){Q(t.$$.fragment),s=z(),r=V("main"),i=V("div"),b=V("h1"),D=ee("observer: "),M=ee(g),v=z(),h=V("h2"),y=ee(j),l=z(),k=V("div"),Q(E.$$.fragment),F=z(),O=V("div"),m&&m.c(),G=z(),o&&Q(o.$$.fragment),L=z(),U=V("h2"),Y=ee("Observed Species"),c=z(),T=V("div");for(let e=0;e<u.length;e+=1)u[e].c();se=z(),J=V("div"),C=V("button"),ae=ee("Load More"),this.h()},l(e){Z(t.$$.fragment,e),s=S(e),r=R(e,"MAIN",{class:!0});var n=A(r);i=R(n,"DIV",{class:!0});var d=A(i);b=R(d,"H1",{class:!0});var H=A(b);D=te(H,"observer: "),M=te(H,g),H.forEach(P),v=S(d),h=R(d,"H2",{class:!0});var N=A(h);y=te(N,j),N.forEach(P),l=S(d),k=R(d,"DIV",{class:!0});var _=A(k);Z(E.$$.fragment,_),F=S(_),O=R(_,"DIV",{class:!0});var $=A(O);m&&m.l($),G=S($),o&&Z(o.$$.fragment,$),$.forEach(P),_.forEach(P),L=S(d),U=R(d,"H2",{});var _e=A(U);Y=te(_e,"Observed Species"),_e.forEach(P),c=S(d),T=R(d,"DIV",{class:!0});var fe=A(T);for(let oe=0;oe<u.length;oe+=1)u[oe].l(fe);fe.forEach(P),se=S(d),J=R(d,"DIV",{class:!0});var de=A(J);C=R(de,"BUTTON",{class:!0});var me=A(C);ae=te(me,"Load More"),me.forEach(P),de.forEach(P),d.forEach(P),n.forEach(P),this.h()},h(){x(b,"class","svelte-1hfikjb"),x(h,"class","subtitle svelte-1hfikjb"),x(O,"class","relative"),x(k,"class","grid md:grid-cols-2 gap-3"),x(T,"class","grid md:grid-cols-2 sm:grid-cols-1 gap-2"),x(C,"class","btn"),pe(C,"hidden",!a[9]),x(J,"class","grid justify-items-center mt-8"),x(i,"class","prose max-w-none svelte-1hfikjb"),x(r,"class","container mx-auto")},m(e,n){W(t,e,n),je(e,s,n),je(e,r,n),f(r,i),f(i,b),f(b,D),f(b,M),f(i,v),f(i,h),f(h,y),f(i,l),f(i,k),W(E,k,null),f(k,F),f(k,O),m&&m.m(O,null),f(O,G),o&&W(o,O,null),f(i,L),f(i,U),f(U,Y),f(i,c),f(i,T);for(let d=0;d<u.length;d+=1)u[d].m(T,null);f(i,se),f(i,J),f(J,C),f(C,ae),K=!0,re||(ce=xe(C,"click",a[15]),re=!0)},p(e,[n]){const d={};n&16&&(d.org=e[4]),n&8&&(d.project=e[3]),t.$set(d),(!K||n&1)&&g!==(g=e[0].user_login+"")&&ke(M,g),(!K||n&2)&&j!==(j=Ee("observation",e[1].length)+"")&&ke(y,j);const H={};n&1024&&(H.observation=e[10]),n&4&&(H.projectPath=e[2]),E.$set(H),e[6]?m?n&64&&w(m,1):(m=we(),m.c(),w(m,1),m.m(O,G)):m&&(ie(),I(m,1,1,()=>{m=null}),ne());const N={};if(n&2&&(N.observations=e[1]),n&32&&(N.mapCenter=e[5]),n&8&&(N.project=e[3]),q!==(q=e[7])){if(o){ie();const _=o;I(_.$$.fragment,1,0,()=>{X(_,1)}),ne()}q?(o=new q(ue(e)),o.$on("doneLoading",e[19]),o.$on("markerClick",e[11]),Q(o.$$.fragment),w(o.$$.fragment,1),W(o,O,null)):o=null}else q&&o.$set(N);if(n&16640){B=e[8];let _;for(_=0;_<B.length;_+=1){const $=Oe(e,B,_);u[_]?(u[_].p($,n),w(u[_],1)):(u[_]=Pe($),u[_].c(),w(u[_],1),u[_].m(T,null))}for(ie(),_=B.length;_<u.length;_+=1)Te(_);ne()}n&512&&pe(C,"hidden",!e[9])},i(e){if(!K){w(t.$$.fragment,e),w(E.$$.fragment,e),w(m),o&&w(o.$$.fragment,e);for(let n=0;n<B.length;n+=1)w(u[n]);K=!0}},o(e){I(t.$$.fragment,e),I(E.$$.fragment,e),I(m),o&&I(o.$$.fragment,e),u=u.filter(Boolean);for(let n=0;n<u.length;n+=1)I(u[n]);K=!1},d(e){X(t,e),e&&P(s),e&&P(r),X(E),m&&m.d(),o&&X(o),ye(u,e),re=!1,ce()}}}async function lt({params:a}){let t=Be.filter(l=>l.username===a.orgs)[0],s=t.projects.filter(l=>l.slug===a.projects)[0],r=`${qe}/orgs/${t.username}/${s.slug}`,D=(await Je(`../../../../../lib/data/${s.slug}/users.csv`)).default.filter(l=>l.user_id==a.user_id)[0],g=await Ge(`../../../../../lib/data/${a.projects}/observations.csv`),v=Se(g.default).filter(l=>l.user_login==D.user_login),h={},j={};v.forEach(l=>{l.taxon_id==0||(h[l.taxon_id]?(h[l.taxon_id]+=1,j[l.taxon_id].taxa_count+=1):(h[l.taxon_id]=1,j[l.taxon_id]={common_name:l.common_name,image_url:l.image_url,rank:l.rank,scientific_name:l.scientific_name,taxon_id:l.taxon_id,taxa_count:1}))});let y=Object.values(j).sort((l,k)=>k.taxa_count-l.taxa_count);return{props:{project:s,projectPath:r,user:D,org:t,observations:v,taxa:y}}}let Qe="users",le=20;function We(a,t,s){let r,i,b,{user:D}=t,{observations:g}=t,{projectPath:M}=t,{project:v}=t,{taxa:h}=t,{org:j}=t,y={};function l(c){s(10,r=g.filter(T=>T.id===c.detail.observation_id)[0])}function k(c){s(5,E=c.detail),s(10,r=g.filter(T=>T.id===c.detail.observation_id)[0])}let E={},F=!0,O=ge(be({},He),{zoom:v.zoom,latitude:v.latitude,longitude:v.longitude,observationsTimeSpan:v.observations_time_span,center:[v.latitude||0,v.longitude||0],preferCanvas:!0}),G=`${M}/users/${D.user_id}/taxa`,o;ze(async()=>{const c=await p(()=>import("../../../../../chunks/taxa_map-e4f1d745.js"),["chunks/taxa_map-e4f1d745.js","assets/taxa_map-2926e294.css","chunks/vendor-35134e52.js","assets/vendor-9877410d.css","chunks/index-4cf94f11.js","assets/index-a02ee4b4.css","chunks/mapUtils-e9636914.js","chunks/dataUtils-977db69d.js","chunks/formatUtils-b852786f.js","chunks/constants-3d7024b8.js","chunks/bar_chart-06d6f597.js","assets/bar_chart-b2bb72e2.css","chunks/map_toggle_marker_type_button-8607250c.js","chunks/CircleMarker-295969fc.js"]);s(7,o=c.default)});let L=1;function U(){s(18,L=L+1),s(8,i=h.slice(0,L*le))}const Y=()=>s(6,F=!1);return a.$$set=c=>{"user"in c&&s(0,D=c.user),"observations"in c&&s(1,g=c.observations),"projectPath"in c&&s(2,M=c.projectPath),"project"in c&&s(3,v=c.project),"taxa"in c&&s(17,h=c.taxa),"org"in c&&s(4,j=c.org)},a.$$.update=()=>{a.$$.dirty&2&&s(10,r=g[0]),a.$$.dirty&393216&&s(8,i=h.slice(0,L*le)),a.$$.dirty&393216&&s(9,b=L*le<h.length)},[D,g,M,v,j,E,F,o,i,b,r,l,k,O,G,U,y,h,L,Y]}class ct extends Ae{constructor(t){super();Me(this,t,We,Ke,Ce,{user:0,observations:1,projectPath:2,project:3,taxa:17,org:4})}}export{ct as default,lt as load};
