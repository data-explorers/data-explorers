var xa=Object.defineProperty,za=Object.defineProperties;var Ua=Object.getOwnPropertyDescriptors;var ua=Object.getOwnPropertySymbols;var Fa=Object.prototype.hasOwnProperty,Ba=Object.prototype.propertyIsEnumerable;var fa=(a,e,t)=>e in a?xa(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,Gt=(a,e)=>{for(var t in e||(e={}))Fa.call(e,t)&&fa(a,t,e[t]);if(ua)for(var t of ua(e))Ba.call(e,t)&&fa(a,t,e[t]);return a},xt=(a,e)=>za(a,Ua(e));import{_ as qe}from"../../../../chunks/preload-helper-768eda0e.js";import{S as da,i as _a,s as ha,e as m,t as N,k as y,c as p,a as b,g as A,d as c,n as S,b as f,M as St,f as x,E as s,P as je,h as et,Q as ma,R as pa,T as va,U as rt,j as Re,m as Ge,o as Me,V as ba,x as M,r as Je,u as z,w as Ye,v as He,I as tt,K as Ja,W as Tt,J as at,X as Ya,Y as Ka,Z as Qa,l as wt,_ as zt,N as ga,$ as Wa,a0 as Xa,A as Za,a1 as $a,a2 as el,a3 as tl}from"../../../../chunks/vendor-83798d90.js";import{b as Dt}from"../../../../chunks/paths-28a87002.js";import{g as al,f as ll,a as sl,b as ka,O as ol,L as Ea,c as nl,m as il,d as rl,s as Ot,e as Pt,l as cl}from"../../../../chunks/observation_data-a20951da.js";import{s as ul}from"../../../../chunks/settings-ef690396.js";import{C as fl,t as Ut,M as dl,b as _l,I as Ia,a as hl}from"../../../../chunks/map_species_list-74daa7d5.js";import{p as ya,f as Lt}from"../../../../chunks/formatUtils-77b182ad.js";import{d as ml,a as Ft,g as pl,b as vl}from"../../../../chunks/mapUtils-8c5a7127.js";import"../../../../chunks/constants-3d7024b8.js";function Sa(a,e,t){const l=a.slice();return l[19]=e[t],l}function bl(a){let e,t;return{c(){e=m("img"),this.h()},l(l){e=p(l,"IMG",{src:!0,alt:!0}),this.h()},h(){at(e.src,t=""+(Dt+"/images/missing-image.png"))||f(e,"src",t),f(e,"alt","")},m(l,o){x(l,e,o)},p:tt,d(l){l&&c(e)}}}function gl(a){let e,t,l;return{c(){e=m("img"),this.h()},l(o){e=p(o,"IMG",{src:!0,alt:!0}),this.h()},h(){at(e.src,t=a[0].image_url.replace("medium","square"))||f(e,"src",t),f(e,"alt",l="photo of "+a[0].taxon_name)},m(o,r){x(o,e,r)},p(o,r){r&1&&!at(e.src,t=o[0].image_url.replace("medium","square"))&&f(e,"src",t),r&1&&l!==(l="photo of "+o[0].taxon_name)&&f(e,"alt",l)},d(o){o&&c(e)}}}function kl(a){let e;return{c(){e=N("More")},l(t){e=A(t,"More")},m(t,l){x(t,e,l)},d(t){t&&c(e)}}}function El(a){let e;return{c(){e=N("Less")},l(t){e=A(t,"Less")},m(t,l){x(t,e,l)},d(t){t&&c(e)}}}function Il(a){let e;return{c(){e=N("Show")},l(t){e=A(t,"Show")},m(t,l){x(t,e,l)},d(t){t&&c(e)}}}function yl(a){let e;return{c(){e=N("Hide")},l(t){e=A(t,"Hide")},m(t,l){x(t,e,l)},d(t){t&&c(e)}}}function Ta(a){let e,t,l,o,r,n,u,i,_,v,E,O=a[0].rank+"",B,I,T,re,de,Z,J,X,V,w,P,R,ce,ee,he,te,Y,me,ae=a[10]&&Sl(a);return{c(){e=m("div"),t=m("dl"),l=m("dt"),o=N("link"),r=m("dd"),n=m("a"),u=N("Species page"),_=m("dt"),v=N("taxonomic rank"),E=m("dd"),B=N(O),I=y(),T=m("span"),re=N("Map layers"),de=y(),Z=m("label"),J=m("input"),X=N("all iNaturalist observations"),V=y(),w=m("label"),P=m("input"),R=N("Taxon range"),ce=y(),ae&&ae.c(),this.h()},l(G){e=p(G,"DIV",{class:!0});var L=b(e);t=p(L,"DL",{class:!0});var H=b(t);l=p(H,"DT",{class:!0});var pe=b(l);o=A(pe,"link"),pe.forEach(c),r=p(H,"DD",{});var Ie=b(r);n=p(Ie,"A",{href:!0});var De=b(n);u=A(De,"Species page"),De.forEach(c),Ie.forEach(c),_=p(H,"DT",{class:!0});var $=b(_);v=A($,"taxonomic rank"),$.forEach(c),E=p(H,"DD",{});var Pe=b(E);B=A(Pe,O),Pe.forEach(c),H.forEach(c),I=S(L),T=p(L,"SPAN",{class:!0});var Le=b(T);re=A(Le,"Map layers"),Le.forEach(c),de=S(L),Z=p(L,"LABEL",{class:!0});var D=b(Z);J=p(D,"INPUT",{type:!0,class:!0}),X=A(D,"all iNaturalist observations"),D.forEach(c),V=S(L),w=p(L,"LABEL",{class:!0});var le=b(w);P=p(le,"INPUT",{type:!0,class:!0}),R=A(le,"Taxon range"),le.forEach(c),ce=S(L),ae&&ae.l(L),L.forEach(c),this.h()},h(){f(l,"class","svelte-pi0iqi"),f(n,"href",i=""+(a[3]+"/taxa/"+a[0].taxon_id)),f(_,"class","svelte-pi0iqi"),f(t,"class","svelte-pi0iqi"),f(T,"class","font-medium inline-block"),f(J,"type","checkbox"),f(J,"class","mr-1"),f(Z,"class","cursor-pointer block"),f(P,"type","checkbox"),f(P,"class","mr-1"),f(w,"class","cursor-pointer block"),f(e,"class","py-1 px-2 card-more-content svelte-pi0iqi"),St(e,"active",a[0].active)},m(G,L){x(G,e,L),s(e,t),s(t,l),s(l,o),s(t,r),s(r,n),s(n,u),s(t,_),s(_,v),s(t,E),s(E,B),s(e,I),s(e,T),s(T,re),s(e,de),s(e,Z),s(Z,J),J.checked=a[8],s(Z,X),s(e,V),s(e,w),s(w,P),P.checked=a[7],s(w,R),s(e,ce),ae&&ae.m(e,null),te=!0,Y||(me=[je(J,"change",a[14]),je(J,"click",a[15]),je(P,"change",a[16]),je(P,"click",a[17])],Y=!0)},p(G,L){(!te||L&9&&i!==(i=""+(G[3]+"/taxa/"+G[0].taxon_id)))&&f(n,"href",i),(!te||L&1)&&O!==(O=G[0].rank+"")&&et(B,O),L&256&&(J.checked=G[8]),L&128&&(P.checked=G[7]),G[10]&&ae.p(G,L),L&1&&St(e,"active",G[0].active)},i(G){te||(ma(()=>{he&&he.end(1),ee=pa(e,Tt,{}),ee.start()}),te=!0)},o(G){ee&&ee.invalidate(),he=va(e,Tt,{}),te=!1},d(G){G&&c(e),ae&&ae.d(),G&&he&&he.end(),Y=!1,rt(me)}}}function Sl(a){let e,t=a[9].length+"",l,o,r,n,u=a[9],i=[];for(let _=0;_<u.length;_+=1)i[_]=wa(Sa(a,u,_));return{c(){e=m("span"),l=N(t),o=N(" observed species"),r=y(),n=m("ul");for(let _=0;_<i.length;_+=1)i[_].c();this.h()},l(_){e=p(_,"SPAN",{class:!0});var v=b(e);l=A(v,t),o=A(v," observed species"),v.forEach(c),r=S(_),n=p(_,"UL",{class:!0});var E=b(n);for(let O=0;O<i.length;O+=1)i[O].l(E);E.forEach(c),this.h()},h(){f(e,"class","font-medium mt-2 inline-block"),f(n,"class","observed-species svelte-pi0iqi")},m(_,v){x(_,e,v),s(e,l),s(e,o),x(_,r,v),x(_,n,v);for(let E=0;E<i.length;E+=1)i[E].m(n,null)},p(_,v){if(v&512){u=_[9];let E;for(E=0;E<u.length;E+=1){const O=Sa(_,u,E);i[E]?i[E].p(O,v):(i[E]=wa(O),i[E].c(),i[E].m(n,null))}for(;E<i.length;E+=1)i[E].d(1);i.length=u.length}},d(_){_&&c(e),_&&c(r),_&&c(n),Ja(i,_)}}}function wa(a){let e,t=Lt(a[19],!0)+"";return{c(){e=m("li"),this.h()},l(l){e=p(l,"LI",{class:!0});var o=b(e);o.forEach(c),this.h()},h(){f(e,"class","svelte-pi0iqi")},m(l,o){x(l,e,o),e.innerHTML=t},p:tt,d(l){l&&c(e)}}}function Tl(a){let e,t,l,o,r,n,u,i,_,v=a[0].taxon_name+"",E,O,B,I,T=ya("observation",a[0].taxa_count)+"",re,de,Z,J,X,V,w,P,R,ce,ee,he,te,Y,me,ae,G,L,H,pe;function Ie(F,q){return F[0].image_url?gl:bl}let De=Ie(a),$=De(a);u=new fl({props:{value:a[0].taxon_id,color:a[0].color}});function Pe(F,q){return F[6]?El:kl}let Le=Pe(a),D=Le(a);function le(F,q){return F[0].active?yl:Il}let ye=le(a),_e=ye(a),U=a[6]&&Ta(a);return{c(){e=m("div"),t=m("div"),l=m("figure"),$.c(),o=y(),r=m("div"),n=m("div"),Re(u.$$.fragment),i=y(),_=m("span"),E=N(v),O=m("br"),B=y(),I=m("span"),re=N(T),de=m("br"),V=y(),w=m("ul"),P=m("li"),D.c(),R=N(" info"),ce=y(),ee=m("li"),_e.c(),te=y(),Y=m("li"),me=N("Delete"),G=y(),U&&U.c(),this.h()},l(F){e=p(F,"DIV",{class:!0});var q=b(e);t=p(q,"DIV",{class:!0});var Se=b(t);l=p(Se,"FIGURE",{});var Ke=b(l);$.l(Ke),Ke.forEach(c),o=S(Se),r=p(Se,"DIV",{class:!0});var Ve=b(r);n=p(Ve,"DIV",{class:!0,"data-taxon-id":!0});var se=b(n);Ge(u.$$.fragment,se),i=S(se),_=p(se,"SPAN",{});var Qe=b(_);E=A(Qe,v),Qe.forEach(c),O=p(se,"BR",{}),B=S(se),I=p(se,"SPAN",{});var We=b(I);re=A(We,T),We.forEach(c),de=p(se,"BR",{}),se.forEach(c),Ve.forEach(c),Se.forEach(c),V=S(q),w=p(q,"UL",{class:!0});var Te=b(w);P=p(Te,"LI",{class:!0});var xe=b(P);D.l(xe),R=A(xe," info"),xe.forEach(c),ce=S(Te),ee=p(Te,"LI",{"data-taxon-id":!0,class:!0});var Xe=b(ee);_e.l(Xe),Xe.forEach(c),te=S(Te),Y=p(Te,"LI",{"data-taxon-id":!0,class:!0});var d=b(Y);me=A(d,"Delete"),d.forEach(c),Te.forEach(c),G=S(q),U&&U.l(q),q.forEach(c),this.h()},h(){f(n,"class","leading-normal"),f(n,"data-taxon-id",Z=a[0].taxon_id),f(r,"class","image-card-side-body svelte-pi0iqi"),f(t,"class","image-card-side svelte-pi0iqi"),St(t,"active",a[0].active),f(P,"class","svelte-pi0iqi"),f(ee,"data-taxon-id",he=a[0].taxon_id),f(ee,"class","svelte-pi0iqi"),f(Y,"data-taxon-id",ae=a[0].taxon_id),f(Y,"class","svelte-pi0iqi"),f(w,"class","text-sm submenu bg-gray-100 grid grid-cols-3 svelte-pi0iqi"),f(e,"class","border relative filter")},m(F,q){x(F,e,q),s(e,t),s(t,l),$.m(l,null),s(t,o),s(t,r),s(r,n),Me(u,n,null),s(n,i),s(n,_),s(_,E),s(n,O),s(n,B),s(n,I),s(I,re),s(n,de),s(e,V),s(e,w),s(w,P),D.m(P,null),s(P,R),s(w,ce),s(w,ee),_e.m(ee,null),s(w,te),s(w,Y),s(Y,me),s(e,G),U&&U.m(e,null),L=!0,H||(pe=[je(P,"click",a[13]),je(ee,"click",function(){ba(a[1])&&a[1].apply(this,arguments)}),je(Y,"click",function(){ba(a[2])&&a[2].apply(this,arguments)})],H=!0)},p(F,[q]){a=F,De===(De=Ie(a))&&$?$.p(a,q):($.d(1),$=De(a),$&&($.c(),$.m(l,null)));const Se={};q&1&&(Se.value=a[0].taxon_id),q&1&&(Se.color=a[0].color),u.$set(Se),(!L||q&1)&&v!==(v=a[0].taxon_name+"")&&et(E,v),(!L||q&1)&&T!==(T=ya("observation",a[0].taxa_count)+"")&&et(re,T),(!L||q&1&&Z!==(Z=a[0].taxon_id))&&f(n,"data-taxon-id",Z),q&1&&St(t,"active",a[0].active),Le!==(Le=Pe(a))&&(D.d(1),D=Le(a),D&&(D.c(),D.m(P,R))),ye!==(ye=le(a))&&(_e.d(1),_e=ye(a),_e&&(_e.c(),_e.m(ee,null))),(!L||q&1&&he!==(he=a[0].taxon_id))&&f(ee,"data-taxon-id",he),(!L||q&1&&ae!==(ae=a[0].taxon_id))&&f(Y,"data-taxon-id",ae),a[6]?U?(U.p(a,q),q&64&&M(U,1)):(U=Ta(a),U.c(),M(U,1),U.m(e,null)):U&&(Je(),z(U,1,1,()=>{U=null}),Ye())},i(F){L||(M(u.$$.fragment,F),ma(()=>{X&&X.end(1),J=pa(t,Tt,{}),J.start()}),M(U),L=!0)},o(F){z(u.$$.fragment,F),J&&J.invalidate(),X=va(t,Tt,{}),z(U),L=!1},d(F){F&&c(e),$.d(),He(u),F&&X&&X.end(),D.d(),_e.d(),U&&U.d(),H=!1,rt(pe)}}}function wl(a,e,t){let{taxon:l}=e,{taxa:o}=e,{toggleTaxon:r}=e,{removeTaxon:n}=e,{projectPath:u}=e,{toggleInatGrid:i}=e,{toggleInatTaxonRange:_}=e,{taxaHistory:v}=e,E=!1,O=al(o,l),B=v.map(w=>w.taxon_id).indexOf(l.taxon_id),I=v[B].showInatTaxonRange,T=v[B].showInatGrid,re=O.length>1||O.length==1&&O[0].taxon_id==!l.taxon_id;const de=()=>t(6,E=!E);function Z(){T=this.checked,t(8,T)}const J=()=>i(l.taxon_id);function X(){I=this.checked,t(7,I)}const V=()=>_(l.taxon_id);return a.$$set=w=>{"taxon"in w&&t(0,l=w.taxon),"taxa"in w&&t(11,o=w.taxa),"toggleTaxon"in w&&t(1,r=w.toggleTaxon),"removeTaxon"in w&&t(2,n=w.removeTaxon),"projectPath"in w&&t(3,u=w.projectPath),"toggleInatGrid"in w&&t(4,i=w.toggleInatGrid),"toggleInatTaxonRange"in w&&t(5,_=w.toggleInatTaxonRange),"taxaHistory"in w&&t(12,v=w.taxaHistory)},[l,r,n,u,i,_,E,I,T,O,re,o,v,de,Z,J,X,V]}class Dl extends da{constructor(e){super();_a(this,e,wl,Tl,ha,{taxon:0,taxa:11,toggleTaxon:1,removeTaxon:2,projectPath:3,toggleInatGrid:4,toggleInatTaxonRange:5,taxaHistory:12})}}const Ol="https://vega.github.io/schema/vega-lite/v5.json",Pl="A faceted bar chart with labels, custom color and custon opacity.",Ll={values:[]},Vl={field:"group",type:"nominal",title:null,header:{orient:"bottom"},sort:null},jl={width:{step:25},height:200,encoding:{y:{field:"yValue",type:"quantitative",title:"observations"},x:{field:"xValue",type:"nominal",title:null,sort:null,axis:{labelAngle:0,labelOverlap:!0}},opacity:{field:"opacity",type:"quantitative",scale:null}},layer:[{mark:{type:"bar"},encoding:{color:{field:"color",type:"nominal"}}},{mark:{type:"text",dx:0,angle:0,baseline:"bottom",align:"center",color:"#6b7280"},encoding:{text:{field:"yValue",type:"quantitative"}}}]},Cl={facet:{columns:2},axis:{titleFontSize:14,labelFontSize:12,labelColor:"#333"},legend:{titleFontSize:14,labelFontSize:14,labelLimit:0,orient:"bottom",columns:1,labelColor:"#333"},header:{titleFontSize:14,labelFontSize:14,labelColor:"#333"},mark:{fontSize:12,color:"#333"},title:{fontSize:14,color:"#333"}},Nl={axis:{x:"independent",y:"independent"}};var Al={$schema:Ol,description:Pl,data:Ll,facet:Vl,spec:jl,config:Cl,resolve:Nl};function Rl(a){switch(a){case"../../../../lib/data/cedar-creek-reserve/observations.csv":return qe(()=>import("../../../../chunks/observations-300b979a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/observations.csv":return qe(()=>import("../../../../chunks/observations-637c398b.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/observations.csv":return qe(()=>import("../../../../chunks/observations-aedf9342.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/observations.csv":return qe(()=>import("../../../../chunks/observations-c3886d39.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/observations.csv":return qe(()=>import("../../../../chunks/observations-627adcb7.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}function Ml(a){switch(a){case"../../../../lib/data/cedar-creek-reserve/taxa.csv":return qe(()=>import("../../../../chunks/taxa-f4c5fea7.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/taxa.csv":return qe(()=>import("../../../../chunks/taxa-9108f66a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/taxa.csv":return qe(()=>import("../../../../chunks/taxa-104f431f.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/taxa.csv":return qe(()=>import("../../../../chunks/taxa-029efbae.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/taxa.csv":return qe(()=>import("../../../../chunks/taxa-99749418.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+a)))})}}const{Map:Hl}=$a;function Da(a,e,t){const l=a.slice();return l[54]=e[t],l}function Oa(a){let e,t,l,o;function r(i,_){return i[15].image_url?Gl:ql}let n=r(a),u=n(a);return l=new ol({props:{observation:a[15],projectPath:a[4],compactLayout:!0}}),l.$on("zoomToObservation",a[36]),{c(){e=m("section"),u.c(),t=y(),Re(l.$$.fragment),this.h()},l(i){e=p(i,"SECTION",{class:!0});var _=b(e);u.l(_),t=S(_),Ge(l.$$.fragment,_),_.forEach(c),this.h()},h(){f(e,"class","px-3 mb-6 lg:mb-0 observation-container overflow-x-auto order-last lg:order-first svelte-hniytl")},m(i,_){x(i,e,_),u.m(e,null),s(e,t),Me(l,e,null),o=!0},p(i,_){n===(n=r(i))&&u?u.p(i,_):(u.d(1),u=n(i),u&&(u.c(),u.m(e,t)));const v={};_[0]&32768&&(v.observation=i[15]),_[0]&16&&(v.projectPath=i[4]),l.$set(v)},i(i){o||(M(l.$$.fragment,i),o=!0)},o(i){z(l.$$.fragment,i),o=!1},d(i){i&&c(e),u.d(),He(l)}}}function ql(a){let e,t;return{c(){e=m("img"),this.h()},l(l){e=p(l,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){f(e,"class","float-right lg:float-none svelte-hniytl"),at(e.src,t=""+(Dt+"/images/missing-image.png"))||f(e,"src",t),f(e,"alt","")},m(l,o){x(l,e,o)},p:tt,d(l){l&&c(e)}}}function Gl(a){let e,t,l;return{c(){e=m("img"),this.h()},l(o){e=p(o,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){f(e,"class","float-right lg:float-none svelte-hniytl"),at(e.src,t=a[15].image_url.replace("medium","small"))||f(e,"src",t),f(e,"alt",l="photo of "+Lt(a[15]))},m(o,r){x(o,e,r)},p(o,r){r[0]&32768&&!at(e.src,t=o[15].image_url.replace("medium","small"))&&f(e,"src",t),r[0]&32768&&l!==(l="photo of "+Lt(o[15]))&&f(e,"alt",l)},d(o){o&&c(e)}}}function Pa(a){let e,t,l,o,r,n,u;return{c(){e=m("label"),t=m("input"),l=y(),o=m("span"),r=N("Show 5 most observed species"),this.h()},l(i){e=p(i,"LABEL",{class:!0});var _=b(e);t=p(_,"INPUT",{type:!0,class:!0}),l=S(_),o=p(_,"SPAN",{});var v=b(o);r=A(v,"Show 5 most observed species"),v.forEach(c),_.forEach(c),this.h()},h(){f(t,"type","checkbox"),f(t,"class","mr-2"),f(e,"class","cursor-pointer block")},m(i,_){x(i,e,_),s(e,t),s(e,l),s(e,o),s(o,r),n||(u=je(t,"click",a[45]),n=!0)},p:tt,d(i){i&&c(e),n=!1,u()}}}function La(a){let e,t,l,o,r,n,u;return{c(){e=m("label"),t=m("input"),l=y(),o=m("span"),r=N("Show indicator species"),this.h()},l(i){e=p(i,"LABEL",{class:!0});var _=b(e);t=p(_,"INPUT",{type:!0,class:!0}),l=S(_),o=p(_,"SPAN",{});var v=b(o);r=A(v,"Show indicator species"),v.forEach(c),_.forEach(c),this.h()},h(){f(t,"type","checkbox"),f(t,"class","mr-2"),f(e,"class","cursor-pointer block")},m(i,_){x(i,e,_),s(e,t),s(e,l),s(e,o),s(o,r),n||(u=je(t,"click",a[46]),n=!0)},p:tt,d(i){i&&c(e),n=!1,u()}}}function Va(a,e){let t,l,o;return l=new Dl({props:{taxa:e[3],taxon:e[54],toggleTaxon:e[33],removeTaxon:e[32],toggleInatGrid:e[30],toggleInatTaxonRange:e[31],projectPath:e[4],taxaHistory:e[5]}}),{key:a,first:null,c(){t=wt(),Re(l.$$.fragment),this.h()},l(r){t=wt(),Ge(l.$$.fragment,r),this.h()},h(){this.first=t},m(r,n){x(r,t,n),Me(l,r,n),o=!0},p(r,n){e=r;const u={};n[0]&8&&(u.taxa=e[3]),n[0]&32&&(u.taxon=e[54]),n[0]&16&&(u.projectPath=e[4]),n[0]&32&&(u.taxaHistory=e[5]),l.$set(u)},i(r){o||(M(l.$$.fragment,r),o=!0)},o(r){z(l.$$.fragment,r),o=!1},d(r){r&&c(t),He(l,r)}}}function ja(a){let e,t,l,o,r,n;return{c(){e=m("span"),t=N("*"),this.h()},l(u){e=p(u,"SPAN",{class:!0,title:!0});var i=b(e);t=A(i,"*"),i.forEach(c),this.h()},h(){f(e,"class","text-red-600"),f(e,"title",l="Since there are over "+Jt+" observations on the map, the map uses clustered markers.")},m(u,i){x(u,e,i),s(e,t),r||(n=zt(o=Ut.call(null,e)),r=!0)},p:tt,d(u){u&&c(e),r=!1,n()}}}function Ca(a){let e,t,l,o;const r=[zl,xl],n=[];function u(i,_){return i[21]?0:1}return e=u(a),t=n[e]=r[e](a),{c(){t.c(),l=wt()},l(i){t.l(i),l=wt()},m(i,_){n[e].m(i,_),x(i,l,_),o=!0},p(i,_){let v=e;e=u(i),e===v?n[e].p(i,_):(Je(),z(n[v],1,1,()=>{n[v]=null}),Ye(),t=n[e],t?t.p(i,_):(t=n[e]=r[e](i),t.c()),M(t,1),t.m(l.parentNode,l))},i(i){o||(M(t),o=!0)},o(i){z(t),o=!1},d(i){n[e].d(i),i&&c(l)}}}function xl(a){let e,t,l,o,r;return t=new Ia({}),{c(){e=m("span"),Re(t.$$.fragment),this.h()},l(n){e=p(n,"SPAN",{title:!0});var u=b(e);Ge(t.$$.fragment,u),u.forEach(c),this.h()},h(){f(e,"title","click show to species list")},m(n,u){x(n,e,u),Me(t,e,null),l=!0,o||(r=[zt(Ut.call(null,e)),je(e,"click",a[39])],o=!0)},p:tt,i(n){l||(M(t.$$.fragment,n),l=!0)},o(n){z(t.$$.fragment,n),l=!1},d(n){n&&c(e),He(t),o=!1,rt(r)}}}function zl(a){let e,t,l,o,r;return t=new Ia({}),{c(){e=m("span"),Re(t.$$.fragment),this.h()},l(n){e=p(n,"SPAN",{title:!0});var u=b(e);Ge(t.$$.fragment,u),u.forEach(c),this.h()},h(){f(e,"title","click hide to species list")},m(n,u){x(n,e,u),Me(t,e,null),l=!0,o||(r=[zt(Ut.call(null,e)),je(e,"click",a[39])],o=!0)},p:tt,i(n){l||(M(t.$$.fragment,n),l=!0)},o(n){z(t.$$.fragment,n),l=!1},d(n){n&&c(e),He(t),o=!1,rt(r)}}}function Na(a){let e,t;return e=new Ea({}),{c(){Re(e.$$.fragment)},l(l){Ge(e.$$.fragment,l)},m(l,o){Me(e,l,o),t=!0},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){He(e,l)}}}function Aa(a){let e,t,l,o;return e=new Ea({}),{c(){Re(e.$$.fragment),t=y(),l=m("div"),this.h()},l(r){Ge(e.$$.fragment,r),t=S(r),l=p(r,"DIV",{class:!0,style:!0}),b(l).forEach(c),this.h()},h(){f(l,"class","bg-gray-100"),ga(l,"width","100%"),ga(l,"height","85vh")},m(r,n){Me(e,r,n),x(r,t,n),x(r,l,n),o=!0},i(r){o||(M(e.$$.fragment,r),o=!0)},o(r){z(e.$$.fragment,r),o=!1},d(r){He(e,r),r&&c(t),r&&c(l)}}}function Ra(a){let e,t,l;return t=new hl({props:{mapOptions:a[25],selectTimeSpanHandler:a[35],groupedObservations:a[8],toggleTimeSpans:a[34],timeSpanHistory:a[6],activeTaxaCount:a[5].filter(qa).length}}),{c(){e=m("section"),Re(t.$$.fragment),this.h()},l(o){e=p(o,"SECTION",{class:!0});var r=b(e);Ge(t.$$.fragment,r),r.forEach(c),this.h()},h(){f(e,"class","pl-2")},m(o,r){x(o,e,r),Me(t,e,null),l=!0},p(o,r){const n={};r[0]&256&&(n.groupedObservations=o[8]),r[0]&64&&(n.timeSpanHistory=o[6]),r[0]&32&&(n.activeTaxaCount=o[5].filter(qa).length),t.$set(n)},i(o){l||(M(t.$$.fragment,o),l=!0)},o(o){z(t.$$.fragment,o),l=!1},d(o){o&&c(e),He(t)}}}function Ma(a){let e;return{c(){e=m("div"),this.h()},l(t){e=p(t,"DIV",{id:!0,class:!0}),b(e).forEach(c),this.h()},h(){f(e,"id","ed-chart"),f(e,"class","w-full mt-4")},m(t,l){x(t,e,l)},d(t){t&&c(e)}}}function Ha(a){let e,t,l,o,r,n;return{c(){e=m("h3"),t=N("Temperature and Preciptation"),l=y(),o=m("img"),this.h()},l(u){e=p(u,"H3",{class:!0});var i=b(e);t=A(i,"Temperature and Preciptation"),i.forEach(c),l=S(u),o=p(u,"IMG",{src:!0,alt:!0}),this.h()},h(){f(e,"class","text-center svelte-hniytl"),at(o.src,r=""+(Dt+"/images/"+a[1].username+"/"+a[0].slug+"/climate-chart.png"))||f(o,"src",r),f(o,"alt",n="climate chart for "+a[0].location)},m(u,i){x(u,e,i),s(e,t),x(u,l,i),x(u,o,i)},p(u,i){i[0]&3&&!at(o.src,r=""+(Dt+"/images/"+u[1].username+"/"+u[0].slug+"/climate-chart.png"))&&f(o,"src",r),i[0]&1&&n!==(n="climate chart for "+u[0].location)&&f(o,"alt",n)},d(u){u&&c(e),u&&c(l),u&&c(o)}}}function Ul(a){let e,t,l=a[2].label+"",o,r,n,u,i,_,v,E,O,B,I,T,re,de,Z,J,X,V=[],w=new Hl,P,R,ce,ee,he,te,Y,me,ae,G,L,H,pe,Ie,De,$,Pe,Le,D,le,ye,_e,U,F,q,Se,Ke,Ve,se,Qe,We,Te,xe,Xe,d,g,j,C,K,Q,Oe,Ce,st,jt,Ct,Ue,ct,Nt,At,ut,ft,W,dt,ot,Ze,Rt,_t,ht,Fe,Mt,Yt,oe=a[15]&&Oa(a);function Ga(h){a[44](h)}let Kt={searchFunction:a[27],onChange:a[26],labelFieldName:"label",valueFieldName:"taxon_id",placeholder:"Search species name"};a[7]!==void 0&&(Kt.selectedItem=a[7]),T=new Ya({props:Kt}),Ka.push(()=>Qa(T,"selectedItem",Ga));let ve=a[9]&&Pa(a),be=a[10]&&La(a),it=a[5];const Qt=h=>h[54].taxon_id;for(let h=0;h<it.length;h+=1){let k=Da(a,it,h),Ne=Qt(k);w.set(Ne,V[h]=Va(Ne,k))}let ge=a[17]>=Jt&&ja(),ne=a[22]&&Ca(a),ue=a[14]&&a[13]&&Na(),fe=!a[14]&&Aa();var lt=a[24];function Wt(h){return{props:{mapOptions:h[25],groupedObservations:h[8],timeSpanHistory:h[6],showDemoMapLayer:h[12],taxaHistory:h[5],mapCenter:h[23],country:h[0].country}}}lt&&(W=new lt(Wt(a)),W.$on("markerClick",a[38]),W.$on("updateStats",a[37])),Ze=new dl({props:{showSpeciesList:a[21],speciesList:a[20]}});let ie=a[5].length>0&&Ra(a),we=a[5].length>0&&Ma(),ke=a[11]&&Ha(a);return{c(){e=m("div"),t=m("h1"),o=N(l),r=y(),n=m("div"),u=m("div"),i=m("div"),oe&&oe.c(),_=y(),v=m("section"),E=m("h3"),O=N("Biodiversity"),B=y(),I=m("div"),Re(T.$$.fragment),de=y(),ve&&ve.c(),Z=y(),be&&be.c(),J=y(),X=m("div");for(let h=0;h<V.length;h+=1)V[h].c();P=y(),R=m("section"),ce=m("h3"),ee=N("Environmental Factors"),he=y(),te=m("div"),Y=m("label"),me=m("input"),ae=y(),G=m("span"),L=N("Temperature and Preciptation"),H=y(),pe=m("label"),Ie=m("input"),De=y(),$=m("span"),Pe=N("Demo map layer"),Le=y(),D=m("div"),le=m("div"),ye=m("div"),_e=m("div"),U=N("Observations"),F=y(),q=m("div"),Se=N(a[16]),Ke=y(),Ve=m("div"),se=m("div"),Qe=N(`Observations on map
            `),ge&&ge.c(),We=y(),Te=m("div"),xe=N(a[17]),Xe=y(),d=m("div"),g=m("div"),j=N("Species"),C=y(),K=m("div"),Q=N(a[18]),Oe=y(),Ce=m("div"),st=m("div"),jt=N("Species on map"),Ct=y(),Ue=m("div"),ct=N(a[19]),Nt=y(),ne&&ne.c(),At=y(),ue&&ue.c(),ut=y(),fe&&fe.c(),ft=y(),W&&Re(W.$$.fragment),dt=y(),ot=m("section"),Re(Ze.$$.fragment),Rt=y(),ie&&ie.c(),_t=y(),we&&we.c(),ht=y(),ke&&ke.c(),this.h()},l(h){e=p(h,"DIV",{class:!0});var k=b(e);t=p(k,"H1",{class:!0});var Ne=b(t);o=A(Ne,l),Ne.forEach(c),r=S(k),n=p(k,"DIV",{class:!0});var Ae=b(n);u=p(Ae,"DIV",{class:!0});var nt=b(u);i=p(nt,"DIV",{class:!0});var Be=b(i);oe&&oe.l(Be),_=S(Be),v=p(Be,"SECTION",{class:!0});var ze=b(v);E=p(ze,"H3",{class:!0});var Xt=b(E);O=A(Xt,"Biodiversity"),Xt.forEach(c),B=S(ze),I=p(ze,"DIV",{class:!0});var Zt=b(I);Ge(T.$$.fragment,Zt),Zt.forEach(c),de=S(ze),ve&&ve.l(ze),Z=S(ze),be&&be.l(ze),J=S(ze),X=p(ze,"DIV",{class:!0});var $t=b(X);for(let qt=0;qt<V.length;qt+=1)V[qt].l($t);$t.forEach(c),ze.forEach(c),P=S(Be),R=p(Be,"SECTION",{class:!0});var mt=b(R);ce=p(mt,"H3",{class:!0});var ea=b(ce);ee=A(ea,"Environmental Factors"),ea.forEach(c),he=S(mt),te=p(mt,"DIV",{class:!0});var pt=b(te);Y=p(pt,"LABEL",{class:!0});var vt=b(Y);me=p(vt,"INPUT",{type:!0}),ae=S(vt),G=p(vt,"SPAN",{});var ta=b(G);L=A(ta,"Temperature and Preciptation"),ta.forEach(c),vt.forEach(c),H=S(pt),pe=p(pt,"LABEL",{class:!0});var bt=b(pe);Ie=p(bt,"INPUT",{type:!0}),De=S(bt),$=p(bt,"SPAN",{});var aa=b($);Pe=A(aa,"Demo map layer"),aa.forEach(c),bt.forEach(c),pt.forEach(c),mt.forEach(c),Be.forEach(c),nt.forEach(c),Le=S(Ae),D=p(Ae,"DIV",{class:!0});var Ee=b(D);le=p(Ee,"DIV",{class:!0});var $e=b(le);ye=p($e,"DIV",{class:!0});var gt=b(ye);_e=p(gt,"DIV",{class:!0});var la=b(_e);U=A(la,"Observations"),la.forEach(c),F=S(gt),q=p(gt,"DIV",{class:!0});var sa=b(q);Se=A(sa,a[16]),sa.forEach(c),gt.forEach(c),Ke=S($e),Ve=p($e,"DIV",{class:!0});var kt=b(Ve);se=p(kt,"DIV",{class:!0});var Ht=b(se);Qe=A(Ht,`Observations on map
            `),ge&&ge.l(Ht),Ht.forEach(c),We=S(kt),Te=p(kt,"DIV",{class:!0});var oa=b(Te);xe=A(oa,a[17]),oa.forEach(c),kt.forEach(c),Xe=S($e),d=p($e,"DIV",{class:!0});var Et=b(d);g=p(Et,"DIV",{class:!0});var na=b(g);j=A(na,"Species"),na.forEach(c),C=S(Et),K=p(Et,"DIV",{class:!0});var ia=b(K);Q=A(ia,a[18]),ia.forEach(c),Et.forEach(c),Oe=S($e),Ce=p($e,"DIV",{class:!0});var It=b(Ce);st=p(It,"DIV",{class:!0});var ra=b(st);jt=A(ra,"Species on map"),ra.forEach(c),Ct=S(It),Ue=p(It,"DIV",{class:!0});var yt=b(Ue);ct=A(yt,a[19]),Nt=S(yt),ne&&ne.l(yt),yt.forEach(c),It.forEach(c),$e.forEach(c),At=S(Ee),ue&&ue.l(Ee),ut=S(Ee),fe&&fe.l(Ee),ft=S(Ee),W&&Ge(W.$$.fragment,Ee),dt=S(Ee),ot=p(Ee,"SECTION",{class:!0});var ca=b(ot);Ge(Ze.$$.fragment,ca),ca.forEach(c),Rt=S(Ee),ie&&ie.l(Ee),_t=S(Ee),we&&we.l(Ee),ht=S(Ee),ke&&ke.l(Ee),Ee.forEach(c),Ae.forEach(c),k.forEach(c),this.h()},h(){f(t,"class","px-2"),f(E,"class","svelte-hniytl"),f(I,"class","max-w-lg mb-6 autocomplete svelte-hniytl"),f(X,"class","grid lg:grid-cols-1 md:grid-cols-2 sm:grid-cols-1 gap-2 mb-2"),f(v,"class","px-3"),f(ce,"class","svelte-hniytl"),f(me,"type","checkbox"),f(Y,"class","cursor-pointer block"),f(Ie,"type","checkbox"),f(pe,"class","cursor-pointer block"),f(te,"class","mb-4"),f(R,"class","px-3"),f(i,"class","grid"),f(u,"class","lg:col-span-3 border-0 lg:border-r-2 border-t"),f(_e,"class","stat-title svelte-hniytl"),f(q,"class","stat-value svelte-hniytl"),f(ye,"class","stat place-items-center place-content-center svelte-hniytl"),f(se,"class","stat-title svelte-hniytl"),f(Te,"class","stat-value svelte-hniytl"),f(Ve,"class","stat place-items-center place-content-center svelte-hniytl"),f(g,"class","stat-title svelte-hniytl"),f(K,"class","stat-value svelte-hniytl"),f(d,"class","stat place-items-center place-content-center svelte-hniytl"),f(st,"class","stat-title svelte-hniytl"),f(Ue,"class","stat-value svelte-hniytl"),f(Ce,"class","stat place-items-center place-content-center svelte-hniytl"),f(le,"class","w-full rounded-none border stats"),f(ot,"class","pl-2"),f(D,"class","lg:col-span-7"),f(n,"class","grid lg:grid-cols-10 mb-6"),f(e,"class","prose max-w-none")},m(h,k){x(h,e,k),s(e,t),s(t,o),s(e,r),s(e,n),s(n,u),s(u,i),oe&&oe.m(i,null),s(i,_),s(i,v),s(v,E),s(E,O),s(v,B),s(v,I),Me(T,I,null),s(v,de),ve&&ve.m(v,null),s(v,Z),be&&be.m(v,null),s(v,J),s(v,X);for(let Ne=0;Ne<V.length;Ne+=1)V[Ne].m(X,null);s(i,P),s(i,R),s(R,ce),s(ce,ee),s(R,he),s(R,te),s(te,Y),s(Y,me),me.checked=a[11],s(Y,ae),s(Y,G),s(G,L),s(te,H),s(te,pe),s(pe,Ie),Ie.checked=a[12],s(pe,De),s(pe,$),s($,Pe),s(n,Le),s(n,D),s(D,le),s(le,ye),s(ye,_e),s(_e,U),s(ye,F),s(ye,q),s(q,Se),s(le,Ke),s(le,Ve),s(Ve,se),s(se,Qe),ge&&ge.m(se,null),s(Ve,We),s(Ve,Te),s(Te,xe),s(le,Xe),s(le,d),s(d,g),s(g,j),s(d,C),s(d,K),s(K,Q),s(le,Oe),s(le,Ce),s(Ce,st),s(st,jt),s(Ce,Ct),s(Ce,Ue),s(Ue,ct),s(Ue,Nt),ne&&ne.m(Ue,null),s(D,At),ue&&ue.m(D,null),s(D,ut),fe&&fe.m(D,null),s(D,ft),W&&Me(W,D,null),s(D,dt),s(D,ot),Me(Ze,ot,null),s(D,Rt),ie&&ie.m(D,null),s(D,_t),we&&we.m(D,null),s(D,ht),ke&&ke.m(D,null),Fe=!0,Mt||(Yt=[je(me,"change",a[47]),je(Ie,"change",a[48])],Mt=!0)},p(h,k){(!Fe||k[0]&4)&&l!==(l=h[2].label+"")&&et(o,l),h[15]?oe?(oe.p(h,k),k[0]&32768&&M(oe,1)):(oe=Oa(h),oe.c(),M(oe,1),oe.m(i,_)):oe&&(Je(),z(oe,1,1,()=>{oe=null}),Ye());const Ne={};!re&&k[0]&128&&(re=!0,Ne.selectedItem=h[7],Wa(()=>re=!1)),T.$set(Ne),h[9]?ve?ve.p(h,k):(ve=Pa(h),ve.c(),ve.m(v,Z)):ve&&(ve.d(1),ve=null),h[10]?be?be.p(h,k):(be=La(h),be.c(),be.m(v,J)):be&&(be.d(1),be=null),k[0]&1073741880|k[1]&7&&(it=h[5],Je(),V=Xa(V,k,Qt,1,h,it,w,X,el,Va,null,Da),Ye()),k[0]&2048&&(me.checked=h[11]),k[0]&4096&&(Ie.checked=h[12]),(!Fe||k[0]&65536)&&et(Se,h[16]),h[17]>=Jt?ge?ge.p(h,k):(ge=ja(),ge.c(),ge.m(se,null)):ge&&(ge.d(1),ge=null),(!Fe||k[0]&131072)&&et(xe,h[17]),(!Fe||k[0]&262144)&&et(Q,h[18]),(!Fe||k[0]&524288)&&et(ct,h[19]),h[22]?ne?(ne.p(h,k),k[0]&4194304&&M(ne,1)):(ne=Ca(h),ne.c(),M(ne,1),ne.m(Ue,null)):ne&&(Je(),z(ne,1,1,()=>{ne=null}),Ye()),h[14]&&h[13]?ue?k[0]&24576&&M(ue,1):(ue=Na(),ue.c(),M(ue,1),ue.m(D,ut)):ue&&(Je(),z(ue,1,1,()=>{ue=null}),Ye()),h[14]?fe&&(Je(),z(fe,1,1,()=>{fe=null}),Ye()):fe?k[0]&16384&&M(fe,1):(fe=Aa(),fe.c(),M(fe,1),fe.m(D,ft));const Ae={};if(k[0]&256&&(Ae.groupedObservations=h[8]),k[0]&64&&(Ae.timeSpanHistory=h[6]),k[0]&4096&&(Ae.showDemoMapLayer=h[12]),k[0]&32&&(Ae.taxaHistory=h[5]),k[0]&8388608&&(Ae.mapCenter=h[23]),k[0]&1&&(Ae.country=h[0].country),lt!==(lt=h[24])){if(W){Je();const Be=W;z(Be.$$.fragment,1,0,()=>{He(Be,1)}),Ye()}lt?(W=new lt(Wt(h)),W.$on("markerClick",h[38]),W.$on("updateStats",h[37]),Re(W.$$.fragment),M(W.$$.fragment,1),Me(W,D,dt)):W=null}else lt&&W.$set(Ae);const nt={};k[0]&2097152&&(nt.showSpeciesList=h[21]),k[0]&1048576&&(nt.speciesList=h[20]),Ze.$set(nt),h[5].length>0?ie?(ie.p(h,k),k[0]&32&&M(ie,1)):(ie=Ra(h),ie.c(),M(ie,1),ie.m(D,_t)):ie&&(Je(),z(ie,1,1,()=>{ie=null}),Ye()),h[5].length>0?we||(we=Ma(),we.c(),we.m(D,ht)):we&&(we.d(1),we=null),h[11]?ke?ke.p(h,k):(ke=Ha(h),ke.c(),ke.m(D,null)):ke&&(ke.d(1),ke=null)},i(h){if(!Fe){M(oe),M(T.$$.fragment,h);for(let k=0;k<it.length;k+=1)M(V[k]);M(ne),M(ue),M(fe),W&&M(W.$$.fragment,h),M(Ze.$$.fragment,h),M(ie),Fe=!0}},o(h){z(oe),z(T.$$.fragment,h);for(let k=0;k<V.length;k+=1)z(V[k]);z(ne),z(ue),z(fe),W&&z(W.$$.fragment,h),z(Ze.$$.fragment,h),z(ie),Fe=!1},d(h){h&&c(e),oe&&oe.d(),He(T),ve&&ve.d(),be&&be.d();for(let k=0;k<V.length;k+=1)V[k].d();ge&&ge.d(),ne&&ne.d(),ue&&ue.d(),fe&&fe.d(),W&&He(W),He(Ze),ie&&ie.d(),we&&we.d(),ke&&ke.d(),Mt=!1,rt(Yt)}}}async function ts({page:a}){let e=ul.filter(v=>v.username===a.params.users)[0],t=e.projects.filter(v=>v.slug===a.params.projects)[0],l=a.path.split("/"),o=t.tabs_project.filter(v=>v.link===l[l.length-1])[0],r=`/users/${e.username}/${t.slug}`,n=await Ml(`../../../../lib/data/${a.params.projects}/taxa.csv`),u=ll(n.default),i=await Rl(`../../../../lib/data/${a.params.projects}/observations.csv`),_=sl(i.default);return{props:{project:t,user:e,currentTab:o,allObservations:_,taxa:u,projectPath:r}}}let Vt="oldest",Bt=.25,Jt=1e3;const qa=a=>a.active;function Fl(a,e,t){let{project:l}=e,{user:o}=e,{currentTab:r}=e,{allObservations:n}=e,{taxa:u}=e,{projectPath:i}=e,_="",v=[],E=new Set,O=[],B=[],I=[],T={},re=l.slug!=="los-angeles-bioblitz",de=l.slug==="los-angeles-bioblitz",Z=!1,J=!1,X=0,V=!0,w=!1,P=JSON.parse(JSON.stringify(_l)),R=JSON.parse(JSON.stringify(Al)),ce,ee=0,he=0,te=0,Y=0,me=[],ae=!1,G=!1,L={};n=n.filter(d=>d.latitude&&d.longitude);let H=xt(Gt({},ml),{zoom:l.zoom,latitude:l.latitude,longitude:l.longitude,observationsTimeSpan:"all",colorSchemeMonth:Array(12).fill(Ft),colorSchemeYear:[Ft],defaultColor:Ft,monthSeasonalMarkers:!1,center:[l.latitude||0,l.longitude||0],preferCanvas:!0});function pe(d){!d||!d.label||(t(9,re=!1),t(10,de=!1),!(I.filter(g=>g.taxon_id==d.taxon_id).length>0)&&(X+=1,t(13,V=!0),setTimeout(()=>{Pe(d)},100)))}async function Ie(d){if(d.length>2)return await nl(u,d)}function De(){t(9,re=!1),u.filter(d=>d.rank==="species").sort((d,g)=>g.taxa_count-d.taxa_count).slice(0,5).forEach(d=>{X+=1,Pe(d)})}function $(){t(10,de=!1),u.filter(d=>d.taxon_group&&d.observations_count>0).sort((d,g)=>g.taxa_count-d.taxa_count).forEach(d=>{X+=1,Pe(d)})}function Pe(d){let g=il(X,H.colorScheme.length),j=rl(n,d.taxon_id,H.colorScheme[g]);j.forEach(Oe=>{E.has(Oe.id)||(E.add(Oe.id),v.push(Oe))}),O=Ot(v,Vt,H.observationsTimeSpan),t(8,B=Pt(O,H.observationsTimeSpan)),t(15,ce=O[0]);let C=vl(d.taxon_id),K=H.colorScheme[g],Q=cl(K,10);t(5,I=I.concat({taxon_name:Lt(d),image_url:d.image_url,taxa_count:d.taxa_count,taxon_id:d.taxon_id,color:K,rank:d.rank,active:!0,observations:j.map(Oe=>Oe.id),showInatGrid:!1,InatGridUrl:`${C.InatGrid.url}&color=%23${Q}`,showInatTaxonRange:!1,InatTaxonRangeUrl:`${C.InatTaxonRange.url}?color=%23${Q}`})),H.observationsTimeSpan!=="all"&&B.forEach((Oe,Ce)=>t(6,T[Ce]=T[Ce]!==void 0?T[Ce]:!0,T)),t(13,V=!1)}function Le(d){let g=I.map(j=>j.taxon_id).indexOf(d);t(5,I[g].showInatGrid=!I[g].showInatGrid,I)}function D(d){let g=I.map(j=>j.taxon_id).indexOf(d);t(5,I[g].showInatTaxonRange=!I[g].showInatTaxonRange,I)}function le(d){t(13,V=!0);let g=Number(d.target.dataset.taxonId);E=new Set,t(5,I=I.filter(j=>(j.taxon_id!==g&&j.active&&j.observations.forEach(C=>{let K=v.filter(Q=>Q.id===C)[0];K.color=j.color,K.fillColor=j.color,E.add(C)}),j.taxon_id!==g))),t(41,v=v.filter(j=>E.has(j.id))),O=Ot(v,Vt,H.observationsTimeSpan),t(8,B=Pt(v,H.observationsTimeSpan)),H.observationsTimeSpan!=="all"&&B.forEach((j,C)=>(t(6,T),t(5,I),t(0,l))),t(13,V=!1)}function ye(d){let g=Number(d.target.dataset.taxonId);if(!g)return;let j=!0;if(t(13,V=!0),t(5,I=I.map(C=>C.taxon_id===g?(j=!C.active,xt(Gt({},C),{active:!C.active})):C)),j){let C=I.filter(K=>K.taxon_id===g)[0];C.observations.forEach(K=>{let Q=v.filter(Oe=>Oe.id===K)[0];Q.color=C.color,Q.fillColor=C.color,E.add(K)})}else E=new Set,I.forEach(C=>{C.taxon_id!==g&&C.active&&C.observations.forEach(K=>{let Q=v.filter(Oe=>Oe.id===K)[0];Q.color=C.color,Q.fillColor=C.color,E.add(K)})});O=v.filter(C=>E.has(C.id)),O=Ot(O,Vt,H.observationsTimeSpan),t(8,B=Pt(O,H.observationsTimeSpan)),H.observationsTimeSpan!=="all"&&B.forEach((C,K)=>(t(6,T),t(5,I),t(0,l))),t(13,V=!1)}function _e(d){let g=d.target.dataset.filter;g=g==="unknown"?"unknown":Number(g),t(6,T[g]=!T[g],T)}function U(){t(13,V=!0),O=Ot(O,Vt,H.observationsTimeSpan),t(8,B=Pt(O,H.observationsTimeSpan)),t(6,T={}),H.observationsTimeSpan!=="all"&&B.forEach((d,g)=>t(6,T[g]=!0,T)),t(13,V=!1)}function F(d){tl("#ed-chart",d,{actions:!1}).then(g=>{}).catch(console.warn)}function q(d){t(23,L=d.detail)}function Se(d){t(17,he=d.detail.observationsDisplayCount),t(16,ee=d.detail.observationsSelectedCount),t(18,te=d.detail.speciesCount),t(19,Y=d.detail.speciesDisplayCount),t(20,me=d.detail.speciesList),t(22,G=d.detail.showSpeciesListIcon)}function Ke(d){t(15,ce=v.filter(g=>g.id===d.detail.observation_id)[0])}function Ve(){t(21,ae=!ae)}let se;Za(async()=>{const d=await qe(()=>import("../../../../chunks/explore_data_map-785db7e0.js"),["chunks/explore_data_map-785db7e0.js","chunks/vendor-83798d90.js","assets/vendor-626d706b.css","chunks/index-cea82726.js","assets/index-655e5209.css","chunks/mapUtils-8c5a7127.js","chunks/observation_data-a20951da.js","assets/observation_data-913912fc.css","chunks/formatUtils-77b182ad.js","chunks/constants-3d7024b8.js","chunks/map_toggle_marker_type_button-5897e2c1.js","chunks/TileLayer-978a34f9.js","chunks/CircleMarker-fe18eefd.js"]);t(24,se=d.default),t(13,V=!1),t(14,w=!0)});function Qe(d){_=d,t(7,_)}const We=()=>De(),Te=()=>$();function xe(){Z=this.checked,t(11,Z)}function Xe(){J=this.checked,t(12,J)}return a.$$set=d=>{"project"in d&&t(0,l=d.project),"user"in d&&t(1,o=d.user),"currentTab"in d&&t(2,r=d.currentTab),"allObservations"in d&&t(40,n=d.allObservations),"taxa"in d&&t(3,u=d.taxa),"projectPath"in d&&t(4,i=d.projectPath)},a.$$.update=()=>{if(a.$$.dirty[0]&33&&I.length===0&&(t(9,re=l.slug!=="los-angeles-bioblitz"),t(10,de=l.slug==="los-angeles-bioblitz"),t(6,T={}),t(15,ce=null)),a.$$.dirty[0]&97|a.$$.dirty[1]&7168&&I.length!==0)if(H.observationsTimeSpan=="all"){let d=I.map(g=>({xValue:g.taxon_name,yValue:g.taxa_count,group:"",color:g.taxon_name,label:g.taxa_count,opacity:g.active?1:Bt}));t(42,P.data.values=d,P),t(42,P.height=200,P),t(42,P.encoding.x.axis=null,P),t(42,P.encoding.color.scale={domain:I.map(g=>g.taxon_name),range:I.map(g=>g.color)},P),t(42,P.encoding.color.title=null,P),F(P)}else if(H.observationsTimeSpan=="month"){let d=[],g=ka("month",v,I,T,Bt,l);for(let j in g){let C=g[j];for(let K in C){let Q=C[K];d.push({xValue:j==="unknown"?j:pl(j),yValue:Q.count,group:Q.taxon_name,color:Q.color,opacity:Q.opacity})}}t(43,R.data.values=d,R),t(43,R.facet.sort=I.map(j=>j.taxon_name),R),t(43,R.spec.layer[0].encoding.color.scale=null,R),F(R)}else{let d=[],g=ka("year",v,I,T,Bt,l);for(let j in g){let C=g[j];for(let K in C){let Q=C[K];d.push({xValue:j,yValue:Q.count,group:Q.taxon_name,color:Q.color,opacity:Q.opacity})}}t(43,R.data.values=d,R),t(43,R.facet.sort=I.map(j=>j.taxon_name),R),t(43,R.spec.layer[0].encoding.color.scale=null,R),F(R)}},[l,o,r,u,i,I,T,_,B,re,de,Z,J,V,w,ce,ee,he,te,Y,me,ae,G,L,se,H,pe,Ie,De,$,Le,D,le,ye,_e,U,q,Se,Ke,Ve,n,v,P,R,Qe,We,Te,xe,Xe]}class as extends da{constructor(e){super();_a(this,e,Fl,Ul,ha,{project:0,user:1,currentTab:2,allObservations:40,taxa:3,projectPath:4},null,[-1,-1])}}export{as as default,ts as load};
