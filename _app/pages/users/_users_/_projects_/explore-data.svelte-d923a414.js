var dl=Object.defineProperty,_l=Object.defineProperties;var ml=Object.getOwnPropertyDescriptors;var Mt=Object.getOwnPropertySymbols;var pl=Object.prototype.hasOwnProperty,bl=Object.prototype.propertyIsEnumerable;var Nt=(l,e,t)=>e in l?dl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,Et=(l,e)=>{for(var t in e||(e={}))pl.call(e,t)&&Nt(l,t,e[t]);if(Mt)for(var t of Mt(e))bl.call(e,t)&&Nt(l,t,e[t]);return l},It=(l,e)=>_l(l,ml(e));import{_ as He}from"../../../../chunks/preload-helper-768eda0e.js";import{S as mt,i as pt,s as bt,e as b,t as H,j,c as v,a as k,g as G,d as i,l as A,b as h,M as W,f as C,F as n,N as ue,h as We,O as Ze,P as Ct,Q as Vt,R as Je,v as Oe,w as Ae,x as De,T as Rt,p as N,m as Ve,n as U,o as Re,A as ye,J as Me,L as vl,U as Ee,K as xe,k as $e,V as gl,W as pe,X as tt,Y as kl,Z as qe,_ as wl,u as El,$ as Il,a0 as Sl,a1 as Tl,a2 as Ol,a3 as Dl}from"../../../../chunks/vendor-f02122e8.js";import{b as nt}from"../../../../chunks/paths-28a87002.js";import{g as yl,f as Pl,a as Ll,L as jl,O as Al,b as Ml,m as Nl,c as Cl,d as qt,l as Vl,s as zt,u as Rl}from"../../../../chunks/observation_data-e7b6f804.js";import{s as ql}from"../../../../chunks/settings-ef690396.js";import{d as zl,a as St,g as Hl}from"../../../../chunks/mapUtils-e9636914.js";import{p as Ht,f as vt}from"../../../../chunks/formatUtils-77b182ad.js";import{C as Gl,t as lt,M as Ul,b as Bl,s as Gt,a as Ut,c as Bt,d as Ft,I as Jt,e as Fl}from"../../../../chunks/bar_chart-a789b56f.js";import"../../../../chunks/constants-3d7024b8.js";function Yt(l,e,t){const a=l.slice();return a[19]=e[t],a}function Jl(l){let e,t;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{src:!0,alt:!0}),this.h()},h(){xe(e.src,t=""+(nt+"/images/missing-image.png"))||h(e,"src",t),h(e,"alt","")},m(a,s){C(a,e,s)},p:Me,d(a){a&&i(e)}}}function Yl(l){let e,t,a;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{src:!0,alt:!0}),this.h()},h(){xe(e.src,t=l[0].image_url.replace("medium","square"))||h(e,"src",t),h(e,"alt",a="photo of "+l[0].taxon_name)},m(s,o){C(s,e,o)},p(s,o){o&1&&!xe(e.src,t=s[0].image_url.replace("medium","square"))&&h(e,"src",t),o&1&&a!==(a="photo of "+s[0].taxon_name)&&h(e,"alt",a)},d(s){s&&i(e)}}}function Xl(l){let e;return{c(){e=H("More")},l(t){e=G(t,"More")},m(t,a){C(t,e,a)},d(t){t&&i(e)}}}function Kl(l){let e;return{c(){e=H("Less")},l(t){e=G(t,"Less")},m(t,a){C(t,e,a)},d(t){t&&i(e)}}}function Ql(l){let e;return{c(){e=H("Show")},l(t){e=G(t,"Show")},m(t,a){C(t,e,a)},d(t){t&&i(e)}}}function Wl(l){let e;return{c(){e=H("Hide")},l(t){e=G(t,"Hide")},m(t,a){C(t,e,a)},d(t){t&&i(e)}}}function Xt(l){let e,t,a,s,o,r,f,c,p,_,d,S=l[0].rank+"",L,P,w,D,y,O,T,V,F,m,E,Q,ee,K,be,te,$,Pe,oe=l[10]&&Zl(l);return{c(){e=b("div"),t=b("dl"),a=b("dt"),s=H("link"),o=b("dd"),r=b("a"),f=H("Species page"),p=b("dt"),_=H("taxonomic rank"),d=b("dd"),L=H(S),P=j(),w=b("span"),D=H("Map layers"),y=j(),O=b("label"),T=b("input"),V=H("all iNaturalist observations"),F=j(),m=b("label"),E=b("input"),Q=H("Taxon range"),ee=j(),oe&&oe.c(),this.h()},l(B){e=v(B,"DIV",{class:!0});var R=k(e);t=v(R,"DL",{class:!0});var ge=k(t);a=v(ge,"DT",{class:!0});var fe=k(a);s=G(fe,"link"),fe.forEach(i),o=v(ge,"DD",{});var ke=k(o);r=v(ke,"A",{href:!0});var Ie=k(r);f=G(Ie,"Species page"),Ie.forEach(i),ke.forEach(i),p=v(ge,"DT",{class:!0});var re=k(p);_=G(re,"taxonomic rank"),re.forEach(i),d=v(ge,"DD",{});var Z=k(d);L=G(Z,S),Z.forEach(i),ge.forEach(i),P=A(R),w=v(R,"SPAN",{class:!0});var Se=k(w);D=G(Se,"Map layers"),Se.forEach(i),y=A(R),O=v(R,"LABEL",{class:!0});var he=k(O);T=v(he,"INPUT",{type:!0,class:!0}),V=G(he,"all iNaturalist observations"),he.forEach(i),F=A(R),m=v(R,"LABEL",{class:!0});var de=k(m);E=v(de,"INPUT",{type:!0,class:!0}),Q=G(de,"Taxon range"),de.forEach(i),ee=A(R),oe&&oe.l(R),R.forEach(i),this.h()},h(){h(a,"class","svelte-akmlch"),h(r,"href",c=""+(l[3]+"/taxa/"+l[0].taxon_id)),h(p,"class","svelte-akmlch"),h(t,"class","svelte-akmlch"),h(w,"class","font-medium inline-block"),h(T,"type","checkbox"),h(T,"class","mr-1"),h(O,"class","cursor-pointer block"),h(E,"type","checkbox"),h(E,"class","mr-1"),h(m,"class","cursor-pointer block"),h(e,"class","py-1 px-2 card-more-content svelte-akmlch"),W(e,"active",l[0].active)},m(B,R){C(B,e,R),n(e,t),n(t,a),n(a,s),n(t,o),n(o,r),n(r,f),n(t,p),n(p,_),n(t,d),n(d,L),n(e,P),n(e,w),n(w,D),n(e,y),n(e,O),n(O,T),T.checked=l[8],n(O,V),n(e,F),n(e,m),n(m,E),E.checked=l[7],n(m,Q),n(e,ee),oe&&oe.m(e,null),te=!0,$||(Pe=[ue(T,"change",l[14]),ue(T,"click",l[15]),ue(E,"change",l[16]),ue(E,"click",l[17])],$=!0)},p(B,R){(!te||R&9&&c!==(c=""+(B[3]+"/taxa/"+B[0].taxon_id)))&&h(r,"href",c),(!te||R&1)&&S!==(S=B[0].rank+"")&&We(L,S),R&256&&(T.checked=B[8]),R&128&&(E.checked=B[7]),B[10]&&oe.p(B,R),R&1&&W(e,"active",B[0].active)},i(B){te||(Ze(()=>{be&&be.end(1),K=Ct(e,Ee,{}),K.start()}),te=!0)},o(B){K&&K.invalidate(),be=Vt(e,Ee,{}),te=!1},d(B){B&&i(e),oe&&oe.d(),B&&be&&be.end(),$=!1,Je(Pe)}}}function Zl(l){let e,t=l[9].length+"",a,s,o,r,f=l[9],c=[];for(let p=0;p<f.length;p+=1)c[p]=Kt(Yt(l,f,p));return{c(){e=b("span"),a=H(t),s=H(" observed species"),o=j(),r=b("ul");for(let p=0;p<c.length;p+=1)c[p].c();this.h()},l(p){e=v(p,"SPAN",{class:!0});var _=k(e);a=G(_,t),s=G(_," observed species"),_.forEach(i),o=A(p),r=v(p,"UL",{class:!0});var d=k(r);for(let S=0;S<c.length;S+=1)c[S].l(d);d.forEach(i),this.h()},h(){h(e,"class","font-medium mt-2 inline-block"),h(r,"class","observed-species svelte-akmlch")},m(p,_){C(p,e,_),n(e,a),n(e,s),C(p,o,_),C(p,r,_);for(let d=0;d<c.length;d+=1)c[d].m(r,null)},p(p,_){if(_&512){f=p[9];let d;for(d=0;d<f.length;d+=1){const S=Yt(p,f,d);c[d]?c[d].p(S,_):(c[d]=Kt(S),c[d].c(),c[d].m(r,null))}for(;d<c.length;d+=1)c[d].d(1);c.length=f.length}},d(p){p&&i(e),p&&i(o),p&&i(r),vl(c,p)}}}function Kt(l){let e,t=vt(l[19],!0)+"";return{c(){e=b("li"),this.h()},l(a){e=v(a,"LI",{class:!0});var s=k(e);s.forEach(i),this.h()},h(){h(e,"class","svelte-akmlch")},m(a,s){C(a,e,s),e.innerHTML=t},p:Me,d(a){a&&i(e)}}}function xl(l){let e,t,a,s,o,r,f,c,p,_=l[0].taxon_name+"",d,S,L,P,w=Ht("observation",l[0].taxa_count)+"",D,y,O,T,V,F,m,E,Q,ee,K,be,te,$,Pe,oe,B,R,ge,fe;function ke(J,Y){return J[0].image_url?Yl:Jl}let Ie=ke(l),re=Ie(l);f=new Gl({props:{value:l[0].taxon_id,color:l[0].color}});function Z(J,Y){return J[6]?Kl:Xl}let Se=Z(l),he=Se(l);function de(J,Y){return J[0].active?Wl:Ql}let Te=de(l),ve=Te(l),x=l[6]&&Xt(l);return{c(){e=b("div"),t=b("div"),a=b("figure"),re.c(),s=j(),o=b("div"),r=b("div"),Oe(f.$$.fragment),c=j(),p=b("span"),d=H(_),S=b("br"),L=j(),P=b("span"),D=H(w),y=b("br"),F=j(),m=b("ul"),E=b("li"),he.c(),Q=H(" info"),ee=j(),K=b("li"),ve.c(),te=j(),$=b("li"),Pe=H("Delete"),B=j(),x&&x.c(),this.h()},l(J){e=v(J,"DIV",{class:!0});var Y=k(e);t=v(Y,"DIV",{class:!0});var we=k(t);a=v(we,"FIGURE",{});var Ge=k(a);re.l(Ge),Ge.forEach(i),s=A(we),o=v(we,"DIV",{class:!0});var Le=k(o);r=v(Le,"DIV",{class:!0,"data-taxon-id":!0});var ne=k(r);Ae(f.$$.fragment,ne),c=A(ne),p=v(ne,"SPAN",{});var X=k(p);d=G(X,_),X.forEach(i),S=v(ne,"BR",{}),L=A(ne),P=v(ne,"SPAN",{});var Be=k(P);D=G(Be,w),Be.forEach(i),y=v(ne,"BR",{}),ne.forEach(i),Le.forEach(i),we.forEach(i),F=A(Y),m=v(Y,"UL",{class:!0});var Ne=k(m);E=v(Ne,"LI",{class:!0});var ie=k(E);he.l(ie),Q=G(ie," info"),ie.forEach(i),ee=A(Ne),K=v(Ne,"LI",{"data-taxon-id":!0,class:!0});var Ue=k(K);ve.l(Ue),Ue.forEach(i),te=A(Ne),$=v(Ne,"LI",{"data-taxon-id":!0,class:!0});var je=k($);Pe=G(je,"Delete"),je.forEach(i),Ne.forEach(i),B=A(Y),x&&x.l(Y),Y.forEach(i),this.h()},h(){h(r,"class","leading-normal"),h(r,"data-taxon-id",O=l[0].taxon_id),h(o,"class","image-card-side-body svelte-akmlch"),h(t,"class","image-card-side svelte-akmlch"),W(t,"active",l[0].active),h(E,"class","svelte-akmlch"),h(K,"data-taxon-id",be=l[0].taxon_id),h(K,"class","svelte-akmlch"),h($,"data-taxon-id",oe=l[0].taxon_id),h($,"class","svelte-akmlch"),h(m,"class","text-sm submenu bg-gray-100 grid grid-cols-3 svelte-akmlch"),h(e,"class","border relative filter")},m(J,Y){C(J,e,Y),n(e,t),n(t,a),re.m(a,null),n(t,s),n(t,o),n(o,r),De(f,r,null),n(r,c),n(r,p),n(p,d),n(r,S),n(r,L),n(r,P),n(P,D),n(r,y),n(e,F),n(e,m),n(m,E),he.m(E,null),n(E,Q),n(m,ee),n(m,K),ve.m(K,null),n(m,te),n(m,$),n($,Pe),n(e,B),x&&x.m(e,null),R=!0,ge||(fe=[ue(E,"click",l[13]),ue(K,"click",function(){Rt(l[1])&&l[1].apply(this,arguments)}),ue($,"click",function(){Rt(l[2])&&l[2].apply(this,arguments)})],ge=!0)},p(J,[Y]){l=J,Ie===(Ie=ke(l))&&re?re.p(l,Y):(re.d(1),re=Ie(l),re&&(re.c(),re.m(a,null)));const we={};Y&1&&(we.value=l[0].taxon_id),Y&1&&(we.color=l[0].color),f.$set(we),(!R||Y&1)&&_!==(_=l[0].taxon_name+"")&&We(d,_),(!R||Y&1)&&w!==(w=Ht("observation",l[0].taxa_count)+"")&&We(D,w),(!R||Y&1&&O!==(O=l[0].taxon_id))&&h(r,"data-taxon-id",O),Y&1&&W(t,"active",l[0].active),Se!==(Se=Z(l))&&(he.d(1),he=Se(l),he&&(he.c(),he.m(E,Q))),Te!==(Te=de(l))&&(ve.d(1),ve=Te(l),ve&&(ve.c(),ve.m(K,null))),(!R||Y&1&&be!==(be=l[0].taxon_id))&&h(K,"data-taxon-id",be),(!R||Y&1&&oe!==(oe=l[0].taxon_id))&&h($,"data-taxon-id",oe),l[6]?x?(x.p(l,Y),Y&64&&N(x,1)):(x=Xt(l),x.c(),N(x,1),x.m(e,null)):x&&(Ve(),U(x,1,1,()=>{x=null}),Re())},i(J){R||(N(f.$$.fragment,J),Ze(()=>{V&&V.end(1),T=Ct(t,Ee,{}),T.start()}),N(x),R=!0)},o(J){U(f.$$.fragment,J),T&&T.invalidate(),V=Vt(t,Ee,{}),U(x),R=!1},d(J){J&&i(e),re.d(),ye(f),J&&V&&V.end(),he.d(),ve.d(),x&&x.d(),ge=!1,Je(fe)}}}function $l(l,e,t){let{taxon:a}=e,{taxa:s}=e,{toggleTaxon:o}=e,{removeTaxon:r}=e,{projectPath:f}=e,{toggleInatGrid:c}=e,{toggleInatTaxonRange:p}=e,{taxaHistory:_}=e,d=!1,S=yl(s,a),L=_.map(m=>m.taxon_id).indexOf(a.taxon_id),P=_[L].showInatTaxonRange,w=_[L].showInatGrid,D=S.length>1||S.length==1&&S[0].taxon_id==!a.taxon_id;const y=()=>t(6,d=!d);function O(){w=this.checked,t(8,w)}const T=()=>c(a.taxon_id);function V(){P=this.checked,t(7,P)}const F=()=>p(a.taxon_id);return l.$$set=m=>{"taxon"in m&&t(0,a=m.taxon),"taxa"in m&&t(11,s=m.taxa),"toggleTaxon"in m&&t(1,o=m.toggleTaxon),"removeTaxon"in m&&t(2,r=m.removeTaxon),"projectPath"in m&&t(3,f=m.projectPath),"toggleInatGrid"in m&&t(4,c=m.toggleInatGrid),"toggleInatTaxonRange"in m&&t(5,p=m.toggleInatTaxonRange),"taxaHistory"in m&&t(12,_=m.taxaHistory)},[a,o,r,f,c,p,d,P,w,S,D,s,_,y,O,T,V,F]}class ea extends mt{constructor(e){super();pt(this,e,$l,xl,bt,{taxon:0,taxa:11,toggleTaxon:1,removeTaxon:2,projectPath:3,toggleInatGrid:4,toggleInatTaxonRange:5,taxaHistory:12})}}function ta(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(i),this.h()},h(){h(e,"class","arrow right-arrow svelte-114h8ez"),pe(e,"top",l[2]),pe(e,"right",l[3]),h(e,"title","click to show more info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&i(e),t=!1,Je(a)}}}function la(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(i),this.h()},h(){h(e,"class","arrow left-arrow svelte-114h8ez"),pe(e,"top",l[2]),pe(e,"right",l[3]),h(e,"title","click to show less info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&i(e),t=!1,Je(a)}}}function aa(l){let e;function t(o,r){return o[0]?oa:sa}let a=t(l),s=a(l);return{c(){s.c(),e=$e()},l(o){s.l(o),e=$e()},m(o,r){s.m(o,r),C(o,e,r)},p(o,r){a===(a=t(o))&&s?s.p(o,r):(s.d(1),s=a(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&i(e)}}}function sa(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(i),this.h()},h(){h(e,"class","arrow up-arrow svelte-114h8ez"),pe(e,"top",l[2]),pe(e,"right",l[3]),h(e,"title","click to show more info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&i(e),t=!1,Je(a)}}}function oa(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(i),this.h()},h(){h(e,"class","arrow down-arrow svelte-114h8ez"),pe(e,"top",l[2]),pe(e,"right",l[3]),h(e,"title","click to show less info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&i(e),t=!1,Je(a)}}}function ra(l){let e;function t(o,r){return o[1]==="upDown"?aa:o[0]?la:ta}let a=t(l),s=a(l);return{c(){s.c(),e=$e()},l(o){s.l(o),e=$e()},m(o,r){s.m(o,r),C(o,e,r)},p(o,[r]){a===(a=t(o))&&s?s.p(o,r):(s.d(1),s=a(o),s&&(s.c(),s.m(e.parentNode,e)))},i:Me,o:Me,d(o){s.d(o),o&&i(e)}}}function na(l,e,t){let{showMore:a=!1}=e,{format:s="upDown"}=e,{top:o=0}=e,{right:r=0}=e,{border:f}=e,{position:c="absolute"}=e;const p=gl();function _(){t(0,a=!a),p("toggleShowMore",{showMore:a})}return l.$$set=d=>{"showMore"in d&&t(0,a=d.showMore),"format"in d&&t(1,s=d.format),"top"in d&&t(2,o=d.top),"right"in d&&t(3,r=d.right),"border"in d&&t(4,f=d.border),"position"in d&&t(5,c=d.position)},[a,s,o,r,f,c,_]}class Qt extends mt{constructor(e){super();pt(this,e,na,ra,bt,{showMore:0,format:1,top:2,right:3,border:4,position:5})}}function ia(l){let e,t;return{c(){e=b("span"),t=H("\xD7"),this.h()},l(a){e=v(a,"SPAN",{"data-taxon-id":!0,class:!0});var s=k(e);t=G(s,"\xD7"),s.forEach(i),this.h()},h(){h(e,"data-taxon-id",l[0]),h(e,"class","svelte-tbkz2d")},m(a,s){C(a,e,s),n(e,t)},p(a,[s]){s&1&&h(e,"data-taxon-id",a[0])},i:Me,o:Me,d(a){a&&i(e)}}}function ca(l,e,t){let{value:a=null}=e;return l.$$set=s=>{"value"in s&&t(0,a=s.value)},[a]}class fa extends mt{constructor(e){super();pt(this,e,ca,ia,bt,{value:0})}}const ua="https://vega.github.io/schema/vega-lite/v5.json",ha="A faceted bar chart with labels, custom color and custon opacity.",da={values:[]},_a={field:"group",type:"nominal",title:null,header:{orient:"bottom"},sort:null},ma={width:{step:25},height:200,encoding:{y:{field:"yValue",type:"quantitative",title:"observations"},x:{field:"xValue",type:"nominal",title:null,sort:null,axis:{labelAngle:0,labelOverlap:!0}},opacity:{field:"opacity",type:"quantitative",scale:null}},layer:[{mark:{type:"bar"},encoding:{color:{field:"color",type:"nominal"}}},{mark:{type:"text",dx:0,angle:0,baseline:"bottom",align:"center",color:"#6b7280"},encoding:{text:{field:"yValue",type:"quantitative"}}}]},pa={facet:{columns:2},axis:{titleFontSize:14,labelFontSize:12,labelColor:"#333"},legend:{titleFontSize:14,labelFontSize:14,labelLimit:0,orient:"bottom",columns:1,labelColor:"#333"},header:{titleFontSize:14,labelFontSize:14,labelColor:"#333"},mark:{fontSize:12,color:"#333"},title:{fontSize:14,color:"#333"}},ba={axis:{x:"independent",y:"independent"}};var va={$schema:ua,description:ha,data:da,facet:_a,spec:ma,config:pa,resolve:ba};function ga(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/observations.csv":return He(()=>import("../../../../chunks/observations-300b979a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/observations.csv":return He(()=>import("../../../../chunks/observations-637c398b.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/observations.csv":return He(()=>import("../../../../chunks/observations-aedf9342.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/observations.csv":return He(()=>import("../../../../chunks/observations-c3886d39.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/observations.csv":return He(()=>import("../../../../chunks/observations-627adcb7.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}function ka(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/taxa.csv":return He(()=>import("../../../../chunks/taxa-f4c5fea7.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/taxa.csv":return He(()=>import("../../../../chunks/taxa-9108f66a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/taxa.csv":return He(()=>import("../../../../chunks/taxa-104f431f.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/taxa.csv":return He(()=>import("../../../../chunks/taxa-029efbae.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/taxa.csv":return He(()=>import("../../../../chunks/taxa-99749418.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}const{Map:wa}=Dl;function Wt(l,e,t){const a=l.slice();return a[66]=e[t],a}function Zt(l){let e,t,a,s,o,r,f,c,p,_=[],d=new wa,S,L,P;function w(m){l[49](m)}let D={searchFunction:l[31],onChange:l[30],labelFieldName:"label",valueFieldName:"taxon_id",placeholder:"Search species name",hideArrow:!0};l[8]!==void 0&&(D.selectedItem=l[8]),a=new Il({props:D}),Sl.push(()=>Tl(a,"selectedItem",w));let y=l[5].length>5&&xt(l),O=l[10]&&$t(l),T=l[11]&&el(l),V=l[5];const F=m=>m[66].taxon_id;for(let m=0;m<V.length;m+=1){let E=Wt(l,V,m),Q=F(E);d.set(Q,_[m]=tl(Q,E))}return{c(){e=b("section"),t=b("div"),Oe(a.$$.fragment),o=j(),y&&y.c(),r=j(),O&&O.c(),f=j(),T&&T.c(),c=j(),p=b("div");for(let m=0;m<_.length;m+=1)_[m].c();this.h()},l(m){e=v(m,"SECTION",{class:!0});var E=k(e);t=v(E,"DIV",{class:!0});var Q=k(t);Ae(a.$$.fragment,Q),Q.forEach(i),o=A(E),y&&y.l(E),r=A(E),O&&O.l(E),f=A(E),T&&T.l(E),c=A(E),p=v(E,"DIV",{class:!0});var ee=k(p);for(let K=0;K<_.length;K+=1)_[K].l(ee);ee.forEach(i),E.forEach(i),this.h()},h(){h(t,"class","max-w-lg mb-4 autocomplete svelte-b1whqg"),h(p,"class","grid lg:grid-cols-1 md:grid-cols-2 sm:grid-cols-1 gap-2"),h(e,"class","px-3 mb-3")},m(m,E){C(m,e,E),n(e,t),De(a,t,null),n(e,o),y&&y.m(e,null),n(e,r),O&&O.m(e,null),n(e,f),T&&T.m(e,null),n(e,c),n(e,p);for(let Q=0;Q<_.length;Q+=1)_[Q].m(p,null);P=!0},p(m,E){const Q={};!s&&E[0]&256&&(s=!0,Q.selectedItem=m[8],kl(()=>s=!1)),a.$set(Q),m[5].length>5?y?y.p(m,E):(y=xt(m),y.c(),y.m(e,r)):y&&(y.d(1),y=null),m[10]?O?(O.p(m,E),E[0]&1024&&N(O,1)):(O=$t(m),O.c(),N(O,1),O.m(e,f)):O&&(Ve(),U(O,1,1,()=>{O=null}),Re()),m[11]?T?(T.p(m,E),E[0]&2048&&N(T,1)):(T=el(m),T.c(),N(T,1),T.m(e,c)):T&&(Ve(),U(T,1,1,()=>{T=null}),Re()),E[0]&56|E[1]&816&&(V=m[5],Ve(),_=wl(_,E,F,1,m,V,d,p,Ol,tl,null,Wt),Re())},i(m){if(!P){N(a.$$.fragment,m),N(O),N(T);for(let E=0;E<V.length;E+=1)N(_[E]);Ze(()=>{S||(S=qe(p,Ee,{},!0)),S.run(1)}),Ze(()=>{L||(L=qe(e,Ee,{},!0)),L.run(1)}),P=!0}},o(m){U(a.$$.fragment,m),U(O),U(T);for(let E=0;E<_.length;E+=1)U(_[E]);S||(S=qe(p,Ee,{},!1)),S.run(0),L||(L=qe(e,Ee,{},!1)),L.run(0),P=!1},d(m){m&&i(e),ye(a),y&&y.d(),O&&O.d(),T&&T.d();for(let E=0;E<_.length;E+=1)_[E].d();m&&S&&S.end(),m&&L&&L.end()}}}function xt(l){let e,t,a,s;return{c(){e=b("span"),t=H("Delete all"),this.h()},l(o){e=v(o,"SPAN",{class:!0});var r=k(e);t=G(r,"Delete all"),r.forEach(i),this.h()},h(){h(e,"class","btn btn-sm btn-outline mb-4 ")},m(o,r){C(o,e,r),n(e,t),a||(s=ue(e,"click",l[34]),a=!0)},p:Me,d(o){o&&i(e),a=!1,s()}}}function $t(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=j(),s=b("span"),o=H("Show 5 most observed species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var d=k(e);t=v(d,"INPUT",{type:!0,class:!0}),a=A(d),s=v(d,"SPAN",{});var S=k(s);o=G(S,"Show 5 most observed species"),S.forEach(i),d.forEach(i),this.h()},h(){h(t,"type","checkbox"),h(t,"class","mr-2"),h(e,"class","cursor-pointer block")},m(_,d){C(_,e,d),n(e,t),n(e,a),n(e,s),n(s,o),f=!0,c||(p=ue(t,"click",l[50]),c=!0)},p:Me,i(_){f||(Ze(()=>{r||(r=qe(e,Ee,{},!0)),r.run(1)}),f=!0)},o(_){r||(r=qe(e,Ee,{},!1)),r.run(0),f=!1},d(_){_&&i(e),_&&r&&r.end(),c=!1,p()}}}function el(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=j(),s=b("span"),o=H("Show indicator species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var d=k(e);t=v(d,"INPUT",{type:!0,class:!0}),a=A(d),s=v(d,"SPAN",{});var S=k(s);o=G(S,"Show indicator species"),S.forEach(i),d.forEach(i),this.h()},h(){h(t,"type","checkbox"),h(t,"class","mr-2"),h(e,"class","cursor-pointer block")},m(_,d){C(_,e,d),n(e,t),n(e,a),n(e,s),n(s,o),f=!0,c||(p=ue(t,"click",l[51]),c=!0)},p:Me,i(_){f||(Ze(()=>{r||(r=qe(e,Ee,{},!0)),r.run(1)}),f=!0)},o(_){r||(r=qe(e,Ee,{},!1)),r.run(0),f=!1},d(_){_&&i(e),_&&r&&r.end(),c=!1,p()}}}function tl(l,e){let t,a,s;return a=new ea({props:{taxa:e[3],taxon:e[66],toggleTaxon:e[36],removeTaxon:e[35],toggleInatGrid:e[39],toggleInatTaxonRange:e[40],projectPath:e[4],taxaHistory:e[5]}}),{key:l,first:null,c(){t=$e(),Oe(a.$$.fragment),this.h()},l(o){t=$e(),Ae(a.$$.fragment,o),this.h()},h(){this.first=t},m(o,r){C(o,t,r),De(a,o,r),s=!0},p(o,r){e=o;const f={};r[0]&8&&(f.taxa=e[3]),r[0]&32&&(f.taxon=e[66]),r[0]&16&&(f.projectPath=e[4]),r[0]&32&&(f.taxaHistory=e[5]),a.$set(f)},i(o){s||(N(a.$$.fragment,o),s=!0)},o(o){U(a.$$.fragment,o),s=!1},d(o){o&&i(t),ye(a,o)}}}function ll(l){let e,t,a,s,o,r,f,c,p,_,d,S,L,P,w,D;return{c(){e=b("section"),t=b("label"),a=b("input"),s=j(),o=b("span"),r=H("Temperature and Preciptation"),f=j(),c=b("label"),p=b("input"),_=j(),d=b("span"),S=H("Demo map layer"),this.h()},l(y){e=v(y,"SECTION",{class:!0});var O=k(e);t=v(O,"LABEL",{class:!0});var T=k(t);a=v(T,"INPUT",{type:!0}),s=A(T),o=v(T,"SPAN",{});var V=k(o);r=G(V,"Temperature and Preciptation"),V.forEach(i),T.forEach(i),f=A(O),c=v(O,"LABEL",{class:!0});var F=k(c);p=v(F,"INPUT",{type:!0}),_=A(F),d=v(F,"SPAN",{});var m=k(d);S=G(m,"Demo map layer"),m.forEach(i),F.forEach(i),O.forEach(i),this.h()},h(){h(a,"type","checkbox"),h(t,"class","cursor-pointer block"),h(p,"type","checkbox"),h(c,"class","cursor-pointer block"),h(e,"class","px-3 mb-3")},m(y,O){C(y,e,O),n(e,t),n(t,a),a.checked=l[12],n(t,s),n(t,o),n(o,r),n(e,f),n(e,c),n(c,p),p.checked=l[13],n(c,_),n(c,d),n(d,S),P=!0,w||(D=[ue(a,"change",l[53]),ue(p,"change",l[54])],w=!0)},p(y,O){O[0]&4096&&(a.checked=y[12]),O[0]&8192&&(p.checked=y[13])},i(y){P||(Ze(()=>{L||(L=qe(e,Ee,{},!0)),L.run(1)}),P=!0)},o(y){L||(L=qe(e,Ee,{},!1)),L.run(0),P=!1},d(y){y&&i(e),y&&L&&L.end(),w=!1,Je(D)}}}function al(l){let e,t,a,s,o,r;return{c(){e=b("span"),t=H("*"),this.h()},l(f){e=v(f,"SPAN",{class:!0,title:!0});var c=k(e);t=G(c,"*"),c.forEach(i),this.h()},h(){h(e,"class","text-red-600"),h(e,"title",a="Since there are over "+Tt+" observations on the map, the map uses clustered markers.")},m(f,c){C(f,e,c),n(e,t),o||(r=tt(s=lt.call(null,e)),o=!0)},p:Me,d(f){f&&i(e),o=!1,r()}}}function sl(l){let e,t,a,s;const o=[Ia,Ea],r=[];function f(c,p){return c[22]?0:1}return e=f(l),t=r[e]=o[e](l),{c(){t.c(),a=$e()},l(c){t.l(c),a=$e()},m(c,p){r[e].m(c,p),C(c,a,p),s=!0},p(c,p){let _=e;e=f(c),e===_?r[e].p(c,p):(Ve(),U(r[_],1,1,()=>{r[_]=null}),Re(),t=r[e],t?t.p(c,p):(t=r[e]=o[e](c),t.c()),N(t,1),t.m(a.parentNode,a))},i(c){s||(N(t),s=!0)},o(c){U(t),s=!1},d(c){r[e].d(c),c&&i(a)}}}function Ea(l){let e,t,a,s,o;return t=new Jt({}),{c(){e=b("span"),Oe(t.$$.fragment),this.h()},l(r){e=v(r,"SPAN",{title:!0});var f=k(e);Ae(t.$$.fragment,f),f.forEach(i),this.h()},h(){h(e,"title","click show to species list")},m(r,f){C(r,e,f),De(t,e,null),a=!0,s||(o=[tt(lt.call(null,e)),ue(e,"click",l[44])],s=!0)},p:Me,i(r){a||(N(t.$$.fragment,r),a=!0)},o(r){U(t.$$.fragment,r),a=!1},d(r){r&&i(e),ye(t),s=!1,Je(o)}}}function Ia(l){let e,t,a,s,o;return t=new Jt({}),{c(){e=b("span"),Oe(t.$$.fragment),this.h()},l(r){e=v(r,"SPAN",{title:!0});var f=k(e);Ae(t.$$.fragment,f),f.forEach(i),this.h()},h(){h(e,"title","click hide to species list")},m(r,f){C(r,e,f),De(t,e,null),a=!0,s||(o=[tt(lt.call(null,e)),ue(e,"click",l[44])],s=!0)},p:Me,i(r){a||(N(t.$$.fragment,r),a=!0)},o(r){U(t.$$.fragment,r),a=!1},d(r){r&&i(e),ye(t),s=!1,Je(o)}}}function ol(l){let e,t,a,s;return e=new jl({}),{c(){Oe(e.$$.fragment),t=j(),a=b("div"),this.h()},l(o){Ae(e.$$.fragment,o),t=A(o),a=v(o,"DIV",{class:!0,style:!0}),k(a).forEach(i),this.h()},h(){h(a,"class","bg-gray-100"),pe(a,"width","100%"),pe(a,"height","75vh")},m(o,r){De(e,o,r),C(o,t,r),C(o,a,r),s=!0},i(o){s||(N(e.$$.fragment,o),s=!0)},o(o){U(e.$$.fragment,o),s=!1},d(o){ye(e,o),o&&i(t),o&&i(a)}}}function rl(l){let e,t,a,s,o,r,f,c,p,_,d;a=new fa({});function S(w,D){return w[16].image_url?Ta:Sa}let L=S(l),P=L(l);return f=new Al({props:{observation:l[16],projectPath:l[4],compactLayout:!0}}),f.$on("zoomToObservation",l[41]),{c(){e=b("div"),t=b("span"),Oe(a.$$.fragment),s=j(),o=b("section"),P.c(),r=j(),Oe(f.$$.fragment),this.h()},l(w){e=v(w,"DIV",{class:!0});var D=k(e);t=v(D,"SPAN",{class:!0});var y=k(t);Ae(a.$$.fragment,y),y.forEach(i),s=A(D),o=v(D,"SECTION",{class:!0});var O=k(o);P.l(O),r=A(O),Ae(f.$$.fragment,O),O.forEach(i),D.forEach(i),this.h()},h(){h(t,"class","close-button cursor-pointer svelte-b1whqg"),h(o,"class","px-3 mb-3"),h(e,"class","absolute observation-container bg-white text-sm overflow-auto svelte-b1whqg")},m(w,D){C(w,e,D),n(e,t),De(a,t,null),n(e,s),n(e,o),P.m(o,null),n(o,r),De(f,o,null),p=!0,_||(d=ue(t,"click",l[55]),_=!0)},p(w,D){L===(L=S(w))&&P?P.p(w,D):(P.d(1),P=L(w),P&&(P.c(),P.m(o,r)));const y={};D[0]&65536&&(y.observation=w[16]),D[0]&16&&(y.projectPath=w[4]),f.$set(y)},i(w){p||(N(a.$$.fragment,w),N(f.$$.fragment,w),Ze(()=>{c||(c=qe(o,Ee,{},!0)),c.run(1)}),p=!0)},o(w){U(a.$$.fragment,w),U(f.$$.fragment,w),c||(c=qe(o,Ee,{},!1)),c.run(0),p=!1},d(w){w&&i(e),ye(a),P.d(),ye(f),w&&c&&c.end(),_=!1,d()}}}function Sa(l){let e,t;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){h(e,"class","float-right lg:float-none svelte-b1whqg"),xe(e.src,t=""+(nt+"/images/missing-image.png"))||h(e,"src",t),h(e,"alt","")},m(a,s){C(a,e,s)},p:Me,d(a){a&&i(e)}}}function Ta(l){let e,t,a;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){xe(e.src,t=l[16].image_url.replace("medium","small"))||h(e,"src",t),h(e,"alt",a="photo of "+vt(l[16])),h(e,"class","svelte-b1whqg")},m(s,o){C(s,e,o)},p(s,o){o[0]&65536&&!xe(e.src,t=s[16].image_url.replace("medium","small"))&&h(e,"src",t),o[0]&65536&&a!==(a="photo of "+vt(s[16]))&&h(e,"alt",a)},d(s){s&&i(e)}}}function nl(l){let e,t,a;return t=new Fl({props:{mapOptions:l[29],selectTimeSpanHandler:l[38],groupedObservations:l[9],toggleTimeSpans:l[37],timeSpanHistory:l[6],activeTaxaCount:l[5].filter(hl).length}}),{c(){e=b("section"),Oe(t.$$.fragment)},l(s){e=v(s,"SECTION",{});var o=k(e);Ae(t.$$.fragment,o),o.forEach(i)},m(s,o){C(s,e,o),De(t,e,null),a=!0},p(s,o){const r={};o[0]&512&&(r.groupedObservations=s[9]),o[0]&64&&(r.timeSpanHistory=s[6]),o[0]&32&&(r.activeTaxaCount=s[5].filter(hl).length),t.$set(r)},i(s){a||(N(t.$$.fragment,s),a=!0)},o(s){U(t.$$.fragment,s),a=!1},d(s){s&&i(e),ye(t)}}}function il(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=j(),s=b("span"),o=H("Update charts as map changes"),r=j(),f=b("div"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var d=k(e);t=v(d,"INPUT",{type:!0}),a=A(d),s=v(d,"SPAN",{});var S=k(s);o=G(S,"Update charts as map changes"),S.forEach(i),d.forEach(i),r=A(_),f=v(_,"DIV",{id:!0,class:!0}),k(f).forEach(i),this.h()},h(){h(t,"type","checkbox"),h(e,"class","cursor-pointer mt-2 inline-block"),h(f,"id","ed-chart"),h(f,"class","w-full mt-4")},m(_,d){C(_,e,d),n(e,t),t.checked=l[7],n(e,a),n(e,s),n(s,o),C(_,r,d),C(_,f,d),c||(p=ue(t,"change",l[56]),c=!0)},p(_,d){d[0]&128&&(t.checked=_[7])},d(_){_&&i(e),_&&i(r),_&&i(f),c=!1,p()}}}function cl(l){let e,t,a,s,o,r;return{c(){e=b("h3"),t=H("Temperature and Preciptation"),a=j(),s=b("img"),this.h()},l(f){e=v(f,"H3",{class:!0});var c=k(e);t=G(c,"Temperature and Preciptation"),c.forEach(i),a=A(f),s=v(f,"IMG",{src:!0,alt:!0}),this.h()},h(){h(e,"class","text-center"),xe(s.src,o=""+(nt+"/images/"+l[1].username+"/"+l[0].slug+"/climate-chart.png"))||h(s,"src",o),h(s,"alt",r="climate chart for "+l[0].location)},m(f,c){C(f,e,c),n(e,t),C(f,a,c),C(f,s,c)},p(f,c){c[0]&3&&!xe(s.src,o=""+(nt+"/images/"+f[1].username+"/"+f[0].slug+"/climate-chart.png"))&&h(s,"src",o),c[0]&1&&r!==(r="climate chart for "+f[0].location)&&h(s,"alt",r)},d(f){f&&i(e),f&&i(a),f&&i(s)}}}function Oa(l){let e,t,a=l[2].label+"",s,o,r,f,c,p,_,d,S,L,P,w,D,y,O,T,V,F,m,E,Q,ee,K,be,te,$,Pe,oe,B,R,ge,fe,ke,Ie,re,Z,Se,he,de,Te,ve,x,J,Y,we,Ge,Le,ne,X,Be,Ne,ie,Ue,je,ot,et,at,ze;d=new Qt({props:{showMore:!0,position:"normal"}}),d.$on("toggleShowMore",l[48]);let le=l[26]&&Zt(l);D=new Qt({props:{showMore:!0,position:"normal"}}),D.$on("toggleShowMore",l[52]);let ae=l[27]&&ll(l),_e=l[18]>=Tt&&al(),se=l[23]&&sl(l),ce=l[15]&&l[14]&&ol();var Fe=l[28];function it(g){return{props:{mapOptions:g[29],groupedObservations:g[9],timeSpanHistory:g[6],showDemoMapLayer:g[13],taxaHistory:g[5],mapCenter:g[24],country:g[0].country}}}Fe&&(X=new Fe(it(l)),X.$on("markerClick",l[43]),X.$on("updateStats",l[42]));let u=l[25]&&rl(l);je=new Ul({props:{showSpeciesList:l[22],speciesList:l[21]}});let I=l[5].length>0&&nl(l),q=l[5].length>0&&il(l),M=l[12]&&cl(l);return{c(){e=b("div"),t=b("h1"),s=H(a),o=j(),r=b("div"),f=b("div"),c=b("div"),p=b("h3"),_=H(`Biodiversity
          `),Oe(d.$$.fragment),S=j(),le&&le.c(),L=j(),P=b("h3"),w=H(`Environmental Factors
          `),Oe(D.$$.fragment),y=j(),ae&&ae.c(),O=j(),T=b("div"),V=b("div"),F=b("div"),m=b("div"),E=H("Observations"),Q=j(),ee=b("div"),K=H(l[17]),be=j(),te=b("div"),$=b("div"),Pe=H(`Observations on map
            `),_e&&_e.c(),oe=j(),B=b("div"),R=H(l[18]),ge=j(),fe=b("div"),ke=b("div"),Ie=H("Species"),re=j(),Z=b("div"),Se=H(l[19]),he=j(),de=b("div"),Te=b("div"),ve=H("Species on map"),x=j(),J=b("div"),Y=H(l[20]),we=j(),se&&se.c(),Ge=j(),ce&&ce.c(),Le=j(),ne=b("div"),X&&Oe(X.$$.fragment),Be=j(),u&&u.c(),Ne=j(),ie=b("div"),Ue=b("section"),Oe(je.$$.fragment),ot=j(),I&&I.c(),et=j(),q&&q.c(),at=j(),M&&M.c(),this.h()},l(g){e=v(g,"DIV",{class:!0});var z=k(e);t=v(z,"H1",{class:!0});var me=k(t);s=G(me,a),me.forEach(i),o=A(z),r=v(z,"DIV",{class:!0});var Ce=k(r);f=v(Ce,"DIV",{class:!0});var rt=k(f);c=v(rt,"DIV",{class:!0});var Ye=k(c);p=v(Ye,"H3",{class:!0});var gt=k(p);_=G(gt,`Biodiversity
          `),Ae(d.$$.fragment,gt),gt.forEach(i),S=A(Ye),le&&le.l(Ye),L=A(Ye),P=v(Ye,"H3",{class:!0});var kt=k(P);w=G(kt,`Environmental Factors
          `),Ae(D.$$.fragment,kt),kt.forEach(i),y=A(Ye),ae&&ae.l(Ye),Ye.forEach(i),rt.forEach(i),O=A(Ce),T=v(Ce,"DIV",{class:!0});var Xe=k(T);V=v(Xe,"DIV",{class:!0});var Ke=k(V);F=v(Ke,"DIV",{class:!0});var ct=k(F);m=v(ct,"DIV",{class:!0});var Ot=k(m);E=G(Ot,"Observations"),Ot.forEach(i),Q=A(ct),ee=v(ct,"DIV",{class:!0});var Dt=k(ee);K=G(Dt,l[17]),Dt.forEach(i),ct.forEach(i),be=A(Ke),te=v(Ke,"DIV",{class:!0});var ft=k(te);$=v(ft,"DIV",{class:!0});var wt=k($);Pe=G(wt,`Observations on map
            `),_e&&_e.l(wt),wt.forEach(i),oe=A(ft),B=v(ft,"DIV",{class:!0});var yt=k(B);R=G(yt,l[18]),yt.forEach(i),ft.forEach(i),ge=A(Ke),fe=v(Ke,"DIV",{class:!0});var ut=k(fe);ke=v(ut,"DIV",{class:!0});var Pt=k(ke);Ie=G(Pt,"Species"),Pt.forEach(i),re=A(ut),Z=v(ut,"DIV",{class:!0});var Lt=k(Z);Se=G(Lt,l[19]),Lt.forEach(i),ut.forEach(i),he=A(Ke),de=v(Ke,"DIV",{class:!0});var ht=k(de);Te=v(ht,"DIV",{class:!0});var jt=k(Te);ve=G(jt,"Species on map"),jt.forEach(i),x=A(ht),J=v(ht,"DIV",{class:!0});var dt=k(J);Y=G(dt,l[20]),we=A(dt),se&&se.l(dt),dt.forEach(i),ht.forEach(i),Ke.forEach(i),Ge=A(Xe),ce&&ce.l(Xe),Le=A(Xe),ne=v(Xe,"DIV",{class:!0});var _t=k(ne);X&&Ae(X.$$.fragment,_t),Be=A(_t),u&&u.l(_t),_t.forEach(i),Ne=A(Xe),ie=v(Xe,"DIV",{class:!0});var Qe=k(ie);Ue=v(Qe,"SECTION",{});var At=k(Ue);Ae(je.$$.fragment,At),At.forEach(i),ot=A(Qe),I&&I.l(Qe),et=A(Qe),q&&q.l(Qe),at=A(Qe),M&&M.l(Qe),Qe.forEach(i),Xe.forEach(i),Ce.forEach(i),z.forEach(i),this.h()},h(){h(t,"class","px-3"),h(p,"class","bg-gray-200 mt-0 px-3 py-1"),h(P,"class","bg-gray-200 mt-0 px-3 py-1"),h(c,"class","grid"),h(f,"class","lg:col-span-3 border-0 lg:border-r-2 border-t"),h(m,"class","stat-title svelte-b1whqg"),h(ee,"class","stat-value svelte-b1whqg"),h(F,"class","stat place-items-center place-content-center svelte-b1whqg"),h($,"class","stat-title svelte-b1whqg"),h(B,"class","stat-value svelte-b1whqg"),h(te,"class","stat place-items-center place-content-center svelte-b1whqg"),h(ke,"class","stat-title svelte-b1whqg"),h(Z,"class","stat-value svelte-b1whqg"),h(fe,"class","stat place-items-center place-content-center svelte-b1whqg"),h(Te,"class","stat-title svelte-b1whqg"),h(J,"class","stat-value svelte-b1whqg"),h(de,"class","stat place-items-center place-content-center svelte-b1whqg"),h(V,"class","w-full rounded-none border stats"),h(ne,"class","relative"),h(ie,"class","px-3"),h(T,"class","lg:col-span-7"),h(r,"class","grid lg:grid-cols-10 mb-6"),h(e,"class","prose max-w-none")},m(g,z){C(g,e,z),n(e,t),n(t,s),n(e,o),n(e,r),n(r,f),n(f,c),n(c,p),n(p,_),De(d,p,null),n(c,S),le&&le.m(c,null),n(c,L),n(c,P),n(P,w),De(D,P,null),n(c,y),ae&&ae.m(c,null),n(r,O),n(r,T),n(T,V),n(V,F),n(F,m),n(m,E),n(F,Q),n(F,ee),n(ee,K),n(V,be),n(V,te),n(te,$),n($,Pe),_e&&_e.m($,null),n(te,oe),n(te,B),n(B,R),n(V,ge),n(V,fe),n(fe,ke),n(ke,Ie),n(fe,re),n(fe,Z),n(Z,Se),n(V,he),n(V,de),n(de,Te),n(Te,ve),n(de,x),n(de,J),n(J,Y),n(J,we),se&&se.m(J,null),n(T,Ge),ce&&ce.m(T,null),n(T,Le),n(T,ne),X&&De(X,ne,null),n(ne,Be),u&&u.m(ne,null),n(T,Ne),n(T,ie),n(ie,Ue),De(je,Ue,null),n(ie,ot),I&&I.m(ie,null),n(ie,et),q&&q.m(ie,null),n(ie,at),M&&M.m(ie,null),ze=!0},p(g,z){(!ze||z[0]&4)&&a!==(a=g[2].label+"")&&We(s,a),g[26]?le?(le.p(g,z),z[0]&67108864&&N(le,1)):(le=Zt(g),le.c(),N(le,1),le.m(c,L)):le&&(Ve(),U(le,1,1,()=>{le=null}),Re()),g[27]?ae?(ae.p(g,z),z[0]&134217728&&N(ae,1)):(ae=ll(g),ae.c(),N(ae,1),ae.m(c,null)):ae&&(Ve(),U(ae,1,1,()=>{ae=null}),Re()),(!ze||z[0]&131072)&&We(K,g[17]),g[18]>=Tt?_e?_e.p(g,z):(_e=al(),_e.c(),_e.m($,null)):_e&&(_e.d(1),_e=null),(!ze||z[0]&262144)&&We(R,g[18]),(!ze||z[0]&524288)&&We(Se,g[19]),(!ze||z[0]&1048576)&&We(Y,g[20]),g[23]?se?(se.p(g,z),z[0]&8388608&&N(se,1)):(se=sl(g),se.c(),N(se,1),se.m(J,null)):se&&(Ve(),U(se,1,1,()=>{se=null}),Re()),g[15]&&g[14]?ce?z[0]&49152&&N(ce,1):(ce=ol(),ce.c(),N(ce,1),ce.m(T,Le)):ce&&(Ve(),U(ce,1,1,()=>{ce=null}),Re());const me={};if(z[0]&512&&(me.groupedObservations=g[9]),z[0]&64&&(me.timeSpanHistory=g[6]),z[0]&8192&&(me.showDemoMapLayer=g[13]),z[0]&32&&(me.taxaHistory=g[5]),z[0]&16777216&&(me.mapCenter=g[24]),z[0]&1&&(me.country=g[0].country),Fe!==(Fe=g[28])){if(X){Ve();const rt=X;U(rt.$$.fragment,1,0,()=>{ye(rt,1)}),Re()}Fe?(X=new Fe(it(g)),X.$on("markerClick",g[43]),X.$on("updateStats",g[42]),Oe(X.$$.fragment),N(X.$$.fragment,1),De(X,ne,Be)):X=null}else Fe&&X.$set(me);g[25]?u?(u.p(g,z),z[0]&33554432&&N(u,1)):(u=rl(g),u.c(),N(u,1),u.m(ne,null)):u&&(Ve(),U(u,1,1,()=>{u=null}),Re());const Ce={};z[0]&4194304&&(Ce.showSpeciesList=g[22]),z[0]&2097152&&(Ce.speciesList=g[21]),je.$set(Ce),g[5].length>0?I?(I.p(g,z),z[0]&32&&N(I,1)):(I=nl(g),I.c(),N(I,1),I.m(ie,et)):I&&(Ve(),U(I,1,1,()=>{I=null}),Re()),g[5].length>0?q?q.p(g,z):(q=il(g),q.c(),q.m(ie,at)):q&&(q.d(1),q=null),g[12]?M?M.p(g,z):(M=cl(g),M.c(),M.m(ie,null)):M&&(M.d(1),M=null)},i(g){ze||(N(d.$$.fragment,g),N(le),N(D.$$.fragment,g),N(ae),N(se),N(ce),X&&N(X.$$.fragment,g),N(u),N(je.$$.fragment,g),N(I),ze=!0)},o(g){U(d.$$.fragment,g),U(le),U(D.$$.fragment,g),U(ae),U(se),U(ce),X&&U(X.$$.fragment,g),U(u),U(je.$$.fragment,g),U(I),ze=!1},d(g){g&&i(e),ye(d),le&&le.d(),ye(D),ae&&ae.d(),_e&&_e.d(),se&&se.d(),ce&&ce.d(),X&&ye(X),u&&u.d(),ye(je),I&&I.d(),q&&q.d(),M&&M.d()}}}async function qa({params:l,url:e}){let t=ql.filter(d=>d.username===l.users)[0],a=t.projects.filter(d=>d.slug===l.projects)[0],s=e.pathname.split("/"),o=a.tabs_project.filter(d=>d.link===s[s.length-1])[0],r=`${nt}/users/${t.username}/${a.slug}`,f=await ka(`../../../../lib/data/${l.projects}/taxa.csv`),c=Pl(f.default),p=await ga(`../../../../lib/data/${l.projects}/observations.csv`),_=Ll(p.default);return{props:{project:a,user:t,currentTab:o,projectObservations:_,taxa:c,projectPath:r}}}let st=.25,Tt=1e3,fl="#ed-chart",ul="oldest";const hl=l=>l.active;function Da(l,e,t){let{project:a}=e,{user:s}=e,{currentTab:o}=e,{projectObservations:r}=e,{taxa:f}=e,{projectPath:c}=e,p="",_={},d=new Set,S=new Set,L=[],P=[],w=[],D={},y=a.slug!=="los-angeles-bioblitz",O=a.slug==="los-angeles-bioblitz",T=!1,V=!1,F=0,m=!1,E=!1,Q=JSON.parse(JSON.stringify(Bl)),ee=JSON.parse(JSON.stringify(va)),K,be=0,te=0,$=0,Pe=0,oe=[],B=!1,R=!1,ge={},fe=!1,ke=!1,Ie=!0,re=!0;r=r.filter(u=>u.latitude&&u.longitude);let Z=It(Et({},zl),{zoom:a.zoom,latitude:a.latitude,longitude:a.longitude,observationsTimeSpan:"all",colorSchemeMonth:Array(12).fill(St),colorSchemeYear:[St],defaultColor:St,monthSeasonalMarkers:!1,center:[a.latitude||0,a.longitude||0],preferCanvas:!0});function Se(u){!u||!u.label||(t(10,y=!1),t(11,O=!1),!(w.filter(I=>I.taxon_id==u.taxon_id).length>0)&&(F+=1,t(14,m=!0),setTimeout(()=>{ve(u)},100)))}async function he(u){if(u.length>2)return await Ml(f,u)}function de(){t(10,y=!1),f.filter(u=>u.rank==="species").sort((u,I)=>I.taxa_count-u.taxa_count).slice(0,5).forEach(u=>{F+=1,ve(u)})}function Te(){t(11,O=!1),f.filter(u=>u.taxon_group&&u.observations_count>0).sort((u,I)=>I.taxa_count-u.taxa_count).forEach(u=>{F+=1,ve(u)})}function ve(u){t(14,m=!0);let I=Nl(F,Z.colorScheme.length),q=Cl(r,u.taxon_id,Z.colorScheme[I]);q.forEach(me=>{t(46,_[me.id]=me,_),d.add(me.id),S.add(me.id)}),t(9,L=we()),Le("addObservationsForTaxon"),t(16,K=q[0]);let M=Hl(u.taxon_id),g=Z.colorScheme[I],z=Vl(g,10);t(5,w=w.concat({taxon_name:vt(u),image_url:u.image_url,taxa_count:u.taxa_count,taxon_id:u.taxon_id,color:g,rank:u.rank,active:!0,observationIds:q.map(me=>me.id),showInatGrid:!1,InatGridUrl:`${M.InatGrid.url}&color=%23${z}`,showInatTaxonRange:!1,InatTaxonRangeUrl:`${M.InatTaxonRange.url}?color=%23${z}`})),Z.observationsTimeSpan!=="all"&&L.forEach((me,Ce)=>t(6,D[Ce]=D[Ce]!==void 0?D[Ce]:!0,D)),t(14,m=!1)}function x(){t(8,p=""),t(46,_={}),d=new Set,S=new Set,t(9,L=[]),t(47,P=[]),t(5,w=[]),t(6,D={}),Le("resetTaxa")}function J(u){t(14,m=!0);let I=Number(u.target.dataset.taxonId);S=new Set,d=new Set,t(5,w=w.filter(M=>(M.taxon_id!==I&&(M.active?M.observationIds.forEach(g=>{Ge(M.color,g),S.add(g),d.add(g)}):M.observationIds.forEach(g=>{d.add(g)})),M.taxon_id!==I)));let q={};d.forEach(M=>q[M]=_[M]),t(46,_=q),Le("removeTaxon"),t(9,L=we()),Le("removeTaxon"),t(14,m=!1)}function Y(u){t(14,m=!0);let I=Number(u.target.dataset.taxonId);if(!I)return;let q=!0;if(t(14,m=!0),t(5,w=w.map(M=>M.taxon_id===I?(q=!M.active,It(Et({},M),{active:!M.active})):M)),q){let M=w.filter(g=>g.taxon_id===I)[0];M.observationIds.forEach(g=>{Ge(M.color,g),S.add(g)})}else S=new Set,w.forEach(M=>{M.taxon_id!==I&&M.active&&M.observationIds.forEach(g=>{Ge(M.color,g),S.add(g)})});t(9,L=we()),Le("toggleTaxon"),t(14,m=!1)}function we(){let u=[...S].map(I=>_[I]);return u=zt(u,ul,Z.observationsTimeSpan),qt(u,Z.observationsTimeSpan)}function Ge(u,I){let q=_[I];q.color=u,q.fillColor=u}function Le(u){console.log(u,`observations: ${Object.keys(_).length}`,`observationIds: ${d.size}`,`activeObservationsIds: ${S.size}`)}function ne(u){t(6,D=Rl(u,D))}function X(){t(14,m=!0);let u=zt(Object.values(_),ul,Z.observationsTimeSpan);t(9,L=qt(u,Z.observationsTimeSpan)),t(6,D={}),Z.observationsTimeSpan!=="all"&&L.forEach((I,q)=>t(6,D[q]=!0,D)),t(14,m=!1)}function Be(u){let I=w.map(q=>q.taxon_id).indexOf(u);t(5,w[I].showInatGrid=!w[I].showInatGrid,w)}function Ne(u){let I=w.map(q=>q.taxon_id).indexOf(u);t(5,w[I].showInatTaxonRange=!w[I].showInatTaxonRange,w)}function ie(u){t(24,ge=u.detail)}function Ue(u){t(18,te=u.detail.observationsOnMapCount),t(17,be=u.detail.observationsSelectedCount),t(19,$=u.detail.speciesCount),t(20,Pe=u.detail.speciesDisplayCount),t(21,oe=u.detail.speciesList),t(23,R=u.detail.showSpeciesListIcon);let I=u.detail.observationsOnMap;Array.isArray(I)?t(47,P=I):(t(47,P=[]),I.forEach((q,M)=>{t(47,P=P.concat(q))}))}function je(u){t(25,ke=!0),t(16,K=_[u.detail.observation_id])}function ot(){t(22,B=!B)}let et;El(async()=>{const u=await He(()=>import("../../../../chunks/explore_data_map-da1733bd.js"),["chunks/explore_data_map-da1733bd.js","chunks/vendor-f02122e8.js","assets/vendor-9877410d.css","chunks/index-7ea9a574.js","assets/index-a02ee4b4.css","chunks/mapUtils-e9636914.js","chunks/observation_data-e7b6f804.js","assets/observation_data-f8b72239.css","chunks/formatUtils-77b182ad.js","chunks/constants-3d7024b8.js","chunks/map_toggle_marker_type_button-fe5c5a0f.js","chunks/TileLayer-73bec47f.js","chunks/CircleMarker-071e650d.js"]);t(28,et=u.default),t(14,m=!1),t(15,E=!0)});const at=u=>t(26,Ie=u.detail.showMore);function ze(u){p=u,t(8,p)}const le=()=>de(),ae=()=>Te(),_e=u=>t(27,re=u.detail.showMore);function se(){T=this.checked,t(12,T)}function ce(){V=this.checked,t(13,V)}const Fe=()=>t(25,ke=!1);function it(){fe=this.checked,t(7,fe)}return l.$$set=u=>{"project"in u&&t(0,a=u.project),"user"in u&&t(1,s=u.user),"currentTab"in u&&t(2,o=u.currentTab),"projectObservations"in u&&t(45,r=u.projectObservations),"taxa"in u&&t(3,f=u.taxa),"projectPath"in u&&t(4,c=u.projectPath)},l.$$.update=()=>{if(l.$$.dirty[0]&33&&w.length===0&&(t(10,y=a.slug!=="los-angeles-bioblitz"),t(11,O=a.slug==="los-angeles-bioblitz"),t(6,D={}),t(16,K=null)),l.$$.dirty[0]&225|l.$$.dirty[1]&65536&&w.length>0&&fe){let u=P,I;Z.observationsTimeSpan=="all"?I=Gt(Q,st,w,u):Z.observationsTimeSpan=="month"?I=Ut(ee,st,w,D,u,a):I=Bt(ee,st,w,D,u,a),Ft(I,fl)}if(l.$$.dirty[0]&225|l.$$.dirty[1]&32768&&w.length>0&&!fe){let u=Object.values(_),I;Z.observationsTimeSpan=="all"?I=Gt(Q,st,w,u):Z.observationsTimeSpan=="month"?I=Ut(ee,st,w,D,u,a):I=Bt(ee,st,w,D,u,a),Ft(I,fl)}},[a,s,o,f,c,w,D,fe,p,L,y,O,T,V,m,E,K,be,te,$,Pe,oe,B,R,ge,ke,Ie,re,et,Z,Se,he,de,Te,x,J,Y,ne,X,Be,Ne,ie,Ue,je,ot,r,_,P,at,ze,le,ae,_e,se,ce,Fe,it]}class za extends mt{constructor(e){super();pt(this,e,Da,Oa,bt,{project:0,user:1,currentTab:2,projectObservations:45,taxa:3,projectPath:4},null,[-1,-1,-1])}}export{za as default,qa as load};
