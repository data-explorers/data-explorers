var bl=Object.defineProperty,vl=Object.defineProperties;var gl=Object.getOwnPropertyDescriptors;var zt=Object.getOwnPropertySymbols;var kl=Object.prototype.hasOwnProperty,El=Object.prototype.propertyIsEnumerable;var Rt=(l,e,t)=>e in l?bl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,Tt=(l,e)=>{for(var t in e||(e={}))kl.call(e,t)&&Rt(l,t,e[t]);if(zt)for(var t of zt(e))El.call(e,t)&&Rt(l,t,e[t]);return l},Ot=(l,e)=>vl(l,gl(e));import{_ as je}from"../../../../chunks/preload-helper-768eda0e.js";import{S as vt,i as gt,s as kt,e as b,t as M,j,c as v,a as g,g as z,d as c,l as L,b as u,N as K,f as C,F as r,Q as pe,h as xe,R as $e,T as qt,U as Ht,V as ot,v as Le,w as ze,x as Ae,W as Gt,p as H,m as Ue,n as Q,o as Be,A as Ne,J as Re,L as wl,X as Ie,K as et,k as rt,Y as Il,O as ge,Z as ft,_ as Sl,$ as Ve,a0 as Tl,u as Ol,a1 as Dl,a2 as yl,a3 as Pl,a4 as jl,a5 as Ll}from"../../../../chunks/vendor-ac733917.js";import{b as ut}from"../../../../chunks/paths-28a87002.js";import{g as Al,f as Nl,a as Vl,L as Cl,O as Ml,b as zl,m as Rl,c as ql,d as Ut,l as Hl,s as Bt,u as Gl}from"../../../../chunks/observation_data-90cf8ccf.js";import{s as Ul}from"../../../../chunks/settings-335072b9.js";import{d as Bl,a as Dt,g as Fl}from"../../../../chunks/mapUtils-e9636914.js";import{p as Ft,f as Et}from"../../../../chunks/formatUtils-77b182ad.js";import{C as Jl,t as ht,M as Yl,b as Xl,s as Jt,a as Yt,c as Xt,d as Kt,e as Kl}from"../../../../chunks/bar_chart-7b26ba54.js";import"../../../../chunks/constants-3d7024b8.js";function Qt(l,e,t){const s=l.slice();return s[19]=e[t],s}function Ql(l){let e,t;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{src:!0,alt:!0}),this.h()},h(){et(e.src,t=""+(ut+"/images/missing-image.png"))||u(e,"src",t),u(e,"alt","")},m(s,a){C(s,e,a)},p:Re,d(s){s&&c(e)}}}function Wl(l){let e,t,s;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{src:!0,alt:!0}),this.h()},h(){et(e.src,t=l[0].image_url.replace("medium","square"))||u(e,"src",t),u(e,"alt",s="photo of "+l[0].taxon_name)},m(a,o){C(a,e,o)},p(a,o){o&1&&!et(e.src,t=a[0].image_url.replace("medium","square"))&&u(e,"src",t),o&1&&s!==(s="photo of "+a[0].taxon_name)&&u(e,"alt",s)},d(a){a&&c(e)}}}function Zl(l){let e;return{c(){e=M("More")},l(t){e=z(t,"More")},m(t,s){C(t,e,s)},d(t){t&&c(e)}}}function xl(l){let e;return{c(){e=M("Less")},l(t){e=z(t,"Less")},m(t,s){C(t,e,s)},d(t){t&&c(e)}}}function $l(l){let e;return{c(){e=M("Show")},l(t){e=z(t,"Show")},m(t,s){C(t,e,s)},d(t){t&&c(e)}}}function ea(l){let e;return{c(){e=M("Hide")},l(t){e=z(t,"Hide")},m(t,s){C(t,e,s)},d(t){t&&c(e)}}}function Wt(l){let e,t,s,a,o,i,h,n,f,_,p,w=l[0].rank+"",O,T,k,S,N,P,D,U,$,m,I,W,se,X,ke,oe,te,Pe,ne=l[10]&&ta(l);return{c(){e=b("div"),t=b("dl"),s=b("dt"),a=M("link"),o=b("dd"),i=b("a"),h=M("Species page"),f=b("dt"),_=M("taxonomic rank"),p=b("dd"),O=M(w),T=j(),k=b("span"),S=M("Map layers"),N=j(),P=b("label"),D=b("input"),U=M("all iNaturalist observations"),$=j(),m=b("label"),I=b("input"),W=M("Taxon range"),se=j(),ne&&ne.c(),this.h()},l(F){e=v(F,"DIV",{class:!0});var R=g(e);t=v(R,"DL",{class:!0});var he=g(t);s=v(he,"DT",{class:!0});var de=g(s);a=z(de,"link"),de.forEach(c),o=v(he,"DD",{});var Se=g(o);i=v(Se,"A",{href:!0});var Te=g(i);h=z(Te,"Species page"),Te.forEach(c),Se.forEach(c),f=v(he,"DT",{class:!0});var fe=g(f);_=z(fe,"taxonomic rank"),fe.forEach(c),p=v(he,"DD",{});var Z=g(p);O=z(Z,w),Z.forEach(c),he.forEach(c),T=L(R),k=v(R,"SPAN",{class:!0});var Oe=g(k);S=z(Oe,"Map layers"),Oe.forEach(c),N=L(R),P=v(R,"LABEL",{class:!0});var _e=g(P);D=v(_e,"INPUT",{type:!0,class:!0}),U=z(_e,"all iNaturalist observations"),_e.forEach(c),$=L(R),m=v(R,"LABEL",{class:!0});var be=g(m);I=v(be,"INPUT",{type:!0,class:!0}),W=z(be,"Taxon range"),be.forEach(c),se=L(R),ne&&ne.l(R),R.forEach(c),this.h()},h(){u(s,"class","svelte-zcv3p1"),u(i,"href",n=""+(l[3]+"/taxa/"+l[0].taxon_id)),u(f,"class","svelte-zcv3p1"),u(t,"class","svelte-zcv3p1"),u(k,"class","font-medium inline-block"),u(D,"type","checkbox"),u(D,"class","mr-1"),u(P,"class","cursor-pointer block"),u(I,"type","checkbox"),u(I,"class","mr-1"),u(m,"class","cursor-pointer block"),u(e,"class","py-1 px-2 card-more-content svelte-zcv3p1"),K(e,"active",l[0].active)},m(F,R){C(F,e,R),r(e,t),r(t,s),r(s,a),r(t,o),r(o,i),r(i,h),r(t,f),r(f,_),r(t,p),r(p,O),r(e,T),r(e,k),r(k,S),r(e,N),r(e,P),r(P,D),D.checked=l[8],r(P,U),r(e,$),r(e,m),r(m,I),I.checked=l[7],r(m,W),r(e,se),ne&&ne.m(e,null),oe=!0,te||(Pe=[pe(D,"change",l[14]),pe(D,"click",l[15]),pe(I,"change",l[16]),pe(I,"click",l[17])],te=!0)},p(F,R){(!oe||R&9&&n!==(n=""+(F[3]+"/taxa/"+F[0].taxon_id)))&&u(i,"href",n),(!oe||R&1)&&w!==(w=F[0].rank+"")&&xe(O,w),R&256&&(D.checked=F[8]),R&128&&(I.checked=F[7]),F[10]&&ne.p(F,R),R&1&&K(e,"active",F[0].active)},i(F){oe||($e(()=>{ke&&ke.end(1),X=qt(e,Ie,{}),X.start()}),oe=!0)},o(F){X&&X.invalidate(),ke=Ht(e,Ie,{}),oe=!1},d(F){F&&c(e),ne&&ne.d(),F&&ke&&ke.end(),te=!1,ot(Pe)}}}function ta(l){let e,t=l[9].length+"",s,a,o,i,h=l[9],n=[];for(let f=0;f<h.length;f+=1)n[f]=Zt(Qt(l,h,f));return{c(){e=b("span"),s=M(t),a=M(" observed species"),o=j(),i=b("ul");for(let f=0;f<n.length;f+=1)n[f].c();this.h()},l(f){e=v(f,"SPAN",{class:!0});var _=g(e);s=z(_,t),a=z(_," observed species"),_.forEach(c),o=L(f),i=v(f,"UL",{class:!0});var p=g(i);for(let w=0;w<n.length;w+=1)n[w].l(p);p.forEach(c),this.h()},h(){u(e,"class","font-medium mt-2 inline-block"),u(i,"class","observed-species svelte-zcv3p1")},m(f,_){C(f,e,_),r(e,s),r(e,a),C(f,o,_),C(f,i,_);for(let p=0;p<n.length;p+=1)n[p].m(i,null)},p(f,_){if(_&512){h=f[9];let p;for(p=0;p<h.length;p+=1){const w=Qt(f,h,p);n[p]?n[p].p(w,_):(n[p]=Zt(w),n[p].c(),n[p].m(i,null))}for(;p<n.length;p+=1)n[p].d(1);n.length=h.length}},d(f){f&&c(e),f&&c(o),f&&c(i),wl(n,f)}}}function Zt(l){let e,t=Et(l[19],!0)+"";return{c(){e=b("li"),this.h()},l(s){e=v(s,"LI",{class:!0});var a=g(e);a.forEach(c),this.h()},h(){u(e,"class","svelte-zcv3p1")},m(s,a){C(s,e,a),e.innerHTML=t},p:Re,d(s){s&&c(e)}}}function la(l){let e,t,s,a,o,i,h,n,f,_=l[0].taxon_name+"",p,w,O,T,k=Ft("observation",l[0].taxa_count)+"",S,N,P,D,U,$,m,I,W,se,X,ke,oe,te,Pe,ne,F,R,he,de;function Se(x,Y){return x[0].image_url?Wl:Ql}let Te=Se(l),fe=Te(l);h=new Jl({props:{value:l[0].taxon_id,color:l[0].color}});function Z(x,Y){return x[6]?xl:Zl}let Oe=Z(l),_e=Oe(l);function be(x,Y){return x[0].active?ea:$l}let De=be(l),Ee=De(l),ee=l[6]&&Wt(l);return{c(){e=b("div"),t=b("div"),s=b("figure"),fe.c(),a=j(),o=b("div"),i=b("div"),Le(h.$$.fragment),n=j(),f=b("span"),p=M(_),w=b("br"),O=j(),T=b("span"),S=M(k),N=b("br"),$=j(),m=b("ul"),I=b("li"),_e.c(),W=M(" info"),se=j(),X=b("li"),Ee.c(),oe=j(),te=b("li"),Pe=M("Delete"),F=j(),ee&&ee.c(),this.h()},l(x){e=v(x,"DIV",{class:!0});var Y=g(e);t=v(Y,"DIV",{class:!0});var we=g(t);s=v(we,"FIGURE",{});var Ce=g(s);fe.l(Ce),Ce.forEach(c),a=L(we),o=v(we,"DIV",{class:!0});var me=g(o);i=v(me,"DIV",{class:!0,"data-taxon-id":!0});var G=g(i);ze(h.$$.fragment,G),n=L(G),f=v(G,"SPAN",{});var Fe=g(f);p=z(Fe,_),Fe.forEach(c),w=v(G,"BR",{}),O=L(G),T=v(G,"SPAN",{});var Ye=g(T);S=z(Ye,k),Ye.forEach(c),N=v(G,"BR",{}),G.forEach(c),me.forEach(c),we.forEach(c),$=L(Y),m=v(Y,"UL",{class:!0});var J=g(m);I=v(J,"LI",{class:!0});var qe=g(I);_e.l(qe),W=z(qe," info"),qe.forEach(c),se=L(J),X=v(J,"LI",{"data-taxon-id":!0,class:!0});var Je=g(X);Ee.l(Je),Je.forEach(c),oe=L(J),te=v(J,"LI",{"data-taxon-id":!0,class:!0});var Xe=g(te);Pe=z(Xe,"Delete"),Xe.forEach(c),J.forEach(c),F=L(Y),ee&&ee.l(Y),Y.forEach(c),this.h()},h(){u(i,"class","leading-normal"),u(i,"data-taxon-id",P=l[0].taxon_id),u(o,"class","image-card-side-body svelte-zcv3p1"),u(t,"class","image-card-side svelte-zcv3p1"),K(t,"active",l[0].active),u(I,"class","svelte-zcv3p1"),u(X,"data-taxon-id",ke=l[0].taxon_id),u(X,"class","svelte-zcv3p1"),u(te,"data-taxon-id",ne=l[0].taxon_id),u(te,"class","svelte-zcv3p1"),u(m,"class","text-sm submenu bg-gray-100 grid grid-cols-3 svelte-zcv3p1"),K(m,"active",l[0].active),u(e,"class","border relative filter")},m(x,Y){C(x,e,Y),r(e,t),r(t,s),fe.m(s,null),r(t,a),r(t,o),r(o,i),Ae(h,i,null),r(i,n),r(i,f),r(f,p),r(i,w),r(i,O),r(i,T),r(T,S),r(i,N),r(e,$),r(e,m),r(m,I),_e.m(I,null),r(I,W),r(m,se),r(m,X),Ee.m(X,null),r(m,oe),r(m,te),r(te,Pe),r(e,F),ee&&ee.m(e,null),R=!0,he||(de=[pe(I,"click",l[13]),pe(X,"click",function(){Gt(l[1])&&l[1].apply(this,arguments)}),pe(te,"click",function(){Gt(l[2])&&l[2].apply(this,arguments)})],he=!0)},p(x,[Y]){l=x,Te===(Te=Se(l))&&fe?fe.p(l,Y):(fe.d(1),fe=Te(l),fe&&(fe.c(),fe.m(s,null)));const we={};Y&1&&(we.value=l[0].taxon_id),Y&1&&(we.color=l[0].color),h.$set(we),(!R||Y&1)&&_!==(_=l[0].taxon_name+"")&&xe(p,_),(!R||Y&1)&&k!==(k=Ft("observation",l[0].taxa_count)+"")&&xe(S,k),(!R||Y&1&&P!==(P=l[0].taxon_id))&&u(i,"data-taxon-id",P),Y&1&&K(t,"active",l[0].active),Oe!==(Oe=Z(l))&&(_e.d(1),_e=Oe(l),_e&&(_e.c(),_e.m(I,W))),De!==(De=be(l))&&(Ee.d(1),Ee=De(l),Ee&&(Ee.c(),Ee.m(X,null))),(!R||Y&1&&ke!==(ke=l[0].taxon_id))&&u(X,"data-taxon-id",ke),(!R||Y&1&&ne!==(ne=l[0].taxon_id))&&u(te,"data-taxon-id",ne),Y&1&&K(m,"active",l[0].active),l[6]?ee?(ee.p(l,Y),Y&64&&H(ee,1)):(ee=Wt(l),ee.c(),H(ee,1),ee.m(e,null)):ee&&(Ue(),Q(ee,1,1,()=>{ee=null}),Be())},i(x){R||(H(h.$$.fragment,x),$e(()=>{U&&U.end(1),D=qt(t,Ie,{}),D.start()}),H(ee),R=!0)},o(x){Q(h.$$.fragment,x),D&&D.invalidate(),U=Ht(t,Ie,{}),Q(ee),R=!1},d(x){x&&c(e),fe.d(),Ne(h),x&&U&&U.end(),_e.d(),Ee.d(),ee&&ee.d(),he=!1,ot(de)}}}function aa(l,e,t){let{taxon:s}=e,{taxa:a}=e,{toggleTaxon:o}=e,{removeTaxon:i}=e,{projectPath:h}=e,{toggleInatGrid:n}=e,{toggleInatTaxonRange:f}=e,{taxaHistory:_}=e,p=!1,w=Al(a,s),O=_.map(m=>m.taxon_id).indexOf(s.taxon_id),T=_[O].showInatTaxonRange,k=_[O].showInatGrid,S=w.length>1||w.length==1&&w[0].taxon_id==!s.taxon_id;const N=()=>t(6,p=!p);function P(){k=this.checked,t(8,k)}const D=()=>n(s.taxon_id);function U(){T=this.checked,t(7,T)}const $=()=>f(s.taxon_id);return l.$$set=m=>{"taxon"in m&&t(0,s=m.taxon),"taxa"in m&&t(11,a=m.taxa),"toggleTaxon"in m&&t(1,o=m.toggleTaxon),"removeTaxon"in m&&t(2,i=m.removeTaxon),"projectPath"in m&&t(3,h=m.projectPath),"toggleInatGrid"in m&&t(4,n=m.toggleInatGrid),"toggleInatTaxonRange"in m&&t(5,f=m.toggleInatTaxonRange),"taxaHistory"in m&&t(12,_=m.taxaHistory)},[s,o,i,h,n,f,p,T,k,w,S,a,_,N,P,D,U,$]}class sa extends vt{constructor(e){super();gt(this,e,aa,la,kt,{taxon:0,taxa:11,toggleTaxon:1,removeTaxon:2,projectPath:3,toggleInatGrid:4,toggleInatTaxonRange:5,taxaHistory:12})}}function oa(l){let e,t,s;return{c(){e=b("span"),this.h()},l(a){e=v(a,"SPAN",{class:!0,style:!0,title:!0}),g(e).forEach(c),this.h()},h(){u(e,"class","arrow right-arrow svelte-114h8ez"),ge(e,"top",l[2]),ge(e,"right",l[3]),u(e,"title","click to show more info"),K(e,"border",l[4]),K(e,"border-1",l[4]),K(e,"absolute",l[5]=="absolute")},m(a,o){C(a,e,o),t||(s=[ft(ht.call(null,e)),pe(e,"click",l[6])],t=!0)},p(a,o){o&4&&ge(e,"top",a[2]),o&8&&ge(e,"right",a[3]),o&16&&K(e,"border",a[4]),o&16&&K(e,"border-1",a[4]),o&32&&K(e,"absolute",a[5]=="absolute")},d(a){a&&c(e),t=!1,ot(s)}}}function ra(l){let e,t,s;return{c(){e=b("span"),this.h()},l(a){e=v(a,"SPAN",{class:!0,style:!0,title:!0}),g(e).forEach(c),this.h()},h(){u(e,"class","arrow left-arrow svelte-114h8ez"),ge(e,"top",l[2]),ge(e,"right",l[3]),u(e,"title","click to show less info"),K(e,"border",l[4]),K(e,"border-1",l[4]),K(e,"absolute",l[5]=="absolute")},m(a,o){C(a,e,o),t||(s=[ft(ht.call(null,e)),pe(e,"click",l[6])],t=!0)},p(a,o){o&4&&ge(e,"top",a[2]),o&8&&ge(e,"right",a[3]),o&16&&K(e,"border",a[4]),o&16&&K(e,"border-1",a[4]),o&32&&K(e,"absolute",a[5]=="absolute")},d(a){a&&c(e),t=!1,ot(s)}}}function ia(l){let e;function t(o,i){return o[0]?ca:na}let s=t(l),a=s(l);return{c(){a.c(),e=rt()},l(o){a.l(o),e=rt()},m(o,i){a.m(o,i),C(o,e,i)},p(o,i){s===(s=t(o))&&a?a.p(o,i):(a.d(1),a=s(o),a&&(a.c(),a.m(e.parentNode,e)))},d(o){a.d(o),o&&c(e)}}}function na(l){let e,t,s;return{c(){e=b("span"),this.h()},l(a){e=v(a,"SPAN",{class:!0,style:!0,title:!0}),g(e).forEach(c),this.h()},h(){u(e,"class","arrow up-arrow svelte-114h8ez"),ge(e,"top",l[2]),ge(e,"right",l[3]),u(e,"title","click to show more info"),K(e,"border",l[4]),K(e,"border-1",l[4]),K(e,"absolute",l[5]=="absolute")},m(a,o){C(a,e,o),t||(s=[ft(ht.call(null,e)),pe(e,"click",l[6])],t=!0)},p(a,o){o&4&&ge(e,"top",a[2]),o&8&&ge(e,"right",a[3]),o&16&&K(e,"border",a[4]),o&16&&K(e,"border-1",a[4]),o&32&&K(e,"absolute",a[5]=="absolute")},d(a){a&&c(e),t=!1,ot(s)}}}function ca(l){let e,t,s;return{c(){e=b("span"),this.h()},l(a){e=v(a,"SPAN",{class:!0,style:!0,title:!0}),g(e).forEach(c),this.h()},h(){u(e,"class","arrow down-arrow svelte-114h8ez"),ge(e,"top",l[2]),ge(e,"right",l[3]),u(e,"title","click to show less info"),K(e,"border",l[4]),K(e,"border-1",l[4]),K(e,"absolute",l[5]=="absolute")},m(a,o){C(a,e,o),t||(s=[ft(ht.call(null,e)),pe(e,"click",l[6])],t=!0)},p(a,o){o&4&&ge(e,"top",a[2]),o&8&&ge(e,"right",a[3]),o&16&&K(e,"border",a[4]),o&16&&K(e,"border-1",a[4]),o&32&&K(e,"absolute",a[5]=="absolute")},d(a){a&&c(e),t=!1,ot(s)}}}function fa(l){let e;function t(o,i){return o[1]==="upDown"?ia:o[0]?ra:oa}let s=t(l),a=s(l);return{c(){a.c(),e=rt()},l(o){a.l(o),e=rt()},m(o,i){a.m(o,i),C(o,e,i)},p(o,[i]){s===(s=t(o))&&a?a.p(o,i):(a.d(1),a=s(o),a&&(a.c(),a.m(e.parentNode,e)))},i:Re,o:Re,d(o){a.d(o),o&&c(e)}}}function ua(l,e,t){let{showMore:s=!1}=e,{format:a="upDown"}=e,{top:o=0}=e,{right:i=0}=e,{border:h}=e,{position:n="absolute"}=e;const f=Il();function _(){t(0,s=!s),f("toggleShowMore",{showMore:s})}return l.$$set=p=>{"showMore"in p&&t(0,s=p.showMore),"format"in p&&t(1,a=p.format),"top"in p&&t(2,o=p.top),"right"in p&&t(3,i=p.right),"border"in p&&t(4,h=p.border),"position"in p&&t(5,n=p.position)},[s,a,o,i,h,n,_]}class xt extends vt{constructor(e){super();gt(this,e,ua,fa,kt,{showMore:0,format:1,top:2,right:3,border:4,position:5})}}function ha(l){let e,t;return{c(){e=b("span"),t=M("\xD7"),this.h()},l(s){e=v(s,"SPAN",{"data-taxon-id":!0,class:!0});var a=g(e);t=z(a,"\xD7"),a.forEach(c),this.h()},h(){u(e,"data-taxon-id",l[0]),u(e,"class","svelte-tbkz2d")},m(s,a){C(s,e,a),r(e,t)},p(s,[a]){a&1&&u(e,"data-taxon-id",s[0])},i:Re,o:Re,d(s){s&&c(e)}}}function da(l,e,t){let{value:s=null}=e;return l.$$set=a=>{"value"in a&&t(0,s=a.value)},[s]}class _a extends vt{constructor(e){super();gt(this,e,da,ha,kt,{value:0})}}const ma="https://vega.github.io/schema/vega-lite/v5.json",pa="A faceted bar chart with labels, custom color and custon opacity.",ba={values:[]},va={field:"group",type:"nominal",title:null,header:{orient:"bottom"},sort:null},ga={width:{step:25},height:200,encoding:{y:{field:"yValue",type:"quantitative",title:"observations"},x:{field:"xValue",type:"nominal",title:null,sort:null,axis:{labelAngle:0,labelOverlap:!0}},opacity:{field:"opacity",type:"quantitative",scale:null}},layer:[{mark:{type:"bar"},encoding:{color:{field:"color",type:"nominal"}}},{mark:{type:"text",dx:0,angle:0,baseline:"bottom",align:"center",color:"#6b7280"},encoding:{text:{field:"yValue",type:"quantitative"}}}]},ka={facet:{columns:2},axis:{titleFontSize:14,labelFontSize:12,labelColor:"#333"},legend:{titleFontSize:14,labelFontSize:14,labelLimit:0,orient:"bottom",columns:1,labelColor:"#333"},header:{titleFontSize:14,labelFontSize:14,labelColor:"#333"},mark:{fontSize:12,color:"#333"},title:{fontSize:14,color:"#333"}},Ea={axis:{x:"independent",y:"independent"}};var wa={$schema:ma,description:pa,data:ba,facet:va,spec:ga,config:ka,resolve:Ea};function Ia(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/observations.csv":return je(()=>import("../../../../chunks/observations-300b979a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/observations.csv":return je(()=>import("../../../../chunks/observations-637c398b.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/observations.csv":return je(()=>import("../../../../chunks/observations-aedf9342.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/observations.csv":return je(()=>import("../../../../chunks/observations-c3886d39.js"),[]);case"../../../../lib/data/go-sea/observations.csv":return je(()=>import("../../../../chunks/observations-be764875.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/observations.csv":return je(()=>import("../../../../chunks/observations-627adcb7.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}function Sa(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/taxa.csv":return je(()=>import("../../../../chunks/taxa-f4c5fea7.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/taxa.csv":return je(()=>import("../../../../chunks/taxa-9108f66a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/taxa.csv":return je(()=>import("../../../../chunks/taxa-104f431f.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/taxa.csv":return je(()=>import("../../../../chunks/taxa-029efbae.js"),[]);case"../../../../lib/data/go-sea/taxa.csv":return je(()=>import("../../../../chunks/taxa-6068ec6b.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/taxa.csv":return je(()=>import("../../../../chunks/taxa-99749418.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}const{Map:Ta}=Ll;function $t(l,e,t){const s=l.slice();return s[66]=e[t],s}function el(l){let e,t,s,a,o,i,h,n,f,_=[],p=new Ta,w,O,T;function k(m){l[48](m)}let S={searchFunction:l[31],onChange:l[30],labelFieldName:"label",valueFieldName:"taxon_id",placeholder:"Search species name",hideArrow:!0};l[8]!==void 0&&(S.selectedItem=l[8]),s=new Dl({props:S}),yl.push(()=>Pl(s,"selectedItem",k));let N=l[5].length>3&&tl(l),P=l[10]&&ll(l),D=l[11]&&al(l),U=l[5];const $=m=>m[66].taxon_id;for(let m=0;m<U.length;m+=1){let I=$t(l,U,m),W=$(I);p.set(W,_[m]=sl(W,I))}return{c(){e=b("section"),t=b("div"),Le(s.$$.fragment),o=j(),N&&N.c(),i=j(),P&&P.c(),h=j(),D&&D.c(),n=j(),f=b("div");for(let m=0;m<_.length;m+=1)_[m].c();this.h()},l(m){e=v(m,"SECTION",{class:!0});var I=g(e);t=v(I,"DIV",{class:!0});var W=g(t);ze(s.$$.fragment,W),W.forEach(c),o=L(I),N&&N.l(I),i=L(I),P&&P.l(I),h=L(I),D&&D.l(I),n=L(I),f=v(I,"DIV",{class:!0});var se=g(f);for(let X=0;X<_.length;X+=1)_[X].l(se);se.forEach(c),I.forEach(c),this.h()},h(){u(t,"class","max-w-lg mb-4 autocomplete svelte-b1whqg"),u(f,"class","grid lg:grid-cols-1 md:grid-cols-2 sm:grid-cols-1 gap-2"),u(e,"class","px-3 mb-3")},m(m,I){C(m,e,I),r(e,t),Ae(s,t,null),r(e,o),N&&N.m(e,null),r(e,i),P&&P.m(e,null),r(e,h),D&&D.m(e,null),r(e,n),r(e,f);for(let W=0;W<_.length;W+=1)_[W].m(f,null);T=!0},p(m,I){const W={};!a&&I[0]&256&&(a=!0,W.selectedItem=m[8],Sl(()=>a=!1)),s.$set(W),m[5].length>3?N?N.p(m,I):(N=tl(m),N.c(),N.m(e,i)):N&&(N.d(1),N=null),m[10]?P?(P.p(m,I),I[0]&1024&&H(P,1)):(P=ll(m),P.c(),H(P,1),P.m(e,h)):P&&(Ue(),Q(P,1,1,()=>{P=null}),Be()),m[11]?D?(D.p(m,I),I[0]&2048&&H(D,1)):(D=al(m),D.c(),H(D,1),D.m(e,n)):D&&(Ue(),Q(D,1,1,()=>{D=null}),Be()),I[0]&56|I[1]&816&&(U=m[5],Ue(),_=Tl(_,I,$,1,m,U,p,f,jl,sl,null,$t),Be())},i(m){if(!T){H(s.$$.fragment,m),H(P),H(D);for(let I=0;I<U.length;I+=1)H(_[I]);$e(()=>{w||(w=Ve(f,Ie,{},!0)),w.run(1)}),$e(()=>{O||(O=Ve(e,Ie,{},!0)),O.run(1)}),T=!0}},o(m){Q(s.$$.fragment,m),Q(P),Q(D);for(let I=0;I<_.length;I+=1)Q(_[I]);w||(w=Ve(f,Ie,{},!1)),w.run(0),O||(O=Ve(e,Ie,{},!1)),O.run(0),T=!1},d(m){m&&c(e),Ne(s),N&&N.d(),P&&P.d(),D&&D.d();for(let I=0;I<_.length;I+=1)_[I].d();m&&w&&w.end(),m&&O&&O.end()}}}function tl(l){let e,t,s,a;return{c(){e=b("span"),t=M("Delete all"),this.h()},l(o){e=v(o,"SPAN",{class:!0});var i=g(e);t=z(i,"Delete all"),i.forEach(c),this.h()},h(){u(e,"class","btn btn-sm btn-outline mb-4 ")},m(o,i){C(o,e,i),r(e,t),s||(a=pe(e,"click",l[34]),s=!0)},p:Re,d(o){o&&c(e),s=!1,a()}}}function ll(l){let e,t,s,a,o,i,h,n,f;return{c(){e=b("label"),t=b("input"),s=j(),a=b("span"),o=M("Show 5 most observed species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var p=g(e);t=v(p,"INPUT",{type:!0,class:!0}),s=L(p),a=v(p,"SPAN",{});var w=g(a);o=z(w,"Show 5 most observed species"),w.forEach(c),p.forEach(c),this.h()},h(){u(t,"type","checkbox"),u(t,"class","mr-2"),u(e,"class","cursor-pointer block")},m(_,p){C(_,e,p),r(e,t),r(e,s),r(e,a),r(a,o),h=!0,n||(f=pe(t,"click",l[49]),n=!0)},p:Re,i(_){h||($e(()=>{i||(i=Ve(e,Ie,{},!0)),i.run(1)}),h=!0)},o(_){i||(i=Ve(e,Ie,{},!1)),i.run(0),h=!1},d(_){_&&c(e),_&&i&&i.end(),n=!1,f()}}}function al(l){let e,t,s,a,o,i,h,n,f;return{c(){e=b("label"),t=b("input"),s=j(),a=b("span"),o=M("Show indicator species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var p=g(e);t=v(p,"INPUT",{type:!0,class:!0}),s=L(p),a=v(p,"SPAN",{});var w=g(a);o=z(w,"Show indicator species"),w.forEach(c),p.forEach(c),this.h()},h(){u(t,"type","checkbox"),u(t,"class","mr-2"),u(e,"class","cursor-pointer block")},m(_,p){C(_,e,p),r(e,t),r(e,s),r(e,a),r(a,o),h=!0,n||(f=pe(t,"click",l[50]),n=!0)},p:Re,i(_){h||($e(()=>{i||(i=Ve(e,Ie,{},!0)),i.run(1)}),h=!0)},o(_){i||(i=Ve(e,Ie,{},!1)),i.run(0),h=!1},d(_){_&&c(e),_&&i&&i.end(),n=!1,f()}}}function sl(l,e){let t,s,a;return s=new sa({props:{taxa:e[3],taxon:e[66],toggleTaxon:e[36],removeTaxon:e[35],toggleInatGrid:e[39],toggleInatTaxonRange:e[40],projectPath:e[4],taxaHistory:e[5]}}),{key:l,first:null,c(){t=rt(),Le(s.$$.fragment),this.h()},l(o){t=rt(),ze(s.$$.fragment,o),this.h()},h(){this.first=t},m(o,i){C(o,t,i),Ae(s,o,i),a=!0},p(o,i){e=o;const h={};i[0]&8&&(h.taxa=e[3]),i[0]&32&&(h.taxon=e[66]),i[0]&16&&(h.projectPath=e[4]),i[0]&32&&(h.taxaHistory=e[5]),s.$set(h)},i(o){a||(H(s.$$.fragment,o),a=!0)},o(o){Q(s.$$.fragment,o),a=!1},d(o){o&&c(t),Ne(s,o)}}}function ol(l){let e,t,s,a,o,i,h,n,f,_,p,w=l[28]&&Oa(l);return{c(){e=b("section"),w&&w.c(),t=j(),s=b("label"),a=b("input"),o=j(),i=b("span"),h=M("Demo map layer"),this.h()},l(O){e=v(O,"SECTION",{class:!0});var T=g(e);w&&w.l(T),t=L(T),s=v(T,"LABEL",{class:!0});var k=g(s);a=v(k,"INPUT",{type:!0}),o=L(k),i=v(k,"SPAN",{});var S=g(i);h=z(S,"Demo map layer"),S.forEach(c),k.forEach(c),T.forEach(c),this.h()},h(){u(a,"type","checkbox"),u(s,"class","cursor-pointer block"),u(e,"class","px-3 mb-3")},m(O,T){C(O,e,T),w&&w.m(e,null),r(e,t),r(e,s),r(s,a),a.checked=l[13],r(s,o),r(s,i),r(i,h),f=!0,_||(p=pe(a,"change",l[53]),_=!0)},p(O,T){O[28]&&w.p(O,T),T[0]&8192&&(a.checked=O[13])},i(O){f||($e(()=>{n||(n=Ve(e,Ie,{},!0)),n.run(1)}),f=!0)},o(O){n||(n=Ve(e,Ie,{},!1)),n.run(0),f=!1},d(O){O&&c(e),w&&w.d(),O&&n&&n.end(),_=!1,p()}}}function Oa(l){let e,t,s,a,o,i,h;return{c(){e=b("label"),t=b("input"),s=j(),a=b("span"),o=M("Temperature and Preciptation"),this.h()},l(n){e=v(n,"LABEL",{class:!0});var f=g(e);t=v(f,"INPUT",{type:!0}),s=L(f),a=v(f,"SPAN",{});var _=g(a);o=z(_,"Temperature and Preciptation"),_.forEach(c),f.forEach(c),this.h()},h(){u(t,"type","checkbox"),u(e,"class","cursor-pointer block")},m(n,f){C(n,e,f),r(e,t),t.checked=l[12],r(e,s),r(e,a),r(a,o),i||(h=pe(t,"change",l[52]),i=!0)},p(n,f){f[0]&4096&&(t.checked=n[12])},d(n){n&&c(e),i=!1,h()}}}function rl(l){let e,t,s,a,o,i;return{c(){e=b("span"),t=M("*"),this.h()},l(h){e=v(h,"SPAN",{class:!0,title:!0});var n=g(e);t=z(n,"*"),n.forEach(c),this.h()},h(){u(e,"class","text-red-600"),u(e,"title",s="Since there are over "+yt+" observations on the map, the map uses clustered markers.")},m(h,n){C(h,e,n),r(e,t),o||(i=ft(a=ht.call(null,e)),o=!0)},p:Re,d(h){h&&c(e),o=!1,i()}}}function il(l){let e,t,s,a;return e=new Cl({}),{c(){Le(e.$$.fragment),t=j(),s=b("div"),this.h()},l(o){ze(e.$$.fragment,o),t=L(o),s=v(o,"DIV",{class:!0,style:!0}),g(s).forEach(c),this.h()},h(){u(s,"class","bg-gray-100"),ge(s,"width","100%"),ge(s,"height","75vh")},m(o,i){Ae(e,o,i),C(o,t,i),C(o,s,i),a=!0},i(o){a||(H(e.$$.fragment,o),a=!0)},o(o){Q(e.$$.fragment,o),a=!1},d(o){Ne(e,o),o&&c(t),o&&c(s)}}}function nl(l){let e,t,s,a,o,i,h,n,f,_,p;s=new _a({});function w(k,S){return k[16].image_url?ya:Da}let O=w(l),T=O(l);return h=new Ml({props:{observation:l[16],projectPath:l[4],compactLayout:!0}}),h.$on("zoomToObservation",l[41]),{c(){e=b("div"),t=b("span"),Le(s.$$.fragment),a=j(),o=b("section"),T.c(),i=j(),Le(h.$$.fragment),this.h()},l(k){e=v(k,"DIV",{class:!0});var S=g(e);t=v(S,"SPAN",{class:!0});var N=g(t);ze(s.$$.fragment,N),N.forEach(c),a=L(S),o=v(S,"SECTION",{class:!0});var P=g(o);T.l(P),i=L(P),ze(h.$$.fragment,P),P.forEach(c),S.forEach(c),this.h()},h(){u(t,"class","close-button cursor-pointer svelte-b1whqg"),u(o,"class","px-3 mb-3"),u(e,"class","absolute observation-container bg-white text-sm overflow-auto svelte-b1whqg")},m(k,S){C(k,e,S),r(e,t),Ae(s,t,null),r(e,a),r(e,o),T.m(o,null),r(o,i),Ae(h,o,null),f=!0,_||(p=pe(t,"click",l[54]),_=!0)},p(k,S){O===(O=w(k))&&T?T.p(k,S):(T.d(1),T=O(k),T&&(T.c(),T.m(o,i)));const N={};S[0]&65536&&(N.observation=k[16]),S[0]&16&&(N.projectPath=k[4]),h.$set(N)},i(k){f||(H(s.$$.fragment,k),H(h.$$.fragment,k),$e(()=>{n||(n=Ve(o,Ie,{},!0)),n.run(1)}),f=!0)},o(k){Q(s.$$.fragment,k),Q(h.$$.fragment,k),n||(n=Ve(o,Ie,{},!1)),n.run(0),f=!1},d(k){k&&c(e),Ne(s),T.d(),Ne(h),k&&n&&n.end(),_=!1,p()}}}function Da(l){let e,t;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){u(e,"class","float-right lg:float-none svelte-b1whqg"),et(e.src,t=""+(ut+"/images/missing-image.png"))||u(e,"src",t),u(e,"alt","")},m(s,a){C(s,e,a)},p:Re,d(s){s&&c(e)}}}function ya(l){let e,t,s;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){et(e.src,t=l[16].image_url.replace("medium","small"))||u(e,"src",t),u(e,"alt",s="photo of "+Et(l[16])),u(e,"class","svelte-b1whqg")},m(a,o){C(a,e,o)},p(a,o){o[0]&65536&&!et(e.src,t=a[16].image_url.replace("medium","small"))&&u(e,"src",t),o[0]&65536&&s!==(s="photo of "+Et(a[16]))&&u(e,"alt",s)},d(a){a&&c(e)}}}function cl(l){let e,t,s,a,o,i,h;return{c(){e=b("label"),t=b("input"),s=j(),a=b("span"),o=M("Update charts as map changes"),this.h()},l(n){e=v(n,"LABEL",{class:!0});var f=g(e);t=v(f,"INPUT",{type:!0}),s=L(f),a=v(f,"SPAN",{});var _=g(a);o=z(_,"Update charts as map changes"),_.forEach(c),f.forEach(c),this.h()},h(){u(t,"type","checkbox"),u(e,"class","cursor-pointer mt-2 mr-3 inline-block")},m(n,f){C(n,e,f),r(e,t),t.checked=l[7],r(e,s),r(e,a),r(a,o),i||(h=pe(t,"change",l[55]),i=!0)},p(n,f){f[0]&128&&(t.checked=n[7])},d(n){n&&c(e),i=!1,h()}}}function fl(l){let e,t,s,a,o,i,h;return{c(){e=b("label"),t=b("input"),s=j(),a=b("span"),o=M("Show species list"),this.h()},l(n){e=v(n,"LABEL",{class:!0});var f=g(e);t=v(f,"INPUT",{type:!0}),s=L(f),a=v(f,"SPAN",{});var _=g(a);o=z(_,"Show species list"),_.forEach(c),f.forEach(c),this.h()},h(){u(t,"type","checkbox"),u(e,"class","cursor-pointer mt-2 inline-block")},m(n,f){C(n,e,f),r(e,t),t.checked=l[22],r(e,s),r(e,a),r(a,o),i||(h=pe(t,"change",l[56]),i=!0)},p(n,f){f[0]&4194304&&(t.checked=n[22])},d(n){n&&c(e),i=!1,h()}}}function ul(l){let e,t,s;return t=new Kl({props:{mapOptions:l[29],selectTimeSpanHandler:l[38],groupedObservations:l[9],toggleTimeSpans:l[37],timeSpanHistory:l[6],activeTaxaCount:l[5].filter(pl).length}}),{c(){e=b("section"),Le(t.$$.fragment)},l(a){e=v(a,"SECTION",{});var o=g(e);ze(t.$$.fragment,o),o.forEach(c)},m(a,o){C(a,e,o),Ae(t,e,null),s=!0},p(a,o){const i={};o[0]&512&&(i.groupedObservations=a[9]),o[0]&64&&(i.timeSpanHistory=a[6]),o[0]&32&&(i.activeTaxaCount=a[5].filter(pl).length),t.$set(i)},i(a){s||(H(t.$$.fragment,a),s=!0)},o(a){Q(t.$$.fragment,a),s=!1},d(a){a&&c(e),Ne(t)}}}function hl(l){let e;return{c(){e=b("div"),this.h()},l(t){e=v(t,"DIV",{id:!0,class:!0}),g(e).forEach(c),this.h()},h(){u(e,"id","ed-chart"),u(e,"class","w-full mt-4")},m(t,s){C(t,e,s)},d(t){t&&c(e)}}}function dl(l){let e,t,s,a,o,i;return{c(){e=b("h3"),t=M("Temperature and Preciptation"),s=j(),a=b("img"),this.h()},l(h){e=v(h,"H3",{class:!0});var n=g(e);t=z(n,"Temperature and Preciptation"),n.forEach(c),s=L(h),a=v(h,"IMG",{src:!0,alt:!0}),this.h()},h(){u(e,"class","text-center"),et(a.src,o=""+(ut+"/images/"+l[1].username+"/"+l[0].slug+"/climate-chart.png"))||u(a,"src",o),u(a,"alt",i="climate chart for "+l[0].location)},m(h,n){C(h,e,n),r(e,t),C(h,s,n),C(h,a,n)},p(h,n){n[0]&3&&!et(a.src,o=""+(ut+"/images/"+h[1].username+"/"+h[0].slug+"/climate-chart.png"))&&u(a,"src",o),n[0]&1&&i!==(i="climate chart for "+h[0].location)&&u(a,"alt",i)},d(h){h&&c(e),h&&c(s),h&&c(a)}}}function Pa(l){let e,t,s=l[2].label+"",a,o,i,h,n,f,_,p,w,O,T,k,S,N,P,D,U,$,m,I,W,se,X,ke,oe,te,Pe,ne,F,R,he,de,Se,Te,fe,Z,Oe,_e,be,De,Ee,ee,x,Y,we,Ce,me,G,Fe,Ye,J,qe,Je,Xe,lt,tt,He,nt,at,st,Me;p=new xt({props:{showMore:!0,position:"normal"}}),p.$on("toggleShowMore",l[47]);let re=l[25]&&el(l);S=new xt({props:{showMore:!0,position:"normal"}}),S.$on("toggleShowMore",l[51]);let ie=l[26]&&ol(l),ve=l[18]>=yt&&rl(),ce=l[15]&&l[14]&&il();var d=l[27];function A(E){return{props:{mapOptions:E[29],groupedObservations:E[9],timeSpanHistory:E[6],showDemoMapLayer:E[13],taxaHistory:E[5],mapCenter:E[23],country:E[0].country}}}d&&(G=new d(A(l)),G.$on("markerClick",l[43]),G.$on("updateStats",l[42]));let V=l[24]&&nl(l),y=l[5].length>0&&cl(l),q=l[5].length>0&&fl(l);He=new Yl({props:{showSpeciesList:l[22],speciesList:l[21]}});let le=l[5].length>0&&ul(l),ae=l[5].length>0&&hl(),ue=l[12]&&dl(l);return{c(){e=b("div"),t=b("h1"),a=M(s),o=j(),i=b("div"),h=b("div"),n=b("div"),f=b("h3"),_=M(`Biodiversity
          `),Le(p.$$.fragment),w=j(),re&&re.c(),O=j(),T=b("h3"),k=M(`Environmental Factors
          `),Le(S.$$.fragment),N=j(),ie&&ie.c(),P=j(),D=b("div"),U=b("div"),$=b("div"),m=b("div"),I=M("Observations"),W=j(),se=b("div"),X=M(l[17]),ke=j(),oe=b("div"),te=b("div"),Pe=M(`Observations on map
            `),ve&&ve.c(),ne=j(),F=b("div"),R=M(l[18]),he=j(),de=b("div"),Se=b("div"),Te=M("Species"),fe=j(),Z=b("div"),Oe=M(l[19]),_e=j(),be=b("div"),De=b("div"),Ee=M("Species on map"),ee=j(),x=b("div"),Y=M(l[20]),we=j(),ce&&ce.c(),Ce=j(),me=b("div"),G&&Le(G.$$.fragment),Fe=j(),V&&V.c(),Ye=j(),J=b("div"),y&&y.c(),qe=j(),q&&q.c(),Je=j(),Xe=b("br"),lt=j(),tt=b("section"),Le(He.$$.fragment),nt=j(),le&&le.c(),at=j(),ae&&ae.c(),st=j(),ue&&ue.c(),this.h()},l(E){e=v(E,"DIV",{class:!0});var B=g(e);t=v(B,"H1",{class:!0});var Ge=g(t);a=z(Ge,s),Ge.forEach(c),o=L(B),i=v(B,"DIV",{class:!0});var Ke=g(i);h=v(Ke,"DIV",{class:!0});var ct=g(h);n=v(ct,"DIV",{class:!0});var Qe=g(n);f=v(Qe,"H3",{class:!0});var wt=g(f);_=z(wt,`Biodiversity
          `),ze(p.$$.fragment,wt),wt.forEach(c),w=L(Qe),re&&re.l(Qe),O=L(Qe),T=v(Qe,"H3",{class:!0});var It=g(T);k=z(It,`Environmental Factors
          `),ze(S.$$.fragment,It),It.forEach(c),N=L(Qe),ie&&ie.l(Qe),Qe.forEach(c),ct.forEach(c),P=L(Ke),D=v(Ke,"DIV",{class:!0});var We=g(D);U=v(We,"DIV",{class:!0});var Ze=g(U);$=v(Ze,"DIV",{class:!0});var dt=g($);m=v(dt,"DIV",{class:!0});var Pt=g(m);I=z(Pt,"Observations"),Pt.forEach(c),W=L(dt),se=v(dt,"DIV",{class:!0});var jt=g(se);X=z(jt,l[17]),jt.forEach(c),dt.forEach(c),ke=L(Ze),oe=v(Ze,"DIV",{class:!0});var _t=g(oe);te=v(_t,"DIV",{class:!0});var St=g(te);Pe=z(St,`Observations on map
            `),ve&&ve.l(St),St.forEach(c),ne=L(_t),F=v(_t,"DIV",{class:!0});var Lt=g(F);R=z(Lt,l[18]),Lt.forEach(c),_t.forEach(c),he=L(Ze),de=v(Ze,"DIV",{class:!0});var mt=g(de);Se=v(mt,"DIV",{class:!0});var At=g(Se);Te=z(At,"Species"),At.forEach(c),fe=L(mt),Z=v(mt,"DIV",{class:!0});var Nt=g(Z);Oe=z(Nt,l[19]),Nt.forEach(c),mt.forEach(c),_e=L(Ze),be=v(Ze,"DIV",{class:!0});var pt=g(be);De=v(pt,"DIV",{class:!0});var Vt=g(De);Ee=z(Vt,"Species on map"),Vt.forEach(c),ee=L(pt),x=v(pt,"DIV",{class:!0});var Ct=g(x);Y=z(Ct,l[20]),Ct.forEach(c),pt.forEach(c),Ze.forEach(c),we=L(We),ce&&ce.l(We),Ce=L(We),me=v(We,"DIV",{class:!0});var bt=g(me);G&&ze(G.$$.fragment,bt),Fe=L(bt),V&&V.l(bt),bt.forEach(c),Ye=L(We),J=v(We,"DIV",{class:!0});var ye=g(J);y&&y.l(ye),qe=L(ye),q&&q.l(ye),Je=L(ye),Xe=v(ye,"BR",{}),lt=L(ye),tt=v(ye,"SECTION",{});var Mt=g(tt);ze(He.$$.fragment,Mt),Mt.forEach(c),nt=L(ye),le&&le.l(ye),at=L(ye),ae&&ae.l(ye),st=L(ye),ue&&ue.l(ye),ye.forEach(c),We.forEach(c),Ke.forEach(c),B.forEach(c),this.h()},h(){u(t,"class","px-3"),u(f,"class","bg-gray-200 mt-0 px-3 py-1"),u(T,"class","bg-gray-200 mt-0 px-3 py-1"),u(n,"class","grid"),u(h,"class","lg:col-span-3 border-0 lg:border-r-2 border-t"),u(m,"class","stat-title svelte-b1whqg"),u(se,"class","stat-value svelte-b1whqg"),u($,"class","stat place-items-center place-content-center svelte-b1whqg"),u(te,"class","stat-title svelte-b1whqg"),u(F,"class","stat-value svelte-b1whqg"),u(oe,"class","stat place-items-center place-content-center svelte-b1whqg"),u(Se,"class","stat-title svelte-b1whqg"),u(Z,"class","stat-value svelte-b1whqg"),u(de,"class","stat place-items-center place-content-center svelte-b1whqg"),u(De,"class","stat-title svelte-b1whqg"),u(x,"class","stat-value svelte-b1whqg"),u(be,"class","stat place-items-center place-content-center svelte-b1whqg"),u(U,"class","w-full rounded-none border stats"),u(me,"class","relative"),u(J,"class","px-3"),u(D,"class","lg:col-span-7"),u(i,"class","grid lg:grid-cols-10 mb-6"),u(e,"class","prose max-w-none")},m(E,B){C(E,e,B),r(e,t),r(t,a),r(e,o),r(e,i),r(i,h),r(h,n),r(n,f),r(f,_),Ae(p,f,null),r(n,w),re&&re.m(n,null),r(n,O),r(n,T),r(T,k),Ae(S,T,null),r(n,N),ie&&ie.m(n,null),r(i,P),r(i,D),r(D,U),r(U,$),r($,m),r(m,I),r($,W),r($,se),r(se,X),r(U,ke),r(U,oe),r(oe,te),r(te,Pe),ve&&ve.m(te,null),r(oe,ne),r(oe,F),r(F,R),r(U,he),r(U,de),r(de,Se),r(Se,Te),r(de,fe),r(de,Z),r(Z,Oe),r(U,_e),r(U,be),r(be,De),r(De,Ee),r(be,ee),r(be,x),r(x,Y),r(D,we),ce&&ce.m(D,null),r(D,Ce),r(D,me),G&&Ae(G,me,null),r(me,Fe),V&&V.m(me,null),r(D,Ye),r(D,J),y&&y.m(J,null),r(J,qe),q&&q.m(J,null),r(J,Je),r(J,Xe),r(J,lt),r(J,tt),Ae(He,tt,null),r(J,nt),le&&le.m(J,null),r(J,at),ae&&ae.m(J,null),r(J,st),ue&&ue.m(J,null),Me=!0},p(E,B){(!Me||B[0]&4)&&s!==(s=E[2].label+"")&&xe(a,s),E[25]?re?(re.p(E,B),B[0]&33554432&&H(re,1)):(re=el(E),re.c(),H(re,1),re.m(n,O)):re&&(Ue(),Q(re,1,1,()=>{re=null}),Be()),E[26]?ie?(ie.p(E,B),B[0]&67108864&&H(ie,1)):(ie=ol(E),ie.c(),H(ie,1),ie.m(n,null)):ie&&(Ue(),Q(ie,1,1,()=>{ie=null}),Be()),(!Me||B[0]&131072)&&xe(X,E[17]),E[18]>=yt?ve?ve.p(E,B):(ve=rl(),ve.c(),ve.m(te,null)):ve&&(ve.d(1),ve=null),(!Me||B[0]&262144)&&xe(R,E[18]),(!Me||B[0]&524288)&&xe(Oe,E[19]),(!Me||B[0]&1048576)&&xe(Y,E[20]),E[15]&&E[14]?ce?B[0]&49152&&H(ce,1):(ce=il(),ce.c(),H(ce,1),ce.m(D,Ce)):ce&&(Ue(),Q(ce,1,1,()=>{ce=null}),Be());const Ge={};if(B[0]&512&&(Ge.groupedObservations=E[9]),B[0]&64&&(Ge.timeSpanHistory=E[6]),B[0]&8192&&(Ge.showDemoMapLayer=E[13]),B[0]&32&&(Ge.taxaHistory=E[5]),B[0]&8388608&&(Ge.mapCenter=E[23]),B[0]&1&&(Ge.country=E[0].country),d!==(d=E[27])){if(G){Ue();const ct=G;Q(ct.$$.fragment,1,0,()=>{Ne(ct,1)}),Be()}d?(G=new d(A(E)),G.$on("markerClick",E[43]),G.$on("updateStats",E[42]),Le(G.$$.fragment),H(G.$$.fragment,1),Ae(G,me,Fe)):G=null}else d&&G.$set(Ge);E[24]?V?(V.p(E,B),B[0]&16777216&&H(V,1)):(V=nl(E),V.c(),H(V,1),V.m(me,null)):V&&(Ue(),Q(V,1,1,()=>{V=null}),Be()),E[5].length>0?y?y.p(E,B):(y=cl(E),y.c(),y.m(J,qe)):y&&(y.d(1),y=null),E[5].length>0?q?q.p(E,B):(q=fl(E),q.c(),q.m(J,Je)):q&&(q.d(1),q=null);const Ke={};B[0]&4194304&&(Ke.showSpeciesList=E[22]),B[0]&2097152&&(Ke.speciesList=E[21]),He.$set(Ke),E[5].length>0?le?(le.p(E,B),B[0]&32&&H(le,1)):(le=ul(E),le.c(),H(le,1),le.m(J,at)):le&&(Ue(),Q(le,1,1,()=>{le=null}),Be()),E[5].length>0?ae||(ae=hl(),ae.c(),ae.m(J,st)):ae&&(ae.d(1),ae=null),E[12]?ue?ue.p(E,B):(ue=dl(E),ue.c(),ue.m(J,null)):ue&&(ue.d(1),ue=null)},i(E){Me||(H(p.$$.fragment,E),H(re),H(S.$$.fragment,E),H(ie),H(ce),G&&H(G.$$.fragment,E),H(V),H(He.$$.fragment,E),H(le),Me=!0)},o(E){Q(p.$$.fragment,E),Q(re),Q(S.$$.fragment,E),Q(ie),Q(ce),G&&Q(G.$$.fragment,E),Q(V),Q(He.$$.fragment,E),Q(le),Me=!1},d(E){E&&c(e),Ne(p),re&&re.d(),Ne(S),ie&&ie.d(),ve&&ve.d(),ce&&ce.d(),G&&Ne(G),V&&V.d(),y&&y.d(),q&&q.d(),Ne(He),le&&le.d(),ae&&ae.d(),ue&&ue.d()}}}async function Ga({params:l,url:e}){let t=Ul.filter(p=>p.username===l.users)[0],s=t.projects.filter(p=>p.slug===l.projects)[0],a=e.pathname.split("/"),o=s.tabs_project.filter(p=>p.link===a[a.length-1])[0],i=`${ut}/users/${t.username}/${s.slug}`,h=await Sa(`../../../../lib/data/${l.projects}/taxa.csv`),n=Nl(h.default),f=await Ia(`../../../../lib/data/${l.projects}/observations.csv`),_=Vl(f.default);return{props:{project:s,user:t,currentTab:o,projectObservations:_,taxa:n,projectPath:i}}}let it=.25,yt=1e3,_l="#ed-chart",ml="oldest";const pl=l=>l.active;function ja(l,e,t){let{project:s}=e,{user:a}=e,{currentTab:o}=e,{projectObservations:i}=e,{taxa:h}=e,{projectPath:n}=e,f="",_={},p=new Set,w=new Set,O=[],T=[],k=[],S={},N=s.slug!=="los-angeles-bioblitz",P=s.slug==="los-angeles-bioblitz",D=!1,U=!1,$=0,m=!1,I=!1,W=JSON.parse(JSON.stringify(Xl)),se=JSON.parse(JSON.stringify(wa)),X,ke=0,oe=0,te=0,Pe=0,ne=[],F=!1,R={},he=!1,de=!1,Se=!0,Te=!0,fe=s.slug!=="go-sea";i=i.filter(d=>d.latitude&&d.longitude);let Z=Ot(Tt({},Bl),{zoom:s.zoom,latitude:s.latitude,longitude:s.longitude,observationsTimeSpan:"all",colorSchemeMonth:Array(12).fill(Dt),colorSchemeYear:[Dt],defaultColor:Dt,monthSeasonalMarkers:!1,center:[s.latitude||0,s.longitude||0],preferCanvas:!0});function Oe(d){!d||!d.label||(t(10,N=!1),t(11,P=!1),!(k.filter(A=>A.taxon_id==d.taxon_id).length>0)&&($+=1,t(14,m=!0),setTimeout(()=>{Ee(d)},100)))}async function _e(d){if(d.length>2)return await zl(h,d)}function be(){t(10,N=!1),h.filter(d=>d.rank==="species").sort((d,A)=>A.taxa_count-d.taxa_count).slice(0,5).forEach(d=>{$+=1,Ee(d)})}function De(){t(11,P=!1),h.filter(d=>d.taxon_group&&d.observations_count>0).sort((d,A)=>A.taxa_count-d.taxa_count).forEach(d=>{$+=1,Ee(d)})}function Ee(d){t(14,m=!0);let A=Rl($,Z.colorScheme.length),V=ql(i,d.taxon_id,Z.colorScheme[A]);V.forEach(ae=>{t(45,_[ae.id]=ae,_),p.add(ae.id),w.add(ae.id)}),t(9,O=we()),me("addObservationsForTaxon"),t(16,X=V[0]);let y=Fl(d.taxon_id),q=Z.colorScheme[A],le=Hl(q,10);t(5,k=k.concat({taxon_name:Et(d),image_url:d.image_url,taxa_count:d.taxa_count,taxon_id:d.taxon_id,color:q,rank:d.rank,active:!0,observationIds:V.map(ae=>ae.id),showInatGrid:!1,InatGridUrl:`${y.InatGrid.url}&color=%23${le}`,showInatTaxonRange:!1,InatTaxonRangeUrl:`${y.InatTaxonRange.url}?color=%23${le}`})),Z.observationsTimeSpan!=="all"&&O.forEach((ae,ue)=>t(6,S[ue]=S[ue]!==void 0?S[ue]:!0,S)),t(14,m=!1)}function ee(){t(8,f=""),t(45,_={}),p=new Set,w=new Set,t(9,O=[]),t(46,T=[]),t(5,k=[]),t(6,S={}),me("resetTaxa")}function x(d){t(14,m=!0);let A=Number(d.target.dataset.taxonId);w=new Set,p=new Set,t(5,k=k.filter(y=>(y.taxon_id!==A&&(y.active?y.observationIds.forEach(q=>{Ce(y.color,q),w.add(q),p.add(q)}):y.observationIds.forEach(q=>{p.add(q)})),y.taxon_id!==A))),t(24,de=p.has(X.id));let V={};p.forEach(y=>V[y]=_[y]),t(45,_=V),me("removeTaxon"),t(9,O=we()),me("removeTaxon"),Object.keys(S).forEach(y=>{O.has(Number(y))||delete S[y]}),t(14,m=!1)}function Y(d){t(14,m=!0);let A=Number(d.target.dataset.taxonId);if(!A)return;let V=!0;if(t(14,m=!0),t(5,k=k.map(y=>y.taxon_id===A?(V=!y.active,Ot(Tt({},y),{active:!y.active})):y)),V){let y=k.filter(q=>q.taxon_id===A)[0];y.observationIds.forEach(q=>{Ce(y.color,q),w.add(q)})}else w=new Set,k.forEach(y=>{y.taxon_id!==A&&y.active&&y.observationIds.forEach(q=>{Ce(y.color,q),w.add(q)})});t(9,O=we()),Z.observationsTimeSpan!=="all"&&(Object.keys(S).forEach(y=>{O.has(Number(y))||delete S[y]}),O.forEach((y,q)=>{t(6,S[q]=S[q]!==void 0?S[q]:!0,S)})),me("toggleTaxon"),t(14,m=!1)}function we(){let d=[...w].map(A=>_[A]);return d=Bt(d,ml,Z.observationsTimeSpan),Ut(d,Z.observationsTimeSpan)}function Ce(d,A){let V=_[A];V.color=d,V.fillColor=d}function me(d){console.log(d,`observations: ${Object.keys(_).length}`,`observationIds: ${p.size}`,`activeObservationsIds: ${w.size}`)}function G(d){t(6,S=Gl(d,S))}function Fe(){t(14,m=!0);let d=Bt(Object.values(_).filter(A=>w.has(A.id)),ml,Z.observationsTimeSpan);t(9,O=Ut(d,Z.observationsTimeSpan)),t(6,S={}),Z.observationsTimeSpan!=="all"&&O.forEach((A,V)=>t(6,S[V]=!0,S)),t(14,m=!1)}function Ye(d){let A=k.map(V=>V.taxon_id).indexOf(d);t(5,k[A].showInatGrid=!k[A].showInatGrid,k)}function J(d){let A=k.map(V=>V.taxon_id).indexOf(d);t(5,k[A].showInatTaxonRange=!k[A].showInatTaxonRange,k)}function qe(d){t(23,R=d.detail)}function Je(d){t(18,oe=d.detail.observationsOnMapCount),t(17,ke=d.detail.observationsSelectedCount),t(19,te=d.detail.speciesCount),t(20,Pe=d.detail.speciesDisplayCount),t(21,ne=d.detail.speciesList);let A=d.detail.observationsOnMap;Array.isArray(A)?t(46,T=A):(t(46,T=[]),A.forEach((V,y)=>{t(46,T=T.concat(V))}))}function Xe(d){t(24,de=!0),t(16,X=_[d.detail.observation_id])}let lt;Ol(async()=>{const d=await je(()=>import("../../../../chunks/explore_data_map-aaa5bda3.js"),["chunks/explore_data_map-aaa5bda3.js","chunks/vendor-ac733917.js","assets/vendor-9877410d.css","chunks/index-0ee43062.js","assets/index-a02ee4b4.css","chunks/mapUtils-e9636914.js","chunks/observation_data-90cf8ccf.js","assets/observation_data-f8b72239.css","chunks/formatUtils-77b182ad.js","chunks/constants-3d7024b8.js","chunks/map_toggle_marker_type_button-8e34cd5a.js","chunks/TileLayer-dc3005ae.js","chunks/CircleMarker-a705a7f9.js"]);t(27,lt=d.default),t(14,m=!1),t(15,I=!0)});const tt=d=>t(25,Se=d.detail.showMore);function He(d){f=d,t(8,f)}const nt=()=>be(),at=()=>De(),st=d=>t(26,Te=d.detail.showMore);function Me(){D=this.checked,t(12,D)}function re(){U=this.checked,t(13,U)}const ie=()=>t(24,de=!1);function ve(){he=this.checked,t(7,he)}function ce(){F=this.checked,t(22,F)}return l.$$set=d=>{"project"in d&&t(0,s=d.project),"user"in d&&t(1,a=d.user),"currentTab"in d&&t(2,o=d.currentTab),"projectObservations"in d&&t(44,i=d.projectObservations),"taxa"in d&&t(3,h=d.taxa),"projectPath"in d&&t(4,n=d.projectPath)},l.$$.update=()=>{if(l.$$.dirty[0]&33&&k.length===0&&(t(10,N=s.slug!=="los-angeles-bioblitz"),t(11,P=s.slug==="los-angeles-bioblitz"),t(6,S={}),t(16,X=null)),l.$$.dirty[0]&225|l.$$.dirty[1]&32768&&k.length>0&&he){let d=T,A;Z.observationsTimeSpan=="all"?A=Jt(W,it,k,d,s):Z.observationsTimeSpan=="month"?A=Yt(se,it,k,S,d,s):A=Xt(se,it,k,S,d,s),Kt(A,_l)}if(l.$$.dirty[0]&225|l.$$.dirty[1]&16384&&k.length>0&&!he){let d=Object.values(_),A;Z.observationsTimeSpan=="all"?A=Jt(W,it,k,d,s):Z.observationsTimeSpan=="month"?A=Yt(se,it,k,S,d,s):A=Xt(se,it,k,S,d,s),Kt(A,_l)}},[s,a,o,h,n,k,S,he,f,O,N,P,D,U,m,I,X,ke,oe,te,Pe,ne,F,R,de,Se,Te,lt,fe,Z,Oe,_e,be,De,ee,x,Y,G,Fe,Ye,J,qe,Je,Xe,i,_,T,tt,He,nt,at,st,Me,re,ie,ve,ce]}class Ua extends vt{constructor(e){super();gt(this,e,ja,Pa,kt,{project:0,user:1,currentTab:2,projectObservations:44,taxa:3,projectPath:4},null,[-1,-1,-1])}}export{Ua as default,Ga as load};
