var dl=Object.defineProperty,hl=Object.defineProperties;var ml=Object.getOwnPropertyDescriptors;var Mt=Object.getOwnPropertySymbols;var pl=Object.prototype.hasOwnProperty,bl=Object.prototype.propertyIsEnumerable;var Nt=(l,e,t)=>e in l?dl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,wt=(l,e)=>{for(var t in e||(e={}))pl.call(e,t)&&Nt(l,t,e[t]);if(Mt)for(var t of Mt(e))bl.call(e,t)&&Nt(l,t,e[t]);return l},It=(l,e)=>hl(l,ml(e));import{_ as Ge}from"../../../../chunks/preload-helper-768eda0e.js";import{S as mt,i as pt,s as bt,e as b,t as G,k as L,c as v,a as k,g as U,d as n,n as A,b as d,M as W,f as C,E as i,P as ue,h as We,Q as Ze,R as Ct,T as Vt,U as Je,j as Oe,m as Ae,o as De,V as zt,x as N,r as Ve,u as B,w as ze,v as je,I as Me,K as vl,W as we,J as xe,l as $e,X as gl,N as pe,Y as tt,Z as kl,_ as Re,$ as El,A as wl,a0 as Il,a1 as Sl,a2 as Tl,a3 as Ol,a4 as Dl}from"../../../../chunks/vendor-a1a75673.js";import{b as it}from"../../../../chunks/paths-28a87002.js";import{g as jl,f as yl,a as Pl,L as Ll,O as Al,b as Ml,m as Nl,c as Cl,d as Rt,l as Vl,s as Ht,u as zl}from"../../../../chunks/observation_data-2b3f5cba.js";import{s as Rl}from"../../../../chunks/settings-ef690396.js";import{d as Hl,a as St,g as Gl}from"../../../../chunks/mapUtils-e9636914.js";import{p as Gt,f as vt}from"../../../../chunks/formatUtils-77b182ad.js";import{C as Ul,t as lt,M as Bl,b as Fl,s as Ut,a as Bt,c as Ft,d as qt,I as Jt,e as ql}from"../../../../chunks/bar_chart-b6332b1b.js";import"../../../../chunks/constants-3d7024b8.js";function Yt(l,e,t){const a=l.slice();return a[19]=e[t],a}function Jl(l){let e,t;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{src:!0,alt:!0}),this.h()},h(){xe(e.src,t=""+(it+"/images/missing-image.png"))||d(e,"src",t),d(e,"alt","")},m(a,s){C(a,e,s)},p:Me,d(a){a&&n(e)}}}function Yl(l){let e,t,a;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{src:!0,alt:!0}),this.h()},h(){xe(e.src,t=l[0].image_url.replace("medium","square"))||d(e,"src",t),d(e,"alt",a="photo of "+l[0].taxon_name)},m(s,o){C(s,e,o)},p(s,o){o&1&&!xe(e.src,t=s[0].image_url.replace("medium","square"))&&d(e,"src",t),o&1&&a!==(a="photo of "+s[0].taxon_name)&&d(e,"alt",a)},d(s){s&&n(e)}}}function Xl(l){let e;return{c(){e=G("More")},l(t){e=U(t,"More")},m(t,a){C(t,e,a)},d(t){t&&n(e)}}}function Kl(l){let e;return{c(){e=G("Less")},l(t){e=U(t,"Less")},m(t,a){C(t,e,a)},d(t){t&&n(e)}}}function Ql(l){let e;return{c(){e=G("Show")},l(t){e=U(t,"Show")},m(t,a){C(t,e,a)},d(t){t&&n(e)}}}function Wl(l){let e;return{c(){e=G("Hide")},l(t){e=U(t,"Hide")},m(t,a){C(t,e,a)},d(t){t&&n(e)}}}function Xt(l){let e,t,a,s,o,r,f,c,p,_,h,S=l[0].rank+"",P,y,E,D,j,O,T,V,q,m,w,Q,ee,K,be,te,$,ye,oe=l[10]&&Zl(l);return{c(){e=b("div"),t=b("dl"),a=b("dt"),s=G("link"),o=b("dd"),r=b("a"),f=G("Species page"),p=b("dt"),_=G("taxonomic rank"),h=b("dd"),P=G(S),y=L(),E=b("span"),D=G("Map layers"),j=L(),O=b("label"),T=b("input"),V=G("all iNaturalist observations"),q=L(),m=b("label"),w=b("input"),Q=G("Taxon range"),ee=L(),oe&&oe.c(),this.h()},l(F){e=v(F,"DIV",{class:!0});var z=k(e);t=v(z,"DL",{class:!0});var ge=k(t);a=v(ge,"DT",{class:!0});var fe=k(a);s=U(fe,"link"),fe.forEach(n),o=v(ge,"DD",{});var ke=k(o);r=v(ke,"A",{href:!0});var Ie=k(r);f=U(Ie,"Species page"),Ie.forEach(n),ke.forEach(n),p=v(ge,"DT",{class:!0});var re=k(p);_=U(re,"taxonomic rank"),re.forEach(n),h=v(ge,"DD",{});var Z=k(h);P=U(Z,S),Z.forEach(n),ge.forEach(n),y=A(z),E=v(z,"SPAN",{class:!0});var Se=k(E);D=U(Se,"Map layers"),Se.forEach(n),j=A(z),O=v(z,"LABEL",{class:!0});var _e=k(O);T=v(_e,"INPUT",{type:!0,class:!0}),V=U(_e,"all iNaturalist observations"),_e.forEach(n),q=A(z),m=v(z,"LABEL",{class:!0});var de=k(m);w=v(de,"INPUT",{type:!0,class:!0}),Q=U(de,"Taxon range"),de.forEach(n),ee=A(z),oe&&oe.l(z),z.forEach(n),this.h()},h(){d(a,"class","svelte-1bt2ft"),d(r,"href",c=""+(l[3]+"/taxa/"+l[0].taxon_id)),d(p,"class","svelte-1bt2ft"),d(t,"class","svelte-1bt2ft"),d(E,"class","font-medium inline-block"),d(T,"type","checkbox"),d(T,"class","mr-1"),d(O,"class","cursor-pointer block"),d(w,"type","checkbox"),d(w,"class","mr-1"),d(m,"class","cursor-pointer block"),d(e,"class","py-1 px-2 card-more-content svelte-1bt2ft"),W(e,"active",l[0].active)},m(F,z){C(F,e,z),i(e,t),i(t,a),i(a,s),i(t,o),i(o,r),i(r,f),i(t,p),i(p,_),i(t,h),i(h,P),i(e,y),i(e,E),i(E,D),i(e,j),i(e,O),i(O,T),T.checked=l[8],i(O,V),i(e,q),i(e,m),i(m,w),w.checked=l[7],i(m,Q),i(e,ee),oe&&oe.m(e,null),te=!0,$||(ye=[ue(T,"change",l[14]),ue(T,"click",l[15]),ue(w,"change",l[16]),ue(w,"click",l[17])],$=!0)},p(F,z){(!te||z&9&&c!==(c=""+(F[3]+"/taxa/"+F[0].taxon_id)))&&d(r,"href",c),(!te||z&1)&&S!==(S=F[0].rank+"")&&We(P,S),z&256&&(T.checked=F[8]),z&128&&(w.checked=F[7]),F[10]&&oe.p(F,z),z&1&&W(e,"active",F[0].active)},i(F){te||(Ze(()=>{be&&be.end(1),K=Ct(e,we,{}),K.start()}),te=!0)},o(F){K&&K.invalidate(),be=Vt(e,we,{}),te=!1},d(F){F&&n(e),oe&&oe.d(),F&&be&&be.end(),$=!1,Je(ye)}}}function Zl(l){let e,t=l[9].length+"",a,s,o,r,f=l[9],c=[];for(let p=0;p<f.length;p+=1)c[p]=Kt(Yt(l,f,p));return{c(){e=b("span"),a=G(t),s=G(" observed species"),o=L(),r=b("ul");for(let p=0;p<c.length;p+=1)c[p].c();this.h()},l(p){e=v(p,"SPAN",{class:!0});var _=k(e);a=U(_,t),s=U(_," observed species"),_.forEach(n),o=A(p),r=v(p,"UL",{class:!0});var h=k(r);for(let S=0;S<c.length;S+=1)c[S].l(h);h.forEach(n),this.h()},h(){d(e,"class","font-medium mt-2 inline-block"),d(r,"class","observed-species svelte-1bt2ft")},m(p,_){C(p,e,_),i(e,a),i(e,s),C(p,o,_),C(p,r,_);for(let h=0;h<c.length;h+=1)c[h].m(r,null)},p(p,_){if(_&512){f=p[9];let h;for(h=0;h<f.length;h+=1){const S=Yt(p,f,h);c[h]?c[h].p(S,_):(c[h]=Kt(S),c[h].c(),c[h].m(r,null))}for(;h<c.length;h+=1)c[h].d(1);c.length=f.length}},d(p){p&&n(e),p&&n(o),p&&n(r),vl(c,p)}}}function Kt(l){let e,t=vt(l[19],!0)+"";return{c(){e=b("li"),this.h()},l(a){e=v(a,"LI",{class:!0});var s=k(e);s.forEach(n),this.h()},h(){d(e,"class","svelte-1bt2ft")},m(a,s){C(a,e,s),e.innerHTML=t},p:Me,d(a){a&&n(e)}}}function xl(l){let e,t,a,s,o,r,f,c,p,_=l[0].taxon_name+"",h,S,P,y,E=Gt("observation",l[0].taxa_count)+"",D,j,O,T,V,q,m,w,Q,ee,K,be,te,$,ye,oe,F,z,ge,fe;function ke(J,Y){return J[0].image_url?Yl:Jl}let Ie=ke(l),re=Ie(l);f=new Ul({props:{value:l[0].taxon_id,color:l[0].color}});function Z(J,Y){return J[6]?Kl:Xl}let Se=Z(l),_e=Se(l);function de(J,Y){return J[0].active?Wl:Ql}let Te=de(l),ve=Te(l),x=l[6]&&Xt(l);return{c(){e=b("div"),t=b("div"),a=b("figure"),re.c(),s=L(),o=b("div"),r=b("div"),Oe(f.$$.fragment),c=L(),p=b("span"),h=G(_),S=b("br"),P=L(),y=b("span"),D=G(E),j=b("br"),q=L(),m=b("ul"),w=b("li"),_e.c(),Q=G(" info"),ee=L(),K=b("li"),ve.c(),te=L(),$=b("li"),ye=G("Delete"),F=L(),x&&x.c(),this.h()},l(J){e=v(J,"DIV",{class:!0});var Y=k(e);t=v(Y,"DIV",{class:!0});var Ee=k(t);a=v(Ee,"FIGURE",{});var Ue=k(a);re.l(Ue),Ue.forEach(n),s=A(Ee),o=v(Ee,"DIV",{class:!0});var Pe=k(o);r=v(Pe,"DIV",{class:!0,"data-taxon-id":!0});var ie=k(r);Ae(f.$$.fragment,ie),c=A(ie),p=v(ie,"SPAN",{});var X=k(p);h=U(X,_),X.forEach(n),S=v(ie,"BR",{}),P=A(ie),y=v(ie,"SPAN",{});var Fe=k(y);D=U(Fe,E),Fe.forEach(n),j=v(ie,"BR",{}),ie.forEach(n),Pe.forEach(n),Ee.forEach(n),q=A(Y),m=v(Y,"UL",{class:!0});var Ne=k(m);w=v(Ne,"LI",{class:!0});var ne=k(w);_e.l(ne),Q=U(ne," info"),ne.forEach(n),ee=A(Ne),K=v(Ne,"LI",{"data-taxon-id":!0,class:!0});var Be=k(K);ve.l(Be),Be.forEach(n),te=A(Ne),$=v(Ne,"LI",{"data-taxon-id":!0,class:!0});var Le=k($);ye=U(Le,"Delete"),Le.forEach(n),Ne.forEach(n),F=A(Y),x&&x.l(Y),Y.forEach(n),this.h()},h(){d(r,"class","leading-normal"),d(r,"data-taxon-id",O=l[0].taxon_id),d(o,"class","image-card-side-body svelte-1bt2ft"),d(t,"class","image-card-side svelte-1bt2ft"),W(t,"active",l[0].active),d(w,"class","svelte-1bt2ft"),d(K,"data-taxon-id",be=l[0].taxon_id),d(K,"class","svelte-1bt2ft"),d($,"data-taxon-id",oe=l[0].taxon_id),d($,"class","svelte-1bt2ft"),d(m,"class","text-sm submenu bg-gray-100 grid grid-cols-3 svelte-1bt2ft"),d(e,"class","border relative filter")},m(J,Y){C(J,e,Y),i(e,t),i(t,a),re.m(a,null),i(t,s),i(t,o),i(o,r),De(f,r,null),i(r,c),i(r,p),i(p,h),i(r,S),i(r,P),i(r,y),i(y,D),i(r,j),i(e,q),i(e,m),i(m,w),_e.m(w,null),i(w,Q),i(m,ee),i(m,K),ve.m(K,null),i(m,te),i(m,$),i($,ye),i(e,F),x&&x.m(e,null),z=!0,ge||(fe=[ue(w,"click",l[13]),ue(K,"click",function(){zt(l[1])&&l[1].apply(this,arguments)}),ue($,"click",function(){zt(l[2])&&l[2].apply(this,arguments)})],ge=!0)},p(J,[Y]){l=J,Ie===(Ie=ke(l))&&re?re.p(l,Y):(re.d(1),re=Ie(l),re&&(re.c(),re.m(a,null)));const Ee={};Y&1&&(Ee.value=l[0].taxon_id),Y&1&&(Ee.color=l[0].color),f.$set(Ee),(!z||Y&1)&&_!==(_=l[0].taxon_name+"")&&We(h,_),(!z||Y&1)&&E!==(E=Gt("observation",l[0].taxa_count)+"")&&We(D,E),(!z||Y&1&&O!==(O=l[0].taxon_id))&&d(r,"data-taxon-id",O),Y&1&&W(t,"active",l[0].active),Se!==(Se=Z(l))&&(_e.d(1),_e=Se(l),_e&&(_e.c(),_e.m(w,Q))),Te!==(Te=de(l))&&(ve.d(1),ve=Te(l),ve&&(ve.c(),ve.m(K,null))),(!z||Y&1&&be!==(be=l[0].taxon_id))&&d(K,"data-taxon-id",be),(!z||Y&1&&oe!==(oe=l[0].taxon_id))&&d($,"data-taxon-id",oe),l[6]?x?(x.p(l,Y),Y&64&&N(x,1)):(x=Xt(l),x.c(),N(x,1),x.m(e,null)):x&&(Ve(),B(x,1,1,()=>{x=null}),ze())},i(J){z||(N(f.$$.fragment,J),Ze(()=>{V&&V.end(1),T=Ct(t,we,{}),T.start()}),N(x),z=!0)},o(J){B(f.$$.fragment,J),T&&T.invalidate(),V=Vt(t,we,{}),B(x),z=!1},d(J){J&&n(e),re.d(),je(f),J&&V&&V.end(),_e.d(),ve.d(),x&&x.d(),ge=!1,Je(fe)}}}function $l(l,e,t){let{taxon:a}=e,{taxa:s}=e,{toggleTaxon:o}=e,{removeTaxon:r}=e,{projectPath:f}=e,{toggleInatGrid:c}=e,{toggleInatTaxonRange:p}=e,{taxaHistory:_}=e,h=!1,S=jl(s,a),P=_.map(m=>m.taxon_id).indexOf(a.taxon_id),y=_[P].showInatTaxonRange,E=_[P].showInatGrid,D=S.length>1||S.length==1&&S[0].taxon_id==!a.taxon_id;const j=()=>t(6,h=!h);function O(){E=this.checked,t(8,E)}const T=()=>c(a.taxon_id);function V(){y=this.checked,t(7,y)}const q=()=>p(a.taxon_id);return l.$$set=m=>{"taxon"in m&&t(0,a=m.taxon),"taxa"in m&&t(11,s=m.taxa),"toggleTaxon"in m&&t(1,o=m.toggleTaxon),"removeTaxon"in m&&t(2,r=m.removeTaxon),"projectPath"in m&&t(3,f=m.projectPath),"toggleInatGrid"in m&&t(4,c=m.toggleInatGrid),"toggleInatTaxonRange"in m&&t(5,p=m.toggleInatTaxonRange),"taxaHistory"in m&&t(12,_=m.taxaHistory)},[a,o,r,f,c,p,h,y,E,S,D,s,_,j,O,T,V,q]}class ea extends mt{constructor(e){super();pt(this,e,$l,xl,bt,{taxon:0,taxa:11,toggleTaxon:1,removeTaxon:2,projectPath:3,toggleInatGrid:4,toggleInatTaxonRange:5,taxaHistory:12})}}function ta(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(n),this.h()},h(){d(e,"class","arrow right-arrow svelte-4sfpsf"),pe(e,"top",l[2]),pe(e,"right",l[3]),d(e,"title","click to show more info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&n(e),t=!1,Je(a)}}}function la(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(n),this.h()},h(){d(e,"class","arrow left-arrow svelte-4sfpsf"),pe(e,"top",l[2]),pe(e,"right",l[3]),d(e,"title","click to show less info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&n(e),t=!1,Je(a)}}}function aa(l){let e;function t(o,r){return o[0]?oa:sa}let a=t(l),s=a(l);return{c(){s.c(),e=$e()},l(o){s.l(o),e=$e()},m(o,r){s.m(o,r),C(o,e,r)},p(o,r){a===(a=t(o))&&s?s.p(o,r):(s.d(1),s=a(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&n(e)}}}function sa(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(n),this.h()},h(){d(e,"class","arrow up-arrow svelte-4sfpsf"),pe(e,"top",l[2]),pe(e,"right",l[3]),d(e,"title","click to show more info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&n(e),t=!1,Je(a)}}}function oa(l){let e,t,a;return{c(){e=b("span"),this.h()},l(s){e=v(s,"SPAN",{class:!0,style:!0,title:!0}),k(e).forEach(n),this.h()},h(){d(e,"class","arrow down-arrow svelte-4sfpsf"),pe(e,"top",l[2]),pe(e,"right",l[3]),d(e,"title","click to show less info"),W(e,"border",l[4]),W(e,"border-1",l[4]),W(e,"absolute",l[5]=="absolute")},m(s,o){C(s,e,o),t||(a=[tt(lt.call(null,e)),ue(e,"click",l[6])],t=!0)},p(s,o){o&4&&pe(e,"top",s[2]),o&8&&pe(e,"right",s[3]),o&16&&W(e,"border",s[4]),o&16&&W(e,"border-1",s[4]),o&32&&W(e,"absolute",s[5]=="absolute")},d(s){s&&n(e),t=!1,Je(a)}}}function ra(l){let e;function t(o,r){return o[1]==="upDown"?aa:o[0]?la:ta}let a=t(l),s=a(l);return{c(){s.c(),e=$e()},l(o){s.l(o),e=$e()},m(o,r){s.m(o,r),C(o,e,r)},p(o,[r]){a===(a=t(o))&&s?s.p(o,r):(s.d(1),s=a(o),s&&(s.c(),s.m(e.parentNode,e)))},i:Me,o:Me,d(o){s.d(o),o&&n(e)}}}function ia(l,e,t){let{showMore:a=!1}=e,{format:s="upDown"}=e,{top:o=0}=e,{right:r=0}=e,{border:f}=e,{position:c="absolute"}=e;const p=gl();function _(){t(0,a=!a),p("toggleShowMore",{showMore:a})}return l.$$set=h=>{"showMore"in h&&t(0,a=h.showMore),"format"in h&&t(1,s=h.format),"top"in h&&t(2,o=h.top),"right"in h&&t(3,r=h.right),"border"in h&&t(4,f=h.border),"position"in h&&t(5,c=h.position)},[a,s,o,r,f,c,_]}class Qt extends mt{constructor(e){super();pt(this,e,ia,ra,bt,{showMore:0,format:1,top:2,right:3,border:4,position:5})}}function na(l){let e,t;return{c(){e=b("span"),t=G("\xD7"),this.h()},l(a){e=v(a,"SPAN",{"data-taxon-id":!0,class:!0});var s=k(e);t=U(s,"\xD7"),s.forEach(n),this.h()},h(){d(e,"data-taxon-id",l[0]),d(e,"class","svelte-xette2")},m(a,s){C(a,e,s),i(e,t)},p(a,[s]){s&1&&d(e,"data-taxon-id",a[0])},i:Me,o:Me,d(a){a&&n(e)}}}function ca(l,e,t){let{value:a=null}=e;return l.$$set=s=>{"value"in s&&t(0,a=s.value)},[a]}class fa extends mt{constructor(e){super();pt(this,e,ca,na,bt,{value:0})}}const ua="https://vega.github.io/schema/vega-lite/v5.json",_a="A faceted bar chart with labels, custom color and custon opacity.",da={values:[]},ha={field:"group",type:"nominal",title:null,header:{orient:"bottom"},sort:null},ma={width:{step:25},height:200,encoding:{y:{field:"yValue",type:"quantitative",title:"observations"},x:{field:"xValue",type:"nominal",title:null,sort:null,axis:{labelAngle:0,labelOverlap:!0}},opacity:{field:"opacity",type:"quantitative",scale:null}},layer:[{mark:{type:"bar"},encoding:{color:{field:"color",type:"nominal"}}},{mark:{type:"text",dx:0,angle:0,baseline:"bottom",align:"center",color:"#6b7280"},encoding:{text:{field:"yValue",type:"quantitative"}}}]},pa={facet:{columns:2},axis:{titleFontSize:14,labelFontSize:12,labelColor:"#333"},legend:{titleFontSize:14,labelFontSize:14,labelLimit:0,orient:"bottom",columns:1,labelColor:"#333"},header:{titleFontSize:14,labelFontSize:14,labelColor:"#333"},mark:{fontSize:12,color:"#333"},title:{fontSize:14,color:"#333"}},ba={axis:{x:"independent",y:"independent"}};var va={$schema:ua,description:_a,data:da,facet:ha,spec:ma,config:pa,resolve:ba};function ga(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/observations.csv":return Ge(()=>import("../../../../chunks/observations-300b979a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/observations.csv":return Ge(()=>import("../../../../chunks/observations-637c398b.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/observations.csv":return Ge(()=>import("../../../../chunks/observations-aedf9342.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/observations.csv":return Ge(()=>import("../../../../chunks/observations-c3886d39.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/observations.csv":return Ge(()=>import("../../../../chunks/observations-627adcb7.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}function ka(l){switch(l){case"../../../../lib/data/cedar-creek-reserve/taxa.csv":return Ge(()=>import("../../../../chunks/taxa-f4c5fea7.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bats/taxa.csv":return Ge(()=>import("../../../../chunks/taxa-9108f66a.js"),[]);case"../../../../lib/data/ciencia-ciudadana-peru-bees/taxa.csv":return Ge(()=>import("../../../../chunks/taxa-104f431f.js"),[]);case"../../../../lib/data/clarkstown-high-school-north/taxa.csv":return Ge(()=>import("../../../../chunks/taxa-029efbae.js"),[]);case"../../../../lib/data/los-angeles-bioblitz/taxa.csv":return Ge(()=>import("../../../../chunks/taxa-99749418.js"),[]);default:return new Promise(function(e,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+l)))})}}const{Map:Ea}=Dl;function Wt(l,e,t){const a=l.slice();return a[66]=e[t],a}function Zt(l){let e,t,a,s,o,r,f,c,p,_=[],h=new Ea,S,P,y;function E(m){l[49](m)}let D={searchFunction:l[31],onChange:l[30],labelFieldName:"label",valueFieldName:"taxon_id",placeholder:"Search species name",hideArrow:!0};l[8]!==void 0&&(D.selectedItem=l[8]),a=new Il({props:D}),Sl.push(()=>Tl(a,"selectedItem",E));let j=l[5].length>5&&xt(l),O=l[10]&&$t(l),T=l[11]&&el(l),V=l[5];const q=m=>m[66].taxon_id;for(let m=0;m<V.length;m+=1){let w=Wt(l,V,m),Q=q(w);h.set(Q,_[m]=tl(Q,w))}return{c(){e=b("section"),t=b("div"),Oe(a.$$.fragment),o=L(),j&&j.c(),r=L(),O&&O.c(),f=L(),T&&T.c(),c=L(),p=b("div");for(let m=0;m<_.length;m+=1)_[m].c();this.h()},l(m){e=v(m,"SECTION",{class:!0});var w=k(e);t=v(w,"DIV",{class:!0});var Q=k(t);Ae(a.$$.fragment,Q),Q.forEach(n),o=A(w),j&&j.l(w),r=A(w),O&&O.l(w),f=A(w),T&&T.l(w),c=A(w),p=v(w,"DIV",{class:!0});var ee=k(p);for(let K=0;K<_.length;K+=1)_[K].l(ee);ee.forEach(n),w.forEach(n),this.h()},h(){d(t,"class","max-w-lg mb-4 autocomplete svelte-iekzjp"),d(p,"class","grid lg:grid-cols-1 md:grid-cols-2 sm:grid-cols-1 gap-2"),d(e,"class","px-3 mb-3")},m(m,w){C(m,e,w),i(e,t),De(a,t,null),i(e,o),j&&j.m(e,null),i(e,r),O&&O.m(e,null),i(e,f),T&&T.m(e,null),i(e,c),i(e,p);for(let Q=0;Q<_.length;Q+=1)_[Q].m(p,null);y=!0},p(m,w){const Q={};!s&&w[0]&256&&(s=!0,Q.selectedItem=m[8],kl(()=>s=!1)),a.$set(Q),m[5].length>5?j?j.p(m,w):(j=xt(m),j.c(),j.m(e,r)):j&&(j.d(1),j=null),m[10]?O?(O.p(m,w),w[0]&1024&&N(O,1)):(O=$t(m),O.c(),N(O,1),O.m(e,f)):O&&(Ve(),B(O,1,1,()=>{O=null}),ze()),m[11]?T?(T.p(m,w),w[0]&2048&&N(T,1)):(T=el(m),T.c(),N(T,1),T.m(e,c)):T&&(Ve(),B(T,1,1,()=>{T=null}),ze()),w[0]&56|w[1]&816&&(V=m[5],Ve(),_=El(_,w,q,1,m,V,h,p,Ol,tl,null,Wt),ze())},i(m){if(!y){N(a.$$.fragment,m),N(O),N(T);for(let w=0;w<V.length;w+=1)N(_[w]);Ze(()=>{S||(S=Re(p,we,{},!0)),S.run(1)}),Ze(()=>{P||(P=Re(e,we,{},!0)),P.run(1)}),y=!0}},o(m){B(a.$$.fragment,m),B(O),B(T);for(let w=0;w<_.length;w+=1)B(_[w]);S||(S=Re(p,we,{},!1)),S.run(0),P||(P=Re(e,we,{},!1)),P.run(0),y=!1},d(m){m&&n(e),je(a),j&&j.d(),O&&O.d(),T&&T.d();for(let w=0;w<_.length;w+=1)_[w].d();m&&S&&S.end(),m&&P&&P.end()}}}function xt(l){let e,t,a,s;return{c(){e=b("span"),t=G("Delete all"),this.h()},l(o){e=v(o,"SPAN",{class:!0});var r=k(e);t=U(r,"Delete all"),r.forEach(n),this.h()},h(){d(e,"class","btn btn-sm btn-outline mb-4 ")},m(o,r){C(o,e,r),i(e,t),a||(s=ue(e,"click",l[34]),a=!0)},p:Me,d(o){o&&n(e),a=!1,s()}}}function $t(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=L(),s=b("span"),o=G("Show 5 most observed species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var h=k(e);t=v(h,"INPUT",{type:!0,class:!0}),a=A(h),s=v(h,"SPAN",{});var S=k(s);o=U(S,"Show 5 most observed species"),S.forEach(n),h.forEach(n),this.h()},h(){d(t,"type","checkbox"),d(t,"class","mr-2"),d(e,"class","cursor-pointer block")},m(_,h){C(_,e,h),i(e,t),i(e,a),i(e,s),i(s,o),f=!0,c||(p=ue(t,"click",l[50]),c=!0)},p:Me,i(_){f||(Ze(()=>{r||(r=Re(e,we,{},!0)),r.run(1)}),f=!0)},o(_){r||(r=Re(e,we,{},!1)),r.run(0),f=!1},d(_){_&&n(e),_&&r&&r.end(),c=!1,p()}}}function el(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=L(),s=b("span"),o=G("Show indicator species"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var h=k(e);t=v(h,"INPUT",{type:!0,class:!0}),a=A(h),s=v(h,"SPAN",{});var S=k(s);o=U(S,"Show indicator species"),S.forEach(n),h.forEach(n),this.h()},h(){d(t,"type","checkbox"),d(t,"class","mr-2"),d(e,"class","cursor-pointer block")},m(_,h){C(_,e,h),i(e,t),i(e,a),i(e,s),i(s,o),f=!0,c||(p=ue(t,"click",l[51]),c=!0)},p:Me,i(_){f||(Ze(()=>{r||(r=Re(e,we,{},!0)),r.run(1)}),f=!0)},o(_){r||(r=Re(e,we,{},!1)),r.run(0),f=!1},d(_){_&&n(e),_&&r&&r.end(),c=!1,p()}}}function tl(l,e){let t,a,s;return a=new ea({props:{taxa:e[3],taxon:e[66],toggleTaxon:e[36],removeTaxon:e[35],toggleInatGrid:e[39],toggleInatTaxonRange:e[40],projectPath:e[4],taxaHistory:e[5]}}),{key:l,first:null,c(){t=$e(),Oe(a.$$.fragment),this.h()},l(o){t=$e(),Ae(a.$$.fragment,o),this.h()},h(){this.first=t},m(o,r){C(o,t,r),De(a,o,r),s=!0},p(o,r){e=o;const f={};r[0]&8&&(f.taxa=e[3]),r[0]&32&&(f.taxon=e[66]),r[0]&16&&(f.projectPath=e[4]),r[0]&32&&(f.taxaHistory=e[5]),a.$set(f)},i(o){s||(N(a.$$.fragment,o),s=!0)},o(o){B(a.$$.fragment,o),s=!1},d(o){o&&n(t),je(a,o)}}}function ll(l){let e,t,a,s,o,r,f,c,p,_,h,S,P,y,E,D;return{c(){e=b("section"),t=b("label"),a=b("input"),s=L(),o=b("span"),r=G("Temperature and Preciptation"),f=L(),c=b("label"),p=b("input"),_=L(),h=b("span"),S=G("Demo map layer"),this.h()},l(j){e=v(j,"SECTION",{class:!0});var O=k(e);t=v(O,"LABEL",{class:!0});var T=k(t);a=v(T,"INPUT",{type:!0}),s=A(T),o=v(T,"SPAN",{});var V=k(o);r=U(V,"Temperature and Preciptation"),V.forEach(n),T.forEach(n),f=A(O),c=v(O,"LABEL",{class:!0});var q=k(c);p=v(q,"INPUT",{type:!0}),_=A(q),h=v(q,"SPAN",{});var m=k(h);S=U(m,"Demo map layer"),m.forEach(n),q.forEach(n),O.forEach(n),this.h()},h(){d(a,"type","checkbox"),d(t,"class","cursor-pointer block"),d(p,"type","checkbox"),d(c,"class","cursor-pointer block"),d(e,"class","px-3 mb-3")},m(j,O){C(j,e,O),i(e,t),i(t,a),a.checked=l[12],i(t,s),i(t,o),i(o,r),i(e,f),i(e,c),i(c,p),p.checked=l[13],i(c,_),i(c,h),i(h,S),y=!0,E||(D=[ue(a,"change",l[53]),ue(p,"change",l[54])],E=!0)},p(j,O){O[0]&4096&&(a.checked=j[12]),O[0]&8192&&(p.checked=j[13])},i(j){y||(Ze(()=>{P||(P=Re(e,we,{},!0)),P.run(1)}),y=!0)},o(j){P||(P=Re(e,we,{},!1)),P.run(0),y=!1},d(j){j&&n(e),j&&P&&P.end(),E=!1,Je(D)}}}function al(l){let e,t,a,s,o,r;return{c(){e=b("span"),t=G("*"),this.h()},l(f){e=v(f,"SPAN",{class:!0,title:!0});var c=k(e);t=U(c,"*"),c.forEach(n),this.h()},h(){d(e,"class","text-red-600"),d(e,"title",a="Since there are over "+Tt+" observations on the map, the map uses clustered markers.")},m(f,c){C(f,e,c),i(e,t),o||(r=tt(s=lt.call(null,e)),o=!0)},p:Me,d(f){f&&n(e),o=!1,r()}}}function sl(l){let e,t,a,s;const o=[Ia,wa],r=[];function f(c,p){return c[22]?0:1}return e=f(l),t=r[e]=o[e](l),{c(){t.c(),a=$e()},l(c){t.l(c),a=$e()},m(c,p){r[e].m(c,p),C(c,a,p),s=!0},p(c,p){let _=e;e=f(c),e===_?r[e].p(c,p):(Ve(),B(r[_],1,1,()=>{r[_]=null}),ze(),t=r[e],t?t.p(c,p):(t=r[e]=o[e](c),t.c()),N(t,1),t.m(a.parentNode,a))},i(c){s||(N(t),s=!0)},o(c){B(t),s=!1},d(c){r[e].d(c),c&&n(a)}}}function wa(l){let e,t,a,s,o;return t=new Jt({}),{c(){e=b("span"),Oe(t.$$.fragment),this.h()},l(r){e=v(r,"SPAN",{title:!0});var f=k(e);Ae(t.$$.fragment,f),f.forEach(n),this.h()},h(){d(e,"title","click show to species list")},m(r,f){C(r,e,f),De(t,e,null),a=!0,s||(o=[tt(lt.call(null,e)),ue(e,"click",l[44])],s=!0)},p:Me,i(r){a||(N(t.$$.fragment,r),a=!0)},o(r){B(t.$$.fragment,r),a=!1},d(r){r&&n(e),je(t),s=!1,Je(o)}}}function Ia(l){let e,t,a,s,o;return t=new Jt({}),{c(){e=b("span"),Oe(t.$$.fragment),this.h()},l(r){e=v(r,"SPAN",{title:!0});var f=k(e);Ae(t.$$.fragment,f),f.forEach(n),this.h()},h(){d(e,"title","click hide to species list")},m(r,f){C(r,e,f),De(t,e,null),a=!0,s||(o=[tt(lt.call(null,e)),ue(e,"click",l[44])],s=!0)},p:Me,i(r){a||(N(t.$$.fragment,r),a=!0)},o(r){B(t.$$.fragment,r),a=!1},d(r){r&&n(e),je(t),s=!1,Je(o)}}}function ol(l){let e,t,a,s;return e=new Ll({}),{c(){Oe(e.$$.fragment),t=L(),a=b("div"),this.h()},l(o){Ae(e.$$.fragment,o),t=A(o),a=v(o,"DIV",{class:!0,style:!0}),k(a).forEach(n),this.h()},h(){d(a,"class","bg-gray-100"),pe(a,"width","100%"),pe(a,"height","75vh")},m(o,r){De(e,o,r),C(o,t,r),C(o,a,r),s=!0},i(o){s||(N(e.$$.fragment,o),s=!0)},o(o){B(e.$$.fragment,o),s=!1},d(o){je(e,o),o&&n(t),o&&n(a)}}}function rl(l){let e,t,a,s,o,r,f,c,p,_,h;a=new fa({});function S(E,D){return E[16].image_url?Ta:Sa}let P=S(l),y=P(l);return f=new Al({props:{observation:l[16],projectPath:l[4],compactLayout:!0}}),f.$on("zoomToObservation",l[41]),{c(){e=b("div"),t=b("span"),Oe(a.$$.fragment),s=L(),o=b("section"),y.c(),r=L(),Oe(f.$$.fragment),this.h()},l(E){e=v(E,"DIV",{class:!0});var D=k(e);t=v(D,"SPAN",{class:!0});var j=k(t);Ae(a.$$.fragment,j),j.forEach(n),s=A(D),o=v(D,"SECTION",{class:!0});var O=k(o);y.l(O),r=A(O),Ae(f.$$.fragment,O),O.forEach(n),D.forEach(n),this.h()},h(){d(t,"class","close-button cursor-pointer svelte-iekzjp"),d(o,"class","px-3 mb-3"),d(e,"class","absolute observation-container bg-white text-sm overflow-auto svelte-iekzjp")},m(E,D){C(E,e,D),i(e,t),De(a,t,null),i(e,s),i(e,o),y.m(o,null),i(o,r),De(f,o,null),p=!0,_||(h=ue(t,"click",l[55]),_=!0)},p(E,D){P===(P=S(E))&&y?y.p(E,D):(y.d(1),y=P(E),y&&(y.c(),y.m(o,r)));const j={};D[0]&65536&&(j.observation=E[16]),D[0]&16&&(j.projectPath=E[4]),f.$set(j)},i(E){p||(N(a.$$.fragment,E),N(f.$$.fragment,E),Ze(()=>{c||(c=Re(o,we,{},!0)),c.run(1)}),p=!0)},o(E){B(a.$$.fragment,E),B(f.$$.fragment,E),c||(c=Re(o,we,{},!1)),c.run(0),p=!1},d(E){E&&n(e),je(a),y.d(),je(f),E&&c&&c.end(),_=!1,h()}}}function Sa(l){let e,t;return{c(){e=b("img"),this.h()},l(a){e=v(a,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){d(e,"class","float-right lg:float-none svelte-iekzjp"),xe(e.src,t=""+(it+"/images/missing-image.png"))||d(e,"src",t),d(e,"alt","")},m(a,s){C(a,e,s)},p:Me,d(a){a&&n(e)}}}function Ta(l){let e,t,a;return{c(){e=b("img"),this.h()},l(s){e=v(s,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){xe(e.src,t=l[16].image_url.replace("medium","small"))||d(e,"src",t),d(e,"alt",a="photo of "+vt(l[16])),d(e,"class","svelte-iekzjp")},m(s,o){C(s,e,o)},p(s,o){o[0]&65536&&!xe(e.src,t=s[16].image_url.replace("medium","small"))&&d(e,"src",t),o[0]&65536&&a!==(a="photo of "+vt(s[16]))&&d(e,"alt",a)},d(s){s&&n(e)}}}function il(l){let e,t,a;return t=new ql({props:{mapOptions:l[29],selectTimeSpanHandler:l[38],groupedObservations:l[9],toggleTimeSpans:l[37],timeSpanHistory:l[6],activeTaxaCount:l[5].filter(_l).length}}),{c(){e=b("section"),Oe(t.$$.fragment)},l(s){e=v(s,"SECTION",{});var o=k(e);Ae(t.$$.fragment,o),o.forEach(n)},m(s,o){C(s,e,o),De(t,e,null),a=!0},p(s,o){const r={};o[0]&512&&(r.groupedObservations=s[9]),o[0]&64&&(r.timeSpanHistory=s[6]),o[0]&32&&(r.activeTaxaCount=s[5].filter(_l).length),t.$set(r)},i(s){a||(N(t.$$.fragment,s),a=!0)},o(s){B(t.$$.fragment,s),a=!1},d(s){s&&n(e),je(t)}}}function nl(l){let e,t,a,s,o,r,f,c,p;return{c(){e=b("label"),t=b("input"),a=L(),s=b("span"),o=G("Update charts as map changes"),r=L(),f=b("div"),this.h()},l(_){e=v(_,"LABEL",{class:!0});var h=k(e);t=v(h,"INPUT",{type:!0}),a=A(h),s=v(h,"SPAN",{});var S=k(s);o=U(S,"Update charts as map changes"),S.forEach(n),h.forEach(n),r=A(_),f=v(_,"DIV",{id:!0,class:!0}),k(f).forEach(n),this.h()},h(){d(t,"type","checkbox"),d(e,"class","cursor-pointer mt-2 inline-block"),d(f,"id","ed-chart"),d(f,"class","w-full mt-4")},m(_,h){C(_,e,h),i(e,t),t.checked=l[7],i(e,a),i(e,s),i(s,o),C(_,r,h),C(_,f,h),c||(p=ue(t,"change",l[56]),c=!0)},p(_,h){h[0]&128&&(t.checked=_[7])},d(_){_&&n(e),_&&n(r),_&&n(f),c=!1,p()}}}function cl(l){let e,t,a,s,o,r;return{c(){e=b("h3"),t=G("Temperature and Preciptation"),a=L(),s=b("img"),this.h()},l(f){e=v(f,"H3",{class:!0});var c=k(e);t=U(c,"Temperature and Preciptation"),c.forEach(n),a=A(f),s=v(f,"IMG",{src:!0,alt:!0}),this.h()},h(){d(e,"class","text-center"),xe(s.src,o=""+(it+"/images/"+l[1].username+"/"+l[0].slug+"/climate-chart.png"))||d(s,"src",o),d(s,"alt",r="climate chart for "+l[0].location)},m(f,c){C(f,e,c),i(e,t),C(f,a,c),C(f,s,c)},p(f,c){c[0]&3&&!xe(s.src,o=""+(it+"/images/"+f[1].username+"/"+f[0].slug+"/climate-chart.png"))&&d(s,"src",o),c[0]&1&&r!==(r="climate chart for "+f[0].location)&&d(s,"alt",r)},d(f){f&&n(e),f&&n(a),f&&n(s)}}}function Oa(l){let e,t,a=l[2].label+"",s,o,r,f,c,p,_,h,S,P,y,E,D,j,O,T,V,q,m,w,Q,ee,K,be,te,$,ye,oe,F,z,ge,fe,ke,Ie,re,Z,Se,_e,de,Te,ve,x,J,Y,Ee,Ue,Pe,ie,X,Fe,Ne,ne,Be,Le,ot,et,at,He;h=new Qt({props:{showMore:!0,position:"normal"}}),h.$on("toggleShowMore",l[48]);let le=l[26]&&Zt(l);D=new Qt({props:{showMore:!0,position:"normal"}}),D.$on("toggleShowMore",l[52]);let ae=l[27]&&ll(l),he=l[18]>=Tt&&al(),se=l[23]&&sl(l),ce=l[15]&&l[14]&&ol();var qe=l[28];function nt(g){return{props:{mapOptions:g[29],groupedObservations:g[9],timeSpanHistory:g[6],showDemoMapLayer:g[13],taxaHistory:g[5],mapCenter:g[24],country:g[0].country}}}qe&&(X=new qe(nt(l)),X.$on("markerClick",l[43]),X.$on("updateStats",l[42]));let u=l[25]&&rl(l);Le=new Bl({props:{showSpeciesList:l[22],speciesList:l[21]}});let I=l[5].length>0&&il(l),R=l[5].length>0&&nl(l),M=l[12]&&cl(l);return{c(){e=b("div"),t=b("h1"),s=G(a),o=L(),r=b("div"),f=b("div"),c=b("div"),p=b("h3"),_=G(`Biodiversity
          `),Oe(h.$$.fragment),S=L(),le&&le.c(),P=L(),y=b("h3"),E=G(`Environmental Factors
          `),Oe(D.$$.fragment),j=L(),ae&&ae.c(),O=L(),T=b("div"),V=b("div"),q=b("div"),m=b("div"),w=G("Observations"),Q=L(),ee=b("div"),K=G(l[17]),be=L(),te=b("div"),$=b("div"),ye=G(`Observations on map
            `),he&&he.c(),oe=L(),F=b("div"),z=G(l[18]),ge=L(),fe=b("div"),ke=b("div"),Ie=G("Species"),re=L(),Z=b("div"),Se=G(l[19]),_e=L(),de=b("div"),Te=b("div"),ve=G("Species on map"),x=L(),J=b("div"),Y=G(l[20]),Ee=L(),se&&se.c(),Ue=L(),ce&&ce.c(),Pe=L(),ie=b("div"),X&&Oe(X.$$.fragment),Fe=L(),u&&u.c(),Ne=L(),ne=b("div"),Be=b("section"),Oe(Le.$$.fragment),ot=L(),I&&I.c(),et=L(),R&&R.c(),at=L(),M&&M.c(),this.h()},l(g){e=v(g,"DIV",{class:!0});var H=k(e);t=v(H,"H1",{class:!0});var me=k(t);s=U(me,a),me.forEach(n),o=A(H),r=v(H,"DIV",{class:!0});var Ce=k(r);f=v(Ce,"DIV",{class:!0});var rt=k(f);c=v(rt,"DIV",{class:!0});var Ye=k(c);p=v(Ye,"H3",{class:!0});var gt=k(p);_=U(gt,`Biodiversity
          `),Ae(h.$$.fragment,gt),gt.forEach(n),S=A(Ye),le&&le.l(Ye),P=A(Ye),y=v(Ye,"H3",{class:!0});var kt=k(y);E=U(kt,`Environmental Factors
          `),Ae(D.$$.fragment,kt),kt.forEach(n),j=A(Ye),ae&&ae.l(Ye),Ye.forEach(n),rt.forEach(n),O=A(Ce),T=v(Ce,"DIV",{class:!0});var Xe=k(T);V=v(Xe,"DIV",{class:!0});var Ke=k(V);q=v(Ke,"DIV",{class:!0});var ct=k(q);m=v(ct,"DIV",{class:!0});var Ot=k(m);w=U(Ot,"Observations"),Ot.forEach(n),Q=A(ct),ee=v(ct,"DIV",{class:!0});var Dt=k(ee);K=U(Dt,l[17]),Dt.forEach(n),ct.forEach(n),be=A(Ke),te=v(Ke,"DIV",{class:!0});var ft=k(te);$=v(ft,"DIV",{class:!0});var Et=k($);ye=U(Et,`Observations on map
            `),he&&he.l(Et),Et.forEach(n),oe=A(ft),F=v(ft,"DIV",{class:!0});var jt=k(F);z=U(jt,l[18]),jt.forEach(n),ft.forEach(n),ge=A(Ke),fe=v(Ke,"DIV",{class:!0});var ut=k(fe);ke=v(ut,"DIV",{class:!0});var yt=k(ke);Ie=U(yt,"Species"),yt.forEach(n),re=A(ut),Z=v(ut,"DIV",{class:!0});var Pt=k(Z);Se=U(Pt,l[19]),Pt.forEach(n),ut.forEach(n),_e=A(Ke),de=v(Ke,"DIV",{class:!0});var _t=k(de);Te=v(_t,"DIV",{class:!0});var Lt=k(Te);ve=U(Lt,"Species on map"),Lt.forEach(n),x=A(_t),J=v(_t,"DIV",{class:!0});var dt=k(J);Y=U(dt,l[20]),Ee=A(dt),se&&se.l(dt),dt.forEach(n),_t.forEach(n),Ke.forEach(n),Ue=A(Xe),ce&&ce.l(Xe),Pe=A(Xe),ie=v(Xe,"DIV",{class:!0});var ht=k(ie);X&&Ae(X.$$.fragment,ht),Fe=A(ht),u&&u.l(ht),ht.forEach(n),Ne=A(Xe),ne=v(Xe,"DIV",{class:!0});var Qe=k(ne);Be=v(Qe,"SECTION",{});var At=k(Be);Ae(Le.$$.fragment,At),At.forEach(n),ot=A(Qe),I&&I.l(Qe),et=A(Qe),R&&R.l(Qe),at=A(Qe),M&&M.l(Qe),Qe.forEach(n),Xe.forEach(n),Ce.forEach(n),H.forEach(n),this.h()},h(){d(t,"class","px-3"),d(p,"class","bg-gray-200 mt-0 px-3 py-1"),d(y,"class","bg-gray-200 mt-0 px-3 py-1"),d(c,"class","grid"),d(f,"class","lg:col-span-3 border-0 lg:border-r-2 border-t"),d(m,"class","stat-title svelte-iekzjp"),d(ee,"class","stat-value svelte-iekzjp"),d(q,"class","stat place-items-center place-content-center svelte-iekzjp"),d($,"class","stat-title svelte-iekzjp"),d(F,"class","stat-value svelte-iekzjp"),d(te,"class","stat place-items-center place-content-center svelte-iekzjp"),d(ke,"class","stat-title svelte-iekzjp"),d(Z,"class","stat-value svelte-iekzjp"),d(fe,"class","stat place-items-center place-content-center svelte-iekzjp"),d(Te,"class","stat-title svelte-iekzjp"),d(J,"class","stat-value svelte-iekzjp"),d(de,"class","stat place-items-center place-content-center svelte-iekzjp"),d(V,"class","w-full rounded-none border stats"),d(ie,"class","relative"),d(ne,"class","px-3"),d(T,"class","lg:col-span-7"),d(r,"class","grid lg:grid-cols-10 mb-6"),d(e,"class","prose max-w-none")},m(g,H){C(g,e,H),i(e,t),i(t,s),i(e,o),i(e,r),i(r,f),i(f,c),i(c,p),i(p,_),De(h,p,null),i(c,S),le&&le.m(c,null),i(c,P),i(c,y),i(y,E),De(D,y,null),i(c,j),ae&&ae.m(c,null),i(r,O),i(r,T),i(T,V),i(V,q),i(q,m),i(m,w),i(q,Q),i(q,ee),i(ee,K),i(V,be),i(V,te),i(te,$),i($,ye),he&&he.m($,null),i(te,oe),i(te,F),i(F,z),i(V,ge),i(V,fe),i(fe,ke),i(ke,Ie),i(fe,re),i(fe,Z),i(Z,Se),i(V,_e),i(V,de),i(de,Te),i(Te,ve),i(de,x),i(de,J),i(J,Y),i(J,Ee),se&&se.m(J,null),i(T,Ue),ce&&ce.m(T,null),i(T,Pe),i(T,ie),X&&De(X,ie,null),i(ie,Fe),u&&u.m(ie,null),i(T,Ne),i(T,ne),i(ne,Be),De(Le,Be,null),i(ne,ot),I&&I.m(ne,null),i(ne,et),R&&R.m(ne,null),i(ne,at),M&&M.m(ne,null),He=!0},p(g,H){(!He||H[0]&4)&&a!==(a=g[2].label+"")&&We(s,a),g[26]?le?(le.p(g,H),H[0]&67108864&&N(le,1)):(le=Zt(g),le.c(),N(le,1),le.m(c,P)):le&&(Ve(),B(le,1,1,()=>{le=null}),ze()),g[27]?ae?(ae.p(g,H),H[0]&134217728&&N(ae,1)):(ae=ll(g),ae.c(),N(ae,1),ae.m(c,null)):ae&&(Ve(),B(ae,1,1,()=>{ae=null}),ze()),(!He||H[0]&131072)&&We(K,g[17]),g[18]>=Tt?he?he.p(g,H):(he=al(),he.c(),he.m($,null)):he&&(he.d(1),he=null),(!He||H[0]&262144)&&We(z,g[18]),(!He||H[0]&524288)&&We(Se,g[19]),(!He||H[0]&1048576)&&We(Y,g[20]),g[23]?se?(se.p(g,H),H[0]&8388608&&N(se,1)):(se=sl(g),se.c(),N(se,1),se.m(J,null)):se&&(Ve(),B(se,1,1,()=>{se=null}),ze()),g[15]&&g[14]?ce?H[0]&49152&&N(ce,1):(ce=ol(),ce.c(),N(ce,1),ce.m(T,Pe)):ce&&(Ve(),B(ce,1,1,()=>{ce=null}),ze());const me={};if(H[0]&512&&(me.groupedObservations=g[9]),H[0]&64&&(me.timeSpanHistory=g[6]),H[0]&8192&&(me.showDemoMapLayer=g[13]),H[0]&32&&(me.taxaHistory=g[5]),H[0]&16777216&&(me.mapCenter=g[24]),H[0]&1&&(me.country=g[0].country),qe!==(qe=g[28])){if(X){Ve();const rt=X;B(rt.$$.fragment,1,0,()=>{je(rt,1)}),ze()}qe?(X=new qe(nt(g)),X.$on("markerClick",g[43]),X.$on("updateStats",g[42]),Oe(X.$$.fragment),N(X.$$.fragment,1),De(X,ie,Fe)):X=null}else qe&&X.$set(me);g[25]?u?(u.p(g,H),H[0]&33554432&&N(u,1)):(u=rl(g),u.c(),N(u,1),u.m(ie,null)):u&&(Ve(),B(u,1,1,()=>{u=null}),ze());const Ce={};H[0]&4194304&&(Ce.showSpeciesList=g[22]),H[0]&2097152&&(Ce.speciesList=g[21]),Le.$set(Ce),g[5].length>0?I?(I.p(g,H),H[0]&32&&N(I,1)):(I=il(g),I.c(),N(I,1),I.m(ne,et)):I&&(Ve(),B(I,1,1,()=>{I=null}),ze()),g[5].length>0?R?R.p(g,H):(R=nl(g),R.c(),R.m(ne,at)):R&&(R.d(1),R=null),g[12]?M?M.p(g,H):(M=cl(g),M.c(),M.m(ne,null)):M&&(M.d(1),M=null)},i(g){He||(N(h.$$.fragment,g),N(le),N(D.$$.fragment,g),N(ae),N(se),N(ce),X&&N(X.$$.fragment,g),N(u),N(Le.$$.fragment,g),N(I),He=!0)},o(g){B(h.$$.fragment,g),B(le),B(D.$$.fragment,g),B(ae),B(se),B(ce),X&&B(X.$$.fragment,g),B(u),B(Le.$$.fragment,g),B(I),He=!1},d(g){g&&n(e),je(h),le&&le.d(),je(D),ae&&ae.d(),he&&he.d(),se&&se.d(),ce&&ce.d(),X&&je(X),u&&u.d(),je(Le),I&&I.d(),R&&R.d(),M&&M.d()}}}async function Ra({page:l}){let e=Rl.filter(_=>_.username===l.params.users)[0],t=e.projects.filter(_=>_.slug===l.params.projects)[0],a=l.path.split("/"),s=t.tabs_project.filter(_=>_.link===a[a.length-1])[0],o=`${it}/users/${e.username}/${t.slug}`,r=await ka(`../../../../lib/data/${l.params.projects}/taxa.csv`),f=yl(r.default),c=await ga(`../../../../lib/data/${l.params.projects}/observations.csv`),p=Pl(c.default);return{props:{project:t,user:e,currentTab:s,projectObservations:p,taxa:f,projectPath:o}}}let st=.25,Tt=1e3,fl="#ed-chart",ul="oldest";const _l=l=>l.active;function Da(l,e,t){let{project:a}=e,{user:s}=e,{currentTab:o}=e,{projectObservations:r}=e,{taxa:f}=e,{projectPath:c}=e,p="",_={},h=new Set,S=new Set,P=[],y=[],E=[],D={},j=a.slug!=="los-angeles-bioblitz",O=a.slug==="los-angeles-bioblitz",T=!1,V=!1,q=0,m=!1,w=!1,Q=JSON.parse(JSON.stringify(Fl)),ee=JSON.parse(JSON.stringify(va)),K,be=0,te=0,$=0,ye=0,oe=[],F=!1,z=!1,ge={},fe=!1,ke=!1,Ie=!0,re=!0;r=r.filter(u=>u.latitude&&u.longitude);let Z=It(wt({},Hl),{zoom:a.zoom,latitude:a.latitude,longitude:a.longitude,observationsTimeSpan:"all",colorSchemeMonth:Array(12).fill(St),colorSchemeYear:[St],defaultColor:St,monthSeasonalMarkers:!1,center:[a.latitude||0,a.longitude||0],preferCanvas:!0});function Se(u){!u||!u.label||(t(10,j=!1),t(11,O=!1),!(E.filter(I=>I.taxon_id==u.taxon_id).length>0)&&(q+=1,t(14,m=!0),setTimeout(()=>{ve(u)},100)))}async function _e(u){if(u.length>2)return await Ml(f,u)}function de(){t(10,j=!1),f.filter(u=>u.rank==="species").sort((u,I)=>I.taxa_count-u.taxa_count).slice(0,5).forEach(u=>{q+=1,ve(u)})}function Te(){t(11,O=!1),f.filter(u=>u.taxon_group&&u.observations_count>0).sort((u,I)=>I.taxa_count-u.taxa_count).forEach(u=>{q+=1,ve(u)})}function ve(u){t(14,m=!0);let I=Nl(q,Z.colorScheme.length),R=Cl(r,u.taxon_id,Z.colorScheme[I]);R.forEach(me=>{t(46,_[me.id]=me,_),h.add(me.id),S.add(me.id)}),t(9,P=Ee()),Pe("addObservationsForTaxon"),t(16,K=R[0]);let M=Gl(u.taxon_id),g=Z.colorScheme[I],H=Vl(g,10);t(5,E=E.concat({taxon_name:vt(u),image_url:u.image_url,taxa_count:u.taxa_count,taxon_id:u.taxon_id,color:g,rank:u.rank,active:!0,observationIds:R.map(me=>me.id),showInatGrid:!1,InatGridUrl:`${M.InatGrid.url}&color=%23${H}`,showInatTaxonRange:!1,InatTaxonRangeUrl:`${M.InatTaxonRange.url}?color=%23${H}`})),Z.observationsTimeSpan!=="all"&&P.forEach((me,Ce)=>t(6,D[Ce]=D[Ce]!==void 0?D[Ce]:!0,D)),t(14,m=!1)}function x(){t(8,p=""),t(46,_={}),h=new Set,S=new Set,t(9,P=[]),t(47,y=[]),t(5,E=[]),t(6,D={}),Pe("resetTaxa")}function J(u){t(14,m=!0);let I=Number(u.target.dataset.taxonId);S=new Set,h=new Set,t(5,E=E.filter(M=>(M.taxon_id!==I&&(M.active?M.observationIds.forEach(g=>{Ue(M.color,g),S.add(g),h.add(g)}):M.observationIds.forEach(g=>{h.add(g)})),M.taxon_id!==I)));let R={};h.forEach(M=>R[M]=_[M]),t(46,_=R),Pe("removeTaxon"),t(9,P=Ee()),Pe("removeTaxon"),t(14,m=!1)}function Y(u){t(14,m=!0);let I=Number(u.target.dataset.taxonId);if(!I)return;let R=!0;if(t(14,m=!0),t(5,E=E.map(M=>M.taxon_id===I?(R=!M.active,It(wt({},M),{active:!M.active})):M)),R){let M=E.filter(g=>g.taxon_id===I)[0];M.observationIds.forEach(g=>{Ue(M.color,g),S.add(g)})}else S=new Set,E.forEach(M=>{M.taxon_id!==I&&M.active&&M.observationIds.forEach(g=>{Ue(M.color,g),S.add(g)})});t(9,P=Ee()),Pe("toggleTaxon"),t(14,m=!1)}function Ee(){let u=[...S].map(I=>_[I]);return u=Ht(u,ul,Z.observationsTimeSpan),Rt(u,Z.observationsTimeSpan)}function Ue(u,I){let R=_[I];R.color=u,R.fillColor=u}function Pe(u){console.log(u,`observations: ${Object.keys(_).length}`,`observationIds: ${h.size}`,`activeObservationsIds: ${S.size}`)}function ie(u){t(6,D=zl(u,D))}function X(){t(14,m=!0);let u=Ht(Object.values(_),ul,Z.observationsTimeSpan);t(9,P=Rt(u,Z.observationsTimeSpan)),t(6,D={}),Z.observationsTimeSpan!=="all"&&P.forEach((I,R)=>t(6,D[R]=!0,D)),t(14,m=!1)}function Fe(u){let I=E.map(R=>R.taxon_id).indexOf(u);t(5,E[I].showInatGrid=!E[I].showInatGrid,E)}function Ne(u){let I=E.map(R=>R.taxon_id).indexOf(u);t(5,E[I].showInatTaxonRange=!E[I].showInatTaxonRange,E)}function ne(u){t(24,ge=u.detail)}function Be(u){t(18,te=u.detail.observationsOnMapCount),t(17,be=u.detail.observationsSelectedCount),t(19,$=u.detail.speciesCount),t(20,ye=u.detail.speciesDisplayCount),t(21,oe=u.detail.speciesList),t(23,z=u.detail.showSpeciesListIcon);let I=u.detail.observationsOnMap;Array.isArray(I)?t(47,y=I):(t(47,y=[]),I.forEach((R,M)=>{t(47,y=y.concat(R))}))}function Le(u){t(25,ke=!0),t(16,K=_[u.detail.observation_id])}function ot(){t(22,F=!F)}let et;wl(async()=>{const u=await Ge(()=>import("../../../../chunks/explore_data_map-b9988a17.js"),["chunks/explore_data_map-b9988a17.js","chunks/vendor-a1a75673.js","assets/vendor-626d706b.css","chunks/index-362d2c56.js","assets/index-655e5209.css","chunks/mapUtils-e9636914.js","chunks/observation_data-2b3f5cba.js","assets/observation_data-ce6973a6.css","chunks/formatUtils-77b182ad.js","chunks/constants-3d7024b8.js","chunks/map_toggle_marker_type_button-08db13d1.js","chunks/TileLayer-4989d50e.js","chunks/CircleMarker-7510bcf0.js"]);t(28,et=u.default),t(14,m=!1),t(15,w=!0)});const at=u=>t(26,Ie=u.detail.showMore);function He(u){p=u,t(8,p)}const le=()=>de(),ae=()=>Te(),he=u=>t(27,re=u.detail.showMore);function se(){T=this.checked,t(12,T)}function ce(){V=this.checked,t(13,V)}const qe=()=>t(25,ke=!1);function nt(){fe=this.checked,t(7,fe)}return l.$$set=u=>{"project"in u&&t(0,a=u.project),"user"in u&&t(1,s=u.user),"currentTab"in u&&t(2,o=u.currentTab),"projectObservations"in u&&t(45,r=u.projectObservations),"taxa"in u&&t(3,f=u.taxa),"projectPath"in u&&t(4,c=u.projectPath)},l.$$.update=()=>{if(l.$$.dirty[0]&33&&E.length===0&&(t(10,j=a.slug!=="los-angeles-bioblitz"),t(11,O=a.slug==="los-angeles-bioblitz"),t(6,D={}),t(16,K=null)),l.$$.dirty[0]&225|l.$$.dirty[1]&65536&&E.length>0&&fe){let u=y,I;Z.observationsTimeSpan=="all"?I=Ut(Q,st,E,u):Z.observationsTimeSpan=="month"?I=Bt(ee,st,E,D,u,a):I=Ft(ee,st,E,D,u,a),qt(I,fl)}if(l.$$.dirty[0]&225|l.$$.dirty[1]&32768&&E.length>0&&!fe){let u=Object.values(_),I;Z.observationsTimeSpan=="all"?I=Ut(Q,st,E,u):Z.observationsTimeSpan=="month"?I=Bt(ee,st,E,D,u,a):I=Ft(ee,st,E,D,u,a),qt(I,fl)}},[a,s,o,f,c,E,D,fe,p,P,j,O,T,V,m,w,K,be,te,$,ye,oe,F,z,ge,ke,Ie,re,et,Z,Se,_e,de,Te,x,J,Y,ie,X,Fe,Ne,ne,Be,Le,ot,r,_,y,at,He,le,ae,he,se,ce,qe,nt]}class Ha extends mt{constructor(e){super();pt(this,e,Da,Oa,bt,{project:0,user:1,currentTab:2,projectObservations:45,taxa:3,projectPath:4},null,[-1,-1,-1])}}export{Ha as default,Ra as load};
