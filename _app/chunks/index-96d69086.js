import{ai as ee,aj as ne,S as k,i as D,s as C,e as ie,c as te,a as se,d as F,f as ae,J as A,W as oe,ah as re,a0 as T,a5 as fe,a1 as z,v as K,w as G,x as J,Y as M,p as U,n as Y,A as B,ac as L}from"./vendor-358d5d08.js";const ce=new Set(["width","height"]);function ue(n,e){Object.keys(e).forEach(i=>{const s=e[i];s&&(!!s&&{}.toString.call(s)==="[object Function]"?s(n.data(i)):n.change(i,ee.changeset().remove(()=>!0).insert(s)))})}function E(n={},e={},i=new Set){const s=Object.keys(n),o=Object.keys(e);return n===e||s.length===o.length&&s.filter(u=>!i.has(u)).every(u=>n[u]===e[u])}function Q(n,e){const i=Object.keys(e);return i.forEach(s=>{try{n.removeSignalListener(s,e[s])}catch(o){console.warn("Cannot remove invalid signal listener.",o)}}),i.length>0}function q(n,e){const i=Object.keys(e);return i.forEach(s=>{try{n.addSignalListener(s,e[s])}catch(o){console.warn("Cannot add invalid signal listener.",o)}}),i.length>0}function he(n){const e=new Set;return n.forEach(i=>{Object.keys(i).forEach(s=>{e.add(s)})}),e}function ge(n,e){if(n===e)return!1;const i={width:!1,height:!1,isExpensive:!1},s="width"in n||"width"in e,o="height"in n||"height"in e;return s&&(!("width"in n)||!("width"in e)||n.width!==e.width)&&("width"in n&&typeof n.width=="number"?i.width=n.width:i.isExpensive=!0),o&&(!("height"in n)||!("height"in e)||n.height!==e.height)&&("height"in n&&typeof n.height=="number"?i.height=n.height:i.isExpensive=!0),[...he([n,e])].filter(t=>t!=="width"&&t!=="height").some(t=>!(t in n)||!(t in e)||!ne(n[t],e[t]))&&(i.isExpensive=!0),i.width!==!1||i.height!==!1||i.isExpensive?i:!1}function R(n,e){const{width:i,height:s}=e;return typeof i!="undefined"&&typeof s!="undefined"?Object.assign(Object.assign({},n),{width:i,height:s}):typeof i!="undefined"?Object.assign(Object.assign({},n),{width:i}):typeof s!="undefined"?Object.assign(Object.assign({},n),{height:s}):n}function de(n){let e;return{c(){e=ie("div")},l(i){e=te(i,"DIV",{}),se(e).forEach(F)},m(i,s){ae(i,e,s),n[11](e)},p:A,i:A,o:A,d(i){i&&F(e),n[11](null)}}}function le(n,e,i){var s=this&&this.__awaiter||function(r,l,g,v){function S(_){return _ instanceof g?_:new g(function(y){y(_)})}return new(g||(g=Promise))(function(_,y){function x(w){try{O(v.next(w))}catch(N){y(N)}}function $(w){try{O(v.throw(w))}catch(N){y(N)}}function O(w){w.done?_(w.value):S(w.value).then(x,$)}O((v=v.apply(r,l||[])).next())})};let{options:o}=e,{spec:u}=e,{view:t}=e,{signalListeners:f={}}=e,{data:c={}}=e;const m=oe();let h,d={},a={},V={},j={},b;re(()=>{I()});function H(){return s(this,void 0,void 0,function*(){I();try{i(6,h=yield fe(b,u,o)),i(1,t=h.view),q(t,f)&&t.runAsync(),P(t)}catch(r){Z(r)}})}function I(){h&&(h.finalize(),i(6,h=void 0),i(1,t=void 0))}function Z(r){m("onError",{error:r}),console.warn(r)}function P(r){W(),m("onNewView",{view:r})}function W(){return s(this,void 0,void 0,function*(){c&&Object.keys(c).length>0&&h!==void 0&&(i(1,t=h.view),ue(t,c),yield t.resize().runAsync())})}function p(r){T[r?"unshift":"push"](()=>{b=r,i(0,b)})}return n.$$set=r=>{"options"in r&&i(2,o=r.options),"spec"in r&&i(3,u=r.spec),"view"in r&&i(1,t=r.view),"signalListeners"in r&&i(4,f=r.signalListeners),"data"in r&&i(5,c=r.data)},n.$$.update=()=>{if(n.$$.dirty&1056&&(E(c,j)||W(),i(10,j=c)),n.$$.dirty&991&&b!==void 0){if(!E(o,d,ce))H();else{const r=ge(R(u,o),R(V,d)),l=f,g=a;if(r){if(r.isExpensive)H();else if(h!==void 0){const v=!E(l,g);i(1,t=h.view),r.width!==!1&&t.width(r.width),r.height!==!1&&t.height(r.height),v&&(g&&Q(t,g),l&&q(t,l)),t.runAsync()}}else!E(l,g)&&h!==void 0&&(i(1,t=h.view),g&&Q(t,g),l&&q(t,l),t.runAsync())}i(7,d=o),i(8,a=f),i(9,V=u)}},[b,t,o,u,f,c,h,d,a,V,j,p]}class X extends k{constructor(e){super();D(this,e,le,de,C,{options:2,spec:3,view:1,signalListeners:4,data:5})}}function we(n){let e,i,s;function o(t){n[6](t)}let u={spec:n[1],data:n[2],signalListeners:n[3],options:n[4]};return n[0]!==void 0&&(u.view=n[0]),e=new X({props:u}),T.push(()=>z(e,"view",o)),e.$on("onNewView",n[7]),e.$on("onError",n[8]),{c(){K(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,f){J(e,t,f),s=!0},p(t,[f]){const c={};f&2&&(c.spec=t[1]),f&4&&(c.data=t[2]),f&8&&(c.signalListeners=t[3]),f&16&&(c.options=t[4]),!i&&f&1&&(i=!0,c.view=t[0],M(()=>i=!1)),e.$set(c)},i(t){s||(U(e.$$.fragment,t),s=!0)},o(t){Y(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}const me="vega";function ve(n,e,i){let s,{view:o}=e,{spec:u}=e,{options:t={}}=e,{data:f={}}=e,{signalListeners:c={}}=e;function m(a){o=a,i(0,o)}function h(a){L.call(this,n,a)}function d(a){L.call(this,n,a)}return n.$$set=a=>{"view"in a&&i(0,o=a.view),"spec"in a&&i(1,u=a.spec),"options"in a&&i(5,t=a.options),"data"in a&&i(2,f=a.data),"signalListeners"in a&&i(3,c=a.signalListeners)},n.$$.update=()=>{n.$$.dirty&32&&i(4,s=Object.assign(Object.assign({},t),{mode:me}))},[o,u,f,c,s,t,m,h,d]}class be extends k{constructor(e){super();D(this,e,ve,we,C,{view:0,spec:1,options:5,data:2,signalListeners:3})}}var je=be;function _e(n){let e,i,s;function o(t){n[6](t)}let u={spec:n[1],data:n[2],signalListeners:n[3],options:n[4]};return n[0]!==void 0&&(u.view=n[0]),e=new X({props:u}),T.push(()=>z(e,"view",o)),e.$on("onNewView",n[7]),e.$on("onError",n[8]),{c(){K(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,f){J(e,t,f),s=!0},p(t,[f]){const c={};f&2&&(c.spec=t[1]),f&4&&(c.data=t[2]),f&8&&(c.signalListeners=t[3]),f&16&&(c.options=t[4]),!i&&f&1&&(i=!0,c.view=t[0],M(()=>i=!1)),e.$set(c)},i(t){s||(U(e.$$.fragment,t),s=!0)},o(t){Y(e.$$.fragment,t),s=!1},d(t){B(e,t)}}}const ye="vega-lite";function Le(n,e,i){let s,{view:o}=e,{spec:u}=e,{options:t={}}=e,{data:f={}}=e,{signalListeners:c={}}=e;function m(a){o=a,i(0,o)}function h(a){L.call(this,n,a)}function d(a){L.call(this,n,a)}return n.$$set=a=>{"view"in a&&i(0,o=a.view),"spec"in a&&i(1,u=a.spec),"options"in a&&i(5,t=a.options),"data"in a&&i(2,f=a.data),"signalListeners"in a&&i(3,c=a.signalListeners)},n.$$.update=()=>{n.$$.dirty&32&&i(4,s=Object.assign(Object.assign({},t),{mode:ye}))},[o,u,f,c,s,t,m,h,d]}class Ee extends k{constructor(e){super();D(this,e,Le,_e,C,{view:0,spec:1,options:5,data:2,signalListeners:3})}}var Oe=Ee;export{je as Vega,Oe as VegaLite};
