function Qi(){}const ry=e=>e;function j8(e,t){for(const n in t)e[n]=t[n];return e}function dA(e){return e()}function hA(){return Object.create(null)}function sa(e){e.forEach(dA)}function Yc(e){return typeof e=="function"}function gA(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let Jh;function Dve(e,t){return Jh||(Jh=document.createElement("a")),Jh.href=t,e===Jh.href}function $8(e){return Object.keys(e).length===0}function L8(e,...t){if(e==null)return Qi;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function Mve(e,t,n){e.$$.on_destroy.push(L8(t,n))}function Xc(e,t,n,i){if(e){const r=pA(e,t,n,i);return e[0](r)}}function pA(e,t,n,i){return e[1]&&i?j8(n.ctx.slice(),e[1](i(t))):n.ctx}function Kc(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(t.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=t.dirty[s]|r[s];return o}return t.dirty|r}return t.dirty}function Jc(e,t,n,i,r,o){if(r){const a=pA(t,n,i,o);e.p(a,r)}}function Qc(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let i=0;i<n;i++)t[i]=-1;return t}return-1}function Nve(e){return e&&Yc(e.destroy)?e.destroy:Qi}const mA=typeof window!="undefined";let yA=mA?()=>window.performance.now():()=>Date.now(),oy=mA?e=>requestAnimationFrame(e):Qi;const Xu=new Set;function vA(e){Xu.forEach(t=>{t.c(e)||(Xu.delete(t),t.f())}),Xu.size!==0&&oy(vA)}function bA(e){let t;return Xu.size===0&&oy(vA),{promise:new Promise(n=>{Xu.add(t={c:e,f:n})}),abort(){Xu.delete(t)}}}let Qh=!1;function I8(){Qh=!0}function P8(){Qh=!1}function z8(e,t,n,i){for(;e<t;){const r=e+(t-e>>1);n(r)<=i?e=r+1:t=r}return e}function B8(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if(e.nodeName==="HEAD"){const u=[];for(let l=0;l<t.length;l++){const c=t[l];c.claim_order!==void 0&&u.push(c)}t=u}const n=new Int32Array(t.length+1),i=new Int32Array(t.length);n[0]=-1;let r=0;for(let u=0;u<t.length;u++){const l=t[u].claim_order,c=(r>0&&t[n[r]].claim_order<=l?r+1:z8(1,r,d=>t[n[d]].claim_order,l))-1;i[u]=n[c]+1;const f=c+1;n[f]=u,r=Math.max(f,r)}const o=[],a=[];let s=t.length-1;for(let u=n[r]+1;u!=0;u=i[u-1]){for(o.push(t[u-1]);s>=u;s--)a.push(t[s]);s--}for(;s>=0;s--)a.push(t[s]);o.reverse(),a.sort((u,l)=>u.claim_order-l.claim_order);for(let u=0,l=0;u<a.length;u++){for(;l<o.length&&a[u].claim_order>=o[l].claim_order;)l++;const c=l<o.length?o[l]:null;e.insertBefore(a[u],c)}}function U8(e,t){e.appendChild(t)}function xA(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function q8(e){const t=Ft("style");return W8(xA(e),t),t}function W8(e,t){U8(e.head||e,t)}function Ot(e,t){if(Qh){for(B8(e),(e.actual_end_child===void 0||e.actual_end_child!==null&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);e.actual_end_child!==null&&e.actual_end_child.claim_order===void 0;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?(t.claim_order!==void 0||t.parentNode!==e)&&e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else(t.parentNode!==e||t.nextSibling!==null)&&e.appendChild(t)}function H8(e,t,n){e.insertBefore(t,n||null)}function ct(e,t,n){Qh&&!n?Ot(e,t):(t.parentNode!==e||t.nextSibling!=n)&&e.insertBefore(t,n||null)}function we(e){e.parentNode.removeChild(e)}function ay(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function Ft(e){return document.createElement(e)}function G8(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function gi(e){return document.createTextNode(e)}function ua(){return gi(" ")}function un(){return gi("")}function pi(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function V8(e){return function(t){return t.preventDefault(),e.call(this,t)}}function Rve(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function Te(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ln(e){return Array.from(e.childNodes)}function wA(e){e.claim_info===void 0&&(e.claim_info={last_index:0,total_claimed:0})}function _A(e,t,n,i,r=!1){wA(e);const o=(()=>{for(let a=e.claim_info.last_index;a<e.length;a++){const s=e[a];if(t(s)){const u=n(s);return u===void 0?e.splice(a,1):e[a]=u,r||(e.claim_info.last_index=a),s}}for(let a=e.claim_info.last_index-1;a>=0;a--){const s=e[a];if(t(s)){const u=n(s);return u===void 0?e.splice(a,1):e[a]=u,r?u===void 0&&e.claim_info.last_index--:e.claim_info.last_index=a,s}}return i()})();return o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,o}function EA(e,t,n,i){return _A(e,r=>r.nodeName===t,r=>{const o=[];for(let a=0;a<r.attributes.length;a++){const s=r.attributes[a];n[s.name]||o.push(s.name)}o.forEach(a=>r.removeAttribute(a))},()=>i(t))}function cn(e,t,n){return EA(e,t,n,Ft)}function jve(e,t,n){return EA(e,t,n,G8)}function Zi(e,t){return _A(e,n=>n.nodeType===3,n=>{const i=""+t;if(n.data.startsWith(i)){if(n.data.length!==i.length)return n.splitText(i.length)}else n.data=i},()=>gi(t),!0)}function la(e){return Zi(e," ")}function OA(e,t,n){for(let i=n;i<e.length;i+=1){const r=e[i];if(r.nodeType===8&&r.textContent.trim()===t)return i}return e.length}function SA(e){const t=OA(e,"HTML_TAG_START",0),n=OA(e,"HTML_TAG_END",t);if(t===n)return new Zh;wA(e);const i=e.splice(t,n+1);we(i[0]),we(i[i.length-1]);const r=i.slice(1,i.length-1);for(const o of r)o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1;return new Zh(r)}function Ss(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function AA(e,t){e.value=t==null?"":t}function $ve(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}function Lve(e,t){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t){i.selected=!0;return}}e.selectedIndex=-1}function Ive(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function Ku(e,t,n){e.classList[n?"add":"remove"](t)}function kA(e,t,n=!1){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,!1,t),i}class Y8{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,n,i=null){this.e||(this.e=Ft(n.nodeName),this.t=n,this.c(t)),this.i(i)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)H8(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(we)}}class Zh extends Y8{constructor(t){super();this.e=this.n=null,this.l=t}c(t){this.l?this.n=this.l:super.c(t)}i(t){for(let n=0;n<this.n.length;n+=1)ct(this.t,this.n[n],t)}}const sy=new Set;let eg=0;function X8(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function CA(e,t,n,i,r,o,a,s=0){const u=16.666/i;let l=`{
`;for(let m=0;m<=1;m+=u){const y=t+(n-t)*o(m);l+=m*100+`%{${a(y,1-y)}}
`}const c=l+`100% {${a(n,1-n)}}
}`,f=`__svelte_${X8(c)}_${s}`,d=xA(e);sy.add(d);const h=d.__svelte_stylesheet||(d.__svelte_stylesheet=q8(e).sheet),g=d.__svelte_rules||(d.__svelte_rules={});g[f]||(g[f]=!0,h.insertRule(`@keyframes ${f} ${c}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${i}ms linear ${r}ms 1 both`,eg+=1,f}function uy(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),r=n.length-i.length;r&&(e.style.animation=i.join(", "),eg-=r,eg||K8())}function K8(){oy(()=>{eg||(sy.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),sy.clear())})}let tg;function ng(e){tg=e}function Ju(){if(!tg)throw new Error("Function called outside component initialization");return tg}function Pve(e){Ju().$$.on_mount.push(e)}function zve(e){Ju().$$.after_update.push(e)}function Bve(e){Ju().$$.on_destroy.push(e)}function Uve(){const e=Ju();return(t,n)=>{const i=e.$$.callbacks[t];if(i){const r=kA(t,n);i.slice().forEach(o=>{o.call(e,r)})}}}function qve(e,t){Ju().$$.context.set(e,t)}function Wve(e){return Ju().$$.context.get(e)}function Hve(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(i=>i.call(this,t))}const Zc=[],ig=[],rg=[],ly=[],J8=Promise.resolve();let cy=!1;function Q8(){cy||(cy=!0,J8.then(TA))}function ef(e){rg.push(e)}function Gve(e){ly.push(e)}let fy=!1;const dy=new Set;function TA(){if(!fy){fy=!0;do{for(let e=0;e<Zc.length;e+=1){const t=Zc[e];ng(t),Z8(t.$$)}for(ng(null),Zc.length=0;ig.length;)ig.pop()();for(let e=0;e<rg.length;e+=1){const t=rg[e];dy.has(t)||(dy.add(t),t())}rg.length=0}while(Zc.length);for(;ly.length;)ly.pop()();cy=!1,fy=!1,dy.clear()}}function Z8(e){if(e.fragment!==null){e.update(),sa(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ef)}}let tf;function FA(){return tf||(tf=Promise.resolve(),tf.then(()=>{tf=null})),tf}function og(e,t,n){e.dispatchEvent(kA(`${t?"intro":"outro"}${n}`))}const ag=new Set;let ca;function Qu(){ca={r:0,c:[],p:ca}}function Zu(){ca.r||sa(ca.c),ca=ca.p}function ft(e,t){e&&e.i&&(ag.delete(e),e.i(t))}function Lt(e,t,n,i){if(e&&e.o){if(ag.has(e))return;ag.add(e),ca.c.push(()=>{ag.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}const DA={duration:0};function Vve(e,t,n){let i=t(e,n),r=!1,o,a,s=0;function u(){o&&uy(e,o)}function l(){const{delay:f=0,duration:d=300,easing:h=ry,tick:g=Qi,css:p}=i||DA;p&&(o=CA(e,0,1,d,f,h,p,s++)),g(0,1);const m=yA()+f,y=m+d;a&&a.abort(),r=!0,ef(()=>og(e,!0,"start")),a=bA(v=>{if(r){if(v>=y)return g(1,0),og(e,!0,"end"),u(),r=!1;if(v>=m){const x=h((v-m)/d);g(x,1-x)}}return r})}let c=!1;return{start(){c||(c=!0,uy(e),Yc(i)?(i=i(),FA().then(l)):l())},invalidate(){c=!1},end(){r&&(u(),r=!1)}}}function Yve(e,t,n){let i=t(e,n),r=!0,o;const a=ca;a.r+=1;function s(){const{delay:u=0,duration:l=300,easing:c=ry,tick:f=Qi,css:d}=i||DA;d&&(o=CA(e,1,0,l,u,c,d));const h=yA()+u,g=h+l;ef(()=>og(e,!1,"start")),bA(p=>{if(r){if(p>=g)return f(0,1),og(e,!1,"end"),--a.r||sa(a.c),!1;if(p>=h){const m=c((p-h)/l);f(1-m,m)}}return r})}return Yc(i)?FA().then(()=>{i=i(),s()}):s(),{end(u){u&&i.tick&&i.tick(1,0),r&&(o&&uy(e,o),r=!1)}}}const Xve=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Kve(e,t){Lt(e,1,1,()=>{t.delete(e.key)})}function Jve(e,t,n,i,r,o,a,s,u,l,c,f){let d=e.length,h=o.length,g=d;const p={};for(;g--;)p[e[g].key]=g;const m=[],y=new Map,v=new Map;for(g=h;g--;){const E=f(r,o,g),w=n(E);let O=a.get(w);O?i&&O.p(E,t):(O=l(w,E),O.c()),y.set(w,m[g]=O),w in p&&v.set(w,Math.abs(g-p[w]))}const x=new Set,b=new Set;function _(E){ft(E,1),E.m(s,c),a.set(E.key,E),c=E.first,h--}for(;d&&h;){const E=m[h-1],w=e[d-1],O=E.key,S=w.key;E===w?(c=E.first,d--,h--):y.has(S)?!a.has(O)||x.has(O)?_(E):b.has(S)?d--:v.get(O)>v.get(S)?(b.add(O),_(E)):(x.add(S),d--):(u(w,a),d--)}for(;d--;){const E=e[d];y.has(E.key)||u(E,a)}for(;h;)_(m[h-1]);return m}function Qve(e,t){const n={},i={},r={$$scope:1};let o=e.length;for(;o--;){const a=e[o],s=t[o];if(s){for(const u in a)u in s||(i[u]=1);for(const u in s)r[u]||(n[u]=s[u],r[u]=1);e[o]=s}else for(const u in a)r[u]=1}for(const a in i)a in n||(n[a]=void 0);return n}function Zve(e){return typeof e=="object"&&e!==null?e:{}}function ebe(e,t,n){const i=e.$$.props[t];i!==void 0&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function tbe(e){e&&e.c()}function nbe(e,t){e&&e.l(t)}function e7(e,t,n,i){const{fragment:r,on_mount:o,on_destroy:a,after_update:s}=e.$$;r&&r.m(t,n),i||ef(()=>{const u=o.map(dA).filter(Yc);a?a.push(...u):sa(u),e.$$.on_mount=[]}),s.forEach(ef)}function t7(e,t){const n=e.$$;n.fragment!==null&&(sa(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function n7(e,t){e.$$.dirty[0]===-1&&(Zc.push(e),Q8(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function i7(e,t,n,i,r,o,a,s=[-1]){const u=tg;ng(e);const l=e.$$={fragment:null,ctx:null,props:o,update:Qi,not_equal:r,bound:hA(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:hA(),dirty:s,skip_bound:!1,root:t.target||u.$$.root};a&&a(l.root);let c=!1;if(l.ctx=n?n(e,t.props||{},(f,d,...h)=>{const g=h.length?h[0]:d;return l.ctx&&r(l.ctx[f],l.ctx[f]=g)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](g),c&&n7(e,f)),d}):[],l.update(),c=!0,sa(l.before_update),l.fragment=i?i(l.ctx):!1,t.target){if(t.hydrate){I8();const f=ln(t.target);l.fragment&&l.fragment.l(f),f.forEach(we)}else l.fragment&&l.fragment.c();t.intro&&ft(e.$$.fragment),e7(e,t.target,t.anchor,t.customElement),P8(),TA()}ng(u)}class r7{$destroy(){t7(this,1),this.$destroy=Qi}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!$8(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const el=[];function ibe(e,t=Qi){let n;const i=new Set;function r(s){if(gA(e,s)&&(e=s,n)){const u=!el.length;for(const l of i)l[1](),el.push(l,e);if(u){for(let l=0;l<el.length;l+=2)el[l][0](el[l+1]);el.length=0}}}function o(s){r(s(e))}function a(s,u=Qi){const l=[s,u];return i.add(l),i.size===1&&(n=t(r)||Qi),s(e),()=>{i.delete(l),i.size===0&&(n(),n=null)}}return{set:r,update:o,subscribe:a}}const o7=e=>({noResultsText:e[0]&2048}),MA=e=>({noResultsText:e[11]}),a7=e=>({createText:e[0]&8192}),NA=e=>({createText:e[13]}),s7=e=>({loadingText:e[0]&4096}),RA=e=>({loadingText:e[12]});function jA(e,t,n){const i=e.slice();return i[108]=t[n],i[110]=n,i}const u7=e=>({item:e[0]&134217728,label:e[0]&134217728}),$A=e=>({item:e[108].item,label:e[108].highlighted?e[108].highlighted:e[108].label});function LA(e,t,n){const i=e.slice();return i[111]=t[n],i}const l7=e=>({label:e[0]&2,item:e[0]&2}),IA=e=>({label:e[34](e[111]),item:e[111],unselectItem:e[41]});function PA(e,t,n){const i=e.slice();return i[110]=t[n],i}function c7(e){let t,n=e[1],i=[];for(let r=0;r<n.length;r+=1)i[r]=zA(PA(e,n,r));return{c(){for(let r=0;r<i.length;r+=1)i[r].c();t=un()},l(r){for(let o=0;o<i.length;o+=1)i[o].l(r);t=un()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);ct(r,t,o)},p(r,o){if(o[0]&18|o[1]&8){n=r[1];let a;for(a=0;a<n.length;a+=1){const s=PA(r,n,a);i[a]?i[a].p(s,o):(i[a]=zA(s),i[a].c(),i[a].m(t.parentNode,t))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(r){ay(i,r),r&&we(t)}}}function f7(e){let t,n;return{c(){t=Ft("option"),n=gi(e[3]),this.h()},l(i){t=cn(i,"OPTION",{class:!0});var r=ln(t);n=Zi(r,e[3]),r.forEach(we),this.h()},h(){t.__value=e[2],t.value=t.__value,t.selected=!0,Te(t,"class","svelte-878r4m")},m(i,r){ct(i,t,r),Ot(t,n)},p(i,r){r[0]&8&&Ss(n,i[3]),r[0]&4&&(t.__value=i[2],t.value=t.__value)},d(i){i&&we(t)}}}function zA(e){let t,n=e[34](e[110])+"",i,r,o;return{c(){t=Ft("option"),i=gi(n),r=ua(),this.h()},l(a){t=cn(a,"OPTION",{class:!0});var s=ln(t);i=Zi(s,n),r=la(s),s.forEach(we),this.h()},h(){t.__value=o=e[4](e[110],!0),t.value=t.__value,t.selected=!0,Te(t,"class","svelte-878r4m")},m(a,s){ct(a,t,s),Ot(t,i),Ot(t,r)},p(a,s){s[0]&2&&n!==(n=a[34](a[110])+"")&&Ss(i,n),s[0]&18&&o!==(o=a[4](a[110],!0))&&(t.__value=o,t.value=t.__value)},d(a){a&&we(t)}}}function BA(e){let t,n,i=e[1],r=[];for(let a=0;a<i.length;a+=1)r[a]=UA(LA(e,i,a));const o=a=>Lt(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();t=un()},l(a){for(let s=0;s<r.length;s+=1)r[s].l(a);t=un()},m(a,s){for(let u=0;u<r.length;u+=1)r[u].m(a,s);ct(a,t,s),n=!0},p(a,s){if(s[0]&2|s[1]&1032|s[2]&8192){i=a[1];let u;for(u=0;u<i.length;u+=1){const l=LA(a,i,u);r[u]?(r[u].p(l,s),ft(r[u],1)):(r[u]=UA(l),r[u].c(),ft(r[u],1),r[u].m(t.parentNode,t))}for(Qu(),u=i.length;u<r.length;u+=1)o(u);Zu()}},i(a){if(!n){for(let s=0;s<i.length;s+=1)ft(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Lt(r[s]);n=!1},d(a){ay(r,a),a&&we(t)}}}function d7(e){let t,n,i=e[34](e[111])+"",r,o,a,s,u,l;return{c(){t=Ft("div"),n=Ft("span"),r=gi(i),o=ua(),a=Ft("span"),s=ua(),this.h()},l(c){t=cn(c,"DIV",{class:!0});var f=ln(t);n=cn(f,"SPAN",{class:!0});var d=ln(n);r=Zi(d,i),d.forEach(we),o=la(f),a=cn(f,"SPAN",{class:!0}),ln(a).forEach(we),f.forEach(we),s=la(c),this.h()},h(){Te(n,"class","tag svelte-878r4m"),Te(a,"class","tag is-delete svelte-878r4m"),Te(t,"class","tags has-addons svelte-878r4m")},m(c,f){ct(c,t,f),Ot(t,n),Ot(n,r),Ot(t,o),Ot(t,a),ct(c,s,f),u||(l=pi(a,"click",V8(function(){Yc(e[41](e[111]))&&e[41](e[111]).apply(this,arguments)})),u=!0)},p(c,f){e=c,f[0]&2&&i!==(i=e[34](e[111])+"")&&Ss(r,i)},d(c){c&&we(t),c&&we(s),u=!1,l()}}}function UA(e){let t;const n=e[76].tag,i=Xc(n,e,e[75],IA),r=i||d7(e);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,a){r&&r.m(o,a),t=!0},p(o,a){i?i.p&&(!t||a[0]&2|a[2]&8192)&&Jc(i,n,o,o[75],t?Kc(n,o[75],a,l7):Qc(o[75]),IA):r&&r.p&&(!t||a[0]&2)&&r.p(o,t?a:[-1,-1,-1,-1])},i(o){t||(ft(r,o),t=!0)},o(o){Lt(r,o),t=!1},d(o){r&&r.d(o)}}}function qA(e){let t,n,i,r;return{c(){t=Ft("span"),n=gi("\u2716"),this.h()},l(o){t=cn(o,"SPAN",{class:!0});var a=ln(t);n=Zi(a,"\u2716"),a.forEach(we),this.h()},h(){Te(t,"class","autocomplete-clear-button svelte-878r4m")},m(o,a){ct(o,t,a),Ot(t,n),i||(r=pi(t,"click",e[45]),i=!0)},p:Qi,d(o){o&&we(t),i=!1,r()}}}function h7(e){let t,n;const i=e[76]["no-results"],r=Xc(i,e,e[75],MA),o=r||y7(e);return{c(){t=Ft("div"),o&&o.c(),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);o&&o.l(s),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-no-results svelte-878r4m")},m(a,s){ct(a,t,s),o&&o.m(t,null),n=!0},p(a,s){r?r.p&&(!n||s[0]&2048|s[2]&8192)&&Jc(r,i,a,a[75],n?Kc(i,a[75],s,o7):Qc(a[75]),MA):o&&o.p&&(!n||s[0]&2048)&&o.p(a,n?s:[-1,-1,-1,-1])},i(a){n||(ft(o,a),n=!0)},o(a){Lt(o,a),n=!1},d(a){a&&we(t),o&&o.d(a)}}}function g7(e){let t,n,i,r;const o=e[76].create,a=Xc(o,e,e[75],NA),s=a||v7(e);return{c(){t=Ft("div"),s&&s.c(),this.h()},l(u){t=cn(u,"DIV",{class:!0});var l=ln(t);s&&s.l(l),l.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-create svelte-878r4m")},m(u,l){ct(u,t,l),s&&s.m(t,null),n=!0,i||(r=pi(t,"click",e[35]),i=!0)},p(u,l){a?a.p&&(!n||l[0]&8192|l[2]&8192)&&Jc(a,o,u,u[75],n?Kc(o,u[75],l,a7):Qc(u[75]),NA):s&&s.p&&(!n||l[0]&8192)&&s.p(u,n?l:[-1,-1,-1,-1])},i(u){n||(ft(s,u),n=!0)},o(u){Lt(s,u),n=!1},d(u){u&&we(t),s&&s.d(u),i=!1,r()}}}function p7(e){let t,n;const i=e[76].loading,r=Xc(i,e,e[75],RA),o=r||b7(e);return{c(){t=Ft("div"),o&&o.c(),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);o&&o.l(s),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-loading svelte-878r4m")},m(a,s){ct(a,t,s),o&&o.m(t,null),n=!0},p(a,s){r?r.p&&(!n||s[0]&4096|s[2]&8192)&&Jc(r,i,a,a[75],n?Kc(i,a[75],s,s7):Qc(a[75]),RA):o&&o.p&&(!n||s[0]&4096)&&o.p(a,n?s:[-1,-1,-1,-1])},i(a){n||(ft(o,a),n=!0)},o(a){Lt(o,a),n=!1},d(a){a&&we(t),o&&o.d(a)}}}function m7(e){let t,n,i,r=e[27],o=[];for(let u=0;u<r.length;u+=1)o[u]=GA(jA(e,r,u));const a=u=>Lt(o[u],1,1,()=>{o[u]=null});let s=e[5]>0&&e[27].length>e[5]&&VA(e);return{c(){for(let u=0;u<o.length;u+=1)o[u].c();t=ua(),s&&s.c(),n=un()},l(u){for(let l=0;l<o.length;l+=1)o[l].l(u);t=la(u),s&&s.l(u),n=un()},m(u,l){for(let c=0;c<o.length;c+=1)o[c].m(u,l);ct(u,t,l),s&&s.m(u,l),ct(u,n,l),i=!0},p(u,l){if(l[0]&201326624|l[1]&32800|l[2]&8192){r=u[27];let c;for(c=0;c<r.length;c+=1){const f=jA(u,r,c);o[c]?(o[c].p(f,l),ft(o[c],1)):(o[c]=GA(f),o[c].c(),ft(o[c],1),o[c].m(t.parentNode,t))}for(Qu(),c=r.length;c<o.length;c+=1)a(c);Zu()}u[5]>0&&u[27].length>u[5]?s?s.p(u,l):(s=VA(u),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(u){if(!i){for(let l=0;l<r.length;l+=1)ft(o[l]);i=!0}},o(u){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)Lt(o[l]);i=!1},d(u){ay(o,u),u&&we(t),s&&s.d(u),u&&we(n)}}}function y7(e){let t;return{c(){t=gi(e[11])},l(n){t=Zi(n,e[11])},m(n,i){ct(n,t,i)},p(n,i){i[0]&2048&&Ss(t,n[11])},d(n){n&&we(t)}}}function v7(e){let t;return{c(){t=gi(e[13])},l(n){t=Zi(n,e[13])},m(n,i){ct(n,t,i)},p(n,i){i[0]&8192&&Ss(t,n[13])},d(n){n&&we(t)}}}function b7(e){let t;return{c(){t=gi(e[12])},l(n){t=Zi(n,e[12])},m(n,i){ct(n,t,i)},p(n,i){i[0]&4096&&Ss(t,n[12])},d(n){n&&we(t)}}}function WA(e){let t,n,i=e[108]&&HA(e);return{c(){i&&i.c(),t=un()},l(r){i&&i.l(r),t=un()},m(r,o){i&&i.m(r,o),ct(r,t,o),n=!0},p(r,o){r[108]?i?(i.p(r,o),o[0]&134217728&&ft(i,1)):(i=HA(r),i.c(),ft(i,1),i.m(t.parentNode,t)):i&&(Qu(),Lt(i,1,1,()=>{i=null}),Zu())},i(r){n||(ft(i),n=!0)},o(r){Lt(i),n=!1},d(r){i&&i.d(r),r&&we(t)}}}function HA(e){let t,n,i,r,o;const a=e[76].item,s=Xc(a,e,e[75],$A),u=s||_7(e);function l(){return e[79](e[108])}function c(){return e[80](e[110])}return{c(){t=Ft("div"),u&&u.c(),this.h()},l(f){t=cn(f,"DIV",{class:!0});var d=ln(t);u&&u.l(d),d.forEach(we),this.h()},h(){Te(t,"class",n="autocomplete-list-item "+(e[110]===e[26]?"selected":"")+" svelte-878r4m"),Ku(t,"confirmed",e[46](e[108].item))},m(f,d){ct(f,t,d),u&&u.m(t,null),i=!0,r||(o=[pi(t,"click",l),pi(t,"pointerenter",c)],r=!0)},p(f,d){e=f,s?s.p&&(!i||d[0]&134217728|d[2]&8192)&&Jc(s,a,e,e[75],i?Kc(a,e[75],d,u7):Qc(e[75]),$A):u&&u.p&&(!i||d[0]&134217728)&&u.p(e,i?d:[-1,-1,-1,-1]),(!i||d[0]&67108864&&n!==(n="autocomplete-list-item "+(e[110]===e[26]?"selected":"")+" svelte-878r4m"))&&Te(t,"class",n),d[0]&201326592|d[1]&32768&&Ku(t,"confirmed",e[46](e[108].item))},i(f){i||(ft(u,f),i=!0)},o(f){Lt(u,f),i=!1},d(f){f&&we(t),u&&u.d(f),r=!1,sa(o)}}}function x7(e){let t,n=e[108].label+"",i;return{c(){t=new Zh,i=un(),this.h()},l(r){t=SA(r),i=un(),this.h()},h(){t.a=i},m(r,o){t.m(n,r,o),ct(r,i,o)},p(r,o){o[0]&134217728&&n!==(n=r[108].label+"")&&t.p(n)},d(r){r&&we(i),r&&t.d()}}}function w7(e){let t,n=e[108].highlighted+"",i;return{c(){t=new Zh,i=un(),this.h()},l(r){t=SA(r),i=un(),this.h()},h(){t.a=i},m(r,o){t.m(n,r,o),ct(r,i,o)},p(r,o){o[0]&134217728&&n!==(n=r[108].highlighted+"")&&t.p(n)},d(r){r&&we(i),r&&t.d()}}}function _7(e){let t;function n(o,a){return o[108].highlighted?w7:x7}let i=n(e),r=i(e);return{c(){r.c(),t=un()},l(o){r.l(o),t=un()},m(o,a){r.m(o,a),ct(o,t,a)},p(o,a){i===(i=n(o))&&r?r.p(o,a):(r.d(1),r=i(o),r&&(r.c(),r.m(t.parentNode,t)))},d(o){r.d(o),o&&we(t)}}}function GA(e){let t,n,i=e[108]&&(e[5]<=0||e[110]<e[5])&&WA(e);return{c(){i&&i.c(),t=un()},l(r){i&&i.l(r),t=un()},m(r,o){i&&i.m(r,o),ct(r,t,o),n=!0},p(r,o){r[108]&&(r[5]<=0||r[110]<r[5])?i?(i.p(r,o),o[0]&134217760&&ft(i,1)):(i=WA(r),i.c(),ft(i,1),i.m(t.parentNode,t)):i&&(Qu(),Lt(i,1,1,()=>{i=null}),Zu())},i(r){n||(ft(i),n=!0)},o(r){Lt(i),n=!1},d(r){i&&i.d(r),r&&we(t)}}}function VA(e){let t,n,i=e[27].length-e[5]+"",r,o;return{c(){t=Ft("div"),n=gi("..."),r=gi(i),o=gi(" results not shown"),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);n=Zi(s,"..."),r=Zi(s,i),o=Zi(s," results not shown"),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-no-results svelte-878r4m")},m(a,s){ct(a,t,s),Ot(t,n),Ot(t,r),Ot(t,o)},p(a,s){s[0]&134217760&&i!==(i=a[27].length-a[5]+"")&&Ss(r,i)},d(a){a&&we(t)}}}function E7(e){let t,n,i,r,o,a,s,u,l,c,f,d,h,g,p,m,y,v,x,b;function _(C,M){if(!C[6]&&C[2])return f7;if(C[6]&&C[1])return c7}let E=_(e),w=E&&E(e),O=e[6]&&e[1]&&BA(e),S=e[31]&&qA(e);const k=[m7,p7,g7,h7],A=[];function F(C,M){return C[27]&&C[27].length>0?0:C[30]&&C[12]?1:C[7]?2:C[11]?3:-1}return~(g=F(e))&&(p=A[g]=k[g](e)),{c(){t=Ft("div"),n=Ft("select"),w&&w.c(),i=ua(),r=Ft("div"),O&&O.c(),o=ua(),a=Ft("input"),f=ua(),S&&S.c(),d=ua(),h=Ft("div"),p&&p.c(),this.h()},l(C){t=cn(C,"DIV",{class:!0});var M=ln(t);n=cn(M,"SELECT",{name:!0,id:!0,class:!0});var D=ln(n);w&&w.l(D),D.forEach(we),i=la(M),r=cn(M,"DIV",{class:!0});var N=ln(r);O&&O.l(N),o=la(N),a=cn(N,"INPUT",{type:!0,class:!0,id:!0,autocomplete:!0,placeholder:!0,name:!0,title:!0}),f=la(N),S&&S.l(N),N.forEach(we),d=la(M),h=cn(M,"DIV",{class:!0});var I=ln(h);p&&p.l(I),I.forEach(we),M.forEach(we),this.h()},h(){Te(n,"name",e[19]),Te(n,"id",e[20]),n.multiple=e[6],Te(n,"class","svelte-878r4m"),Te(a,"type","text"),Te(a,"class",s=""+((e[16]?e[16]:"")+" input autocomplete-input svelte-878r4m")),Te(a,"id",u=e[17]?e[17]:""),Te(a,"autocomplete",l=e[22]?"on":"some-other-text"),Te(a,"placeholder",e[14]),Te(a,"name",e[18]),a.disabled=e[25],Te(a,"title",e[21]),a.readOnly=c=e[23]||e[8]&&e[1],Te(r,"class","input-container svelte-878r4m"),Te(h,"class",m=""+((e[24]?e[24]:"")+" autocomplete-list "+(e[32]?"":"hidden")+" is-fullwidth svelte-878r4m")),Te(t,"class",y=""+((e[15]?e[15]:"")+" "+(e[9]||!e[0].length?"hide-arrow":"")+" "+(e[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+e[33]+" svelte-878r4m")),Ku(t,"show-clear",e[31]),Ku(t,"is-loading",e[10]&&e[30])},m(C,M){ct(C,t,M),Ot(t,n),w&&w.m(n,null),Ot(t,i),Ot(t,r),O&&O.m(r,null),Ot(r,o),Ot(r,a),e[77](a),AA(a,e[3]),Ot(r,f),S&&S.m(r,null),Ot(t,d),Ot(t,h),~g&&A[g].m(h,null),e[81](h),v=!0,x||(b=[pi(window,"click",e[37]),pi(a,"input",e[78]),pi(a,"input",e[40]),pi(a,"focus",e[43]),pi(a,"blur",e[44]),pi(a,"keydown",e[38]),pi(a,"click",e[42]),pi(a,"keypress",e[39])],x=!0)},p(C,M){E===(E=_(C))&&w?w.p(C,M):(w&&w.d(1),w=E&&E(C),w&&(w.c(),w.m(n,null))),(!v||M[0]&524288)&&Te(n,"name",C[19]),(!v||M[0]&1048576)&&Te(n,"id",C[20]),(!v||M[0]&64)&&(n.multiple=C[6]),C[6]&&C[1]?O?(O.p(C,M),M[0]&66&&ft(O,1)):(O=BA(C),O.c(),ft(O,1),O.m(r,o)):O&&(Qu(),Lt(O,1,1,()=>{O=null}),Zu()),(!v||M[0]&65536&&s!==(s=""+((C[16]?C[16]:"")+" input autocomplete-input svelte-878r4m")))&&Te(a,"class",s),(!v||M[0]&131072&&u!==(u=C[17]?C[17]:""))&&Te(a,"id",u),(!v||M[0]&4194304&&l!==(l=C[22]?"on":"some-other-text"))&&Te(a,"autocomplete",l),(!v||M[0]&16384)&&Te(a,"placeholder",C[14]),(!v||M[0]&262144)&&Te(a,"name",C[18]),(!v||M[0]&33554432)&&(a.disabled=C[25]),(!v||M[0]&2097152)&&Te(a,"title",C[21]),(!v||M[0]&8388866&&c!==(c=C[23]||C[8]&&C[1]))&&(a.readOnly=c),M[0]&8&&a.value!==C[3]&&AA(a,C[3]),C[31]?S?S.p(C,M):(S=qA(C),S.c(),S.m(r,null)):S&&(S.d(1),S=null);let D=g;g=F(C),g===D?~g&&A[g].p(C,M):(p&&(Qu(),Lt(A[D],1,1,()=>{A[D]=null}),Zu()),~g?(p=A[g],p?p.p(C,M):(p=A[g]=k[g](C),p.c()),ft(p,1),p.m(h,null)):p=null),(!v||M[0]&16777216|M[1]&2&&m!==(m=""+((C[24]?C[24]:"")+" autocomplete-list "+(C[32]?"":"hidden")+" is-fullwidth svelte-878r4m")))&&Te(h,"class",m),(!v||M[0]&33345&&y!==(y=""+((C[15]?C[15]:"")+" "+(C[9]||!C[0].length?"hide-arrow":"")+" "+(C[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+C[33]+" svelte-878r4m")))&&Te(t,"class",y),M[0]&33345|M[1]&1&&Ku(t,"show-clear",C[31]),M[0]&1073776193&&Ku(t,"is-loading",C[10]&&C[30])},i(C){v||(ft(O),ft(p),v=!0)},o(C){Lt(O),Lt(p),v=!1},d(C){C&&we(t),w&&w.d(),O&&O.d(),e[77](null),S&&S.d(),~g&&A[g].d(),e[81](null),x=!1,sa(b)}}}function hy(e,t){typeof e!="function"&&console.error("Not a function: "+e+", argument: "+t);let n;try{n=e(t)}catch{console.warn("Error executing Autocomplete function on value: "+t+" function: "+e)}let i=n;return i==null&&(i=""),typeof i!="string"&&(i=i.toString()),i}function gy(e,t){if(!e)return 0;const n=e.keywords;let i=0;return t.forEach(r=>{n.includes(r)&&i++}),i}function O7(e,t,n){return gy(t,n)-gy(e,n)}function sg(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function S7(e,t,n){let i,r,{$$slots:o={},$$scope:a}=t,{items:s=[]}=t,{searchFunction:u=!1}=t,{labelFieldName:l=void 0}=t,{keywordsFieldName:c=l}=t,{valueFieldName:f=void 0}=t,{labelFunction:d=function(T){return T==null?"":l?T[l]:T}}=t,{keywordsFunction:h=function(T){return T==null?"":c?T[c]:d(T)}}=t,{valueFunction:g=function(T,he=!1){return T==null?T:!S||he?f?T[f]:T:T.map(ve=>f?ve[f]:ve)}}=t,{keywordsCleanFunction:p=function(T){return T}}=t,{textCleanFunction:m=function(T){return T}}=t,{beforeChange:y=function(T,he){return!0}}=t,{onChange:v=function(T){}}=t,{onFocus:x=function(){}}=t,{onBlur:b=function(){}}=t,{onCreate:_=function(T){ie&&console.log("onCreate: "+T)}}=t,{selectFirstIfEmpty:E=!1}=t,{minCharactersToSearch:w=1}=t,{maxItemsToShowInList:O=0}=t,{multiple:S=!1}=t,{create:k=!1}=t,{ignoreAccents:A=!0}=t,{matchAllKeywords:F=!0}=t,{sortByMatchedKeywords:C=!1}=t,{itemFilterFunction:M=void 0}=t,{itemSortFunction:D=void 0}=t,{lock:N=!1}=t,{delay:I=0}=t,{localFiltering:z=!0}=t,{hideArrow:X=!1}=t,{showClear:te=!1}=t,{showLoadingIndicator:xe=!1}=t,{noResultsText:ge="No results found"}=t,{loadingText:je="Loading results..."}=t,{createText:Oe="Not found, add anyway?"}=t,{placeholder:ke=void 0}=t,{className:Xe=void 0}=t,{inputClassName:xt=void 0}=t,{inputId:Ge=void 0}=t,{name:Y=void 0}=t,{selectName:ne=void 0}=t,{selectId:fe=void 0}=t,{title:B=void 0}=t,{html5autocomplete:Ve=void 0}=t,{readonly:pe=void 0}=t,{dropdownClassName:tt=void 0}=t,{disabled:qe=!1}=t,{debug:ie=!1}=t,{selectedItem:me=S?[]:void 0}=t,{value:Ct=void 0}=t,{highlightedItem:Ke=void 0}=t;const st="sautocomplete-"+Math.floor(Math.random()*1e3);let wt,an,Yt=!1,Xi=!1,nt=-1,{text:Tt}=t,sn=0,Xt,di=[],Hc=0,Oo=0,Gc;function $(T){return hy(d,T)}function Z(T){const he=hy(h,T);let ve=hy(p,he);return ve=ve.toLowerCase().trim(),A&&(ve=sg(ve)),ie&&console.log("Extracted keywords: '"+ve+"' from item: "+JSON.stringify(T)),ve}function de(){let T;ie&&(T=`Autocomplete prepare list ${Ge?`(id: ${Ge})`:""}`,console.time(T),console.log("Prepare items to search"),console.log("items: "+JSON.stringify(s))),Array.isArray(s)||(console.warn("Autocomplete items / search function did not return array but",s),n(0,s=[]));const he=s?s.length:0;di=new Array(he),he>0&&s.forEach((ve,$e)=>{const hi=Be(ve);hi==null&&console.log("Undefined item for: ",ve),di[$e]=hi}),ie&&(console.log(di.length+" items to search"),console.timeEnd(T))}function Be(T){return{keywords:Z(T),label:$(T),item:T}}function Ce(){n(2,Ct=g(me)),n(3,Tt=S?"":$(me)),n(27,Xt=di),v(me)}function Kt(T){if(T==null)return"";const he=T.replace(/[&/\\#,+()$~%.'":*?<>{}]/g," ").trim();if(n(74,sn=he.length),w>1&&sn<w)return"";const $e=m(he).toLowerCase().trim();return ie&&console.log("Change user entered text '"+T+"' into '"+$e+"'"),$e}async function kn(){let T;ie&&(T=`Autocomplete search ${Ge?`(id: ${Ge})`:""})`,console.time(T),console.log("Searching user entered text: '"+Tt+"'"));const he=Kt(Tt);if(he===""){u?(n(0,s=[]),ie&&console.log("User entered text is empty clear list of items")):(n(27,Xt=di),ie&&console.log("User entered text is empty set the list of items to all items")),cA(),ie&&console.timeEnd(T);return}if(!u)_s(he);else{Hc=Hc+1;const ve=Hc;if(n(30,Xi=!0),u.constructor.name==="AsyncGeneratorFunction"){for await(const $e of u(he)){if(ve<Oo)return!1;ve>Oo&&n(0,s=[]),Oo=ve,n(0,s=[...s,...$e]),_s(he)}Oo<ve&&(Oo=ve,n(0,s=[]),_s(he))}else{let $e=await u(he);if(ve<Oo)return!1;Oo=ve,n(0,s=$e),_s(he)}n(30,Xi=!1)}ie&&(console.timeEnd(T),console.log("Search found "+Xt.length+" items"))}function oa(T,he){var ve=gy(T,he);return F?ve>=he.length:ve>0}function _s(T){de();const ve=(A?sg(T):T).split(/\s+/g);let $e;z?(M?$e=di.filter(Ao=>M(Ao.item,ve)):$e=di.filter(Ao=>oa(Ao,ve)),D?$e=$e.sort((Ao,aa)=>D(Ao.item,aa.item,ve)):C&&($e=$e.sort((Ao,aa)=>O7(Ao,aa,ve)))):$e=di;const hi=fA(ve,"label"),Vc=$e.map(hi);return n(27,Xt=Vc),cA(),!0}function Fr(T){if(ie&&console.log("selectListItem",T),typeof T=="undefined"&&k){const ve=_(Tt);if(typeof ve!="undefined"){de(),n(27,Xt=di);const $e=uA(ve,Xt);$e>=0&&(n(26,nt=$e),T=Xt[nt])}}if(typeof T=="undefined")return ie&&console.log("listItem is undefined. Can not select."),!1;const he=T.item;return y(me,he)&&(S?me?me.includes(he)?n(1,me=me.filter(ve=>ve!==he)):n(1,me=[...me,he]):n(1,me=[he]):(n(1,me=void 0),n(1,me=he))),!0}function Es(){ie&&console.log("selectItem",nt);const T=Xt[nt];Fr(T)&&(Gu(),S&&wt.focus())}function Os(){ie&&console.log("up"),Xh(),nt>0&&n(26,nt--,nt),qu()}function So(){ie&&console.log("down"),Xh(),nt<Xt.length-1&&n(26,nt++,nt),qu()}function qu(){ie&&console.log("highlight");const T=".selected";ie&&console.log("Seaching DOM element: "+T+" in "+an);const he=an&&an.querySelector(T);he?typeof he.scrollIntoViewIfNeeded=="function"?(ie&&console.log("Scrolling selected item into view"),he.scrollIntoViewIfNeeded()):ie&&console.warn("Could not scroll selected item into view, scrollIntoViewIfNeeded not supported"):ie&&console.warn("Selected item not found to scroll into view")}function Wu(T){ie&&console.log("onListItemClick"),Fr(T)&&(Gu(),S&&wt.focus())}function Hu(T){ie&&console.log("onDocumentClick: "+JSON.stringify(T.composedPath())),T.composedPath().some(he=>he.classList&&he.classList.contains(st))?(ie&&console.log("onDocumentClick inside"),qu()):(ie&&console.log("onDocumentClick outside"),Gu())}function v8(T){ie&&console.log("onKeyDown");let he=T.key;he==="Tab"&&T.shiftKey&&(he="ShiftTab");const $e={Tab:Yt?So.bind(this):null,ShiftTab:Yt?Os.bind(this):null,ArrowDown:So.bind(this),ArrowUp:Os.bind(this),Escape:E8.bind(this),Backspace:S&&me&&me.length&&!Tt?O8.bind(this):null}[he];typeof $e=="function"&&$e(T)}function b8(T){ie&&console.log("onKeyPress"),T.key==="Enter"&&Yt&&(T.preventDefault(),x8())}function x8(){Es()}function w8(T){ie&&console.log("onInput"),n(3,Tt=T.target.value),Gc&&clearTimeout(Gc),I?Gc=setTimeout(aA,I):aA()}function oA(T){ie&&console.log("unselectItem",T),n(1,me=me.filter(he=>he!==T)),wt.focus()}function aA(){kn()&&(n(26,nt=0),Xh())}function _8(){ie&&console.log("onInputClick"),sA()}function E8(T){ie&&console.log("onEsc"),T.stopPropagation(),Yt&&(wt.focus(),Gu())}function O8(T){ie&&console.log("onBackspace"),oA(me[me.length-1])}function S8(){ie&&console.log("onFocus"),x(),sA()}function A8(){ie&&console.log("onBlur"),b()}function sA(){if(ie&&console.log("resetListToAllItemsAndOpen"),Tt?!di.length&&me&&u&&kn():n(27,Xt=di),Xh(),me){ie&&console.log("Searching currently selected item: "+JSON.stringify(me));const T=uA(me,Xt);T>=0&&(n(26,nt=T),qu())}}function uA(T,he){ie&&console.log("Finding index for item",T);let ve=-1;for(let $e=0;$e<he.length;$e++){const hi=he[$e];if(typeof hi=="undefined"){ie&&console.log(`listItem ${$e} is undefined. Skipping.`);continue}if(ie&&console.log("Item "+$e+": "+JSON.stringify(hi)),T==hi.item){ve=$e;break}}return ie&&(ve>=0?console.log("Found index for item: "+ve):console.warn("Not found index for item: "+T)),ve}function Xh(){ie&&console.log("open"),!lA()&&n(73,Yt=!0)}function Gu(){ie&&console.log("close"),n(73,Yt=!1),n(30,Xi=!1),!Tt&&E&&(n(26,nt=0),Es())}function lA(){return w>1&&sn<w}function cA(){lA()&&Gu()}function k8(){ie&&console.log("clear"),n(3,Tt=""),n(1,me=S?[]:void 0),setTimeout(()=>{wt.focus(),Gu()})}function fA(T,he){return ve=>{let $e=ve[he];const hi=Object.assign({highlighted:void 0},ve);hi.highlighted=$e;const Vc=$e.toLowerCase(),Ao=A?sg(Vc):Vc;if(T&&T.length){const aa=[];for(let Vu=0;Vu<T.length;Vu++){let Ki=T[Vu];A&&(Ki=sg(Ki));const Yu=Ki.length;let Ji=0;do if(Ji=Ao.indexOf(Ki,Ji),Ji>=0){let Kh=Ji+Yu;aa.push([Ji,Kh]),Ji=Kh}while(Ji!==-1)}if(aa.length>0){const Vu=new Set;for(let Ki=0;Ki<aa.length;Ki++){const Yu=aa[Ki],Ji=Yu[0],Kh=Yu[1],R8=Vc.substring(Ji,Kh);Vu.add(R8)}for(let Ki of Vu){if(Ki==="b")continue;const Yu=new RegExp("("+Ki+")","ig"),Ji=hi.highlighted.replace(Yu,"<b>$1</b>");hi.highlighted=Ji}}}return hi}}function C8(T){return me?S?me.includes(T):T==me:!1}function T8(T){ig[T?"unshift":"push"](()=>{wt=T,n(28,wt)})}function F8(){Tt=this.value,n(3,Tt)}const D8=T=>Wu(T),M8=T=>{n(26,nt=T)};function N8(T){ig[T?"unshift":"push"](()=>{an=T,n(29,an)})}return e.$$set=T=>{"items"in T&&n(0,s=T.items),"searchFunction"in T&&n(48,u=T.searchFunction),"labelFieldName"in T&&n(49,l=T.labelFieldName),"keywordsFieldName"in T&&n(50,c=T.keywordsFieldName),"valueFieldName"in T&&n(51,f=T.valueFieldName),"labelFunction"in T&&n(52,d=T.labelFunction),"keywordsFunction"in T&&n(53,h=T.keywordsFunction),"valueFunction"in T&&n(4,g=T.valueFunction),"keywordsCleanFunction"in T&&n(54,p=T.keywordsCleanFunction),"textCleanFunction"in T&&n(55,m=T.textCleanFunction),"beforeChange"in T&&n(56,y=T.beforeChange),"onChange"in T&&n(57,v=T.onChange),"onFocus"in T&&n(58,x=T.onFocus),"onBlur"in T&&n(59,b=T.onBlur),"onCreate"in T&&n(60,_=T.onCreate),"selectFirstIfEmpty"in T&&n(61,E=T.selectFirstIfEmpty),"minCharactersToSearch"in T&&n(62,w=T.minCharactersToSearch),"maxItemsToShowInList"in T&&n(5,O=T.maxItemsToShowInList),"multiple"in T&&n(6,S=T.multiple),"create"in T&&n(7,k=T.create),"ignoreAccents"in T&&n(63,A=T.ignoreAccents),"matchAllKeywords"in T&&n(64,F=T.matchAllKeywords),"sortByMatchedKeywords"in T&&n(65,C=T.sortByMatchedKeywords),"itemFilterFunction"in T&&n(66,M=T.itemFilterFunction),"itemSortFunction"in T&&n(67,D=T.itemSortFunction),"lock"in T&&n(8,N=T.lock),"delay"in T&&n(68,I=T.delay),"localFiltering"in T&&n(69,z=T.localFiltering),"hideArrow"in T&&n(9,X=T.hideArrow),"showClear"in T&&n(70,te=T.showClear),"showLoadingIndicator"in T&&n(10,xe=T.showLoadingIndicator),"noResultsText"in T&&n(11,ge=T.noResultsText),"loadingText"in T&&n(12,je=T.loadingText),"createText"in T&&n(13,Oe=T.createText),"placeholder"in T&&n(14,ke=T.placeholder),"className"in T&&n(15,Xe=T.className),"inputClassName"in T&&n(16,xt=T.inputClassName),"inputId"in T&&n(17,Ge=T.inputId),"name"in T&&n(18,Y=T.name),"selectName"in T&&n(19,ne=T.selectName),"selectId"in T&&n(20,fe=T.selectId),"title"in T&&n(21,B=T.title),"html5autocomplete"in T&&n(22,Ve=T.html5autocomplete),"readonly"in T&&n(23,pe=T.readonly),"dropdownClassName"in T&&n(24,tt=T.dropdownClassName),"disabled"in T&&n(25,qe=T.disabled),"debug"in T&&n(71,ie=T.debug),"selectedItem"in T&&n(1,me=T.selectedItem),"value"in T&&n(2,Ct=T.value),"highlightedItem"in T&&n(47,Ke=T.highlightedItem),"text"in T&&n(3,Tt=T.text),"$$scope"in T&&n(75,a=T.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1&&de(),e.$$.dirty[0]&2&&Ce(),e.$$.dirty[0]&201326592&&n(47,Ke=Xt&&nt&&nt>=0&&nt<Xt.length?Xt[nt].item:null),e.$$.dirty[0]&1|e.$$.dirty[2]&6144&&n(32,i=Yt&&(s&&s.length>0||sn>0)),e.$$.dirty[0]&322|e.$$.dirty[2]&256&&n(31,r=te||(N||S)&&me)},[s,me,Ct,Tt,g,O,S,k,N,X,xe,ge,je,Oe,ke,Xe,xt,Ge,Y,ne,fe,B,Ve,pe,tt,qe,nt,Xt,wt,an,Xi,r,i,st,$,Es,Wu,Hu,v8,b8,w8,oA,_8,S8,A8,k8,C8,Ke,u,l,c,f,d,h,p,m,y,v,x,b,_,E,w,A,F,C,M,D,I,z,te,ie,fA,Yt,sn,a,o,T8,F8,D8,M8,N8]}class rbe extends r7{constructor(t){super();i7(this,t,S7,E7,gA,{items:0,searchFunction:48,labelFieldName:49,keywordsFieldName:50,valueFieldName:51,labelFunction:52,keywordsFunction:53,valueFunction:4,keywordsCleanFunction:54,textCleanFunction:55,beforeChange:56,onChange:57,onFocus:58,onBlur:59,onCreate:60,selectFirstIfEmpty:61,minCharactersToSearch:62,maxItemsToShowInList:5,multiple:6,create:7,ignoreAccents:63,matchAllKeywords:64,sortByMatchedKeywords:65,itemFilterFunction:66,itemSortFunction:67,lock:8,delay:68,localFiltering:69,hideArrow:9,showClear:70,showLoadingIndicator:10,noResultsText:11,loadingText:12,createText:13,placeholder:14,className:15,inputClassName:16,inputId:17,name:18,selectName:19,selectId:20,title:21,html5autocomplete:22,readonly:23,dropdownClassName:24,disabled:25,debug:71,selectedItem:1,value:2,highlightedItem:47,text:3,highlightFilter:72},null,[-1,-1,-1,-1])}get highlightFilter(){return this.$$.ctx[72]}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var A7=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),k7=Object.prototype.hasOwnProperty;function py(e,t){return k7.call(e,t)}function my(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)py(e,i)&&n.push(i);return n}function mi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function yy(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function As(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function YA(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function vy(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(vy(e[t]))return!0}else if(typeof e=="object"){for(var i=my(e),r=i.length,t=0;t<r;t++)if(vy(e[i[t]]))return!0}}return!1}function XA(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var KA=function(e){A7(t,e);function t(n,i,r,o,a){var s=this.constructor,u=e.call(this,XA(n,{name:i,index:r,operation:o,tree:a}))||this;return u.name=i,u.index=r,u.operation=o,u.tree=a,Object.setPrototypeOf(u,s.prototype),u.message=XA(n,{name:i,index:r,operation:o,tree:a}),u}return t}(Error),mt=KA,C7=mi,tl={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=ug(n,this.path);i&&(i=mi(i));var r=ks(n,{op:"remove",path:this.from}).removed;return ks(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=ug(n,this.from);return ks(n,{op:"add",path:this.path,value:mi(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:nf(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},T7={add:function(e,t,n){return yy(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:tl.move,copy:tl.copy,test:tl.test,_get:tl._get};function ug(e,t){if(t=="")return e;var n={op:"_get",path:t};return ks(e,n),n.value}function ks(e,t,n,i,r,o){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):cg(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=ug(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=nf(e,t.value),a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new mt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}}else{i||(e=mi(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=cg;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=YA(h)),r&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!yy(h))throw new mt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);yy(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new mt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var a=T7[t.op].call(t,l,h,e);if(a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=f){var a=tl[t.op].call(t,l,h,e);if(a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new mt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function lg(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new mt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=mi(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=ks(e,t[a],n,!0,r,a),e=o[a].newDocument;return o.newDocument=e,o}function F7(e,t,n){var i=ks(e,t);if(i.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function cg(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new mt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(tl[e.op]){if(typeof e.path!="string")throw new mt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new mt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new mt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new mt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&vy(e.value))throw new mt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new mt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new mt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},s=JA([a],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new mt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new mt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function JA(e,t,n){try{if(!Array.isArray(e))throw new mt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)lg(mi(t),mi(e),n||!0);else{n=n||cg;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof mt)return r;throw r}}function nf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,o,a;if(n&&i){if(o=e.length,o!=t.length)return!1;for(r=o;r--!=0;)if(!nf(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(r=o;r--!=0;)if(!t.hasOwnProperty(s[r]))return!1;for(r=o;r--!=0;)if(a=s[r],!nf(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var D7=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:mt,deepClone:C7,getValueByPointer:ug,applyOperation:ks,applyPatch:lg,applyReducer:F7,validator:cg,validate:JA,_areEquals:nf});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var by=new WeakMap,M7=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),N7=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function R7(e){return by.get(e)}function j7(e,t){return e.observers.get(t)}function $7(e,t){e.observers.delete(t.callback)}function L7(e,t){t.unobserve()}function I7(e,t){var n=[],i,r=R7(e);if(!r)r=new M7(e),by.set(e,r);else{var o=j7(r,t);i=o&&o.observer}if(i)return i;if(i={},r.value=mi(e),t){i.callback=t,i.next=null;var a=function(){xy(i)},s=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return i.patches=n,i.object=e,i.unobserve=function(){xy(i),clearTimeout(i.next),$7(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(t,new N7(t,i)),i}function xy(e,t){t===void 0&&(t=!1);var n=by.get(e.object);wy(n.value,e.object,e.patches,"",t),e.patches.length&&lg(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function wy(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=my(t),a=my(e),s=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(py(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?wy(c,f,n,i+"/"+As(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+As(l),value:mi(c)}),n.push({op:"replace",path:i+"/"+As(l),value:mi(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+As(l),value:mi(c)}),n.push({op:"remove",path:i+"/"+As(l)}),s=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!s&&o.length==a.length))for(var u=0;u<o.length;u++){var l=o[u];!py(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+As(l),value:mi(t[l])})}}}function P7(e,t,n){n===void 0&&(n=!1);var i=[];return wy(e,t,i,"",n),i}var z7=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:L7,observe:I7,generate:xy,compare:P7});Object.assign({},D7,z7,{JsonPatchError:KA,deepClone:mi,escapePathComponent:As,unescapePathComponent:YA});var obe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},B7=/("(?:[^\\"]|\\.)*")|[:,]/g,_y=function(t,n){var i,r,o;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function a(s,u,l){var c,f,d,h,g,p,m,y,v,x,b,_;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),b=JSON.stringify(s,o),b===void 0)return b;if(m=r-u.length-l,b.length<=m&&(v=b.replace(B7,function(E,w){return w||E+" "}),v.length<=m))return v;if(o!=null&&(s=JSON.parse(b),o=void 0),typeof s=="object"&&s!==null){if(y=u+i,d=[],f=0,Array.isArray(s))for(x="[",c="]",m=s.length;f<m;f++)d.push(a(s[f],y,f===m-1?0:1)||"null");else for(x="{",c="}",p=Object.keys(s),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",_=a(s[h],y,g.length+(f===m-1?0:1)),_!==void 0&&d.push(g+_);if(d.length>0)return[x,i+d.join(`,
`+y),c].join(`
`+u)}return b}(t,"",0)};function Hn(e,t,n){return e.fields=t||[],e.fname=n,e}function yt(e){return e==null?null:e.fname}function fn(e){return e==null?null:e.fields}function QA(e){return e.length===1?U7(e[0]):q7(e)}const U7=e=>function(t){return t[e]},q7=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function L(e){throw Error(e)}function Dr(e){const t=[],n=e.length;let i=null,r=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===i)l(),i=null,r=-1;else{if(i)continue;a===r&&u==='"'||a===r&&u==="'"?(a=s+1,i=u):u==="."&&!r?s>a?l():a=s+1:u==="["?(s>a&&l(),r=a=s+1):u==="]"&&(r||L("Access path missing open bracket: "+e),r>0&&l(),r=0,a=s+1)}return r&&L("Access path missing closing bracket: "+e),i&&L("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Gn(e,t,n){const i=Dr(e);return e=i.length===1?i[0]:e,Hn((n&&n.get||QA)(i),[e],t||e)}const rf=Gn("id"),dn=Hn(e=>e,[],"identity"),fa=Hn(()=>0,[],"zero"),nl=Hn(()=>1,[],"one"),Ti=Hn(()=>!0,[],"true"),da=Hn(()=>!1,[],"false");function W7(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const ZA=0,Ey=1,Oy=2,ek=3,tk=4;function Sy(e,t,n=W7){let i=e||ZA;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=Ey&&n(t||"error","ERROR",arguments),this},warn(){return i>=Oy&&n(t||"warn","WARN",arguments),this},info(){return i>=ek&&n(t||"log","INFO",arguments),this},debug(){return i>=tk&&n(t||"log","DEBUG",arguments),this}}}var P=Array.isArray;function Q(e){return e===Object(e)}const nk=e=>e!=="__proto__";function il(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=H7(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;rl(t,i,n[i],r)}return t},{})}function rl(e,t,n,i){if(!nk(t))return;let r,o;if(Q(n)&&!P(n)){o=Q(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?rl(o,r,n[r]):nk(r)&&(o[r]=n[r])}else e[t]=n}function H7(e,t){if(e==null)return t;const n={},i=[];function r(o){n[o.name]||(n[o.name]=1,i.push(o))}return t.forEach(r),e.forEach(r),i}function Fe(e){return e[e.length-1]}function hn(e){return e==null||e===""?null:+e}const ik=e=>t=>e*Math.exp(t),rk=e=>t=>Math.log(e*t),ok=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),ak=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,fg=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function dg(e,t,n,i){const r=n(e[0]),o=n(Fe(e)),a=(o-r)*t;return[i(r-a),i(o-a)]}function sk(e,t){return dg(e,t,hn,dn)}function uk(e,t){var n=Math.sign(e[0]);return dg(e,t,rk(n),ik(n))}function lk(e,t,n){return dg(e,t,fg(n),fg(1/n))}function ck(e,t,n){return dg(e,t,ok(n),ak(n))}function hg(e,t,n,i,r){const o=i(e[0]),a=i(Fe(e)),s=t!=null?i(t):(o+a)/2;return[r(s+(o-s)*n),r(s+(a-s)*n)]}function Ay(e,t,n){return hg(e,t,n,hn,dn)}function ky(e,t,n){const i=Math.sign(e[0]);return hg(e,t,n,rk(i),ik(i))}function gg(e,t,n,i){return hg(e,t,n,fg(i),fg(1/i))}function Cy(e,t,n,i){return hg(e,t,n,ok(i),ak(i))}function fk(e){return 1+~~(new Date(e).getMonth()/3)}function dk(e){return 1+~~(new Date(e).getUTCMonth()/3)}function J(e){return e!=null?P(e)?e:[e]:[]}function hk(e,t,n){let i=e[0],r=e[1],o;return r<i&&(o=r,r=i,i=o),o=r-i,o>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-o),i+o]}function _e(e){return typeof e=="function"}const G7="descending";function Ty(e,t,n){n=n||{},t=J(t)||[];const i=[],r=[],o={},a=n.comparator||V7;return J(e).forEach((s,u)=>{s!=null&&(i.push(t[u]===G7?-1:1),r.push(s=_e(s)?s:Gn(s,null,n)),(fn(s)||[]).forEach(l=>o[l]=1))}),r.length===0?null:Hn(a(r,i),Object.keys(o))}const pg=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),V7=(e,t)=>e.length===1?Y7(e[0],t[0]):X7(e,t,e.length),Y7=(e,t)=>function(n,i){return pg(e(n),e(i))*t},X7=(e,t,n)=>(t.push(0),function(i,r){let o,a=0,s=-1;for(;a===0&&++s<n;)o=e[s],a=pg(o(i),o(r));return a*t[s]});function gn(e){return _e(e)?e:()=>e}function Fy(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ee(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function Mr(e,t){let n=0,i,r,o,a;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(o=a=r;n<i;++n)r=e[n],r!=null&&(r<o&&(o=r),r>a&&(a=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(o=a=r;n<i;++n)r=t(e[n]),r!=null&&(r<o&&(o=r),r>a&&(a=r))}return[o,a]}function gk(e,t){const n=e.length;let i=-1,r,o,a,s,u;if(t==null){for(;++i<n;)if(o=e[i],o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=e[i],o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}else{for(;++i<n;)if(o=t(e[i],i,e),o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=t(e[i],i,e),o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}return[s,u]}const K7=Object.prototype.hasOwnProperty;function re(e,t){return K7.call(e,t)}const mg={};function ol(e){let t={},n;function i(o){return re(t,o)&&t[o]!==mg}const r={size:0,empty:0,object:t,has:i,get(o){return i(o)?t[o]:void 0},set(o,a){return i(o)||(++r.size,t[o]===mg&&--r.empty),t[o]=a,this},delete(o){return i(o)&&(--r.size,++r.empty,t[o]=mg),this},clear(){r.size=r.empty=0,r.object=t={}},test(o){return arguments.length?(n=o,r):n},clean(){const o={};let a=0;for(const s in t){const u=t[s];u!==mg&&(!n||!n(u))&&(o[s]=u,++a)}r.size=a,r.empty=0,r.object=t=o}};return e&&Object.keys(e).forEach(o=>{r.set(o,e[o])}),r}function pk(e,t,n,i,r,o){if(!n&&n!==0)return o;const a=+n;let s=e[0],u=Fe(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=a?i:c<=a?r:o}function W(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ee(i,n)}function al(e,t,n,i){let r=t[0],o=t[t.length-1],a;return r>o&&(a=r,r=o,o=a),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=o:e<o)}function ha(e){return typeof e=="boolean"}function ga(e){return Object.prototype.toString.call(e)==="[object Date]"}function mk(e){return e&&_e(e[Symbol.iterator])}function Je(e){return typeof e=="number"}function yk(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function K(e){return typeof e=="string"}function Dy(e,t,n){e&&(e=t?J(e).map(s=>s.replace(/\\(.)/g,"$1")):J(e));const i=e&&e.length,r=n&&n.get||QA,o=s=>r(t?[s]:Dr(s));let a;if(!i)a=function(){return""};else if(i===1){const s=o(e[0]);a=function(u){return""+s(u)}}else{const s=e.map(o);a=function(u){let l=""+s[0](u),c=0;for(;++c<i;)l+="|"+s[c](u);return l}}return Hn(a,e,"key")}function vk(e,t){const n=e[0],i=Fe(e),r=+t;return r?r===1?i:n+r*(i-n):n}const J7=1e4;function bk(e){e=+e||J7;let t,n,i;const r=()=>{t={},n={},i=0},o=(a,s)=>(++i>e&&(n=t,t={},i=1),t[a]=s);return r(),{clear:r,has:a=>re(t,a)||re(n,a),get:a=>re(t,a)?t[a]:re(n,a)?o(a,n[a]):void 0,set:(a,s)=>re(t,a)?t[a]=s:o(a,s)}}function xk(e,t,n,i){const r=t.length,o=n.length;if(!o)return t;if(!r)return n;const a=i||new t.constructor(r+o);let s=0,u=0,l=0;for(;s<r&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<r;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function of(e,t){let n="";for(;--t>=0;)n+=e;return n}function wk(e,t,n,i){const r=n||" ",o=e+"",a=t-o.length;return a<=0?o:i==="left"?of(r,a)+o:i==="center"?of(r,~~(a/2))+o+of(r,Math.ceil(a/2)):o+of(r,a)}function af(e){return e&&Fe(e)-e[0]||0}function H(e){return P(e)?"["+e.map(H)+"]":Q(e)||K(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function My(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const Q7=e=>Je(e)||ga(e)?e:Date.parse(e);function Ny(e,t){return t=t||Q7,e==null||e===""?null:t(e)}function Ry(e){return e==null||e===""?null:e+""}function er(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function _k(e,t,n,i){const r=i!=null?i:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-r.length);return a<=t?o:n==="left"?r+o.slice(a-s):n==="center"?o.slice(0,Math.ceil(s/2))+r+o.slice(a-~~(s/2)):o.slice(0,s)+r}function pa(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const o=t(e[r]);o&&n(o,r,e)}}else e.forEach(n)}var Ek={},jy={},$y=34,sf=10,Ly=13;function Ok(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Z7(e,t){var n=Ok(e);return function(i,r){return t(n(i),r,e)}}function Sk(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Vn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function e9(e){return e<0?"-"+Vn(-e,6):e>9999?"+"+Vn(e,6):Vn(e,4)}function t9(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":e9(e.getUTCFullYear())+"-"+Vn(e.getUTCMonth()+1,2)+"-"+Vn(e.getUTCDate(),2)+(r?"T"+Vn(t,2)+":"+Vn(n,2)+":"+Vn(i,2)+"."+Vn(r,3)+"Z":i?"T"+Vn(t,2)+":"+Vn(n,2)+":"+Vn(i,2)+"Z":n||t?"T"+Vn(t,2)+":"+Vn(n,2)+"Z":"")}function n9(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,g,p=r(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?Z7(m,d):Ok(m)});return p.columns=g||[],p}function r(f,d){var h=[],g=f.length,p=0,m=0,y,v=g<=0,x=!1;f.charCodeAt(g-1)===sf&&--g,f.charCodeAt(g-1)===Ly&&--g;function b(){if(v)return jy;if(x)return x=!1,Ek;var E,w=p,O;if(f.charCodeAt(w)===$y){for(;p++<g&&f.charCodeAt(p)!==$y||f.charCodeAt(++p)===$y;);return(E=p)>=g?v=!0:(O=f.charCodeAt(p++))===sf?x=!0:O===Ly&&(x=!0,f.charCodeAt(p)===sf&&++p),f.slice(w+1,E-1).replace(/""/g,'"')}for(;p<g;){if((O=f.charCodeAt(E=p++))===sf)x=!0;else if(O===Ly)x=!0,f.charCodeAt(p)===sf&&++p;else if(O!==n)continue;return f.slice(w,E)}return v=!0,f.slice(w,g)}for(;(y=b())!==jy;){for(var _=[];y!==Ek&&y!==jy;)_.push(y),y=b();d&&(_=d(_,m++))==null||h.push(_)}return h}function o(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function a(f,d){return d==null&&(d=Sk(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function s(f,d){return d==null&&(d=Sk(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?t9(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:a,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function i9(e){return e}function r9(e){if(e==null)return i9;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],a=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*i+o,f[1]=(n+=s[1])*r+a;l<c;)f[l]=s[l],++l;return f}}function o9(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function a9(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return Ak(e,n)})}:Ak(e,t)}function Ak(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,o=kk(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function kk(e,t){var n=r9(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&o9(f,g)}function o(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function s9(e,t){var n={},i={},r={},o=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,g;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,g=i[d]){delete i[g.start];var p=g===h?h:h.concat(g);i[p.start=h.start]=r[p.end=g.end]=p}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,g=r[f]){delete r[g.end];var m=g===h?h:g.concat(h);i[m.start=g.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function u9(e){return kk(e,l9.apply(this,arguments))}function l9(e,t,n){var i,r,o;if(arguments.length>1)i=c9(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:s9(e,i)}}function c9(e,t,n){var i=[],r=[],o;function a(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:o})}function s(f){f.forEach(a)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function sl(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function uf(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=f9(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function f9(e){return(t,n)=>sl(e(t),n)}function Ck(e){return e===null?NaN:+e}function*d9(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const Tk=uf(sl),yg=Tk.right,h9=Tk.left;uf(Ck).center;var lf=yg;function g9(e,t){let n=0,i,r=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,o+=i*(a-r));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(i=s-r,r+=i/++n,o+=i*(s-r))}if(n>1)return o/(n-1)}function p9(e,t){const n=g9(e,t);return n&&Math.sqrt(n)}class Cn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[i++]=s),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}function m9(e,t){return Array.from(t,n=>e[n])}var Iy=Math.sqrt(50),Py=Math.sqrt(10),zy=Math.sqrt(2);function By(e,t,n){var i,r=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(o=e,e=t,t=o),(s=Fk(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)/s}return i&&a.reverse(),a}function Fk(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=Iy?10:o>=Py?5:o>=zy?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Iy?10:o>=Py?5:o>=zy?2:1)}function ma(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Iy?r*=10:o>=Py?r*=5:o>=zy&&(r*=2),t<e?-r:r}function Cs(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function Uy(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function Dk(e,t,n=0,i=e.length-1,r=sl){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));Dk(e,t,h,g,r)}const o=e[t];let a=n,s=i;for(cf(e,n,t),r(e[i],o)>0&&cf(e,n,i);a<s;){for(cf(e,a,s),++a,--s;r(e[a],o)<0;)++a;for(;r(e[s],o)>0;)--s}r(e[n],o)===0?cf(e,n,s):(++s,cf(e,s,i)),s<=t&&(n=s+1),t<=s&&(i=s-1)}return e}function cf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function qy(e,t,n){if(e=Float64Array.from(d9(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return Uy(e);if(t>=1)return Cs(e);var i,r=(i-1)*t,o=Math.floor(r),a=Cs(Dk(e,o).subarray(0,o+1)),s=Uy(e.subarray(o+1));return a+(s-a)*(r-o)}}function Mk(e,t,n=Ck){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(r-o)}}function y9(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}function Nk(e,t){return qy(e,.5,t)}function*v9(e){for(const t of e)yield*t}function Rk(e){return Array.from(v9(e))}function yi(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function jk(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function b9(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function vg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function ul(e){return e=vg(Math.abs(e)),e?e[1]:NaN}function x9(e,t){return function(n,i){for(var r=n.length,o=[],a=0,s=e[0],u=0;r>0&&s>0&&(u+s+1>i&&(s=Math.max(1,i-u)),o.push(n.substring(r-=s,r+s)),!((u+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function w9(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var _9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ll(e){if(!(t=_9.exec(e)))throw new Error("invalid format: "+e);var t;return new Wy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ll.prototype=Wy.prototype;function Wy(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Wy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function E9(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var $k;function O9(e,t){var n=vg(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-($k=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+vg(e,Math.max(0,t+o-1))[0]}function Lk(e,t){var n=vg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var Ik={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:b9,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Lk(e*100,t),r:Lk,s:O9,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Pk(e){return e}var zk=Array.prototype.map,Bk=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Uk(e){var t=e.grouping===void 0||e.thousands===void 0?Pk:x9(zk.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?Pk:w9(zk.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=ll(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,x=f.precision,b=f.trim,_=f.type;_==="n"?(v=!0,_="g"):Ik[_]||(x===void 0&&(x=12),b=!0,_="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",w=p==="$"?i:/[%p]/.test(_)?a:"",O=Ik[_],S=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function k(A){var F=E,C=w,M,D,N;if(_==="c")C=O(A)+C,A="";else{A=+A;var I=A<0||1/A<0;if(A=isNaN(A)?u:O(Math.abs(A),x),b&&(A=E9(A)),I&&+A==0&&g!=="+"&&(I=!1),F=(I?g==="("?g:s:g==="-"||g==="("?"":g)+F,C=(_==="s"?Bk[8+$k/3]:"")+C+(I&&g==="("?")":""),S){for(M=-1,D=A.length;++M<D;)if(N=A.charCodeAt(M),48>N||N>57){C=(N===46?r+A.slice(M+1):A.slice(M))+C,A=A.slice(0,M);break}}}v&&!m&&(A=t(A,1/0));var z=F.length+A.length+C.length,X=z<y?new Array(y-z+1).join(d):"";switch(v&&m&&(A=t(X+A,X.length?y-C.length:1/0),X=""),h){case"<":A=F+A+C+X;break;case"=":A=F+X+A+C;break;case"^":A=X.slice(0,z=X.length>>1)+F+A+C+X.slice(z);break;default:A=X+F+A+C;break}return o(A)}return k.toString=function(){return f+""},k}function c(f,d){var h=l((f=ll(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(ul(d)/3)))*3,p=Math.pow(10,-g),m=Bk[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var bg,xg,Hy;S9({thousands:",",grouping:[3],currency:["$",""]});function S9(e){return bg=Uk(e),xg=bg.format,Hy=bg.formatPrefix,bg}function qk(e){return Math.max(0,-ul(Math.abs(e)))}function Wk(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ul(t)/3)))*3-ul(Math.abs(e)))}function Hk(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ul(t)-ul(e))+1}var Gy=new Date,Vy=new Date;function It(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var a=r(o),s=r.ceil(o);return o-a<s-o?a:s},r.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},r.range=function(o,a,s){var u=[],l;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},r.filter=function(o){return It(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(r.count=function(o,a){return Gy.setTime(+o),Vy.setTime(+a),e(Gy),e(Vy),Math.floor(n(Gy,Vy))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(a){return i(a)%o==0}:function(a){return r.count(0,a)%o==0}):r}),r}var Yy=It(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Yy.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?It(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Yy};var Xy=Yy;const ko=1e3,Fi=ko*60,Co=Fi*60,Ts=Co*24,Ky=Ts*7,Gk=Ts*30,Jy=Ts*365;var A9=It(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*ko)},function(e,t){return(t-e)/ko},function(e){return e.getUTCSeconds()}),ya=A9,k9=It(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ko)},function(e,t){e.setTime(+e+t*Fi)},function(e,t){return(t-e)/Fi},function(e){return e.getMinutes()}),Qy=k9,C9=It(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ko-e.getMinutes()*Fi)},function(e,t){e.setTime(+e+t*Co)},function(e,t){return(t-e)/Co},function(e){return e.getHours()}),Zy=C9,T9=It(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fi)/Ts,e=>e.getDate()-1),va=T9;function Fs(e){return It(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fi)/Ky})}var ff=Fs(0),ev=Fs(1);Fs(2);Fs(3);var df=Fs(4);Fs(5);Fs(6);var F9=It(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),wg=F9,Vk=It(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Vk.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:It(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var ba=Vk,D9=It(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Fi)},function(e,t){return(t-e)/Fi},function(e){return e.getUTCMinutes()}),tv=D9,M9=It(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Co)},function(e,t){return(t-e)/Co},function(e){return e.getUTCHours()}),nv=M9,N9=It(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Ts},function(e){return e.getUTCDate()-1}),xa=N9;function Ds(e){return It(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/Ky})}var hf=Ds(0),iv=Ds(1);Ds(2);Ds(3);var gf=Ds(4);Ds(5);Ds(6);var R9=It(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),_g=R9,Yk=It(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Yk.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:It(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var wa=Yk;function Xk(e,t,n,i,r,o){const a=[[ya,1,ko],[ya,5,5*ko],[ya,15,15*ko],[ya,30,30*ko],[o,1,Fi],[o,5,5*Fi],[o,15,15*Fi],[o,30,30*Fi],[r,1,Co],[r,3,3*Co],[r,6,6*Co],[r,12,12*Co],[i,1,Ts],[i,2,2*Ts],[n,1,Ky],[t,1,Gk],[t,3,3*Gk],[e,1,Jy]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=uf(([,,m])=>m).right(a,d);if(h===a.length)return e.every(ma(l/Jy,c/Jy,f));if(h===0)return Xy.every(Math.max(ma(l,c,f),1));const[g,p]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return g.every(p)}return[s,u]}const[j9,$9]=Xk(wa,_g,hf,xa,nv,tv),[L9,I9]=Xk(ba,wg,ff,va,Zy,Qy),Jt="year",Yn="quarter",pn="month",Dt="week",Xn="date",mn="day",Nr="dayofyear",vi="hours",bi="minutes",Di="seconds",tr="milliseconds",rv=[Jt,Yn,pn,Dt,Xn,mn,Nr,vi,bi,Di,tr],ov=rv.reduce((e,t,n)=>(e[t]=1+n,e),{});function av(e){const t=J(e).slice(),n={};return t.length||L("Missing time unit."),t.forEach(r=>{re(ov,r)?n[r]=1:L("Invalid time unit: ".concat(r,"."))}),(n[Dt]||n[mn]?1:0)+(n[Yn]||n[pn]||n[Xn]?1:0)+(n[Nr]?1:0)>1&&L("Incompatible time units: ".concat(e)),t.sort((r,o)=>ov[r]-ov[o]),t}const P9={[Jt]:"%Y ",[Yn]:"Q%q ",[pn]:"%b ",[Xn]:"%d ",[Dt]:"W%U ",[mn]:"%a ",[Nr]:"%j ",[vi]:"%H:00",[bi]:"00:%M",[Di]:":%S",[tr]:".%L",["".concat(Jt,"-").concat(pn)]:"%Y-%m ",["".concat(Jt,"-").concat(pn,"-").concat(Xn)]:"%Y-%m-%d ",["".concat(vi,"-").concat(bi)]:"%H:%M"};function Kk(e,t){const n=Ee({},P9,t),i=av(e),r=i.length;let o="",a=0,s,u;for(a=0;a<r;)for(s=i.length;s>a;--s)if(u=i.slice(a,s).join("-"),n[u]!=null){o+=n[u],a=s;break}return o.trim()}const Ms=new Date;function sv(e){return Ms.setFullYear(e),Ms.setMonth(0),Ms.setDate(1),Ms.setHours(0,0,0,0),Ms}function Jk(e){return Zk(new Date(e))}function Qk(e){return uv(new Date(e))}function Zk(e){return va.count(sv(e.getFullYear())-1,e)}function uv(e){return ff.count(sv(e.getFullYear())-1,e)}function lv(e){return sv(e).getDay()}function z9(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,i,r,o,a);return s.setFullYear(e),s}return new Date(e,t,n,i,r,o,a)}function eC(e){return nC(new Date(e))}function tC(e){return cv(new Date(e))}function nC(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return xa.count(t-1,e)}function cv(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return hf.count(t-1,e)}function fv(e){return Ms.setTime(Date.UTC(e,0,1)),Ms.getUTCDay()}function B9(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,i,r,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,i,r,o,a))}function iC(e,t,n,i,r){const o=t||1,a=Fe(e),s=(y,v,x)=>(x=x||y,U9(n[x],i[x],y===a&&o,v)),u=new Date,l=er(e),c=l[Jt]?s(Jt):gn(2012),f=l[pn]?s(pn):l[Yn]?s(Yn):fa,d=l[Dt]&&l[mn]?s(mn,1,Dt+mn):l[Dt]?s(Dt,1):l[mn]?s(mn,1):l[Xn]?s(Xn,1):l[Nr]?s(Nr,1):nl,h=l[vi]?s(vi):fa,g=l[bi]?s(bi):fa,p=l[Di]?s(Di):fa,m=l[tr]?s(tr):fa;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),g(u),p(u),m(u))}}function U9(e,t,n,i){const r=n<=1?e:i?(o,a)=>i+n*Math.floor((e(o,a)-i)/n):(o,a)=>n*Math.floor(e(o,a)/n);return t?(o,a)=>t(r(o,a),a):r}function cl(e,t,n){return t+e*7-(n+6)%7}const q9={[Jt]:e=>e.getFullYear(),[Yn]:e=>Math.floor(e.getMonth()/3),[pn]:e=>e.getMonth(),[Xn]:e=>e.getDate(),[vi]:e=>e.getHours(),[bi]:e=>e.getMinutes(),[Di]:e=>e.getSeconds(),[tr]:e=>e.getMilliseconds(),[Nr]:e=>Zk(e),[Dt]:e=>uv(e),[Dt+mn]:(e,t)=>cl(uv(e),e.getDay(),lv(t)),[mn]:(e,t)=>cl(1,e.getDay(),lv(t))},W9={[Yn]:e=>3*e,[Dt]:(e,t)=>cl(e,0,lv(t))};function rC(e,t){return iC(e,t||1,q9,W9,z9)}const H9={[Jt]:e=>e.getUTCFullYear(),[Yn]:e=>Math.floor(e.getUTCMonth()/3),[pn]:e=>e.getUTCMonth(),[Xn]:e=>e.getUTCDate(),[vi]:e=>e.getUTCHours(),[bi]:e=>e.getUTCMinutes(),[Di]:e=>e.getUTCSeconds(),[tr]:e=>e.getUTCMilliseconds(),[Nr]:e=>nC(e),[Dt]:e=>cv(e),[mn]:(e,t)=>cl(1,e.getUTCDay(),fv(t)),[Dt+mn]:(e,t)=>cl(cv(e),e.getUTCDay(),fv(t))},G9={[Yn]:e=>3*e,[Dt]:(e,t)=>cl(e,0,fv(t))};function oC(e,t){return iC(e,t||1,H9,G9,B9)}const V9={[Jt]:ba,[Yn]:wg.every(3),[pn]:wg,[Dt]:ff,[Xn]:va,[mn]:va,[Nr]:va,[vi]:Zy,[bi]:Qy,[Di]:ya,[tr]:Xy},Y9={[Jt]:wa,[Yn]:_g.every(3),[pn]:_g,[Dt]:hf,[Xn]:xa,[mn]:xa,[Nr]:xa,[vi]:nv,[bi]:tv,[Di]:ya,[tr]:Xy};function fl(e){return V9[e]}function dl(e){return Y9[e]}function aC(e,t,n){return e?e.offset(t,n):void 0}function sC(e,t,n){return aC(fl(e),t,n)}function uC(e,t,n){return aC(dl(e),t,n)}function lC(e,t,n,i){return e?e.range(t,n,i):void 0}function cC(e,t,n,i){return lC(fl(e),t,n,i)}function fC(e,t,n,i){return lC(dl(e),t,n,i)}const pf=1e3,mf=pf*60,yf=mf*60,Eg=yf*24,X9=Eg*7,dC=Eg*30,dv=Eg*365,hC=[Jt,pn,Xn,vi,bi,Di,tr],vf=hC.slice(0,-1),bf=vf.slice(0,-1),xf=bf.slice(0,-1),K9=xf.slice(0,-1),J9=[Jt,Dt],gC=[Jt,pn],pC=[Jt],wf=[[vf,1,pf],[vf,5,5*pf],[vf,15,15*pf],[vf,30,30*pf],[bf,1,mf],[bf,5,5*mf],[bf,15,15*mf],[bf,30,30*mf],[xf,1,yf],[xf,3,3*yf],[xf,6,6*yf],[xf,12,12*yf],[K9,1,Eg],[J9,1,X9],[gC,1,dC],[gC,3,3*dC],[pC,1,dv]];function mC(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(af(t))/n;let r=uf(s=>s[2]).right(wf,i),o,a;return r===wf.length?(o=pC,a=ma(t[0]/dv,t[1]/dv,n)):r?(r=wf[i/wf[r-1][2]<wf[r][2]/i?r-1:r],o=r[0],a=r[1]):(o=hC,a=Math.max(ma(t[0],t[1],n),1)),{units:o,step:a}}function hv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function gv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _f(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function yC(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Ef(r),c=Of(r),f=Ef(o),d=Of(o),h=Ef(a),g=Of(a),p=Ef(s),m=Of(s),y=Ef(u),v=Of(u),x={a:I,A:z,b:X,B:te,c:null,d:EC,e:EC,f:xz,g:Fz,G:Mz,H:yz,I:vz,j:bz,L:OC,m:wz,M:_z,p:xe,q:ge,Q:FC,s:DC,S:Ez,u:Oz,U:Sz,V:Az,w:kz,W:Cz,x:null,X:null,y:Tz,Y:Dz,Z:Nz,"%":TC},b={a:je,A:Oe,b:ke,B:Xe,c:null,d:AC,e:AC,f:Lz,g:Vz,G:Xz,H:Rz,I:jz,j:$z,L:kC,m:Iz,M:Pz,p:xt,q:Ge,Q:FC,s:DC,S:zz,u:Bz,U:Uz,V:qz,w:Wz,W:Hz,x:null,X:null,y:Gz,Y:Yz,Z:Kz,"%":TC},_={a:k,A,b:F,B:C,c:M,d:wC,e:wC,f:hz,g:xC,G:bC,H:_C,I:_C,j:lz,L:dz,m:uz,M:cz,p:S,q:sz,Q:pz,s:mz,S:fz,u:nz,U:iz,V:rz,w:tz,W:oz,x:D,X:N,y:xC,Y:bC,Z:az,"%":gz};x.x=E(n,x),x.X=E(i,x),x.c=E(t,x),b.x=E(n,b),b.X=E(i,b),b.c=E(t,b);function E(Y,ne){return function(fe){var B=[],Ve=-1,pe=0,tt=Y.length,qe,ie,me;for(fe instanceof Date||(fe=new Date(+fe));++Ve<tt;)Y.charCodeAt(Ve)===37&&(B.push(Y.slice(pe,Ve)),(ie=vC[qe=Y.charAt(++Ve)])!=null?qe=Y.charAt(++Ve):ie=qe==="e"?" ":"0",(me=ne[qe])&&(qe=me(fe,ie)),B.push(qe),pe=Ve+1);return B.push(Y.slice(pe,Ve)),B.join("")}}function w(Y,ne){return function(fe){var B=_f(1900,void 0,1),Ve=O(B,Y,fe+="",0),pe,tt;if(Ve!=fe.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(ne&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(pe=gv(_f(B.y,0,1)),tt=pe.getUTCDay(),pe=tt>4||tt===0?iv.ceil(pe):iv(pe),pe=xa.offset(pe,(B.V-1)*7),B.y=pe.getUTCFullYear(),B.m=pe.getUTCMonth(),B.d=pe.getUTCDate()+(B.w+6)%7):(pe=hv(_f(B.y,0,1)),tt=pe.getDay(),pe=tt>4||tt===0?ev.ceil(pe):ev(pe),pe=va.offset(pe,(B.V-1)*7),B.y=pe.getFullYear(),B.m=pe.getMonth(),B.d=pe.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),tt="Z"in B?gv(_f(B.y,0,1)).getUTCDay():hv(_f(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(tt+5)%7:B.w+B.U*7-(tt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,gv(B)):hv(B)}}function O(Y,ne,fe,B){for(var Ve=0,pe=ne.length,tt=fe.length,qe,ie;Ve<pe;){if(B>=tt)return-1;if(qe=ne.charCodeAt(Ve++),qe===37){if(qe=ne.charAt(Ve++),ie=_[qe in vC?ne.charAt(Ve++):qe],!ie||(B=ie(Y,fe,B))<0)return-1}else if(qe!=fe.charCodeAt(B++))return-1}return B}function S(Y,ne,fe){var B=l.exec(ne.slice(fe));return B?(Y.p=c.get(B[0].toLowerCase()),fe+B[0].length):-1}function k(Y,ne,fe){var B=h.exec(ne.slice(fe));return B?(Y.w=g.get(B[0].toLowerCase()),fe+B[0].length):-1}function A(Y,ne,fe){var B=f.exec(ne.slice(fe));return B?(Y.w=d.get(B[0].toLowerCase()),fe+B[0].length):-1}function F(Y,ne,fe){var B=y.exec(ne.slice(fe));return B?(Y.m=v.get(B[0].toLowerCase()),fe+B[0].length):-1}function C(Y,ne,fe){var B=p.exec(ne.slice(fe));return B?(Y.m=m.get(B[0].toLowerCase()),fe+B[0].length):-1}function M(Y,ne,fe){return O(Y,t,ne,fe)}function D(Y,ne,fe){return O(Y,n,ne,fe)}function N(Y,ne,fe){return O(Y,i,ne,fe)}function I(Y){return a[Y.getDay()]}function z(Y){return o[Y.getDay()]}function X(Y){return u[Y.getMonth()]}function te(Y){return s[Y.getMonth()]}function xe(Y){return r[+(Y.getHours()>=12)]}function ge(Y){return 1+~~(Y.getMonth()/3)}function je(Y){return a[Y.getUTCDay()]}function Oe(Y){return o[Y.getUTCDay()]}function ke(Y){return u[Y.getUTCMonth()]}function Xe(Y){return s[Y.getUTCMonth()]}function xt(Y){return r[+(Y.getUTCHours()>=12)]}function Ge(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ne=E(Y+="",x);return ne.toString=function(){return Y},ne},parse:function(Y){var ne=w(Y+="",!1);return ne.toString=function(){return Y},ne},utcFormat:function(Y){var ne=E(Y+="",b);return ne.toString=function(){return Y},ne},utcParse:function(Y){var ne=w(Y+="",!0);return ne.toString=function(){return Y},ne}}}var vC={"-":"",_:" ","0":"0"},Pt=/^\s*\d+/,Q9=/^%/,Z9=/[\\^$*+?|[\]().{}]/g;function Le(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function ez(e){return e.replace(Z9,"\\$&")}function Ef(e){return new RegExp("^(?:"+e.map(ez).join("|")+")","i")}function Of(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function tz(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function nz(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function iz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function rz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function oz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function bC(e,t,n){var i=Pt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function xC(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function az(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function sz(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function uz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function wC(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function lz(e,t,n){var i=Pt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function _C(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function cz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function fz(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function dz(e,t,n){var i=Pt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function hz(e,t,n){var i=Pt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function gz(e,t,n){var i=Q9.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function pz(e,t,n){var i=Pt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function mz(e,t,n){var i=Pt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function EC(e,t){return Le(e.getDate(),t,2)}function yz(e,t){return Le(e.getHours(),t,2)}function vz(e,t){return Le(e.getHours()%12||12,t,2)}function bz(e,t){return Le(1+va.count(ba(e),e),t,3)}function OC(e,t){return Le(e.getMilliseconds(),t,3)}function xz(e,t){return OC(e,t)+"000"}function wz(e,t){return Le(e.getMonth()+1,t,2)}function _z(e,t){return Le(e.getMinutes(),t,2)}function Ez(e,t){return Le(e.getSeconds(),t,2)}function Oz(e){var t=e.getDay();return t===0?7:t}function Sz(e,t){return Le(ff.count(ba(e)-1,e),t,2)}function SC(e){var t=e.getDay();return t>=4||t===0?df(e):df.ceil(e)}function Az(e,t){return e=SC(e),Le(df.count(ba(e),e)+(ba(e).getDay()===4),t,2)}function kz(e){return e.getDay()}function Cz(e,t){return Le(ev.count(ba(e)-1,e),t,2)}function Tz(e,t){return Le(e.getFullYear()%100,t,2)}function Fz(e,t){return e=SC(e),Le(e.getFullYear()%100,t,2)}function Dz(e,t){return Le(e.getFullYear()%1e4,t,4)}function Mz(e,t){var n=e.getDay();return e=n>=4||n===0?df(e):df.ceil(e),Le(e.getFullYear()%1e4,t,4)}function Nz(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Le(t/60|0,"0",2)+Le(t%60,"0",2)}function AC(e,t){return Le(e.getUTCDate(),t,2)}function Rz(e,t){return Le(e.getUTCHours(),t,2)}function jz(e,t){return Le(e.getUTCHours()%12||12,t,2)}function $z(e,t){return Le(1+xa.count(wa(e),e),t,3)}function kC(e,t){return Le(e.getUTCMilliseconds(),t,3)}function Lz(e,t){return kC(e,t)+"000"}function Iz(e,t){return Le(e.getUTCMonth()+1,t,2)}function Pz(e,t){return Le(e.getUTCMinutes(),t,2)}function zz(e,t){return Le(e.getUTCSeconds(),t,2)}function Bz(e){var t=e.getUTCDay();return t===0?7:t}function Uz(e,t){return Le(hf.count(wa(e)-1,e),t,2)}function CC(e){var t=e.getUTCDay();return t>=4||t===0?gf(e):gf.ceil(e)}function qz(e,t){return e=CC(e),Le(gf.count(wa(e),e)+(wa(e).getUTCDay()===4),t,2)}function Wz(e){return e.getUTCDay()}function Hz(e,t){return Le(iv.count(wa(e)-1,e),t,2)}function Gz(e,t){return Le(e.getUTCFullYear()%100,t,2)}function Vz(e,t){return e=CC(e),Le(e.getUTCFullYear()%100,t,2)}function Yz(e,t){return Le(e.getUTCFullYear()%1e4,t,4)}function Xz(e,t){var n=e.getUTCDay();return e=n>=4||n===0?gf(e):gf.ceil(e),Le(e.getUTCFullYear()%1e4,t,4)}function Kz(){return"+0000"}function TC(){return"%"}function FC(e){return+e}function DC(e){return Math.floor(+e/1e3)}var hl,pv,MC,mv,NC;Jz({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Jz(e){return hl=yC(e),pv=hl.format,MC=hl.parse,mv=hl.utcFormat,NC=hl.utcParse,hl}function Sf(e){const t={};return n=>t[n]||(t[n]=e(n))}function Qz(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let o=Zz(i,r);const a=o<i.length?i.slice(o):"";for(;--o>r;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+a}}function Zz(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function RC(e){const t=Sf(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=ll(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return Qz(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,o,a){a=ll(a==null?",f":a);const s=ma(i,r,o),u=Math.max(Math.abs(i),Math.abs(r));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=Wk(s,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=Hk(s,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=qk(s))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let yv;jC();function jC(){return yv=RC({format:xg,formatPrefix:Hy})}function $C(e){return RC(Uk(e))}function Og(e){return arguments.length?yv=$C(e):yv}function LC(e,t,n){n=n||{},Q(n)||L("Invalid time multi-format specifier: ".concat(n));const i=t(Di),r=t(bi),o=t(vi),a=t(Xn),s=t(Dt),u=t(pn),l=t(Yn),c=t(Jt),f=e(n[tr]||".%L"),d=e(n[Di]||":%S"),h=e(n[bi]||"%I:%M"),g=e(n[vi]||"%I %p"),p=e(n[Xn]||n[mn]||"%a %d"),m=e(n[Dt]||"%b %d"),y=e(n[pn]||"%B"),v=e(n[Yn]||"%B"),x=e(n[Jt]||"%Y");return b=>(i(b)<b?f:r(b)<b?d:o(b)<b?h:a(b)<b?g:u(b)<b?s(b)<b?p:m:c(b)<b?l(b)<b?y:v:x)(b)}function IC(e){const t=Sf(e.format),n=Sf(e.utcFormat);return{timeFormat:i=>K(i)?t(i):LC(t,fl,i),utcFormat:i=>K(i)?n(i):LC(n,dl,i),timeParse:Sf(e.parse),utcParse:Sf(e.utcParse)}}let vv;PC();function PC(){return vv=IC({format:pv,parse:MC,utcFormat:mv,utcParse:NC})}function zC(e){return IC(yC(e))}function Af(e){return arguments.length?vv=zC(e):vv}const bv=(e,t)=>Ee({},e,t);function BC(e,t){const n=e?$C(e):Og(),i=t?zC(t):Af();return bv(n,i)}function xv(e,t){const n=arguments.length;return n&&n!==2&&L("defaultLocale expects either zero or two arguments."),n?bv(Og(e),Af(t)):bv(Og(),Af())}function eB(){return jC(),PC(),xv()}const tB=/^(data:|([A-Za-z]+:)?\/\/)/,nB=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,iB=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,UC="file://";function rB(e,t){return n=>({options:n||{},sanitize:aB,load:oB,fileAccess:!!t,file:sB(t),http:lB(e)})}async function oB(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function aB(e,t){t=Ee({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,a;const s=nB.test(e.replace(iB,""));(e==null||typeof e!="string"||!s)&&L("Sanitize failure, invalid URI: "+H(e));const u=tB.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),o=(r=e.startsWith(UC))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(UC.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function sB(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,o)=>{r?i(r):n(o)})}):uB}async function uB(){L("No file system access.")}function lB(e){return e?async function(t,n){const i=Ee({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?_e(o[r])?o[r]():o.text():L(o.status+""+o.statusText)}:cB}async function cB(){L("No HTTP fetch method available.")}const fB=e=>e!=null&&e===e,dB=e=>e==="true"||e==="false"||e===!0||e===!1,hB=e=>!Number.isNaN(Date.parse(e)),qC=e=>!Number.isNaN(+e)&&!(e instanceof Date),gB=e=>qC(e)&&Number.isInteger(+e),wv={boolean:My,integer:hn,number:hn,date:Ny,string:Ry,unknown:dn},Sg=[dB,gB,qC,hB],pB=["boolean","integer","number","date"];function WC(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Sg.length,r=Sg.map((o,a)=>a+1);for(let o=0,a=0,s,u;o<n;++o)for(u=t?e[o][t]:e[o],s=0;s<i;++s)if(r[s]&&fB(u)&&!Sg[s](u)&&(r[s]=0,++a,a===Sg.length))return"string";return pB[r.reduce((o,a)=>o===0?a:o,0)-1]}function HC(e,t){return t.reduce((n,i)=>(n[i]=WC(e,i),n),{})}function GC(e){const t=function(n,i){const r={delimiter:e};return _v(n,i?Ee(i,r):r)};return t.responseType="text",t}function _v(e,t){return t.header&&(e=t.header.map(H).join(t.delimiter)+`
`+e),n9(t.delimiter).parse(e+"")}_v.responseType="text";function mB(e){return typeof Buffer=="function"&&_e(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Ev(e,t){const n=t&&t.property?Gn(t.property):dn;return Q(e)&&!mB(e)?yB(n(e),t):n(JSON.parse(e))}Ev.responseType="json";function yB(e,t){return!P(e)&&mk(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const vB={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function VC(e,t){let n,i,r,o;return e=Ev(e,t),t&&t.feature?(n=a9,r=t.feature):t&&t.mesh?(n=u9,r=t.mesh,o=vB[t.filter]):L("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):L("Invalid TopoJSON object: "+r),i&&i.features||[i]}VC.responseType="json";const Ag={dsv:_v,csv:GC(","),tsv:GC("	"),json:Ev,topojson:VC};function Ov(e,t){return arguments.length>1?(Ag[e]=t,this):re(Ag,e)?Ag[e]:null}function YC(e){const t=Ov(e);return t&&t.responseType||"text"}function XC(e,t,n,i){t=t||{};const r=Ov(t.type||"json");return r||L("Unknown data format type: "+t.type),e=r(e,t),t.parse&&bB(e,t.parse,n,i),re(e,"columns")&&delete e.columns,e}function bB(e,t,n,i){if(!e.length)return;const r=Af();n=n||r.timeParse,i=i||r.utcParse;let o=e.columns||Object.keys(e[0]),a,s,u,l,c,f;t==="auto"&&(t=HC(e,o)),o=Object.keys(t);const d=o.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:n)(m);if(!wv[g])throw Error("Illegal format pattern: "+h+":"+g);return wv[g]});for(u=0,c=e.length,f=o.length;u<c;++u)for(a=e[u],l=0;l<f;++l)s=o[l],a[s]=d[l](a[s])}const kg=rB(typeof fetch!="undefined"&&fetch,null);function Cg(e){const t=e||dn,n=[],i={};return n.add=r=>{const o=t(r);return i[o]||(i[o]=1,n.push(r)),n},n.remove=r=>{const o=t(r);if(i[o]){i[o]=0;const a=n.indexOf(r);a>=0&&n.splice(a,1)}return n},n}async function Tg(e,t){try{await t(e)}catch(n){e.error(n)}}const KC=Symbol("vega_id");let xB=1;function Fg(e){return!!(e&&ae(e))}function ae(e){return e[KC]}function JC(e,t){return e[KC]=t,e}function Ue(e){const t=e===Object(e)?e:{data:e};return ae(t)?t:JC(t,xB++)}function Sv(e){return Dg(e,Ue({}))}function Dg(e,t){for(const n in e)t[n]=e[n];return t}function QC(e,t){return JC(t,ae(e))}function Ns(e,t){return e?t?(n,i)=>e(n,i)||ae(t(n))-ae(t(i)):(n,i)=>e(n,i)||ae(n)-ae(i):null}function ZC(e){return e&&e.constructor===Rs}function Rs(){const e=[],t=[],n=[],i=[],r=[];let o=null,a=!1;return{constructor:Rs,insert(s){const u=J(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=_e(s)?i:t,l=J(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:gn(l)};return _e(s)?(c.filter=s,r.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return _e(s)?r.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return o=s,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[ae(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[ae(p)]=-1;for(f=0,d=i.length;f<d;++f)g=i[f],u.forEach(v=>{g(v)&&(l[ae(v)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=ae(p),l[m]?l[m]=1:s.add.push(Ue(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[ae(p)]<0&&s.rem.push(p);function y(v,x,b){b?v[x]=b(v):s.encode=x,a||(c[ae(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[ae(p)],m>0&&(y(p,g,h.value),s.modifies(g));for(f=0,d=r.length;f<d;++f)h=r[f],g=h.filter,u.forEach(v=>{g(v)&&l[ae(v)]>0&&y(v,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=t.length||i.length?u.filter(v=>l[ae(v)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(o||o==null&&(t.length||i.length))&&s.clean(!0),s}}}const Mg="_:mod:_";function Ng(){Object.defineProperty(this,Mg,{writable:!0,value:{}})}Ng.prototype={set(e,t,n,i){const r=this,o=r[e],a=r[Mg];return t!=null&&t>=0?(o[t]!==n||i)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||i)&&(r[e]=n,a[e]=P(n)?1+n.length:-1),r},modified(e,t){const n=this[Mg];if(arguments.length){if(P(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Mg]={},this}};let wB=0;const _B="pulse",EB=new Ng,OB=1,SB=2;function it(e,t,n,i){this.id=++wB,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function eT(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}it.prototype={targets(){return this._targets||(this._targets=Cg(rf))},set(e){return this.value!==e?(this.value=e,1):0},skip:eT(OB),modified:eT(SB),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Ng,r=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(f,d,h)=>{h instanceof it?(h!==this&&(t&&h.targets().add(this),o.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(a in e)if(s=e[a],a===_B)J(s).forEach(f=>{f instanceof it?f!==this&&(f.targets().add(this),o.push(f)):L("Pulse parameters must be operator instances.")}),this.source=s;else if(P(s))for(i.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(r.initonly=!0),o},marshall(e){const t=this._argval||EB,n=this._argops;let i,r,o,a;if(n){const s=n.length;for(r=0;r<s;++r)i=n[r],o=i.op,a=o.modified()&&o.stamp===e,t.set(i.name,i.index,o.value,a);if(n.initonly){for(r=0;r<s;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function AB(e,t,n,i){let r=1,o;return e instanceof it?o=e:e&&e.prototype instanceof it?o=new e:_e(e)?o=new it(null,e):(r=0,o=new it(e,t)),this.rank(o),r&&(i=n,n=t),n&&this.connect(o,o.parameters(n,i)),this.touch(o),o}function kB(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let CB=0;function Rg(e,t,n){this.id=++CB,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function _a(e,t,n){return new Rg(e,t,n)}Rg.prototype={_filter:Ti,_apply:dn,targets(){return this._targets||(this._targets=Cg(rf))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=_a(e);return this.targets().add(t),t},apply(e){const t=_a(null,e);return this.targets().add(t),t},merge(){const e=_a();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=_a();return this.targets().add(_a(null,null,Fy(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(_a(null,null,()=>n=!0)),t.targets().add(_a(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Ti,this._targets=null}};function TB(e,t,n,i){const r=this,o=_a(n,i),a=function(l){l.dataflow=r;try{o.receive(l)}catch(c){r.error(c)}finally{r.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=J(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,a);return o}function FB(e,t){const n=this.locale();return XC(e,t,n.timeParse,n.utcParse)}function DB(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function MB(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:YC(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}}async function NB(e,t,n){const i=this,r=i._pending||RB(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(Ti).insert(o.data||[])),r.done(),o}function RB(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const jB={skip:!0};function $B(e,t,n,i,r){return(e instanceof it?IB:LB)(this,e,t,n,i,r),this}function LB(e,t,n,i,r,o){const a=Ee({},o,jB);let s,u;_e(n)||(n=gn(n)),i===void 0?s=l=>e.touch(n(l)):_e(i)?(u=new it(null,i,r,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;ZC(f)?e.pulse(c,f,o):e.update(c,f,a)}):s=l=>e.update(n(l),i,a),t.apply(s)}function IB(e,t,n,i,r,o){if(i===void 0)t.targets().add(n);else{const a=o||{},s=new it(null,PB(n,i),r,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function PB(e,t){return t=_e(t)?t:gn(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function zB(e){e.rank=++this._rank}function BB(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&L("Cycle detected in dataflow graph.")}const jg={},Rr=1<<0,Ea=1<<1,To=1<<2,UB=Rr|Ea,tT=Rr|To,gl=Rr|Ea|To,nT=1<<3,kf=1<<4,iT=1<<5,rT=1<<6;function Oa(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Av(e,t){const n=[];return pa(e,t,i=>n.push(i)),n}function oT(e,t){const n={};return e.visit(t,i=>{n[ae(i)]=1}),i=>n[ae(i)]?null:i}function $g(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}Oa.prototype={StopPropagation:jg,ADD:Rr,REM:Ea,MOD:To,ADD_REM:UB,ADD_MOD:tT,ALL:gl,REFLOW:nT,SOURCE:kf,NO_SOURCE:iT,NO_FIELDS:rT,fork(e){return new Oa(this.dataflow).init(this,e)},clone(){const e=this.fork(gl);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(gl|kf)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Oa(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&rT)&&(n.fields=e.fields),t&Rr?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Ea?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&To?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&iT?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||gl;return t&Rr&&this.add.length||t&Ea&&this.rem.length||t&To&&this.mod.length},reflow(e){if(e)return this.fork(gl).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(To,oT(this,Rr))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return P(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?P(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Rr&&(n.addF=$g(n.addF,t)),e&Ea&&(n.remF=$g(n.remF,t)),e&To&&(n.modF=$g(n.modF,t)),e&kf&&(n.srcF=$g(n.srcF,t)),n},materialize(e){e=e||gl;const t=this;return e&Rr&&t.addF&&(t.add=Av(t.add,t.addF),t.addF=null),e&Ea&&t.remF&&(t.rem=Av(t.rem,t.remF),t.remF=null),e&To&&t.modF&&(t.mod=Av(t.mod,t.modF),t.modF=null),e&kf&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&kf)return pa(n.source,n.srcF,i),n;e&Rr&&pa(n.add,n.addF,i),e&Ea&&pa(n.rem,n.remF,i),e&To&&pa(n.mod,n.modF,i);const r=n.source;if(e&nT&&r){const o=n.add.length+n.mod.length;o===r.length||(o?pa(r,oT(n,tT),i):pa(r,n.srcF,i))}return n}};function kv(e,t,n,i){const r=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let s=0;s<o;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(a|=r.ADD),u.changed(r.REM)&&(a|=r.REM),u.changed(r.MOD)&&(a|=r.MOD)}}this.changes=a}W(kv,Oa,{fork(e){const t=new Oa(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?P(e)?e.some(i=>n[i]):n[e]:0},filter(){L("MultiPulse does not support filtering.")},materialize(){L("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n}});async function qB(e,t,n){const i=this,r=[];if(i._pulse)return aT(i);if(i._pending&&await i._pending,t&&await Tg(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new Oa(i,o,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=Cg(rf);let a=0,s,u,l;try{for(;i._heap.size()>0;){if(s=i._heap.pop(),s.rank!==s.qrank){i._enqueue(s,!0);continue}u=s.run(i._getPulse(s,e)),u.then?u=await u:u.async&&(r.push(u.async),u=jg),u!==jg&&s._targets&&s._targets.forEach(c=>i._enqueue(c)),++a}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${a} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Tg(i,c[f].callback)}return n&&await Tg(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function WB(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function HB(e,t,n){return this._pulse?aT(this):(this.evaluate(e,t,n),this)}function GB(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function aT(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function VB(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function YB(e,t){const n=e.source,i=this._clock;return n&&P(n)?new kv(this,i,n.map(r=>r.pulse),t):this._input[e.id]||XB(this._pulse,n&&n.pulse)}function XB(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==jg&&(e.source=t.source),e)}const Cv={skip:!1,force:!1};function KB(e,t){const n=t||Cv;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function JB(e,t,n){const i=n||Cv;return(e.set(t)||i.force)&&this.touch(e,i),this}function QB(e,t,n){this.touch(e,n||Cv);const i=new Oa(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function ZB(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),sT(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,eU(t,0,e)):i=n,i}}}function sT(e,t,n,i){let r,o;const a=e[n];for(;n>t;){if(o=n-1>>1,r=e[o],i(a,r)<0){e[n]=r,n=o;continue}break}return e[n]=a}function eU(e,t,n){const i=t,r=e.length,o=e[t];let a=(t<<1)+1,s;for(;a<r;)s=a+1,s<r&&n(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=o,sT(e,i,t,n)}function pl(){this.logger(Sy()),this.logLevel(Ey),this._clock=0,this._rank=0,this._locale=xv();try{this._loader=kg()}catch{}this._touched=Cg(rf),this._input={},this._pulse=null,this._heap=ZB((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Cf(e){return function(){return this._log[e].apply(this,arguments)}}pl.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Cf("error"),warn:Cf("warn"),info:Cf("info"),debug:Cf("debug"),logLevel:Cf("level"),cleanThreshold:1e4,add:AB,connect:kB,rank:zB,rerank:BB,pulse:QB,touch:KB,update:JB,changeset:Rs,ingest:DB,parse:FB,preload:NB,request:MB,events:TB,on:$B,evaluate:qB,run:HB,runAsync:WB,runAfter:GB,_enqueue:VB,_getPulse:YB};function R(e,t){it.call(this,e,null,t)}W(R,it,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const ml={};function uT(e){const t=lT(e);return t&&t.Definition||null}function lT(e){return e=e&&e.toLowerCase(),re(ml,e)?ml[e]:null}function*cT(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Tv(e,t,n){const i=Float64Array.from(cT(e,n));return i.sort(sl),t.map(r=>Mk(i,r))}function Fv(e,t){return Tv(e,[.25,.5,.75],t)}function Dv(e,t){const n=e.length,i=p9(e,t),r=Fv(e,t),o=(r[2]-r[0])/1.34,a=Math.min(i,o)||i||Math.abs(r[0])||1;return 1.06*a*Math.pow(n,-.2)}function fT(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let o=e.extent[0],a=e.extent[1],s,u,l,c,f,d;const h=e.span||a-o||Math.abs(o)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=r.length;f<d;++f)c=s/r[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const g=c>=0?0:~~(-c/i)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/s+p)*s,o=o<c?c-s:c,a=Math.ceil(a/s)*s),{start:o,stop:a===o?o+s:a,step:s}}var Mi=Math.random;function tU(e){Mi=e}function dT(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(cT(e,i)),o=r.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=r[~~(Mi()*o)];c[l]=s/o}return c.sort(sl),[qy(c,n/2),qy(c,1-n/2)]}function hT(e,t,n,i){i=i||(d=>d);const r=e.length,o=new Float64Array(r);let a=0,s=1,u=i(e[0]),l=u,c=u+t,f;for(;s<r;++s){if(f=i(e[s]),f>=c){for(l=(u+l)/2;a<s;++a)o[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<s;++a)o[a]=l;return n?nU(o,t+t/4):o}function nU(e,t){const n=e.length;let i=0,r=1,o,a;for(;e[i]===e[r];)++r;for(;r<n;){for(o=r+1;e[r]===e[o];)++o;if(e[r]-e[r-1]<t){for(a=r+(i+o-r-r>>1);a<r;)e[a++]=e[r];for(;a>r;)e[a--]=e[i]}i=r,r=o}return e}function iU(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function rU(e,t){t==null&&(t=e,e=0);let n,i,r;const o={min(a){return arguments.length?(n=a||0,r=i-n,o):n},max(a){return arguments.length?(i=a||0,r=i-n,o):i},sample(){return n+Math.floor(r*Mi())},pdf(a){return a===Math.floor(a)&&a>=n&&a<i?1/r:0},cdf(a){const s=Math.floor(a);return s<n?0:s>=i?1:(s-n+1)/r},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*r):NaN}};return o.min(e).max(t)}const gT=Math.sqrt(2*Math.PI),oU=Math.SQRT2;let Tf=NaN;function Lg(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,o;if(Tf===Tf)n=Tf,Tf=NaN;else{do n=Mi()*2-1,i=Mi()*2-1,r=n*n+i*i;while(r===0||r>1);o=Math.sqrt(-2*Math.log(r)/r),n*=o,Tf=i*o}return e+n*t}function Mv(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*gT)}function Ig(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let o;if(r>37)o=0;else{const a=Math.exp(-r*r/2);let s;r<7.07106781186547?(s=.0352624965998911*r+.700383064443688,s=s*r+6.37396220353165,s=s*r+33.912866078383,s=s*r+112.079291497871,s=s*r+221.213596169931,s=s*r+220.206867912376,o=a*s,s=.0883883476483184*r+1.75566716318264,s=s*r+16.064177579207,s=s*r+86.7807322029461,s=s*r+296.564248779674,s=s*r+637.333633378831,s=s*r+793.826512519948,s=s*r+440.413735824752,o=o/s):(s=r+.65,s=r+4/s,s=r+3/s,s=r+2/s,s=r+1/s,o=a/s/2.506628274631)}return i>0?1-o:o}function Pg(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*oU*aU(2*e-1)}function aU(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Nv(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>Lg(n,i),pdf:o=>Mv(o,n,i),cdf:o=>Ig(o,n,i),icdf:o=>Pg(o,n,i)};return r.mean(e).stdev(t)}function Rv(e,t){const n=Nv();let i=0;const r={data(o){return arguments.length?(e=o,i=o?o.length:0,r.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Dv(e)),r):t},sample(){return e[~~(Mi()*i)]+t*n.sample()},pdf(o){let a=0,s=0;for(;s<i;++s)a+=n.pdf((o-e[s])/t);return a/t/i},cdf(o){let a=0,s=0;for(;s<i;++s)a+=n.cdf((o-e[s])/t);return a/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function jv(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+Lg()*t)}function $v(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*gT*e)}function Lv(e,t,n){return Ig(Math.log(e),t,n)}function Iv(e,t,n){return Math.exp(Pg(e,t,n))}function pT(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>jv(n,i),pdf:o=>$v(o,n,i),cdf:o=>Lv(o,n,i),icdf:o=>Iv(o,n,i)};return r.mean(e).stdev(t)}function mT(e,t){let n=0,i;function r(a){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)s[l]/=u;return s}const o={weights(a){return arguments.length?(i=r(t=a||[]),o):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),o.weights(t)):e},sample(){const a=Mi();let s=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(a<u){s=e[l];break}return s.sample()},pdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].pdf(a);return s},cdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].cdf(a);return s},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function Pv(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*Mi()}function zv(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function Bv(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function Uv(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function yT(e,t){let n,i;const r={min(o){return arguments.length?(n=o||0,r):n},max(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>Pv(n,i),pdf:o=>zv(o,n,i),cdf:o=>Bv(o,n,i),icdf:o=>Uv(o,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function Ff(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-o*e,o]}function zg(e,t,n,i){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),i&&e.sort((h,g)=>t(h)-t(g));const r=e.length,o=new Float64Array(r),a=new Float64Array(r);let s=0,u=0,l=0,c,f,d;for(d of e)o[s]=c=+t(d),a[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<r;++s)o[s]-=u,a[s]-=l;return[o,a,u,l]}function Df(e,t,n,i){let r=-1,o,a;for(const s of e)o=t(s),a=n(s),o!=null&&(o=+o)>=o&&a!=null&&(a=+a)>=a&&i(o,a,++r)}function yl(e,t,n,i,r){let o=0,a=0;return Df(e,t,n,(s,u)=>{const l=u-r(s),c=u-i;o+=l*l,a+=c*c}),1-o/a}function qv(e,t,n){let i=0,r=0,o=0,a=0,s=0;Df(e,t,n,(c,f)=>{++s,i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Ff(i,r,o,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:yl(e,t,n,r,l)}}function vT(e,t,n){let i=0,r=0,o=0,a=0,s=0;Df(e,t,n,(c,f)=>{++s,c=Math.log(c),i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Ff(i,r,o,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:yl(e,t,n,r,l)}}function bT(e,t,n){const[i,r,o,a]=zg(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,g;Df(e,t,n,(v,x)=>{d=i[f++],h=Math.log(x),g=d*x,s+=(x*h-s)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=Ff(u/a,s/a,l/a,c/a),y=v=>Math.exp(p+m*(v-o));return{coef:[Math.exp(p-m*o),m],predict:y,rSquared:yl(e,t,n,a,y)}}function xT(e,t,n){let i=0,r=0,o=0,a=0,s=0,u=0;Df(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,i+=(h-i)/u,r+=(g-r)/u,o+=(h*g-o)/u,a+=(h*h-a)/u,s+=(d-s)/u});const l=Ff(i,r,o,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:yl(e,t,n,s,c)}}function Wv(e,t,n){const[i,r,o,a]=zg(e,t,n),s=i.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<s;)g=i[h],p=r[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,v=u*y-l*l,x=(d*u-f*l)/v,b=(f*y-d*l)/v,_=-x*u,E=w=>(w=w-o,x*w*w+b*w+_+a);return{coef:[_-b*o+x*o*o+a,b-2*x*o,x],predict:E,rSquared:yl(e,t,n,a,E)}}function wT(e,t,n,i){if(i===1)return qv(e,t,n);if(i===2)return Wv(e,t,n);const[r,o,a,s]=zg(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d)*o[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=uU(c),v=x=>{x-=a;let b=s+y[0]+y[1]*x+y[2]*x*x;for(d=3;d<f;++d)b+=y[d]*Math.pow(x,d);return b};return{coef:sU(f,y,-a,s),predict:v,rSquared:yl(e,t,n,s,v)}}function sU(e,t,n,i){const r=Array(e);let o,a,s,u;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,r[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,r[o-a]+=s*Math.pow(n,a)*u;return r[0]+=i,r}function uU(e){const t=e.length-1,n=[];let i,r,o,a,s;for(i=0;i<t;++i){for(a=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][a])&&(a=r);for(o=i;o<t+1;++o)s=e[o][i],e[o][i]=e[o][a],e[o][a]=s;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(s=0,o=r+1;o<t;++o)s+=e[o][r]*n[o];n[r]=(e[t][r]-s)/e[r][r]}return n}const _T=2,ET=1e-12;function OT(e,t,n,i){const[r,o,a,s]=zg(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=_T;){const g=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=g[0],x=g[1],b=y-r[v]>r[x]-y?v:x;let _=0,E=0,w=0,O=0,S=0;const k=1/Math.abs(r[b]-y||1);for(let C=v;C<=x;++C){const M=r[C],D=o[C],N=lU(Math.abs(y-M)*k)*d[C],I=M*N;_+=N,E+=I,w+=D*N,O+=D*I,S+=M*I}const[A,F]=Ff(E/_,w/_,O/_,S/_);c[m]=A+F*y,f[m]=Math.abs(o[m]-c[m]),cU(r,m+1,g)}if(h===_T)break;const p=Nk(f);if(Math.abs(p)<ET)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?ET:(v=1-y*y)*v}return fU(r,c,a,s)}function lU(e){return(e=1-e*e*e)*e*e}function cU(e,t,n){const i=e[t];let r=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>r&&e[o]-i<=i-e[r];)n[0]=++r,n[1]=o,++o}function fU(e,t,n,i){const r=e.length,o=[];let a=0,s=0,u=[],l;for(;a<r;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++s:(s=0,u[1]+=i,u=[l,t[a]],o.push(u));return u[1]+=i,o}const dU=.5*Math.PI/180;function Bg(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=p=>[p,e(p)],o=t[0],a=t[1],s=a-o,u=s/i,l=[r(o)],c=[];if(n===i){for(let p=1;p<i;++p)l.push(r(o+p/n*s));return l.push(r(a)),l}else{c.push(r(a));for(let p=n;--p>0;)c.push(r(o+p/n*s))}let f=l[0],d=c[c.length-1];const h=1/s,g=hU(f[1],c);for(;d;){const p=r((f[0]+d[0])/2);p[0]-f[0]>=u&&gU(f,p,d,h,g)>dU?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function hU(e,t){let n=e,i=e;const r=t.length;for(let o=0;o<r;++o){const a=t[o][1];a<n&&(n=a),a>i&&(i=a)}return 1/(i-n)}function gU(e,t,n,i,r){const o=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),a=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(o-a)}function pU(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function Hv(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:pU(e)}function ST(e,t,n){return n||e+(t?"_"+t:"")}const Gv=()=>{},mU={init:Gv,add:Gv,rem:Gv,idx:0},Mf={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Nf=Object.keys(Mf);function yU(e,t){return n=>Ee({name:e,out:n||e},mU,t)}Nf.forEach(e=>{Mf[e]=yU(e,Mf[e])});function AT(e,t){return Mf[e](t)}function kT(e,t){return e.idx-t.idx}function vU(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=Mf[r]())})};return e.forEach(n),Object.values(t).sort(kT)}function bU(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function xU(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function wU(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function _U(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function CT(e,t){const n=t||dn,i=vU(e),r=e.slice().sort(kT);function o(a){this._ops=i,this._out=r,this.cell=a,this.init()}return o.prototype.init=bU,o.prototype.add=xU,o.prototype.rem=wU,o.prototype.set=_U,o.prototype.get=n,o.fields=e.map(a=>a.out),o}function Vv(e){this._key=e?Gn(e):ae,this.reset()}const Qt=Vv.prototype;Qt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Qt.add=function(e){this._add.push(e)};Qt.rem=function(e){this._rem.push(e)};Qt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,o=Array(i-r),a={};let s,u,l;for(s=0;s<r;++s)a[n(t[s])]=1;for(s=0,u=0;s<i;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Qt.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,o;for(;--i>=0;)o=e(t[i])+"",re(n,o)||(n[o]=1,++r);return r};Qt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=gk(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Qt.argmin=function(e){return this.extent(e)[0]||{}};Qt.argmax=function(e){return this.extent(e)[1]||{}};Qt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Qt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Qt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Fv(this.values(),e),this._get=e),this._q};Qt.q1=function(e){return this.quartile(e)[0]};Qt.q2=function(e){return this.quartile(e)[1]};Qt.q3=function(e){return this.quartile(e)[2]};Qt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=dT(this.values(),1e3,.05,e),this._get=e),this._ci};Qt.ci0=function(e){return this.ci(e)[0]};Qt.ci1=function(e){return this.ci(e)[1]};function Sa(e){R.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Sa.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Nf},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};W(Sa,R,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function o(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}o(e._prev),o(t);function a(s,u,l){const c=n[l],f=i[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<r?a(h,u,l):t[h]||e.cell(h,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=J(fn(m)),v=y.length;let x=0,b;for(;x<v;++x)i[b=y[x]]||(i[b]=1,t.push(b))}this._dims=J(e.groupby),this._dnames=this._dims.map(m=>{const y=yt(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:Hv(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,g,p;for(u!==a.length&&L("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=o[p],f=a[p],c==null&&f!=="count"&&L("Null aggregate field specified."),h=yt(c),g=ST(f,h,s[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(AT(f,g))}return this._measures=this._measures.map(m=>CT(m,m.field)),{}},cellkey:Hv(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let o=0;o<r;++o)n.agg[o]=new i[o](n)}return n.store&&(n.data=new Vv),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,o={};for(let a=0;a<r;++a)o[n[a]]=i[a](e);return t?QC(t.tuple,o):Ue(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,o=i.length;r<o;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const EU=1e-14;function Yv(e){R.call(this,null,e)}Yv.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};W(Yv,R,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,o=i.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(fn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[s]=f,c[u]=f==null?null:r+o*(1+(f-r)/o)}:c=>c[s]=i(c)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=fT(e),i=n.step;let r=n.start,o=r+Math.ceil((n.stop-r)/i)*i,a,s;(a=e.anchor)!=null&&(s=a-(r+i*Math.floor((a-r)/i)),r+=s,o+=s);const u=function(l){let c=hn(t(l));return c==null?null:c<r?-1/0:c>o?1/0:(c=Math.max(r,Math.min(c,o-i)),r+i*Math.floor(EU+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=Hn(u,fn(t),e.name||"bin_"+yt(t))}});function TT(e,t,n){const i=e;let r=t||[],o=n||[],a={},s=0;return{add:u=>o.push(u),remove:u=>a[i(u)]=++s,size:()=>r.length,data:(u,l)=>(s&&(r=r.filter(c=>!a[i(c)]),a={},s=0),l&&u&&r.sort(u),o.length&&(r=u?xk(u,r,o.sort(u)):r.concat(o),o=[]),r)}}function Xv(e){R.call(this,[],e)}Xv.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};W(Xv,R,{transform(e,t){const n=t.fork(t.ALL),i=TT(ae,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data(Ns(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function FT(e){it.call(this,null,OU,e)}W(FT,it);function OU(e){return this.value&&!e.modified()?this.value:Ty(e.fields,e.orders)}function Kv(e){R.call(this,null,e)}Kv.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function SU(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}W(Kv,R,{transform(e,t){const n=f=>d=>{for(var h=SU(s(d),e.case,o)||[],g,p=0,m=h.length;p<m;++p)a.test(g=h[p])||f(g)},i=this._parameterCheck(e,t),r=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=i[s],l=n[s]||0,!u&&l?(i[s]=u=Ue({}),u[r]=s,u[o]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[s]=null,i[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}});function Jv(e){R.call(this,null,e)}Jv.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};W(Jv,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],o=i[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=AU(s,r,o,e.filter||Ti)):n.mod=s,n.source=this.value,n.modifies(i)}});function AU(e,t,n,i){for(var r=[],o={},a=e.length,s=0,u,l;s<a;++s)for(o[t]=l=e[s],u=0;u<a;++u)o[n]=e[u],i(o)&&(r.push(Ue(o)),o={},o[t]=l);return r}const DT={kde:Rv,mixture:mT,normal:Nv,lognormal:pT,uniform:yT},kU="distributions",MT="function",CU="field";function NT(e,t){const n=e[MT];re(DT,n)||L("Unknown distribution function: "+n);const i=DT[n]();for(const r in e)r===CU?i.data((e.from||t()).map(e[r])):r===kU?i[r](e[r].map(o=>NT(o,t))):typeof i[r]===MT&&i[r](e[r]);return i}function Qv(e){R.call(this,null,e)}const RT=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],TU={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:RT},{name:"weights",type:"number",array:!0}]};Qv.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:RT.concat(TU)},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(Qv,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=NT(e.distribution,FU(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&L("Invalid density method: "+a),!e.extent&&!i.data&&L("Missing density extent parameter."),a=i[a];const s=e.as||["value","density"],u=e.extent||Mr(i.data()),l=Bg(a,u,r,o).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Ue(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function FU(e){return()=>e.materialize(e.SOURCE).source}function jT(e,t){return e?e.map((n,i)=>t[i]||yt(n)):null}function Zv(e,t,n){const i=[],r=f=>f(u);let o,a,s,u,l,c;if(t==null)i.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(r),c=o[l],c||(o[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const $T="bin";function eb(e){R.call(this,null,e)}eb.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:$T}]};const DU=(e,t)=>af(Mr(e,t))/30;W(eb,R,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=Zv(t.source,e.groupby,dn),r=e.smooth||!1,o=e.field,a=e.step||DU(n,o),s=Ns((g,p)=>o(g)-o(p)),u=e.as||$T,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=i[d].sort(s);h=-1;for(const p of hT(g,a,r,o))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function LT(e){it.call(this,null,MU,e),this.modified(!0)}W(LT,it);function MU(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Hn(n=>t(n,e),fn(t),yt(t))}function tb(e){R.call(this,[void 0,void 0],e)}tb.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};W(tb,R,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let o=n[0],a=n[1];if((r||o==null)&&(o=1/0,a=-1/0),t.visit(r?t.SOURCE:t.ADD,s=>{const u=hn(i(s));u!=null&&(u<o&&(o=u),u>a&&(a=u))}),!Number.isFinite(o)||!Number.isFinite(a)){let s=yt(i);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}});function nb(e,t){it.call(this,e),this.parent=t,this.count=0}W(nb,it,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function Ug(e){R.call(this,{},e),this._keys=ol();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}W(Ug,R,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o=re(r,e)&&r[e],a,s;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(s=i||(s=this._group[e])&&s.tuple,a=n.dataflow,o=new nb(n.fork(n.NO_SOURCE),this),a.add(o).connect(t(a,e,s)),r[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,a=e.modified("key"),s=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ae(u),c=o.get(l);c!==void 0&&(o.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);o.set(ae(u),l),s(l).add(u)}),a||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ae(u),c=o.get(l),f=i(u);c===f?s(f).mod(u):(o.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(o.get(ae(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=ae(u),c=o.get(l),f=i(u);c!==f&&(o.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function IT(e){it.call(this,null,NU,e)}W(IT,it);function NU(e){return this.value&&!e.modified()?this.value:P(e.name)?J(e.name).map(t=>Gn(t)):Gn(e.name,e.as)}function ib(e){R.call(this,ol(),e)}ib.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};W(ib,R,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),o=r.add,a=r.rem,s=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ae(f);i.has(d)?i.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):i.set(ae(f),1)});function c(f){const d=ae(f),h=u(f,e),g=i.get(d);h&&g?(i.delete(d),o.push(f)):!h&&!g?(i.set(d,1),a.push(f)):l&&h&&!g&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function rb(e){R.call(this,[],e)}rb.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};W(rb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=jT(i,e.as||[]),o=e.index||null,a=r.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=i.map(g=>g(s)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Sv(s),f=0;f<a;++f)d[r[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)}});function ob(e){R.call(this,[],e)}ob.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};W(ob,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(yt),o=e.as||["key","value"],a=o[0],s=o[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Sv(l),f[a]=r[c],f[s]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function ab(e){R.call(this,null,e)}ab.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};W(ab,R,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,a=>a[i]=n(a,e))}});function PT(e){R.call(this,[],e)}W(PT,R,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,o=e.size-r.length,a,s,u;if(o>0){for(a=[];--o>=0;)a.push(u=Ue(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=r.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,r=r.slice(-o);return n.source=this.value=r,n}});const qg={value:"value",median:Nk,mean:y9,min:Uy,max:Cs},RU=[];function sb(e){R.call(this,[],e)}sb.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function jU(e){var t=e.method||qg.value,n;if(qg[t]==null)L("Unrecognized imputation method: "+t);else return t===qg.value?(n=e.value!==void 0?e.value:0,()=>n):qg[t]}function $U(e){const t=e.field;return n=>n?t(n):NaN}W(sb,R,{transform(e,t){var n=t.fork(t.ALL),i=jU(e),r=$U(e),o=yt(e.field),a=yt(e.key),s=(e.groupby||[]).map(yt),u=LU(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,v,x,b,_;for(m=0,x=u.length;m<x;++m)for(d=u[m],g=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(p=u.domain[v],_={_impute:!0},y=0,b=g.length;y<b;++y)_[s[y]]=g[y];_[a]=p,_[o]=Number.isNaN(h)?h=i(d,r):h,l.push(Ue(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function LU(e,t,n,i){var r=y=>y(m),o=[],a=i?i.slice():[],s={},u={},l,c,f,d,h,g,p,m;for(a.forEach((y,v)=>s[y]=v+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=s[g]||(s[g]=a.push(g)),c=(l=t?t.map(r):RU)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=a,o}function ub(e){Sa.call(this,e)}ub.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Nf},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};W(ub,Sa,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(r=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{Ee(o,r[n.cellkey(o)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function lb(e){R.call(this,null,e)}lb.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(lb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=Zv(i,e.groupby,e.field),o=(e.groupby||[]).map(yt),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&L("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=Mr(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const g=Rv(h,a)[s],p=e.counts?h.length:1,m=c||Mr(h);Bg(g,m,f,d).forEach(y=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[u[0]]=y[0],v[u[1]]=y[1]*p,l.push(Ue(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function zT(e){it.call(this,null,IU,e)}W(zT,it);function IU(e){return this.value&&!e.modified()?this.value:Dy(e.fields,e.flat)}function BT(e){R.call(this,[],e),this._pending=null}W(BT,R,{transform(e,t){const n=t.dataflow;return this._pending?cb(this,t,this._pending):PU(e)?t.StopPropagation:e.values?cb(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=J(r.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(i=>cb(this,t,J(i.data)))}});function PU(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function cb(e,t,n){n.forEach(Ue);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function fb(e){R.call(this,{},e)}fb.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};W(fb,R,{transform(e,t){const n=e.fields,i=e.index,r=e.values,o=e.default==null?null:e.default,a=e.modified(),s=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,s>1&&!c&&L('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&L('The "as" parameter has too few output field names.'),c=c||r.map(yt),f=function(g){for(var p=0,m=0,y,v;p<s;++p)if(v=i.get(n[p](g)),v==null)for(y=0;y<d;++y,++m)g[c[m]]=o;else for(y=0;y<d;++y,++m)g[c[m]]=r[y](v)}):(c||L("Missing output field names."),f=function(g){for(var p=0,m;p<s;++p)m=i.get(n[p](g)),g[c[p]]=m==null?o:m}),a?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function UT(e){it.call(this,null,zU,e)}W(UT,it);function zU(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,o,a;for(o=0;o<n;++o)a=t[o],a[0]<i&&(i=a[0]),a[1]>r&&(r=a[1]);return[i,r]}function qT(e){it.call(this,null,BU,e)}W(qT,it);function BU(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function WT(e){R.call(this,null,e)}W(WT,R,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function db(e){Sa.call(this,e)}db.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Nf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};W(db,Sa,{_transform:Sa.prototype.transform,transform(e,t){return this._transform(UU(e,t),t)}});function UU(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",o=fn(n).concat(fn(i)),a=WU(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>r),fields:a.map(s=>qU(s,n,i,o)),as:a.map(s=>s+""),modified:e.modified.bind(e)}}function qU(e,t,n,i){return Hn(r=>t(r)===e?n(r):NaN,i,e+"")}function WU(e,t,n){const i={},r=[];return n.visit(n.SOURCE,o=>{const a=e(o);i[a]||(i[a]=1,r.push(a))}),r.sort(pg),t?r.slice(0,t):r}function HT(e){Ug.call(this,e)}W(HT,Ug,{transform(e,t){const n=e.subflow,i=e.field,r=o=>this.subflow(ae(o),n,t,o);return(e.modified("field")||i&&t.modified(fn(i)))&&L("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,o=>{const a=r(o);i(o).forEach(s=>a.mod(s))}),t.visit(t.ADD,o=>{const a=r(o);i(o).forEach(s=>a.add(Ue(s)))}),t.visit(t.REM,o=>{const a=r(o);i(o).forEach(s=>a.rem(s))})):(t.visit(t.MOD,o=>r(o).mod(o)),t.visit(t.ADD,o=>r(o).add(o)),t.visit(t.REM,o=>r(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function hb(e){R.call(this,null,e)}hb.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};W(hb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=jT(e.fields,e.as||[]),o=i?(s,u)=>HU(s,u,i,r):Dg;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,s=>{const u=ae(s);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,s=>{const u=o(s,Ue({}));a[ae(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(o(s,a[ae(s)]))}),n}});function HU(e,t,n,i){for(let r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}function GT(e){R.call(this,null,e)}W(GT,R,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function gb(e){R.call(this,null,e)}gb.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const GU=1e-14;W(gb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,o=Zv(r,e.groupby,e.field),a=(e.groupby||[]).map(yt),s=[],u=e.step||.01,l=e.probs||yi(u/2,1-GU,u),c=l.length;return o.forEach(f=>{const d=Tv(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<a.length;++p)g[a[p]]=f.dims[p];g[i[0]]=l[h],g[i[1]]=d[h],s.push(Ue(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function VT(e){R.call(this,null,e)}W(VT,R,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const o=ae(r);n.rem.push(i[o]),i[o]=null}),t.visit(t.ADD,r=>{const o=Sv(r);i[ae(r)]=o,n.add.push(o)}),t.visit(t.MOD,r=>{const o=i[ae(r)];for(const a in r)o[a]=r[a],n.modifies(a);n.mod.push(o)})),n}});function pb(e){R.call(this,[],e),this.count=0}pb.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};W(pb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value.reduce((c,f)=>(c[ae(f)]=1,c),{});let a=this.value,s=this.count,u=0;function l(c){let f,d;a.length<r?a.push(c):(d=~~((s+1)*Mi()),d<a.length&&d>=u&&(f=a[d],o[ae(f)]&&n.rem.push(f),a[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ae(c);o[f]&&(o[f]=-1,n.rem.push(c)),--s}),a=a.filter(c=>o[ae(c)]!==-1)),(t.rem.length||i)&&a.length<r&&t.source&&(u=s=a.length,t.visit(t.SOURCE,c=>{o[ae(c)]||l(c)}),u=-1),i&&a.length>r){const c=a.length-r;for(let f=0;f<c;++f)o[ae(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[ae(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!o[ae(c)])),this.count=s,this.value=n.source=a,n}});function mb(e){R.call(this,null,e)}mb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};W(mb,R,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=yi(e.start,e.stop,e.step||1).map(r=>{const o={};return o[i]=r,Ue(o)}),n.add=t.add.concat(this.value),n}});function YT(e){R.call(this,null,e),this.modified(!0)}W(YT,R,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function yb(e){R.call(this,null,e)}const XT=["unit0","unit1"];yb.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:rv,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:XT}]};W(yb,R,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",o=this._floor(e,t),a=(r?dl:fl)(o.unit).offset,s=e.as||XT,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(fn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,i&&(g[l]=null)):(g[u]=m=y=o(p),i&&(g[l]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(i?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:mC({extent:e.extent||Mr(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=av(i),a=this.value||{},s=(n?oC:rC)(o,r);return s.unit=Fe(o),s.units=o,s.step=r,s.start=a.start,s.stop=a.stop,this.value=s}});function KT(e){R.call(this,ol(),e)}W(KT,R,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,o=s=>r.set(i(s),s);let a=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,s=>r.delete(i(s))),t.visit(t.ADD,o)):a=!1,this.modified(a),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function JT(e){R.call(this,null,e)}W(JT,R,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Ns(e.sort)):t.source).map(e.field))}});function VU(e,t,n,i){const r=Rf[e](t,n);return{init:r.init||fa,update:function(o,a){a[i]=r.next(o)}}}const Rf={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Rf.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||L("ntile num must be greater than zero.");const n=Rf.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||L("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=YU(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function YU(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const XU=Object.keys(Rf);function QT(e){const t=J(e.ops),n=J(e.fields),i=J(e.params),r=J(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){J(fn(h)).forEach(g=>s[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=yt(p),y=ST(h,m,r[g]);if(d(p),o.push(y),re(Rf,h))a.push(VU(h,n[g],i[g],y));else{if(p==null&&h!=="count"&&L("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=p,c.push(v)),v.push(AT(h,y))}}),(l.length||c.length)&&(this.cell=KU(c,l,f)),this.inputs=Object.keys(s)}const ZT=QT.prototype;ZT.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};ZT.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,o=i&&i.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(r[a]);for(a=e.p1;a<e.i1;++a)n.add(r[a]);n.set(t)}for(a=0;a<o;++a)i[a].update(e,t)};function KU(e,t,n){e=e.map(u=>CT(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),a=0;a<r;++a)o[a]=new e[a](i);if(i.store)var s=i.data=new Vv;return i.add=function(u){if(i.num+=1,!n){s&&s.add(u);for(let l=0;l<r;++l)o[l].add(o[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){s&&s.rem(u);for(let l=0;l<r;++l)o[l].rem(o[l].get(u),u)}},i.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},i.init=function(){i.num=0,s&&s.reset();for(let u=0;u<r;++u)o[u].init()},i}function vb(e){R.call(this,{},e),this._mlen=0,this._mods=[]}vb.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:XU.concat(Nf)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};W(vb,R,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=Ns(e.sort),r=Hv(e.groupby),o=s=>this.group(r(s));let a=this.state;(!a||n)&&(a=this.state=new QT(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,s=>o(s).add(s))):(t.visit(t.REM,s=>o(s).remove(s)),t.visit(t.ADD,s=>o(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)JU(this._mods[s],a,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=TT(ae),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function JU(e,t,n,i){const r=i.sort,o=r&&!i.ignorePeers,a=i.frame||[null,0],s=e.data(n),u=s.length,l=o?uf(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:r||gn(-1)};t.init();for(let f=0;f<u;++f)QU(c,a,f,u),o&&ZU(c,l),t.update(c,s[f])}function QU(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function ZU(e,t){const n=e.i0,i=e.i1-1,r=e.compare,o=e.data,a=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<a&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}var eq=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Sa,bin:Yv,collect:Xv,compare:FT,countpattern:Kv,cross:Jv,density:Qv,dotbin:eb,expression:LT,extent:tb,facet:Ug,field:IT,filter:ib,flatten:rb,fold:ob,formula:ab,generate:PT,impute:sb,joinaggregate:ub,kde:lb,key:zT,load:BT,lookup:fb,multiextent:UT,multivalues:qT,params:WT,pivot:db,prefacet:HT,project:hb,proxy:GT,quantile:gb,relay:VT,sample:pb,sequence:mb,sieve:YT,subflow:nb,timeunit:yb,tupleindex:KT,values:JT,window:vb});const bb=Math.PI,xb=2*bb,js=1e-6,tq=xb-js;function wb(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function $s(){return new wb}wb.prototype=$s.prototype={constructor:wb,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-e,u=i-t,l=o-e,c=a-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>js)if(!(Math.abs(c*s-u*l)>js)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=i-a,g=s*s+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),v=r*Math.tan((bb-Math.acos((g+f-p)/(2*m*y)))/2),x=v/y,b=v/m;Math.abs(x-1)>js&&(this._+="L"+(e+x*l)+","+(t+x*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+b*s)+","+(this._y1=t+b*u)}},arc:function(e,t,n,i,r,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(i),s=n*Math.sin(i),u=e+a,l=t+s,c=1^o,f=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>js||Math.abs(this._y1-l)>js)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%xb+xb),f>tq?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>js&&(this._+="A"+n+","+n+",0,"+ +(f>=bb)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function We(e){return function(){return e}}var eF=Math.abs,yn=Math.atan2,Ls=Math.cos,nq=Math.max,_b=Math.min,jr=Math.sin,vl=Math.sqrt,vn=1e-12,bl=Math.PI,Wg=bl/2,tF=2*bl;function iq(e){return e>1?0:e<-1?bl:Math.acos(e)}function nF(e){return e>=1?Wg:e<=-1?-Wg:Math.asin(e)}function rq(e){return e.innerRadius}function oq(e){return e.outerRadius}function aq(e){return e.startAngle}function sq(e){return e.endAngle}function uq(e){return e&&e.padAngle}function lq(e,t,n,i,r,o,a,s){var u=n-e,l=i-t,c=a-r,f=s-o,d=f*u-c*l;if(!(d*d<vn))return d=(c*(t-o)-f*(e-r))/d,[e+d*u,t+d*l]}function Hg(e,t,n,i,r,o,a){var s=e-n,u=t-i,l=(a?o:-o)/vl(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,g=n+c,p=i+f,m=(d+g)/2,y=(h+p)/2,v=g-d,x=p-h,b=v*v+x*x,_=r-o,E=d*p-g*h,w=(x<0?-1:1)*vl(nq(0,_*_*b-E*E)),O=(E*x-v*w)/b,S=(-E*v-x*w)/b,k=(E*x+v*w)/b,A=(-E*v+x*w)/b,F=O-m,C=S-y,M=k-m,D=A-y;return F*F+C*C>M*M+D*D&&(O=k,S=A),{cx:O,cy:S,x01:-c,y01:-f,x11:O*(r/_-1),y11:S*(r/_-1)}}function cq(){var e=rq,t=oq,n=We(0),i=null,r=aq,o=sq,a=uq,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-Wg,g=o.apply(this,arguments)-Wg,p=eF(g-h),m=g>h;if(s||(s=l=$s()),d<f&&(c=d,d=f,f=c),!(d>vn))s.moveTo(0,0);else if(p>tF-vn)s.moveTo(d*Ls(h),d*jr(h)),s.arc(0,0,d,h,g,!m),f>vn&&(s.moveTo(f*Ls(g),f*jr(g)),s.arc(0,0,f,g,h,m));else{var y=h,v=g,x=h,b=g,_=p,E=p,w=a.apply(this,arguments)/2,O=w>vn&&(i?+i.apply(this,arguments):vl(f*f+d*d)),S=_b(eF(d-f)/2,+n.apply(this,arguments)),k=S,A=S,F,C;if(O>vn){var M=nF(O/f*jr(w)),D=nF(O/d*jr(w));(_-=M*2)>vn?(M*=m?1:-1,x+=M,b-=M):(_=0,x=b=(h+g)/2),(E-=D*2)>vn?(D*=m?1:-1,y+=D,v-=D):(E=0,y=v=(h+g)/2)}var N=d*Ls(y),I=d*jr(y),z=f*Ls(b),X=f*jr(b);if(S>vn){var te=d*Ls(v),xe=d*jr(v),ge=f*Ls(x),je=f*jr(x),Oe;if(p<bl&&(Oe=lq(N,I,ge,je,te,xe,z,X))){var ke=N-Oe[0],Xe=I-Oe[1],xt=te-Oe[0],Ge=xe-Oe[1],Y=1/jr(iq((ke*xt+Xe*Ge)/(vl(ke*ke+Xe*Xe)*vl(xt*xt+Ge*Ge)))/2),ne=vl(Oe[0]*Oe[0]+Oe[1]*Oe[1]);k=_b(S,(f-ne)/(Y-1)),A=_b(S,(d-ne)/(Y+1))}}E>vn?A>vn?(F=Hg(ge,je,N,I,d,A,m),C=Hg(te,xe,z,X,d,A,m),s.moveTo(F.cx+F.x01,F.cy+F.y01),A<S?s.arc(F.cx,F.cy,A,yn(F.y01,F.x01),yn(C.y01,C.x01),!m):(s.arc(F.cx,F.cy,A,yn(F.y01,F.x01),yn(F.y11,F.x11),!m),s.arc(0,0,d,yn(F.cy+F.y11,F.cx+F.x11),yn(C.cy+C.y11,C.cx+C.x11),!m),s.arc(C.cx,C.cy,A,yn(C.y11,C.x11),yn(C.y01,C.x01),!m))):(s.moveTo(N,I),s.arc(0,0,d,y,v,!m)):s.moveTo(N,I),!(f>vn)||!(_>vn)?s.lineTo(z,X):k>vn?(F=Hg(z,X,te,xe,f,-k,m),C=Hg(N,I,ge,je,f,-k,m),s.lineTo(F.cx+F.x01,F.cy+F.y01),k<S?s.arc(F.cx,F.cy,k,yn(F.y01,F.x01),yn(C.y01,C.x01),!m):(s.arc(F.cx,F.cy,k,yn(F.y01,F.x01),yn(F.y11,F.x11),!m),s.arc(0,0,f,yn(F.cy+F.y11,F.cx+F.x11),yn(C.cy+C.y11,C.cx+C.x11),m),s.arc(C.cx,C.cy,k,yn(C.y11,C.x11),yn(C.y01,C.x01),!m))):s.arc(0,0,f,b,x,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-bl/2;return[Ls(c)*l,jr(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:We(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:We(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:We(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:We(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:We(+l),u):r},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:We(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:We(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}function iF(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function rF(e){this._context=e}rF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Eb(e){return new rF(e)}function oF(e){return e[0]}function aF(e){return e[1]}function sF(e,t){var n=We(!0),i=null,r=Eb,o=null;e=typeof e=="function"?e:e===void 0?oF:We(e),t=typeof t=="function"?t:t===void 0?aF:We(t);function a(s){var u,l=(s=iF(s)).length,c,f=!1,d;for(i==null&&(o=r(d=$s())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,s),+t(c,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(e=typeof s=="function"?s:We(+s),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:We(+s),a):t},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:We(!!s),a):n},a.curve=function(s){return arguments.length?(r=s,i!=null&&(o=r(i)),a):r},a.context=function(s){return arguments.length?(s==null?i=o=null:o=r(i=s),a):i},a}function uF(e,t,n){var i=null,r=We(!0),o=null,a=Eb,s=null;e=typeof e=="function"?e:e===void 0?oF:We(+e),t=typeof t=="function"?t:We(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?aF:We(+n);function u(c){var f,d,h,g=(c=iF(c)).length,p,m=!1,y,v=new Array(g),x=new Array(g);for(o==null&&(s=a(y=$s())),f=0;f<=g;++f){if(!(f<g&&r(p=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(v[h],x[h]);s.lineEnd(),s.areaEnd()}m&&(v[f]=+e(p,f,c),x[f]=+t(p,f,c),s.point(i?+i(p,f,c):v[f],n?+n(p,f,c):x[f]))}if(y)return s=null,y+""||null}function l(){return sF().defined(r).curve(a).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:We(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:We(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:We(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:We(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:We(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:We(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:We(!!c),u):r},u.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),u):a},u.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),u):o},u}var fq={draw:function(e,t){var n=Math.sqrt(t/bl);e.moveTo(n,0),e.arc(0,0,n,0,tF)}};function dq(e,t){var n=null;e=typeof e=="function"?e:We(e||fq),t=typeof t=="function"?t:We(t===void 0?64:+t);function i(){var r;if(n||(n=r=$s()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:We(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:We(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function Aa(){}function Gg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Vg(e){this._context=e}Vg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hq(e){return new Vg(e)}function lF(e){this._context=e}lF.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gq(e){return new lF(e)}function cF(e){this._context=e}cF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Gg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pq(e){return new cF(e)}function fF(e,t){this._basis=new Vg(e),this._beta=t}fF.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],o=e[n]-i,a=t[n]-r,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(i+u*o),this._beta*t[s]+(1-this._beta)*(r+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var mq=function e(t){function n(i){return t===1?new Vg(i):new fF(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function Yg(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Ob(e,t){this._context=e,this._k=(1-t)/6}Ob.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Yg(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Yg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var yq=function e(t){function n(i){return new Ob(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Sb(e,t){this._context=e,this._k=(1-t)/6}Sb.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Yg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var vq=function e(t){function n(i){return new Sb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Ab(e,t){this._context=e,this._k=(1-t)/6}Ab.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Yg(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bq=function e(t){function n(i){return new Ab(i,t)}return n.tension=function(i){return e(+i)},n}(0);function kb(e,t,n){var i=e._x1,r=e._y1,o=e._x2,a=e._y2;if(e._l01_a>vn){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>vn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,o,a,e._x2,e._y2)}function dF(e,t){this._context=e,this._alpha=t}dF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:kb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var xq=function e(t){function n(i){return t?new dF(i,t):new Ob(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function hF(e,t){this._context=e,this._alpha=t}hF.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:kb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var wq=function e(t){function n(i){return t?new hF(i,t):new Sb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function gF(e,t){this._context=e,this._alpha=t}gF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:kb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _q=function e(t){function n(i){return t?new gF(i,t):new Ab(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function pF(e){this._context=e}pF.prototype={areaStart:Aa,areaEnd:Aa,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Eq(e){return new pF(e)}function mF(e){return e<0?-1:1}function yF(e,t,n){var i=e._x1-e._x0,r=t-e._x1,o=(e._y1-e._y0)/(i||r<0&&-0),a=(n-e._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(mF(o)+mF(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function vF(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Cb(e,t,n){var i=e._x0,r=e._y0,o=e._x1,a=e._y1,s=(o-i)/3;e._context.bezierCurveTo(i+s,r+s*t,o-s,a-s*n,o,a)}function Xg(e){this._context=e}Xg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Cb(this,this._t0,vF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Cb(this,vF(this,n=yF(this,e,t)),n);break;default:Cb(this,this._t0,n=yF(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function bF(e){this._context=new xF(e)}(bF.prototype=Object.create(Xg.prototype)).point=function(e,t){Xg.prototype.point.call(this,t,e)};function xF(e){this._context=e}xF.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}};function Oq(e){return new Xg(e)}function Sq(e){return new bF(e)}function wF(e){this._context=e}wF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=_F(e),r=_F(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function _F(e){var t,n=e.length-1,i,r=new Array(n),o=new Array(n),a=new Array(n);for(r[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/o[t-1],o[t]-=i,a[t]-=i*a[t-1];for(r[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)r[t]=(a[t]-r[t+1])/o[t];for(o[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}function Aq(e){return new wF(e)}function Kg(e,t){this._context=e,this._t=t}Kg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function kq(e){return new Kg(e,.5)}function Cq(e){return new Kg(e,0)}function Tq(e){return new Kg(e,1)}function xl(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const Fq=()=>typeof Image!="undefined"?Image:null;function $r(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ka(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Tb=Symbol("implicit");function Fb(){var e=new Map,t=[],n=[],i=Tb;function r(o){var a=o+"",s=e.get(a);if(!s){if(i!==Tb)return i;e.set(a,s=t.push(o))}return n[(s-1)%n.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of o){const s=a+"";e.has(s)||e.set(s,t.push(a))}return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Fb(t,n).unknown(i)},$r.apply(r,arguments),r}function wl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function jf(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Ca(){}var Is=.7,_l=1/Is,El="\\s*([+-]?\\d+)\\s*",$f="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dq=/^#([0-9a-f]{3,8})$/,Mq=new RegExp("^rgb\\("+[El,El,El]+"\\)$"),Nq=new RegExp("^rgb\\("+[Lr,Lr,Lr]+"\\)$"),Rq=new RegExp("^rgba\\("+[El,El,El,$f]+"\\)$"),jq=new RegExp("^rgba\\("+[Lr,Lr,Lr,$f]+"\\)$"),$q=new RegExp("^hsl\\("+[$f,Lr,Lr]+"\\)$"),Lq=new RegExp("^hsla\\("+[$f,Lr,Lr,$f]+"\\)$"),EF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wl(Ca,Lf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:OF,formatHex:OF,formatHsl:Iq,formatRgb:SF,toString:SF});function OF(){return this.rgb().formatHex()}function Iq(){return FF(this).formatHsl()}function SF(){return this.rgb().formatRgb()}function Lf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Dq.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?AF(t):n===3?new Zt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Jg(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Jg(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Mq.exec(e))?new Zt(t[1],t[2],t[3],1):(t=Nq.exec(e))?new Zt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Rq.exec(e))?Jg(t[1],t[2],t[3],t[4]):(t=jq.exec(e))?Jg(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$q.exec(e))?TF(t[1],t[2]/100,t[3]/100,1):(t=Lq.exec(e))?TF(t[1],t[2]/100,t[3]/100,t[4]):EF.hasOwnProperty(e)?AF(EF[e]):e==="transparent"?new Zt(NaN,NaN,NaN,0):null}function AF(e){return new Zt(e>>16&255,e>>8&255,e&255,1)}function Jg(e,t,n,i){return i<=0&&(e=t=n=NaN),new Zt(e,t,n,i)}function Db(e){return e instanceof Ca||(e=Lf(e)),e?(e=e.rgb(),new Zt(e.r,e.g,e.b,e.opacity)):new Zt}function Ta(e,t,n,i){return arguments.length===1?Db(e):new Zt(e,t,n,i==null?1:i)}function Zt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}wl(Zt,Ta,jf(Ca,{brighter:function(e){return e=e==null?_l:Math.pow(_l,e),new Zt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Is:Math.pow(Is,e),new Zt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kF,formatHex:kF,formatRgb:CF,toString:CF}));function kF(){return"#"+Mb(this.r)+Mb(this.g)+Mb(this.b)}function CF(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Mb(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function TF(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ir(e,t,n,i)}function FF(e){if(e instanceof Ir)return new Ir(e.h,e.s,e.l,e.opacity);if(e instanceof Ca||(e=Lf(e)),!e)return new Ir;if(e instanceof Ir)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Ir(a,s,u,e.opacity)}function Qg(e,t,n,i){return arguments.length===1?FF(e):new Ir(e,t,n,i==null?1:i)}function Ir(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}wl(Ir,Qg,jf(Ca,{brighter:function(e){return e=e==null?_l:Math.pow(_l,e),new Ir(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Is:Math.pow(Is,e),new Ir(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Zt(Nb(e>=240?e-240:e+120,r,i),Nb(e,r,i),Nb(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Nb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const DF=Math.PI/180,MF=180/Math.PI,Zg=18,NF=.96422,RF=1,jF=.82521,$F=4/29,Ol=6/29,LF=3*Ol*Ol,Pq=Ol*Ol*Ol;function IF(e){if(e instanceof Pr)return new Pr(e.l,e.a,e.b,e.opacity);if(e instanceof Fo)return PF(e);e instanceof Zt||(e=Db(e));var t=Lb(e.r),n=Lb(e.g),i=Lb(e.b),r=Rb((.2225045*t+.7168786*n+.0606169*i)/RF),o,a;return t===n&&n===i?o=a=r:(o=Rb((.4360747*t+.3850649*n+.1430804*i)/NF),a=Rb((.0139322*t+.0971045*n+.7141733*i)/jF)),new Pr(116*r-16,500*(o-r),200*(r-a),e.opacity)}function ep(e,t,n,i){return arguments.length===1?IF(e):new Pr(e,t,n,i==null?1:i)}function Pr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}wl(Pr,ep,jf(Ca,{brighter:function(e){return new Pr(this.l+Zg*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Pr(this.l-Zg*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=NF*jb(t),e=RF*jb(e),n=jF*jb(n),new Zt($b(3.1338561*t-1.6168667*e-.4906146*n),$b(-.9787684*t+1.9161415*e+.033454*n),$b(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Rb(e){return e>Pq?Math.pow(e,1/3):e/LF+$F}function jb(e){return e>Ol?e*e*e:LF*(e-$F)}function $b(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Lb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function zq(e){if(e instanceof Fo)return new Fo(e.h,e.c,e.l,e.opacity);if(e instanceof Pr||(e=IF(e)),e.a===0&&e.b===0)return new Fo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*MF;return new Fo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function tp(e,t,n,i){return arguments.length===1?zq(e):new Fo(e,t,n,i==null?1:i)}function Fo(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function PF(e){if(isNaN(e.h))return new Pr(e.l,0,0,e.opacity);var t=e.h*DF;return new Pr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}wl(Fo,tp,jf(Ca,{brighter:function(e){return new Fo(this.h,this.c,this.l+Zg*(e==null?1:e),this.opacity)},darker:function(e){return new Fo(this.h,this.c,this.l-Zg*(e==null?1:e),this.opacity)},rgb:function(){return PF(this).rgb()}}));var zF=-.14861,Ib=1.78277,Pb=-.29227,np=-.90649,If=1.97294,BF=If*np,UF=If*Ib,qF=Ib*Pb-np*zF;function Bq(e){if(e instanceof Ps)return new Ps(e.h,e.s,e.l,e.opacity);e instanceof Zt||(e=Db(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(qF*i+BF*t-UF*n)/(qF+BF-UF),o=i-r,a=(If*(n-r)-Pb*o)/np,s=Math.sqrt(a*a+o*o)/(If*r*(1-r)),u=s?Math.atan2(a,o)*MF-120:NaN;return new Ps(u<0?u+360:u,s,r,e.opacity)}function zb(e,t,n,i){return arguments.length===1?Bq(e):new Ps(e,t,n,i==null?1:i)}function Ps(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}wl(Ps,zb,jf(Ca,{brighter:function(e){return e=e==null?_l:Math.pow(_l,e),new Ps(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Is:Math.pow(Is,e),new Ps(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*DF,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Zt(255*(t+n*(zF*i+Ib*r)),255*(t+n*(Pb*i+np*r)),255*(t+n*(If*i)),this.opacity)}}));function WF(e,t,n,i,r){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*i+a*r)/6}function HF(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],a=i>0?e[i-1]:2*r-o,s=i<t-1?e[i+2]:2*o-r;return WF((n-i/t)*t,a,r,o,s)}}function GF(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],a=e[(i+1)%t],s=e[(i+2)%t];return WF((n-i/t)*t,r,o,a,s)}}var ip=e=>()=>e;function VF(e,t){return function(n){return e+n*t}}function Uq(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function rp(e,t){var n=t-e;return n?VF(e,n>180||n<-180?n-360*Math.round(n/360):n):ip(isNaN(e)?t:e)}function qq(e){return(e=+e)==1?zt:function(t,n){return n-t?Uq(t,n,e):ip(isNaN(t)?n:t)}}function zt(e,t){var n=t-e;return n?VF(e,n):ip(isNaN(e)?t:e)}var Bb=function e(t){var n=qq(t);function i(r,o){var a=n((r=Ta(r)).r,(o=Ta(o)).r),s=n(r.g,o.g),u=n(r.b,o.b),l=zt(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function YF(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Ta(t[a]),i[a]=s.r||0,r[a]=s.g||0,o[a]=s.b||0;return i=e(i),r=e(r),o=e(o),s.opacity=1,function(u){return s.r=i(u),s.g=r(u),s.b=o(u),s+""}}}var Wq=YF(HF),Hq=YF(GF);function Ub(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function XF(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Gq(e,t){return(XF(t)?Ub:KF)(e,t)}function KF(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)r[a]=Fa(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function JF(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function nr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function QF(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Fa(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var qb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wb=new RegExp(qb.source,"g");function Vq(e){return function(){return e}}function Yq(e){return function(t){return e(t)+""}}function ZF(e,t){var n=qb.lastIndex=Wb.lastIndex=0,i,r,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(i=qb.exec(e))&&(r=Wb.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:nr(i,r)})),n=Wb.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?Yq(u[0].x):Vq(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function Fa(e,t){var n=typeof t,i;return t==null||n==="boolean"?ip(t):(n==="number"?nr:n==="string"?(i=Lf(t))?(t=i,Bb):ZF:t instanceof Lf?Bb:t instanceof Date?JF:XF(t)?Ub:Array.isArray(t)?KF:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?QF:nr)(e,t)}function Xq(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Kq(e,t){var n=rp(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function Pf(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var eD=180/Math.PI,Hb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tD(e,t,n,i,r,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,u/=s),e*i<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*eD,skewX:Math.atan(u)*eD,scaleX:a,scaleY:s}}var op;function Jq(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Hb:tD(t.a,t.b,t.c,t.d,t.e,t.f)}function Qq(e){return e==null||(op||(op=document.createElementNS("http://www.w3.org/2000/svg","g")),op.setAttribute("transform",e),!(e=op.transform.baseVal.consolidate()))?Hb:(e=e.matrix,tD(e.a,e.b,e.c,e.d,e.e,e.f))}function nD(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:nr(l,f)},{i:p-2,x:nr(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:nr(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function s(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:nr(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(r(h)+"scale(",null,",",null,")");g.push({i:p-4,x:nr(l,f)},{i:p-2,x:nr(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var Zq=nD(Jq,"px, ","px)","deg)"),eW=nD(Qq,", ",")",")"),tW=1e-12;function iD(e){return((e=Math.exp(e))+1/e)/2}function nW(e){return((e=Math.exp(e))-1/e)/2}function iW(e){return((e=Math.exp(2*e))-1)/(e+1)}var rW=function e(t,n,i){function r(o,a){var s=o[0],u=o[1],l=o[2],c=a[0],f=a[1],d=a[2],h=c-s,g=f-u,p=h*h+g*g,m,y;if(p<tW)y=Math.log(d/l)/t,m=function(w){return[s+w*h,u+w*g,l*Math.exp(t*w*y)]};else{var v=Math.sqrt(p),x=(d*d-l*l+i*p)/(2*l*n*v),b=(d*d-l*l-i*p)/(2*d*n*v),_=Math.log(Math.sqrt(x*x+1)-x),E=Math.log(Math.sqrt(b*b+1)-b);y=(E-_)/t,m=function(w){var O=w*y,S=iD(_),k=l/(n*v)*(S*iW(t*O+_)-nW(_));return[s+k*h,u+k*g,l*S/iD(t*O+_)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return e(a,s,u)},r}(Math.SQRT2,2,4);function rD(e){return function(t,n){var i=e((t=Qg(t)).h,(n=Qg(n)).h),r=zt(t.s,n.s),o=zt(t.l,n.l),a=zt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.s=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var oW=rD(rp),aW=rD(zt);function sW(e,t){var n=zt((e=ep(e)).l,(t=ep(t)).l),i=zt(e.a,t.a),r=zt(e.b,t.b),o=zt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=i(a),e.b=r(a),e.opacity=o(a),e+""}}function oD(e){return function(t,n){var i=e((t=tp(t)).h,(n=tp(n)).h),r=zt(t.c,n.c),o=zt(t.l,n.l),a=zt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.c=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var uW=oD(rp),lW=oD(zt);function aD(e){return function t(n){n=+n;function i(r,o){var a=e((r=zb(r)).h,(o=zb(o)).h),s=zt(r.s,o.s),u=zt(r.l,o.l),l=zt(r.opacity,o.opacity);return function(c){return r.h=a(c),r.s=s(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var cW=aD(rp),fW=aD(zt);function Gb(e,t){t===void 0&&(t=e,e=Fa);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(a){var s=Math.max(0,Math.min(i-1,Math.floor(a*=i)));return o[s](a-s)}}function dW(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var hW=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Fa,interpolateArray:Gq,interpolateBasis:HF,interpolateBasisClosed:GF,interpolateDate:JF,interpolateDiscrete:Xq,interpolateHue:Kq,interpolateNumber:nr,interpolateNumberArray:Ub,interpolateObject:QF,interpolateRound:Pf,interpolateString:ZF,interpolateTransformCss:Zq,interpolateTransformSvg:eW,interpolateZoom:rW,interpolateRgb:Bb,interpolateRgbBasis:Wq,interpolateRgbBasisClosed:Hq,interpolateHsl:oW,interpolateHslLong:aW,interpolateLab:sW,interpolateHcl:uW,interpolateHclLong:lW,interpolateCubehelix:cW,interpolateCubehelixLong:fW,piecewise:Gb,quantize:dW});function gW(e){return function(){return e}}function Vb(e){return+e}var sD=[0,1];function Kn(e){return e}function Yb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:gW(isNaN(t)?NaN:.5)}function pW(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function mW(e,t,n){var i=e[0],r=e[1],o=t[0],a=t[1];return r<i?(i=Yb(r,i),o=n(a,o)):(i=Yb(i,r),o=n(o,a)),function(s){return o(i(s))}}function yW(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=Yb(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=lf(e,s,1,i)-1;return o[u](r[u](s))}}function zf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ap(){var e=sD,t=sD,n=Fa,i,r,o,a=Kn,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==Kn&&(a=pW(e[0],e[d-1])),s=d>2?yW:mW,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(i),t,n)))(i(a(d)))}return f.invert=function(d){return a(r((l||(l=s(t,e.map(i),nr)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,Vb),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Pf,c()},f.clamp=function(d){return arguments.length?(a=d?!0:Kn,c()):a!==Kn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return i=d,r=h,c()}}function uD(){return ap()(Kn,Kn)}function lD(e,t,n,i){var r=ma(e,t,n),o;switch(i=ll(i==null?",f":i),i.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(o=Wk(r,a))&&(i.precision=o),Hy(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=Hk(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=qk(r))&&(i.precision=o-(i.type==="%")*2);break}}return xg(i)}function zs(e){var t=e.domain;return e.ticks=function(n){var i=t();return By(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return lD(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,o=i.length-1,a=i[r],s=i[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=r,r=o,o=l);c-- >0;){if(l=Fk(a,s,n),l===u)return i[r]=a,i[o]=s,t(i);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function cD(){var e=uD();return e.copy=function(){return zf(e,cD())},$r.apply(e,arguments),zs(e)}function fD(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,Vb),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return fD(e).unknown(t)},e=arguments.length?Array.from(e,Vb):[0,1],zs(n)}function dD(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],o=e[i],a;return o<r&&(a=n,n=i,i=a,a=r,r=o,o=a),e[n]=t.floor(r),e[i]=t.ceil(o),e}function hD(e){return Math.log(e)}function gD(e){return Math.exp(e)}function vW(e){return-Math.log(-e)}function bW(e){return-Math.exp(-e)}function xW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function wW(e){return e===10?xW:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function _W(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function pD(e){return function(t){return-e(-t)}}function Xb(e){var t=e(hD,gD),n=t.domain,i=10,r,o;function a(){return r=_W(i),o=wW(i),n()[0]<0?(r=pD(r),o=pD(o),e(vW,bW)):e(hD,gD),t}return t.base=function(s){return arguments.length?(i=+s,a()):i},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=r(l),h=r(c),g,p,m,y=s==null?10:+s,v=[];if(!(i%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=o(d);p<i;++p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(p=i-1,g=o(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=By(l,c,y))}else v=By(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(s,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=xg(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,i*s/t.ticks().length);return function(c){var f=c/o(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(dD(n(),{floor:function(s){return o(Math.floor(r(s)))},ceil:function(s){return o(Math.ceil(r(s)))}}))},t}function mD(){var e=Xb(ap()).domain([1,10]);return e.copy=function(){return zf(e,mD()).base(e.base())},$r.apply(e,arguments),e}function yD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function vD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Kb(e){var t=1,n=e(yD(t),vD(t));return n.constant=function(i){return arguments.length?e(yD(t=+i),vD(t)):t},zs(n)}function bD(){var e=Kb(ap());return e.copy=function(){return zf(e,bD()).constant(e.constant())},$r.apply(e,arguments)}function xD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function EW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function OW(e){return e<0?-e*e:e*e}function Jb(e){var t=e(Kn,Kn),n=1;function i(){return n===1?e(Kn,Kn):n===.5?e(EW,OW):e(xD(n),xD(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},zs(t)}function Qb(){var e=Jb(ap());return e.copy=function(){return zf(e,Qb()).exponent(e.exponent())},$r.apply(e,arguments),e}function SW(){return Qb.apply(null,arguments).exponent(.5)}function wD(){var e=[],t=[],n=[],i;function r(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=Mk(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?i:t[lf(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(sl),r()},o.range=function(a){return arguments.length?(t=Array.from(a),r()):t.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.quantiles=function(){return n.slice()},o.copy=function(){return wD().domain(e).range(t).unknown(i)},$r.apply(o,arguments)}function _D(){var e=0,t=1,n=1,i=[.5],r=[0,1],o;function a(u){return u!=null&&u<=u?r[lf(i,u,0,n)]:o}function s(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},a.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,s()):r.slice()},a.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},a.unknown=function(u){return arguments.length&&(o=u),a},a.thresholds=function(){return i.slice()},a.copy=function(){return _D().domain([e,t]).range(r).unknown(o)},$r.apply(zs(a),arguments)}function ED(){var e=[.5],t=[0,1],n,i=1;function r(o){return o!=null&&o<=o?t[lf(e,o,0,i)]:n}return r.domain=function(o){return arguments.length?(e=Array.from(o),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(o){return arguments.length?(t=Array.from(o),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return ED().domain(e).range(t).unknown(n)},$r.apply(r,arguments)}function AW(e){return new Date(e)}function kW(e){return e instanceof Date?+e:+new Date(+e)}function Zb(e,t,n,i,r,o,a,s,u,l){var c=uD(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function _(E){return(u(E)<E?h:s(E)<E?g:a(E)<E?p:o(E)<E?m:i(E)<E?r(E)<E?y:v:n(E)<E?x:b)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,kW)):d().map(AW)},c.ticks=function(E){var w=d();return e(w[0],w[w.length-1],E==null?10:E)},c.tickFormat=function(E,w){return w==null?_:l(w)},c.nice=function(E){var w=d();return(!E||typeof E.range!="function")&&(E=t(w[0],w[w.length-1],E==null?10:E)),E?d(dD(w,E)):c},c.copy=function(){return zf(c,Zb(e,t,n,i,r,o,a,s,u,l))},c}function CW(){return $r.apply(Zb(L9,I9,ba,wg,ff,va,Zy,Qy,ya,pv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function TW(){return $r.apply(Zb(j9,$9,wa,_g,hf,xa,nv,tv,ya,mv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function sp(){var e=0,t=1,n,i,r,o,a=Kn,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(r===0?.5:(f=(o(f)-n)*r,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),i=o(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,a=f(h,g),l):[a(0),a(1)]}}return l.range=c(Fa),l.rangeRound=c(Pf),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function Da(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ex(){var e=zs(sp()(Kn));return e.copy=function(){return Da(e,ex())},ka.apply(e,arguments)}function OD(){var e=Xb(sp()).domain([1,10]);return e.copy=function(){return Da(e,OD()).base(e.base())},ka.apply(e,arguments)}function SD(){var e=Kb(sp());return e.copy=function(){return Da(e,SD()).constant(e.constant())},ka.apply(e,arguments)}function tx(){var e=Jb(sp());return e.copy=function(){return Da(e,tx()).exponent(e.exponent())},ka.apply(e,arguments)}function FW(){return tx.apply(null,arguments).exponent(.5)}function up(){var e=0,t=.5,n=1,i=1,r,o,a,s,u,l=Kn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-o)*(i*p<i*o?s:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,r=c(e=+e),o=c(t=+t),a=c(n=+n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,v,x;return arguments.length?([y,v,x]=m,l=Gb(p,[y,v,x]),h):[l(0),l(.5),l(1)]}}return h.range=g(Fa),h.rangeRound=g(Pf),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,r=p(e),o=p(t),a=p(n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h}}function AD(){var e=zs(up()(Kn));return e.copy=function(){return Da(e,AD())},ka.apply(e,arguments)}function kD(){var e=Xb(up()).domain([.1,1,10]);return e.copy=function(){return Da(e,kD()).base(e.base())},ka.apply(e,arguments)}function CD(){var e=Kb(up());return e.copy=function(){return Da(e,CD()).constant(e.constant())},ka.apply(e,arguments)}function nx(){var e=Jb(up());return e.copy=function(){return Da(e,nx()).exponent(e.exponent())},ka.apply(e,arguments)}function DW(){return nx.apply(null,arguments).exponent(.5)}function ix(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const MW="identity",Sl="linear",Do="log",Bf="pow",Uf="sqrt",lp="symlog",Bs="time",Us="utc",zr="sequential",Al="diverging",kl="quantile",cp="quantize",fp="threshold",rx="ordinal",ox="point",TD="band",ax="bin-ordinal",Mt="continuous",qf="discrete",Wf="discretizing",Ni="interpolating",sx="temporal";function NW(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function RW(e){return function(t){const n=e.range();let i=t[0],r=t[1],o=-1,a,s,u,l;for(r<i&&(s=i,i=r,r=s),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(o<0&&(o=u),a=u);if(!(o<0))return i=e.invertExtent(n[o]),r=e.invertExtent(n[a]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function ux(){const e=Fb().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,o,a=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],g=ix(f,s,u);let p=i[d-0];r=(h-p)/(g||1),a&&(r=Math.floor(r)),p+=(h-p-r*(f-s))*l,o=r*(1-s),a&&(p=Math.round(p),o=Math.round(o));const m=yi(f).map(y=>p+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return o},e.step=function(){return r},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,v,x;if(!(p!==p||m!==m)&&(m<p&&(x=p,p=m,m=x),!(m<h[0]||p>i[1-d])))return y=Math.max(0,yg(h,p)-1),v=p===m?y:yg(h,m)-1,p-h[y]>o+1e-10&&++y,d&&(x=y,y=g-v,v=g-x),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return ux().domain(t()).range(i).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function FD(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return FD(t())},e}function jW(){return FD(ux().paddingInner(1))}var $W=Array.prototype.map;function LW(e){return $W.call(e,hn)}const IW=Array.prototype.slice;function DD(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(lf(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=LW(i),n):e.slice()},n.range=function(i){return arguments.length?(t=IW.call(i),n):t.slice()},n.tickFormat=function(i,r){return lD(e[0],Fe(e),i==null?10:i,r)},n.copy=function(){return DD().domain(n.domain()).range(n.range())},n}const dp={};function PW(e,t,n){const i=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?NW(o):o.invertExtent?RW(o):void 0),o.type=e,o};return i.metadata=er(J(n)),i}function Ie(e,t,n){return arguments.length>1?(dp[e]=PW(e,t,n),this):MD(e)?dp[e]:void 0}Ie(MW,fD);Ie(Sl,cD,Mt);Ie(Do,mD,[Mt,Do]);Ie(Bf,Qb,Mt);Ie(Uf,SW,Mt);Ie(lp,bD,Mt);Ie(Bs,CW,[Mt,sx]);Ie(Us,TW,[Mt,sx]);Ie(zr,ex,[Mt,Ni]);Ie("".concat(zr,"-").concat(Sl),ex,[Mt,Ni]);Ie("".concat(zr,"-").concat(Do),OD,[Mt,Ni,Do]);Ie("".concat(zr,"-").concat(Bf),tx,[Mt,Ni]);Ie("".concat(zr,"-").concat(Uf),FW,[Mt,Ni]);Ie("".concat(zr,"-").concat(lp),SD,[Mt,Ni]);Ie("".concat(Al,"-").concat(Sl),AD,[Mt,Ni]);Ie("".concat(Al,"-").concat(Do),kD,[Mt,Ni,Do]);Ie("".concat(Al,"-").concat(Bf),nx,[Mt,Ni]);Ie("".concat(Al,"-").concat(Uf),DW,[Mt,Ni]);Ie("".concat(Al,"-").concat(lp),CD,[Mt,Ni]);Ie(kl,wD,[Wf,kl]);Ie(cp,_D,Wf);Ie(fp,ED,Wf);Ie(ax,DD,[qf,Wf]);Ie(rx,Fb,qf);Ie(TD,ux,qf);Ie(ox,jW,qf);function MD(e){return re(dp,e)}function qs(e,t){const n=dp[e];return n&&n.metadata[t]}function lx(e){return qs(e,Mt)}function Cl(e){return qs(e,qf)}function cx(e){return qs(e,Wf)}function ND(e){return qs(e,Do)}function zW(e){return qs(e,sx)}function RD(e){return qs(e,Ni)}function jD(e){return qs(e,kl)}const BW=["clamp","base","constant","exponent"];function $D(e,t){const n=t[0],i=Fe(t)-n;return function(r){return e(n+r*i)}}function hp(e,t,n){return Gb(fx(t||"rgb",n),e)}function LD(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function ID(e,t,n){const i=n-t;let r,o,a;return!i||!Number.isFinite(i)?gn(.5):(r=(o=e.type).indexOf("-"),o=r<0?o:o.slice(r+1),a=Ie(o)().domain([t,n]).range([0,1]),BW.forEach(s=>e[s]?a[s](e[s]()):0),a)}function fx(e,t){const n=hW[UW(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function UW(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const qW={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},WW={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function PD(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function zD(e,t){for(const n in e)dx(n,t(e[n]))}const BD={};zD(WW,PD);zD(qW,e=>hp(PD(e)));function dx(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(BD[e]=t,this):BD[e]}const gp="symbol",HW="discrete",GW="gradient",VW=e=>P(e)?e.map(t=>String(t)):String(e),YW=(e,t)=>e[1]-t[1],XW=(e,t)=>t[1]-e[1];function hx(e,t,n){let i;return Je(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(af(e.domain())/n||1)))),Q(t)&&(i=t.step,t=t.interval),K(t)&&(t=e.type===Bs?fl(t):e.type==Us?dl(t):L("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function UD(e,t,n){let i=e.range(),r=i[0],o=Fe(i),a=YW;if(r>o&&(i=o,o=r,r=i,a=XW),r=Math.floor(r),o=Math.ceil(o),t=t.map(s=>[s,e(s)]).filter(s=>r<=s[1]&&s[1]<=o).sort(a).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],Fe(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function gx(e,t){return e.bins?UD(e,e.bins):e.ticks?e.ticks(t):e.domain()}function qD(e,t,n,i,r,o){const a=t.type;let s=VW;if(a===Bs||r===Bs)s=e.timeFormat(i);else if(a===Us||r===Us)s=e.utcFormat(i);else if(ND(a)){const u=e.formatFloat(i);if(o||t.bins)s=u;else{const l=WD(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(s=e.format(i));return s}function WD(e,t,n){const i=gx(e,t),r=e.base(),o=Math.log(r),a=Math.max(1,r*t/i.length),s=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/o));return l*r<r-.5&&(l*=r),l<=a};return n?i.filter(s):s}const px={[kl]:"quantiles",[cp]:"thresholds",[fp]:"domain"},HD={[kl]:"quantiles",[cp]:"domain"};function GD(e,t){return e.bins?QW(e.bins):e.type===Do?WD(e,t,!0):px[e.type]?JW(e[px[e.type]]()):gx(e,t)}function KW(e,t,n){const i=t[HD[t.type]](),r=i.length;let o=r>1?i[1]-i[0]:i[0],a;for(a=1;a<r;++a)o=Math.min(o,i[a]-i[a-1]);return e.formatSpan(0,o,3*10,n)}function JW(e){const t=[-1/0].concat(e);return t.max=1/0,t}function QW(e){const t=e.slice(0,-1);return t.max=Fe(e),t}const ZW=e=>px[e.type]||e.bins;function VD(e,t,n,i,r,o,a){const s=HD[t.type]&&o!==Bs&&o!==Us?KW(e,t,r):qD(e,t,n,r,o,a);return i===gp&&ZW(t)?eH(s):i===HW?tH(s):nH(s)}const eH=e=>(t,n,i)=>{const r=YD(i[n+1],YD(i.max,1/0)),o=XD(t,e),a=XD(r,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},YD=(e,t)=>e!=null?e:t,tH=e=>(t,n)=>n?e(t):null,nH=e=>t=>e(t),XD=(e,t)=>Number.isFinite(e)?t(e):null;function iH(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Fe(t),o=r-i;if(e.type===fp){const a=n?o/n:.1;i-=a,r+=a,o=r-i}return a=>(a-i)/o}function rH(e,t,n,i){const r=i||t.type;return K(n)&&zW(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Bs?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===Us?e.utcFormat("%A, %d %B %Y, %X UTC"):VD(e,t,5,null,n,i,!0)}function KD(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=rH(e,t,n.format,n.formatType);if(cx(t.type)){const o=GD(t).slice(1).map(r),a=o.length;return"".concat(a," boundar").concat(a===1?"y":"ies",": ").concat(o.join(", "))}else if(Cl(t.type)){const o=t.domain(),a=o.length,s=a>i?o.slice(0,i-2).map(r).join(", ")+", ending with "+o.slice(-1).map(r):o.map(r).join(", ");return"".concat(a," value").concat(a===1?"":"s",": ").concat(s)}else{const o=t.domain();return"values from ".concat(r(o[0])," to ").concat(r(Fe(o)))}}let JD=0;function oH(){JD=0}const pp="p_";function mx(e){return e&&e.gradient}function QD(e,t,n){const i=e.gradient;let r=e.id,o=i==="radial"?pp:"";return r||(r=e.id="gradient_"+JD++,i==="radial"?(e.x1=Br(e.x1,.5),e.y1=Br(e.y1,.5),e.r1=Br(e.r1,0),e.x2=Br(e.x2,.5),e.y2=Br(e.y2,.5),e.r2=Br(e.r2,.5),o=pp):(e.x1=Br(e.x1,0),e.y1=Br(e.y1,0),e.x2=Br(e.x2,1),e.y2=Br(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+o+r+")"}function Br(e,t){return e!=null?e:t}function ZD(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,o){return n.push({offset:r,color:o}),i}}}const eM={basis:{curve:hq},"basis-closed":{curve:gq},"basis-open":{curve:pq},bundle:{curve:mq,tension:"beta",value:.85},cardinal:{curve:yq,tension:"tension",value:0},"cardinal-open":{curve:bq,tension:"tension",value:0},"cardinal-closed":{curve:vq,tension:"tension",value:0},"catmull-rom":{curve:xq,tension:"alpha",value:.5},"catmull-rom-closed":{curve:wq,tension:"alpha",value:.5},"catmull-rom-open":{curve:_q,tension:"alpha",value:.5},linear:{curve:Eb},"linear-closed":{curve:Eq},monotone:{horizontal:Sq,vertical:Oq},natural:{curve:Aq},step:{curve:kq},"step-after":{curve:Tq},"step-before":{curve:Cq}};function yx(e,t,n){var i=re(eM,e)&&eM[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const aH={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Hf=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Tl(e){const t=[];let n,i,r,o,a,s,u,l,c,f;const d=e.slice().replace(Hf[0],"###$1").split(Hf[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],i=n.slice(1).trim().replace(Hf[2],"$1###$2").replace(Hf[3],"$1###$2").split(Hf[4]),a=n.charAt(0),r=[a],l=0,f=i.length;l<f;++l)(o=+i[l])===o&&r.push(o);if(s=aH[a.toLowerCase()],r.length-1>s){const h=r.length;for(l=1,t.push([a].concat(r.slice(l,l+=s))),a=a==="M"?"L":a==="m"?"l":a;l<h;l+=s)t.push([a].concat(r.slice(l,l+s)))}else t.push(r)}return t}const Ma=Math.PI/180,sH=1e-14,Ws=Math.PI/2,Ur=Math.PI*2,Fl=Math.sqrt(3)/2;var vx={},bx={},tM=[].join;function uH(e,t,n,i,r,o,a,s,u){const l=tM.call(arguments);if(vx[l])return vx[l];const c=a*Ma,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(s-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(s-e)*.5;let p=h*h/(n*n)+g*g/(i*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const m=d/n,y=f/n,v=-f/i,x=d/i,b=m*s+y*u,_=v*s+x*u,E=m*e+y*t,w=v*e+x*t,O=(E-b)*(E-b)+(w-_)*(w-_);let S=1/O-.25;S<0&&(S=0);let k=Math.sqrt(S);o==r&&(k=-k);const A=.5*(b+E)-k*(w-_),F=.5*(_+w)+k*(E-b),C=Math.atan2(_-F,b-A);let D=Math.atan2(w-F,E-A)-C;D<0&&o===1?D+=Ur:D>0&&o===0&&(D-=Ur);const N=Math.ceil(Math.abs(D/(Ws+.001))),I=[];for(let z=0;z<N;++z){const X=C+z*D/N,te=C+(z+1)*D/N;I[z]=[A,F,X,te,n,i,f,d]}return vx[l]=I}function lH(e){const t=tM.call(e);if(bx[t])return bx[t];var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,g=Math.cos(r),p=Math.sin(r),m=Math.cos(o),y=Math.sin(o),v=.5*(o-r),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),_=n+g-b*p,E=i+p+b*g,w=n+m,O=i+y,S=w+b*y,k=O-b*m;return bx[t]=[c*_+f*E,d*_+h*E,c*S+f*k,d*S+h*k,c*w+f*O,d*w+h*O]}const Ri=["l",0,0,0,0,0,0,0];function cH(e,t,n){const i=Ri[0]=e[0];if(i==="a"||i==="A")Ri[1]=t*e[1],Ri[2]=n*e[2],Ri[3]=e[3],Ri[4]=e[4],Ri[5]=e[5],Ri[6]=t*e[6],Ri[7]=n*e[7];else if(i==="h"||i==="H")Ri[1]=t*e[1];else if(i==="v"||i==="V")Ri[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)Ri[r]=(r%2==1?t:n)*e[r];return Ri}function Gf(e,t,n,i,r,o){var a,s=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),o==null&&(o=r),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],(r!==1||o!==1)&&(a=cH(a,r,o)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+i);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+i);break;case"h":u+=a[1],e.lineTo(u+n,l+i);break;case"H":u=a[1],e.lineTo(u+n,l+i);break;case"v":l+=a[1],e.lineTo(u+n,l+i);break;case"V":l=a[1],e.lineTo(u+n,l+i);break;case"m":u+=a[1],l+=a[2],e.moveTo(u+n,l+i);break;case"M":u=a[1],l=a[2],e.moveTo(u+n,l+i);break;case"c":d=u+a[5],h=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+a[3],h=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+a[1]+n,l+a[2]+i,d+n,h+i),c=u+a[1],f=l+a[2],u=d,l=h;break;case"S":d=a[3],h=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"q":d=u+a[3],h=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"t":d=u+a[1],h=l+a[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-g,f=2*l-p):s[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+a[1],f=l+a[2];break;case"T":d=a[1],h=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":nM(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+i]),u+=a[6],l+=a[7];break;case"A":nM(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+i]),u=a[6],l=a[7];break;case"z":case"Z":e.closePath();break}s=a}}function nM(e,t,n,i){const r=uH(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let o=0;o<r.length;++o){const a=lH(r[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const iM=.5773502691896257,rM={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Ur)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n,r=i-n*iM,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n,r=i-n*iM;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Fl*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function oM(e){return re(rM,e)?rM[e]:fH(e)}var xx={};function fH(e){if(!re(xx,e)){const t=Tl(e);xx[e]={draw:function(n,i){Gf(n,t,0,0,Math.sqrt(i)/2)}}}return xx[e]}const Na=.448084975506;function dH(e){return e.x}function hH(e){return e.y}function gH(e){return e.width}function pH(e){return e.height}function Mo(e){return typeof e=="function"?e:()=>+e}function mp(e,t,n){return Math.max(t,Math.min(e,n))}function aM(){var e=dH,t=hH,n=gH,i=pH,r=Mo(0),o=r,a=r,s=r,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,x=mp(+r.call(this,c),0,v),b=mp(+o.call(this,c),0,v),_=mp(+a.call(this,c),0,v),E=mp(+s.call(this,c),0,v);if(u||(u=h=$s()),x<=0&&b<=0&&_<=0&&E<=0)u.rect(g,p,m,y);else{var w=g+m,O=p+y;u.moveTo(g+x,p),u.lineTo(w-b,p),u.bezierCurveTo(w-Na*b,p,w,p+Na*b,w,p+b),u.lineTo(w,O-E),u.bezierCurveTo(w,O-Na*E,w-Na*E,O,w-E,O),u.lineTo(g+_,O),u.bezierCurveTo(g+Na*_,O,g,O-Na*_,g,O-_),u.lineTo(g,p+x),u.bezierCurveTo(g,p+Na*x,g+Na*x,p,g+x,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Mo(c),l):e},l.y=function(c){return arguments.length?(t=Mo(c),l):t},l.width=function(c){return arguments.length?(n=Mo(c),l):n},l.height=function(c){return arguments.length?(i=Mo(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=Mo(c),o=f!=null?Mo(f):r,s=d!=null?Mo(d):r,a=h!=null?Mo(h):o,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function sM(){var e,t,n,i,r=null,o,a,s,u;function l(f,d,h){const g=h/2;if(o){var p=s-d,m=f-a;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*u,x=(m/=y)*u,b=Math.atan2(m,p);r.moveTo(a-v,s-x),r.lineTo(f-p*g,d-m*g),r.arc(f,d,g,b-Math.PI,b),r.lineTo(a+v,s+x),r.arc(a,s,u,b,b+Math.PI)}else r.arc(f,d,g,0,Ur);r.closePath()}else o=1;a=f,s=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(r==null&&(r=m=$s()),d=0;d<=h;++d)!(d<h&&i(g=f[d],d,f))===p&&(p=!p)&&(o=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function Vf(e,t){return e!=null?e:t}const Yf=e=>e.x||0,Xf=e=>e.y||0,mH=e=>e.width||0,yH=e=>e.height||0,vH=e=>(e.x||0)+(e.width||0),bH=e=>(e.y||0)+(e.height||0),xH=e=>e.startAngle||0,wH=e=>e.endAngle||0,_H=e=>e.padAngle||0,EH=e=>e.innerRadius||0,OH=e=>e.outerRadius||0,SH=e=>e.cornerRadius||0,AH=e=>Vf(e.cornerRadiusTopLeft,e.cornerRadius)||0,kH=e=>Vf(e.cornerRadiusTopRight,e.cornerRadius)||0,CH=e=>Vf(e.cornerRadiusBottomRight,e.cornerRadius)||0,TH=e=>Vf(e.cornerRadiusBottomLeft,e.cornerRadius)||0,FH=e=>Vf(e.size,64),DH=e=>e.size||1,yp=e=>e.defined!==!1,MH=e=>oM(e.shape||"circle"),NH=cq().startAngle(xH).endAngle(wH).padAngle(_H).innerRadius(EH).outerRadius(OH).cornerRadius(SH),RH=uF().x(Yf).y1(Xf).y0(bH).defined(yp),jH=uF().y(Xf).x1(Yf).x0(vH).defined(yp),$H=sF().x(Yf).y(Xf).defined(yp),LH=aM().x(Yf).y(Xf).width(mH).height(yH).cornerRadius(AH,kH,CH,TH),IH=dq().type(MH).size(FH),PH=sM().x(Yf).y(Xf).defined(yp).size(DH);function wx(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function zH(e,t){return NH.context(e)(t)}function BH(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?jH:RH).curve(yx(i,n.orient,n.tension)).context(e)(t)}function UH(e,t){const n=t[0],i=n.interpolate||"linear";return $H.curve(yx(i,n.orient,n.tension)).context(e)(t)}function Dl(e,t,n,i){return LH.context(e)(t,n,i)}function qH(e,t){return(t.mark.shape||t.shape).context(e)(t)}function WH(e,t){return IH.context(e)(t)}function HH(e,t){return PH.context(e)(t)}var uM=1;function lM(){uM=1}function _x(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+uM++),a=r.clipping[o]||(r.clipping[o]={id:o});return _e(i)?a.path=i(null):wx(n)?a.path=Dl(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Nt(e){this.clear(),e&&this.union(e)}Nt.prototype={clone(){return new Nt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*i-u*r+l,u*i+s*r+c,s*i-u*a+l,u*i+s*a+c,s*o-u*r+l,u*o+s*r+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function vp(e){this.mark=e,this.bounds=this.bounds||new Nt}function bp(e){vp.call(this,e),this.items=this.items||[]}W(bp,vp);function Ex(e){this._pending=0,this._loader=e||kg()}function cM(e){e._pending+=1}function Kf(e){e._pending-=1}Ex.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return cM(t),t._loader.sanitize(e,{context:"href"}).then(n=>(Kf(t),n)).catch(()=>(Kf(t),null))},loadImage(e){const t=this,n=Fq();return cM(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const o=new n,a=re(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>Kf(t),o.onerror=()=>Kf(t),o.src=r,o}).catch(i=>(Kf(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function No(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?GH(t,i):0))}return e}function GH(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const VH=Ur-1e-8;let xp,wp,_p,Hs,Ox,Ep,Sx,Ax;const Ra=(e,t)=>xp.add(e,t),Op=(e,t)=>Ra(wp=e,_p=t),fM=e=>Ra(e,xp.y1),dM=e=>Ra(xp.x1,e),Gs=(e,t)=>Ox*e+Sx*t,Vs=(e,t)=>Ep*e+Ax*t,kx=(e,t)=>Ra(Gs(e,t),Vs(e,t)),Cx=(e,t)=>Op(Gs(e,t),Vs(e,t));function Jf(e,t){return xp=e,t?(Hs=t*Ma,Ox=Ax=Math.cos(Hs),Ep=Math.sin(Hs),Sx=-Ep):(Ox=Ax=1,Hs=Ep=Sx=0),YH}const YH={beginPath(){},closePath(){},moveTo:Cx,lineTo:Cx,rect(e,t,n,i){Hs?(kx(e+n,t),kx(e+n,t+i),kx(e,t+i),Cx(e,t)):(Ra(e+n,t+i),Op(e,t))},quadraticCurveTo(e,t,n,i){const r=Gs(e,t),o=Vs(e,t),a=Gs(n,i),s=Vs(n,i);hM(wp,r,a,fM),hM(_p,o,s,dM),Op(a,s)},bezierCurveTo(e,t,n,i,r,o){const a=Gs(e,t),s=Vs(e,t),u=Gs(n,i),l=Vs(n,i),c=Gs(r,o),f=Vs(r,o);gM(wp,a,u,c,fM),gM(_p,s,l,f,dM),Op(c,f)},arc(e,t,n,i,r,o){if(i+=Hs,r+=Hs,wp=n*Math.cos(r)+e,_p=n*Math.sin(r)+t,Math.abs(r-i)>VH)Ra(e-n,t-n),Ra(e+n,t+n);else{const a=l=>Ra(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(a(i),a(r),r!==i)if(i=i%Ur,i<0&&(i+=Ur),r=r%Ur,r<0&&(r+=Ur),r<i&&(o=!o,s=i,i=r,r=s),o)for(r-=Ur,s=i-i%Ws,u=0;u<4&&s>r;++u,s-=Ws)a(s);else for(s=i-i%Ws+Ws,u=0;u<4&&s<r;++u,s=s+Ws)a(s)}}};function hM(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function gM(e,t,n,i,r){const o=i-e+3*t-3*n,a=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(o)>sH?(c=a*a+s*o,c>=0&&(c=Math.sqrt(c),u=(-a+c)/o,l=(-a-c)/o)):u=.5*s/a,0<u&&u<1&&r(pM(u,e,t,n,i)),0<l&&l<1&&r(pM(l,e,t,n,i))}function pM(e,t,n,i,r){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*i+s*e*r}var ja=(ja=xl(1,1))?ja.getContext("2d"):null;const Tx=new Nt;function Fx(e){return function(t,n){if(!ja)return!0;e(ja,t),Tx.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:a}=Tx;for(let s=r;s<=a;++s)for(let u=i;u<=o;++u)if(ja.isPointInPath(u,s))return!0;return!1}}function Dx(e,t){return t.contains(e.x||0,e.y||0)}function mM(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Tx.set(n,i,n+r,i+o))}function yM(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:i;return Ml(t,n,i,r,o)}function Ml(e,t,n,i,r){const{x1:o,y1:a,x2:s,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(o-t)),m===1&&(h=l,g=s-t),m===2&&(h=-c,g=-(a-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Nl(e,t){e.globalCompositeOperation=t.blend||"source-over"}function ir(e,t){return e==null?t:e}function vM(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function XH(e,t,n){const i=n.width(),r=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+ir(t.x1,.5)*i,n.y1+ir(t.y1,.5)*r,Math.max(i,r)*ir(t.r1,0),n.x1+ir(t.x2,.5)*i,n.y1+ir(t.y2,.5)*r,Math.max(i,r)*ir(t.r2,.5));else{const a=ir(t.x1,0),s=ir(t.y1,0),u=ir(t.x2,1),l=ir(t.y2,0);if(a===u||s===l||i===r)o=e.createLinearGradient(n.x1+a*i,n.y1+s*r,n.x1+u*i,n.y1+l*r);else{const c=xl(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=vM(f.createLinearGradient(a,s,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return vM(o,t.stops)}function bM(e,t,n){return mx(n)?XH(e,n,t.bounds):n}function Sp(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=bM(e,t,t.fill),!0):!1}var KH=[];function Rl(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=bM(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||KH),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function JH(e,t){return e.zindex-t.zindex||e.index-t.index}function Mx(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,o;for(r=0,o=t.length;r<o;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(JH)}function rr(e,t){var n=e.items,i,r;if(!n||!n.length)return;const o=Mx(e);if(o&&o.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=o}for(i=0,r=n.length;i<r;++i)t(n[i])}function Ap(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const o=Mx(e);for(o&&o.length&&(n=o),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===o){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function Nx(e){return function(t,n,i){rr(n,r=>{(!i||i.intersects(r.bounds))&&xM(e,t,r,r)})}}function QH(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&xM(e,t,n.items[0],n.items)}}function xM(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Nl(t,n),n.fill&&Sp(t,n,r)&&t.fill(),n.stroke&&Rl(t,n,r)&&t.stroke()))}function kp(e){return e=e||Ti,function(t,n,i,r,o,a){return i*=t.pixelRatio,r*=t.pixelRatio,Ap(n,s=>{const u=s.bounds;if(!(u&&!u.contains(o,a)||!u)&&e(t,s,i,r,o,a))return s})}}function Qf(e,t){return function(n,i,r,o){var a=Array.isArray(i)?i[0]:i,s=t==null?a.fill:t,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:s&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o)}}function Rx(e){return kp(Qf(e))}function Ys(e,t){return"translate("+e+","+t+")"}function jx(e){return"rotate("+e+")"}function ZH(e,t){return"scale("+e+","+t+")"}function wM(e){return Ys(e.x||0,e.y||0)}function eG(e){return Ys(e.x||0,e.y||0)+(e.angle?" "+jx(e.angle):"")}function tG(e){return Ys(e.x||0,e.y||0)+(e.angle?" "+jx(e.angle):"")+(e.scaleX||e.scaleY?" "+ZH(e.scaleX||1,e.scaleY||1):"")}function $x(e,t,n){function i(a,s){a("transform",eG(s)),a("d",t(null,s))}function r(a,s){return t(Jf(a,s.angle),s),No(a,s).translate(s.x||0,s.y||0)}function o(a,s){var u=s.x||0,l=s.y||0,c=s.angle||0;a.translate(u,l),c&&a.rotate(c*=Ma),a.beginPath(),t(a,s),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:Nx(o),pick:Rx(o),isect:n||Fx(o)}}var nG=$x("arc",zH);function iG(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,o=1/0,a,s;--r>=0;)e[r].defined!==!1&&(s=Math.abs(e[r][i]-n),s<o&&(o=s,a=e[r]));return a}function rG(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,o,a;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],o=e[i].y-t[1],a=r*r+o*o,a<n))return e[i];return null}function oG(e,t){for(var n=e.length,i,r,o;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],o=i*i+r*r,i=e[n].size||1,o<i*i))return e[n];return null}function Lx(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(Jf(u),c),No(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const a=Qf(o);function s(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:QH(o),pick:s,isect:Dx,tip:n}}var aG=Lx("area",BH,iG);function sG(e,t){var n=t.clip;e.save(),_e(n)?(e.beginPath(),n(e),e.clip()):_M(e,t.group)}function _M(e,t){e.beginPath(),wx(t)?Dl(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function EM(e){const t=ir(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function uG(e,t){e("transform",wM(t))}function OM(e,t){const n=EM(t);e("d",Dl(null,t,n,n))}function lG(e,t){e("class","background"),e("aria-hidden",!0),OM(e,t)}function cG(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?OM(e,t):e("d","")}function fG(e,t,n){const i=t.clip?_x(n,t,t):null;e("clip-path",i)}function dG(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),No(e,t),e.translate(t.x||0,t.y||0)}function Zf(e,t,n,i){const r=EM(t);e.beginPath(),Dl(e,t,(n||0)+r,(i||0)+r)}const hG=Qf(Zf),gG=Qf(Zf,!1),pG=Qf(Zf,!0);function mG(e,t,n){rr(t,i=>{const r=i.x||0,o=i.y||0,a=i.strokeForeground,s=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&s&&(Zf(e,i,r,o),Nl(e,i),i.fill&&Sp(e,i,s)&&e.fill(),i.stroke&&!a&&Rl(e,i,s)&&e.stroke()),e.save(),e.translate(r,o),i.clip&&_M(e,i),n&&n.translate(-r,-o),rr(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,o),e.restore(),a&&i.stroke&&s&&(Zf(e,i,r,o),Nl(e,i),Rl(e,i,s)&&e.stroke())})}function yG(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const a=n*e.pixelRatio,s=i*e.pixelRatio;return Ap(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(r<c||r>h||o<f||o>g))return;if(e.save(),e.translate(c,f),c=r-c,f=o-f,p&&wx(u)&&!pG(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&gG(e,u,a,s)?(e.restore(),u):(l=Ap(u,v=>vG(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&hG(e,u,a,s)&&(l=u),e.restore(),l||null)})}function vG(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var bG={type:"group",tag:"g",nested:!1,attr:uG,bound:dG,draw:mG,pick:yG,isect:mM,content:fG,background:lG,foreground:cG},ed={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Ix(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function Px(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function zx(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function Cp(e,t){return e==="center"?t/2:e==="right"?t:0}function Tp(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function xG(e,t,n){const i=Ix(t,n),r=Px(t,i),o=zx(t,i),a=(t.x||0)-Cp(t.align,r),s=(t.y||0)-Tp(t.baseline,o),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,ed["xmlns:xlink"],"xlink:href"),e("transform",Ys(a,s)),e("width",r),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function wG(e,t){const n=t.image,i=Px(t,n),r=zx(t,n),o=(t.x||0)-Cp(t.align,i),a=(t.y||0)-Tp(t.baseline,r);return e.set(o,a,o+i,a+r)}function _G(e,t,n){rr(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=Ix(i,this);let o=Px(i,r),a=zx(i,r);if(o===0||a===0)return;let s=(i.x||0)-Cp(i.align,o),u=(i.y||0)-Tp(i.baseline,a),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(a-d)/2,a=d):(d=a*c,s+=(o-d)/2,o=d))),(r.complete||r.toDataURL)&&(Nl(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,s,u,o,a))})}var EG={type:"image",tag:"image",nested:!1,attr:xG,bound:wG,draw:_G,pick:kp(),isect:Ti,get:Ix,xOffset:Cp,yOffset:Tp},OG=Lx("line",UH,rG);function SG(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",tG(t)),e("d",t.path)}function Fp(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Ma,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Tl(n)).path=n),s&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(s),Gf(e,u,0,0,o,a),e.rotate(-s),e.translate(-i,-r)):Gf(e,u,i,r,o,a)}function AG(e,t){return Fp(Jf(e,t.angle),t)?e.set(0,0,0,0):No(e,t,!0)}var kG={type:"path",tag:"path",nested:!1,attr:SG,bound:AG,draw:Nx(Fp),pick:Rx(Fp),isect:Fx(Fp)};function CG(e,t){e("d",Dl(null,t))}function TG(e,t){var n,i;return No(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function SM(e,t){e.beginPath(),Dl(e,t)}var FG={type:"rect",tag:"path",nested:!1,attr:CG,bound:TG,draw:Nx(SM),pick:Rx(SM),isect:mM};function DG(e,t){e("transform",wM(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function MG(e,t){var n,i;return No(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function AM(e,t,n){var i,r,o,a;return t.stroke&&Rl(e,t,n)?(i=t.x||0,r=t.y||0,o=t.x2!=null?t.x2:i,a=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,a),!0):!1}function NG(e,t,n){rr(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&AM(e,i,r)&&(Nl(e,i),e.stroke())}})}function RG(e,t,n,i){return e.isPointInStroke?AM(e,t,1)&&e.isPointInStroke(n,i):!1}var jG={type:"rule",tag:"line",nested:!1,attr:DG,bound:MG,draw:NG,pick:kp(RG),isect:yM},$G=$x("shape",qH),LG=$x("symbol",WH,Dx);const kM=bk();var qr={height:Wr,measureWidth:Ux,estimateWidth:Bx,width:Bx,canvas:CM};CM(!0);function CM(e){qr.width=e&&ja?Ux:Bx}function Bx(e,t){return TM(La(e,t),Wr(e))}function TM(e,t){return~~(.8*e.length*t)}function Ux(e,t){return Wr(e)<=0||!(t=La(e,t))?0:FM(t,Dp(e))}function FM(e,t){const n=`(${t}) ${e}`;let i=kM.get(n);return i===void 0&&(ja.font=t,i=ja.measureText(e).width,kM.set(n,i)),i}function Wr(e){return e.fontSize!=null?+e.fontSize||0:11}function $a(e){return e.lineHeight!=null?e.lineHeight:Wr(e)+2}function IG(e){return P(e)?e.length>1?e:e[0]:e}function td(e){return IG(e.lineBreak&&e.text&&!P(e.text)?e.text.split(e.lineBreak):e.text)}function qx(e){const t=td(e);return(P(t)?t.length-1:0)*$a(e)}function La(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?zG(e,n):n}function PG(e){if(qr.width===Ux){const t=Dp(e);return n=>FM(n,t)}else{const t=Wr(e);return n=>TM(n,t)}}function zG(e,t){var n=+e.limit,i=PG(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",o=e.dir==="rtl",a=0,s=t.length,u;if(n-=i(r),o){for(;a<s;)u=a+s>>>1,i(t.slice(u))>n?a=u+1:s=u;return r+t.slice(a)}else{for(;a<s;)u=1+(a+s>>>1),i(t.slice(0,u))<n?a=u:s=u-1;return t.slice(0,a)+r}}function nd(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Dp(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Wr(e)+"px "+nd(e,t)}function Wx(e){var t=e.baseline,n=Wr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*$a(e):t==="line-bottom"?.29*n-.5*$a(e):0)}const BG={left:"start",center:"middle",right:"end"},id=new Nt;function Mp(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Ws,t+=i*Math.cos(r),n+=i*Math.sin(r)),id.x1=t,id.y1=n,id}function UG(e,t){var n=t.dx||0,i=(t.dy||0)+Wx(t),r=Mp(t),o=r.x1,a=r.y1,s=t.angle||0,u;e("text-anchor",BG[t.align]||"start"),s?(u=Ys(o,a)+" "+jx(s),(n||i)&&(u+=" "+Ys(n,i))):u=Ys(o+n,a+i),e("transform",u)}function Hx(e,t,n){var i=qr.height(t),r=t.align,o=Mp(t),a=o.x1,s=o.y1,u=t.dx||0,l=(t.dy||0)+Wx(t)-Math.round(.8*i),c=td(t),f;if(P(c)?(i+=$a(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,qr.width(t,h)),0)):f=qr.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=a,l+=s,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Ma,a,s);else if(n===2)return e.rotatedPoints(t.angle*Ma,a,s);return e}function qG(e,t,n){rr(t,i=>{var r=i.opacity==null?1:i.opacity,o,a,s,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=Dp(i),e.textAlign=i.align||"left",o=Mp(i),a=o.x1,s=o.y1,i.angle&&(e.save(),e.translate(a,s),e.rotate(i.angle*Ma),a=s=0),a+=i.dx||0,s+=(i.dy||0)+Wx(i),c=td(i),Nl(e,i),P(c))for(l=$a(i),u=0;u<c.length;++u)f=La(i,c[u]),i.fill&&Sp(e,i,r)&&e.fillText(f,a,s),i.stroke&&Rl(e,i,r)&&e.strokeText(f,a,s),s+=l;else f=La(i,c),i.fill&&Sp(e,i,r)&&e.fillText(f,a,s),i.stroke&&Rl(e,i,r)&&e.strokeText(f,a,s);i.angle&&e.restore()}})}function WG(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=Mp(t),s=a.x1,u=a.y1,l=Hx(id,t,1),c=-t.angle*Ma,f=Math.cos(c),d=Math.sin(c),h=f*r-d*o+(s-f*s+d*u),g=d*r+f*o+(u-d*s-f*u);return l.contains(h,g)}function HG(e,t){const n=Hx(id,e,2);return Ml(t,n[0],n[1],n[2],n[3])||Ml(t,n[0],n[1],n[4],n[5])||Ml(t,n[4],n[5],n[6],n[7])||Ml(t,n[2],n[3],n[6],n[7])}var GG={type:"text",tag:"text",nested:!1,attr:UG,bound:Hx,draw:qG,pick:kp(WG),isect:HG},VG=Lx("trail",HH,oG),xi={arc:nG,area:aG,group:bG,image:EG,line:OG,path:kG,rect:FG,rule:jG,shape:$G,symbol:LG,text:GG,trail:VG};function Gx(e,t,n){var i=xi[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Nt),e,n)}var DM={mark:null};function MM(e,t,n){var i=xi[e.marktype],r=i.bound,o=e.items,a=o&&o.length,s,u,l,c;if(i.nested)return a?l=o[0]:(DM.mark=e,l=DM),c=Gx(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Nt,a)for(s=0,u=o.length;s<u;++s)t.union(Gx(o[s],r,n));return e.bounds=t}const YG=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function NM(e,t){return JSON.stringify(e,YG,t)}function RM(e){const t=typeof e=="string"?JSON.parse(e):e;return jM(t)}function jM(e){var t=e.marktype,n=e.items,i,r,o;if(n)for(r=0,o=n.length;r<o;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&jM(n[r]);return t&&MM(e),e}function Vx(e){arguments.length?this.root=RM(e):(this.root=$M({marktype:"group",name:"root",role:"frame"}),this.root.items=[new bp(this.root)])}Vx.prototype={toJSON(e){return NM(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=$M(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function $M(e,t){const n={bounds:new Nt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Ia(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Yx(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Jn(e,t,n,i){var r=e.childNodes[t],o;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(o=r||null,r=Ia(e.ownerDocument,n,i),e.insertBefore(r,o)),r}function or(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function LM(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Np(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function XG(e,t,n,i){var r=e&&e.mark,o,a;if(r&&(o=xi[r.marktype]).tip){for(a=Np(t,n),a[0]-=i[0],a[1]-=i[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=o.tip(r.items,a)}return e}function Pa(e,t){this._active=null,this._handlers={},this._loader=e||kg(),this._tooltip=t||KG}function KG(e,t,n,i){e.element().setAttribute("title",i||"")}Pa.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),o=Ia(null,"a");for(const a in i)o.setAttribute(a,i[a]);o.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=XG(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),a=r.height();let s=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}};function Hr(e){this._el=null,this._bgcolor=null,this._loader=new Ex(e)}Hr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(o=>{o&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const JG="keydown",QG="keypress",ZG="keyup",IM="dragenter",Rp="dragleave",PM="dragover",Xx="mousedown",eV="mouseup",jp="mousemove",rd="mouseout",zM="mouseover",$p="click",tV="dblclick",nV="wheel",BM="mousewheel",Lp="touchstart",Ip="touchmove",Pp="touchend",iV=[JG,QG,ZG,IM,Rp,PM,Xx,eV,jp,rd,zM,$p,tV,nV,BM,Lp,Ip,Pp],Kx=jp,od=rd,Jx=$p;function ad(e,t){Pa.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const rV=e=>e===Lp||e===Ip||e===Pp?[Lp,Ip,Pp]:[e];function UM(e,t){rV(t).forEach(n=>oV(e,n))}function oV(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function qM(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=o,this.fire(t,i),this.fire(e,i))}}function WM(e){return function(t){this.fire(e,t),this._active=null}}W(ad,Pa,{initialize(e,t,n){return this._canvas=e&&Yx(e,"canvas"),[$p,Xx,jp,rd,Rp].forEach(i=>UM(this,i)),Pa.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:iV,DOMMouseScroll(e){this.fire(BM,e)},mousemove:qM(jp,zM,rd),dragover:qM(PM,IM,Rp),mouseout:WM(rd),dragleave:WM(Rp),mousedown(e){this._down=this._active,this.fire(Xx,e)},click(e){this._down===this._active&&(this.fire($p,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Lp,e,!0)},touchmove(e){this.fire(Ip,e,!0)},touchend(e){this.fire(Pp,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===Jx&&i&&i.href?this.handleHref(t,i,i.href):(e===Kx||e===od)&&this.handleTooltip(t,i,e!==od),r)for(let o=0,a=r.length;o<a;++o)r[o].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(UM(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Np(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return xi[e.marktype].pick.call(this,o,e,t,n,i,r)}});function aV(){return typeof window!="undefined"&&window.devicePixelRatio||1}var sV=aV();function uV(e,t,n,i,r,o){const a=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=a?sV:r;e.width=t*u,e.height=n*u;for(const l in o)s[l]=o[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function zp(e){Hr.call(this,e),this._options={},this._redraw=!1,this._dirty=new Nt,this._tempb=new Nt}const HM=Hr.prototype,lV=(e,t,n)=>new Nt().set(0,0,t,n).translate(-e[0],-e[1]);function cV(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}W(zp,Hr,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:xl(1,1,this._options.type),e&&this._canvas&&(or(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),HM.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(HM.resize.call(this,e,t,n,i),this._canvas)uV(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||L("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,a=lV(n,i,r);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):cV(t,a.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const i=xi[t.marktype];t.clip&&sG(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();r.type!=="pdf"&&!r.externalContext&&o.clearRect(e,t,n,i),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});function Qx(e,t){Pa.call(this,e,t);const n=this;n._hrefHandler=Zx(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=Zx(n,(i,r)=>{n.handleTooltip(i,r,i.type!==od)})}const Zx=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};W(Qx,Pa,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(Jx,this._hrefHandler),i.removeEventListener(Kx,this._tooltipHandler),i.removeEventListener(od,this._tooltipHandler)),this._svg=i=e&&Yx(e,"svg"),i&&(i.addEventListener(Jx,this._hrefHandler),i.addEventListener(Kx,this._tooltipHandler),i.addEventListener(od,this._tooltipHandler)),Pa.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const o={type:e,handler:t,listener:Zx(this,t)};(i[n]||(i[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const GM="aria-hidden",e2="aria-label",t2="role",n2="aria-roledescription",VM="graphics-object",i2="graphics-symbol",YM=(e,t,n)=>({[t2]:e,[n2]:t,[e2]:n||void 0}),fV=er(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),XM={axis:{desc:"axis",caption:gV},legend:{desc:"legend",caption:pV},"title-text":{desc:"title",caption:e=>`Title text '${ZM(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${ZM(e)}'`}},KM={ariaRole:t2,ariaRoleDescription:n2,description:e2};function JM(e,t){const n=t.aria===!1;if(e(GM,n||void 0),n||t.description==null)for(const i in KM)e(KM[i],void 0);else{const i=t.mark.marktype;e(e2,t.description),e(t2,t.ariaRole||(i==="group"?VM:i2)),e(n2,t.ariaRoleDescription||`${i} mark`)}}function QM(e){return e.aria===!1?{[GM]:!0}:fV[e.role]?null:XM[e.role]?hV(e,XM[e.role]):dV(e)}function dV(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return YM(n?VM:i2,`${t} mark container`,e.description)}function hV(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return YM(t.role||i2,t.desc,n.description||i(n))}catch{return null}}function ZM(e){return J(e.text).join(" ")}function gV(e){const t=e.datum,n=e.orient,i=t.title?e3(e):null,r=e.context,o=r.scales[t.scale].value,a=r.dataflow.locale(),s=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Cl(s)?"discrete":s} scale with ${KD(a,o,e)}`}function pV(e){const t=e.datum,n=t.title?e3(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,o=Object.keys(r),a=e.context,s=a.scales[r[o[0]]].value,u=a.dataflow.locale();return yV(i)+(n?` titled '${n}'`:"")+` for ${mV(o)} with ${KD(u,s,e)}`}function e3(e){try{return J(Fe(e.items).items[0].text).join(" ")}catch{return null}}function mV(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Fe(e)}function yV(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const t3=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),vV=e=>t3(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function r2(){let e="",t="",n="";const i=[],r=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${vV(l)}"`),s),s={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)a(f,c[f]);return s},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),s},attr:a,text:u=>(n+=t3(u),s),toString:()=>e};return s}const n3=e=>i3(r2(),e)+"";function i3(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const o=n[r];o.nodeType===3?e.text(o.nodeValue):i3(e,o)}}return e.close()}const Bp={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},r3={fill:"none","stroke-miterlimit":10},sd=0,o3="http://www.w3.org/2000/xmlns/",Rt=ed.xmlns;function o2(e){Hr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const a2=Hr.prototype;W(o2,Hr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Jn(e,0,"svg",Rt),this._svg.setAttributeNS(o3,"xmlns",Rt),this._svg.setAttributeNS(o3,"xmlns:xlink",ed["xmlns:xlink"]),this._svg.setAttribute("version",ed.version),this._svg.setAttribute("class","marks"),or(e,1),this._root=Jn(this._svg,sd,"g",Rt),za(this._root,r3),or(this._svg,sd+1)),this.background(this._bgcolor),a2.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),a2.background.apply(this,arguments)},resize(e,t,n,i){return a2.resize.call(this,e,t,n,i),this._svg&&(za(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Jn(e,sd,"rect",Rt),za(n,{width:this._width,height:this._height,fill:t}));const i=n3(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),or(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,o,a,s,u;for(a=0,s=e.length;a<s;++a)if(n=e[a],i=n.mark,i.marktype!==r&&(r=i.marktype,o=xi[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,a3(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){o.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,a3(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=xi[t.marktype],o=t.interactive===!1?"none":null,a=r.tag==="g";let s=null,u=0;const l=s3(t,e,n,"g",i);l.setAttribute("class",LM(t));const c=QM(t);for(const d in c)Tn(l,d,c[d]);a||Tn(l,"pointer-events",o),Tn(l,"clip-path",t.clip?_x(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=s3(d,l,s,r.tag,i);h&&(this._update(r,g,d),a&&wV(this,g,d)),s=g,++u};return r.nested?t.items.length&&f(t.items[0]):rr(t,f),or(l,u),l},_update(e,t,n){Ro=t,bn=t.__values__,JM(ud,n),e.attr(ud,n,this);const i=EV[e.type];i&&i.call(this,e,t,n),Ro&&this.style(Ro,n)},style(e,t){if(t!=null)for(const n in Bp){let i=n==="font"?nd(t):t[n];if(i===bn[n])continue;const r=Bp[n];i==null?e.removeAttribute(r):(mx(i)&&(i=QD(i,this._defs.gradient,u3())),e.setAttribute(r,i+"")),bn[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Jn(e,sd+1,"defs",Rt)),i=bV(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Jn(e,sd+1,"defs",Rt)),i=xV(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):or(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function a3(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function bV(e,t,n){let i,r,o;if(t.gradient==="radial"){let a=Jn(e,n++,"pattern",Rt);za(a,{id:pp+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Jn(a,0,"rect",Rt),za(a,{width:1,height:1,fill:`url(${u3()}#${t.id})`}),e=Jn(e,n++,"radialGradient",Rt),za(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Jn(e,n++,"linearGradient",Rt),za(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=Jn(e,i,"stop",Rt),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return or(e,i),n}function xV(e,t,n){let i;return e=Jn(e,n,"clipPath",Rt),e.setAttribute("id",t.id),t.path?(i=Jn(e,0,"path",Rt),i.setAttribute("d",t.path)):(i=Jn(e,0,"rect",Rt),za(i,{x:0,y:0,width:t.width,height:t.height})),or(e,1),n+1}function wV(e,t,n){t=t.lastChild.previousSibling;let i,r=0;rr(n,o=>{i=e.mark(t,o,i),++r}),or(t,1+r)}function s3(e,t,n,i,r){let o=e._svg,a;if(!o&&(a=t.ownerDocument,o=Ia(a,i,Rt),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},i==="g"))){const s=Ia(a,"path",Rt);o.appendChild(s),s.__data__=e;const u=Ia(a,"g",Rt);o.appendChild(u),u.__data__=e;const l=Ia(a,"path",Rt);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==r||_V(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function _V(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let Ro=null,bn=null;const EV={group(e,t,n){const i=Ro=t.childNodes[2];bn=i.__values__,e.foreground(ud,n,this),bn=t.__values__,Ro=t.childNodes[1],e.content(ud,n,this);const r=Ro=t.childNodes[0];e.background(ud,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==bn.events&&(Tn(i,"pointer-events",o),Tn(r,"pointer-events",o),bn.events=o),n.strokeForeground&&n.stroke){const a=n.fill;Tn(i,"display",null),this.style(r,n),Tn(r,"stroke",null),a&&(n.fill=null),bn=i.__values__,this.style(i,n),a&&(n.fill=a),Ro=null}else Tn(i,"display","none")},image(e,t,n){n.smooth===!1?(s2(t,"image-rendering","optimizeSpeed"),s2(t,"image-rendering","pixelated")):s2(t,"image-rendering",null)},text(e,t,n){const i=td(n);let r,o,a,s;P(i)?(o=i.map(u=>La(n,u)),r=o.join(`
`),r!==bn.text&&(or(t,0),a=t.ownerDocument,s=$a(n),o.forEach((u,l)=>{const c=Ia(a,"tspan",Rt);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),bn.text=r)):(o=La(n,i),o!==bn.text&&(t.textContent=o,bn.text=o)),Tn(t,"font-family",nd(n)),Tn(t,"font-size",Wr(n)+"px"),Tn(t,"font-style",n.fontStyle),Tn(t,"font-variant",n.fontVariant),Tn(t,"font-weight",n.fontWeight)}};function ud(e,t,n){t!==bn[e]&&(n?OV(Ro,e,t,n):Tn(Ro,e,t),bn[e]=t)}function s2(e,t,n){n!==bn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),bn[t]=n)}function za(e,t){for(const n in t)Tn(e,n,t[n])}function Tn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function OV(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function u3(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function u2(e){Hr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}W(u2,Hr,{svg(){return this._text},_render(e){const t=r2();t.open("svg",Ee({},ed,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",r3,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=xi[t.marktype],i=n.tag,r=[JM,n.attr];e.open("g",{class:LM(t),"clip-path":t.clip?_x(this,t,t.group):null},QM(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const o=a=>{const s=this.href(a);if(s&&e.open("a",s),e.open(i,this.attr(t,a,r,i!=="g"?i:null)),i==="text"){const u=td(a);if(P(u)){const l={x:0,dy:$a(a)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(La(a,u[c])).close()}else e.text(La(a,u))}else if(i==="g"){const u=a.strokeForeground,l=a.fill,c=a.stroke;u&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),rr(a,f=>this.mark(e,f)),e.close(),u&&c?(l&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),l&&(a.fill=l)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):rr(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},o=(a,s,u,l)=>{r[l||a]=s};return Array.isArray(n)?n.forEach(a=>a(o,t,this)):n(o,t,this),i&&SV(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const o=t[r],a=o.stops;o.gradient==="radial"?(e.open("pattern",{id:pp+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:r,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let s=0;s<a.length;++s)e.open("stop",{offset:a[s].offset,"stop-color":a[s].color}).close();e.close()}for(const r in n){const o=n[r];e.open("clipPath",{id:r}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function SV(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=nd(t),e["font-size"]=Wr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Bp){let a=t[o];const s=Bp[o];a==="transparent"&&(s==="fill"||s==="stroke")||a!=null&&(mx(a)&&(a=QD(a,r.gradient,"")),e[s]=a)}return e}const l3="canvas",c3="png",f3="svg",d3="none",Ba={Canvas:l3,PNG:c3,SVG:f3,None:d3},jl={};jl[l3]=jl[c3]={renderer:zp,headless:zp,handler:ad};jl[f3]={renderer:o2,headless:u2,handler:Qx};jl[d3]={};function Up(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(jl[e]=t,this):jl[e]}function h3(e,t,n){const i=[],r=new Nt().union(t),o=e.marktype;return o?g3(e,r,n,i):o==="group"?p3(e,r,n,i):L("Intersect scene must be mark node or group item.")}function g3(e,t,n,i){if(AV(e,t,n)){const r=e.items,o=e.marktype,a=r.length;let s=0;if(o==="group")for(;s<a;++s)p3(r[s],t,n,i);else for(const u=xi[o].isect;s<a;++s){const l=r[s];m3(l,t,u)&&i.push(l)}}return i}function AV(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function p3(e,t,n,i){n&&n(e.mark)&&m3(e,t,xi.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let u=0;u<o;++u)g3(r[u],t,n,i);t.translate(a,s)}return i}function m3(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const l2=new Nt;function y3(e){const t=e.clip;if(_e(t))t(Jf(l2.clear()));else if(t)l2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(l2)}const kV=1e-9;function c2(e,t,n){return e===t?!0:n==="path"?v3(e,t):e instanceof Date&&t instanceof Date?+e==+t:Je(e)&&Je(t)?Math.abs(e-t)<=kV:!e||!t||!Q(e)&&!Q(t)?e==t:CV(e,t)}function v3(e,t){return c2(Tl(e),Tl(t))}function CV(e,t){var n=Object.keys(e),i=Object.keys(t),r,o;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),o=n.length-1;o>=0;o--)if(n[o]!=i[o])return!1;for(o=n.length-1;o>=0;o--)if(r=n[o],!c2(e[r],t[r],r))return!1;return typeof e==typeof t}function TV(){lM(),oH()}const $l="top",ar="left",sr="right",Ua="bottom",FV="top-left",DV="top-right",MV="bottom-left",NV="bottom-right",f2="start",d2="middle",Fn="end",RV="x",jV="y",qp="group",h2="axis",g2="title",$V="frame",LV="scope",p2="legend",b3="row-header",x3="row-footer",w3="row-title",_3="column-header",E3="column-footer",O3="column-title",IV="padding",PV="symbol",S3="fit",zV="fit-x",BV="fit-y",UV="pad",m2="none",Wp="all",y2="each",v2="flush",qa="column",Wa="row";function A3(e){R.call(this,null,e)}W(A3,R,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,o=xi[r],a=o.bound;let s=i.bounds,u;if(o.nested)i.items.length&&n.dirty(i.items[0]),s=Hp(i,a),i.items.forEach(l=>{l.bounds.clear().union(s)});else if(r===qp||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),i.items.forEach(l=>s.union(Hp(l,a))),i.role){case h2:case p2:case g2:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(Hp(l,a))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(Hp(l,a))}),u&&(s.clear(),i.items.forEach(l=>s.union(l.bounds)));return y3(i),t.modifies("bounds")}});function Hp(e,t,n){return t(e.bounds.clear(),e,n)}const k3=":vega_identifier:";function b2(e){R.call(this,0,e)}b2.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};W(b2,R,{transform(e,t){const n=qV(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,o=>o[i]=o[i]||++r),n.set(this.value=r),t}});function qV(e){return e._signals[k3]||(e._signals[k3]=e.add(0))}function C3(e){R.call(this,null,e)}W(C3,R,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,WV(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===qp?bp:vp;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function WV(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function T3(e){R.call(this,null,e)}const F3={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!D3(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},D3=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),M3=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,o;n<i;r=o,++n)if(D3(r,o=e[n].bounds,t))return!0},HV=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},GV=(e,t,n)=>{var i=e.range(),r=new Nt;return t===$l||t===Ua?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),o=>r.encloses(o.bounds)},N3=e=>(e.forEach(t=>t.opacity=1),e),R3=(e,t)=>e.reflow(t.modified()).modifies("opacity");W(T3,R,{transform(e,t){const n=F3[e.method]||F3.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,o,a;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(N3(r),t=R3(t,e)),t;if(r=r.filter(HV),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),o=N3(r),t=R3(t,e),o.length>=3&&M3(o,i)){do o=n(o,i);while(o.length>=3&&M3(o,i));o.length<3&&!Fe(r).opacity&&(o.length>1&&(Fe(o).opacity=0),Fe(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=GV(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{a(u)||(u.opacity=0)}));const s=o[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function j3(e){R.call(this,null,e)}W(j3,R,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const xn=new Nt;function Ll(e,t,n){return e[t]===n?0:(e[t]=n,1)}function VV(e){var t=e.items[0].orient;return t===ar||t===sr}function YV(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function XV(e,t,n,i){var r=t.items[0],o=r.datum,a=r.translate!=null?r.translate:.5,s=r.orient,u=YV(o),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,g=o.title&&r.items[u[2]].items[0],p=r.titlePadding,m=r.bounds,y=g&&qx(g),v=0,x=0,b,_;switch(xn.clear().union(m),m.clear(),(b=u[0])>-1&&m.union(r.items[b].bounds),(b=u[1])>-1&&m.union(r.items[b].bounds),s){case $l:v=f||0,x=-c,_=Math.max(d,Math.min(h,-m.y1)),m.add(0,-_).add(l,0),g&&Gp(e,g,_,p,y,0,-1,m);break;case ar:v=-c,x=f||0,_=Math.max(d,Math.min(h,-m.x1)),m.add(-_,0).add(0,l),g&&Gp(e,g,_,p,y,1,-1,m);break;case sr:v=n+c,x=f||0,_=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(_,l),g&&Gp(e,g,_,p,y,1,1,m);break;case Ua:v=f||0,x=i+c,_=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,_),g&&Gp(e,g,_,p,0,0,1,m);break;default:v=r.x,x=r.y}return No(m.translate(v,x),r),Ll(r,"x",v+a)|Ll(r,"y",x+a)&&(r.bounds=xn,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function Gp(e,t,n,i,r,o,a,s){const u=t.bounds;if(t.auto){const l=a*(n+r+i);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const $3=(e,t)=>Math.floor(Math.min(e,t)),L3=(e,t)=>Math.ceil(Math.max(e,t));function KV(e){var t=e.items,n=t.length,i=0,r,o;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],o=r.items,r.marktype===qp)switch(r.role){case h2:case p2:case g2:break;case b3:a.rowheaders.push(...o);break;case x3:a.rowfooters.push(...o);break;case _3:a.colheaders.push(...o);break;case E3:a.colfooters.push(...o);break;case w3:a.rowtitle=o[0];break;case O3:a.coltitle=o[0];break;default:a.marks.push(...o)}return a}function JV(e){return new Nt().set(0,0,e.width||0,e.height||0)}function QV(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function dt(e,t,n){const i=Q(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function I3(e){return e<0?Math.ceil(-e):0}function P3(e,t,n){var i=!n.nodirty,r=n.bounds===v2?JV:QV,o=xn.set(0,0,0,0),a=dt(n.align,qa),s=dt(n.align,Wa),u=dt(n.padding,qa),l=dt(n.padding,Wa),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),v=0,x=Array(d),b=Array(d),_=Array(d),E,w,O,S,k,A,F,C,M,D,N;for(w=0;w<c;++w)g[w]=0;for(w=0;w<f;++w)y[w]=0;for(w=0;w<d;++w)A=t[w],k=_[w]=r(A),A.x=A.x||0,x[w]=0,A.y=A.y||0,b[w]=0,O=w%c,S=~~(w/c),p=Math.max(p,F=Math.ceil(k.x2)),v=Math.max(v,C=Math.ceil(k.y2)),g[O]=Math.max(g[O],F),y[S]=Math.max(y[S],C),h[w]=u+I3(k.x1),m[w]=l+I3(k.y1),i&&e.dirty(t[w]);for(w=0;w<d;++w)w%c==0&&(h[w]=0),w<c&&(m[w]=0);if(a===y2)for(O=1;O<c;++O){for(N=0,w=O;w<d;w+=c)N<h[w]&&(N=h[w]);for(w=O;w<d;w+=c)h[w]=N+g[O-1]}else if(a===Wp){for(N=0,w=0;w<d;++w)w%c&&N<h[w]&&(N=h[w]);for(w=0;w<d;++w)w%c&&(h[w]=N+p)}else for(a=!1,O=1;O<c;++O)for(w=O;w<d;w+=c)h[w]+=g[O-1];if(s===y2)for(S=1;S<f;++S){for(N=0,w=S*c,E=w+c;w<E;++w)N<m[w]&&(N=m[w]);for(w=S*c;w<E;++w)m[w]=N+y[S-1]}else if(s===Wp){for(N=0,w=c;w<d;++w)N<m[w]&&(N=m[w]);for(w=c;w<d;++w)m[w]=N+v}else for(s=!1,S=1;S<f;++S)for(w=S*c,E=w+c;w<E;++w)m[w]+=y[S-1];for(M=0,w=0;w<d;++w)M=h[w]+(w%c?M:0),x[w]+=M-t[w].x;for(O=0;O<c;++O)for(D=0,w=O;w<d;w+=c)D+=m[w],b[w]+=D-t[w].y;if(a&&dt(n.center,qa)&&f>1)for(w=0;w<d;++w)k=a===Wp?p:g[w%c],M=k-_[w].x2-t[w].x-x[w],M>0&&(x[w]+=M/2);if(s&&dt(n.center,Wa)&&c!==1)for(w=0;w<d;++w)k=s===Wp?v:y[~~(w/c)],D=k-_[w].y2-t[w].y-b[w],D>0&&(b[w]+=D/2);for(w=0;w<d;++w)o.union(_[w].translate(x[w],b[w]));switch(M=dt(n.anchor,RV),D=dt(n.anchor,jV),dt(n.anchor,qa)){case Fn:M-=o.width();break;case d2:M-=o.width()/2}switch(dt(n.anchor,Wa)){case Fn:D-=o.height();break;case d2:D-=o.height()/2}for(M=Math.round(M),D=Math.round(D),o.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)A=t[w],A.x+=x[w]+=M,A.y+=b[w]+=D,o.union(A.mark.bounds.union(A.bounds.translate(x[w],b[w]))),i&&e.dirty(A);return o}function ZV(e,t,n){var i=KV(t),r=i.marks,o=n.bounds===v2?eY:tY,a=n.offset,s=n.columns||r.length,u=s<=0?1:Math.ceil(r.length/s),l=u*s,c,f,d,h,g,p,m;const y=P3(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(p=dt(n.headerBand,Wa,null),c=Vp(e,i.rowheaders,r,s,u,-dt(a,"rowHeader"),$3,0,o,"x1",0,s,1,p)),i.colheaders&&(p=dt(n.headerBand,qa,null),f=Vp(e,i.colheaders,r,s,s,-dt(a,"columnHeader"),$3,1,o,"y1",0,1,s,p)),i.rowfooters&&(p=dt(n.footerBand,Wa,null),d=Vp(e,i.rowfooters,r,s,u,dt(a,"rowFooter"),L3,0,o,"x2",s-1,s,1,p)),i.colfooters&&(p=dt(n.footerBand,qa,null),h=Vp(e,i.colfooters,r,s,s,dt(a,"columnFooter"),L3,1,o,"y2",l-s,1,s,p)),i.rowtitle&&(g=dt(n.titleAnchor,Wa),m=dt(a,"rowTitle"),m=g===Fn?d+m:c-m,p=dt(n.titleBand,Wa,.5),z3(e,i.rowtitle,m,0,y,p)),i.coltitle&&(g=dt(n.titleAnchor,qa),m=dt(a,"columnTitle"),m=g===Fn?h+m:f-m,p=dt(n.titleBand,qa,.5),z3(e,i.coltitle,m,1,y,p))}function eY(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function tY(e,t){return e.bounds[t]}function Vp(e,t,n,i,r,o,a,s,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,v,x,b,_,E,w,O,S;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=a(p,u(n[y],l)));if(!t.length)return p;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),p+=o,v=0,b=t.length;v<b;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,b=t.length;v<b;++v,y+=f){for(E=t[v],_=E.mark.bounds,x=y;x>=0&&(w=n[x])==null;x-=d);s?(O=h==null?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),S=p):(O=p,S=h==null?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),_.union(E.bounds.translate(O-(E.x||0),S-(E.y||0))),E.x=O,E.y=S,e.dirty(E),m=a(m,_[l])}return m}function z3(e,t,n,i,r,o){if(!!t){e.dirty(t);var a=n,s=n;i?a=Math.round(r.x1+o*r.width()):s=Math.round(r.y1+o*r.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function nY(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function iY(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function rY(e,t,n,i,r,o,a){const s=nY(n,t),u=iY(e,s("offset",0)),l=s("anchor",f2),c=l===Fn?1:l===d2?.5:0,f={align:y2,bounds:s("bounds",v2),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case ar:f.anchor={x:Math.floor(i.x1)-u,column:Fn,y:c*(a||i.height()+2*i.y1),row:l};break;case sr:f.anchor={x:Math.ceil(i.x2)+u,y:c*(a||i.height()+2*i.y1),row:l};break;case $l:f.anchor={y:Math.floor(r.y1)-u,row:Fn,x:c*(o||r.width()+2*r.x1),column:l};break;case Ua:f.anchor={y:Math.ceil(r.y2)+u,x:c*(o||r.width()+2*r.x1),column:l};break;case FV:f.anchor={x:u,y:u};break;case DV:f.anchor={x:o-u,y:u,column:Fn};break;case MV:f.anchor={x:u,y:a-u,row:Fn};break;case NV:f.anchor={x:o-u,y:a-u,column:Fn,row:Fn};break}return f}function oY(e,t){var n=t.items[0],i=n.datum,r=n.orient,o=n.bounds,a=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),sY(e,n,n.items[0].items[0]),o=aY(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),i.type===PV&&uY(n.items[0].items[0].items[0].items),r!==m2&&(n.x=a=0,n.y=s=0),n.width=u,n.height=l,No(o.set(a,s,a+u,s+l),n),n.mark.bounds.clear().union(o),n}function aY(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function sY(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(!t.datum.title)(r||o)&&ld(e,n,r,o);else{var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=i-a.x,c=i-a.y;switch(a.orient){case ar:r+=Math.ceil(a.bounds.width())+u;break;case sr:case Ua:break;default:o+=a.bounds.height()+u}switch((r||o)&&ld(e,n,r,o),a.orient){case ar:c+=Il(t,n,a,s,1,1);break;case sr:l+=Il(t,n,a,Fn,0,0)+u,c+=Il(t,n,a,s,1,1);break;case Ua:l+=Il(t,n,a,s,0,0),c+=Il(t,n,a,Fn,-1,0,1)+u;break;default:l+=Il(t,n,a,s,0,0)}(l||c)&&ld(e,a,l,c),(l=Math.round(a.bounds.x1-i))<0&&(ld(e,n,-l,0),ld(e,a,-l,0))}}function Il(e,t,n,i,r,o,a){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(o||!u)&&!a?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=r<=0?0:qx(n);return Math.round(i===f2?f:i===Fn?d-h:.5*(c-h))}function ld(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function uY(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function lY(e,t,n,i,r){var o=t.items[0],a=o.frame,s=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=s===ar||s===sr?i:n,g=0,p=0,m=0,y=0,v=0,x;if(a!==qp?s===ar?(g=r.y2,h=r.y1):s===sr?(g=r.y1,h=r.y2):(g=r.x1,h=r.x2):s===ar&&(g=i,h=0),x=u===f2?g:u===Fn?h:(g+h)/2,d&&d.text){switch(s){case $l:case Ua:v=f.bounds.height()+c;break;case ar:y=f.bounds.width()+c;break;case sr:y=-f.bounds.width()-c;break}xn.clear().union(d.bounds),xn.translate(y-(d.x||0),v-(d.y||0)),Ll(d,"x",y)|Ll(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(xn),d.mark.bounds.clear().union(xn),e.dirty(d)),xn.clear().union(d.bounds)}else xn.clear();switch(xn.union(f.bounds),s){case $l:p=x,m=r.y1-xn.height()-l;break;case ar:p=r.x1-xn.width()-l,m=x;break;case sr:p=r.x2+xn.width()+l,m=x;break;case Ua:p=x,m=r.y2+l;break;default:p=o.x,m=o.y}return Ll(o,"x",p)|Ll(o,"y",m)&&(xn.translate(p,m),e.dirty(o),o.bounds.clear().union(xn),t.bounds.clear().union(xn),e.dirty(o)),o.bounds}function B3(e){R.call(this,null,e)}W(B3,R,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&ZV(n,i,e.layout),fY(n,i,e)}),cY(e.mark.group)?t.reflow():t}});function cY(e){return e&&e.mark.role!=="legend-entry"}function fY(e,t,n){var i=t.items,r=Math.max(0,t.width||0),o=Math.max(0,t.height||0),a=new Nt().set(0,0,r,o),s=a.clone(),u=a.clone(),l=[],c,f,d,h,g,p;for(g=0,p=i.length;g<p;++g)switch(f=i[g],f.role){case h2:h=VV(f)?s:u,h.union(XV(e,f,r,o));break;case g2:c=f;break;case p2:l.push(oY(e,f));break;case $V:case LV:case b3:case x3:case w3:case _3:case E3:case O3:s.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||sr,d!==m2&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];P3(e,v,rY(v,y,n.legends,s,u,r,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===S3)switch(y.orient){case ar:case sr:a.add(v.x1,0).add(v.x2,0);break;case $l:case Ua:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(s).union(u),c&&a.union(lY(e,c,r,o,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),dY(e,t,a,n)}function dY(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===IV){const g=e.padding();a-=g.left+g.right,s-=g.top+g.bottom}o===m2?(l=0,f=0,u=a,c=s):o===S3?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===zV?(u=Math.max(0,a-l-d),s=c+f+h):o===BV?(a=u+l+d,c=Math.max(0,s-f-h)):o===UV&&(a=u+l+d,s=c+f+h),e._resizeView(a,s,u,c,[l,f],r.resize)}var hY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:A3,identifier:b2,mark:C3,overlap:T3,render:j3,viewlayout:B3});function U3(e){R.call(this,null,e)}W(U3,R,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,s=hx(o,a,e.minstep),u=e.format||qD(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?UD(o,e.values,s):gx(o,s);return r&&(i.rem=r),r=l.map((c,f)=>Ue({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ue({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function q3(e){R.call(this,null,e)}function gY(){return Ue({})}function pY(e){const t=ol().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}W(q3,R,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||gY,o=e.key||ae,a=this.value;return P(i.encode)&&(i.encode=null),a&&(e.modified("key")||t.modified(o))&&L("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=pY(o)),t.visit(t.ADD,s=>{const u=o(s);let l=a.get(u);l?l.exit?(a.empty--,i.add.push(l)):i.mod.push(l):(l=r(s),a.set(u,l),i.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=o(s),l=a.get(u);l&&(l.datum=s,i.mod.push(l))}),t.visit(t.REM,s=>{const u=o(s),l=a.get(u);s===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),i}});function W3(e){R.call(this,null,e)}W(W3,R,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(P(o))if(n.changed()||o.every(f=>r[f]))o=o[0],n.encode=null;else return t.StopPropagation;var a=o==="enter",s=r.update||da,u=r.enter||da,l=r.exit||da,c=(o&&!a?r[o]:s)||da;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==da&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==da&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==da){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function H3(e){R.call(this,[],e)}W(H3,R,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.type||gp,a=e.scale,s=+e.limit,u=hx(a,e.count==null?5:e.count,e.minstep),l=!!e.values||o===gp,c=e.format||VD(n,a,u,o,e.formatSpecifier,e.formatType,l),f=e.values||GD(a,u),d,h,g,p,m;return r&&(i.rem=r),o===gp?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,s-1),m=!0):r=f,_e(g=e.size)?(!e.values&&a(r[0])===0&&(r=r.slice(1)),p=r.reduce((y,v)=>Math.max(y,g(v,e)),0)):g=gn(p=g||8),r=r.map((y,v)=>Ue({index:v,label:c(y,v,r),value:y,offset:p,size:g(y,e)})),m&&(m=f[r.length],r.push(Ue({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:p,size:g(m,e)})))):o===GW?(d=a.domain(),h=ID(a,d[0],Fe(d)),f.length<3&&!e.values&&d[0]!==Fe(d)&&(f=[d[0],Fe(d)]),r=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(g=f.length-1,h=iH(a),r=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===g?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const mY=e=>e.source.x,yY=e=>e.source.y,vY=e=>e.target.x,bY=e=>e.target.y;function x2(e){R.call(this,{},e)}x2.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};W(x2,R,{transform(e,t){var n=e.sourceX||mY,i=e.sourceY||yY,r=e.targetX||vY,o=e.targetY||bY,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=X3.get(u+"-"+s)||X3.get(u);return l||L("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),i(c),r(c),o(c))}),t.reflow(e.modified()).modifies(a)}});const G3=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,xY=(e,t,n,i)=>G3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),V3=(e,t,n,i)=>{var r=n-e,o=i-t,a=Math.sqrt(r*r+o*o)/2,s=180*Math.atan2(o,r)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+i},wY=(e,t,n,i)=>V3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),Y3=(e,t,n,i)=>{const r=n-e,o=i-t,a=.2*(r+o),s=.2*(o-r);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(i-a)+" "+n+","+i},_Y=(e,t,n,i)=>Y3(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),EY=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,OY=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,SY=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+i*a+","+i*s},AY=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},kY=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},CY=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*o+"C"+u*r+","+u*o+" "+u*a+","+u*s+" "+i*a+","+i*s},X3=ol({line:G3,"line-radial":xY,arc:V3,"arc-radial":wY,curve:Y3,"curve-radial":_Y,"orthogonal-horizontal":EY,"orthogonal-vertical":OY,"orthogonal-radial":SY,"diagonal-horizontal":AY,"diagonal-vertical":kY,"diagonal-radial":CY});function w2(e){R.call(this,null,e)}w2.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};W(w2,R,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.field||nl,a=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=a,d=(s-a)/jk(l),h=yi(c),g,p,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[i]=f,p[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const TY=5;function FY(e){const t=e.type;return!e.bins&&(t===Sl||t===Bf||t===Uf)}function K3(e){return lx(e)&&e!==zr}const DY=er(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function J3(e){R.call(this,null,e),this.modified(!0)}W(J3,R,{transform(e,t){var n=t.dataflow,i=this.value,r=MY(e);(!i||r!==i.type)&&(this.value=i=Ie(r)());for(r in e)if(!DY[r]){if(r==="padding"&&K3(i.type))continue;_e(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return IY(i,e,LY(i,e,RY(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function MY(e){var t=e.type,n="",i;return t===zr?zr+"-"+Sl:(NY(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?zr+"-":i===3?Al+"-":""),(n+t||Sl).toLowerCase())}function NY(e){const t=e.type;return lx(t)&&t!==Bs&&t!==Us&&(e.scheme||e.range&&e.range.length&&e.range.every(K))}function RY(e,t,n){const i=jY(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,o=e.type,a=t.zero||t.zero===void 0&&FY(e),s,u;if(!r)return 0;if(K3(o)&&t.padding&&r[0]!==Fe(r)&&(r=$Y(o,r,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(r=r.slice()).length-1||1,a&&(r[0]>0&&(r[0]=0),r[s]<0&&(r[s]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[s]?s+1:u<r[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain(Q3(o,r,n)),o===rx&&e.unknown(t.domainImplicit?Tb:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&hx(e,t.nice)||null),r.length}function jY(e,t,n){return t?(e.domain(Q3(e.type,t,n)),t.length):-1}function $Y(e,t,n,i,r,o){var a=Math.abs(Fe(n)-n[0]),s=a/(a-2*i),u=e===Do?ky(t,null,s):e===Uf?gg(t,null,s,.5):e===Bf?gg(t,null,s,r||1):e===lp?Cy(t,null,s,o||1):Ay(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function Q3(e,t,n){if(ND(e)){var i=Math.abs(t.reduce((r,o)=>r+(o<0?-1:o>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+H(t))}return t}function LY(e,t,n){let i=t.bins;if(i&&!P(i)){const r=e.domain(),o=r[0],a=Fe(r),s=i.step;let u=i.start==null?o:i.start,l=i.stop==null?a:i.stop;s||L("Scale bins parameter missing step property."),u<o&&(u=s*Math.ceil(o/s)),l>a&&(l=s*Math.floor(a/s)),i=yi(u,l+s/2,s)}return i?e.bins=i:e.bins&&delete e.bins,e.type===ax&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function IY(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(t.rangeStep!=null)o=PY(i,t,n);else if(t.scheme&&(o=zY(i,t,n),_e(o))){if(e.interpolator)return e.interpolator(o);L("Scale type ".concat(i," does not support interpolating color schemes."))}if(o&&RD(i))return e.interpolator(hp(_2(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(fx(t.interpolate,t.interpolateGamma)):_e(e.round)?e.round(r):_e(e.rangeRound)&&e.interpolate(r?Pf:Fa),o&&e.range(_2(o,t.reverse))}function PY(e,t,n){e!==TD&&e!==ox&&L("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===ox?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*ix(n,r,i)]}function zY(e,t,n){var i=t.schemeExtent,r,o;return P(t.scheme)?o=hp(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),o=dx(r),o||L("Unrecognized scheme name: ".concat(t.scheme))),n=e===fp?n+1:e===ax?n-1:e===kl||e===cp?+t.schemeCount||TY:n,RD(e)?Z3(o,i,t.reverse):_e(o)?LD(Z3(o,i),n):e===rx?o:o.slice(0,n)}function Z3(e,t,n){return _e(e)&&(t||n)?$D(e,_2(t||[0,1],n)):e}function _2(e,t){return t?e.slice().reverse():e}function eN(e){R.call(this,null,e)}W(eN,R,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Ns(e.sort)),this.modified(n),t}});const tN="zero",nN="center",iN="normalize",rN=["y0","y1"];function E2(e){R.call(this,null,e)}E2.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:tN,values:[tN,nN,iN]},{name:"as",type:"string",array:!0,length:2,default:rN}]};W(E2,R,{transform(e,t){var n=e.as||rN,i=n[0],r=n[1],o=Ns(e.sort),a=e.field||nl,s=e.offset===nN?BY:e.offset===iN?UY:qY,u,l,c,f;for(u=WY(t.source,e.groupby,o,a),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,a,i,r);return t.reflow(e.modified()).modifies(n)}});function BY(e,t,n,i,r){for(var o=(t-e.sum)/2,a=e.length,s=0,u;s<a;++s)u=e[s],u[i]=o,u[r]=o+=Math.abs(n(u))}function UY(e,t,n,i,r){for(var o=1/e.sum,a=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[i]=a,c[r]=a=o*(l+=Math.abs(n(c)))}function qY(e,t,n,i,r){for(var o=0,a=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[i]=a,c[r]=a+=l):(c[i]=o,c[r]=o+=l)}function WY(e,t,n,i){var r=[],o=p=>p(c),a,s,u,l,c,f,d,h,g;if(t==null)r.push(e.slice());else for(a={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(o),d=a[f],d||(a[f]=d=[],r.push(d)),d.push(c);for(f=0,g=0,l=r.length;f<l;++f){for(d=r[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(i(d[s]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return r.max=g,r}var HY=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:U3,datajoin:q3,encode:W3,legendentries:H3,linkpath:x2,pie:w2,scale:J3,sortitems:eN,stack:E2}),le=1e-6,Yp=1e-12,Se=Math.PI,vt=Se/2,Xp=Se/4,Dn=Se*2,_t=180/Se,Ae=Se/180,Ne=Math.abs,Pl=Math.atan,ji=Math.atan2,ce=Math.cos,Kp=Math.ceil,oN=Math.exp,O2=Math.hypot,Jp=Math.log,S2=Math.pow,se=Math.sin,$i=Math.sign||function(e){return e>0?1:e<0?-1:0},Mn=Math.sqrt,A2=Math.tan;function aN(e){return e>1?0:e<-1?Se:Math.acos(e)}function Qn(e){return e>1?vt:e<-1?-vt:Math.asin(e)}function en(){}function Qp(e,t){e&&uN.hasOwnProperty(e.type)&&uN[e.type](e,t)}var sN={Feature:function(e,t){Qp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)Qp(n[i].geometry,t)}},uN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){k2(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)k2(n[i],t,0)},Polygon:function(e,t){lN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)lN(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)Qp(n[i],t)}};function k2(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function lN(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)k2(e[n],t,1);t.polygonEnd()}function jo(e,t){e&&sN.hasOwnProperty(e.type)?sN[e.type](e,t):Qp(e,t)}var Zp=new Cn,em=new Cn,cN,fN,C2,T2,F2,Gr={point:en,lineStart:en,lineEnd:en,polygonStart:function(){Zp=new Cn,Gr.lineStart=GY,Gr.lineEnd=VY},polygonEnd:function(){var e=+Zp;em.add(e<0?Dn+e:e),this.lineStart=this.lineEnd=this.point=en},sphere:function(){em.add(Dn)}};function GY(){Gr.point=YY}function VY(){dN(cN,fN)}function YY(e,t){Gr.point=dN,cN=e,fN=t,e*=Ae,t*=Ae,C2=e,T2=ce(t=t/2+Xp),F2=se(t)}function dN(e,t){e*=Ae,t*=Ae,t=t/2+Xp;var n=e-C2,i=n>=0?1:-1,r=i*n,o=ce(t),a=se(t),s=F2*a,u=T2*o+s*ce(r),l=s*i*se(r);Zp.add(ji(l,u)),C2=e,T2=o,F2=a}function XY(e){return em=new Cn,jo(e,Gr),em*2}function tm(e){return[ji(e[1],e[0]),Qn(e[2])]}function Xs(e){var t=e[0],n=e[1],i=ce(n);return[i*ce(t),i*se(t),se(n)]}function nm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function D2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function im(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function rm(e){var t=Mn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var gt,Zn,bt,wi,Ks,hN,gN,Bl,cd,Ha,$o,Lo={point:M2,lineStart:mN,lineEnd:yN,polygonStart:function(){Lo.point=vN,Lo.lineStart=KY,Lo.lineEnd=JY,cd=new Cn,Gr.polygonStart()},polygonEnd:function(){Gr.polygonEnd(),Lo.point=M2,Lo.lineStart=mN,Lo.lineEnd=yN,Zp<0?(gt=-(bt=180),Zn=-(wi=90)):cd>le?wi=90:cd<-le&&(Zn=-90),$o[0]=gt,$o[1]=bt},sphere:function(){gt=-(bt=180),Zn=-(wi=90)}};function M2(e,t){Ha.push($o=[gt=e,bt=e]),t<Zn&&(Zn=t),t>wi&&(wi=t)}function pN(e,t){var n=Xs([e*Ae,t*Ae]);if(Bl){var i=zl(Bl,n),r=[i[1],-i[0],0],o=zl(r,i);rm(o),o=tm(o);var a=e-Ks,s=a>0?1:-1,u=o[0]*_t*s,l,c=Ne(a)>180;c^(s*Ks<u&&u<s*e)?(l=o[1]*_t,l>wi&&(wi=l)):(u=(u+360)%360-180,c^(s*Ks<u&&u<s*e)?(l=-o[1]*_t,l<Zn&&(Zn=l)):(t<Zn&&(Zn=t),t>wi&&(wi=t))),c?e<Ks?_i(gt,e)>_i(gt,bt)&&(bt=e):_i(e,bt)>_i(gt,bt)&&(gt=e):bt>=gt?(e<gt&&(gt=e),e>bt&&(bt=e)):e>Ks?_i(gt,e)>_i(gt,bt)&&(bt=e):_i(e,bt)>_i(gt,bt)&&(gt=e)}else Ha.push($o=[gt=e,bt=e]);t<Zn&&(Zn=t),t>wi&&(wi=t),Bl=n,Ks=e}function mN(){Lo.point=pN}function yN(){$o[0]=gt,$o[1]=bt,Lo.point=M2,Bl=null}function vN(e,t){if(Bl){var n=e-Ks;cd.add(Ne(n)>180?n+(n>0?360:-360):n)}else hN=e,gN=t;Gr.point(e,t),pN(e,t)}function KY(){Gr.lineStart()}function JY(){vN(hN,gN),Gr.lineEnd(),Ne(cd)>le&&(gt=-(bt=180)),$o[0]=gt,$o[1]=bt,Bl=null}function _i(e,t){return(t-=e)<0?t+360:t}function QY(e,t){return e[0]-t[0]}function bN(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function ZY(e){var t,n,i,r,o,a,s;if(wi=bt=-(gt=Zn=1/0),Ha=[],jo(e,Lo),n=Ha.length){for(Ha.sort(QY),t=1,i=Ha[0],o=[i];t<n;++t)r=Ha[t],bN(i,r[0])||bN(i,r[1])?(_i(i[0],r[1])>_i(i[0],i[1])&&(i[1]=r[1]),_i(r[0],i[1])>_i(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,n=o.length-1,t=0,i=o[n];t<=n;i=r,++t)r=o[t],(s=_i(i[1],r[0]))>a&&(a=s,gt=r[0],bt=i[1])}return Ha=$o=null,gt===1/0||Zn===1/0?[[NaN,NaN],[NaN,NaN]]:[[gt,Zn],[bt,wi]]}var fd,om,am,sm,um,lm,cm,fm,N2,R2,j2,xN,wN,Nn,Rn,jn,ur={sphere:en,point:$2,lineStart:_N,lineEnd:EN,polygonStart:function(){ur.lineStart=nX,ur.lineEnd=iX},polygonEnd:function(){ur.lineStart=_N,ur.lineEnd=EN}};function $2(e,t){e*=Ae,t*=Ae;var n=ce(t);dd(n*ce(e),n*se(e),se(t))}function dd(e,t,n){++fd,am+=(e-am)/fd,sm+=(t-sm)/fd,um+=(n-um)/fd}function _N(){ur.point=eX}function eX(e,t){e*=Ae,t*=Ae;var n=ce(t);Nn=n*ce(e),Rn=n*se(e),jn=se(t),ur.point=tX,dd(Nn,Rn,jn)}function tX(e,t){e*=Ae,t*=Ae;var n=ce(t),i=n*ce(e),r=n*se(e),o=se(t),a=ji(Mn((a=Rn*o-jn*r)*a+(a=jn*i-Nn*o)*a+(a=Nn*r-Rn*i)*a),Nn*i+Rn*r+jn*o);om+=a,lm+=a*(Nn+(Nn=i)),cm+=a*(Rn+(Rn=r)),fm+=a*(jn+(jn=o)),dd(Nn,Rn,jn)}function EN(){ur.point=$2}function nX(){ur.point=rX}function iX(){ON(xN,wN),ur.point=$2}function rX(e,t){xN=e,wN=t,e*=Ae,t*=Ae,ur.point=ON;var n=ce(t);Nn=n*ce(e),Rn=n*se(e),jn=se(t),dd(Nn,Rn,jn)}function ON(e,t){e*=Ae,t*=Ae;var n=ce(t),i=n*ce(e),r=n*se(e),o=se(t),a=Rn*o-jn*r,s=jn*i-Nn*o,u=Nn*r-Rn*i,l=O2(a,s,u),c=Qn(l),f=l&&-c/l;N2.add(f*a),R2.add(f*s),j2.add(f*u),om+=c,lm+=c*(Nn+(Nn=i)),cm+=c*(Rn+(Rn=r)),fm+=c*(jn+(jn=o)),dd(Nn,Rn,jn)}function oX(e){fd=om=am=sm=um=lm=cm=fm=0,N2=new Cn,R2=new Cn,j2=new Cn,jo(e,ur);var t=+N2,n=+R2,i=+j2,r=O2(t,n,i);return r<Yp&&(t=lm,n=cm,i=fm,om<le&&(t=am,n=sm,i=um),r=O2(t,n,i),r<Yp)?[NaN,NaN]:[ji(n,t)*_t,Qn(i/r)*_t]}function L2(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function I2(e,t){return[Ne(e)>Se?e+Math.round(-e/Dn)*Dn:e,t]}I2.invert=I2;function SN(e,t,n){return(e%=Dn)?t||n?L2(kN(e),CN(t,n)):kN(e):t||n?CN(t,n):I2}function AN(e){return function(t,n){return t+=e,[t>Se?t-Dn:t<-Se?t+Dn:t,n]}}function kN(e){var t=AN(e);return t.invert=AN(-e),t}function CN(e,t){var n=ce(e),i=se(e),r=ce(t),o=se(t);function a(s,u){var l=ce(u),c=ce(s)*l,f=se(s)*l,d=se(u),h=d*n+c*i;return[ji(f*r-h*o,c*n-d*i),Qn(h*r+f*o)]}return a.invert=function(s,u){var l=ce(u),c=ce(s)*l,f=se(s)*l,d=se(u),h=d*r-f*o;return[ji(f*r+d*o,c*n+h*i),Qn(h*n-c*i)]},a}function aX(e){e=SN(e[0]*Ae,e[1]*Ae,e.length>2?e[2]*Ae:0);function t(n){return n=e(n[0]*Ae,n[1]*Ae),n[0]*=_t,n[1]*=_t,n}return t.invert=function(n){return n=e.invert(n[0]*Ae,n[1]*Ae),n[0]*=_t,n[1]*=_t,n},t}function sX(e,t,n,i,r,o){if(!!n){var a=ce(t),s=se(t),u=i*n;r==null?(r=t+i*Dn,o=t-u/2):(r=TN(a,r),o=TN(a,o),(i>0?r<o:r>o)&&(r+=i*Dn));for(var l,c=r;i>0?c>o:c<o;c-=u)l=tm([a,-s*ce(c),-s*se(c)]),e.point(l[0],l[1])}}function TN(e,t){t=Xs(t),t[0]-=e,rm(t);var n=aN(-t[1]);return((-t[2]<0?-n:n)+Dn-le)%Dn}function FN(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:en,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function dm(e,t){return Ne(e[0]-t[0])<le&&Ne(e[1]-t[1])<le}function hm(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function DN(e,t,n,i,r){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(dm(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),s=0;s<p;++s)r.point((m=g[s])[0],m[1]);r.lineEnd();return}y[0]+=2*le}o.push(v=new hm(m,g,null,!0)),a.push(v.o=new hm(m,null,v,!1)),o.push(v=new hm(y,g,null,!1)),a.push(v.o=new hm(y,null,v,!0))}}),!!o.length){for(a.sort(t),MN(o),MN(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)r.point((f=c[s])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)r.point((f=c[s])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function MN(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function P2(e){return Ne(e[0])<=Se?e[0]:$i(e[0])*((Ne(e[0])+Se)%Dn-Se)}function uX(e,t){var n=P2(t),i=t[1],r=se(i),o=[se(n),-ce(n),0],a=0,s=0,u=new Cn;r===1?i=vt+le:r===-1&&(i=-vt-le);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=P2(h),p=h[1]/2+Xp,m=se(p),y=ce(p),v=0;v<d;++v,g=b,m=E,y=w,h=x){var x=f[v],b=P2(x),_=x[1]/2+Xp,E=se(_),w=ce(_),O=b-g,S=O>=0?1:-1,k=S*O,A=k>Se,F=m*E;if(u.add(ji(F*S*se(k),y*w+F*ce(k))),a+=A?O+S*Dn:O,A^g>=n^b>=n){var C=zl(Xs(h),Xs(x));rm(C);var M=zl(o,C);rm(M);var D=(A^O>=0?-1:1)*Qn(M[2]);(i>D||i===D&&(C[0]||C[1]))&&(s+=A^O>=0?1:-1)}}return(a<-le||a<le&&u<-Yp)^s&1}function NN(e,t,n,i){return function(r){var o=t(r),a=FN(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=Rk(c);var b=uX(l,i);c.length?(u||(r.polygonStart(),u=!0),DN(c,cX,b,n,r)):b&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(b,_){e(b,_)&&r.point(b,_)}function g(b,_){o.point(b,_)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(b,_){f.push([b,_]),s.point(b,_)}function v(){s.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),s.lineEnd();var b=s.clean(),_=a.result(),E,w=_.length,O,S,k;if(f.pop(),l.push(f),f=null,!!w){if(b&1){if(S=_[0],(O=S.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),E=0;E<O;++E)r.point((k=S[E])[0],k[1]);r.lineEnd()}return}w>1&&b&2&&_.push(_.pop().concat(_.shift())),c.push(_.filter(lX))}}return d}}function lX(e){return e.length>1}function cX(e,t){return((e=e.x)[0]<0?e[1]-vt-le:vt-e[1])-((t=t.x)[0]<0?t[1]-vt-le:vt-t[1])}var RN=NN(function(){return!0},fX,hX,[-Se,-vt]);function fX(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,a){var s=o>0?Se:-Se,u=Ne(o-t);Ne(u-Se)<le?(e.point(t,n=(n+a)/2>0?vt:-vt),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),r=0):i!==s&&u>=Se&&(Ne(t-i)<le&&(t-=i*le),Ne(o-s)<le&&(o-=s*le),n=dX(t,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),r=0),e.point(t=o,n=a),i=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function dX(e,t,n,i){var r,o,a=se(e-n);return Ne(a)>le?Pl((se(t)*(o=ce(i))*se(n)-se(i)*(r=ce(t))*se(e))/(r*o*a)):(t+i)/2}function hX(e,t,n,i){var r;if(e==null)r=n*vt,i.point(-Se,r),i.point(0,r),i.point(Se,r),i.point(Se,0),i.point(Se,-r),i.point(0,-r),i.point(-Se,-r),i.point(-Se,0),i.point(-Se,r);else if(Ne(e[0]-t[0])>le){var o=e[0]<t[0]?Se:-Se;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function gX(e){var t=ce(e),n=6*Ae,i=t>0,r=Ne(t)>le;function o(c,f,d,h){sX(h,e,n,d,c,f)}function a(c,f){return ce(c)*ce(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],x,b=a(m,y),_=i?b?0:l(m,y):b?l(m+(m<0?Se:-Se),y):0;if(!f&&(g=h=b)&&c.lineStart(),b!==h&&(x=u(f,v),(!x||dm(f,x)||dm(v,x))&&(v[2]=1)),b!==h)p=0,b?(c.lineStart(),x=u(v,f),c.point(x[0],x[1])):(x=u(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(r&&f&&i^b){var E;!(_&d)&&(E=u(v,f,!0))&&(p=0,i?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}b&&(!f||!dm(f,v))&&c.point(v[0],v[1]),f=v,h=b,d=_},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=Xs(c),g=Xs(f),p=[1,0,0],m=zl(h,g),y=nm(m,m),v=m[0],x=y-v*v;if(!x)return!d&&c;var b=t*y/x,_=-t*v/x,E=zl(p,m),w=im(p,b),O=im(m,_);D2(w,O);var S=E,k=nm(w,S),A=nm(S,S),F=k*k-A*(nm(w,w)-1);if(!(F<0)){var C=Mn(F),M=im(S,(-k-C)/A);if(D2(M,w),M=tm(M),!d)return M;var D=c[0],N=f[0],I=c[1],z=f[1],X;N<D&&(X=D,D=N,N=X);var te=N-D,xe=Ne(te-Se)<le,ge=xe||te<le;if(!xe&&z<I&&(X=I,I=z,z=X),ge?xe?I+z>0^M[1]<(Ne(M[0]-D)<le?I:z):I<=M[1]&&M[1]<=z:te>Se^(D<=M[0]&&M[0]<=N)){var je=im(S,(-k+C)/A);return D2(je,w),[M,tm(je)]}}}function l(c,f){var d=i?e:Se-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return NN(a,s,o,i?[0,-e]:[-Se,e-Se])}function pX(e,t,n,i,r,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var hd=1e9,gm=-hd;function jN(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return Ne(l[0]-e)<le?c>0?0:3:Ne(l[0]-n)<le?c>0?2:1:Ne(l[1]-t)<le?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=FN(),d,h,g,p,m,y,v,x,b,_,E,w={point:O,lineStart:F,lineEnd:C,polygonStart:k,polygonEnd:A};function O(D,N){r(D,N)&&c.point(D,N)}function S(){for(var D=0,N=0,I=h.length;N<I;++N)for(var z=h[N],X=1,te=z.length,xe=z[0],ge,je,Oe=xe[0],ke=xe[1];X<te;++X)ge=Oe,je=ke,xe=z[X],Oe=xe[0],ke=xe[1],je<=i?ke>i&&(Oe-ge)*(i-je)>(ke-je)*(e-ge)&&++D:ke<=i&&(Oe-ge)*(i-je)<(ke-je)*(e-ge)&&--D;return D}function k(){c=f,d=[],h=[],E=!0}function A(){var D=S(),N=E&&D,I=(d=Rk(d)).length;(N||I)&&(l.polygonStart(),N&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),I&&DN(d,s,D,o,l),l.polygonEnd()),c=l,d=h=g=null}function F(){w.point=M,h&&h.push(g=[]),_=!0,b=!1,v=x=NaN}function C(){d&&(M(p,m),y&&b&&f.rejoin(),d.push(f.result())),w.point=O,b&&c.lineEnd()}function M(D,N){var I=r(D,N);if(h&&g.push([D,N]),_)p=D,m=N,y=I,_=!1,I&&(c.lineStart(),c.point(D,N));else if(I&&b)c.point(D,N);else{var z=[v=Math.max(gm,Math.min(hd,v)),x=Math.max(gm,Math.min(hd,x))],X=[D=Math.max(gm,Math.min(hd,D)),N=Math.max(gm,Math.min(hd,N))];pX(z,X,e,t,n,i)?(b||(c.lineStart(),c.point(z[0],z[1])),c.point(X[0],X[1]),I||c.lineEnd(),E=!1):I&&(c.lineStart(),c.point(D,N),E=!1)}v=D,x=N,b=I}return w}}function $N(e,t,n){var i=yi(e,t-le,n).concat(t);return function(r){return i.map(function(o){return[r,o]})}}function LN(e,t,n){var i=yi(e,t-le,n).concat(t);return function(r){return i.map(function(o){return[o,r]})}}function mX(){var e,t,n,i,r,o,a,s,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return yi(Kp(i/c)*c,n,c).map(g).concat(yi(Kp(s/f)*f,a,f).map(p)).concat(yi(Kp(t/u)*u,e,u).filter(function(x){return Ne(x%c)>le}).map(d)).concat(yi(Kp(o/l)*l,r,l).filter(function(x){return Ne(x%f)>le}).map(h))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(p(a).slice(1),g(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(i=+x[0][0],n=+x[1][0],s=+x[0][1],a=+x[1][1],i>n&&(x=i,i=n,n=x),s>a&&(x=s,s=a,a=x),y.precision(m)):[[i,s],[n,a]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],r=+x[1][1],t>e&&(x=t,t=e,e=x),o>r&&(x=o,o=r,r=x),y.precision(m)):[[t,o],[e,r]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],y):[c,f]},y.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],y):[u,l]},y.precision=function(x){return arguments.length?(m=+x,d=$N(o,r,90),h=LN(t,e,m),g=$N(s,a,90),p=LN(i,n,m),y):m},y.extentMajor([[-180,-90+le],[180,90-le]]).extentMinor([[-180,-80-le],[180,80+le]])}var gd=e=>e,z2=new Cn,B2=new Cn,IN,PN,U2,q2,Ga={point:en,lineStart:en,lineEnd:en,polygonStart:function(){Ga.lineStart=yX,Ga.lineEnd=bX},polygonEnd:function(){Ga.lineStart=Ga.lineEnd=Ga.point=en,z2.add(Ne(B2)),B2=new Cn},result:function(){var e=z2/2;return z2=new Cn,e}};function yX(){Ga.point=vX}function vX(e,t){Ga.point=zN,IN=U2=e,PN=q2=t}function zN(e,t){B2.add(q2*e-U2*t),U2=e,q2=t}function bX(){zN(IN,PN)}var BN=Ga,Ul=1/0,pm=Ul,pd=-Ul,mm=pd,xX={point:wX,lineStart:en,lineEnd:en,polygonStart:en,polygonEnd:en,result:function(){var e=[[Ul,pm],[pd,mm]];return pd=mm=-(pm=Ul=1/0),e}};function wX(e,t){e<Ul&&(Ul=e),e>pd&&(pd=e),t<pm&&(pm=t),t>mm&&(mm=t)}var ym=xX,W2=0,H2=0,md=0,vm=0,bm=0,ql=0,G2=0,V2=0,yd=0,UN,qN,Vr,Yr,lr={point:Js,lineStart:WN,lineEnd:HN,polygonStart:function(){lr.lineStart=OX,lr.lineEnd=SX},polygonEnd:function(){lr.point=Js,lr.lineStart=WN,lr.lineEnd=HN},result:function(){var e=yd?[G2/yd,V2/yd]:ql?[vm/ql,bm/ql]:md?[W2/md,H2/md]:[NaN,NaN];return W2=H2=md=vm=bm=ql=G2=V2=yd=0,e}};function Js(e,t){W2+=e,H2+=t,++md}function WN(){lr.point=_X}function _X(e,t){lr.point=EX,Js(Vr=e,Yr=t)}function EX(e,t){var n=e-Vr,i=t-Yr,r=Mn(n*n+i*i);vm+=r*(Vr+e)/2,bm+=r*(Yr+t)/2,ql+=r,Js(Vr=e,Yr=t)}function HN(){lr.point=Js}function OX(){lr.point=AX}function SX(){GN(UN,qN)}function AX(e,t){lr.point=GN,Js(UN=Vr=e,qN=Yr=t)}function GN(e,t){var n=e-Vr,i=t-Yr,r=Mn(n*n+i*i);vm+=r*(Vr+e)/2,bm+=r*(Yr+t)/2,ql+=r,r=Yr*e-Vr*t,G2+=r*(Vr+e),V2+=r*(Yr+t),yd+=r*3,Js(Vr=e,Yr=t)}var VN=lr;function YN(e){this._context=e}YN.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Dn);break}}},result:en};var Y2=new Cn,X2,XN,KN,vd,bd,xm={point:en,lineStart:function(){xm.point=kX},lineEnd:function(){X2&&JN(XN,KN),xm.point=en},polygonStart:function(){X2=!0},polygonEnd:function(){X2=null},result:function(){var e=+Y2;return Y2=new Cn,e}};function kX(e,t){xm.point=JN,XN=vd=e,KN=bd=t}function JN(e,t){vd-=e,bd-=t,Y2.add(Mn(vd*vd+bd*bd)),vd=e,bd=t}var QN=xm;function ZN(){this._string=[]}ZN.prototype={_radius:4.5,_circle:e5(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=e5(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function e5(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function t5(e,t){var n=4.5,i,r;function o(a){return a&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),jo(a,i(r))),r.result()}return o.area=function(a){return jo(a,i(BN)),BN.result()},o.measure=function(a){return jo(a,i(QN)),QN.result()},o.bounds=function(a){return jo(a,i(ym)),ym.result()},o.centroid=function(a){return jo(a,i(VN)),VN.result()},o.projection=function(a){return arguments.length?(i=a==null?(e=null,gd):(e=a).stream,o):e},o.context=function(a){return arguments.length?(r=a==null?(t=null,new ZN):new YN(t=a),typeof n!="function"&&r.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(r.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function wm(e){return function(t){var n=new K2;for(var i in e)n[i]=e[i];return n.stream=t,n}}function K2(){}K2.prototype={constructor:K2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function J2(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),jo(n,e.stream(ym)),t(ym.result()),i!=null&&e.clipExtent(i),e}function _m(e,t,n){return J2(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(o-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function Q2(e,t,n){return _m(e,[[0,0],t],n)}function Z2(e,t,n){return J2(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];e.scale(150*o).translate([a,s])},n)}function ew(e,t,n){return J2(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var n5=16,CX=ce(30*Ae);function i5(e,t){return+t?FX(e,t):TX(e)}function TX(e){return wm({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function FX(e,t){function n(i,r,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-i,v=c-r,x=y*y+v*v;if(x>4*t&&p--){var b=a+d,_=s+h,E=u+g,w=Mn(b*b+_*_+E*E),O=Qn(E/=w),S=Ne(Ne(E)-1)<le||Ne(o-f)<le?(o+f)/2:ji(_,b),k=e(S,O),A=k[0],F=k[1],C=A-i,M=F-r,D=v*C-y*M;(D*D/x>t||Ne((y*C+v*M)/x-.5)>.3||a*d+s*h+u*g<CX)&&(n(i,r,o,a,s,u,A,F,S,b/=w,_/=w,E,p,m),m.point(A,F),n(A,F,S,b,_,E,l,c,f,d,h,g,p,m))}}return function(i){var r,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:b,polygonStart:function(){i.polygonStart(),m.lineStart=_},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y(O,S){O=e(O,S),i.point(O[0],O[1])}function v(){f=NaN,m.point=x,i.lineStart()}function x(O,S){var k=Xs([O,S]),A=e(O,S);n(f,d,c,h,g,p,f=A[0],d=A[1],c=O,h=k[0],g=k[1],p=k[2],n5,i),i.point(f,d)}function b(){m.point=y,i.lineEnd()}function _(){v(),m.point=E,m.lineEnd=w}function E(O,S){x(r=O,S),o=f,a=d,s=h,u=g,l=p,m.point=x}function w(){n(f,d,c,h,g,p,o,a,r,s,u,l,n5,i),m.lineEnd=b,b()}return m}}var DX=wm({point:function(e,t){this.stream.point(e*Ae,t*Ae)}});function MX(e){return wm({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function NX(e,t,n,i,r){function o(a,s){return a*=i,s*=r,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*i,(n-s)/e*r]},o}function r5(e,t,n,i,r,o){if(!o)return NX(e,t,n,i,r);var a=ce(o),s=se(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function Xr(e){return o5(function(){return e})()}function o5(e){var t,n=150,i=480,r=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=RN,m=null,y,v,x,b=gd,_=.5,E,w,O,S,k;function A(D){return O(D[0]*Ae,D[1]*Ae)}function F(D){return D=O.invert(D[0],D[1]),D&&[D[0]*_t,D[1]*_t]}A.stream=function(D){return S&&k===D?S:S=DX(MX(c)(p(E(b(k=D)))))},A.preclip=function(D){return arguments.length?(p=D,g=void 0,M()):p},A.postclip=function(D){return arguments.length?(b=D,m=y=v=x=null,M()):b},A.clipAngle=function(D){return arguments.length?(p=+D?gX(g=D*Ae):(g=null,RN),M()):g*_t},A.clipExtent=function(D){return arguments.length?(b=D==null?(m=y=v=x=null,gd):jN(m=+D[0][0],y=+D[0][1],v=+D[1][0],x=+D[1][1]),M()):m==null?null:[[m,y],[v,x]]},A.scale=function(D){return arguments.length?(n=+D,C()):n},A.translate=function(D){return arguments.length?(i=+D[0],r=+D[1],C()):[i,r]},A.center=function(D){return arguments.length?(o=D[0]%360*Ae,a=D[1]%360*Ae,C()):[o*_t,a*_t]},A.rotate=function(D){return arguments.length?(s=D[0]%360*Ae,u=D[1]%360*Ae,l=D.length>2?D[2]%360*Ae:0,C()):[s*_t,u*_t,l*_t]},A.angle=function(D){return arguments.length?(f=D%360*Ae,C()):f*_t},A.reflectX=function(D){return arguments.length?(d=D?-1:1,C()):d<0},A.reflectY=function(D){return arguments.length?(h=D?-1:1,C()):h<0},A.precision=function(D){return arguments.length?(E=i5(w,_=D*D),M()):Mn(_)},A.fitExtent=function(D,N){return _m(A,D,N)},A.fitSize=function(D,N){return Q2(A,D,N)},A.fitWidth=function(D,N){return Z2(A,D,N)},A.fitHeight=function(D,N){return ew(A,D,N)};function C(){var D=r5(n,0,0,d,h,f).apply(null,t(o,a)),N=r5(n,i-D[0],r-D[1],d,h,f);return c=SN(s,u,l),w=L2(t,N),O=L2(c,w),E=i5(w,_),M()}function M(){return S=k=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&F,C()}}function tw(e){var t=0,n=Se/3,i=o5(e),r=i(t,n);return r.parallels=function(o){return arguments.length?i(t=o[0]*Ae,n=o[1]*Ae):[t*_t,n*_t]},r}function RX(e){var t=ce(e);function n(i,r){return[i*t,se(r)/t]}return n.invert=function(i,r){return[i/t,Qn(r*t)]},n}function jX(e,t){var n=se(e),i=(n+se(t))/2;if(Ne(i)<le)return RX(e);var r=1+n*(2*i-n),o=Mn(r)/i;function a(s,u){var l=Mn(r-2*i*se(u))/i;return[l*se(s*=i),o-l*ce(s)]}return a.invert=function(s,u){var l=o-u,c=ji(s,Ne(l))*$i(l);return l*i<0&&(c-=Se*$i(s)*$i(l)),[c/i,Qn((r-(s*s+l*l)*i*i)/(2*i))]},a}function Em(){return tw(jX).scale(155.424).center([0,33.6442])}function a5(){return Em().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function $X(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function LX(){var e,t,n=a5(),i,r=Em().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=Em().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,i.point(h,g),u||(o.point(h,g),u)||(s.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?r:m>=.166&&m<.234&&p>=-.214&&p<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=$X([n.stream(t=d),r.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return i=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),o=r.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+le,p+.12*h+le],[g-.214*h-le,p+.234*h-le]]).stream(l),s=a.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+le,p+.166*h+le],[g-.115*h-le,p+.234*h-le]]).stream(l),f()},c.fitExtent=function(d,h){return _m(c,d,h)},c.fitSize=function(d,h){return Q2(c,d,h)},c.fitWidth=function(d,h){return Z2(c,d,h)},c.fitHeight=function(d,h){return ew(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function s5(e){return function(t,n){var i=ce(t),r=ce(n),o=e(i*r);return o===1/0?[2,0]:[o*r*se(t),o*se(n)]}}function xd(e){return function(t,n){var i=Mn(t*t+n*n),r=e(i),o=se(r),a=ce(r);return[ji(t*o,i*a),Qn(i&&n*o/i)]}}var u5=s5(function(e){return Mn(2/(1+e))});u5.invert=xd(function(e){return 2*Qn(e/2)});function IX(){return Xr(u5).scale(124.75).clipAngle(180-.001)}var l5=s5(function(e){return(e=aN(e))&&e/se(e)});l5.invert=xd(function(e){return e});function PX(){return Xr(l5).scale(79.4188).clipAngle(180-.001)}function Om(e,t){return[e,Jp(A2((vt+t)/2))]}Om.invert=function(e,t){return[e,2*Pl(oN(t))-vt]};function zX(){return c5(Om).scale(961/Dn)}function c5(e){var t=Xr(e),n=t.center,i=t.scale,r=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=Se*i(),d=t(aX(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Om?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function Sm(e){return A2((vt+e)/2)}function BX(e,t){var n=ce(e),i=e===t?se(e):Jp(n/ce(t))/Jp(Sm(t)/Sm(e)),r=n*S2(Sm(e),i)/i;if(!i)return Om;function o(a,s){r>0?s<-vt+le&&(s=-vt+le):s>vt-le&&(s=vt-le);var u=r/S2(Sm(s),i);return[u*se(i*a),r-u*ce(i*a)]}return o.invert=function(a,s){var u=r-s,l=$i(i)*Mn(a*a+u*u),c=ji(a,Ne(u))*$i(u);return u*i<0&&(c-=Se*$i(a)*$i(u)),[c/i,2*Pl(S2(r/l,1/i))-vt]},o}function UX(){return tw(BX).scale(109.5).parallels([30,30])}function Am(e,t){return[e,t]}Am.invert=Am;function qX(){return Xr(Am).scale(152.63)}function WX(e,t){var n=ce(e),i=e===t?se(e):(n-ce(t))/(t-e),r=n/i+e;if(Ne(i)<le)return Am;function o(a,s){var u=r-s,l=i*a;return[u*se(l),r-u*ce(l)]}return o.invert=function(a,s){var u=r-s,l=ji(a,Ne(u))*$i(u);return u*i<0&&(l-=Se*$i(a)*$i(u)),[l/i,r-$i(i)*Mn(a*a+u*u)]},o}function HX(){return tw(WX).scale(131.154).center([0,13.9389])}var wd=1.340264,_d=-.081106,Ed=893e-6,Od=.003796,km=Mn(3)/2,GX=12;function f5(e,t){var n=Qn(km*se(t)),i=n*n,r=i*i*i;return[e*ce(n)/(km*(wd+3*_d*i+r*(7*Ed+9*Od*i))),n*(wd+_d*i+r*(Ed+Od*i))]}f5.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,o=0,a,s,u;o<GX&&(s=n*(wd+_d*i+r*(Ed+Od*i))-t,u=wd+3*_d*i+r*(7*Ed+9*Od*i),n-=a=s/u,i=n*n,r=i*i*i,!(Ne(a)<Yp));++o);return[km*e*(wd+3*_d*i+r*(7*Ed+9*Od*i))/ce(n),Qn(se(n)/km)]};function VX(){return Xr(f5).scale(177.158)}function d5(e,t){var n=ce(t),i=ce(e)*n;return[n*se(e)/i,se(t)/i]}d5.invert=xd(Pl);function YX(){return Xr(d5).scale(144.049).clipAngle(60)}function XX(){var e=1,t=0,n=0,i=1,r=1,o=0,a,s,u=null,l,c,f,d=1,h=1,g=wm({point:function(b,_){var E=x([b,_]);this.stream.point(E[0],E[1])}}),p=gd,m,y;function v(){return d=e*i,h=e*r,m=y=null,x}function x(b){var _=b[0]*d,E=b[1]*h;if(o){var w=E*a-_*s;_=_*a+E*s,E=w}return[_+t,E+n]}return x.invert=function(b){var _=b[0]-t,E=b[1]-n;if(o){var w=E*a+_*s;_=_*a-E*s,E=w}return[_/d,E/h]},x.stream=function(b){return m&&y===b?m:m=g(p(y=b))},x.postclip=function(b){return arguments.length?(p=b,u=l=c=f=null,v()):p},x.clipExtent=function(b){return arguments.length?(p=b==null?(u=l=c=f=null,gd):jN(u=+b[0][0],l=+b[0][1],c=+b[1][0],f=+b[1][1]),v()):u==null?null:[[u,l],[c,f]]},x.scale=function(b){return arguments.length?(e=+b,v()):e},x.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],v()):[t,n]},x.angle=function(b){return arguments.length?(o=b%360*Ae,s=se(o),a=ce(o),v()):o*_t},x.reflectX=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.reflectY=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.fitExtent=function(b,_){return _m(x,b,_)},x.fitSize=function(b,_){return Q2(x,b,_)},x.fitWidth=function(b,_){return Z2(x,b,_)},x.fitHeight=function(b,_){return ew(x,b,_)},x}function h5(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}h5.invert=function(e,t){var n=t,i=25,r;do{var o=n*n,a=o*o;n-=r=(n*(1.007226+o*(.015085+a*(-.044475+.028874*o-.005916*a)))-t)/(1.007226+o*(.015085*3+a*(-.044475*7+.028874*9*o-.005916*11*a)))}while(Ne(r)>le&&--i>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function KX(){return Xr(h5).scale(175.295)}function g5(e,t){return[ce(t)*se(e),se(t)]}g5.invert=xd(Qn);function JX(){return Xr(g5).scale(249.5).clipAngle(90+le)}function p5(e,t){var n=ce(t),i=1+ce(e)*n;return[n*se(e)/i,se(t)/i]}p5.invert=xd(function(e){return 2*Pl(e)});function QX(){return Xr(p5).scale(250).clipAngle(142)}function m5(e,t){return[Jp(A2((vt+t)/2)),-e]}m5.invert=function(e,t){return[-t,2*Pl(oN(e))-vt]};function ZX(){var e=c5(m5),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var eK=Math.abs,nw=Math.cos,Cm=Math.sin,tK=1e-6,y5=Math.PI,iw=y5/2,v5=nK(2);function b5(e){return e>1?iw:e<-1?-iw:Math.asin(e)}function nK(e){return e>0?Math.sqrt(e):0}function iK(e,t){var n=e*Cm(t),i=30,r;do t-=r=(t+Cm(t)-n)/(1+nw(t));while(eK(r)>tK&&--i>0);return t/2}function rK(e,t,n){function i(r,o){return[e*r*nw(o=iK(n,o)),t*Cm(o)]}return i.invert=function(r,o){return o=b5(o/t),[r/(e*nw(o)),b5((2*o+Cm(2*o))/n)]},i}var oK=rK(v5/iw,v5,y5);function aK(){return Xr(oK).scale(169.529)}const sK=t5(),rw=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function uK(e,t){return function n(){const i=t();return i.type=e,i.path=t5().projection(i),i.copy=i.copy||function(){const r=n();return rw.forEach(o=>{i[o]&&r[o](i[o]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function ow(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Tm[e]=uK(e,t),this):Tm[e]||null}function x5(e){return e&&e.path||sK}const Tm={albers:a5,albersusa:LX,azimuthalequalarea:IX,azimuthalequidistant:PX,conicconformal:UX,conicequalarea:Em,conicequidistant:HX,equalEarth:VX,equirectangular:qX,gnomonic:YX,identity:XX,mercator:zX,mollweide:aK,naturalEarth1:KX,orthographic:JX,stereographic:QX,transversemercator:ZX};for(const e in Tm)ow(e,Tm[e]);function lK(){}const Io=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function w5(){var e=1,t=1,n=s;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),cK(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(fK((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,v;for(h=g=-1,m=u[0]>=l,Io[m<<1].forEach(x);++h<e-1;)p=m,m=u[h+1]>=l,Io[p|m<<1].forEach(x);for(Io[m<<0].forEach(x);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,Io[m<<1|y<<2].forEach(x);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,v=y,y=u[g*e+h+1]>=l,Io[p|m<<1|y<<2|v<<3].forEach(x);Io[m|y<<3].forEach(x)}for(h=-1,y=u[g*e]>=l,Io[y<<2].forEach(x);++h<e-1;)v=y,y=u[g*e+h+1]>=l,Io[y<<2|v<<3].forEach(x);Io[y<<3].forEach(x);function x(b){var _=[b[0][0]+h,b[0][1]+g],E=[b[1][0]+h,b[1][1]+g],w=a(_),O=a(E),S,k;(S=d[w])?(k=f[O])?(delete d[S.end],delete f[k.start],S===k?(S.ring.push(E),c(S.ring)):f[S.start]=d[k.end]={start:S.start,end:k.end,ring:S.ring.concat(k.ring)}):(delete d[S.end],S.ring.push(E),d[S.end=O]=S):(S=f[O])?(k=d[w])?(delete f[S.start],delete d[k.end],S===k?(S.ring.push(E),c(S.ring)):f[k.start]=d[S.end]={start:k.start,end:S.end,ring:k.ring.concat(S.ring)}):(delete f[S.start],S.ring.unshift(_),f[S.start=w]=S):f[w]=d[O]={start:w,end:O,ring:[_,E]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||L("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?s:lK,i):n===s},i}function cK(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function fK(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=dK(e,t[n]))return r;return 0}function dK(e,t){for(var n=t[0],i=t[1],r=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(hK(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function hK(e,t,n){var i;return gK(e,t,n)&&pK(e[i=+(e[0]===t[0])],n[i],t[i])}function gK(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function pK(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function _5(e,t,n){return function(i){var r=Mr(i),o=n?Math.min(r[0],0):r[0],a=r[1],s=a-o,u=t?ma(o,a,e):s/(e+1);return yi(o+u,a,u)}}function aw(e){R.call(this,null,e)}aw.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};W(aw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||dn,o=w5().smooth(e.smooth!==!1),a=e.thresholds||mK(i,r,e),s=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=o.size([c.width,c.height])(c.values,P(a)?a:a(c.values));yK(f,c,l,e),f.forEach(d=>{u.push(Dg(l,Ue(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function mK(e,t,n){const i=_5(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Cs(t(r).values)))}function yK(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;if(_e(r)&&(r=r(n,i)),_e(o)&&(o=o(n,i)),(r===1||r==null)&&!o)return;const a=(Je(r)?r:r[0])||1,s=(Je(r)?r:r[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(E5(t,a,s,u,l))}function E5(e,t,n,i,r){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+i,f[1]=(f[1]-a)*n+r}return function(f){return f.coordinates.forEach(u),f}}function O5(e,t,n){const i=e>=0?e:Dv(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function sw(e){return _e(e)?e:gn(+e)}function S5(){var e=u=>u[0],t=u=>u[1],n=nl,i=[-1,-1],r=960,o=500,a=2;function s(u,l){const c=O5(i[0],u,e)>>a,f=O5(i[1],u,t)>>a,d=c?c+2:0,h=f?f+2:0,g=2*d+(r>>a),p=2*h+(o>>a),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;u.forEach(b=>{const _=d+(+e(b)>>a),E=h+(+t(b)>>a);_>=0&&_<g&&E>=0&&E<p&&(m[_+E*g]+=+n(b))}),c>0&&f>0?(Wl(g,p,m,y,c),Hl(g,p,y,m,f),Wl(g,p,m,y,c),Hl(g,p,y,m,f),Wl(g,p,m,y,c),Hl(g,p,y,m,f)):c>0?(Wl(g,p,m,y,c),Wl(g,p,y,m,c),Wl(g,p,m,y,c),v=y):f>0&&(Hl(g,p,m,y,f),Hl(g,p,y,m,f),Hl(g,p,m,y,f),v=y);const x=l?Math.pow(2,-2*a):1/jk(v);for(let b=0,_=g*p;b<_;++b)v[b]*=x;return{values:v,scale:1<<a,width:g,height:p,x1:d,y1:h,x2:d+(r>>a),y2:h+(o>>a)}}return s.x=function(u){return arguments.length?(e=sw(u),s):e},s.y=function(u){return arguments.length?(t=sw(u),s):t},s.weight=function(u){return arguments.length?(n=sw(u),s):n},s.size=function(u){if(!arguments.length)return[r,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||L("invalid size"),r=l,o=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||L("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),s):1<<a},s.bandwidth=function(u){return arguments.length?(u=J(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&L("invalid bandwidth"),i=u,s):i},s}function Wl(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<t;++a)for(let s=0,u=0;s<e+r;++s)s<e&&(u+=n[s+a*e]),s>=r&&(s>=o&&(u-=n[s-o+a*e]),i[s-r+a*e]=u/Math.min(s+1,e-1+o-s,o))}function Hl(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<e;++a)for(let s=0,u=0;s<t+r;++s)s<t&&(u+=n[a+s*e]),s>=r&&(s>=o&&(u-=n[a+(s-o)*e]),i[a+(s-r)*e]=u/Math.min(s+1,t-1+o-s,o))}function uw(e){R.call(this,null,e)}uw.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const vK=["x","y","weight","size","cellSize","bandwidth"];function A5(e,t){return vK.forEach(n=>t[n]!=null?e[n](t[n]):0),e}W(uw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=bK(i,e.groupby),o=(e.groupby||[]).map(yt),a=A5(S5(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=r.map(c=>Ue(l({[s]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function bK(e,t){var n=[],i=c=>c(s),r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function lw(e){R.call(this,null,e)}lw.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};W(lw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=w5().smooth(e.smooth!==!1),r=e.values,o=e.thresholds||_5(e.count||10,e.nice,!!r),a=e.size,s,u;return r||(r=t.materialize(t.SOURCE).source,s=A5(S5(),e)(r,!0),u=E5(s,s.scale||1,s.scale||1,0,0),a=[s.width,s.height],r=s.values),o=P(o)?o:o(r),r=i.size(a)(r,o),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ue),n}});const cw="Feature",fw="FeatureCollection",xK="MultiPoint";function dw(e){R.call(this,null,e)}dw.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};W(dw,R,{transform(e,t){var n=this._features,i=this._points,r=e.fields,o=r&&r[0],a=r&&r[1],s=e.geojson||!r&&dn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(fn(s))||o&&t.modified(fn(o))||a&&t.modified(fn(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),s&&t.visit(u,c=>n.push(s(c))),o&&a&&(t.visit(u,c=>{var f=o(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:cw,geometry:{type:xK,coordinates:i}})),this.value={type:fw,features:n}}});function hw(e){R.call(this,null,e)}hw.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};W(hw,R,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||dn,o=e.as||"path",a=n.SOURCE;!i||e.modified()?(this.value=i=x5(e.projection),n.materialize().reflow()):a=r===dn||t.modified(r.fields)?n.ADD_MOD:n.ADD;const s=wK(i,e.pointRadius);return n.visit(a,u=>u[o]=i(r(u))),i.pointRadius(s),n.modifies(o)}});function wK(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function gw(e){R.call(this,null,e)}gw.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};W(gw,R,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],o=e.as||["x","y"],a=o[0],s=o[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[a]=f[0],c[s]=f[1]):(c[a]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function pw(e){R.call(this,null,e)}pw.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};W(pw,R,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return(!i||e.modified())&&(this.value=i=_K(x5(e.projection),e.field||Gn("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,a=>a[r]=i),n.modifies(r)}});function _K(e,t,n){const i=n==null?r=>e(t(r)):r=>{var o=e.pointRadius(),a=e.pointRadius(n)(t(r));return e.pointRadius(o),a};return i.context=r=>(e.context(r),i),i}function mw(e){R.call(this,[],e),this.generator=mX()}mw.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};W(mw,R,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const o in e)_e(i[o])&&i[o](e[o]);return r=i(),n.length?t.mod.push(QC(n[0],r)):t.add.push(Ue(r)),n[0]=r,t}});function yw(e){R.call(this,null,e)}yw.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};W(yw,R,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||dn,o=OK(e.opacity,e),a=EK(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?Cs(n.map(l=>Cs(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=Ee({},l,u);i||(f.$max=Cs(c.values||[])),l[s]=SK(c,f,a.dep?a:gn(a(f)),o.dep?o:gn(o(f)))}),t.reflow(!0).modifies(s)}});function EK(e,t){let n;return _e(e)?(n=i=>Ta(e(i,t)),n.dep=k5(e)):n=gn(Ta(e||"#888")),n}function OK(e,t){let n;return _e(e)?(n=i=>e(i,t),n.dep=k5(e)):e?n=gn(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function k5(e){if(!_e(e))return!1;const t=er(fn(e));return t.$x||t.$y||t.$value||t.$max}function SK(e,t,n,i){const r=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||r,l=e.y2||o,c=e.values,f=c?m=>c[m]:fa,d=xl(u-a,l-s),h=d.getContext("2d"),g=h.getImageData(0,0,u-a,l-s),p=g.data;for(let m=s,y=0;m<l;++m){t.$y=m-s;for(let v=a,x=m*r;v<u;++v,y+=4){t.$x=v-a,t.$value=f(v+x);const b=n(t);p[y+0]=b.r,p[y+1]=b.g,p[y+2]=b.b,p[y+3]=~~(255*i(t))}}return h.putImageData(g,0,0),d}function C5(e){R.call(this,null,e),this.modified(!0)}W(C5,R,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=kK(e.type),rw.forEach(i=>{e[i]!=null&&T5(n,i,e[i])})):rw.forEach(i=>{e.modified(i)&&T5(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&AK(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function AK(e,t){const n=CK(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function kK(e){const t=ow((e||"mercator").toLowerCase());return t||L("Unrecognized projection type: "+e),t()}function T5(e,t,n){_e(e[t])&&e[t](n)}function CK(e){return e=J(e),e.length===1?e[0]:{type:fw,features:e.reduce((t,n)=>t.concat(TK(n)),[])}}function TK(e){return e.type===fw?e.features:J(e).filter(t=>t!=null).map(t=>t.type===cw?t:{type:cw,geometry:t})}var FK=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:lw,geojson:dw,geopath:hw,geopoint:gw,geoshape:pw,graticule:mw,heatmap:yw,isocontour:aw,kde2d:uw,projection:C5});function DK(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var o,a=n.length,s,u=0,l=0;for(o=0;o<a;++o)s=n[o],u+=s.x,l+=s.y;for(u=(u/a-e)*i,l=(l/a-t)*i,o=0;o<a;++o)s=n[o],s.x-=u,s.y-=l}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(e=+o,r):e},r.y=function(o){return arguments.length?(t=+o,r):t},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function MK(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return F5(this.cover(t,n),t,n,e)}function F5(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,a={data:i},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,v;if(!o)return e._root=a,e;for(;o.length;)if((p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=o,!(o=o[y=m<<1|p]))return r[y]=a,e;if(h=+e._x.call(null,o.data),g=+e._y.call(null,o.data),t===h&&n===g)return a.next=o,r?r[y]=a:e._root=a,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(v=(g>=d)<<1|h>=f));return r[v]=o,r[y]=a,e}function NK(e){var t,n,i=e.length,r,o,a=new Array(i),s=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=r,s[n]=o,r<u&&(u=r),r>c&&(c=r),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)F5(this,a[n],s[n],e[n]);return this}function RK(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var a=r-n||1,s=this._root,u,l;n>e||e>=r||i>t||t>=o;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:r=n+a,o=i+a;break;case 1:n=r-a,o=i+a;break;case 2:r=n+a,i=o-a;break;case 3:n=r-a,i=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function jK(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function $K(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function $n(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function LK(e,t,n){var i,r=this._x0,o=this._y0,a,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new $n(h,r,o,c,f)),n==null?n=1/0:(r=e-n,o=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(a=g.x0)>c||(s=g.y0)>f||(u=g.x1)<r||(l=g.y1)<o))if(h.length){var m=(a+u)/2,y=(s+l)/2;d.push(new $n(h[3],m,y,u,l),new $n(h[2],a,y,m,l),new $n(h[1],m,s,u,y),new $n(h[0],a,s,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),b=v*v+x*x;if(b<n){var _=Math.sqrt(n=b);r=e-_,o=t-_,c=e+_,f=t+_,i=h.data}}return i}function IK(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(a+u)/2))?a=d:u=d,(p=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function PK(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function zK(){return this._root}function BK(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function UK(e){var t=[],n,i=this._root,r,o,a,s,u;for(i&&t.push(new $n(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&i.length){var l=(o+s)/2,c=(a+u)/2;(r=i[3])&&t.push(new $n(r,l,c,s,u)),(r=i[2])&&t.push(new $n(r,o,c,l,u)),(r=i[1])&&t.push(new $n(r,l,a,s,c)),(r=i[0])&&t.push(new $n(r,o,a,l,c))}return this}function qK(e){var t=[],n=[],i;for(this._root&&t.push(new $n(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,a=i.x0,s=i.y0,u=i.x1,l=i.y1,c=(a+u)/2,f=(s+l)/2;(o=r[0])&&t.push(new $n(o,a,s,c,f)),(o=r[1])&&t.push(new $n(o,c,s,u,f)),(o=r[2])&&t.push(new $n(o,a,f,c,l)),(o=r[3])&&t.push(new $n(o,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function WK(e){return e[0]}function HK(e){return arguments.length?(this._x=e,this):this._x}function GK(e){return e[1]}function VK(e){return arguments.length?(this._y=e,this):this._y}function vw(e,t,n){var i=new bw(t==null?WK:t,n==null?GK:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function bw(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function D5(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ln=vw.prototype=bw.prototype;Ln.copy=function(){var e=new bw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=D5(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=D5(i));return e};Ln.add=MK;Ln.addAll=NK;Ln.cover=RK;Ln.data=jK;Ln.extent=$K;Ln.find=LK;Ln.remove=IK;Ln.removeAll=PK;Ln.root=zK;Ln.size=BK;Ln.visit=UK;Ln.visitAfter=qK;Ln.x=HK;Ln.y=VK;function In(e){return function(){return e}}function Va(e){return(e()-.5)*1e-6}function YK(e){return e.x+e.vx}function XK(e){return e.y+e.vy}function KK(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=In(e==null?1:+e));function a(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<o;++y)for(f=vw(t,YK,XK).visitAfter(s),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(v);function v(x,b,_,E,w){var O=x.data,S=x.r,k=p+S;if(O){if(O.index>d.index){var A=h-O.x-O.vx,F=g-O.y-O.vy,C=A*A+F*F;C<k*k&&(A===0&&(A=Va(i),C+=A*A),F===0&&(F=Va(i),C+=F*F),C=(k-(C=Math.sqrt(C)))/C*r,d.vx+=(A*=C)*(k=(S*=S)/(m+S)),d.vy+=(F*=C)*k,O.vx-=A*(k=1-k),O.vy-=F*k)}return}return b>h+k||E<h-k||_>g+k||w<g-k}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,i=c,u()},a.iterations=function(l){return arguments.length?(o=+l,a):o},a.strength=function(l){return arguments.length?(r=+l,a):r},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:In(+l),u(),a):e},a}function JK(e){return e.index}function M5(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function QK(e){var t=JK,n=f,i,r=In(30),o,a,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var x=0,b,_,E,w,O,S,k;x<v;++x)b=e[x],_=b.source,E=b.target,w=E.x+E.vx-_.x-_.vx||Va(l),O=E.y+E.vy-_.y-_.vy||Va(l),S=Math.sqrt(w*w+O*O),S=(S-o[x])/S*m*i[x],w*=S,O*=S,E.vx-=w*(k=u[x]),E.vy-=O*k,_.vx+=w*(k=1-k),_.vy+=O*k}function h(){if(!!a){var m,y=a.length,v=e.length,x=new Map(a.map((_,E)=>[t(_,E,a),_])),b;for(m=0,s=new Array(y);m<v;++m)b=e[m],b.index=m,typeof b.source!="object"&&(b.source=M5(x,b.source)),typeof b.target!="object"&&(b.target=M5(x,b.target)),s[b.source.index]=(s[b.source.index]||0)+1,s[b.target.index]=(s[b.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)b=e[m],u[m]=s[b.source.index]/(s[b.source.index]+s[b.target.index]);i=new Array(v),g(),o=new Array(v),p()}}function g(){if(!!a)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function p(){if(!!a)for(var m=0,y=e.length;m<y;++m)o[m]=+r(e[m],m,e)}return d.initialize=function(m,y){a=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:In(+m),g(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:In(+m),p(),d):r},d}var ZK={value:()=>{}};function N5(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Fm(n)}function Fm(e){this._=e}function eJ(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Fm.prototype=N5.prototype={constructor:Fm,on:function(e,t){var n=this._,i=eJ(e+"",n),r,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((r=(e=i[o]).type)&&(r=tJ(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(r=(e=i[o]).type)n[r]=R5(n[r],e.name,t);else if(t==null)for(r in n)n[r]=R5(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Fm(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function tJ(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function R5(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=ZK,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var Gl=0,Sd=0,Ad=0,j5=1e3,Dm,kd,Mm=0,Qs=0,Nm=0,Cd=typeof performance=="object"&&performance.now?performance:Date,$5=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function xw(){return Qs||($5(nJ),Qs=Cd.now()+Nm)}function nJ(){Qs=0}function Rm(){this._call=this._time=this._next=null}Rm.prototype=L5.prototype={constructor:Rm,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?xw():+n)+(t==null?0:+t),!this._next&&kd!==this&&(kd?kd._next=this:Dm=this,kd=this),this._call=e,this._time=n,ww()},stop:function(){this._call&&(this._call=null,this._time=1/0,ww())}};function L5(e,t,n){var i=new Rm;return i.restart(e,t,n),i}function iJ(){xw(),++Gl;for(var e=Dm,t;e;)(t=Qs-e._time)>=0&&e._call.call(null,t),e=e._next;--Gl}function I5(){Qs=(Mm=Cd.now())+Nm,Gl=Sd=0;try{iJ()}finally{Gl=0,oJ(),Qs=0}}function rJ(){var e=Cd.now(),t=e-Mm;t>j5&&(Nm-=t,Mm=e)}function oJ(){for(var e,t=Dm,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Dm=n);kd=e,ww(i)}function ww(e){if(!Gl){Sd&&(Sd=clearTimeout(Sd));var t=e-Qs;t>24?(e<1/0&&(Sd=setTimeout(I5,e-Cd.now()-Nm)),Ad&&(Ad=clearInterval(Ad))):(Ad||(Mm=Cd.now(),Ad=setInterval(rJ,j5)),Gl=1,$5(I5))}}function aJ(e,t,n){var i=new Rm,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(o,a,s){a=+a,s=s==null?xw():+s,i._restart(function u(l){l+=r,i._restart(u,r+=a,s),o(l)},a,s)},i.restart(e,t,n),i)}const sJ=1664525,uJ=1013904223,P5=4294967296;function lJ(){let e=1;return()=>(e=(sJ*e+uJ)%P5)/P5}function cJ(e){return e.x}function fJ(e){return e.y}var dJ=10,hJ=Math.PI*(3-Math.sqrt(5));function gJ(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,u=L5(f),l=N5("tick","end"),c=lJ();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,v;p===void 0&&(p=1);for(var x=0;x<p;++x)for(n+=(o-n)*r,s.forEach(function(b){b(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=dJ*Math.sqrt(.5+p),x=p*hJ;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),s.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(a=1-p,t):1-a},randomSource:function(p){return arguments.length?(c=p,s.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?s.delete(p):s.set(p,g(m)),t):s.get(p)},find:function(p,m,y){var v=0,x=e.length,b,_,E,w,O;for(y==null?y=1/0:y*=y,v=0;v<x;++v)w=e[v],b=p-w.x,_=m-w.y,E=b*b+_*_,E<y&&(O=w,y=E);return O},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function pJ(){var e,t,n,i,r=In(-30),o,a=1,s=1/0,u=.81;function l(h){var g,p=e.length,m=vw(e,cJ,fJ).visitAfter(f);for(i=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(o=new Array(g),h=0;h<g;++h)p=e[h],o[p.index]=+r(p,h,e)}}function f(h){var g=0,p,m,y=0,v,x,b;if(h.length){for(v=x=b=0;b<4;++b)(p=h[b])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,x+=m*p.y);h.x=v/y,h.y=x/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=o[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,x=m-g,b=y*y+v*v;if(x*x/u<b)return b<s&&(y===0&&(y=Va(n),b+=y*y),v===0&&(v=Va(n),b+=v*v),b<a&&(b=Math.sqrt(a*b)),t.vx+=y*h.value*i/b,t.vy+=v*h.value*i/b),!0;if(h.length||b>=s)return;(h.data!==t||h.next)&&(y===0&&(y=Va(n),b+=y*y),v===0&&(v=Va(n),b+=v*v),b<a&&(b=Math.sqrt(a*b)));do h.data!==t&&(x=o[h.data.index]*i/b,t.vx+=y*x,t.vy+=v*x);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:In(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function mJ(e){var t=In(.1),n,i,r;typeof e!="function"&&(e=In(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:In(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:In(+s),a(),o):e},o}function yJ(e){var t=In(.1),n,i,r;typeof e!="function"&&(e=In(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:In(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:In(+s),a(),o):e},o}const z5={center:DK,collide:KK,nbody:pJ,link:QK,x:mJ,y:yJ},Td="forces",_w=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],vJ=["static","iterations"],B5=["x","y","vx","vy"];function Ew(e){R.call(this,null,e)}Ew.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:B5}]};W(Ew,R,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(_w),o=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&U5(n,e,0,t)):(this.value=n=xJ(t.source,e),n.on("tick",bJ(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(vJ)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==Td||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,o=i.length,a;r<o;++r)if(i[r].name==="links"&&(a=i[r].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(B5)}});function bJ(e,t){return()=>e.touch(t).run()}function xJ(e,t){const n=gJ(e),i=n.stop,r=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,r()),n.stop=()=>(o=!0,i()),U5(n,t,!0).on("end",()=>o=!0)}function U5(e,t,n,i){var r=J(t.forces),o,a,s,u;for(o=0,a=_w.length;o<a;++o)s=_w[o],s!==Td&&t.modified(s)&&e[s](t[s]);for(o=0,a=r.length;o<a;++o)u=Td+o,s=n||t.modified(Td,o)?_J(r[o]):i&&wJ(r[o],i)?e.force(u):null,s&&e.force(u,s);for(a=e.numForces||0;o<a;++o)e.force(Td+o,null);return e.numForces=r.length,e}function wJ(e,t){var n,i;for(n in e)if(_e(i=e[n])&&t.modified(fn(i)))return 1;return 0}function _J(e){var t,n;re(z5,e.force)||L("Unrecognized force: "+e.force),t=z5[e.force]();for(n in e)_e(t[n])&&EJ(t[n],e[n],e);return t}function EJ(e,t,n){e(_e(t)?i=>t(i,n):t)}var OJ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Ew});function SJ(e,t){return e.parent===t.parent?1:2}function AJ(e){return e.reduce(kJ,0)/e.length}function kJ(e,t){return e+t.x}function CJ(e){return 1+e.reduce(TJ,0)}function TJ(e,t){return Math.max(e,t.y)}function FJ(e){for(var t;t=e.children;)e=t[0];return e}function DJ(e){for(var t;t=e.children;)e=t[t.length-1];return e}function MJ(){var e=SJ,t=1,n=1,i=!1;function r(o){var a,s=0;o.eachAfter(function(d){var h=d.children;h?(d.x=AJ(h),d.y=CJ(h)):(d.x=a?s+=e(d,a):0,d.y=0,a=d)});var u=FJ(o),l=DJ(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(i?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return r.separation=function(o){return arguments.length?(e=o,r):e},r.size=function(o){return arguments.length?(i=!1,t=+o[0],n=+o[1],r):i?null:[t,n]},r.nodeSize=function(o){return arguments.length?(i=!0,t=+o[0],n=+o[1],r):i?[t,n]:null},r}function NJ(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function RJ(){return this.eachAfter(NJ)}function jJ(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function $J(e,t){for(var n=this,i=[n],r,o,a=-1;n=i.pop();)if(e.call(t,n,++a,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function LJ(e,t){for(var n=this,i=[n],r=[],o,a,s,u=-1;n=i.pop();)if(r.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)i.push(o[a]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function IJ(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function PJ(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function zJ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function BJ(e){for(var t=this,n=UJ(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function UJ(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function qJ(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function WJ(){return Array.from(this)}function HJ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function GJ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*VJ(){var e=this,t,n=[e],i,r,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function Ow(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=KJ)):t===void 0&&(t=XJ);for(var n=new Vl(e),i,r=[n],o,a,s,u;i=r.pop();)if((a=t(i.data))&&(u=(a=Array.from(a)).length))for(i.children=a,s=u-1;s>=0;--s)r.push(o=a[s]=new Vl(a[s])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(q5)}function YJ(){return Ow(this).eachBefore(JJ)}function XJ(e){return e.children}function KJ(e){return Array.isArray(e)?e[1]:null}function JJ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function q5(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Vl(e){this.data=e,this.depth=this.height=0,this.parent=null}Vl.prototype=Ow.prototype={constructor:Vl,count:RJ,each:jJ,eachAfter:LJ,eachBefore:$J,find:IJ,sum:PJ,sort:zJ,path:BJ,ancestors:qJ,descendants:WJ,leaves:HJ,links:GJ,copy:YJ,[Symbol.iterator]:VJ};function QJ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ZJ(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function eQ(e){for(var t=0,n=(e=ZJ(Array.from(e))).length,i=[],r,o;t<n;)r=e[t],o&&W5(o,r)?++t:(o=nQ(i=tQ(i,r)),t=0);return o}function tQ(e,t){var n,i;if(Sw(t,e))return[t];for(n=0;n<e.length;++n)if(jm(t,e[n])&&Sw(Fd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(jm(Fd(e[n],e[i]),t)&&jm(Fd(e[n],t),e[i])&&jm(Fd(e[i],t),e[n])&&Sw(H5(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function jm(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function W5(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Sw(e,t){for(var n=0;n<t.length;++n)if(!W5(e,t[n]))return!1;return!0}function nQ(e){switch(e.length){case 1:return iQ(e[0]);case 2:return Fd(e[0],e[1]);case 3:return H5(e[0],e[1],e[2])}}function iQ(e){return{x:e.x,y:e.y,r:e.r}}function Fd(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-i,c=s-r,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(i+a+l/f*c)/2,r:(f+r+s)/2}}function H5(e,t,n){var i=e.x,r=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-a,h=i-l,g=r-s,p=r-c,m=u-o,y=f-o,v=i*i+r*r-o*o,x=v-a*a-s*s+u*u,b=v-l*l-c*c+f*f,_=h*g-d*p,E=(g*b-p*x)/(_*2)-i,w=(p*m-g*y)/_,O=(h*x-d*b)/(_*2)-r,S=(d*y-h*m)/_,k=w*w+S*S-1,A=2*(o+E*w+O*S),F=E*E+O*O-o*o,C=-(k?(A+Math.sqrt(A*A-4*k*F))/(2*k):F/A);return{x:i+E+w*C,y:r+O+S*C,r:C}}function G5(e,t,n){var i=e.x-t.x,r,o,a=e.y-t.y,s,u,l=i*i+a*a;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(r=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-s*a,n.y=e.y-r*a+s*i):(r=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x+r*i-s*a,n.y=t.y+r*a+s*i)):(n.x=t.x+n.r,n.y=t.y)}function V5(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Y5(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function $m(e){this._=e,this.next=null,this.previous=null}function rQ(e){if(!(r=(e=QJ(e)).length))return 0;var t,n,i,r,o,a,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;G5(n,t,i=e[2]),t=new $m(t),n=new $m(n),i=new $m(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(s=3;s<r;++s){G5(t._,n._,i=e[s]),i=new $m(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(V5(u._,i._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(V5(l._,i._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,o=Y5(t);(i=i.next)!==n;)(a=Y5(i))<o&&(t=i,o=a);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=eQ(t),s=0;s<r;++s)t=e[s],t.x-=i.x,t.y-=i.y;return i.r}function oQ(e){return e==null?null:Lm(e)}function Lm(e){if(typeof e!="function")throw new Error;return e}function Zs(){return 0}function Yl(e){return function(){return e}}function aQ(e){return Math.sqrt(e.value)}function sQ(){var e=null,t=1,n=1,i=Zs;function r(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(X5(e)).eachAfter(Aw(i,.5)).eachBefore(K5(1)):o.eachBefore(X5(aQ)).eachAfter(Aw(Zs,1)).eachAfter(Aw(i,o.r/Math.min(t,n))).eachBefore(K5(Math.min(t,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(e=oQ(o),r):e},r.size=function(o){return arguments.length?(t=+o[0],n=+o[1],r):[t,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:Yl(+o),r):i},r}function X5(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Aw(e,t){return function(n){if(i=n.children){var i,r,o=i.length,a=e(n)*t||0,s;if(a)for(r=0;r<o;++r)i[r].r+=a;if(s=rQ(i),a)for(r=0;r<o;++r)i[r].r-=a;n.r=s+a}}}function K5(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function J5(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Dd(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(i-t)/e.value;++s<u;)a=o[s],a.y0=n,a.y1=r,a.x0=t,a.x1=t+=a.value*l}function uQ(){var e=1,t=1,n=0,i=!1;function r(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/s,a.eachBefore(o(t,s)),i&&a.eachBefore(J5),a}function o(a,s){return function(u){u.children&&Dd(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(a){return arguments.length?(i=!!a,r):i},r.size=function(a){return arguments.length?(e=+a[0],t=+a[1],r):[e,t]},r.padding=function(a){return arguments.length?(n=+a,r):n},r}var lQ={depth:-1},Q5={};function cQ(e){return e.id}function fQ(e){return e.parentId}function Z5(){var e=cQ,t=fQ;function n(i){var r=Array.from(i),o=r.length,a,s,u,l,c,f,d,h=new Map;for(s=0;s<o;++s)a=r[s],c=r[s]=new Vl(a),(f=e(a,s,i))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?Q5:c)),(f=t(a,s,i))!=null&&(f+="")&&(c.parent=f);for(s=0;s<o;++s)if(c=r[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===Q5)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=lQ,u.eachBefore(function(g){g.depth=g.parent.depth+1,--o}).eachBefore(q5),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=Lm(i),n):e},n.parentId=function(i){return arguments.length?(t=Lm(i),n):t},n}function dQ(e,t){return e.parent===t.parent?1:2}function kw(e){var t=e.children;return t?t[0]:e.t}function Cw(e){var t=e.children;return t?t[t.length-1]:e.t}function hQ(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function gQ(e){for(var t=0,n=0,i=e.children,r=i.length,o;--r>=0;)o=i[r],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function pQ(e,t,n){return e.a.parent===t.parent?e.a:n}function Im(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Im.prototype=Object.create(Vl.prototype);function mQ(e){for(var t=new Im(e,0),n,i=[t],r,o,a,s;n=i.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)i.push(r=n.children[a]=new Im(o[a],a)),r.parent=n;return(t.parent=new Im(null,0)).children=[t],t}function yQ(){var e=dQ,t=1,n=1,i=null;function r(l){var c=mQ(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){gQ(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,v=g.m,x=p.m,b;g=Cw(g),d=kw(d),g&&d;)p=kw(p),h=Cw(h),h.a=l,b=g.z+v-d.z-m+e(g._,d._),b>0&&(hQ(pQ(g,l,f),l,b),m+=b,y+=b),v+=g.m,m+=d.m,x+=p.m,y+=h.m;g&&!Cw(h)&&(h.t=g,h.m+=v-y),d&&!kw(p)&&(p.t=d,p.m+=m-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function Pm(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(r-n)/e.value;++s<u;)a=o[s],a.x0=t,a.x1=i,a.y0=n,a.y1=n+=a.value*l}var eR=(1+Math.sqrt(5))/2;function tR(e,t,n,i,r,o){for(var a=[],s=t.children,u,l,c=0,f=0,d=s.length,h,g,p=t.value,m,y,v,x,b,_,E;c<d;){h=r-n,g=o-i;do m=s[f++].value;while(!m&&f<d);for(y=v=m,_=Math.max(g/h,h/g)/(p*e),E=m*m*_,b=Math.max(v/E,E/y);f<d;++f){if(m+=l=s[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*_,x=Math.max(v/E,E/y),x>b){m-=l;break}b=x}a.push(u={value:m,dice:h<g,children:s.slice(c,f)}),u.dice?Dd(u,n,i,r,p?i+=g*m/p:o):Pm(u,n,i,p?n+=h*m/p:r,o),p-=m,c=f}return a}var nR=function e(t){function n(i,r,o,a,s){tR(t,i,r,o,a,s)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(eR);function vQ(){var e=nR,t=!1,n=1,i=1,r=[0],o=Zs,a=Zs,s=Zs,u=Zs,l=Zs;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(J5),d}function f(d){var h=r[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=o(d)/2,g+=l(d)-h,p+=a(d)-h,m-=s(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=Lm(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:Yl(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:Yl(+d),c):a},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:Yl(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:Yl(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:Yl(+d),c):l},c}function bQ(e,t,n,i,r){var o=e.children,a,s=o.length,u,l=new Array(s+1);for(l[0]=u=a=0;a<s;++a)l[a+1]=u+=o[a].value;c(0,s,e.value,t,n,i,r);function c(f,d,h,g,p,m,y){if(f>=d-1){var v=o[f];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var x=l[f],b=h/2+x,_=f+1,E=d-1;_<E;){var w=_+E>>>1;l[w]<b?_=w+1:E=w}b-l[_-1]<l[_]-b&&f+1<_&&--_;var O=l[_]-x,S=h-O;if(m-g>y-p){var k=h?(g*S+m*O)/h:m;c(f,_,O,g,p,k,y),c(_,d,S,k,p,m,y)}else{var A=h?(p*S+y*O)/h:y;c(f,_,O,g,p,m,A),c(_,d,S,g,A,m,y)}}}function xQ(e,t,n,i,r){(e.depth&1?Pm:Dd)(e,t,n,i,r)}var wQ=function e(t){function n(i,r,o,a,s){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=i.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Dd(l,r,o,a,p?o+=(s-o)*l.value/p:s):Pm(l,r,o,p?r+=(a-r)*l.value/p:a,s),p-=l.value}else i._squarify=u=tR(t,i,r,o,a,s),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(eR);function Tw(e,t,n){const i={};return e.each(r=>{const o=r.data;n(o)&&(i[t(o)]=r)}),e.lookup=i,e}function Fw(e){R.call(this,null,e)}Fw.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const _Q=e=>e.values;W(Fw,R,{transform(e,t){t.source||L("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(a=>{a.children&&Fg(a.data)&&r.rem.push(a.data)}),this.value=o=Ow({values:J(e.keys).reduce((a,s)=>(a.key(s),a),EQ()).entries(r.source)},_Q),n&&o.each(a=>{a.children&&(a=Ue(a.data),r.add.push(a),r.source.push(a))}),Tw(o,ae,ae)),r.source.root=o,r}});function EQ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,o){if(o>=e.length)return r;const a=r.length,s=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<a;)f=s(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function i(r,o){if(++o>e.length)return r;const a=[];for(const s in r)a.push({key:s,values:i(r[s],o)});return a}return t}function Po(e){R.call(this,null,e)}const OQ=(e,t)=>e.parent===t.parent?1:2;W(Po,R,{transform(e,t){(!t.source||!t.source.root)&&L(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort(Ns(e.sort,a=>a.data)),SQ(n,this.params,e),n.separation&&n.separation(e.separation!==!1?OQ:nl);try{this.value=n(r)}catch(a){L(a)}return r.each(a=>AQ(a,i,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function SQ(e,t,n){for(let i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}function AQ(e,t,n){const i=e.data,r=t.length-1;for(let o=0;o<r;++o)i[n[o]]=e[t[o]];i[n[r]]=e.children?e.children.length:0}const Dw=["x","y","r","depth","children"];function Mw(e){Po.call(this,e)}Mw.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Dw.length,default:Dw}]};W(Mw,Po,{layout:sQ,params:["radius","size","padding"],fields:Dw});const Nw=["x0","y0","x1","y1","depth","children"];function Rw(e){Po.call(this,e)}Rw.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Nw.length,default:Nw}]};W(Rw,Po,{layout:uQ,params:["size","round","padding"],fields:Nw});function jw(e){R.call(this,null,e)}jw.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};W(jw,R,{transform(e,t){t.source||L("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?Tw(Z5().id(e.key).parentId(e.parentKey)(r.source),e.key,Ti):Tw(Z5()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const iR={tidy:yQ,cluster:MJ},$w=["x","y","depth","children"];function Lw(e){Po.call(this,e)}Lw.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:$w.length,default:$w}]};W(Lw,Po,{layout(e){const t=e||"tidy";if(re(iR,t))return iR[t]();L("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:$w});function Iw(e){R.call(this,[],e)}Iw.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};W(Iw,R,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||L("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,a=>o[ae(a)]=1),i.each(a=>{const s=a.data,u=a.parent&&a.parent.data;u&&o[ae(s)]&&o[ae(u)]&&r.add.push(Ue({source:u,target:s}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>o[ae(a)]=1),n.forEach(a=>{(o[ae(a.source)]||o[ae(a.target)])&&r.mod.push(a)})),r}});const rR={binary:bQ,dice:Dd,slice:Pm,slicedice:xQ,squarify:nR,resquarify:wQ},Pw=["x0","y0","x1","y1","depth","children"];function zw(e){Po.call(this,e)}zw.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Pw.length,default:Pw}]};W(zw,Po,{layout(){const e=vQ();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{re(rR,t)?e.tile(rR[t]):L("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:Pw});var kQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:Fw,pack:Mw,partition:Rw,stratify:jw,tree:Lw,treelinks:Iw,treemap:zw});const CQ=4278190080,TQ=268435456,FQ=.0625;function DQ(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function MQ(e,t,n,i){const r=e.width,o=e.height,a=n||i,s=xl(r,o).getContext("2d");t.forEach(m=>oR(s,m,a));const u=new Uint32Array(s.getImageData(0,0,r,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,g,p;for(d=0;d<o;++d)for(f=0;f<r;++f)p=u[d*r+f]&CQ,p&&(h=e(f),g=e(d),i||l.set(h,g),a&&p^TQ&&c.set(h,g));return[l,c]}function oR(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(o=>oR(e,o.items,n))}):xi[i].draw(e,{items:n?t.map(NQ):t})}function NQ(e){const t=Dg(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=FQ,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const zo=5,Pn=31,Md=32,Ya=new Uint32Array(Md+1),cr=new Uint32Array(Md+1);cr[0]=0;Ya[0]=~cr[0];for(let e=1;e<=Md;++e)cr[e]=cr[e-1]<<1|1,Ya[e]=~cr[e];function RQ(e,t){const n=new Uint32Array(~~((e*t+Md)/Md));function i(o,a){n[o]|=a}function r(o,a){n[o]&=a}return{array:n,get:(o,a)=>{const s=a*e+o;return n[s>>>zo]&1<<(s&Pn)},set:(o,a)=>{const s=a*e+o;i(s>>>zo,1<<(s&Pn))},clear:(o,a)=>{const s=a*e+o;r(s>>>zo,~(1<<(s&Pn)))},getRange:(o,a,s,u)=>{let l=u,c,f,d,h;for(;l>=a;--l)if(c=l*e+o,f=l*e+s,d=c>>>zo,h=f>>>zo,d===h){if(n[d]&Ya[c&Pn]&cr[(f&Pn)+1])return!0}else{if(n[d]&Ya[c&Pn]||n[h]&cr[(f&Pn)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>zo,d=c>>>zo,f===d)i(f,Ya[l&Pn]&cr[(c&Pn)+1]);else for(i(f,Ya[l&Pn]),i(d,cr[(c&Pn)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>zo,d=c>>>zo,f===d)r(f,cr[l&Pn]|Ya[(c&Pn)+1]);else for(r(f,cr[l&Pn]),r(d,Ya[(c&Pn)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(o,a,s,u)=>o<0||a<0||u>=t||s>=e}}function jQ(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),o=~~((t+2*n+i)/i),a=s=>~~((s+n)/i);return a.invert=s=>s*i-n,a.bitmap=()=>RQ(r,o),a.ratio=i,a.padding=n,a.width=e,a.height=t,a}function $Q(e,t,n,i){const r=e.width,o=e.height;return function(a){const s=a.datum.datum.items[i].items,u=s.length,l=a.datum.fontSize,c=qr.width(a.datum,a.datum.text);let f=0,d,h,g,p,m,y,v;for(let x=0;x<u;++x)d=s[x].x,g=s[x].y,h=s[x].x2===void 0?d:s[x].x2,p=s[x].y2===void 0?g:s[x].y2,m=(d+h)/2,y=(g+p)/2,v=Math.abs(h-d+p-g),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=l/2,d=a.x-m,h=a.x+m,g=a.y-y,p=a.y+y,a.align="center",d<0&&h<=r?a.align="left":0<=d&&r<h&&(a.align="right"),a.baseline="middle",g<0&&p<=o?a.baseline="top":0<=g&&o<p&&(a.baseline="bottom"),!0}}function LQ(e,t,n,i,r,o){let a=n/2;return e-a<0||e+a>r||t-(a=i/2)<0||t+a>o}function IQ(){return!1}function PQ(e,t,n,i,r,o,a,s){const u=r*o/(i*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function zQ(e,t,n,i,r,o,a,s){const u=r*o/(i*2);let l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function aR(e){return e?[zQ,IQ]:[PQ,LQ]}function BQ(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=aR(r),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),v=e.invert(h);let x=g,b=a,_;if(!u(y,v,p,m,o,a)&&!s(e,y,v,m,p,x,l,c)&&!s(e,y,v,m,p,m,l,null)){for(;b-x>=1;)_=(x+b)/2,s(e,y,v,m,p,_,l,c)?b=_:x=_;if(x>g)return[y,v,x,!0]}}return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=qr.width(d.datum,d.datum.text);let y=n?p:0,v=!1,x=!1,b=0,_,E,w,O,S,k,A,F,C,M,D,N,I,z,X,te,xe;for(let ge=0;ge<g;++ge){for(_=h[ge].x,w=h[ge].y,E=h[ge].x2===void 0?_:h[ge].x2,O=h[ge].y2===void 0?w:h[ge].y2,_>E&&(xe=_,_=E,E=xe),w>O&&(xe=w,w=O,O=xe),C=e(_),D=e(E),M=~~((C+D)/2),N=e(w),z=e(O),I=~~((N+z)/2),A=M;A>=C;--A)for(F=I;F>=N;--F)te=f(A,F,y,m,p),te&&([d.x,d.y,y,v]=te);for(A=M;A<=D;++A)for(F=I;F<=z;++F)te=f(A,F,y,m,p),te&&([d.x,d.y,y,v]=te);!v&&!n&&(X=Math.abs(E-_+O-w),S=(_+E)/2,k=(w+O)/2,X>=b&&!u(S,k,m,p,o,a)&&!s(e,S,k,p,m,p,l,null)&&(b=X,d.x=S,d.y=k,x=!0))}return v||x?(S=m/2,k=p/2,l.setRange(e(d.x-S),e(d.y-k),e(d.x+S),e(d.y+k)),d.align="center",d.baseline="middle",!0):!1}}const UQ=[-1,-1,1,1],qQ=[-1,1,-1,1];function WQ(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=aR(r),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=qr.width(d.datum,d.datum.text),y=[];let v=n?p:0,x=!1,b=!1,_=0,E,w,O,S,k,A,F,C,M,D,N,I;for(let z=0;z<g;++z){for(E=h[z].x,O=h[z].y,w=h[z].x2===void 0?E:h[z].x2,S=h[z].y2===void 0?O:h[z].y2,y.push([e((E+w)/2),e((O+S)/2)]);y.length;)if([F,C]=y.pop(),!(l.get(F,C)||c.get(F,C)||f.get(F,C))){f.set(F,C);for(let X=0;X<4;++X)k=F+UQ[X],A=C+qQ[X],f.outOfBounds(k,A,k,A)||y.push([k,A]);if(k=e.invert(F),A=e.invert(C),M=v,D=a,!u(k,A,m,p,o,a)&&!s(e,k,A,p,m,M,l,c)&&!s(e,k,A,p,m,p,l,null)){for(;D-M>=1;)N=(M+D)/2,s(e,k,A,p,m,N,l,c)?D=N:M=N;M>v&&(d.x=k,d.y=A,v=M,x=!0)}}!x&&!n&&(I=Math.abs(w-E+S-O),k=(E+w)/2,A=(O+S)/2,I>=_&&!u(k,A,m,p,o,a)&&!s(e,k,A,p,m,p,l,null)&&(_=I,d.x=k,d.y=A,b=!0))}return x||b?(k=m/2,A=p/2,l.setRange(e(d.x-k),e(d.y-A),e(d.x+k),e(d.y+A)),d.align="center",d.baseline="middle",!0):!1}}const HQ=["right","center","left"],GQ=["bottom","middle","top"];function VQ(e,t,n,i,r){const o=e.width,a=e.height,s=t[0],u=t[1],l=i.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>o||f[3]>a))return!1;let h=0,g,p,m,y,v,x,b,_,E,w,O,S,k,A,F;for(let C=0;C<l;++C){if(g=(n[C]&3)-1,p=(n[C]>>>2&3)-1,m=g===0&&p===0||i[C]<0,y=g&&p?Math.SQRT1_2:1,v=i[C]<0?-1:1,x=f[1+g]+i[C]*g*y,O=f[4+p]+v*d*p/2+i[C]*p*y,_=O-d/2,E=O+d/2,S=e(x),A=e(_),F=e(E),r&&(S=S<0?0:S,A=A<0?0:A,F=F>=e.height?e.height-1:F),!h)if(sR(S,S,A,F,s,u,x,x,_,E,f,m))h=qr.width(c.datum,c.datum.text);else continue;if(w=x+v*h*g/2,x=w-h/2,b=w+h/2,S=e(x),k=e(b),r&&(S=S<0?0:S,k=k>=e.width?e.width-1:k),sR(S,k,A,F,s,u,x,b,_,E,f,m))return c.x=g?g*v<0?b:x:w,c.y=p?p*v<0?E:_:O,c.align=HQ[g*v+1],c.baseline=GQ[p*v+1],s.setRange(S,A,k,F),!0}return!1}}function sR(e,t,n,i,r,o,a,s,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&o?o.getRange(e,n,t,i)||!YQ(a,u,s,l,c):r.getRange(e,n,t,i)))}function YQ(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const Bw=0,Uw=4,qw=8,Ww=0,Hw=1,Gw=2,XQ={"top-left":Bw+Ww,top:Bw+Hw,"top-right":Bw+Gw,left:Uw+Ww,middle:Uw+Hw,right:Uw+Gw,"bottom-left":qw+Ww,bottom:qw+Hw,"bottom-right":qw+Gw},KQ={naive:$Q,"reduced-search":BQ,floodfill:WQ};function JQ(e,t,n,i,r,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=QQ(i,f),h=ZQ(r,f),g=eZ(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=tZ(g,p,s,u),v=l===null||l===1/0,x=jQ(t[0],t[1],v?0:l),b=m&&c==="naive",_=e.map(O=>({datum:O,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(O)}));let E;if(!b){n&&_.sort((S,k)=>n(S.datum,k.datum));let O=!1;for(let S=0;S<h.length&&!O;++S)O=h[S]===5||d[S]<0;g&&(a||m)&&(o=[e.map(S=>S.datum)].concat(o)),E=o.length?MQ(x,o,O,m):DQ(x,a&&_)}const w=m?KQ[c](x,E,a,u,v):VQ(x,E,h,d,v);return _.forEach(O=>O.opacity=+w(O)),_}function QQ(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function ZQ(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=XQ[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function eZ(e){return e&&e.mark&&e.mark.marktype}function tZ(e,t,n,i){const r=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>r(o.datum):t==="line"?o=>{const a=o.datum.items[i].items;return r(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:o=>{const a=o.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:r}const Vw=["x","y","opacity","align","baseline"],uR=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Yw(e){R.call(this,null,e)}Yw.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:uR},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Vw.length,default:Vw}]};W(Yw,R,{transform(e,t){function n(o){const a=e[o];return _e(a)&&t.modified(a.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&L("Size parameter should be specified as a [width, height] array.");const r=e.as||Vw;return JQ(t.materialize(t.SOURCE).source||[],e.size,e.sort,J(e.offset==null?1:e.offset),J(e.anchor||uR),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const a=o.datum;a[r[0]]=o.x,a[r[1]]=o.y,a[r[2]]=o.opacity,a[r[3]]=o.align,a[r[4]]=o.baseline}),t.reflow(i).modifies(r)}});var nZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:Yw});function lR(e,t){var n=[],i=function(c){return c(s)},r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function Xw(e){R.call(this,null,e)}Xw.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};W(Xw,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=lR(i,e.groupby),o=(e.groupby||[]).map(yt),a=o.length,s=e.as||[yt(e.x),yt(e.y)],u=[];r.forEach(l=>{OT(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[o[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Ue(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const Kw={linear:qv,log:vT,exp:bT,pow:xT,quad:Wv,poly:wT},iZ=(e,t)=>e==="poly"?t:e==="quad"?2:1;function Jw(e){R.call(this,null,e)}Jw.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Kw)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};W(Jw,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=lR(i,e.groupby),o=(e.groupby||[]).map(yt),a=e.method||"linear",s=e.order||3,u=iZ(a,s),l=e.as||[yt(e.x),yt(e.y)],c=Kw[a],f=[];let d=e.extent;re(Kw,a)||L("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,s);if(e.params){f.push(Ue({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||Mr(h,e.x),y=v=>{const x={};for(let b=0;b<o.length;++b)x[o[b]]=h.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],f.push(Ue(x))};a==="linear"?m.forEach(v=>y([v,p.predict(v)])):Bg(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var rZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:Xw,regression:Jw});const cR=Math.pow(2,-52),zm=new Uint32Array(512);class Bm{static from(t,n=lZ,i=cZ){const r=t.length,o=new Float64Array(r*2);for(let a=0;a<r;a++){const s=t[a];o[2*a]=n(s),o[2*a+1]=i(s)}return new Bm(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,a=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let k=0;k<a;k++){const A=t[2*k],F=t[2*k+1];A<s&&(s=A),F<u&&(u=F),A>l&&(l=A),F>c&&(c=F),this._ids[k]=k}const f=(s+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let k=0;k<a;k++){const A=Qw(f,d,t[2*k],t[2*k+1]);A<h&&(g=k,h=A)}const y=t[2*g],v=t[2*g+1];h=1/0;for(let k=0;k<a;k++){if(k===g)continue;const A=Qw(y,v,t[2*k],t[2*k+1]);A<h&&A>0&&(p=k,h=A)}let x=t[2*p],b=t[2*p+1],_=1/0;for(let k=0;k<a;k++){if(k===g||k===p)continue;const A=sZ(y,v,x,b,t[2*k],t[2*k+1]);A<_&&(m=k,_=A)}let E=t[2*m],w=t[2*m+1];if(_===1/0){for(let F=0;F<a;F++)this._dists[F]=t[2*F]-t[0]||t[2*F+1]-t[1];Xl(this._ids,this._dists,0,a-1);const k=new Uint32Array(a);let A=0;for(let F=0,C=-1/0;F<a;F++){const M=this._ids[F];this._dists[M]>C&&(k[A++]=M,C=this._dists[M])}this.hull=k.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Um(y,v,x,b,E,w)){const k=p,A=x,F=b;p=m,x=E,b=w,m=k,E=A,w=F}const O=uZ(y,v,x,b,E,w);this._cx=O.x,this._cy=O.y;for(let k=0;k<a;k++)this._dists[k]=Qw(t[2*k],t[2*k+1],O.x,O.y);Xl(this._ids,this._dists,0,a-1),this._hullStart=g;let S=3;i[g]=n[m]=p,i[p]=n[g]=m,i[m]=n[p]=g,r[g]=0,r[p]=1,r[m]=2,o.fill(-1),o[this._hashKey(y,v)]=g,o[this._hashKey(x,b)]=p,o[this._hashKey(E,w)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let k=0,A,F;k<this._ids.length;k++){const C=this._ids[k],M=t[2*C],D=t[2*C+1];if(k>0&&Math.abs(M-A)<=cR&&Math.abs(D-F)<=cR||(A=M,F=D,C===g||C===p||C===m))continue;let N=0;for(let xe=0,ge=this._hashKey(M,D);xe<this._hashSize&&(N=o[(ge+xe)%this._hashSize],!(N!==-1&&N!==i[N]));xe++);N=n[N];let I=N,z;for(;z=i[I],!Um(M,D,t[2*I],t[2*I+1],t[2*z],t[2*z+1]);)if(I=z,I===N){I=-1;break}if(I===-1)continue;let X=this._addTriangle(I,C,i[I],-1,-1,r[I]);r[C]=this._legalize(X+2),r[I]=X,S++;let te=i[I];for(;z=i[te],Um(M,D,t[2*te],t[2*te+1],t[2*z],t[2*z+1]);)X=this._addTriangle(te,C,z,r[C],-1,r[te]),r[C]=this._legalize(X+2),i[te]=te,S--,te=z;if(I===N)for(;z=n[I],Um(M,D,t[2*z],t[2*z+1],t[2*I],t[2*I+1]);)X=this._addTriangle(z,C,I,-1,r[I],r[z]),this._legalize(X+2),r[z]=X,i[I]=I,S--,I=z;this._hullStart=n[C]=I,i[I]=n[te]=C,i[C]=te,o[this._hashKey(M,D)]=C,o[this._hashKey(t[2*I],t[2*I+1])]=I}this.hull=new Uint32Array(S);for(let k=0,A=this._hullStart;k<S;k++)this.hull[k]=A,A=i[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(oZ(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,a=0;for(;;){const s=i[t],u=t-t%3;if(a=u+(t+2)%3,s===-1){if(o===0)break;t=zm[--o];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[a],h=n[t],g=n[c],p=n[f];if(aZ(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1])){n[t]=p,n[s]=d;const y=i[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(s,i[a]),this._link(a,f);const v=l+(s+1)%3;o<zm.length&&(zm[o++]=v)}else{if(o===0)break;t=zm[--o]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,a){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=i,this._link(s,r),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function oZ(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Qw(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function Zw(e,t,n,i,r,o){const a=(i-t)*(r-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function Um(e,t,n,i,r,o){return(Zw(r,o,e,t,n,i)||Zw(e,t,n,i,r,o)||Zw(n,i,r,o,e,t))<0}function aZ(e,t,n,i,r,o,a,s){const u=e-a,l=t-s,c=n-a,f=i-s,d=r-a,h=o-s,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function sZ(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,g=(a*f-u*c)*d;return h*h+g*g}function uZ(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=e+(l*c-s*f)*d,g=t+(a*f-u*c)*d;return{x:h,y:g}}function Xl(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],a=t[o];let s=r-1;for(;s>=n&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=o}else{const r=n+i>>1;let o=n+1,a=i;Nd(e,r,o),t[e[n]]>t[e[i]]&&Nd(e,n,i),t[e[o]]>t[e[i]]&&Nd(e,o,i),t[e[n]]>t[e[o]]&&Nd(e,n,o);const s=e[o],u=t[s];for(;;){do o++;while(t[e[o]]<u);do a--;while(t[e[a]]>u);if(a<o)break;Nd(e,o,a)}e[n+1]=e[a],e[a]=s,i-o+1>=a-n?(Xl(e,t,o,i),Xl(e,t,n,a-1)):(Xl(e,t,n,a-1),Xl(e,t,o,i))}}function Nd(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function lZ(e){return e[0]}function cZ(e){return e[1]}const fR=1e-6;class eu{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,o=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>fR||Math.abs(this._y1-o)>fR)&&(this._+="L"+r+","+o),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=o}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class e_{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class fZ{constructor(t,[n,i,r,o]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=o,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let h=0,g=0,p=i.length,m,y;h<p;h+=3,g+=2){const v=i[h]*2,x=i[h+1]*2,b=i[h+2]*2,_=t[v],E=t[v+1],w=t[x],O=t[x+1],S=t[b],k=t[b+1],A=w-_,F=O-E,C=S-_,M=k-E,D=A*A+F*F,N=C*C+M*M,I=(A*M-F*C)*2;if(!I)m=(_+S)/2-1e8*M,y=(E+k)/2+1e8*C;else if(Math.abs(I)<1e-8)m=(_+S)/2,y=(E+k)/2;else{const z=1/I;m=_+(M*D-F*N)*z,y=E+(A*N-C*D)*z}o[g]=m,o[g+1]=y}let a=n[n.length-1],s,u=a*4,l,c=t[2*a],f,d=t[2*a+1];r.fill(0);for(let h=0;h<n.length;++h)a=n[h],s=u,l=c,f=d,u=a*4,c=t[2*a],d=t[2*a+1],r[s+2]=r[u]=f-d,r[s+3]=r[u+1]=c-l}render(t){const n=t==null?t=new eu:void 0,{delaunay:{halfedges:i,inedges:r,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=a[h],m=a[h+1],y=a[g],v=a[g+1];this._renderSegment(p,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(r[l]/3)*2,d=a[f],h=a[f+1],g=u*4,p=this._project(d,h,s[g+2],s[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new eu:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new eu:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(r[a]!==r[a-2]||r[a+1]!==r[a-1])&&n.lineTo(r[a],r[a+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new e_;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,o){let a;const s=this._regioncode(t,n),u=this._regioncode(i,r);s===0&&u===0?(o.moveTo(t,n),o.lineTo(i,r)):(a=this._clipSegment(t,n,i,r,s,u))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let o=0,a=n.length;o<a;o+=2)for(let s=0,u=r.length;s<u;s+=2)if(n[o]==r[s]&&n[o+1]==r[s+1]&&n[(o+2)%a]==r[(s+u-2)%u]&&n[(o+3)%a]==r[(s+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:o}}=this,a=i[t];if(a===-1)return null;const s=[];let u=a;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=r[u]}while(u!==a&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,o,a,s=n[i-2],u=n[i-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<i;h+=2)if(o=s,a=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,r?r.push(s,u):r=[s,u];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(o,a,s,u,l,c))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(s,u,o,a,c,l))===null)continue;[y,v,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(p,m):r=[p,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,o,a){for(;;){if(o===0&&a===0)return[t,n,i,r];if(o&a)return null;let s,u,l=o||a;l&8?(s=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(s=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),s=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),s=this.xmin),o?(t=s,n=u,o=this._regioncode(t,n)):(i=s,r=u,a=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,o,a){let s=Array.from(n),u;if((u=this._project(s[0],s[1],i,r))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,i,r,o){for(;n!==i;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(r[o]!==a||r[o+1]!==s)&&this.contains(t,a,s)&&(r.splice(o,0,a,s),o+=2)}if(r.length>4)for(let a=0;a<r.length;a+=2){const s=(a+2)%r.length,u=(a+4)%r.length;(r[a]===r[s]&&r[s]===r[u]||r[a+1]===r[s+1]&&r[s+1]===r[u+1])&&(r.splice(s,2),a-=2)}return o}_project(t,n,i,r){let o=1/0,a,s,u;if(r<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/r)<o&&(u=this.ymin,s=t+(o=a)*i)}else if(r>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/r)<o&&(u=this.ymax,s=t+(o=a)*i)}if(i>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/i)<o&&(s=this.xmax,u=n+(o=a)*r)}else if(i<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/i)<o&&(s=this.xmin,u=n+(o=a)*r)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const dZ=2*Math.PI,Kl=Math.pow;function hZ(e){return e[0]}function gZ(e){return e[1]}function pZ(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],o=2*t[i+1],a=2*t[i+2];if((n[a]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}function mZ(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class t_{static from(t,n=hZ,i=gZ,r){return new t_("length"in t?yZ(t,n,i,r):Float64Array.from(vZ(t,n,i,r)))}constructor(t){this._delaunator=new Bm(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&pZ(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=mZ(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new Bm(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(i[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=r.length;u<l;++u)s[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,r.length===2&&(a[r[1]]=0))}voronoi(t){return new fZ(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3==2?l-2:l+1,a[l]!==t)return;if(l=o[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let o;for(;(o=this._step(i,t,n))>=0&&o!==i&&o!==r;)i=o;return o}_step(t,n,i){const{inedges:r,hull:o,_hullIndex:a,halfedges:s,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=Kl(n-l[t*2],2)+Kl(i-l[t*2+1],2);const d=r[t];let h=d;do{let g=u[h];const p=Kl(n-l[g*2],2)+Kl(i-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=o[(a[t]+1)%o.length],h!==g&&Kl(n-l[h*2],2)+Kl(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new eu:void 0,{points:i,halfedges:r,triangles:o}=this;for(let a=0,s=r.length;a<s;++a){const u=r[a];if(u<a)continue;const l=o[a]*2,c=o[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new eu:void 0,{points:r}=this;for(let o=0,a=r.length;o<a;o+=2){const s=r[o],u=r[o+1];t.moveTo(s+n,u),t.arc(s,u,n,0,dZ)}return i&&i.value()}renderHull(t){const n=t==null?t=new eu:void 0,{hull:i,points:r}=this,o=i[0]*2,a=i.length;t.moveTo(r[o],r[o+1]);for(let s=1;s<a;++s){const u=2*i[s];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new e_;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new eu:void 0,{points:r,triangles:o}=this,a=o[t*=3]*2,s=o[t+1]*2,u=o[t+2]*2;return n.moveTo(r[a],r[a+1]),n.lineTo(r[s],r[s+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new e_;return this.renderTriangle(t,n),n.value()}}function yZ(e,t,n,i){const r=e.length,o=new Float64Array(r*2);for(let a=0;a<r;++a){const s=e[a];o[a*2]=t.call(i,s,a,e),o[a*2+1]=n.call(i,s,a,e)}return o}function*vZ(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}function n_(e){R.call(this,null,e)}n_.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const bZ=[-1e5,-1e5,1e5,1e5];W(n_,R,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:bZ;const o=this.value=t_.from(i,e.x,e.y).voronoi(r);for(let a=0,s=i.length;a<s;++a){const u=o.cellPolygon(a);i[a][n]=u?xZ(u):null}return t.reflow(e.modified()).modifies(n)}});function xZ(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var wZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:n_}),i_=Math.PI/180,Rd=1<<11>>5,qm=1<<11;function _Z(){var e=[256,256],t,n,i,r,o,a,s,u=dR,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(xl()),p=CZ((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,x=[],b=l.map(E=>({text:t(E),font:n(E),style:r(E),weight:o(E),rotate:a(E),size:~~(i(E)+1e-14),padding:s(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,w)=>w.size-E.size);++v<y;){var _=b[v];_.x=e[0]*(c()+.5)>>1,_.y=e[1]*(c()+.5)>>1,EZ(g,_,b,v),_.hasText&&h(p,_,m)&&(x.push(_),m?SZ(m,_):m=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=e[0]>>1,_.y-=e[1]>>1)}return x};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Rd<<5)/p,g.height=qm/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,v=p.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=u(e),_=c()<.5?1:-1,E=-_,w,O,S;(w=b(E+=_))&&(O=~~w[0],S=~~w[1],!(Math.min(Math.abs(O),Math.abs(S))>=x));)if(p.x=y+O,p.y=v+S,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!OZ(p,g,e[0]))&&(!m||AZ(p,m))){for(var k=p.sprite,A=p.width>>5,F=e[0]>>5,C=p.x-(A<<4),M=C&127,D=32-M,N=p.y1-p.y0,I=(p.y+p.y0)*F+(C>>5),z,X=0;X<N;X++){z=0;for(var te=0;te<=A;te++)g[I+te]|=z<<D|(te<A?(z=k[X*A+te])>>>M:0);I+=F}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=tu(g),f):n},f.fontStyle=function(g){return arguments.length?(r=tu(g),f):r},f.fontWeight=function(g){return arguments.length?(o=tu(g),f):o},f.rotate=function(g){return arguments.length?(a=tu(g),f):a},f.text=function(g){return arguments.length?(t=tu(g),f):t},f.spiral=function(g){return arguments.length?(u=TZ[g]||g,f):u},f.fontSize=function(g){return arguments.length?(i=tu(g),f):i},f.padding=function(g){return arguments.length?(s=tu(g),f):s},f.random=function(g){return arguments.length?(c=g,f):c},f}function EZ(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,(Rd<<5)/o,qm/o);var a=0,s=0,u=0,l=n.length,c,f,d,h,g;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=r.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*i_),m=Math.cos(t.rotate*i_),y=c*m,v=c*p,x=d*m,b=d*p;c=Math.max(Math.abs(y+b),Math.abs(y-b))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=Rd<<5&&(a=0,s+=u,u=0),s+d>=qm)break;r.translate((a+(c>>1))/o,(s+(d>>1))/o),t.rotate&&r.rotate(t.rotate*i_),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var _=r.getImageData(0,0,(Rd<<5)/o,qm/o).data,E=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(a=t.xoff,a==null)return;s=t.yoff;var w=0,O=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var S=f*g+(h>>5),k=_[(s+g)*(Rd<<5)+(a+h)<<2]?1<<31-h%32:0;E[S]|=k,w|=k}w?O=g:(t.y0++,d--,g--,s++)}t.y1=t.y0+O,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function OZ(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,o=e.x-(r<<4),a=o&127,s=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<s|(d<r?(c=i[f*r+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function SZ(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function AZ(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function dR(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function kZ(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(o){var a=o<0?-1:1;switch(Math.sqrt(1+4*a*o)-a&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function CZ(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function tu(e){return typeof e=="function"?e:function(){return e}}var TZ={archimedean:dR,rectangular:kZ};const hR=["x","y","font","fontSize","fontStyle","fontWeight","angle"],FZ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function r_(e){R.call(this,_Z(),e)}r_.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:hR}]};W(r_,R,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&L("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return _e(p)&&t.modified(p.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||FZ.some(n)))return;const r=t.materialize(t.SOURCE).source,o=this.value,a=e.as||hR;let s=e.fontSize||14,u;if(_e(s)?u=e.fontSizeRange:s=gn(s),u){const g=s,p=Ie("sqrt")().domain(Mr(r,g)).range(u);s=m=>p(g(m))}r.forEach(g=>{g[a[0]]=NaN,g[a[1]]=NaN,g[a[3]]=0});const l=o.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(Mi).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[a[0]]=p.x+f,m[a[1]]=p.y+d,m[a[2]]=p.font,m[a[3]]=p.size,m[a[4]]=p.style,m[a[5]]=p.weight,m[a[6]]=p.rotate;return t.reflow(i).modifies(a)}});var DZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:r_});const MZ=e=>new Uint8Array(e),NZ=e=>new Uint16Array(e),jd=e=>new Uint32Array(e);function RZ(){let e=8,t=[],n=jd(0),i=Wm(0,e),r=Wm(0,e);return{data:()=>t,seen:()=>n=jZ(n,t.length),add(o){for(let a=0,s=t.length,u=o.length,l;a<u;++a)l=o[a],l._index=s++,t.push(l)},remove(o,a){const s=t.length,u=Array(s-o),l=t;let c,f,d;for(f=0;!a[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:o=>r[o]=i[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,a){i[o]|=a},clear(o,a){i[o]&=~a},resize(o,a){const s=i.length;(o>s||a>e)&&(e=Math.max(a,e),i=Wm(o,e,i),r=Wm(o,e))}}}function jZ(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Wm(e,t,n){const i=(t<257?MZ:t<65537?NZ:jd)(e);return n&&i.set(n),i}function gR(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,o){const a=this,s=a.bisect(a.range,r.value),u=r.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=i;for(d=c;d<f;++d)o[u[d]]|=i;return a}}}function pR(){let e=jd(0),t=[],n=0;function i(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=jd(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=$Z(h,d),c)g=t,p=e,t=Array(c+f),e=jd(c+f),LZ(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function o(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function a(s,u){let l;return u?l=u.length:(u=t,l=n),[h9(u,s[0],0,l),yg(u,s[1],0,l)]}return{insert:i,remove:r,bisect:a,reindex:o,index:()=>e,size:()=>n}}function $Z(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],o=e[i];return r<o?-1:r>o?1:0}),m9(e,t)}function LZ(e,t,n,i,r,o,a,s,u){let l=0,c=0,f;for(f=0;l<i&&c<a;++f)t[l]<r[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=r[c],u[f]=o[c++]+e);for(;l<i;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)s[f]=r[c],u[f]=o[c]+e}function o_(e){R.call(this,RZ(),e),this._indices=null,this._dims=null}o_.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};W(o_,R,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},o=this._dims=[],a=i.length;let s=0,u,l;for(;s<a;++s)u=n[s].fname,l=r[u]||(r[u]=pR()),o.push(gR(l,s,i[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=r.length,g={};let p,m,y,v,x,b,_,E,w;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(b={},v=t.mod,_=0,E=v.length;_<E;++_)b[v[_]._index]=1;for(_=0;_<h;++_)w=i[_],(!a[_]||e.modified("fields",_)||t.modified(w.fields))&&(y=w.fname,(p=g[y])||(o[y]=m=pR(),g[y]=p=m.insert(w,t.source,0)),a[_]=gR(m,_,r[_]).onAdd(p,u));for(_=0,E=s.data().length;_<E;++_)x[_]||(l[_]!==u[_]?f.push(_):b[_]&&u[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=r.size()+i.length,f=o.length;let d=r.size(),h,g,p;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)g=s[h].fname,p=u[g]||(u[g]=a[g].insert(s[h],i,d)),o[h].onAdd(p,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),o=i.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,r[l]!==o&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,o=r.curr(),a=r.prev(),s=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=g=o[h],o[h]=s,g!==s&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const o=r.remove(t,n);for(const a in i)i[a].reindex(o)})},update(e,t,n){const i=this._dims,r=e.query,o=t.stamp,a=i.length;let s=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,s=0;l<a;++l)!e.modified("query",l)||(s|=i[l].one,this.incrementAll(i[l],r[l],o,n.add),n.rem=n.add);return s},incrementAll(e,t,n,i){const r=this.value,o=r.seen(),a=r.curr(),s=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,o=r.curr(),a=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=a[g],o[m]^=h,i.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=a[g],o[m]^=h,i.push(m);e.range=t.slice()}});function a_(e){R.call(this,null,e)}a_.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};W(a_,R,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),a=i.data(),s=i.curr(),u=i.prev(),l=c=>s[c]&n?null:a[c];return o.filter(o.MOD,l),r&r-1?(o.filter(o.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?a[c]:null}),o.filter(o.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(s[c]&n)===r?a[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var IZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:o_,resolvefilter:a_});const PZ="RawCode",nu="Literal",zZ="Property",BZ="Identifier",UZ="ArrayExpression",qZ="BinaryExpression",mR="CallExpression",WZ="ConditionalExpression",HZ="LogicalExpression",GZ="MemberExpression",VZ="ObjectExpression",YZ="UnaryExpression";function fr(e){this.type=e}fr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=XZ(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function XZ(e){switch(e.type){case UZ:return e.elements;case qZ:case HZ:return[e.left,e.right];case mR:return[e.callee].concat(e.arguments);case WZ:return[e.test,e.consequent,e.alternate];case GZ:return[e.object,e.property];case VZ:return e.properties;case zZ:return[e.key,e.value];case YZ:return[e.argument];case BZ:case nu:case PZ:default:return[]}}var Kr,ee,j,wn,Ye,Hm=1,$d=2,iu=3,Xa=4,Gm=5,ru=6,ei=7,Ld=8,KZ=9;Kr={};Kr[Hm]="Boolean";Kr[$d]="<end>";Kr[iu]="Identifier";Kr[Xa]="Keyword";Kr[Gm]="Null";Kr[ru]="Numeric";Kr[ei]="Punctuator";Kr[Ld]="String";Kr[KZ]="RegularExpression";var JZ="ArrayExpression",QZ="BinaryExpression",ZZ="CallExpression",eee="ConditionalExpression",yR="Identifier",tee="Literal",nee="LogicalExpression",iee="MemberExpression",ree="ObjectExpression",oee="Property",aee="UnaryExpression",Bt="Unexpected token %0",see="Unexpected number",uee="Unexpected string",lee="Unexpected identifier",cee="Unexpected reserved word",fee="Unexpected end of input",s_="Invalid regular expression",u_="Invalid regular expression: missing /",vR="Octal literals are not allowed in strict mode.",dee="Duplicate data property in object literal not allowed in strict mode",tn="ILLEGAL",Id="Disabled.",hee=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),gee=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Vm(e,t){if(!e)throw new Error("ASSERT: "+t)}function Bo(e){return e>=48&&e<=57}function l_(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Pd(e){return"01234567".indexOf(e)>=0}function pee(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function zd(e){return e===10||e===13||e===8232||e===8233}function Bd(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&hee.test(String.fromCharCode(e))}function Ym(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&gee.test(String.fromCharCode(e))}const mee={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function bR(){for(;j<wn;){const e=ee.charCodeAt(j);if(pee(e)||zd(e))++j;else break}}function c_(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<wn&&l_(ee[j])?(i=ee[j++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Pe({},Bt,tn);return String.fromCharCode(r)}function yee(){var e,t,n,i;for(e=ee[j],t=0,e==="}"&&Pe({},Bt,tn);j<wn&&(e=ee[j++],!!l_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Pe({},Bt,tn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function xR(){var e,t;for(e=ee.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(ee.charCodeAt(j)!==117&&Pe({},Bt,tn),++j,e=c_("u"),(!e||e==="\\"||!Bd(e.charCodeAt(0)))&&Pe({},Bt,tn),t=e);j<wn&&(e=ee.charCodeAt(j),!!Ym(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ee.charCodeAt(j)!==117&&Pe({},Bt,tn),++j,e=c_("u"),(!e||e==="\\"||!Ym(e.charCodeAt(0)))&&Pe({},Bt,tn),t+=e);return t}function vee(){var e,t;for(e=j++;j<wn;){if(t=ee.charCodeAt(j),t===92)return j=e,xR();if(Ym(t))++j;else break}return ee.slice(e,j)}function bee(){var e,t,n;return e=j,t=ee.charCodeAt(j)===92?xR():vee(),t.length===1?n=iu:mee.hasOwnProperty(t)?n=Xa:t==="null"?n=Gm:t==="true"||t==="false"?n=Hm:n=iu,{type:n,value:t,start:e,end:j}}function f_(){var e=j,t=ee.charCodeAt(j),n,i=ee[j],r,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:ei,value:String.fromCharCode(t),start:e,end:j};default:if(n=ee.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:ei,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,ee.charCodeAt(j)===61&&++j,{type:ei,value:ee.slice(e,j),start:e,end:j}}}if(a=ee.substr(j,4),a===">>>=")return j+=4,{type:ei,value:a,start:e,end:j};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return j+=3,{type:ei,value:o,start:e,end:j};if(r=o.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return j+=2,{type:ei,value:r,start:e,end:j};if(r==="//"&&Pe({},Bt,tn),"<>=!+-*%&|^/".indexOf(i)>=0)return++j,{type:ei,value:i,start:e,end:j};Pe({},Bt,tn)}function xee(e){let t="";for(;j<wn&&l_(ee[j]);)t+=ee[j++];return t.length===0&&Pe({},Bt,tn),Bd(ee.charCodeAt(j))&&Pe({},Bt,tn),{type:ru,value:parseInt("0x"+t,16),start:e,end:j}}function wee(e){let t="0"+ee[j++];for(;j<wn&&Pd(ee[j]);)t+=ee[j++];return(Bd(ee.charCodeAt(j))||Bo(ee.charCodeAt(j)))&&Pe({},Bt,tn),{type:ru,value:parseInt(t,8),octal:!0,start:e,end:j}}function wR(){var e,t,n;if(n=ee[j],Vm(Bo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=ee[j++],n=ee[j],e==="0"){if(n==="x"||n==="X")return++j,xee(t);if(Pd(n))return wee(t);n&&Bo(n.charCodeAt(0))&&Pe({},Bt,tn)}for(;Bo(ee.charCodeAt(j));)e+=ee[j++];n=ee[j]}if(n==="."){for(e+=ee[j++];Bo(ee.charCodeAt(j));)e+=ee[j++];n=ee[j]}if(n==="e"||n==="E")if(e+=ee[j++],n=ee[j],(n==="+"||n==="-")&&(e+=ee[j++]),Bo(ee.charCodeAt(j)))for(;Bo(ee.charCodeAt(j));)e+=ee[j++];else Pe({},Bt,tn);return Bd(ee.charCodeAt(j))&&Pe({},Bt,tn),{type:ru,value:parseFloat(e),start:t,end:j}}function _ee(){var e="",t,n,i,r,o=!1;for(t=ee[j],Vm(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<wn;)if(i=ee[j++],i===t){t="";break}else if(i==="\\")if(i=ee[j++],!i||!zd(i.charCodeAt(0)))switch(i){case"u":case"x":ee[j]==="{"?(++j,e+=yee()):e+=c_(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Pd(i)?(r="01234567".indexOf(i),r!==0&&(o=!0),j<wn&&Pd(ee[j])&&(o=!0,r=r*8+"01234567".indexOf(ee[j++]),"0123".indexOf(i)>=0&&j<wn&&Pd(ee[j])&&(r=r*8+"01234567".indexOf(ee[j++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&ee[j]===`
`&&++j;else{if(zd(i.charCodeAt(0)))break;e+=i}return t!==""&&Pe({},Bt,tn),{type:Ld,value:e,octal:o,start:n,end:j}}function Eee(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Pe({},s_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Pe({},s_)}try{return new RegExp(e,t)}catch{return null}}function Oee(){var e,t,n,i,r;for(e=ee[j],Vm(e==="/","Regular expression literal must start with a slash"),t=ee[j++],n=!1,i=!1;j<wn;)if(e=ee[j++],t+=e,e==="\\")e=ee[j++],zd(e.charCodeAt(0))&&Pe({},u_),t+=e;else if(zd(e.charCodeAt(0)))Pe({},u_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Pe({},u_),r=t.substr(1,t.length-2),{value:r,literal:t}}function See(){var e,t,n;for(t="",n="";j<wn&&(e=ee[j],!!Ym(e.charCodeAt(0)));)++j,e==="\\"&&j<wn?Pe({},Bt,tn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Pe({},s_,n),{value:n,literal:t}}function Aee(){var e,t,n,i;return Ye=null,bR(),e=j,t=Oee(),n=See(),i=Eee(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function kee(e){return e.type===iu||e.type===Xa||e.type===Hm||e.type===Gm}function _R(){if(bR(),j>=wn)return{type:$d,start:j,end:j};const e=ee.charCodeAt(j);return Bd(e)?bee():e===40||e===41||e===59?f_():e===39||e===34?_ee():e===46?Bo(ee.charCodeAt(j+1))?wR():f_():Bo(e)?wR():f_()}function ti(){const e=Ye;return j=e.end,Ye=_R(),j=e.end,e}function ER(){const e=j;Ye=_R(),j=e}function Cee(e){const t=new fr(JZ);return t.elements=e,t}function OR(e,t,n){const i=new fr(e==="||"||e==="&&"?nee:QZ);return i.operator=e,i.left=t,i.right=n,i}function Tee(e,t){const n=new fr(ZZ);return n.callee=e,n.arguments=t,n}function Fee(e,t,n){const i=new fr(eee);return i.test=e,i.consequent=t,i.alternate=n,i}function d_(e){const t=new fr(yR);return t.name=e,t}function Ud(e){const t=new fr(tee);return t.value=e.value,t.raw=ee.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function SR(e,t,n){const i=new fr(iee);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function Dee(e){const t=new fr(ree);return t.properties=e,t}function AR(e,t,n){const i=new fr(oee);return i.key=t,i.value=n,i.kind=e,i}function Mee(e,t){const n=new fr(aee);return n.operator=e,n.argument=t,n.prefix=!0,n}function Pe(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(o,a)=>(Vm(a<i.length,"Message reference must be in range"),i[a]));throw n=new Error(r),n.index=j,n.description=r,n}function Xm(e){e.type===$d&&Pe(e,fee),e.type===ru&&Pe(e,see),e.type===Ld&&Pe(e,uee),e.type===iu&&Pe(e,lee),e.type===Xa&&Pe(e,cee),Pe(e,Bt,e.value)}function _n(e){const t=ti();(t.type!==ei||t.value!==e)&&Xm(t)}function ut(e){return Ye.type===ei&&Ye.value===e}function h_(e){return Ye.type===Xa&&Ye.value===e}function Nee(){const e=[];for(j=Ye.start,_n("[");!ut("]");)ut(",")?(ti(),e.push(null)):(e.push(ou()),ut("]")||_n(","));return ti(),Cee(e)}function kR(){j=Ye.start;const e=ti();return e.type===Ld||e.type===ru?(e.octal&&Pe(e,vR),Ud(e)):d_(e.value)}function Ree(){var e,t,n,i;if(j=Ye.start,e=Ye,e.type===iu)return n=kR(),_n(":"),i=ou(),AR("init",n,i);if(e.type===$d||e.type===ei)Xm(e);else return t=kR(),_n(":"),i=ou(),AR("init",t,i)}function jee(){var e=[],t,n,i,r={},o=String;for(j=Ye.start,_n("{");!ut("}");)t=Ree(),t.key.type===yR?n=t.key.name:n=o(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Pe({},dee):r[i]=!0,e.push(t),ut("}")||_n(",");return _n("}"),Dee(e)}function $ee(){_n("(");const e=g_();return _n(")"),e}const Lee={if:1};function Iee(){var e,t,n;if(ut("("))return $ee();if(ut("["))return Nee();if(ut("{"))return jee();if(e=Ye.type,j=Ye.start,e===iu||Lee[Ye.value])n=d_(ti().value);else if(e===Ld||e===ru)Ye.octal&&Pe(Ye,vR),n=Ud(ti());else{if(e===Xa)throw new Error(Id);e===Hm?(t=ti(),t.value=t.value==="true",n=Ud(t)):e===Gm?(t=ti(),t.value=null,n=Ud(t)):ut("/")||ut("/=")?(n=Ud(Aee()),ER()):Xm(ti())}return n}function Pee(){const e=[];if(_n("("),!ut(")"))for(;j<wn&&(e.push(ou()),!ut(")"));)_n(",");return _n(")"),e}function zee(){j=Ye.start;const e=ti();return kee(e)||Xm(e),d_(e.value)}function Bee(){return _n("."),zee()}function Uee(){_n("[");const e=g_();return _n("]"),e}function qee(){var e,t,n;for(e=Iee();;)if(ut("."))n=Bee(),e=SR(".",e,n);else if(ut("("))t=Pee(),e=Tee(e,t);else if(ut("["))n=Uee(),e=SR("[",e,n);else break;return e}function CR(){const e=qee();if(Ye.type===ei&&(ut("++")||ut("--")))throw new Error(Id);return e}function Km(){var e,t;if(Ye.type!==ei&&Ye.type!==Xa)t=CR();else{if(ut("++")||ut("--"))throw new Error(Id);if(ut("+")||ut("-")||ut("~")||ut("!"))e=ti(),t=Km(),t=Mee(e.value,t);else{if(h_("delete")||h_("void")||h_("typeof"))throw new Error(Id);t=CR()}}return t}function TR(e){let t=0;if(e.type!==ei&&e.type!==Xa)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function Wee(){var e,t,n,i,r,o,a,s,u,l;if(e=Ye,u=Km(),i=Ye,r=TR(i),r===0)return u;for(i.prec=r,ti(),t=[e,Ye],a=Km(),o=[u,i,a];(r=TR(Ye))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=OR(s,u,a),o.push(n);i=ti(),i.prec=r,o.push(i),t.push(Ye),n=Km(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=OR(o[l-1].value,o[l-2],n),l-=2;return n}function ou(){var e,t,n;return e=Wee(),ut("?")&&(ti(),t=ou(),_n(":"),n=ou(),e=Fee(e,t,n)),e}function g_(){const e=ou();if(ut(","))throw new Error(Id);return e}function p_(e){ee=e,j=0,wn=ee.length,Ye=null,ER();const t=g_();if(Ye.type!==$d)throw new Error("Unexpect token after expression.");return t}var FR={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function DR(e){function t(a,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(a,s,u){return l=>t(a,l,s,u)}const i="new Date",r="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&L("Missing arguments to clamp function."),a.length>3&&L("Too many arguments to clamp function.");const s=a.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:o,test:n("test",o),if:function(a){a.length<3&&L("Missing arguments to if function."),a.length>3&&L("Too many arguments to if function.");const s=a.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function Hee(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function MR(e){e=e||{};const t=e.allowed?er(e.allowed):{},n=e.forbidden?er(e.forbidden):{},i=e.constants||FR,r=(e.functions||DR)(f),o=e.globalvar,a=e.fieldvar,s=_e(o)?o:g=>`${o}["${g}"]`;let u={},l={},c=0;function f(g){if(K(g))return g;const p=d[g.type];return p==null&&L("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:re(n,p)?L("Illegal identifier: "+p):re(i,p)?i[p]:re(t,p)?p:(u[p]=1,s(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===a&&(l[Hee(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&L("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=re(r,p)&&r[p];return y||L("Unrecognized function: "+p),_e(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=r,h.constants=i,h}function Gee(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Vee(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Yee(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function Yee(e){return(t,n)=>Gee(e(t),n)}const m_="intersect",NR="union",Xee="vlMulti",Kee="vlPoint",RR="or",Jee="and",Qee="_vgsid_",Zee="E",ete="R",tte="R-E",nte="R-LE",ite="R-RE",Jm="index:unit";function jR(e,t){for(var n=t.fields,i=t.values,r=n.length,o=0,a,s;o<r;++o)if(s=n[o],s.getter=Gn.getter||Gn(s.field),a=s.getter(e),ga(a)&&(a=hn(a)),ga(i[o])&&(i[o]=hn(i[o])),ga(i[o][0])&&(i[o]=i[o].map(hn)),s.type===Zee){if(P(i[o])?i[o].indexOf(a)<0:a!==i[o])return!1}else if(s.type===ete){if(!al(a,i[o]))return!1}else if(s.type===ite){if(!al(a,i[o],!0,!1))return!1}else if(s.type===tte){if(!al(a,i[o],!1,!1))return!1}else if(s.type===nte&&!al(a,i[o],!1,!0))return!1;return!0}function rte(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],o=i?i[Jm]&&i[Jm].value:void 0,a=n===m_,s=r.length,u=0,l,c,f,d,h;u<s;++u)if(l=r[u],o&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=jR(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=jR(t,l),a^h)return h;return s&&a}const y_=Gn(Qee),$R=Vee(y_),ote=$R.left,ate=$R.right;function ste(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],o=i?i[Jm]&&i[Jm].value:void 0,a=n===m_,s=y_(t),u=ote(r,s);if(u===r.length||y_(r[u])!==s)return!1;if(o&&a){if(o.size===1)return!0;if(ate(r,s)-u<o.size)return!1}return!0}function ute(e,t){return e.map(n=>Ee({values:t.fields.map(i=>(i.getter||(i.getter=Gn(i.field)))(n.datum))},t))}function lte(e,t,n,i){for(var r=this.context.data[e],o=r?r.values.value:[],a={},s={},u={},l,c,f,d,h,g,p,m,y,v=o.length,x=0,b,_;x<v;++x){for(l=o[x],d=l.unit,c=l.fields,f=l.values,b=0,_=c.length;b<_;++b)h=c[b],g=a[h.field]||(a[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=LR[m+"_union"],g[d]=y(p,J(f[b]));n&&(p=s[d]||(s[d]=[]),p.push(J(f).reduce((E,w,O)=>(E[c[O].field]=w,E),{})))}if(t=t||NR,Object.keys(a).forEach(E=>{a[E]=Object.keys(a[E]).map(w=>a[E][w]).reduce((w,O)=>w===void 0?O:LR[u[E]+"_"+t](w,O))}),o=Object.keys(s),n&&o.length){const E=i?Kee:Xee;a[E]=t===NR?{[RR]:o.reduce((w,O)=>(w.push(...s[O]),w),[])}:{[Jee]:o.map(w=>({[RR]:s[w]}))}}return a}var LR={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=hn(t[0]),i=hn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=hn(t[0]),i=hn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const cte=":",fte="@";function v_(e,t,n,i){t[0].type!==nu&&L("First argument to selection functions must be a string literal.");const r=t[0].value,o=t.length>=2&&Fe(t).value,a="unit",s=fte+a,u=cte+r;o===m_&&!re(i,s)&&(i[s]=n.getData(r).indataRef(n,a)),re(i,u)||(i[u]=n.getData(r).tuplesRef())}function IR(e){const t=this.context.data[e];return t?t.values.value:[]}function dte(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function hte(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Ti).insert(t)),1}function gte(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const qd=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},pte=qd("format"),PR=qd("timeFormat"),mte=qd("utcFormat"),yte=qd("timeParse"),vte=qd("utcParse"),Qm=new Date(2e3,0,1);function Zm(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(Qm.setYear(2e3),Qm.setMonth(e),Qm.setDate(t),PR.call(this,Qm,n))}function bte(e){return Zm.call(this,e,1,"%B")}function xte(e){return Zm.call(this,e,1,"%b")}function wte(e){return Zm.call(this,0,2+e,"%A")}function _te(e){return Zm.call(this,0,2+e,"%a")}const Ete=":",Ote="@",b_="%",zR="$";function x_(e,t,n,i){t[0].type!==nu&&L("First argument to data functions must be a string literal.");const r=t[0].value,o=Ete+r;if(!re(o,i))try{i[o]=n.getData(r).tuplesRef()}catch{}}function Ste(e,t,n,i){t[0].type!==nu&&L("First argument to indata must be a string literal."),t[1].type!==nu&&L("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,a=Ote+o;re(a,i)||(i[a]=n.getData(r).indataRef(n,o))}function ni(e,t,n,i){if(t[0].type===nu)BR(n,i,t[0].value);else for(e in n.scales)BR(n,i,e)}function BR(e,t,n){const i=b_+n;if(!re(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Uo(e,t){let n;return _e(e)?e:K(e)?(n=t.scales[e])&&n.value:void 0}function Ate(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=ni,n._range=ni,n._scale=ni;const i=r=>"_["+(r.type===nu?H(b_+r.value):H(b_)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function w_(e,t){return function(n,i,r){if(n){const o=Uo(n,(r||this).context);return o&&o.path[e](i)}else return t(i)}}const kte=w_("area",XY),Cte=w_("bounds",ZY),Tte=w_("centroid",oX);function Fte(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function __(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function Dte(){return __(this.context.dataflow,"warn",arguments)}function Mte(){return __(this.context.dataflow,"info",arguments)}function Nte(){return __(this.context.dataflow,"debug",arguments)}function E_(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function O_(e){const t=Ta(e),n=E_(t.r),i=E_(t.g),r=E_(t.b);return .2126*n+.7152*i+.0722*r}function Rte(e,t){const n=O_(e),i=O_(t),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}function jte(){const e=[].slice.call(arguments);return e.unshift({}),Ee(...e)}function UR(e,t){return e===t||e!==e&&t!==t?!0:P(e)?P(t)&&e.length===t.length?$te(e,t):!1:Q(e)&&Q(t)?qR(e,t):!1}function $te(e,t){for(let n=0,i=e.length;n<i;++n)if(!UR(e[n],t[n]))return!1;return!0}function qR(e,t){for(const n in e)if(!UR(e[n],t[n]))return!1;return!0}function WR(e){return t=>qR(e,t)}function Lte(e,t,n,i,r,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c=s.changes,f,d;if(a._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(s.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{s.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Ti:P(n)||Fg(n)?n:WR(n),c.remove(f)),t&&c.insert(t),i&&(f=WR(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in o)c.modify(r,d,o[d]);return 1}function Ite(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function Pte(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const HR={};function zte(e,t){const n=HR[t]||(HR[t]=Gn(t));return P(e)?e.map(n):n(e)}function S_(e){return P(e)||ArrayBuffer.isView(e)?e:null}function A_(e){return S_(e)||(K(e)?e:null)}function Bte(e,...t){return S_(e).join(...t)}function Ute(e,...t){return A_(e).indexOf(...t)}function qte(e,...t){return A_(e).lastIndexOf(...t)}function Wte(e,...t){return A_(e).slice(...t)}function Hte(e,t,n){return _e(n)&&L("Function argument passed to replace."),String(e).replace(t,n)}function Gte(e){return S_(e).slice().reverse()}function Vte(e,t,n){return ix(e||0,t||0,n||0)}function Yte(e,t){const n=Uo(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Xte(e,t){const n=Uo(e,(t||this).context);return n?n.copy():void 0}function Kte(e,t){const n=Uo(e,(t||this).context);return n?n.domain():[]}function Jte(e,t,n){const i=Uo(e,(n||this).context);return i?P(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function Qte(e,t){const n=Uo(e,(t||this).context);return n&&n.range?n.range():[]}function Zte(e,t,n){const i=Uo(e,(n||this).context);return i?i(t):void 0}function ene(e,t,n,i,r){e=Uo(e,(r||this).context);const o=ZD(t,n);let a=e.domain(),s=a[0],u=Fe(a),l=dn;return u-s?l=ID(e,s,u):e=(e.interpolator?Ie("sequential")().interpolator(e.interpolator()):Ie("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+i||15),s!==a[0]&&a.unshift(s),u!==Fe(a)&&a.push(u)),a.forEach(c=>o.stop(l(c),e(c))),o}function tne(e,t,n){const i=Uo(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function nne(e){let t=null;return function(n){return n?Gf(n,t=t||Tl(e)):e}}const GR=e=>e.data;function VR(e,t){const n=IR.call(t,e);return n.root&&n.root.lookup||{}}function ine(e,t,n){const i=VR(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(GR):void 0}function rne(e,t){const n=VR(e,this)[t];return n?n.ancestors().map(GR):void 0}const YR=()=>typeof window!="undefined"&&window||null;function one(){const e=YR();return e?e.screen:{}}function ane(){const e=YR();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function sne(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function une(e,t,n){if(!e)return[];const[i,r]=e,o=new Nt().set(i[0],i[1],r[0],r[1]),a=n||this.context.dataflow.scenegraph().root;return h3(a,o,lne(t))}function lne(e){let t=null;if(e){const n=J(e.marktype),i=J(e.markname);t=r=>(!n.length||n.some(o=>r.marktype===o))&&(!i.length||i.some(o=>r.name===o))}return t}const Wd={random(){return Mi()},cumulativeNormal:Ig,cumulativeLogNormal:Lv,cumulativeUniform:Bv,densityNormal:Mv,densityLogNormal:$v,densityUniform:zv,quantileNormal:Pg,quantileLogNormal:Iv,quantileUniform:Uv,sampleNormal:Lg,sampleLogNormal:jv,sampleUniform:Pv,isArray:P,isBoolean:ha,isDate:ga,isDefined(e){return e!==void 0},isNumber:Je,isObject:Q,isRegExp:yk,isString:K,isTuple:Fg,isValid(e){return e!=null&&e===e},toBoolean:My,toDate:Ny,toNumber:hn,toString:Ry,indexof:Ute,join:Bte,lastindexof:qte,replace:Hte,reverse:Gte,slice:Wte,flush:pk,lerp:vk,merge:jte,pad:wk,peek:Fe,pluck:zte,span:af,inrange:al,truncate:_k,rgb:Ta,lab:ep,hcl:tp,hsl:Qg,luminance:O_,contrast:Rte,sequence:yi,format:pte,utcFormat:mte,utcParse:vte,utcOffset:uC,utcSequence:fC,timeFormat:PR,timeParse:yte,timeOffset:sC,timeSequence:cC,timeUnitSpecifier:Kk,monthFormat:bte,monthAbbrevFormat:xte,dayFormat:wte,dayAbbrevFormat:_te,quarter:fk,utcquarter:dk,week:Qk,utcweek:tC,dayofyear:Jk,utcdayofyear:eC,warn:Dte,info:Mte,debug:Nte,extent:Mr,inScope:Fte,intersect:une,clampRange:hk,pinchDistance:Ite,pinchAngle:Pte,screen:one,containerSize:sne,windowSize:ane,bandspace:Vte,setdata:hte,pathShape:nne,panLinear:sk,panLog:uk,panPow:lk,panSymlog:ck,zoomLinear:Ay,zoomLog:ky,zoomPow:gg,zoomSymlog:Cy,encode:gte,modify:Lte},cne=["view","item","group","xy","x","y"],fne="event.vega.",XR="this.",k_={},KR={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${H(zR+e)}]`,functions:dne,constants:FR,visitors:k_},C_=MR(KR);function dne(e){const t=DR(e);cne.forEach(n=>t[n]=fne+n);for(const n in Wd)t[n]=XR+n;return Ee(t,Ate(e,Wd,k_)),t}function St(e,t,n){return arguments.length===1?Wd[e]:(Wd[e]=t,n&&(k_[e]=n),C_&&(C_.functions[e]=XR+e),this)}St("bandwidth",Yte,ni);St("copy",Xte,ni);St("domain",Kte,ni);St("range",Qte,ni);St("invert",Jte,ni);St("scale",Zte,ni);St("gradient",ene,ni);St("geoArea",kte,ni);St("geoBounds",Cte,ni);St("geoCentroid",Tte,ni);St("geoShape",tne,ni);St("indata",dte,Ste);St("data",IR,x_);St("treePath",ine,x_);St("treeAncestors",rne,x_);St("vlSelectionTest",rte,v_);St("vlSelectionIdTest",ste,v_);St("vlSelectionResolve",lte,v_);St("vlSelectionTuples",ute);function Jr(e,t){const n={};let i;try{e=K(e)?e:H(e)+"",i=p_(e)}catch{L("Expression parse error: "+e)}i.visit(o=>{if(o.type!==mR)return;const a=o.callee.name,s=KR.visitors[a];s&&s(a,o.arguments,t,n)});const r=C_(i);return r.globals.forEach(o=>{const a=zR+o;!re(n,a)&&t.getSignal(o)&&(n[a]=t.signalRef(o))}),{$expr:Ee({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function hne(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const gne=er(["rule"]),JR=er(["group","image","rect"]);function pne(e,t){let n="";return gne[t]||(e.x2&&(e.x?(JR[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(JR[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function T_(e){return(e+"").toLowerCase()}function mne(e){return T_(e)==="operator"}function yne(e){return T_(e)==="collect"}function Hd(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function vne(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var bne={operator:(e,t)=>Hd(e,["_"],t.code),parameter:(e,t)=>Hd(e,["datum","_"],t.code),event:(e,t)=>Hd(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return Hd(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const a="o["+H(o)+"]";r+="$=".concat(i[o].code,";if(").concat(a,"!==$)").concat(a,"=$,m=1;")}return r+=pne(i,n),r+="return m;",Hd(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(H).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(o,a)=>{const s=t[a];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+a]=o,u="this.f".concat(a,"(a)"),l="this.f".concat(a,"(b)")),vne(u,l,-s,s)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function xne(e){const t=this;mne(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function wne(e){const t=this;if(e.params){const n=t.get(e.id);n||L("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function _ne(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=P(r)?r.map(o=>QR(o,n,t)):QR(r,n,t)}return t}function QR(e,t,n){if(!e||!Q(e))return e;for(let i=0,r=ZR.length,o;i<r;++i)if(o=ZR[i],re(e,o.key))return o.parse(e,t,n);return e}var ZR=[{key:"$ref",parse:Ene},{key:"$key",parse:Sne},{key:"$expr",parse:One},{key:"$field",parse:Ane},{key:"$encode",parse:Cne},{key:"$compare",parse:kne},{key:"$context",parse:Tne},{key:"$subflow",parse:Fne},{key:"$tupleid",parse:Dne}];function Ene(e,t){return t.get(e.$ref)||L("Operator not defined: "+e.$ref)}function One(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Hn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function Sne(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Dy(e.$key,e.$flat,t.expr.codegen))}function Ane(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Gn(e.$field,e.$name,t.expr.codegen))}function kne(e,t){const n="c:"+e.$compare+"_"+e.$order,i=J(e.$compare).map(r=>r&&r.$tupleid?ae:r);return t.fn[n]||(t.fn[n]=Ty(i,e.$order,t.expr.codegen))}function Cne(e,t){const n=e.$encode,i={};for(const r in n){const o=n[r];i[r]=Hn(t.encodeExpression(o.$expr),o.$fields),i[r].output=o.$output}return i}function Tne(e,t){return t}function Fne(e,t){const n=e.$subflow;return function(i,r,o){const a=t.fork().parse(n),s=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(o),s.detachSubflow=()=>t.detach(a),s}}function Dne(){return ae}function Mne(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(o=>t.get(o)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(o=>t.get(o)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&L("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function Nne(e){var t=this,n=Q(n=e.source)?n.$ref:n,i=t.get(n),r=null,o=e.update,a=void 0;i||L("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,i,r,o,a)}const Rne={skip:!0};function jne(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(o=>{const a=t.signals[o];e.signals(o,a)&&(i[o]=a.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(o=>{const a=t.data[o];e.data(o,a)&&(r[o]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function $ne(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(o=>{n.update(t.signals[o],r[o],Rne)}),Object.keys(i||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Ti).insert(i[o]))}),(e.subcontext||[]).forEach((o,a)=>{const s=t.subcontext[a];s&&s.setState(o)})}function ej(e,t,n,i){return new tj(e,t,n,i)}function tj(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||bne,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function nj(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}tj.prototype=nj.prototype={fork(){const e=new nj(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),yne(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const a=n.data[o]||(n.data[o]={});e.data[o].forEach(s=>a[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[T_(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:hne,parseOperator:xne,parseOperatorParameters:wne,parseParameters:_ne,parseStream:Mne,parseUpdate:Nne,getState:jne,setState:$ne};function Lne(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),ij(t,e.description()))}function ij(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function Ine(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const F_="default";function Pne(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:F_,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,o=r?K(r)?r:r.user:F_,a=i.item&&i.item.cursor||null;return r&&o===r.user&&a==r.item?r:{user:o,item:a}}),e.add(null,function(n){let i=n.cursor,r=this.value;return K(i)||(r=i.item,i=i.user),D_(e,i&&i!==F_?i:r||i),r},{cursor:t})}function D_(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function e0(e,t){var n=e._runtime.data;return re(n,t)||L("Unrecognized data set: "+t),n[t]}function zne(e,t){return arguments.length<2?e0(this,e).values.value:t0.call(this,e,Rs().remove(Ti).insert(t))}function t0(e,t){ZC(t)||L("Second argument to changes must be a changeset.");const n=e0(this,e);return n.modified=!0,this.pulse(n.input,t)}function Bne(e,t){return t0.call(this,e,Rs().insert(t))}function Une(e,t){return t0.call(this,e,Rs().remove(t))}function rj(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function oj(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function n0(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function qne(e){var t=n0(e),n=rj(e),i=oj(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(o){e.error(o)}})}function Wne(e,t,n){var i=e._renderer,r=i&&i.canvas(),o,a,s;return r&&(s=n0(e),a=t.changedTouches?t.changedTouches[0]:t,o=Np(a,r),o[0]-=s[0],o[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=Hne(e,n,o),t}function Hne(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(a){var s=i,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function o(a){if(!a)return n;K(a)&&(a=r(a));const s=n.slice();for(;a;)s[0]-=a.x||0,s[1]-=a.y||0,a=a.mark&&a.mark.group;return s}return{view:gn(e),item:gn(t||{}),group:r,xy:o,x:a=>o(a)[0],y:a=>o(a)[1]}}const aj="view",Gne="timer",Vne="window",Yne={trap:!1};function Xne(e){const t=Ee({defaults:{}},e),n=(i,r)=>{r.forEach(o=>{P(i[o])&&(i[o]=er(i[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function sj(e,t,n,i){e._eventListeners.push({type:n,sources:J(t),handler:i})}function Kne(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function i0(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||Q(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Jne(e,t,n){var i=this,r=new Rg(n),o=function(l,c){i.runAsync(null,()=>{e===aj&&Kne(i,t)&&l.preventDefault(),r.receive(Wne(i,l,c))})},a;if(e===Gne)i0(i,"timer",t)&&i.timer(o,t);else if(e===aj)i0(i,"view",t)&&i.addEventListener(t,o,Yne);else if(e===Vne?i0(i,"window",t)&&typeof window!="undefined"&&(a=[window]):typeof document!="undefined"&&i0(i,"selector",t)&&(a=document.querySelectorAll(e)),!a)i.warn("Can not resolve event source: "+e);else{for(var s=0,u=a.length;s<u;++s)a[s].addEventListener(t,o);sj(i,a,t,o)}return r}function uj(e){return e.item}function lj(e){return e.item.mark.source}function cj(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function Qne(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",uj),lj,cj(e)),this.on(this.events("view","mouseout",uj),lj,cj(t)),this}function Zne(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,o;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(o=n[i],r=o.sources.length;--r>=0;)o.sources[r].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function Ei(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const eie="vega-bind",tie="vega-bind-name",nie="vega-bind-radio";function iie(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,a)})}},i.debounce&&(r.update=Fy(i.debounce,r.update))),(i.input==null&&i.element?rie:aie)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function rie(e,t,n,i){const r=n.event||"input",o=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,o),sj(i,t,r,o),e.set=a=>{t.value=a,t.dispatchEvent(oie(r))}}function oie(e){return typeof Event!="undefined"?new Event(e):{type:e}}function aie(e,t,n,i){const r=i.signal(n.signal),o=Ei("div",{class:eie}),a=n.input==="radio"?o:o.appendChild(Ei("label"));a.appendChild(Ei("span",{class:tie},n.name||n.signal)),t.appendChild(o);let s=sie;switch(n.input){case"checkbox":s=uie;break;case"select":s=lie;break;case"radio":s=cie;break;case"range":s=fie;break}s(e,a,n,r)}function sie(e,t,n,i){const r=Ei("input");for(const o in n)o!=="signal"&&o!=="element"&&r.setAttribute(o==="input"?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=o=>r.value=o}function uie(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=Ei("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=a=>o.checked=!!a||null}function lie(e,t,n,i){const r=Ei("select",{name:n.signal}),o=n.labels||[];n.options.forEach((a,s)=>{const u={value:a};r0(a,i)&&(u.selected=!0),r.appendChild(Ei("option",u,(o[s]||a)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=a=>{for(let s=0,u=n.options.length;s<u;++s)if(r0(n.options[s],a)){r.selectedIndex=s;return}}}function cie(e,t,n,i){const r=Ei("span",{class:nie}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((a,s)=>{const u={type:"radio",name:n.signal,value:a};r0(a,i)&&(u.checked=!0);const l=Ei("input",u);l.addEventListener("change",()=>e.update(a));const c=Ei("label",{},(o[s]||a)+"");return c.prepend(l),r.appendChild(c),l}),e.set=a=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)r0(s[l].value,a)&&(s[l].checked=!0)}}function fie(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,a=n.step||ma(o,r,100),s=Ei("input",{type:"range",name:n.signal,min:o,max:r,step:a});s.value=i;const u=Ei("span",{},+i);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function r0(e,t){return e===t||e+""==t+""}function fj(e,t,n,i,r,o){return t=t||new i(e.loader()),t.initialize(n,rj(e),oj(e),n0(e),r,o).background(e.background())}function M_(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function die(e,t,n,i){const r=new i(e.loader(),M_(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,n0(e),e);return t&&t.handlers().forEach(o=>{r.on(o.type,o.handler)}),r}function hie(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=Up(i);e=n._el=e?N_(n,e,!0):null,Lne(n),o||n.error("Unrecognized renderer type: "+i);const a=o.handler||ad,s=e?o.renderer:o.headless;return n._renderer=s?fj(n,n._renderer,e,s):null,n._handler=die(n,n._handler,e,a),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=N_(n,t,!0):e.appendChild(Ei("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=N_(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{iie(n,u.element||t,u)})),n}function N_(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const Gd=e=>+e||0,gie=e=>({top:e,bottom:e,left:e,right:e});function dj(e){return Q(e)?{top:Gd(e.top),bottom:Gd(e.bottom),left:Gd(e.left),right:Gd(e.right)}:gie(Gd(e))}async function R_(e,t,n,i){const r=Up(t),o=r&&r.headless;return o||L("Unrecognized renderer type: "+t),await e.runAsync(),fj(e,null,null,o,n,i).renderAsync(e._scenegraph.root)}async function pie(e,t){e!==Ba.Canvas&&e!==Ba.SVG&&e!==Ba.PNG&&L("Unrecognized image type: "+e);const n=await R_(this,e,t);return e===Ba.SVG?mie(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function mie(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function yie(e,t){return(await R_(this,Ba.Canvas,e,t)).canvas()}async function vie(e){return(await R_(this,Ba.SVG,e)).svg()}function bie(e,t,n){return ej(e,ml,Wd,n).parse(t)}function xie(e){var t=this._runtime.scales;return re(t,e)||L("Unrecognized scale or projection: "+e),t[e].value}var hj="width",gj="height",j_="padding",pj={skip:!0};function mj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===j_?i.left+i.right:0)}function yj(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===j_?i.top+i.bottom:0)}function wie(e){var t=e._signals,n=t[hj],i=t[gj],r=t[j_];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=mj(e,s.size),o()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=yj(e,s.size),o()},{size:i});const a=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,a.rank=r.rank+1}function _ie(e,t,n,i,r,o){this.runAfter(a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(hj,n,pj),a._resizeWidth.skip(!0)),a.height()!==i&&(s=1,a.signal(gj,i,pj),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==r[0]||a._origin[1]!==r[1])&&(a._resize=1,a._origin=r),s&&a.run("enter"),o&&a.runAfter(u=>u.resize())},!1,1)}function Eie(e){return this._runtime.getState(e||{data:Oie,signals:Sie,recurse:!0})}function Oie(e,t){return t.modified&&P(t.input.value)&&e.indexOf("_:vega:_")}function Sie(e,t){return!(e==="parent"||t instanceof ml.proxy)}function Aie(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function kie(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(aJ(n,t))}function Cie(e,t,n,i){const r=e.element();r&&r.setAttribute("title",Tie(i))}function Tie(e){return e==null?"":P(e)?vj(e):Q(e)&&!ga(e)?Fie(e):e+""}function Fie(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(P(n)?vj(n):bj(n))}).join(`
`)}function vj(e){return"["+e.map(bj).join(", ")+"]"}function bj(e){return P(e)?"[\u2026]":Q(e)&&!ga(e)?"{\u2026}":e}function xj(e,t){const n=this;if(t=t||{},pl.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=Ee({},e.locale,t.locale);n.locale(BC(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Ba.Canvas,n._scenegraph=new Vx;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||Cie,n._redraw=!0,n._handler=new ad().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Xne(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=bie(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:Ee({},o)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=mj(n,n._width),n._viewHeight=yj(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,wie(n),Ine(n),Pne(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function o0(e,t){return re(e._signals,t)?e._signals[t]:L("Unrecognized signal name: "+H(t))}function wj(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function _j(e,t,n,i){let r=wj(n,i);return r||(r=M_(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function Ej(e,t,n){const i=wj(t,n);return i&&t._targets.remove(i),e}W(xj,pl,{async evaluate(e,t,n){if(await pl.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,qne(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Tg(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&ij(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=o0(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",dj(e)):dj(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(Up(e)||L("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(pl.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(o0(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:_ie,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=M_(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,o;--i>=0;)if(o=n[i].type,r=n[i].handler,e===o&&(t===r||t===r.raw)){this._handler.off(o,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return _j(this,e,o0(this,e),t)},removeSignalListener(e,t){return Ej(this,o0(this,e),t)},addDataListener(e,t){return _j(this,e,e0(this,e).values,t)},removeDataListener(e,t){return Ej(this,e0(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=D_(this,null);this._globalCursor=!!e,t&&D_(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:kie,events:Jne,finalize:Zne,hover:Qne,data:zne,change:t0,insert:Bne,remove:Une,scale:xie,initialize:hie,toImageURL:pie,toCanvas:yie,toSVG:vie,getState:Eie,setState:Aie});const Die="view",a0="[",s0="]",Oj="{",Sj="}",Mie=":",Aj=",",Nie="@",Rie=">",jie=/[[\]{}]/,$ie={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let kj,Cj;function Ka(e,t,n){return kj=t||Die,Cj=n||$ie,Tj(e.trim()).map($_)}function Lie(e){return Cj[e]}function Vd(e,t,n,i,r){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;r&&r.indexOf(s)>=0?--a:i&&i.indexOf(s)>=0&&++a}return t}function Tj(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=Vd(e,r,Aj,a0+Oj,s0+Sj),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function $_(e){return e[0]==="["?Iie(e):Pie(e)}function Iie(e){const t=e.length;let n=1,i;if(n=Vd(e,n,s0,a0,s0),n===t)throw"Empty between selector: "+e;if(i=Tj(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==Rie)throw"Expected '>' after between selector: "+e;i=i.map($_);const r=$_(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function Pie(e){const t={source:kj},n=[];let i=[0,0],r=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===Sj){if(s=e.lastIndexOf(Oj),s>=0){try{i=zie(e.substring(s+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===Nie&&(r=++s),u=Vd(e,s,Mie),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=Vd(e,s,a0),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=Vd(e,s,s0),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==a0)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||jie.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],r?t.markname=n[0].slice(1):Lie(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function zie(e){const t=e.split(Aj);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function Bie(e){return Q(e)?e:{type:e||"pad"}}const Yd=e=>+e||0,Uie=e=>({top:e,bottom:e,left:e,right:e});function qie(e){return Q(e)?e.signal?e:{top:Yd(e.top),bottom:Yd(e.bottom),left:Yd(e.left),right:Yd(e.right)}:Uie(Yd(e))}const Ut=e=>Q(e)&&!P(e)?Ee({},e):{value:e};function Fj(e,t,n,i){return n!=null?(Q(n)&&!P(n)||P(n)&&n.length&&Q(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function nn(e,t,n){for(const i in t)Fj(e,i,t[i]);for(const i in n)Fj(e,i,n[i],"update")}function Jl(e,t,n){for(const i in t)n&&re(n,i)||(e[i]=Ee(e[i]||{},t[i]));return e}function Ql(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const L_="mark",I_="frame",P_="scope",Wie="axis",Hie="axis-domain",Gie="axis-grid",Vie="axis-label",Yie="axis-tick",Xie="axis-title",Kie="legend",Jie="legend-band",Qie="legend-entry",Zie="legend-gradient",Dj="legend-label",ere="legend-symbol",tre="legend-title",nre="title",ire="title-text",rre="title-subtitle";function ore(e,t,n,i,r){const o={},a={};let s,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!Ql(u,e)&&z_(o,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===I_?r.group:n===L_?Ee({},r.mark,r[t]):null;for(u in c)l=Ql(u,e)||(u==="fill"||u==="stroke")&&(Ql("fill",e)||Ql("stroke",e)),l||z_(o,u,c[u]);J(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)Ql(h,e)||z_(o,h,d[h])}),e=Ee({},e);for(u in o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=Ee(a,e.enter),s&&(e.update=Ee(s,e.update)),e}function z_(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const Mj=e=>K(e)?H(e):e.signal?`(${e.signal})`:Nj(e);function u0(e){if(e.gradient!=null)return sre(e);let t=e.signal?`(${e.signal})`:e.color?are(e.color):e.field!=null?Nj(e.field):e.value!==void 0?H(e.value):void 0;return e.scale!=null&&(t=ure(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${c0(e.exponent)})`),e.mult!=null&&(t+=`*${c0(e.mult)}`),e.offset!=null&&(t+=`+${c0(e.offset)}`),e.round&&(t=`round(${t})`),t}const l0=(e,t,n,i)=>`(${e}(${[t,n,i].map(u0).join(",")})+'')`;function are(e){return e.c?l0("hcl",e.h,e.c,e.l):e.h||e.s?l0("hsl",e.h,e.s,e.l):e.l||e.a?l0("lab",e.l,e.a,e.b):e.r||e.g||e.b?l0("rgb",e.r,e.g,e.b):null}function sre(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:H(n));for(;t.length&&Fe(t)==null;)t.pop();return t.unshift(Mj(e.gradient)),`gradient(${t.join(",")})`}function c0(e){return Q(e)?"("+u0(e)+")":e}function Nj(e){return Rj(Q(e)?e:{datum:e})}function Rj(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):L("Invalid field reference: "+H(e));return e.signal||(i=K(i)?Dr(i).map(H).join("]["):Rj(i)),t+"["+i+"]"}function ure(e,t){const n=Mj(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+c0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function lre(e){let t="";return e.forEach(n=>{const i=u0(n);t+=n.test?`(${n.test})?${i}:`:i}),Fe(t)===":"&&(t+="null"),t}function jj(e,t,n,i,r,o){const a={};o=o||{},o.encoders={$encode:a},e=ore(e,t,n,i,r.config);for(const s in e)a[s]=cre(e[s],t,o,r);return o}function cre(e,t,n,i){const r={},o={};for(const a in e)e[a]!=null&&(r[a]=dre(fre(e[a]),i,n,o));return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function fre(e){return P(e)?lre(e):u0(e)}function dre(e,t,n,i){const r=Jr(e,t);return r.$fields.forEach(o=>i[o]=1),Ee(n,r.$params),r.$expr}const hre="outer",gre=["value","update","init","react","bind"];function $j(e,t){L(e+' for "outer" push: '+H(t))}function Lj(e,t){const n=e.name;if(e.push===hre)t.signals[n]||$j("No prior signal definition",n),gre.forEach(i=>{e[i]!==void 0&&$j("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function B_(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function f0(e,t,n,i){return new B_(e,t,n,i)}function d0(e,t){return f0("operator",e,t)}function ue(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function Xd(e,t){return t?{$field:e,$name:t}:{$field:e}}const U_=Xd("key");function Ij(e,t){return{$compare:e,$order:t}}function pre(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const mre="ascending",yre="descending";function vre(e){return Q(e)?(e.order===yre?"-":"+")+h0(e.op,e.field):""}function h0(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const q_="scope",W_="view";function jt(e){return e&&e.signal}function bre(e){return e&&e.expr}function g0(e){if(jt(e))return!0;if(Q(e)){for(const t in e)if(g0(e[t]))return!0}return!1}function dr(e,t){return e!=null?e:t}function au(e){return e&&e.signal||e}const Pj="timer";function Kd(e,t){return(e.merge?wre:e.stream?_re:e.type?Ere:L("Invalid stream specification: "+H(e)))(e,t)}function xre(e){return e===q_?W_:e||W_}function wre(e,t){const n=e.merge.map(r=>Kd(r,t)),i=H_({merge:n},e,t);return t.addStream(i).id}function _re(e,t){const n=Kd(e.stream,t),i=H_({stream:n},e,t);return t.addStream(i).id}function Ere(e,t){let n;e.type===Pj?(n=t.event(Pj,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(xre(e.source),e.type);const i=H_({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function H_(e,t,n){let i=t.between;return i&&(i.length!==2&&L('Stream "between" parameter must have 2 entries: '+H(t)),e.between=[Kd(i[0],n),Kd(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Ore(t.marktype,t.markname,t.markrole)),t.source===q_&&i.push("inScope(event.item)"),i.length&&(e.filter=Jr("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Ore(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const Sre={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Are(e,t,n){const i=e.encode,r={target:n};let o=e.events,a=e.update,s=[];o||L("Signal update missing events specification."),K(o)&&(o=Ka(o,t.isSubscope()?q_:W_)),o=J(o).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[Cre(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),i!=null&&(a&&L("Signal encode and update are mutually exclusive."),a="encode(item(),"+H(i)+")"),r.update=K(a)?Jr(a,t):a.expr!=null?Jr(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:Sre,$params:{$value:t.signalRef(a.signal)}}:L("Invalid signal update specification."),e.force&&(r.options={force:!0}),s.forEach(u=>t.addUpdate(Ee(kre(u,t),r)))}function kre(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Kd(e,t)}}function Cre(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function Tre(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?L("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=Jr(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>Are(r,t,n.id))}const Qe=e=>(t,n,i)=>f0(e,n,t||void 0,i),zj=Qe("aggregate"),Fre=Qe("axisticks"),Bj=Qe("bound"),hr=Qe("collect"),Uj=Qe("compare"),Dre=Qe("datajoin"),qj=Qe("encode"),Mre=Qe("expression"),Nre=Qe("facet"),Rre=Qe("field"),jre=Qe("key"),$re=Qe("legendentries"),Lre=Qe("load"),Ire=Qe("mark"),Pre=Qe("multiextent"),zre=Qe("multivalues"),Bre=Qe("overlap"),Ure=Qe("params"),Wj=Qe("prefacet"),qre=Qe("projection"),Wre=Qe("proxy"),Hre=Qe("relay"),Hj=Qe("render"),Gre=Qe("scale"),su=Qe("sieve"),Vre=Qe("sortitems"),Gj=Qe("viewlayout"),Yre=Qe("values");let Xre=0;const Vj={min:"min",max:"max",count:"sum"};function Kre(e,t){const n=e.type||"linear";MD(n)||L("Unrecognized scale type: "+H(n)),t.addScale(e.name,{type:n,domain:void 0})}function Jre(e,t){const n=t.getScale(e.name).params;let i;n.domain=Yj(e.domain,e,t),e.range!=null&&(n.range=Kj(e,t,n)),e.interpolate!=null&&soe(e.interpolate,n),e.nice!=null&&(n.nice=aoe(e.nice)),e.bins!=null&&(n.bins=ooe(e.bins,t));for(i in e)re(n,i)||i==="name"||(n[i]=Li(e[i],t))}function Li(e,t){return Q(e)?e.signal?t.signalRef(e.signal):L("Unsupported object: "+H(e)):e}function p0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Li(n,t))}function m0(e){L("Can not find data set: "+H(e))}function Yj(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&L("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(P(e)?Qre:e.fields?eoe:Zre)(e,t,n)}function Qre(e,t,n){return e.map(i=>Li(i,n))}function Zre(e,t,n){const i=n.getData(e.data);return i||m0(e.data),Cl(t.type)?i.valuesRef(n,e.field,Xj(e.sort,!1)):jD(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function eoe(e,t,n){const i=e.data,r=e.fields.reduce((o,a)=>(a=K(a)?{data:i,field:a}:P(a)||a.signal?toe(a,n):a,o.push(a),o),[]);return(Cl(t.type)?noe:jD(t.type)?ioe:roe)(e,n,r)}function toe(e,t){const n="_:vega:_"+Xre++,i=hr({});if(P(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+H(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,su({})]),{data:n,field:"data"}}function noe(e,t,n){const i=Xj(e.sort,!0);let r,o;const a=n.map(l=>{const c=t.getData(l.data);return c||m0(l.data),c.countsRef(t,l.field,i)}),s={groupby:U_,pulse:a};i&&(r=i.op||"count",o=i.field?h0(r,i.field):"count",s.ops=[Vj[r]],s.fields=[t.fieldRef(o)],s.as=[o]),r=t.add(zj(s));const u=t.add(hr({pulse:ue(r)}));return o=t.add(Yre({field:U_,sort:t.sortRef(i),pulse:ue(u)})),ue(o)}function Xj(e,t){return e&&(!e.field&&!e.op?Q(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?L("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!Vj[e.op]&&L("Multiple domain scales can not be sorted using "+e.op)),e}function ioe(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||m0(r.data),o.domainRef(t,r.field)});return ue(t.add(zre({values:i})))}function roe(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||m0(r.data),o.extentRef(t,r.field)});return ue(t.add(Pre({extents:i})))}function ooe(e,t){return e.signal||P(e)?p0(e,t):t.objectProperty(e)}function aoe(e){return Q(e)?{interval:Li(e.interval),step:Li(e.step)}:Li(e)}function soe(e,t){t.interpolate=Li(e.type||e),e.gamma!=null&&(t.interpolateGamma=Li(e.gamma))}function Kj(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(K(r)){if(i&&re(i,r))return e=Ee({},e,{range:i[r]}),Kj(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Cl(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:L("Unrecognized scale range value: "+H(r))}else if(r.scheme){n.scheme=P(r.scheme)?p0(r.scheme,t):Li(r.scheme,t),r.extent&&(n.schemeExtent=p0(r.extent,t)),r.count&&(n.schemeCount=Li(r.count,t));return}else if(r.step){n.rangeStep=Li(r.step,t);return}else{if(Cl(e.type)&&!P(r))return Yj(r,e,t);P(r)||L("Unsupported range type: "+H(r))}return r.map(o=>(P(o)?p0:Li)(o,t))}function uoe(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=G_(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=G_(n[r],r,t));t.addProjection(e.name,i)}function G_(e,t,n){return P(e)?e.map(i=>G_(i,t,n)):Q(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:L("Unsupported parameter object: "+H(e)):e}const gr="top",Zl="left",ec="right",Ja="bottom",Jj="center",loe="vertical",coe="start",foe="middle",doe="end",V_="index",Y_="label",hoe="offset",tc="perc",goe="perc2",Ii="value",Jd="guide-label",X_="guide-title",poe="group-title",moe="group-subtitle",Qj="symbol",y0="gradient",K_="discrete",J_="size",yoe="shape",voe="fill",boe="stroke",xoe="strokeWidth",woe="strokeDash",_oe="opacity",Q_=[J_,yoe,voe,boe,xoe,woe,_oe],Qd={name:1,style:1,interactive:1},Re={value:0},Pi={value:1},v0="group",Zj="rect",Z_="rule",Eoe="symbol",uu="text";function Zd(e){return e.type=v0,e.interactive=e.interactive||!1,e}function ii(e,t){const n=(i,r)=>dr(e[i],dr(t[i],r));return n.isVertical=i=>loe===dr(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>dr(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>dr(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>dr(e.columns,dr(t.columns,+n.isVertical(!0))),n}function e$(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Ooe(e,t,n){const i=t.config.style[n];return i&&i[e]}function b0(e,t,n){return`item.anchor === '${coe}' ? ${e} : item.anchor === '${doe}' ? ${t} : ${n}`}const eE=b0(H(Zl),H(ec),H(Jj));function Soe(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Q(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function t$(e,t){return t?e?Q(e)?Object.assign({},e,{offset:t$(e.offset,t)}):{value:e,offset:t}:t:e}function Oi(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=Jl(e.encode,t,Qd)):e.interactive=!1,e}function Aoe(e,t,n,i){const r=ii(e,n),o=r.isVertical(),a=r.gradientThickness(),s=r.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:Re,x:Re,y:Re,width:Ut(f),height:Ut(d)},update:Ee({},u,{opacity:Pi,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Re}};return nn(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Oi({type:Zj,role:Zie,encode:h},i)}function koe(e,t,n,i,r){const o=ii(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Re,fill:{scale:t,field:Ii}};g[l]={signal:h+"datum."+tc,mult:u},g[c]=Re,g[f]={signal:h+"datum."+goe,mult:u},g[d]=Ut(s);const p={enter:g,update:Ee({},g,{opacity:Pi}),exit:{opacity:Re}};return nn(p,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Oi({type:Zj,role:Jie,key:Ii,from:r,encode:p},i)}const Coe=`datum.${tc}<=0?"${Zl}":datum.${tc}>=1?"${ec}":"${Jj}"`,Toe=`datum.${tc}<=0?"${Ja}":datum.${tc}>=1?"${gr}":"${foe}"`;function n$(e,t,n,i){const r=ii(e,t),o=r.isVertical(),a=Ut(r.gradientThickness()),s=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Re},update:c={opacity:Pi,text:{field:Y_}},exit:{opacity:Re}};return nn(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:dr(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:Toe},f="y",d="x",h="1-"):(l.align=c.align={signal:Coe},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+tc,mult:s},l[d]=c[d]=a,a.offset=dr(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+V_}:void 0,Oi({type:uu,role:Dj,style:Jd,key:Ii,from:i,encode:g,overlap:u},n)}function Foe(e,t,n,i,r){const o=ii(e,t),a=n.entries,s=!!(a&&a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${hoe} : datum.${J_}`,h=l?Ut(l):{field:J_},g=`datum.${V_}`,p=`max(1, ${r})`;let m,y,v,x,b;h.mult=.5,m={enter:y={opacity:Re,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:Pi,x:y.x,y:y.y},exit:{opacity:Re}};let _=null,E=null;e.fill||(_=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),nn(m,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",E),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Q_.forEach(k=>{e[k]&&(v[k]=y[k]={scale:e[k],field:Ii})});const w=Oi({type:Eoe,role:ere,key:Ii,from:f,clip:l?!0:void 0,encode:m},n.symbols),O=Ut(c);O.offset=o("labelOffset"),m={enter:y={opacity:Re,x:{signal:d,offset:O},y:h},update:v={opacity:Pi,text:{field:Y_},x:y.x,y:y.y},exit:{opacity:Re}},nn(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const S=Oi({type:uu,role:Dj,style:Jd,key:Ii,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Re,height:l?Ut(l):Re,opacity:Re},exit:{opacity:Re},update:v={opacity:Pi,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${p})`,v.row.signal=`${g}%${x}`,v.column.signal=`floor(${g} / ${x})`,b={field:["row",g]}):(v.row.signal=`floor(${g} / ${p})`,v.column.signal=`${g} % ${p}`,b={field:g}),v.column.signal=`(${r})?${v.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:V_}},Zd({role:P_,from:i,encode:Jl(m,a,Qd),marks:[w,S],name:u,interactive:s,sort:b})}function Doe(e,t){const n=ii(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const tE='item.orient === "left"',nE='item.orient === "right"',x0=`(${tE} || ${nE})`,Moe=`datum.vgrad && ${x0}`,Noe=b0('"top"','"bottom"','"middle"'),Roe=b0('"right"','"left"','"center"'),joe=`datum.vgrad && ${nE} ? (${Roe}) : (${x0} && !(datum.vgrad && ${tE})) ? "left" : ${eE}`,$oe=`item._anchor || (${x0} ? "middle" : "start")`,Loe=`${Moe} ? (${tE} ? -90 : 90) : 0`,Ioe=`${x0} ? (datum.vgrad ? (${nE} ? "bottom" : "top") : ${Noe}) : "top"`;function Poe(e,t,n,i){const r=ii(e,t),o={enter:{opacity:Re},update:{opacity:Pi,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Re}};return nn(o,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:$oe},angle:{signal:Loe},align:{signal:joe},baseline:{signal:Ioe},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Oi({type:uu,role:tre,style:X_,from:i,encode:o},n)}function zoe(e,t){let n;return Q(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+i$(e.path)+")":e.sphere&&(n="geoShape("+i$(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function i$(e){return Q(e)&&e.signal?e.signal:H(e)}function r$(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===v0?P_:t||L_}function Boe(e){return{marktype:e.type,name:e.name||void 0,role:e.role||r$(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Uoe(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function iE(e,t){const n=uT(e.type);n||L("Unrecognized transform type: "+H(e.type));const i=f0(n.type.toLowerCase(),null,o$(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function o$(e,t,n){const i={},r=e.params.length;for(let o=0;o<r;++o){const a=e.params[o];i[a.name]=qoe(a,t,n)}return i}function qoe(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return Woe(e,t,n);if(r===void 0){e.required&&L("Missing required "+H(t.type)+" parameter: "+H(e.name));return}else{if(i==="param")return Hoe(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!jt(r)?r.map(o=>a$(e,o,n)):a$(e,r,n)}function a$(e,t,n){const i=e.type;if(jt(t))return u$(i)?L("Expression references can not be signals."):rE(i)?n.fieldRef(t):l$(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||rE(i);return r&&Goe(t)?n.exprRef(t.expr,t.as):r&&Voe(t)?Xd(t.field,t.as):u$(i)?Jr(t,n):Yoe(i)?ue(n.getData(t).values):rE(i)?Xd(t):l$(i)?n.compareRef(t):t}}function Woe(e,t,n){return K(t.from)||L('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function Hoe(e,t,n){const i=t[e.name];return e.array?(P(i)||L("Expected an array of sub-parameters. Instead: "+H(i)),i.map(r=>s$(e,r,n))):s$(e,i,n)}function s$(e,t,n){const i=e.params.length;let r;for(let a=0;a<i;++a){r=e.params[a];for(const s in r.key)if(r.key[s]!==t[s]){r=null;break}if(r)break}r||L("Unsupported parameter: "+H(t));const o=Ee(o$(r,t,n),r.key);return ue(n.add(Ure(o)))}const Goe=e=>e&&e.expr,Voe=e=>e&&e.field,Yoe=e=>e==="data",u$=e=>e==="expr",rE=e=>e==="field",l$=e=>e==="compare";function Xoe(e,t,n){let i,r,o,a,s;return e?(i=e.facet)&&(t||L("Only group marks can be faceted."),i.field!=null?a=s=w0(i,n):(e.data?s=ue(n.getData(e.data).aggregate):(o=iE(Ee({type:"aggregate",groupby:J(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=w0(i,n),a=s=ue(n.add(o))),r=n.keyRef(i.groupby,!0))):a=ue(n.add(hr(null,[{}]))),a||(a=w0(e,n)),{key:r,pulse:a,parent:s}}function w0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ue(t.getData(e.data).output)}function lu(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}lu.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let o=t[0],a=null,s=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ue(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(a=t[s]);return new lu(e,o,r,i,a)};function c$(e){return K(e)?e:null}function f$(e,t,n){const i=h0(n.op,n.field);let r;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function eh(e,t,n,i,r,o,a){const s=t[n]||(t[n]={}),u=vre(o);let l=c$(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=o?{field:U_,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:ue(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(f0(i,void 0,d)),a&&(t.index[r]=f),c=ue(f),l!=null&&(s[l]=c)}return c}lu.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),o=c$(t);let a,s,u;return o!=null&&(e=i.scope,a=r[o]),a?n&&n.field&&f$(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ue(i.output)},n&&n.field&&f$(e,u,n),s=e.add(zj(u)),a=e.add(hr({pulse:ue(s)})),a={agg:s,ref:ue(a)},o!=null&&(r[o]=a)),a.ref},tuplesRef(){return ue(this.values)},extentRef(e,t){return eh(e,this,"extent","extent",t,!1)},domainRef(e,t){return eh(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return eh(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return eh(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return eh(e,this,"indata","tupleindex",t,!0,!0)}};function Koe(e,t,n){const i=e.from.facet,r=i.name,o=w0(i,t);let a;i.name||L("Facet must have a name: "+H(i)),i.data||L("Facet must reference a data set: "+H(i)),i.field?a=t.add(Wj({field:t.fieldRef(i.field),pulse:o})):i.groupby?a=t.add(Nre({key:t.keyRef(i.groupby),group:ue(t.proxy(n.parent)),pulse:o})):L("Facet must specify groupby or field: "+H(i));const s=t.fork(),u=s.add(hr()),l=s.add(su({pulse:ue(u)}));s.addData(r,new lu(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}function Joe(e,t,n){const i=t.add(Wj({pulse:n.pulse})),r=t.fork();r.add(su()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function d$(e,t,n){const i=e.remove,r=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(d0()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,o,a,s].map(f=>f==null?"null":f).join(",")+"),0)",c=Jr(l,t);u.update=c.$expr,u.params=c.$params}function _0(e,t){const n=r$(e),i=e.type===v0,r=e.from&&e.from.facet,o=e.overlap;let a=e.layout||n===P_||n===I_,s,u,l,c,f,d,h;const g=n===L_||a||r,p=Xoe(e.from,i,t);u=t.add(Dre({key:p.key||(e.key?Xd(e.key):void 0),pulse:p.pulse,clean:!i}));const m=ue(u);u=l=t.add(hr({pulse:m})),u=t.add(Ire({markdef:Boe(e),interactive:Uoe(e.interactive,t),clip:zoe(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ue(u)}));const y=ue(u);u=c=t.add(qj(jj(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const w=iE(E,t),O=w.metadata;(O.generates||O.changes)&&L("Mark transforms should not generate new data."),O.nomod||(c.params.mod=!0),w.params.pulse=ue(u),t.add(u=w)}),e.sort&&(u=t.add(Vre({sort:t.compareRef(e.sort),pulse:ue(u)})));const v=ue(u);(r||a)&&(a=t.add(Gj({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ue(a));const x=t.add(Bj({mark:y,pulse:d||v}));h=ue(x),i&&(g&&(s=t.operators,s.pop(),a&&s.pop()),t.pushState(v,d||h,m),r?Koe(e,t,p):g?Joe(e,t,p):t.parse(e),t.popState(),g&&(a&&s.push(a),s.push(x))),o&&(h=Qoe(o,h,t));const b=t.add(Hj({pulse:h})),_=t.add(su({pulse:ue(b)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new lu(t,l,b,_)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&L("Marks only support modify triggers."),d$(E,t,f)}))}function Qoe(e,t,n){const i=e.method,r=e.bound,o=e.separation,a={separation:jt(o)?n.signalRef(o.signal):o,method:jt(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),r){const s=r.tolerance;a.boundTolerance=jt(s)?n.signalRef(s.signal):+s,a.boundScale=n.scaleRef(r.scale),a.boundOrient=r.orient}return ue(n.add(Bre(a)))}function Zoe(e,t){const n=t.config.legend,i=e.encode||{},r=ii(e,n),o=i.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c=0,f,d,h;Q_.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||L("Missing valid scale for legend.");const g=eae(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},m=ue(t.add(hr(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=ue(t.add($re(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===y0?(h=[Aoe(e,c,n,i.gradient),n$(e,n,i.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${au(r.gradientLength())})/100))`)):g===K_?h=[koe(e,c,n,i.gradient,v),n$(e,n,i.labels,v)]:(f=Doe(e,n),h=[Foe(e,n,i,v,au(f.columns))],d.size=iae(e,t,h[0].marks)),h=[Zd({role:Qie,from:m,encode:y,marks:h,layout:f,interactive:s})],p.title&&h.push(Poe(e,n,i.title,m)),_0(Zd({role:Kie,from:m,encode:Jl(nae(r,e,n),o,Qd),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:a,interactive:s,style:u}),t)}function eae(e,t){let n=e.type||Qj;return!e.type&&tae(e)===1&&(e.fill||e.stroke)&&(n=lx(t)?y0:cx(t)?K_:Qj),n!==y0?n:cx(t)?K_:y0}function tae(e){return Q_.reduce((t,n)=>t+(e[n]?1:0),0)}function nae(e,t,n){const i={enter:{},update:{}};return nn(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function iae(e,t,n){const i=au(h$("size",e,n)),r=au(h$("strokeWidth",e,n)),o=au(rae(n[1].encode,t,Jd));return Jr(`max(ceil(sqrt(${i})+${r}),${o})`,t)}function h$(e,t,n){return t[e]?`scale("${t[e]}",datum)`:e$(e,n[0].encode)}function rae(e,t,n){return e$("fontSize",e)||Ooe("fontSize",t,n)}const oae=`item.orient==="${Zl}"?-90:item.orient==="${ec}"?90:0`;function aae(e,t){e=K(e)?{text:e}:e;const n=ii(e,t.config.title),i=e.encode||{},r=i.group||{},o=r.name||void 0,a=r.interactive,s=r.style,u=[],l={},c=ue(t.add(hr(null,[l])));return u.push(lae(e,n,sae(e),c)),e.subtitle&&u.push(cae(e,n,i.subtitle,c)),_0(Zd({role:nre,from:c,encode:uae(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function sae(e){const t=e.encode;return t&&t.title||Ee({name:e.name,interactive:e.interactive,style:e.style},t)}function uae(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:eE},angle:{signal:oae},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Jl(n,t,Qd)}function lae(e,t,n,i){const r={value:0},o=e.text,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return nn(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Oi({type:uu,role:ire,style:poe,from:i,encode:a},n)}function cae(e,t,n,i){const r={value:0},o=e.subtitle,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return nn(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Oi({type:uu,role:rre,style:moe,from:i,encode:a},n)}function fae(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(iE(i,t))}),e.on&&e.on.forEach(i=>{d$(i,t,e.name)}),t.addDataPipeline(e.name,dae(e,t,n))}function dae(e,t,n){const i=[];let r=null,o=!1,a=!1,s,u,l,c,f;for(e.values?jt(e.values)||g0(e.format)?(i.push(g$(t,e)),i.push(r=cu())):i.push(r=cu({$ingest:e.values,$format:e.format})):e.url?g0(e.url)||g0(e.format)?(i.push(g$(t,e)),i.push(r=cu())):i.push(r=cu({$request:e.url,$format:e.format})):e.source&&(r=s=J(e.source).map(d=>ue(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=cu()),i.push(c),f.generates&&(a=!0),f.modifies&&!a&&(o=!0),f.source?r=c:f.changes&&(r=null);return s&&(l=s.length-1,i[0]=Hre({derive:o,pulse:l?s:s[0]}),(o||l)&&i.splice(1,0,cu())),r||i.push(cu()),i.push(su({})),i}function cu(e){const t=hr({},e);return t.metadata={source:!0},t}function g$(e,t){return Lre({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const p$=e=>e===Ja||e===gr,E0=(e,t,n)=>jt(e)?mae(e.signal,t,n):e===Zl||e===gr?t:n,qt=(e,t,n)=>jt(e)?gae(e.signal,t,n):p$(e)?t:n,pr=(e,t,n)=>jt(e)?pae(e.signal,t,n):p$(e)?n:t,m$=(e,t,n)=>jt(e)?yae(e.signal,t,n):e===gr?{value:t}:{value:n},hae=(e,t,n)=>jt(e)?vae(e.signal,t,n):e===ec?{value:t}:{value:n},gae=(e,t,n)=>y$(`${e} === '${gr}' || ${e} === '${Ja}'`,t,n),pae=(e,t,n)=>y$(`${e} !== '${gr}' && ${e} !== '${Ja}'`,t,n),mae=(e,t,n)=>oE(`${e} === '${Zl}' || ${e} === '${gr}'`,t,n),yae=(e,t,n)=>oE(`${e} === '${gr}'`,t,n),vae=(e,t,n)=>oE(`${e} === '${ec}'`,t,n),y$=(e,t,n)=>(t=t!=null?Ut(t):t,n=n!=null?Ut(n):n,v$(t)&&v$(n)?(t=t?t.signal||H(t.value):null,n=n?n.signal||H(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ee({test:e},t)].concat(n||[])),v$=e=>e==null||Object.keys(e).length===1,oE=(e,t,n)=>({signal:`${e} ? (${nc(t)}) : (${nc(n)})`}),bae=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${Zl}' ? (${nc(i)}) : `:"")+(n!=null?`${e} === '${Ja}' ? (${nc(n)}) : `:"")+(r!=null?`${e} === '${ec}' ? (${nc(r)}) : `:"")+(t!=null?`${e} === '${gr}' ? (${nc(t)}) : `:"")+"(null)"}),nc=e=>jt(e)?e.signal:e==null?null:H(e),xae=(e,t)=>t===0?0:jt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},ic=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function rc(e,t,n,i){let r;if(t&&re(t,e))return t[e];if(re(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[X_][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[Jd][r]}return null}function b$(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function wae(e,t){var n=t.config,i=n.style,r=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,s,u,l;if(jt(a)){const f=b$([n.axisX,n.axisY]),d=b$([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=qt(a,rc(l,n.axisX,r,i),rc(l,n.axisY,r,i));u={};for(l of d)u[l]=bae(a.signal,rc(l,n.axisTop,r,i),rc(l,n.axisBottom,r,i),rc(l,n.axisLeft,r,i),rc(l,n.axisRight,r,i))}else s=a===gr||a===Ja?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return s||u||o?Ee({},r,s,u,o):r}function _ae(e,t,n,i){const r=ii(e,t),o=e.orient;let a,s;const u={enter:a={opacity:Re},update:s={opacity:Pi},exit:{opacity:Re}};nn(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=x$(e,0),c=x$(e,1);return a.x=s.x=qt(o,l,Re),a.x2=s.x2=qt(o,c),a.y=s.y=pr(o,l,Re),a.y2=s.y2=pr(o,c),Oi({type:Z_,role:Hie,from:i,encode:u},n)}function x$(e,t){return{scale:e.scale,range:t}}function Eae(e,t,n,i,r){const o=ii(e,t),a=e.orient,s=e.gridScale,u=E0(a,1,-1),l=Oae(e.offset,u);let c,f,d;const h={enter:c={opacity:Re},update:d={opacity:Pi},exit:f={opacity:Re}};nn(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const g={scale:e.scale,field:Ii,band:r.band,extra:r.extra,offset:r.offset,round:o("tickRound")},p=qt(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:Ee(p,{mult:u,offset:l});return c.x=d.x=qt(a,g,m),c.y=d.y=pr(a,g,m),c.x2=d.x2=pr(a,y),c.y2=d.y2=qt(a,y),f.x=qt(a,g),f.y=pr(a,g),Oi({type:Z_,role:Gie,key:Ii,from:i,encode:h},n)}function Oae(e,t){if(t!==1)if(!Q(e))e=jt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ee({},e);for(;n.mult!=null;)if(Q(n.mult))n=n.mult=Ee({},n.mult);else return n.mult=jt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function Sae(e,t,n,i,r,o){const a=ii(e,t),s=e.orient,u=E0(s,-1,1);let l,c,f;const d={enter:l={opacity:Re},update:f={opacity:Pi},exit:c={opacity:Re}};nn(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Ut(r);h.mult=u;const g={scale:e.scale,field:Ii,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=qt(s,Re,g),f.y2=l.y2=qt(s,h),c.x=qt(s,g),f.x=l.x=pr(s,Re,g),f.x2=l.x2=pr(s,h),c.y=pr(s,g),Oi({type:Z_,role:Yie,key:Ii,from:i,encode:d},n)}function aE(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function Aae(e,t,n,i,r,o){const a=ii(e,t),s=e.orient,u=e.scale,l=E0(s,-1,1),c=au(a("labelFlush")),f=au(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let g=c===0||!!c,p;const m=Ut(r);m.mult=l,m.offset=Ut(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Ii,band:.5,offset:t$(o.offset,a("labelOffset"))},v=qt(s,g?aE(u,c,'"left"','"right"','"center"'):{value:"center"},hae(s,"left","right")),x=qt(s,m$(s,"bottom","top"),g?aE(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=aE(u,c,`-(${f})`,f,0);g=g&&f;const _={opacity:Re,x:qt(s,y,m),y:pr(s,y,m)},E={enter:_,update:p={opacity:Pi,text:{field:Y_},x:_.x,y:_.y,align:v,baseline:x},exit:{opacity:Re,x:_.x,y:_.y}};nn(E,{dx:!d&&g?qt(s,b):null,dy:!h&&g?pr(s,b):null}),nn(E,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const w=a("labelBound");let O=a("labelOverlap");return O=O||w?{separation:a("labelSeparation"),method:O,order:"datum.index",bound:w?{scale:u,orient:s,tolerance:w}:null}:void 0,p.align!==v&&(p.align=ic(p.align,v)),p.baseline!==x&&(p.baseline=ic(p.baseline,x)),Oi({type:uu,role:Vie,style:Jd,key:Ii,from:i,encode:E,overlap:O},n)}function kae(e,t,n,i){const r=ii(e,t),o=e.orient,a=E0(o,-1,1);let s,u;const l={enter:s={opacity:Re,anchor:Ut(r("titleAnchor",null)),align:{signal:eE}},update:u=Ee({},s,{opacity:Pi,text:Ut(e.title)}),exit:{opacity:Re}},c={signal:`lerp(range("${e.scale}"), ${b0(0,1,.5)})`};return u.x=qt(o,c),u.y=pr(o,c),s.angle=qt(o,Re,xae(a,90)),s.baseline=qt(o,m$(o,Ja,gr),{value:Ja}),u.angle=s.angle,u.baseline=s.baseline,nn(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),Cae(r,o,l,n),l.update.align=ic(l.update.align,s.align),l.update.angle=ic(l.update.angle,s.angle),l.update.baseline=ic(l.update.baseline,s.baseline),Oi({type:uu,role:Xie,style:X_,from:i,encode:l},n)}function Cae(e,t,n,i){const r=(s,u)=>s!=null?(n.update[u]=ic(Ut(s),n.update[u]),!1):!Ql(u,i),o=r(e("titleX"),"x"),a=r(e("titleY"),"y");n.enter.auto=a===o?Ut(a):qt(t,Ut(a),Ut(o))}function Tae(e,t){const n=wae(e,t),i=e.encode||{},r=i.axis||{},o=r.name||void 0,a=r.interactive,s=r.style,u=ii(e,n),l=Soe(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ue(t.add(hr({},[c]))),d=ue(t.add(Fre({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(Eae(e,n,i.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(Sae(e,n,i.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(Aae(e,n,i.labels,d,g,l))),c.domain&&h.push(_ae(e,n,i.domain,f)),c.title&&h.push(kae(e,n,i.title,f)),_0(Zd({role:Wie,from:f,encode:Jl(Fae(u,e),r,Qd),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function Fae(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),offset:e("offset")||0,position:dr(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function w$(e,t,n){const i=J(e.signals),r=J(e.scales);return n||i.forEach(o=>Lj(o,t)),J(e.projections).forEach(o=>uoe(o,t)),r.forEach(o=>Kre(o,t)),J(e.data).forEach(o=>fae(o,t)),r.forEach(o=>Jre(o,t)),(n||i).forEach(o=>Tre(o,t)),J(e.axes).forEach(o=>Tae(o,t)),J(e.marks).forEach(o=>_0(o,t)),J(e.legends).forEach(o=>Zoe(o,t)),e.title&&aae(e.title,t),t.parseLambdas(),t}const Dae=e=>Jl({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function Mae(e,t){const n=t.config,i=ue(t.root=t.add(d0())),r=Nae(e,n);r.forEach(l=>Lj(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(hr()),a=t.add(qj(jj(Dae(e.encode),v0,I_,e.style,t,{pulse:ue(o)}))),s=t.add(Gj({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ue(a)}));t.operators.pop(),t.pushState(ue(a),ue(s),null),w$(e,t,r),t.operators.push(s);let u=t.add(Bj({mark:i,pulse:ue(s)}));return u=t.add(Hj({pulse:ue(u)})),u=t.add(su({pulse:ue(u)})),t.addData("root",new lu(t,o,o,u)),t}function th(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Nae(e,t){const n=a=>dr(e[a],t[a]),i=[th("background",n("background")),th("autosize",Bie(n("autosize"))),th("padding",qie(n("padding"))),th("width",n("width")||0),th("height",n("height")||0)],r=i.reduce((a,s)=>(a[s.name]=s,a),{}),o={};return J(e.signals).forEach(a=>{re(r,a.name)?a=Ee(r[a.name],a):i.push(a),o[a.name]=a}),J(t.signals).forEach(a=>{!re(o,a.name)&&!re(r,a.name)&&i.push(a)}),i}function _$(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function E$(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}_$.prototype=E$.prototype={parse(e){return w$(e,this)},fork(){return new E$(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof B_?ue(e):e;return this.add(Wre({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,o){let a,s;i&&(a=i.data||(i.data={}),s=a[r]||(a[r]=[]),s.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ue(this.add(su({pulse:e})))),this._parent.push(t),this._lookup.push(n?ue(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Fe(this._parent)},encode(){return Fe(this._encode)},lookup(){return Fe(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(K(e))return Xd(e,t);e.signal||L("Unsupported field reference: "+H(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ue(this.add(Rre(r)))}return i},compareRef(e){let t=!1;const n=o=>jt(o)?(t=!0,this.signalRef(o.signal)):bre(o)?(t=!0,this.exprRef(o.expr)):o,i=J(e.field).map(n),r=J(e.order).map(n);return t?ue(this.add(Uj({fields:i,orders:r}))):Ij(i,r)},keyRef(e,t){let n=!1;const i=o=>jt(o)?(n=!0,ue(r[o.signal])):o,r=this.signals;return e=J(e).map(i),n?ue(this.add(jre({fields:e,flat:t}))):pre(e,t)},sortRef(e){if(!e)return e;const t=h0(e.op,e.field),n=e.order||mre;return n.signal?ue(this.add(Uj({fields:t,orders:this.signalRef(n.signal)}))):Ij(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return re(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&L("Duplicate signal name: "+H(e));const n=t instanceof B_?t:this.add(d0(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||L("Unrecognized signal name: "+H(e)),this.signals[e]},signalRef(e){return this.signals[e]?ue(this.signals[e]):(re(this.lambdas,e)||(this.lambdas[e]=this.add(d0(null))),ue(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=Jr(i,this),o=this.lambdas[i];o.params=r.$params,o.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Q(e)?e:this.signalRef(e.signal||sE(e))},exprRef(e,t){const n={expr:Jr(e,this)};return t&&(n.expr.$name=t),ue(this.add(Mre(n)))},addBinding(e,t){this.bindings||L("Nested signals do not support binding: "+H(e)),this.bindings.push(Ee({signal:e},t))},addScaleProj(e,t){re(this.scales,e)&&L("Duplicate scale or projection name: "+H(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,Gre(t))},addProjection(e,t){this.addScaleProj(e,qre(t))},getScale(e){return this.scales[e]||L("Unrecognized scale name: "+H(e)),this.scales[e]},scaleRef(e){return ue(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return re(this.data,e)&&L("Duplicate data set name: "+H(e)),this.data[e]=t},getData(e){return this.data[e]||L("Undefined data set name: "+H(e)),this.data[e]},addDataPipeline(e,t){return re(this.data,e)&&L("Duplicate data set name: "+H(e)),this.addData(e,lu.fromEntries(this,t))}};function sE(e){return(P(e)?Rae:jae)(e)}function Rae(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Q(r)?r.signal||sE(r):H(r))}return n+"]"}function jae(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+H(i)+":"+(Q(r)?r.signal||sE(r):H(r));return t+"}"}function $ae(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Lae(e,t,n){return Q(e)||L("Input Vega specification must be an object."),t=il($ae(),t,e.config),Mae(e,new _$(t,n)).toRuntime()}var Iae="vega",Pae="5.21.0",zae="The Vega visualization grammar.",Bae=["vega","visualization","interaction","dataflow","library","data","d3"],Uae="BSD-3-Clause",qae="UW Interactive Data Lab (http://idl.cs.washington.edu)",Wae="build/vega-node.js",Hae="build/vega.module.js",Gae="build/vega.min.js",Vae="build/vega.min.js",Yae="index.d.ts",Xae="vega/vega",Kae={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Jae={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Qae={"vega-schema":"*"},Zae="774165e29850b66ec8b79ba52a7955f1ab936ea6",ese={name:Iae,version:Pae,description:zae,keywords:Bae,license:Uae,author:qae,main:Wae,module:Hae,unpkg:Gae,jsdelivr:Vae,types:Yae,repository:Xae,scripts:Kae,dependencies:Jae,devDependencies:Qae,gitHead:Zae};Ee(ml,eq,hY,HY,FK,OJ,nZ,kQ,rZ,wZ,DZ,IZ);const tse=ese.version;var nse=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:tse,Dataflow:pl,EventStream:Rg,MultiPulse:kv,Operator:it,Parameters:Ng,Pulse:Oa,Transform:R,changeset:Rs,definition:uT,ingest:Ue,isTuple:Fg,transform:lT,transforms:ml,tupleid:ae,interpolate:fx,interpolateColors:hp,interpolateRange:$D,quantizeInterpolator:LD,scale:Ie,scheme:dx,projection:ow,View:xj,defaultLocale:xv,formatLocale:Og,locale:BC,resetDefaultLocale:eB,timeFormatLocale:Af,expressionFunction:St,parse:Lae,runtimeContext:ej,codegenExpression:MR,parseExpression:p_,parseSelector:Ka,Debug:tk,Error:Ey,Info:ek,None:ZA,Warn:Oy,accessor:Hn,accessorFields:fn,accessorName:yt,array:J,ascending:pg,clampRange:hk,compare:Ty,constant:gn,debounce:Fy,error:L,extend:Ee,extent:Mr,extentIndex:gk,falsy:da,fastmap:ol,field:Gn,flush:pk,hasOwnProperty:re,id:rf,identity:dn,inherits:W,inrange:al,isArray:P,isBoolean:ha,isDate:ga,isFunction:_e,isIterable:mk,isNumber:Je,isObject:Q,isRegExp:yk,isString:K,key:Dy,lerp:vk,logger:Sy,lruCache:bk,merge:xk,mergeConfig:il,one:nl,pad:wk,panLinear:sk,panLog:uk,panPow:lk,panSymlog:ck,peek:Fe,quarter:fk,repeat:of,span:af,splitAccessPath:Dr,stringValue:H,toBoolean:My,toDate:Ny,toNumber:hn,toSet:er,toString:Ry,truncate:_k,truthy:Ti,utcquarter:dk,visitArray:pa,writeConfig:rl,zero:fa,zoomLinear:Ay,zoomLog:ky,zoomPow:gg,zoomSymlog:Cy,bandwidthNRD:Dv,bin:fT,bootstrapCI:dT,cumulativeLogNormal:Lv,cumulativeNormal:Ig,cumulativeUniform:Bv,densityLogNormal:$v,densityNormal:Mv,densityUniform:zv,dotbin:hT,quantileLogNormal:Iv,quantileNormal:Pg,quantileUniform:Uv,quantiles:Tv,quartiles:Fv,get random(){return Mi},randomInteger:rU,randomKDE:Rv,randomLCG:iU,randomLogNormal:pT,randomMixture:mT,randomNormal:Nv,randomUniform:yT,regressionExp:bT,regressionLinear:qv,regressionLoess:OT,regressionLog:vT,regressionPoly:wT,regressionPow:xT,regressionQuad:Wv,sampleCurve:Bg,sampleLogNormal:jv,sampleNormal:Lg,sampleUniform:Pv,setRandom:tU,DATE:Xn,DAY:mn,DAYOFYEAR:Nr,HOURS:vi,MILLISECONDS:tr,MINUTES:bi,MONTH:pn,QUARTER:Yn,SECONDS:Di,TIME_UNITS:rv,WEEK:Dt,YEAR:Jt,dayofyear:Jk,timeBin:mC,timeFloor:rC,timeInterval:fl,timeOffset:sC,timeSequence:cC,timeUnitSpecifier:Kk,timeUnits:av,utcFloor:oC,utcInterval:dl,utcOffset:uC,utcSequence:fC,utcdayofyear:eC,utcweek:tC,week:Qk,format:Ag,formats:Ov,inferType:WC,inferTypes:HC,loader:kg,read:XC,responseType:YC,typeParsers:wv,Bounds:Nt,CanvasHandler:ad,CanvasRenderer:zp,Gradient:ZD,GroupItem:bp,Handler:Pa,Item:vp,Marks:xi,RenderType:Ba,Renderer:Hr,ResourceLoader:Ex,SVGHandler:Qx,SVGRenderer:o2,SVGStringRenderer:u2,Scenegraph:Vx,boundClip:y3,boundContext:Jf,boundItem:Gx,boundMark:MM,boundStroke:No,domChild:Jn,domClear:or,domCreate:Ia,domFind:Yx,font:Dp,fontFamily:nd,fontSize:Wr,intersect:h3,intersectBoxLine:Ml,intersectPath:Fx,intersectPoint:Dx,intersectRule:yM,lineHeight:$a,markup:r2,multiLineOffset:qx,pathCurves:yx,pathEqual:v3,pathParse:Tl,pathRectangle:aM,pathRender:Gf,pathSymbols:oM,pathTrail:sM,point:Np,renderModule:Up,resetSVGClipId:lM,resetSVGDefIds:TV,sceneEqual:c2,sceneFromJSON:RM,scenePickVisit:Ap,sceneToJSON:NM,sceneVisit:rr,sceneZOrder:Mx,serializeXML:n3,textMetrics:qr});function ise(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var rse={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},ose={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},ase={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const sse=Array.prototype.slice,fu=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,sse.call(t,1))},use=(e,t,n,i,r,o,a)=>new Date(e,t||0,n!=null?n:1,i||0,r||0,o||0,a||0);var lse={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:use,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return fu("join",arguments)},indexof:function(){return fu("indexOf",arguments)},lastindexof:function(){return fu("lastIndexOf",arguments)},slice:function(){return fu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return fu("substring",arguments,String)},split:function(){return fu("split",arguments,String)},replace:function(){return fu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const cse=["view","item","group","xy","x","y"],fse={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:rse[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||lse[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>ose[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>ase[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function nh(e,t,n,i,r,o){const a=s=>fse[s.type](a,s);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=i,a.event=r,a.item=o,cse.forEach(s=>a.fn[s]=(...u)=>r.vega[s](...u)),a(e)}var dse={operator(e,t){const n=t.ast,i=e.functions;return r=>nh(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,o)=>nh(n,i,o,r)},event(e,t){const n=t.ast,i=e.functions;return r=>nh(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,o)=>{const a=o.item&&o.item.datum;return nh(n,i,r,a,o)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,o=n==="group"||n==="image"||n==="rect";return(a,s)=>{const u=a.datum;let l=0,c;for(const f in i)c=nh(i[f].ast,r,s,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&ise(a,i,o),l}}};const hse="vega-lite",gse='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',pse="5.2.0",mse=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],yse="https://vega.github.io/vega-lite/",vse="Vega-Lite is a concise high-level language for interactive visualization.",bse="build/vega-lite.js",xse="build/vega-lite.min.js",wse="build/vega-lite.min.js",_se="build/src/index",Ese="build/src/index.d.ts",Ose={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},Sse={test:"test"},Ase=["bin","build","src","vega-lite*","tsconfig.json"],kse={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},Cse={type:"git",url:"https://github.com/vega/vega-lite.git"},Tse="BSD-3-Clause",Fse={url:"https://github.com/vega/vega-lite/issues"},Dse={"@babel/core":"^7.16.0","@babel/preset-env":"^7.16.0","@babel/preset-typescript":"^7.16.0","@rollup/plugin-alias":"^3.1.8","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.6","@types/chai":"^4.2.22","@types/d3":"^7.1.0","@types/jest":"^27.0.2","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^5.4.0","@typescript-eslint/parser":"^5.4.0",ajv:"^8.8.0","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.1.1","del-cli":"^4.0.1",eslint:"^8.2.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^25.2.4","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.3.1",jest:"^27.3.1","jest-dev-server":"^6.0.0",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.4.1",puppeteer:"^11.0.0",rollup:"^2.60.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^13.0.2",terser:"^5.10.0","ts-jest":"^27.0.7","ts-json-schema-generator":"^0.97.0",typescript:"~4.5.2","vega-cli":"^5.21.0","vega-datasets":"~2.2.0","vega-embed":"^6.20.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},Mse={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-util":"~1.17.0",yargs:"~17.2.1"},Nse={vega:"^5.21.0"},Rse={node:">=12"};var jse={name:hse,author:gse,version:pse,collaborators:mse,homepage:yse,description:vse,main:bse,unpkg:xse,jsdelivr:wse,module:_se,types:Ese,bin:Ose,directories:Sse,files:Ase,scripts:kse,repository:Cse,license:Tse,bugs:Fse,devDependencies:Dse,dependencies:Mse,peerDependencies:Nse,engines:Rse};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var O$={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var o;try{o=Promise}catch{o=function(){}}function a(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],x=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function b(_,E){if(_===null)return null;if(E===0)return _;var w,O;if(typeof _!="object")return _;if(n(_,i))w=new i;else if(n(_,r))w=new r;else if(n(_,o))w=new o(function(I,z){_.then(function(X){I(b(X,E-1))},function(X){z(b(X,E-1))})});else if(a.__isArray(_))w=[];else if(a.__isRegExp(_))w=new RegExp(_.source,f(_)),_.lastIndex&&(w.lastIndex=_.lastIndex);else if(a.__isDate(_))w=new Date(_.getTime());else{if(x&&Buffer.isBuffer(_))return Buffer.allocUnsafe?w=Buffer.allocUnsafe(_.length):w=new Buffer(_.length),_.copy(w),w;n(_,Error)?w=Object.create(_):typeof p=="undefined"?(O=Object.getPrototypeOf(_),w=Object.create(O)):(w=Object.create(p),O=p)}if(h){var S=y.indexOf(_);if(S!=-1)return v[S];y.push(_),v.push(w)}n(_,i)&&_.forEach(function(I,z){var X=b(z,E-1),te=b(I,E-1);w.set(X,te)}),n(_,r)&&_.forEach(function(I){var z=b(I,E-1);w.add(z)});for(var k in _){var A;O&&(A=Object.getOwnPropertyDescriptor(O,k)),!(A&&A.set==null)&&(w[k]=b(_[k],E-1))}if(Object.getOwnPropertySymbols)for(var F=Object.getOwnPropertySymbols(_),k=0;k<F.length;k++){var C=F[k],M=Object.getOwnPropertyDescriptor(_,C);M&&!M.enumerable&&!m||(w[C]=b(_[C],E-1),M.enumerable||Object.defineProperty(w,C,{enumerable:!1}))}if(m)for(var D=Object.getOwnPropertyNames(_),k=0;k<D.length;k++){var N=D[k],M=Object.getOwnPropertyDescriptor(_,N);M&&M.enumerable||(w[N]=b(_[N],E-1),Object.defineProperty(w,N,{enumerable:!1}))}return w}return b(d,g)}a.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function s(d){return Object.prototype.toString.call(d)}a.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}a.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}a.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(O$);var $se=O$.exports,Lse=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;r--!=0;){var a=o[r];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},uE=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(o){return function(a){return function(s,u){var l={key:s,value:a[s]},c={key:u,value:a[u]};return o(l,c)}}}(t.cmp),r=[];return function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var s,u;if(Array.isArray(a)){for(u="[",s=0;s<a.length;s++)s&&(u+=","),u+=o(a[s])||"null";return u+"]"}if(a===null)return"null";if(r.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(a)-1,c=Object.keys(a).sort(i&&i(a));for(u="",s=0;s<c.length;s++){var f=c[s],d=o(a[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};function lE(e){return!!e.or}function cE(e){return!!e.and}function fE(e){return!!e.not}function O0(e,t){if(fE(e))O0(e.not,t);else if(cE(e))for(const n of e.and)O0(n,t);else if(lE(e))for(const n of e.or)O0(n,t);else t(e)}function oc(e,t){return fE(e)?{not:oc(e.not,t)}:cE(e)?{and:e.and.map(n=>oc(n,t))}:lE(e)?{or:e.or.map(n=>oc(n,t))}:t(e)}const Qr=Lse,be=$se;function S$(e){throw new Error(e)}function ac(e,t){const n={};for(const i of t)re(e,i)&&(n[i]=e[i]);return n}function Si(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>uE(e)).join(",")})`};const rt=uE;function De(e){if(Je(e))return e;const t=K(e)?e:uE(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function dE(e){return e===!1||e===null}function Me(e,t){return e.includes(t)}function du(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function hE(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function A$(e,...t){for(const n of t)Ise(e,n!=null?n:{});return e}function Ise(e,t){for(const n of U(t))rl(e,n,t[n],!0)}function Zr(e,t){const n=[],i={};let r;for(const o of e)r=t(o),!(r in i)&&(i[r]=1,n.push(o));return n}function Pse(e,t){const n=U(e),i=U(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function k$(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function gE(e,t){for(const n of e)if(t.has(n))return!0;return!1}function pE(e){const t=new Set;for(const n of e){const r=Dr(n).map((a,s)=>s===0?a:`[${a}]`),o=r.map((a,s)=>r.slice(0,s+1).join(""));for(const a of o)t.add(a)}return t}function mE(e,t){return e===void 0||t===void 0?!0:gE(pE(e),pE(t))}function Ze(e){return U(e).length===0}const U=Object.keys,En=Object.values,Qa=Object.entries;function ih(e){return e===!0||e===!1}function ht(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function rh(e,t){return fE(e)?`!(${rh(e.not,t)})`:cE(e)?`(${e.and.map(n=>rh(n,t)).join(") && (")})`:lE(e)?`(${e.or.map(n=>rh(n,t)).join(") || (")})`:t(e)}function S0(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&S0(e[n],t)&&delete e[n],Ze(e)}function oh(e){return e.charAt(0).toUpperCase()+e.substr(1)}function yE(e,t="datum"){const n=Dr(e),i=[];for(let r=1;r<=n.length;r++){const o=`[${n.slice(0,r).map(H).join("][")}]`;i.push(`${t}${o}`)}return i.join(" && ")}function C$(e,t="datum"){return`${t}[${H(Dr(e).join("."))}]`}function zse(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function zi(e){return`${Dr(e).map(zse).join("\\.")}`}function hu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function vE(e){return`${Dr(e).join(".")}`}function sc(e){return e?Dr(e).length:0}function At(...e){for(const t of e)if(t!==void 0)return t}let T$=42;function F$(e){const t=++T$;return e?String(e)+t:t}function Bse(){T$=42}function D$(e){return M$(e)?e:`__${e}`}function M$(e){return e.startsWith("__")}function ah(e){if(e!==void 0)return(e%360+360)%360}function A0(e){return Je(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var sh=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const qo="row",Wo="column",k0="facet",pt="x",Wt="y",mr="x2",eo="y2",Za="xOffset",uc="yOffset",to="radius",Ho="radius2",yr="theta",Go="theta2",no="latitude",io="longitude",vr="latitude2",Bi="longitude2",ri="color",ro="fill",oo="stroke",oi="shape",Vo="size",gu="angle",Yo="opacity",es="fillOpacity",ts="strokeOpacity",ns="strokeWidth",is="strokeDash",uh="text",lh="order",ch="detail",C0="key",pu="tooltip",T0="href",F0="url",D0="description",Use={x:1,y:1,x2:1,y2:1},N$={theta:1,theta2:1,radius:1,radius2:1};function R$(e){return e in N$}const bE={longitude:1,longitude2:1,latitude:1,latitude2:1};function qse(e){switch(e){case no:return"y";case vr:return"y2";case io:return"x";case Bi:return"x2"}}function Wse(e){return e in bE}const Hse=U(bE),xE=Object.assign(Object.assign(Object.assign(Object.assign({},Use),N$),bE),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function lc(e){return e===ri||e===ro||e===oo}const j$={row:1,column:1,facet:1},Ui=U(j$),wE=Object.assign(Object.assign({},xE),j$),Gse=U(wE),Vse=sh(wE,["order","detail","tooltip"]),Yse=sh(Vse,["row","column","facet"]);function Xse(e){return!!Yse[e]}function $$(e){return!!wE[e]}const Kse=[mr,eo,vr,Bi,Go,Ho];function L$(e){return mu(e)!==e}function mu(e){switch(e){case mr:return pt;case eo:return Wt;case vr:return no;case Bi:return io;case Go:return yr;case Ho:return to}return e}function rs(e){if(R$(e))switch(e){case yr:return"startAngle";case Go:return"endAngle";case to:return"outerRadius";case Ho:return"innerRadius"}return e}function Xo(e){switch(e){case pt:return mr;case Wt:return eo;case no:return vr;case io:return Bi;case yr:return Go;case to:return Ho}}function ai(e){switch(e){case pt:case mr:return"width";case Wt:case eo:return"height"}}function Jse(e){switch(e){case pt:return"xOffset";case Wt:return"yOffset";case mr:return"x2Offset";case eo:return"y2Offset";case yr:return"thetaOffset";case to:return"radiusOffset";case Go:return"theta2Offset";case Ho:return"radius2Offset"}}function I$(e){switch(e){case pt:return"xOffset";case Wt:return"yOffset"}}function P$(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const Qse=U(xE),_E=sh(xE,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Zse=U(_E),EE={x:1,y:1},ao=U(EE);function rn(e){return e in EE}const OE={theta:1,radius:1},eue=U(OE);function M0(e){return e==="width"?pt:Wt}const z$={xOffset:1,yOffset:1};function cc(e){return e in z$}const B$=sh(_E,["text","tooltip","href","url","description","detail","key","order"]),tue=U(B$);function nue(e){return!!_E[e]}function iue(e){switch(e){case ri:case ro:case oo:case Vo:case oi:case Yo:case ns:case is:return!0;case es:case ts:case gu:return!1}}const U$=Object.assign(Object.assign(Object.assign(Object.assign({},EE),OE),z$),B$),N0=U(U$);function os(e){return!!U$[e]}function rue(e,t){return aue(e)[t]}const q$={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},oue=sh(q$,["geoshape"]);function aue(e){switch(e){case ri:case ro:case oo:case D0:case ch:case C0:case pu:case T0:case lh:case Yo:case es:case ts:case ns:case k0:case qo:case Wo:return q$;case pt:case Wt:case Za:case uc:case no:case io:return oue;case mr:case eo:case vr:case Bi:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Vo:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case is:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case oi:return{point:"always",geoshape:"always"};case uh:return{text:"always"};case gu:return{point:"always",square:"always",text:"always"};case F0:return{image:"always"};case yr:return{text:"always",arc:"always"};case to:return{text:"always",arc:"always"};case Go:case Ho:return{arc:"always"}}}function SE(e){switch(e){case pt:case Wt:case yr:case to:case Za:case uc:case Vo:case gu:case ns:case Yo:case es:case ts:case mr:case eo:case Go:case Ho:return;case k0:case qo:case Wo:case oi:case is:case uh:case pu:case T0:case F0:case D0:return"discrete";case ri:case ro:case oo:return"flexible";case no:case io:case vr:case Bi:case ch:case C0:case lh:return}}const sue={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},uue={count:1,min:1,max:1};function Ko(e){return!!e&&!!e.argmin}function as(e){return!!e&&!!e.argmax}function AE(e){return K(e)&&!!sue[e]}const lue=new Set(["count","valid","missing","distinct"]);function W$(e){return K(e)&&lue.has(e)}function cue(e){return K(e)&&Me(["min","max"],e)}const fue=new Set(["count","sum","distinct","valid","missing"]),due=new Set(["mean","average","median","q1","q3","min","max"]);function H$(e){return ha(e)&&(e=Q0(e,void 0)),"bin"+U(e).map(t=>R0(e[t])?ht(`_${t}_${Qa(e[t])}`):ht(`_${t}_${e[t]}`)).join("")}function ot(e){return e===!0||yu(e)&&!e.binned}function zn(e){return e==="binned"||yu(e)&&e.binned===!0}function yu(e){return Q(e)}function R0(e){return e==null?void 0:e.param}function G$(e){switch(e){case qo:case Wo:case Vo:case ri:case ro:case oo:case ns:case Yo:case es:case ts:case oi:return 6;case is:return 4;default:return 10}}function fh(e){return e&&!!e.expr}function si(e){const t=U(e||{}),n={};for(const i of t)n[i]=Ai(e[i]);return n}var hue=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function V$(e){const{anchor:t,frame:n,offset:i,orient:r,angle:o,limit:a,color:s,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=hue(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),s?{fill:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),o!==void 0?{angle:o}:{}),a!==void 0?{limit:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),x=ac(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMarkTitleProperties:y,subtitle:v}}function ss(e){return K(e)||P(e)&&K(e[0])}function oe(e){return e&&!!e.signal}function us(e){return!!e.step}function gue(e){return P(e)?!1:"fields"in e&&!("data"in e)}function pue(e){return P(e)?!1:"fields"in e&&"data"in e}function Jo(e){return P(e)?!1:"field"in e&&"data"in e}const mue={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},yue=U(mue),vue={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},kE=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var CE=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Y$(e){const t=P(e.condition)?e.condition.map(X$):X$(e.condition);return Object.assign(Object.assign({},Ai(e)),{condition:t})}function Ai(e){if(fh(e)){const{expr:t}=e,n=CE(e,["expr"]);return Object.assign({signal:t},n)}return e}function X$(e){if(fh(e)){const{expr:t}=e,n=CE(e,["expr"]);return Object.assign({signal:t},n)}return e}function lt(e){if(fh(e)){const{expr:t}=e,n=CE(e,["expr"]);return Object.assign({signal:t},n)}return oe(e)?e:e!==void 0?{value:e}:void 0}function bue(e){return oe(e)?e.signal:H(e)}function K$(e){return oe(e)?e.signal:H(e.value)}function Qo(e){return oe(e)?e.signal:e==null?null:H(e)}function xue(e,t,n){for(const i of n){const r=vu(i,t.markDef,t.config);r!==void 0&&(e[i]=lt(r))}return e}function J$(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function He(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:o&&(!r||r===e)?void 0:vu(e,t,n,i)}function vu(e,t,n,{vgChannel:i}={}){return At(i?j0(e,t,n.style):void 0,j0(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function j0(e,t,n){return Q$(e,J$(t),n)}function Q$(e,t,n){t=J(t);let i;for(const r of t){const o=n[r];o&&o[e]!==void 0&&(i=o[e])}return i}function Z$(e,t){return J(e).reduce((n,i)=>{var r;return n.field.push(V(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function eL(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(Qr(r,i))return;n.push(i)}),n}function tL(e,t){return Qr(e,t)||!t?e:e?[...J(e),...J(t)].join(", "):t}function nL(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((ss(n)||oe(n))&&(ss(i)||oe(i)))return{explicit:e.explicit,value:tL(n,i)};if(ss(n)||oe(n))return{explicit:e.explicit,value:n};if(ss(i)||oe(i))return{explicit:e.explicit,value:i};if(!ss(n)&&!oe(n)&&!ss(i)&&!oe(i))return{explicit:e.explicit,value:eL(n,i)};throw new Error("It should never reach here")}function TE(e){return`Invalid specification ${rt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const wue='Autosize "fit" only works for single views and layered views.';function iL(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function rL(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function oL(e){return e?`Dropping "fit-${e}" because spec has discrete ${ai(e)}.`:'Dropping "fit" because spec has discrete size.'}function FE(e){return`Unknown field for ${e}. Cannot calculate view size.`}function aL(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function _ue(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Eue(e){return`The "nearest" transform is not supported for ${e} marks.`}function sL(e){return`Selection not supported for ${e} yet.`}function Oue(e){return`Cannot find a selection named "${e}".`}const Sue="Scale bindings are currently only supported for scales with unbinned, continuous domains.",Aue="Legend bindings are only supported for selections over an individual field or encoding channel.";function kue(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function Cue(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const Tue="The same selection must be used to override scale domains in a layered view.",Fue='Interval selections should be initialized using "x" and/or "y" keys.';function Due(e){return`Unknown repeated value "${e}".`}function uL(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const Mue="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function Nue(e){return`Unrecognized parse "${e}".`}function lL(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const Rue="Attempt to add the same child twice.";function jue(e){return`Ignoring an invalid transform: ${rt(e)}.`}const $ue='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function cL(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function Lue(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${rt(t)} is overridden by a child projection ${rt(n)}.`}const Iue="Arc marks uses theta channel rather than angle, replacing angle with theta.";function Pue(e){return`${e}Offset dropped because ${e} is continuous`}function zue(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function Bue(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${rt(n)}}.`}function fL(e){return`Invalid field type "${e}".`}function Uue(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function que(e){return`Invalid aggregation operator "${e}".`}function dL(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function Wue(e){return`Position range does not support relative band size for ${e}.`}function DE(e,t){return`Dropping ${rt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const Hue="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function $0(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function Gue(e){return`${e} encoding has no scale, so specified scale is ignored.`}function Vue(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Yue(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Xue(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Kue(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function ME(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Jue(e){return`The ${e} for range marks cannot be an expression`}function Que(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Zue(e,t){return`Specified orient "${e}" overridden with "${t}".`}function ele(e){return`Cannot use the scale property "${e}" with non-color channel.`}function tle(e){return`Cannot use the relative band size with ${e} scale.`}function nle(e){return`Using unaggregated domain with raw field has no effect (${rt(e)}).`}function ile(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function rle(e){return`Unaggregated domain is currently unsupported for log scale (${rt(e)}).`}function ole(e){return`Cannot apply size to non-oriented mark "${e}".`}function ale(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function sle(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function hL(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function gL(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function ule(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${rt(n)} and ${rt(i)}). Using ${rt(n)}.`}function lle(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${rt(n)} and ${rt(i)}). Using the union of the two domains.`}function cle(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function fle(e){return`Dropping sort property ${rt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const pL="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",dle="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",hle="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",gle="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function ple(e){return`Cannot stack "${e}" if there is already "${e}2".`}function mle(e){return`Cannot stack non-linear scale (${e}).`}function yle(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function L0(e,t){return`Invalid ${e}: ${rt(t)}.`}function vle(e){return`Dropping day from datetime ${rt(e)} as day cannot be combined with other units.`}function ble(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function xle(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function wle(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function mL(e){return`1D error band does not support ${e}.`}function yL(e){return`Channel ${e} is required for "binned" bin.`}function _le(e){return`Channel ${e} should not be used with "binned" bin.`}function Ele(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const vL=Sy(Oy);let fc=vL;function Ole(e){return fc=e,fc}function Sle(){return fc=vL,fc}function q(...e){fc.warn(...e)}function Ale(...e){fc.debug(...e)}function bu(e){if(e&&Q(e)){for(const t of RE)if(t in e)return!0}return!1}const bL=["january","february","march","april","may","june","july","august","september","october","november","december"],kle=bL.map(e=>e.substr(0,3)),xL=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Cle=xL.map(e=>e.substr(0,3));function Tle(e){if(A0(e)&&(e=+e),Je(e))return e>4&&q(L0("quarter",e)),e-1;throw new Error(L0("quarter",e))}function Fle(e){if(A0(e)&&(e=+e),Je(e))return e-1;{const t=e.toLowerCase(),n=bL.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=kle.indexOf(i);if(r!==-1)return r;throw new Error(L0("month",e))}}function Dle(e){if(A0(e)&&(e=+e),Je(e))return e%7;{const t=e.toLowerCase(),n=xL.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=Cle.indexOf(i);if(r!==-1)return r;throw new Error(L0("day",e))}}function NE(e,t){const n=[];if(t&&e.day!==void 0&&U(e).length>1&&(q(vle(e)),e=be(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?Fle(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?Tle(e.quarter):e.quarter;n.push(Je(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?Dle(e.day):e.day;n.push(Je(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function dh(e){const n=NE(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Mle(e){const n=NE(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function Nle(e){const t=NE(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var Rle=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const wL={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},RE=U(wL);function jle(e){return!!wL[e]}function jE(e){return e.startsWith("utc")}function $le(e){return e.substr(3)}const Lle={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function $E(e){return RE.filter(t=>_L(e,t))}function _L(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function Ile(e,t,{end:n}={end:!1}){const i=yE(t),r=jE(e)?"utc":"";function o(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let a;const s={};for(const u of RE)_L(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),Mle(s)}function EL(e){if(!e)return;const t=$E(e);return`timeUnitSpecifier(${rt(t)}, ${rt(Lle)})`}function Ple(e,t,n){if(!e)return;const i=EL(e);return`${n||jE(e)?"utc":"time"}Format(${t}, ${i})`}function Bn(e){if(!e)return;let t;return K(e)?t={unit:e}:Q(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),jE(t.unit)&&(t.utc=!0,t.unit=$le(t.unit)),t}function zle(e){const t=Bn(e),{utc:n}=t,i=Rle(t,["utc"]);return i.unit?(n?"utc":"")+U(i).map(r=>ht(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+U(i).map(r=>ht(`_${r}_${i[r]}`)).join("")}function Ble(e){return e==null?void 0:e.param}function LE(e){return e&&!!e.field&&e.equal!==void 0}function IE(e){return e&&!!e.field&&e.lt!==void 0}function PE(e){return e&&!!e.field&&e.lte!==void 0}function zE(e){return e&&!!e.field&&e.gt!==void 0}function BE(e){return e&&!!e.field&&e.gte!==void 0}function UE(e){if(e==null?void 0:e.field){if(P(e.range)&&e.range.length===2)return!0;if(oe(e.range))return!0}return!1}function qE(e){return e&&!!e.field&&(P(e.oneOf)||P(e.in))}function Ule(e){return e&&!!e.field&&e.valid!==void 0}function OL(e){return qE(e)||LE(e)||UE(e)||IE(e)||zE(e)||PE(e)||BE(e)}function so(e,t){return Z0(e,{timeUnit:t,wrapTime:!0})}function qle(e,t){return e.map(n=>so(n,t))}function SL(e,t=!0){var n;const{field:i}=e,r=(n=Bn(e.timeUnit))===null||n===void 0?void 0:n.unit,o=r?`time(${Ile(r,i)})`:V(e,{expr:"datum"});if(LE(e))return`${o}===${so(e.equal,r)}`;if(IE(e)){const a=e.lt;return`${o}<${so(a,r)}`}else if(zE(e)){const a=e.gt;return`${o}>${so(a,r)}`}else if(PE(e)){const a=e.lte;return`${o}<=${so(a,r)}`}else if(BE(e)){const a=e.gte;return`${o}>=${so(a,r)}`}else{if(qE(e))return`indexof([${qle(e.oneOf,r).join(",")}], ${o}) !== -1`;if(Ule(e))return WE(o,e.valid);if(UE(e)){const{range:a}=e,s=oe(a)?{signal:`${a.signal}[0]`}:a[0],u=oe(a)?{signal:`${a.signal}[1]`}:a[1];if(s!==null&&u!==null&&t)return"inrange("+o+", ["+so(s,r)+", "+so(u,r)+"])";const l=[];return s!==null&&l.push(`${o} >= ${so(s,r)}`),u!==null&&l.push(`${o} <= ${so(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${rt(e)}`)}function WE(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function Wle(e){var t;return OL(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Bn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const hh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function Hle(e){return e==="quantitative"||e==="temporal"}function AL(e){return e==="ordinal"||e==="nominal"}const xu=hh.quantitative,HE=hh.ordinal,dc=hh.temporal,GE=hh.nominal,hc=hh.geojson;function Gle(e){if(e)switch(e=e.toLowerCase(),e){case"q":case xu:return"quantitative";case"t":case dc:return"temporal";case"o":case HE:return"ordinal";case"n":case GE:return"nominal";case hc:return"geojson"}}var Vle=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const ui={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},VE={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Yle(e,t){const n=VE[e],i=VE[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const Xle={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function kL(e){return Xle[e]}const CL=new Set(["linear","log","pow","sqrt","symlog"]),TL=new Set([...CL,"time","utc"]);function FL(e){return CL.has(e)}const DL=new Set(["quantile","quantize","threshold"]),Kle=new Set([...TL,...DL,"sequential","identity"]),Jle=new Set(["ordinal","bin-ordinal","point","band"]);function Ht(e){return Jle.has(e)}function ki(e){return Kle.has(e)}function br(e){return TL.has(e)}function gc(e){return DL.has(e)}const Qle={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function Zle(e){return!K(e)&&!!e.name}function ML(e){return e==null?void 0:e.param}function ece(e){return e&&e.unionWith}function tce(e){return Q(e)&&"field"in e}const nce={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},ice=Vle(nce,["type","domain","range","rangeMax","rangeMin","scheme"]),rce=U(ice);function YE(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return br(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return br(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return br(e);case"nice":return br(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ki(e)&&!Me(["log","time","utc","threshold","quantile"],e)}}function NL(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return lc(e)?void 0:ele(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function oce(e,t){return Me([HE,GE],t)?e===void 0||Ht(e):t===dc?Me([ui.TIME,ui.UTC,void 0],e):t===xu?FL(e)||gc(e)||e===void 0:!0}function ace(e,t,n=!1){if(!os(e))return!1;switch(e){case pt:case Wt:case Za:case uc:case yr:case to:return br(t)||t==="band"?!0:t==="point"?!n:!1;case Vo:case ns:case Yo:case es:case ts:case gu:return br(t)||gc(t)||Me(["band","point","ordinal"],t);case ri:case ro:case oo:return t!=="band";case is:case oi:return t==="ordinal"||gc(t)}}const Un={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},RL=Un.arc,I0=Un.area,P0=Un.bar,sce=Un.image,z0=Un.line,B0=Un.point,uce=Un.rect,U0=Un.rule,jL=Un.text,XE=Un.tick,lce=Un.trail,KE=Un.circle,JE=Un.square,$L=Un.geoshape;function ls(e){return["line","area","trail"].includes(e)}function LL(e){return["rect","bar","image","arc"].includes(e)}const cce=new Set(U(Un));function uo(e){return e.type}const fce=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],dce=["fill","fillOpacity"],hce=[...fce,...dce],gce={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},IL=U(gce),pce={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},mce={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},yce={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},PL=U(yce);function pc(e){return e&&e.band!=null}const vce={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},zL=5,bce={binSpacing:1,continuousBandSize:zL,timeUnitBandPosition:.5},xce={binSpacing:0,continuousBandSize:zL,timeUnitBandPosition:.5},wce={thickness:1};function _ce(e){return uo(e)?e.type:e}function QE(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,a=eO(e);return G(n)&&!W$(n.aggregate)&&r&&br(r.get("type"))?Ece({fieldDef:n,channel:t,markDef:i,ref:a,config:o}):a}function Ece({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return ls(n.type)?i:He("invalid",n,r)===null?[Oce(e,t),i]:i}function Oce(e,t){const n=ZE(e,!0),r=mu(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function ZE(e,t=!0){return WE(K(e)?e:V(e,{expr:"datum"}),!t)}function Sce(e){const{datum:t}=e;return bu(t)?dh(t):`${rt(t)}`}function wu(e,t,n,i){const r={};if(t&&(r.scale=t),co(e)){const{datum:o}=e;bu(o)?r.signal=dh(o):oe(o)?r.signal=o.signal:fh(o)?r.signal=o.expr:r.value=o}else r.field=V(e,n);if(i){const{offset:o,band:a}=i;o&&(r.offset=o),a&&(r.band=a)}return r}function q0({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=V(t,{expr:a,suffix:r}),u=n!==void 0?V(n,{expr:a}):V(t,{suffix:"end",expr:a}),l={};if(o===0||o===1){l.scale=e;const c=o===0?s:u;l.field=c}else{const c=oe(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function eO({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(ye(t)){const d=a==null?void 0:a.get("type");if(qi(t)){c!=null||(c=QL({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:g,type:p}=t;if(ot(h)||c&&g&&p===dc)return(s==null?void 0:s.impute)?wu(t,o,{binSuffix:"mid"},{offset:u}):c&&!Ht(d)?q0({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):wu(t,o,yh(t,e)?{binSuffix:"range"}:{},{offset:u});if(zn(h)){if(G(n))return q0({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});q(yL(e===pt?mr:eo))}}return wu(t,o,Ht(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(xr(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},gh(e,d)),h)}}return _e(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function gh(e,t){return Me(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:Me(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:lt(t)}function _u(e){return e&&e!=="number"&&e!=="time"}function BL(e,t,n){return`${e}(${t}${n?`, ${rt(n)}`:""})`}const Ace=" \u2013 ";function tO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var a,s;if(_u(n))return nO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const u=UL(e,i,r);if(vc(e)){const l=Cce(u,G(e)?(a=Bn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,o.timeFormat,Eu(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ui.UTC);return l?{signal:l}:void 0}if(t=HL(aO(e),t,o),G(e)&&ot(e.bin)){const l=V(e,{expr:i,binSuffix:"end"});return{signal:W0(u,l,t,n,o)}}else return t||aO(e)==="quantitative"?{signal:`${GL(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function UL(e,t,n){return G(e)?n?`${V(e,{expr:t,suffix:"end"})}-${V(e,{expr:t,suffix:"start"})}`:V(e,{expr:t}):Sce(e)}function nO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:a}){if(a!=null||(a=UL(e,i,r)),G(e)&&ot(e.bin)){const s=V(e,{expr:i,binSuffix:"end"});return{signal:W0(a,s,t,n,o)}}return{signal:BL(n,a,t)}}function qL(e,t,n,i,r,o){var a;if(!_u(i)){if(vc(e)){const s=G(e)?(a=Bn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return kce(n,s,r,o)}return HL(t,n,r)}}function WL(e,t,n){if(e&&(oe(e)||e==="number"||e==="time"))return e;if(vc(t)&&n!=="time"&&n!=="utc")return"time"}function HL(e,t,n){if(K(t))return t;if(e===xu)return n.numberFormat}function kce(e,t,n,i){return e||(t?{signal:EL(t)}:i?void 0:n.timeFormat)}function GL(e,t){return`format(${e}, "${t||""}")`}function VL(e,t,n,i){var r;return _u(n)?BL(n,e,t):GL(e,(r=K(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function W0(e,t,n,i,r){const o=VL(e,n,i,r),a=VL(t,n,i,r);return`${WE(e,!1)} ? "null" : ${o} + "${Ace}" + ${a}`}function Cce(e,t,n,i,r){return!t||n?(n=K(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):Ple(t,e,r)}const H0="min",Tce={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function YL(e){return e in Tce}function XL(e){return!!e&&!!e.encoding}function lo(e){return!!e&&(e.op==="count"||!!e.field)}function KL(e){return!!e&&P(e)}function ph(e){return"row"in e||"column"in e}function iO(e){return!!e&&"header"in e}function G0(e){return"facet"in e}var rO=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Fce(e){return e.param}function Dce(e){return e&&!K(e)&&"repeat"in e}function JL(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function oO(e){return"sort"in e}function QL({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(ye(e)&&e.bandPosition!==void 0)return e.bandPosition;if(G(e)){const{timeUnit:r,bin:o}=e;if(r&&!t)return LL(n.type)?0:vu("timeUnitBandPosition",n,i);if(ot(o))return .5}}function ZL({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:o,useVlSizeChannel:a}){var s,u,l;const c=ai(e),f=He(a?"size":c,i,r,{vgChannel:c});if(f!==void 0)return f;if(G(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:vu("timeUnitBandSize",i,r)};if(ot(h)&&!Ht(o))return{band:1}}if(LL(i.type))return o?Ht(o)?((s=r[i.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}:(u=r[i.type])===null||u===void 0?void 0:u.continuousBandSize:(l=r[i.type])===null||l===void 0?void 0:l.discreteBandSize}function eI(e,t,n,i){return ot(e.bin)||e.timeUnit&&qi(e)&&e.type==="temporal"?QL({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function V0(e){return e&&"condition"in e}function Y0(e){const t=e&&e.condition;return!!t&&!P(t)&&G(t)}function mh(e){const t=e&&e.condition;return!!t&&!P(t)&&ye(t)}function Mce(e){const t=e&&e.condition;return!!t&&(P(t)||xr(t))}function G(e){return e&&(!!e.field||e.aggregate==="count")}function aO(e){return e&&e.type}function co(e){return e&&"datum"in e}function fo(e){return qi(e)&&!X0(e)||sO(e)}function sO(e){return co(e)&&Je(e.datum)}function ye(e){return G(e)||co(e)}function qi(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function xr(e){return e&&"value"in e&&"value"in e}function Eu(e){return e&&("scale"in e||"sort"in e)}function uO(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function tI(e){return e&&"legend"in e}function nI(e){return e&&("format"in e||"formatType"in e)}function Nce(e){return Si(e,["legend","axis","header","scale"])}function Rce(e){return"op"in e}function V(e,t={}){var n,i,r;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if($ce(e))o=D$("count");else{let l;if(!t.nofn)if(Rce(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;ot(c)?(l=H$(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?as(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):Ko(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=zle(d),s=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(o=o?`${l}_${o}`:l)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?vE(o):t.expr?C$(o,t.expr)+u:zi(o)+u}function X0(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return G(e)&&!!e.bin;case"temporal":return!1}throw new Error(fL(e.type))}function jce(e){var t;return Eu(e)&&gc((t=e.scale)===null||t===void 0?void 0:t.type)}function $ce(e){return e.aggregate==="count"}function Lce(e,t){var n;const{field:i,bin:r,timeUnit:o,aggregate:a}=e;if(a==="count")return t.countTitle;if(ot(r))return`${i} (binned)`;if(o){const s=(n=Bn(o))===null||n===void 0?void 0:n.unit;if(s)return`${i} (${$E(s).join("-")})`}else if(a)return as(a)?`${i} for max ${a.argmax}`:Ko(a)?`${i} for min ${a.argmin}`:`${oh(a)} of ${i}`;return i}function Ice(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(as(t))return`${r} for argmax(${t.argmax})`;if(Ko(t))return`${r} for argmin(${t.argmin})`;const o=Bn(i),a=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||ot(n)&&"bin";return a?`${a.toUpperCase()}(${r})`:r}const iI=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return Ice(e);default:return Lce(e,t)}};let rI=iI;function oI(e){rI=e}function Pce(){oI(iI)}function mc(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const a=(r=lO(e))===null||r===void 0?void 0:r.title;if(!G(e))return a!=null?a:e.title;const s=e,u=i?cO(s,t):void 0;return n?At(a,s.title,u):(o=a!=null?a:s.title)!==null&&o!==void 0?o:u}function lO(e){if(uO(e)&&e.axis)return e.axis;if(tI(e)&&e.legend)return e.legend;if(iO(e)&&e.header)return e.header}function cO(e,t){return rI(e,t)}function K0(e){var t;if(nI(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=lO(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function zce(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(oO(e)&&P(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:o}=e;if(o)return"temporal";if(r||i&&!as(i)&&!Ko(i))return"quantitative";if(Eu(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(VE[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function ho(e){if(G(e))return e;if(Y0(e))return e.condition}function $t(e){if(ye(e))return e;if(mh(e))return e.condition}function aI(e,t,n,i={}){if(K(e)||Je(e)||ha(e)){const r=K(e)?"string":Je(e)?"number":"boolean";return q(Bue(t,r,e)),{value:e}}return ye(e)?J0(e,t,n,i):mh(e)?Object.assign(Object.assign({},e),{condition:J0(e.condition,t,n,i)}):e}function J0(e,t,n,i){if(nI(e)){const{format:r,formatType:o}=e,a=rO(e,["format","formatType"]);if(_u(o)&&!n.customFormatTypes)return q(cL(t)),J0(a,t,n,i)}else{const r=uO(e)?"axis":tI(e)?"legend":iO(e)?"header":null;if(r&&e[r]){const o=e[r],{format:a,formatType:s}=o,u=rO(o,["format","formatType"]);if(_u(s)&&!n.customFormatTypes)return q(cL(t)),J0(Object.assign(Object.assign({},e),{[r]:u}),t,n,i)}}return G(e)?fO(e,t,i):Bce(e)}function Bce(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Je(n)?"quantitative":K(n)?"nominal":bu(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function fO(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:o,field:a}=e,s=Object.assign({},e);if(!n&&i&&!AE(i)&&!as(i)&&!Ko(i)&&(q(que(i)),delete s.aggregate),r&&(s.timeUnit=Bn(r)),a&&(s.field=`${a}`),ot(o)&&(s.bin=Q0(o,t)),zn(o)&&!rn(t)&&q(_le(t)),qi(s)){const{type:u}=s,l=Gle(u);u!==l&&(s.type=l),u!=="quantitative"&&W$(i)&&(q(Uue(u,i)),s.type="quantitative")}else if(!L$(t)){const u=zce(s,t);s.type=u}if(qi(s)){const{compatible:u,warning:l}=Uce(s,t)||{};u===!1&&q(l)}if(oO(s)&&K(s.sort)){const{sort:u}=s;if(YL(u))return Object.assign(Object.assign({},s),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&YL(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(iO(s)){const{header:u}=s;if(u){const{orient:l}=u,c=rO(u,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return s}function Q0(e,t){return ha(e)?{maxbins:G$(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:G$(t)}):e}const yc={compatible:!0};function Uce(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case qo:case Wo:case k0:return X0(e)?yc:{compatible:!1,warning:Yue(t)};case pt:case Wt:case Za:case uc:case ri:case ro:case oo:case uh:case ch:case C0:case pu:case T0:case F0:case gu:case yr:case to:case D0:return yc;case io:case Bi:case no:case vr:return n!==xu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:yc;case Yo:case es:case ts:case ns:case Vo:case Go:case Ho:case mr:case eo:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:yc;case oi:case is:return!X0(e)&&!jce(e)?{compatible:!1,warning:Xue(t)}:yc;case lh:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:yc}}function vc(e){const{formatType:t}=K0(e);return t==="time"||!t&&qce(e)}function qce(e){return e&&(e.type==="temporal"||G(e)&&!!e.timeUnit)}function Z0(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var o;const a=t&&((o=Bn(t))===null||o===void 0?void 0:o.unit);let s=a||n==="temporal",u;return fh(e)?u=e.expr:oe(e)?u=e.signal:bu(e)?(s=!0,u=dh(e)):(K(e)||Je(e))&&s&&(u=`datetime(${rt(e)})`,jle(a)&&(Je(e)&&e<1e4||K(e)&&isNaN(Date.parse(e)))&&(u=dh({[a]:e}))),u?i&&s?`time(${u})`:u:r?void 0:rt(e)}function sI(e,t){const{type:n}=e;return t.map(i=>{const r=Z0(i,{timeUnit:G(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function yh(e,t){return ot(e.bin)?os(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const uI={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function vh(e){return e&&e.condition}const lI=["domain","grid","labels","ticks","title"],Wce={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},cI={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Hce=Object.assign(Object.assign({},cI),{style:1,labelExpr:1,encoding:1});function fI(e){return!!Hce[e]}const Gce={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},dI=U(Gce);function Zo(e){return"mark"in e}class e1{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return Zo(t)?_ce(t.mark)===this.name:!1}}var Vce=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ou(e,t){const n=e&&e[t];return n?P(n)?du(n,i=>!!i.field):G(n)||Y0(n):!1}function hI(e,t){const n=e&&e[t];return n?P(n)?du(n,i=>!!i.field):G(n)||co(n)||mh(n):!1}function dO(e,t){if(rn(t)){const n=e[t];if((G(n)||co(n))&&AL(n.type)){const i=I$(t);return hI(e,i)}}return!1}function hO(e){return du(Gse,t=>{if(Ou(e,t)){const n=e[t];if(P(n))return du(n,i=>!!i.aggregate);{const i=ho(n);return i&&!!i.aggregate}}return!1})}function gI(e,t){const n=[],i=[],r=[],o=[],a={};return gO(e,(s,u)=>{if(G(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=Vce(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=lO(s),p=g==null?void 0:g.title;let m=V(s,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:mc(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let v;if(as(c)?(v="argmax",m=V({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):Ko(c)?(v="argmin",m=V({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:m};l&&(x.field=l),o.push(x)}}else if(n.push(m),qi(s)&&ot(f)){if(i.push({bin:f,field:l,as:m}),n.push(V(s,{binSuffix:"end"})),yh(s,u)&&n.push(V(s,{binSuffix:"range"})),rn(u)){const v={field:`${m}_end`};a[`${u}2`]=v}y.bin="binned",L$(u)||(y.type=xu)}else if(d){r.push({timeUnit:d,field:l,as:m});const v=qi(s)&&s.type!==dc&&"time";v&&(u===uh||u===pu?y.formatType=v:nue(u)?y.legend=Object.assign({formatType:v},y.legend):rn(u)&&(y.axis=Object.assign({formatType:v},y.axis)))}a[u]=y}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:a}}function Yce(e,t,n){const i=rue(t,n);if(i){if(i==="binned"){const r=e[t===mr?pt:Wt];return!!(G(r)&&G(e[t])&&zn(r.bin))}}else return!1;return!0}function Xce(e,t,n,i){const r={};for(const o of U(e))$$(o)||q(Vue(o));for(let o of Qse){if(!e[o])continue;const a=e[o];if(cc(o)){const s=P$(o),u=r[s];if(G(u)){if(Hle(u.type)&&G(a)){q(Pue(s));continue}}else o=s,q(zue(s))}if(o==="angle"&&t==="arc"&&!e.theta&&(q(Iue),o=yr),!Yce(e,o,t)){q($0(o,t));continue}if(o===Vo&&t==="line"){const s=ho(e[o]);if(s==null?void 0:s.aggregate){q(Hue);continue}}if(o===ri&&(n?"fill"in e:"stroke"in e)){q(dL("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===ch||o===lh&&!P(a)&&!xr(a)||o===pu&&P(a))a&&(r[o]=J(a).reduce((s,u)=>(G(u)?s.push(fO(u,o)):q(DE(u,o)),s),[]));else{if(o===pu&&a===null)r[o]=null;else if(!G(a)&&!co(a)&&!xr(a)&&!V0(a)&&!oe(a)){q(DE(a,o));continue}r[o]=aI(a,o,i)}}return r}function t1(e,t){const n={};for(const i of U(e)){const r=aI(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Kce(e){const t=[];for(const n of U(e))if(Ou(e,n)){const i=e[n],r=J(i);for(const o of r)G(o)?t.push(o):Y0(o)&&t.push(o.condition)}return t}function gO(e,t,n){if(!!e)for(const i of U(e)){const r=e[i];if(P(r))for(const o of r)t.call(n,o,i);else t.call(n,r,i)}}function Jce(e,t,n,i){return e?U(e).reduce((r,o)=>{const a=e[o];return P(a)?a.reduce((s,u)=>t.call(i,s,u,o),r):t.call(i,r,a,o)},n):n}function pI(e,t){return U(t).reduce((n,i)=>{switch(i){case pt:case Wt:case T0:case D0:case F0:case mr:case eo:case Za:case uc:case yr:case Go:case to:case Ho:case no:case io:case vr:case Bi:case uh:case oi:case gu:case pu:return n;case lh:if(e==="line"||e==="trail")return n;case ch:case C0:{const r=t[i];if(P(r)||G(r))for(const o of J(r))o.aggregate||n.push(V(o,{}));return n}case Vo:if(e==="trail")return n;case ri:case ro:case oo:case Yo:case es:case ts:case is:case ns:{const r=ho(t[i]);return r&&!r.aggregate&&n.push(V(r,{})),n}}},[])}var mI=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Qce(e){const{tooltip:t}=e,n=mI(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(P(t)){for(const o of t)o.aggregate?(i||(i=[]),i.push(o)):(r||(r=[]),r.push(o));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return P(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function pO(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:a,titlePrefix:s})=>{const u=i?` of ${mO(t)}`:"";return{field:a+t.field,type:t.type,title:oe(s)?{signal:`${s}"${escape(u)}"`}:s+u}}),o=Kce(n).map(Nce);return{tooltip:[...r,...Zr(o,De)]}}function mO(e){const{title:t,field:n}=e;return At(t,n)}function yO(e,t,n,i,r){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=mO(n);return yI(e,s,r,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),a!==void 0?{axis:a}:{})},K(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function yI(e,t,n,i){const{clip:r,color:o,opacity:a}=e,s=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),o?{color:o}:{}),a?{opacity:a}:{}),uo(i.mark)?i.mark:{type:i.mark}),{style:`${s}-${t}`}),ha(e[t])?{}:e[t])})]:[]}function vI(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",o=i[r],a=i[`${r}2`],s=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:n1(o,n),continuousAxisChannelDef2:n1(a,n),continuousAxisChannelDefError:n1(s,n),continuousAxisChannelDefError2:n1(u,n),continuousAxis:r}}function n1(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,i=mI(e,["aggregate"]);return n!==t&&q(wle(n,t)),i}else return e}function bI(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(uo(n)&&n.orient)return n.orient;if(fo(r)){if(fo(o)){const a=G(r)&&r.aggregate,s=G(o)&&o.aggregate;if(!a&&s===t)return"vertical";if(!s&&a===t)return"horizontal";if(a===t&&s===t)throw new Error("Both x and y cannot have aggregate");return vc(o)&&!vc(r)?"horizontal":"vertical"}return"horizontal"}else{if(fo(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var i1=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const r1="boxplot",Zce=["box","median","outliers","rule","ticks"],efe=new e1(r1,wI);function xI(e){return Je(e)?"tukey":e}function wI(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:t1(e.encoding,t)});const{mark:r,encoding:o,params:a,projection:s}=e,u=i1(e,["mark","encoding","params","projection"]),l=uo(r)?r:{type:r};a&&q(sL("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=He("size",l,t),d=xI(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:x,encodingWithoutContinuousAxis:b,ticksOrient:_,boxOrient:E,customTooltipWithoutAggregatedField:w}=tfe(e,c,t),{color:O,size:S}=b,k=i1(b,["color","size"]),A=qe=>yO(l,y,m,qe,t.boxplot),F=A(k),C=A(b),M=A(Object.assign(Object.assign({},k),S?{size:S}:{})),D=pO([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),N={type:"tick",color:"black",opacity:1,orient:_,invalid:null,aria:!1},I=d==="min-max"?D:pO([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),z=[...F({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:I}),...F({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:I}),...F({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:I}),...F({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:I})],X=[...d!=="tukey"?z:[],...C({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:E,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:D}),...M({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Q(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:_,aria:!1}),positionPrefix:"mid_box",extraEncoding:D})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(p),layer:X});const te=`datum["lower_box_${m.field}"]`,xe=`datum["upper_box_${m.field}"]`,ge=`(${xe} - ${te})`,je=`${te} - ${c} * ${ge}`,Oe=`${xe} + ${c} * ${ge}`,ke=`datum["${m.field}"]`,Xe={joinaggregate:_I(m.field),groupby:v},xt={transform:[{filter:`(${je} <= ${ke}) && (${ke} <= ${Oe})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...x],groupby:v}],layer:z},Ge=i1(k,["tooltip"]),{scale:Y,axis:ne}=m,fe=mO(m),B=Si(ne,["title"]),Ve=yI(l,"outliers",t.boxplot,{transform:[{filter:`(${ke} < ${je}) || (${ke} > ${Oe})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},fe!==void 0?{title:fe}:{}),Y!==void 0?{scale:Y}:{}),Ze(B)?{}:{axis:B})},Ge),O?{color:O}:{}),w?{tooltip:w}:{})})[0];let pe;const tt=[...h,...g,Xe];return Ve?pe={transform:tt,layer:[Ve,xt]}:(pe=xt,pe.transform.unshift(...tt)),Object.assign(Object.assign({},u),{layer:[pe,{transform:p,layer:X}]})}function _I(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function tfe(e,t,n){const i=bI(e,r1),{continuousAxisChannelDef:r,continuousAxis:o}=vI(e,i,r1),a=r.field,s=xI(t),u=[..._I(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(s==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(s==="min-max"?"upper_whisker_":"max_")+a}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],c=e.encoding,f=o;c[f];const d=i1(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=Qce(d),{bins:p,timeUnits:m,aggregate:y,groupby:v,encoding:x}=gI(g,n),b=i==="vertical"?"horizontal":"vertical",_=i,E=[...p,...m,{aggregate:[...y,...u],groupby:v},...l];return{bins:p,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:b,boxOrient:_,customTooltipWithoutAggregatedField:h}}var EI=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const vO="errorbar",nfe=["ticks","rule"],ife=new e1(vO,OI);function OI(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:t1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=SI(e,vO,t);delete o.size;const c=yO(s,r,i,o,t.errorbar),f=s.thickness,d=s.size,h=Object.assign(Object.assign({type:"tick",orient:a,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function rfe(e,t){const{encoding:n}=e;if(ofe(n))return{orient:bI(e,t),inputType:"raw"};const i=afe(n),r=sfe(n),o=n.x,a=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(ye(s)&&ye(u))throw new Error(`${t} cannot have both x2 and y2`);if(ye(s)){if(fo(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ye(u)){if(fo(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ye(u)&&!ye(s))throw new Error(`${t} cannot have xError2 without xError`);if(ye(c)&&!ye(l))throw new Error(`${t} cannot have yError2 without yError`);if(ye(s)&&ye(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ye(s)){if(fo(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ye(l)){if(fo(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function ofe(e){return(ye(e.x)||ye(e.y))&&!ye(e.x2)&&!ye(e.y2)&&!ye(e.xError)&&!ye(e.xError2)&&!ye(e.yError)&&!ye(e.yError2)}function afe(e){return ye(e.x2)||ye(e.y2)}function sfe(e){return ye(e.xError)||ye(e.xError2)||ye(e.yError)||ye(e.yError2)}function SI(e,t,n){var i;const{mark:r,encoding:o,params:a,projection:s}=e,u=EI(e,["mark","encoding","params","projection"]),l=uo(r)?r:{type:r};a&&q(sL(t));const{orient:c,inputType:f}=rfe(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=vI(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:x,tooltipTitleWithFieldName:b}=ufe(l,d,h,g,p,f,t,n),_=o,E=m;_[E];const w=m==="x"?"x2":"y2";_[w];const O=m==="x"?"xError":"yError";_[O];const S=m==="x"?"xError2":"yError2";_[S];const k=EI(_,[typeof E=="symbol"?E:E+"",typeof w=="symbol"?w:w+"",typeof O=="symbol"?O:O+"",typeof S=="symbol"?S:S+""]),{bins:A,timeUnits:F,aggregate:C,groupby:M,encoding:D}=gI(k,n),N=[...C,...y],I=f!=="raw"?[]:M,z=pO(x,d,D,b);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...A,...F,...N.length===0?[]:[{aggregate:N,groupby:I}],...v],groupby:I,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:D,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:z}}function ufe(e,t,n,i,r,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&q(xle(h,g,a)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:oh(h)},{fieldPrefix:"upper_",titlePrefix:AI(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:AI(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:mc({field:c,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:mc({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:mc({field:c,aggregate:p,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(ble(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:hu(hu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function AI(e,t,n){return`${oh(e)} ${n} ${t}`}const bO="errorband",lfe=["band","borders"],cfe=new e1(bO,kI);function kI(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:t1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=SI(e,bO,t),l=a,c=yO(l,r,i,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?q(mL("interpolate")):l.tension&&q(mL("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const CI={};function xO(e,t,n){const i=new e1(e,t);CI[e]={normalizer:i,parts:n}}function ffe(){return U(CI)}xO(r1,wI,Zce);xO(vO,OI,nfe);xO(bO,kI,lfe);const dfe=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],TI={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},FI={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},hfe=U(TI),gfe=U(FI),pfe={header:1,headerRow:1,headerColumn:1,headerFacet:1},DI=U(pfe),MI=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],mfe={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},yfe={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},bh="_vgsid_",vfe={point:{on:"click",fields:[bh],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function wO(e){return!!e&&(e==="legend"||!!e.legend)}function _O(e){return wO(e)&&Q(e)}function EO(e){return!!e.select}var bfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function NI(e){const t=[];for(const n of e||[]){if(EO(n))continue;const{expr:i,bind:r}=n,o=bfe(n,["expr","bind"]);if(r&&i){const a=Object.assign(Object.assign({},o),{bind:r,init:i});t.push(a)}else{const a=Object.assign(Object.assign(Object.assign({},o),i?{update:i}:{}),r?{bind:r}:{});t.push(a)}}return t}function xfe(e){return o1(e)||SO(e)||OO(e)}function OO(e){return"concat"in e}function o1(e){return"vconcat"in e}function SO(e){return"hconcat"in e}function RI({step:e,offsetIsDiscrete:t}){var n;return t?(n=e.for)!==null&&n!==void 0?n:"offset":"position"}function go(e){return Q(e)&&e.step!==void 0}function jI(e){return e.view||e.width||e.height}const $I=20,wfe={align:1,bounds:1,center:1,columns:1,spacing:1},_fe=U(wfe);function Efe(e,t,n){var i,r;const o=n[t],a={},{spacing:s,columns:u}=o;s!==void 0&&(a.spacing=s),u!==void 0&&(G0(e)&&!ph(e.facet)||OO(e))&&(a.columns=u),o1(e)&&(a.columns=1);for(const l of _fe)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];a[l]=Je(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:s,column:(r=c.column)!==null&&r!==void 0?r:s}}else a[l]=e[l];return a}var Ofe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function AO(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function a1(e,t){const n=s1(e,t);return go(n)?n.step:LI}function s1(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return At(i,{step:e.step})}const LI=20,Sfe={continuousWidth:200,continuousHeight:200,step:LI},Afe={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:Sfe,mark:mce,arc:{},area:{},bar:bce,circle:{},geoshape:{},image:{},line:{},point:{},rect:xce,rule:{color:"black"},square:{},text:{color:"black"},tick:wce,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:Qle,projection:{},legend:mfe,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:vfe,style:{},title:{},facet:{spacing:$I},concat:{spacing:$I}},ea=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],II={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},PI={blue:ea[0],orange:ea[1],red:ea[2],teal:ea[3],green:ea[4],yellow:ea[5],purple:ea[6],pink:ea[7],brown:ea[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function kfe(e={}){return{signals:[{name:"color",value:Q(e)?Object.assign(Object.assign({},PI),e):PI}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function Cfe(e){return{signals:[{name:"fontSize",value:Q(e)?Object.assign(Object.assign({},II),e):II}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function Tfe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function zI(e){const t=U(e||{}),n={};for(const i of t){const r=e[i];n[i]=vh(r)?Y$(r):Ai(r)}return n}function Ffe(e){const t=U(e),n={};for(const i of t)n[i]=zI(e[i]);return n}const Dfe=[...PL,...dI,...DI,"background","padding","legend","lineBreak","scale","style","title","view"];function BI(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,o=Ofe(e,["color","font","fontSize","selection"]),a=il({},be(Afe),n?Tfe(n):{},t?kfe(t):{},i?Cfe(i):{},o||{});r&&rl(a,"selection",r,!0);const s=Si(a,Dfe);for(const u of["background","lineBreak","padding"])a[u]&&(s[u]=Ai(a[u]));for(const u of PL)a[u]&&(s[u]=si(a[u]));for(const u of dI)a[u]&&(s[u]=zI(a[u]));for(const u of DI)a[u]&&(s[u]=si(a[u]));return a.legend&&(s.legend=si(a.legend)),a.scale&&(s.scale=si(a.scale)),a.style&&(s.style=Ffe(a.style)),a.title&&(s.title=si(a.title)),a.view&&(s.view=si(a.view)),s}const Mfe=new Set(["view",...cce]),Nfe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Rfe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},pce);function jfe(e){e=be(e);for(const t of Nfe)delete e[t];if(e.axis)for(const t in e.axis)vh(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of dfe)delete e.legend[t];if(e.mark){for(const t of IL)delete e.mark[t];e.mark.tooltip&&Q(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(NI(e.params)),delete e.params);for(const t of Mfe){for(const i of IL)delete e[t][i];const n=Rfe[t];if(n)for(const i of n)delete e[t][i];Lfe(e,t)}for(const t of ffe())delete e[t];$fe(e);for(const t in e)Q(e[t])&&Ze(e[t])&&delete e[t];return Ze(e)?void 0:e}function $fe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=V$(e.title);Ze(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Ze(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Ze(i)?delete e.title:e.title=i}function Lfe(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[n!=null?n:t]);Ze(o)||(e.style[n!=null?n:t]=o),i||delete e[t]}function u1(e){return"layer"in e}function Ife(e){return"repeat"in e}function Pfe(e){return!P(e.repeat)&&e.repeat.layer}var zfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class kO{map(t,n){return G0(t)?this.mapFacet(t,n):Ife(t)?this.mapRepeat(t,n):SO(t)?this.mapHConcat(t,n):o1(t)?this.mapVConcat(t,n):OO(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(u1(t))return this.mapLayer(t,n);if(Zo(t))return this.mapUnit(t,n);throw new Error(TE(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=zfe(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const Bfe={zero:1,center:1,normalize:1};function Ufe(e){return e in Bfe}const qfe=new Set([RL,P0,I0,U0,B0,KE,JE,z0,jL,XE]),Wfe=new Set([P0,I0,RL]);function bc(e){return G(e)&&aO(e)==="quantitative"&&!e.bin}function UI(e,t){var n,i;const r=t==="x"?"y":"radius",o=e[t],a=e[r];if(G(o)&&G(a))if(bc(o)&&bc(a)){if(o.stack)return t;if(a.stack)return r;const s=G(o)&&!!o.aggregate,u=G(a)&&!!a.aggregate;if(s!==u)return s?t:r;{const l=(n=o.scale)===null||n===void 0?void 0:n.type,c=(i=a.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(bc(o))return t;if(bc(a))return r}else{if(bc(o))return t;if(bc(a))return r}}function Hfe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function qI(e,t,n={}){var i,r;const o=uo(e)?e.type:e;if(!qfe.has(o))return null;const a=UI(t,"x")||UI(t,"theta");if(!a)return null;const s=t[a],u=G(s)?V(s,{}):void 0,l=Hfe(a),c=[],f=new Set;if(t[l]){const g=t[l],p=G(g)?V(g,{}):void 0;p&&p!==u&&(c.push(l),f.add(p));const m=l==="x"?"xOffset":"yOffset",y=t[m],v=G(y)?V(y,{}):void 0;v&&v!==u&&(c.push(m),f.add(v))}const d=Zse.reduce((g,p)=>{if(p!=="tooltip"&&Ou(t,p)){const m=t[p];for(const y of J(m)){const v=ho(y);if(v.aggregate)continue;const x=V(v,{});(!x||!f.has(x))&&g.push({channel:p,fieldDef:v})}}return g},[]);let h;if(s.stack!==void 0?ha(s.stack)?h=s.stack?"zero":null:h=s.stack:Wfe.has(o)&&(h="zero"),!h||!Ufe(h)||hO(t)&&d.length===0)return null;if(((i=s==null?void 0:s.scale)===null||i===void 0?void 0:i.type)&&((r=s==null?void 0:s.scale)===null||r===void 0?void 0:r.type)!==ui.LINEAR){if(n.disallowNonLinearStack)return null;q(mle(s.scale.type))}return ye(t[Xo(a)])?(s.stack!==void 0&&q(ple(a)),null):(G(s)&&s.aggregate&&!fue.has(s.aggregate)&&q(yle(s.aggregate)),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:s.impute===null?!1:ls(o),stackBy:d,offset:h})}var WI=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Gfe(e){const t=WI(e,["point","line"]);return U(t).length>1?t:t.type}function Vfe(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Si(e[t],["point","line"])}));return e}function CO(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Q(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Q(t.point)?t.point:{}:void 0}function HI(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Yfe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(Zo(t)){const{mark:i,encoding:r}=t,o=uo(i)?i:{type:i};switch(o.type){case"line":case"rule":case"trail":return!!CO(o,n[o.type],r);case"area":return!!CO(o,n[o.type],r)||!!HI(o,n[o.type])}}return!1}run(t,n,i){const{config:r}=n,{params:o,projection:a,mark:s,encoding:u}=t,l=WI(t,["params","projection","mark","encoding"]),c=t1(u,r),f=uo(s)?s:{type:s},d=CO(f,r[f.type],c),h=f.type==="area"&&HI(f,r[f.type]),g=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:Gfe(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:Si(c,["shape"])})],p=qI(f,c);let m=c;if(p){const{fieldChannel:y,offset:v}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),v?{stack:v}:{})})}return h&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},ac(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},ac(f,["clip","tooltip"])),d),encoding:m})),i(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:Vfe(r)}))}}var Xfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Kfe(e,t){return t?ph(e)?XI(e,t):GI(e,t):e}function TO(e,t){return t?XI(e,t):e}function FO(e,t,n){const i=t[e];if(Dce(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});q(Due(i.repeat));return}return t}function GI(e,t){if(e=FO("field",e,t),e!==void 0){if(e===null)return null;if(oO(e)&&lo(e.sort)){const n=FO("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function VI(e,t){if(G(e))return GI(e,t);{const n=FO("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function YI(e,t){if(ye(e)){const n=VI(e,t);if(n)return n;if(V0(e))return{condition:e.condition}}else{if(mh(e)){const n=VI(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):Xfe(e,["condition"])}return e}}function XI(e,t){const n={};for(const i in e)if(re(e,i)){const r=e[i];if(P(r))n[i]=r.map(o=>YI(o,t)).filter(o=>o);else{const o=YI(r,t);o!==void 0&&(n[i]=o)}}return n}class Jfe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Zo(t)){const{encoding:n,mark:i}=t;if(i==="line"||uo(i)&&i.type==="line")for(const r of Kse){const o=mu(r),a=n[o];if(n[r]&&(G(a)&&!zn(a.bin)||co(a)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:o}=t;return q(Que(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Q(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var cs=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Qfe extends kO{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[efe,ife,cfe,new Yfe,new Jfe]}map(t,n){if(Zo(t)){const i=Ou(t.encoding,qo),r=Ou(t.encoding,Wo),o=Ou(t.encoding,k0);if(i||r||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,o=TO(t.encoding,n.repeater),a=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(a,n);const s=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,s);return a}mapRepeat(t,n){return Pfe(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,o=cs(t,["repeat","spec"]),{row:a,column:s,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return a||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(r.name||"")+c}child__layer_${ht(f)}`,g=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:o,data:a}=t,s=cs(t,["repeat","spec","data"]);!P(r)&&t.columns&&(t=Si(t,["columns"]),q(uL("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!P(r)&&r.row||[l?l.row:null],d=!P(r)&&r.column||[l?l.column:null],h=P(r)&&r||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const v={repeat:p,row:m,column:y,layer:l.layer},x=(o.name||"")+c+"child__"+(P(r)?`${ht(p)}`:(r.row?`row_${ht(m)}`:"")+(r.column?`column_${ht(y)}`:"")),b=this.map(o,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:x}));b.name=x,u.push(Si(b,["data"]))}const g=P(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=o.data)!==null&&i!==void 0?i:a,align:"all"},s),{columns:g,concat:u})}mapFacet(t,n){const{facet:i}=t;return ph(i)&&t.columns&&(t=Si(t,["columns"]),q(uL("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:o,parentProjection:a,config:s}=n,u=JI({parentProjection:a,projection:r}),l=KI({parentEncoding:o,encoding:TO(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:o,facet:a}=i,s=cs(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=cs(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:r,column:o,facet:a},n),v=TO(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:o,facet:a}=t;if(r||o){a&&q(Kue([...r?[qo]:[],...o?[Wo]:[]]));const s={},u={};for(const l of[qo,Wo]){const c=t[l];if(c){const f=cs(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((i=u[d])!==null&&i!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=a,f=cs(a,["align","center","spacing","columns"]);return{facetMapping:Kfe(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,o=cs(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:s}=t,u=cs(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:KI({parentEncoding:i,encoding:a,layer:!0}),parentProjection:JI({parentProjection:r,projection:s})});return super.mapLayer(u,l)}}function KI({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...U(e),...U(t)]);for(const o of r){const a=t[o],s=e[o];if(ye(a)){const u=Object.assign(Object.assign({},s),a);i[o]=u}else mh(a)?i[o]=Object.assign(Object.assign({},a),{condition:Object.assign(Object.assign({},s),a.condition)}):a||a===null?i[o]=a:(n||xr(s)||oe(s)||ye(s)||P(s))&&(i[o]=s)}}else i=t;return!i||Ze(i)?void 0:i}function JI(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(Lue({parentProjection:t,projection:n})),n!=null?n:t}function DO(e){return"filter"in e}function Zfe(e){return(e==null?void 0:e.stop)!==void 0}function QI(e){return"lookup"in e}function ede(e){return"data"in e}function tde(e){return"param"in e}function nde(e){return"pivot"in e}function ide(e){return"density"in e}function rde(e){return"quantile"in e}function ode(e){return"regression"in e}function ade(e){return"loess"in e}function sde(e){return"sample"in e}function ude(e){return"window"in e}function lde(e){return"joinaggregate"in e}function cde(e){return"flatten"in e}function fde(e){return"calculate"in e}function ZI(e){return"bin"in e}function dde(e){return"impute"in e}function hde(e){return"timeUnit"in e}function gde(e){return"aggregate"in e}function pde(e){return"stack"in e}function mde(e){return"fold"in e}function yde(e){return e.map(t=>DO(t)?{filter:oc(t.filter,Wle)}:t)}var fs=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class vde extends kO{map(t,n){var i,r;return(i=n.emptySelections)!==null&&i!==void 0||(n.emptySelections={}),(r=n.selectionPredicates)!==null&&r!==void 0||(n.selectionPredicates={}),t=eP(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=eP(t,n),t.encoding){const i={};for(const[r,o]of Qa(t.encoding))i[r]=tP(o,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,o=fs(i,["selection"]);return r?Object.assign(Object.assign({},o),{params:Qa(r).map(([a,s])=>{var u;const l=s,{init:c,bind:f,empty:d}=l,h=fs(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[a]=d!=="none";for(const g of En((u=n.selectionPredicates[a])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:a,value:c,select:h,bind:f}})}):t}}function eP(e,t){const{transform:n}=e,i=fs(e,["transform"]);if(n){const r=n.map(o=>{if(DO(o))return{filter:MO(o,t)};if(ZI(o)&&yu(o.bin))return Object.assign(Object.assign({},o),{bin:nP(o.bin)});if(QI(o)){const a=o.from,{selection:s}=a,u=fs(a,["selection"]);return s?Object.assign(Object.assign({},o),{from:Object.assign({param:s},u)}):o}return o});return Object.assign(Object.assign({},i),{transform:r})}return e}function tP(e,t){var n,i;const r=be(e);if(G(r)&&yu(r.bin)&&(r.bin=nP(r.bin)),Eu(r)&&((i=(n=r.scale)===null||n===void 0?void 0:n.domain)===null||i===void 0?void 0:i.selection)){const o=r.scale.domain,{selection:a}=o,s=fs(o,["selection"]);r.scale.domain=Object.assign(Object.assign({},s),a?{param:a}:{})}if(V0(r))if(P(r.condition))r.condition=r.condition.map(o=>{const{selection:a,param:s,test:u}=o,l=fs(o,["selection","param","test"]);return s?o:Object.assign(Object.assign({},l),{test:MO(o,t)})});else{const o=tP(r.condition,t),{selection:a,param:s,test:u}=o,l=fs(o,["selection","param","test"]);r.condition=s?r.condition:Object.assign(Object.assign({},l),{test:MO(r.condition,t)})}return r}function nP(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,i=fs(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function MO(e,t){const n=i=>oc(i,r=>{var o,a,s;const u=(o=t.emptySelections[r])!==null&&o!==void 0?o:!0,l={param:r,empty:u};return(a=(s=t.selectionPredicates)[r])!==null&&a!==void 0||(s[r]=[]),t.selectionPredicates[r].push(l),l});return e.selection?n(e.selection):oc(e.test||e.filter,i=>i.selection?n(i.selection):i)}class NO extends kO{map(t,n){var i;const r=(i=n.selections)!==null&&i!==void 0?i:[];if(t.params&&!Zo(t)){const o=[];for(const a of t.params)EO(a)?r.push(a):o.push(a);t.params=o}return n.selections=r,super.map(t,iP(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const o=((i=n.path)!==null&&i!==void 0?i:[]).concat(t.name),a=[];for(const s of r)if(!s.views||!s.views.length)a.push(s);else for(const u of s.views)(K(u)&&(u===t.name||o.indexOf(u)>=0)||P(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=NO.prototype[e];NO.prototype[e]=function(n,i){return t.call(this,n,iP(n,i))}}function iP(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function rP(e,t){t===void 0&&(t=BI(e.config));const n=_de(e,t),{width:i,height:r}=e,o=Ede(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const bde=new Qfe,xde=new vde,wde=new NO;function _de(e,t={}){const n={config:t};return wde.map(bde.map(xde.map(e,n),n),n)}function oP(e){return K(e)?{type:e}:e!=null?e:{}}function Ede(e,t,n){let{width:i,height:r}=t;const o=Zo(e)||u1(e),a={};o?i=="container"&&r=="container"?(a.type="fit",a.contains="padding"):i=="container"?(a.type="fit-x",a.contains="padding"):r=="container"&&(a.type="fit-y",a.contains="padding"):(i=="container"&&(q(iL("width")),i=void 0),r=="container"&&(q(iL("height")),r=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?oP(n.autosize):{}),oP(e.autosize));if(s.type==="fit"&&!o&&(q(wue),s.type="pad"),i=="container"&&!(s.type=="fit"||s.type=="fit-x")&&q(rL("width")),r=="container"&&!(s.type=="fit"||s.type=="fit-y")&&q(rL("height")),!Qr(s,{type:"pad"}))return s}function Ode(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function Sde(e){return e?`fit-${M0(e)}`:"fit"}const Ade=["background","padding"];function aP(e,t){const n={};for(const i of Ade)e&&e[i]!==void 0&&(n[i]=Ai(e[i]));return t&&(n.params=e.params),n}class ta{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ta(be(this.explicit),be(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return At(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of U(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function po(e){return{explicit:!0,value:e}}function Ci(e){return{explicit:!1,value:e}}function sP(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:l1(t,n,i,r)}}function l1(e,t,n,i){return e.explicit&&t.explicit&&q(ule(n,i,e.value,t.value)),e}function ds(e,t,n,i,r=l1){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Qr(e.value,t.value)?e:r(e,t,n,i)}class kde extends ta{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function xc(e){return"url"in e}function xh(e){return"values"in e}function uP(e){return"name"in e&&!xc(e)&&!xh(e)&&!hs(e)}function hs(e){return e&&(lP(e)||cP(e)||RO(e))}function lP(e){return"sequence"in e}function cP(e){return"sphere"in e}function RO(e){return"graticule"in e}var at;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(at||(at={}));var Cde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function wc(e,t=!0,n=dn){if(P(e)){const i=e.map(r=>wc(r,t,n));return t?`[${i.join(", ")}]`:i}else if(bu(e))return n(t?dh(e):Nle(e));return t?n(rt(e)):e}function Tde(e,t){var n;for(const i of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const r=i.name;let o=`${r}${ms}, ${i.resolve==="global"?"true":`{unit: ${Oc(e)}}`}`;for(const a of g1)!a.defined(i)||(a.signals&&(t=a.signals(e,i,t)),a.modifyExpr&&(o=a.modifyExpr(e,i,o)));t.push({name:r+uhe,on:[{events:{signal:i.name+ms},update:`modify(${H(i.name+Su)}, ${o})`}]})}return jO(t)}function Fde(e,t){if(e.component.selection&&U(e.component.selection).length){const n=H(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ka("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return jO(t)}function Dde(e,t){var n;let i=!1;for(const r of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=r.name,a=H(o+Su);if(t.filter(u=>u.name===o).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${NP}(${a}, ${H(u)}${l}`})}i=!0;for(const u of g1)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return i&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),jO(t)}function Mde(e,t){var n;const i=[...t];for(const r of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const o={name:r.name+Su};if(r.init){const s=r.project.items.map(u=>Cde(u,["signals"]));o.values=r.init.map(u=>({unit:Oc(e,{escape:!1}),fields:s,values:wc(u,!1)}))}i.filter(s=>s.name===r.name+Su).length||i.push(o)}return i}function fP(e,t){var n;for(const i of En((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const r of g1)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function Nde(e,t){for(const n of e.children)kt(n)&&(t=fP(n,t));return t}function Rde(e,t,n,i){const r=IP(e,t.param,t);return{signal:ki(n.get("type"))&&P(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function jO(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class et{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(Rue);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qn extends et{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${F$()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var dP=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class mo extends et{constructor(t,n){super(t);this.formula=n}clone(){return new mo(null,be(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o)=>{const{field:a,timeUnit:s}=o;if(s){const u=V(o,{forAs:!0});r[De({as:u,field:a,timeUnit:s})]={as:u,field:a,timeUnit:s}}return r},{});return Ze(i)?null:new mo(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,o=dP(i,["timeUnit"]),a=Bn(r),s=Object.assign(Object.assign({},o),{timeUnit:a});return new mo(t,{[De(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Qa(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(En(this.formula).map(t=>t.as))}dependentFields(){return new Set(En(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${De(this.formula)}`}assemble(){const t=[];for(const n of En(this.formula)){const{field:i,as:r,timeUnit:o}=n,a=Bn(o),{unit:s,utc:u}=a,l=dP(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:zi(i),type:"timeunit"},s?{units:$E(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}var jde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const wh="_tuple_fields";class $de{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const Lde={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,o=(i=t.project)!==null&&i!==void 0?i:t.project=new $de,a={},s={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let v=ht(`${r}_${y}`);for(let x=1;u.has(v);x++)v=ht(`${r}_${y}_${x}`);return u.add(v),{[m]:v}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?J(n.value):null;let{fields:h,encodings:g}=Q(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!Q(p))for(const m of U(p))Xse(m)?(g||(g=[])).push(m):c==="interval"?(q(Fue),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){q(_ue(p,m.aggregate));continue}else if(!y){q(aL(p));continue}if(m.timeUnit){y=e.vgField(p);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[De(v)]=v}if(!a[y]){let v="E";if(c==="interval"){const b=e.getScaleComponent(p).get("type");ki(b)&&(v="R")}else m.bin&&(v="R-RE");const x={field:y,channel:p,type:v};x.signals=Object.assign(Object.assign({},l(x,"data")),l(x,"visual")),o.items.push(a[y]=x),o.hasField[y]=o.hasChannel[p]=a[y]}}else q(aL(p))}for(const p of h!=null?h:[]){if(o.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[p]=m}d&&(t.init=d.map(p=>o.items.map(m=>Q(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),Ze(s)||(o.timeUnit=new mo(null,s))},signals:(e,t,n)=>{const i=t.name+wh;return n.filter(o=>o.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(o=>{const a=jde(o,["signals","hasLegend"]);return a.field=zi(a.field),a})})}},gs={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!os(r))continue;const o=e.getScaleComponent(r),a=o?o.get("type"):void 0;if(!o||!ki(a)){q(Sue);continue}o.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(a=>n.filter(s=>s.name===a.signals.data).length===0);if(!e.parent||LO(e)||i.length===0)return n;const r=n.filter(a=>a.name===t.name)[0];let o=r.update;if(o.indexOf(NP)>=0)r.update=`{${i.map(a=>`${H(zi(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of i){const s=`${H(zi(a.field))}: ${a.signals.data}`;o.includes(s)||(o=`${o.substring(0,o.length-1)}, ${s}}`)}r.update=o}return n.concat(i.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!LO(e))for(const i of t.scales){const r=n.filter(o=>o.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function $O(e,t){return`domain(${H(e.scaleName(t))})`}function LO(e){var t;return e.parent&&Dc(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:LO(e.parent.parent))}var Ide=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const _c="_brush",IO="_scale_trigger",Pde={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+wh,o=gs.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${H(i+_c)}`;hP(t,(f,d)=>{var h,g;const p=J((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==pt&&d!==Wt){q("Interval selections only support x and y encoding channels.");return}const h=a?a[f]:null,g=zde(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=H(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),x=ki(v)?"+":"";n.push(...g),s.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${x}invert(${y}, ${m})[0] === ${x}${p}[0] && ${x}invert(${y}, ${m})[1] === ${x}${p}[1]))`})}),!o&&u.length&&n.push({name:i+IO,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+IO} : {}`}]});const l=`unit: ${Oc(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+ms},a?{init:`{${l}: ${wc(a)}}`}:{}),s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:o}=t.project.hasChannel,a=r==null?void 0:r.signals.visual,s=o==null?void 0:o.signals.visual,u=`data(${H(t.name+Su)})`;if(gs.defined(t)||!r&&!o)return n;const l={x:r!==void 0?{signal:`${a}[0]`}:{value:0},y:o!==void 0?{signal:`${s}[0]`}:{value:0},x2:r!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of U(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Oc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=Ide(c,["fill","fillOpacity","cursor"]),p=U(g).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${a}[0] !== ${a}[1]`,o!==void 0&&`${s}[0] !== ${s}[1]`].filter(v=>v).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${i+_c}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:i+_c,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function zde(e,t,n,i){const r=n.channel,o=n.signals.visual,a=n.signals.data,s=gs.defined(t),u=H(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(r===pt?"width":"height").signal,h=`${r}(unit)`,g=hP(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+IO},update:ki(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},i?{init:wc(i,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:a},i?{init:wc(i)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function hP(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(q(`${i} is not an ordered event stream for interval selections.`),n),[])}const Bde={defined:e=>e.type==="point",signals:(e,t,n)=>{var i;const r=t.name,o=r+wh,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${s}[${H(e.vgField(h.channel,{}))}], ${s}[${H(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${H(h.field)}]`}).join(", "),l=`unit: ${Oc(e)}, fields: ${o}, values`,c=t.events,f=En((i=e.component.selection)!==null&&i!==void 0?i:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+_c):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d=`datum && item().mark.marktype !== 'group'${f?` && ${f}`:""}`;return n.concat([{name:r+ms,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Ec(e,t,n,i){const r=V0(t)&&t.condition,o=i(t);if(r){const s=J(r).map(u=>{const l=i(u);if(Fce(u)){const{param:c,empty:f}=u,d=LP(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=p1(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...s,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function PO(e,t="text"){const n=e.encoding[t];return Ec(e,n,t,i=>c1(i,e.config))}function c1(e,t,n="datum"){if(e){if(xr(e))return lt(e.value);if(ye(e)){const{format:i,formatType:r}=K0(e);return tO({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function gP(e,t={}){const{encoding:n,markDef:i,config:r,stack:o}=e,a=n.tooltip;if(P(a))return{tooltip:mP({tooltip:a},o,r,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Ec(e,a,"tooltip",u=>{const l=c1(u,r,s);if(l)return l;if(u===null)return;let c=He("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),K(c))return{value:c};if(Q(c))return oe(c)?c:c.content==="encoding"?mP(n,o,r,t):{signal:s}})}}function pP(e,t,n,{reactiveGeom:i}={}){const r={},o=i?"datum.datum":"datum",a=[];function s(l,c){const f=mu(c),d=qi(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||cO(d,n),g=J(h).join(", ");let p;if(rn(c)){const m=c==="x"?"x2":"y2",y=ho(e[m]);if(zn(d.bin)&&y){const v=V(d,{expr:o}),x=V(y,{expr:o}),{format:b,formatType:_}=K0(d);p=W0(v,x,b,_,n),r[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:x}=K0(d);p=tO({fieldOrDatumDef:d,format:v,formatType:x,expr:o,config:n,normalizeStack:!0}).signal}}p!=null||(p=c1(d,n,o).signal),a.push({channel:c,key:g,value:p})}gO(e,(l,c)=>{G(l)?s(l,c):Y0(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of a)!r[l]&&!u[c]&&(u[c]=f);return u}function mP(e,t,n,{reactiveGeom:i}={}){const r=pP(e,t,n,{reactiveGeom:i}),o=Qa(r).map(([a,s])=>`"${a}": ${s}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Ude(e){const{markDef:t,config:n}=e,i=He("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),qde(e)),Wde(e))}function qde(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=He("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in vue?{}:{ariaRoleDescription:{value:t}}}function Wde(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return Ec(e,o,"description",u=>c1(u,e.config));const a=He("description",n,i);if(a!=null)return{description:lt(a)};if(i.aria===!1)return{};const s=pP(t,r,i);if(!Ze(s))return{description:{signal:Qa(s).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Gt(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u!=null||(u=He(e,i,o,{vgChannel:a,ignoreVgConfig:!0})),u!==void 0&&(s=lt(u)));const l=r[e];return Ec(t,l,a!=null?a:e,c=>eO({channel:e,channelDef:c,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function yP(e,t={filled:void 0}){var n,i,r,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=(n=t.filled)!==null&&n!==void 0?n:He("filled",a,u),f=Me(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(r=(i=He(c===!0?"color":void 0,a,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,h=(o=He(c===!1?"color":void 0,a,u,{vgChannel:"stroke"}))!==null&&o!==void 0?o:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:lt(d)}:{}),h?{stroke:lt(h)}:{});return a.color&&(c?a.fill:a.stroke)&&q(dL("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},p),Gt("color",e,{vgChannel:g,defaultValue:c?d:h})),Gt("fill",e,{defaultValue:s.fill?d:void 0})),Gt("stroke",e,{defaultValue:s.stroke?h:void 0}))}function Hde(e){const{encoding:t,mark:n}=e,i=t.order;return!ls(n)&&xr(i)?Ec(e,i,"zindex",r=>lt(r.value)):{}}function _h({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const o=`${e}Offset`,a=t[o],s=n[o];if((o==="xOffset"||o==="yOffset")&&s){const l=eO({channel:o,channelDef:s,markDef:t,config:i==null?void 0:i.config,scaleName:i.scaleName(o),scale:i.getScaleComponent(o),stack:null,defaultRef:lt(a),bandPosition:r});return{offsetType:"encoding",offset:l}}const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function On(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:o,config:a,stack:s}=t,u=r[e],l=r[Xo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=_h({channel:e,markDef:o,encoding:r,model:t,bandPosition:.5}),g=zO({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),p=!u&&rn(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:Gde({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:g,bandPosition:h==="encoding"?0:void 0});return p?{[i||e]:p}:void 0}function Gde(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:o,markDef:a}=e;if(ye(n)&&r&&t===r.fieldChannel){if(G(n)){let s=n.bandPosition;if(s===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(s=.5),s!==void 0)return q0({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:s,offset:o})}return wu(n,i,{suffix:"end"},{offset:o})}return QE(e)}function zO({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:a}=e;return()=>{const s=mu(n),u=rs(n),l=He(n,o,a,{vgChannel:u});if(l!==void 0)return gh(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!Me([ui.LOG,ui.TIME,ui.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[ai(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const Vde={left:"x",center:"xc",right:"x2"},Yde={top:"y",middle:"yc",bottom:"y2"};function vP(e,t,n,i="middle"){if(e==="radius"||e==="theta")return rs(e);const r=e==="x"?"align":"baseline",o=He(r,t,n);let a;return oe(o)?(q(Jue(r)),a=void 0):a=o,e==="x"?Vde[a||(i==="top"?"left":"center")]:Yde[a||i]}function f1(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?bP(e,t,{defaultPos:n,defaultPos2:i}):On(e,t,{defaultPos:n})}function bP(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,a=Xo(e),s=ai(e),u=Xde(t,i,a),l=u[s]?vP(e,r,o):rs(e);return Object.assign(Object.assign({},On(e,t,{defaultPos:n,vgChannel:l})),u)}function Xde(e,t,n){const{encoding:i,mark:r,markDef:o,stack:a,config:s}=e,u=mu(n),l=ai(n),c=rs(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:g}=n in i||n in o?_h({channel:n,markDef:o,encoding:i,model:e}):_h({channel:u,markDef:o,encoding:i,model:e});if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=ai(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=Kde({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:d1(n,o)||d1(n,{[n]:j0(n,o,s.style),[l]:j0(l,o,s.style)})||d1(n,s[r])||d1(n,s.mark)||{[c]:zO({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Kde({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return ye(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?wu(t,o,{suffix:"start"},{offset:u}):QE({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:i,config:r,offset:u,defaultRef:l})}function d1(e,t){const n=ai(e),i=rs(e);if(t[i]!==void 0)return{[i]:gh(e,t[i])};if(t[e]!==void 0)return{[i]:gh(e,t[e])};if(t[n]){const r=t[n];if(pc(r))q(Wue(n));else return{[n]:gh(e,r)}}}function ps(e,t){var n,i;const{config:r,encoding:o,markDef:a}=e,s=a.type,u=Xo(t),l=ai(t),c=o[t],f=o[u],d=e.getScaleComponent(t),h=d?d.get("type"):void 0,g=a.orient,p=(i=(n=o[l])!==null&&n!==void 0?n:o.size)!==null&&i!==void 0?i:He("size",a,r,{vgChannel:l}),m=s==="bar"&&(t==="x"?g==="vertical":g==="horizontal");return G(c)&&(ot(c.bin)||zn(c.bin)||c.timeUnit&&!f)&&!(p&&!pc(p))&&!Ht(h)?Zde({fieldDef:c,fieldDef2:f,channel:t,model:e}):(ye(c)&&Ht(h)||m)&&!f?Qde(c,t,e):bP(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Jde(e,t,n,i,r){if(pc(r))if(n){const a=n.get("type");if(a==="band")return{scale:t,band:r.band};r.band!==1&&(q(tle(a)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(oe(r))return r;if(r)return{value:r}}if(n){const a=n.get("range");if(us(a)&&Je(a.step))return{value:a.step-2}}return{value:a1(i.view,e)-2}}function Qde(e,t,n){const{markDef:i,encoding:r,config:o,stack:a}=n,s=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=ai(t),f=Xo(t),d=Jse(t),h=n.scaleName(d),g=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let p;(r.size||i.size)&&(g?p=Gt("size",n,{vgChannel:c,defaultRef:lt(i.size)}):q(ole(i.type)));const m=ZL({channel:t,fieldDef:e,markDef:i,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:g});p=p||{[c]:Jde(c,h||u,l,o,m)};const y=(l==null?void 0:l.get("type"))!=="band"||!("band"in p[c])?"middle":"top",v=vP(t,i,o,y),x=v==="xc"||v==="yc",{offset:b,offsetType:_}=_h({channel:t,markDef:i,encoding:r,model:n,bandPosition:x?.5:0}),E=QE({channel:t,channelDef:e,markDef:i,config:o,scaleName:u,scale:l,stack:a,offset:b,defaultRef:zO({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:x?_==="encoding"?0:.5:oe(m)?{signal:`(1-${m})/2`}:pc(m)?(1-m.band)/2:0});if(c)return Object.assign({[v]:E},p);{const w=rs(f),O=p[c],S=b?Object.assign(Object.assign({},O),{offset:b}):O;return{[v]:E,[w]:P(E)?[E[0],Object.assign(Object.assign({},E[1]),{offset:S})]:Object.assign(Object.assign({},E),{offset:S})}}}function Eh(e,t,n,i,r){if(R$(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(oe(n)||oe(r)||oe(i)){const a=Qo(n),s=Qo(r),u=Qo(i),l=u?`${u} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=s?`(${s} + ${o})`:o;return{signal:l+c+f}}else return r=r||0,i+(n?-r-o:+r+o)}function Zde({fieldDef:e,fieldDef2:t,channel:n,model:i}){var r,o,a;const{config:s,markDef:u,encoding:l}=i,c=i.getScaleComponent(n),f=i.scaleName(n),d=c?c.get("type"):void 0,h=c.get("reverse"),g=ZL({channel:n,fieldDef:e,markDef:u,config:s,scaleType:d}),p=(r=i.component.axes[n])===null||r===void 0?void 0:r[0],m=(o=p==null?void 0:p.get("translate"))!==null&&o!==void 0?o:.5,y=rn(n)&&(a=He("binSpacing",u,s))!==null&&a!==void 0?a:0,v=Xo(n),x=rs(n),b=rs(v),{offset:_}=_h({channel:n,markDef:u,encoding:l,model:i,bandPosition:0}),E=oe(g)?{signal:`(1-${g.signal})/2`}:pc(g)?(1-g.band)/2:.5;if(ot(e.bin)||e.timeUnit)return{[b]:xP({fieldDef:e,scaleName:f,bandPosition:E,offset:Eh(v,y,h,m,_)}),[x]:xP({fieldDef:e,scaleName:f,bandPosition:oe(E)?{signal:`1-${E.signal}`}:1-E,offset:Eh(n,y,h,m,_)})};if(zn(e.bin)){const w=wu(e,f,{},{offset:Eh(v,y,h,m,_)});if(G(t))return{[b]:w,[x]:wu(t,f,{},{offset:Eh(n,y,h,m,_)})};if(yu(e.bin)&&e.bin.step)return{[b]:w,[x]:{signal:`scale("${f}", ${V(e,{expr:"datum"})} + ${e.bin.step})`,offset:Eh(n,y,h,m,_)}}}q(yL(v))}function xP({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return q0({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}const ehe=new Set(["aria","width","height"]);function Wi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?yP(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},the(e.markDef,t)),wP(e,"fill",n)),wP(e,"stroke",i)),Gt("opacity",e)),Gt("fillOpacity",e)),Gt("strokeOpacity",e)),Gt("strokeWidth",e)),Gt("strokeDash",e)),Hde(e)),gP(e)),PO(e,"href")),Ude(e))}function wP(e,t,n){const{config:i,mark:r,markDef:o}=e;if(He("invalid",o,i)==="hide"&&n&&!ls(r)){const s=nhe(e,{invalid:!0,channels:N0});if(s)return{[t]:[{test:s,value:null},...J(n)]}}return n?{[t]:n}:{}}function the(e,t){return yue.reduce((n,i)=>(!ehe.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=lt(e[i])),n),{})}function nhe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&ki(u)&&(o[l]=!0)}return o},{}),r=U(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>ZE(a,t)).join(` ${o} `)}}function BO(e){const{config:t,markDef:n}=e;if(He("invalid",n,t)){const r=ihe(e,{channels:ao});if(r)return{defined:{signal:r}}}return{}}function ihe(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&ki(u)&&(o[l]=!0)}return o},{}),r=U(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>ZE(a,t)).join(` ${o} `)}}function _P(e,t){if(t!==void 0)return{[e]:lt(t)}}const UO="voronoi",EP={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(UO)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,o=e.mark;if(ls(o))return q(Eue(o)),n;const a={name:e.getName(UO),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},gP(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(UO)>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}},OP={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!wO(e.bind),parse:(e,t,n)=>RP(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,o=t.bind,a=t.init&&t.init[0],s=EP.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const d=ht(`${i}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},a?{init:wc(a[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${H(u.field)}] : null`}]:[],bind:(f=(c=o[u.field])!==null&&c!==void 0?c:o[u.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(l=>l.name===i+ms)[0],a=i+wh,s=r.items.map(l=>ht(`${i}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},h1="_toggle",SP={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+h1,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ms,i=t.name+h1;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Oc(e)}}, `)+`${i} ? ${n} : null`}},rhe={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=K(t.clear)?Ka(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(OP.defined(t))for(const i of t.project.items){const r=n.findIndex(o=>o.name===ht(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,o){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const r of t.project.items){const o=n.findIndex(a=>a.name===r.signals.visual);if(i(o,"[0, 0]"),o===-1){const a=n.findIndex(s=>s.name===r.signals.data);i(a,"null")}}else{let r=n.findIndex(o=>o.name===t.name+ms);i(r,"null"),SP.defined(t)&&(r=n.findIndex(o=>o.name===t.name+h1),i(r,"false"))}return n}},AP={defined:e=>{const t=e.resolve==="global"&&e.bind&&wO(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==bh;return t&&!n&&q(Aue),t&&n},parse:(e,t,n)=>{var i;const r=be(n);if(r.select=K(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),RP(t,r),Q(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=J((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.includes(s)||u.filter.push(s)}const o=_O(t.bind)?t.bind.legend:"click",a=K(o)?Ka(o,"view"):J(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=_O(t.bind)&&t.bind.legend,o=a=>s=>{const u=be(s);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const s=`${ht(a.field)}_legend`,u=`${i}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(o(`${s}_symbols`)).concat(r.merge.map(o(`${s}_labels`))).concat(r.merge.map(o(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(d=>d.name===i+ms),a=i+wh,s=r.items.filter(d=>d.hasLegend).map(d=>ht(`${i}_${ht(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===i+h1),f=_O(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function ohe(e,t,n){var i,r,o,a;const s=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;for(const u of En((r=e.component.selection)!==null&&r!==void 0?r:{})){const l=(o=u.project.hasField[s])!==null&&o!==void 0?o:u.project.hasChannel[t];if(l&&AP.defined(u)){const c=(a=n.get("selections"))!==null&&a!==void 0?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const kP="_translate_anchor",CP="_translate_delta",ahe={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=gs.defined(t),o=i+kP,{x:a,y:s}=t.project.hasChannel;let u=Ka(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+_c,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${r?$O(e,pt):`slice(${a.signals.visual})`}`:"")+(s!==void 0?`, extent_y: ${r?$O(e,Wt):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:i+CP,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),a!==void 0&&TP(e,t,a,"width",n),s!==void 0&&TP(e,t,s,"height",n),n}};function TP(e,t,n,i,r){var o,a;const s=t.name,u=s+kP,l=s+CP,c=n.channel,f=gs.defined(t),d=r.filter(w=>w.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===pt?m?"":"-":m?"-":"":"",v=`${u}.extent_${c}`,x=`${y}${l}.${c} / ${f?`${h}`:`span(${v})`}`,b=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",_=f?p==="pow"?`, ${(o=g.get("exponent"))!==null&&o!==void 0?o:1}`:p==="symlog"?`, ${(a=g.get("constant"))!==null&&a!==void 0?a:1}`:"":"",E=`${b}(${v}, ${x}${_})`;d.on.push({events:{signal:l},update:f?E:`clampRange(${E}, 0, ${h})`})}const FP="_zoom_anchor",DP="_zoom_delta",she={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=gs.defined(t),o=i+DP,{x:a,y:s}=t.project.hasChannel,u=H(e.scaleName(pt)),l=H(e.scaleName(Wt));let c=Ka(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+_c,f))),n.push({name:i+FP,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&MP(e,t,a,"width",n),s!==void 0&&MP(e,t,s,"height",n),n}};function MP(e,t,n,i,r){var o,a;const s=t.name,u=n.channel,l=gs.defined(t),c=r.filter(b=>b.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?$O(e,u):c.name,p=s+DP,m=`${s}${FP}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",v=l?h==="pow"?`, ${(o=d.get("exponent"))!==null&&o!==void 0?o:1}`:h==="symlog"?`, ${(a=d.get("constant"))!==null&&a!==void 0?a:1}`:"":"",x=`${y}(${g}, ${m}, ${p}${v})`;c.on.push({events:{signal:p},update:l?x:`clampRange(${x}, 0, ${f})`})}const Su="_store",ms="_tuple",uhe="_modify",NP="vlSelectionResolve",g1=[Bde,Pde,Lde,SP,OP,gs,AP,rhe,ahe,she,EP];function lhe(e){let t=e.parent;for(;t&&!Er(t);)t=t.parent;return t}function Oc(e,{escape:t}={escape:!0}){let n=t?H(e.name):e.name;const i=lhe(e);if(i){const{facet:r}=i;for(const o of Ui)r[o]&&(n+=` + '__facet_${o}_' + (facet[${H(i.vgField(o))}])`)}return n}function qO(e){var t;return En((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===bh),!1)}function RP(e,t){(K(t.select)||!t.select.on)&&delete e.events,(K(t.select)||!t.select.clear)&&delete e.clear,(K(t.select)||!t.select.toggle)&&delete e.toggle}function WO(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...WO(e.object)),t.push(...WO(e.property))),t)}function jP(e){return e.object.type==="MemberExpression"?jP(e.object):e.object.name==="datum"}function $P(e){const t=p_(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&jP(i)&&n.add(WO(i).slice(1).join("."))}),n}class Sc extends et{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=p1(this.model,this.filter,this),this._dependentFields=$P(this.expr)}clone(){return new Sc(null,this.model,be(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function che(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const o of t){const a=ht(o.name),s=o.select,u=K(s)?s:s.type,l=Q(s)?be(s):{type:u},c=r[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=i[a]=Object.assign(Object.assign({},l),{name:a,type:u,init:o.value,bind:o.bind,events:K(l.on)?Ka(l.on,"scope"):J(be(l.on))});for(const d of g1)d.defined(f)&&d.parse&&d.parse(e,f,o)}return i}function LP(e,t,n,i="datum"){const r=K(t)?t:t.param,o=ht(r),a=H(o+Su);let s;try{s=e.getSelectionComponent(o,r)}catch{return`!!${o}`}if(s.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=s.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${a}, ${i}${s.resolve==="global"?")":`, ${H(s.resolve)})`}`,l=`length(data(${a}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function IP(e,t,n){const i=ht(t),r=n.encoding;let o=n.field,a;try{a=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!o)o=a.project.items[0].field,a.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${H(o)}.`);else if(r&&!o){const s=a.project.items.filter(u=>u.channel===r);!s.length||s.length>1?(o=a.project.items[0].field,q((s.length?"Multiple ":"No ")+`matching ${H(r)} encoding found for selection ${H(n.param)}. Using "field": ${H(o)}.`)):o=s[0].field}return`${a.name}[${H(zi(o))}]`}function fhe(e,t){var n;for(const[i,r]of Qa((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=e.getName(`lookup_${i}`);e.component.data.outputNodes[o]=r.materialized=new qn(new Sc(t,e,{param:i}),o,at.Lookup,e.component.data.outputNodeRefCounts)}}function p1(e,t,n){return rh(t,i=>K(i)?i:Ble(i)?LP(e,i,n):SL(i))}var m1=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function dhe(e,t){if(!!e)return P(e)&&!ss(e)?e.map(n=>cO(n,t)).join(", "):e}function HO(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function Oh(e,t,n,i={header:!1}){var r,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=a,h=m1(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const g in h){const p=Wce[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(vh(m)){const{condition:y}=m,v=m1(m,["condition"]),x=J(y),b=uI[g];if(b){const{vgProp:_,part:E}=b,w=[...x.map(O=>{const{test:S}=O,k=m1(O,["test"]);return Object.assign({test:p1(null,S)},k)}),v];HO(h,E,_,w),delete h[g]}else if(b===null){const _={signal:x.map(E=>{const{test:w}=E,O=m1(E,["test"]);return`${p1(null,w)} ? ${K$(O)} : `}).join("")+K$(v)};h[g]=_}}else if(oe(m)){const y=uI[g];if(y){const{vgProp:v,part:x}=y;HO(h,x,v,m),delete h[g]}}Me(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),Ze(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:At(d,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((o=(r=h.encode)===null||r===void 0?void 0:r.labels)===null||o===void 0?void 0:o.update)&&oe(h.encode.labels.update.text)&&(p=hu(c,"datum.label",h.encode.labels.update.text.signal)),HO(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of lI)e.hasAxisPart(p)||delete h.encode[p];Ze(h.encode)&&delete h.encode}const g=dhe(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:At(d,0)})}}}function PP(e){const{axes:t}=e.component,n=[];for(const i of ao)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const o=i==="x"?"height":"width",a=e.getSizeSignalRef(o).signal;o!==a&&n.push({name:o,update:a})}}return n}function hhe(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>Oh(r,"grid",t)),...i.map(r=>Oh(r,"grid",t)),...n.map(r=>Oh(r,"main",t)),...i.map(r=>Oh(r,"main",t))].filter(r=>r)}function zP(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const o=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...U(a),...U(s)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${o}" ? ${Qo(a[c])} : ${Qo(s[c])}`};return l}return t[r]})])}function ghe(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:FL(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",a=oe(n)?"axisOrient":`axis${oh(n)}`,s=[...r,...r.map(l=>o+l.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:zP(s,i,e,n),vgAxisConfig:zP(u,i,e,n),axisConfigStyle:phe([...u,...s],i)}}function phe(e,t){var n;const i=[{}];for(const r of e){let o=(n=t[r])===null||n===void 0?void 0:n.style;if(o){o=J(o);for(const a of o)i.push(t.style[a])}}return Object.assign.apply(null,i)}function GO(e,t,n,i={}){var r;const o=Q$(e,n,t);if(o!==void 0)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[a])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:a,configValue:i[a][e]};return{}}const BP={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return qL(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return WL(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!==null&&i!==void 0?i:mhe(n,e)},gridScale:({model:e,channel:t})=>yhe(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||qP(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||UP(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:bhe(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:xhe(t.type,n,G(t)&&!!t.timeUnit,G(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var o;const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:_he({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=WP(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),o=n==="x"?"x2":"y2",a=t.fieldDef(o);return eL(r?[JL(r)]:[],G(a)?[JL(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Ehe(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:Ohe(n,t)}};function mhe(e,t){return!Ht(e)&&G(t)&&!ot(t==null?void 0:t.bin)&&!zn(t==null?void 0:t.bin)}function yhe(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function vhe(e,t,n,i,r){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return oe(o)?o:ah(o);{const{configValue:a}=GO("labelAngle",i,t==null?void 0:t.style,r);return a!==void 0?ah(a):n===pt&&Me([GE,HE],e.type)&&!(G(e)&&e.timeUnit)?270:void 0}}function VO(e){return`(((${e.signal} % 360) + 360) % 360)`}function UP(e,t,n,i){if(e!==void 0)if(n==="x"){if(oe(e)){const r=VO(e),o=oe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(oe(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(oe(e)){const r=VO(e),o=oe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(oe(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function qP(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,o=i?"bottom":"left";if(oe(e)){const a=VO(e),s=oe(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${r?`(${a} + 90)`:a} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${a} && ${a} < ${180+r}) === ${s} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(oe(t)){const a=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${a} "${o}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===o)?"left":"right"}function bhe(e,t){if(t==="x"&&Me(["quantitative","temporal"],e))return!0}function xhe(e,t,n,i){if(n&&!Q(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function whe(e){return e==="x"?"bottom":"left"}function _he({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Ht(t)&&t!=="log"){if(G(e)){if(ot(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&Me(["month","hours","day","quarter"],(r=Bn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function WP(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,a=r?r.title:void 0;if(o&&a)return tL(o,a);if(o)return o;if(a)return a;if(o!==void 0)return o;if(a!==void 0)return a}function Ehe(e,t){const n=e.values;if(P(n))return sI(t,n);if(oe(n))return n}function Ohe(e,t){return e==="rect"&&X0(t)?1:0}class Ac extends et{constructor(t,n){super(t);this.transform=n,this._dependentFields=$P(this.transform.calculate)}clone(){return new Ac(null,be(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!Eu(i)&&KL(i.sort)){const{field:o,timeUnit:a}=i,s=i.sort,u=s.map((l,c)=>`${SL({field:o,timeUnit:a,equal:l})} ? ${c} : `).join("")+s.length;t=new Ac(t,{calculate:u,as:kc(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${De(this.transform)}`}}function kc(e,t,n){return V(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function y1(e,t){return Me(["top","bottom"],t)?"column":Me(["left","right"],t)||e==="row"?"row":"column"}function Cc(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return At((t||{})[e],r[e],n.header[e])}function v1(e,t,n,i){const r={};for(const o of e){const a=Cc(o,t||{},n,i);a!==void 0&&(r[o]=a)}return r}const YO=["row","column"],XO=["header","footer"];function She(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=v1(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=y1(t,s),l=ah(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),GP(l,u)),HP(u,l,o)),VP(i,r,t,hfe,TI))}}function HP(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=qP(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function GP(e,t){const n=UP(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function Ahe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of XO)if(n[r])for(const o of n[r]){const a=Che(e,t,r,n,o);a!=null&&i.push(a)}return i}function khe(e,t){var n;const{sort:i}=e;return lo(i)?{field:V(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:P(i)?{field:kc(e,t,{expr:"datum"}),order:"ascending"}:{field:V(e,{expr:"datum"}),order:i!=null?i:"ascending"}}function KO(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=v1(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=tO({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=y1(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?hu(hu(u,"datum.label",l),"datum.value",V(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),GP(o,c)),HP(c,o,a)),VP(n,e,t,gfe,FI))}function Che(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:a}=i,s=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:f}=v1(["labelOrient"],a.header,s,t);(t==="row"&&!Me(["top","bottom"],f)||t==="column"&&!Me(["left","right"],f))&&(o=KO(a,t,s))}const u=Er(e)&&!ph(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:khe(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const The={column:{start:0,end:1},row:{start:1,end:0}};function Fhe(e,t){return The[t][e]}function Dhe(e,t){const n={};for(const i of Ui){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:o,titleOrient:a}=v1(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),s=y1(i,a),u=Fhe(o,s);u!==void 0&&(n[s]=u)}}return Ze(n)?void 0:n}function VP(e,t,n,i,r){const o={};for(const a of i){if(!r[a])continue;const s=Cc(a,t==null?void 0:t.header,e,n);s!==void 0&&(o[r[a]]=s)}return o}function JO(e){return[...b1(e,"width"),...b1(e,"height"),...b1(e,"childWidth"),...b1(e,"childHeight")]}function b1(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const o=e.getScaleComponent(n);if(o){const a=o.get("type"),s=o.get("range");if(Ht(a)&&us(s)){const u=e.scaleName(n);return Er(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[YP(u,s)]:[YP(u,s),{name:r,update:XP(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const o=r.endsWith("width"),a=o?"containerSize()[0]":"containerSize()[1]",s=AO(e.config.view,o?"width":"height"),u=`isFinite(${a}) ? ${a} : ${s}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function YP(e,t){const n=`${e}_step`;return oe(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function XP(e,t,n){const i=t.get("type"),r=t.get("padding"),o=At(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a=i==="band"?a!==void 0?a:r:1,`bandspace(${n}, ${Qo(a)}, ${Qo(o)}) * ${e}_step`}function KP(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function JP(e,t){return U(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Ec(t,r,i,o=>lt(o.value)))},{})}function QP(e,t){if(Er(t))return e==="theta"?"independent":"shared";if(Dc(t))return"shared";if(hS(t))return rn(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function QO(e,t){const n=e.scale[t],i=rn(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&q(cle(t)),"independent"):e[i][t]||"shared"}const Mhe=Object.assign(Object.assign({},yfe),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),ZP=U(Mhe);class Nhe extends ta{}const e6={symbols:Rhe,gradient:jhe,labels:$he,entries:Lhe};function Rhe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){var a,s,u,l,c,f,d,h;if(o!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,v=g.filled&&y!=="trail";let x=Object.assign(Object.assign({},xue({},n,hce)),yP(n,{filled:v}));const b=(a=r.get("symbolOpacity"))!==null&&a!==void 0?a:m.legend.symbolOpacity,_=(s=r.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor,E=(u=r.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,w=b===void 0?(l=t6(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(x.fill){if(i==="fill"||v&&i===ri)delete x.fill;else if(x.fill.field)_?delete x.fill:(x.fill=lt((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),x.fillOpacity=lt(w!=null?w:1));else if(P(x.fill)){const O=(h=(d=ZO((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:v&&g.color;O&&(x.fill=lt(O))}}if(x.stroke){if(i==="stroke"||!v&&i===ri)delete x.stroke;else if(x.stroke.field||E)delete x.stroke;else if(P(x.stroke)){const O=At(ZO(p.stroke||p.color),g.stroke,v?g.color:void 0);O&&(x.stroke={value:O})}}if(i!==Yo){const O=G(t)&&i6(n,r,t);O?x.opacity=[Object.assign({test:O},lt(w!=null?w:1)),lt(m.legend.unselectedOpacity)]:w&&(x.opacity=lt(w))}return x=Object.assign(Object.assign({},x),e),Ze(x)?void 0:x}function jhe(e,{model:t,legendType:n,legendCmpt:i}){var r;if(n!=="gradient")return;const{config:o,markDef:a,encoding:s}=t;let u={};const c=((r=i.get("gradientOpacity"))!==null&&r!==void 0?r:o.legend.gradientOpacity)===void 0?t6(s.opacity)||a.opacity:void 0;return c&&(u.opacity=lt(c)),u=Object.assign(Object.assign({},u),e),Ze(u)?void 0:u}function $he(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},a=n.config,s=G(t)?i6(n,r,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=_u(c)?nO({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Ze(d)?void 0:d}function Lhe(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function t6(e){return n6(e,(t,n)=>Math.max(t,n.value))}function ZO(e){return n6(e,(t,n)=>At(t,n.value))}function n6(e,t){if(Mce(e))return J(e.condition).reduce(t,e.value);if(xr(e))return e.value}function i6(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=H(n.field);return i.map(o=>`(!length(data(${H(ht(o)+Su)})) || (${o}[${r}] && indexof(${o}[${r}], datum.value) >= 0))`).join(" || ")}const r6={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return qL(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return WL(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:Whe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:Hhe(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:Phe(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>mc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(lc(n)&&br(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>Ihe(t,e)};function Ihe(e,t){const n=e.values;if(P(n))return sI(t,n);if(oe(n))return n}function Phe(e,t,n,i){var r;if(t!=="shape"){const o=(r=ZO(n))!==null&&r!==void 0?r:i;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function zhe(e){const{legend:t}=e;return At(t.type,Bhe(e))}function Bhe({channel:e,timeUnit:t,scaleType:n}){if(lc(e)){if(Me(["quarter","month","day"],t))return"symbol";if(br(n))return"gradient"}return"symbol"}function Uhe({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return(o=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:qhe(n,t)}function qhe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function Whe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(br(r))return n==="horizontal"?i==="top"||i==="bottom"?o6(t,"width",a,o):a:o6(t,"height",u,s)}function o6(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function Hhe(e){if(Me(["quantile","threshold","log","symlog"],e))return"greedy"}function a6(e){const t=kt(e)?Ghe(e):Khe(e);return e.component.legends=t,t}function Ghe(e){const{encoding:t}=e,n={};for(const i of[ri,...MI]){const r=$t(t[i]);!r||!e.getScaleComponent(i)||i===oi&&G(r)&&r.type===hc||(n[i]=Xhe(e,i))}return n}function Vhe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Yhe(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function Xhe(e,t){var n,i,r;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new Nhe({},Vhe(e,t));ohe(e,t,c);const f=o!==void 0?!o:l.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=$t(s[t]),g=G(h)?(n=Bn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=o.orient||u.legend.orient||"right",m=zhe({legend:o,channel:t,timeUnit:g,scaleType:d}),y=Uhe({legend:o,legendType:m,orient:p,legendConfig:l}),v={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const w of ZP){if(m==="gradient"&&w.startsWith("symbol")||m==="symbol"&&w.startsWith("gradient"))continue;const O=w in r6?r6[w](v):o[w];if(O!==void 0){const S=Yhe(O,w,o,e.fieldDef(t));(S||u.legend[w]===void 0)&&c.set(w,O,S)}}const x=(i=o==null?void 0:o.encoding)!==null&&i!==void 0?i:{},b=c.get("selections"),_={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const O=JP((r=x[w])!==null&&r!==void 0?r:{},e),S=w in e6?e6[w](O,E):O;S!==void 0&&!Ze(S)&&(_[w]=Object.assign(Object.assign(Object.assign({},(b==null?void 0:b.length)&&G(h)?{name:`${ht(h.field)}_legend_${w}`}:{}),(b==null?void 0:b.length)?{interactive:!!b}:{}),{update:S}))}return Ze(_)||c.set("encode",_,!!(o==null?void 0:o.encoding)),c}function Khe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){a6(i);for(const r of U(i.component.legends))n.legend[r]=QO(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=s6(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of U(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function s6(e,t){var n,i,r,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of ZP){const c=ds(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return Jhe(f,d);case"title":return nL(f,d);case"type":return u=!0,Ci("symbol")}return l1(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0?void 0:i.gradient)&&S0(e.implicit,["encode","gradient"]),((o=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||o===void 0?void 0:o.gradient)&&S0(e.explicit,["encode","gradient"])),e}function Jhe(e,t){return t.value==="circle"?t:e}var Qhe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Zhe(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function u6(e){const t=e.component.legends,n={};for(const r of U(t)){const o=e.getScaleComponent(r),a=rt(o.get("domains"));if(n[a])for(const s of n[a])s6(s,t[r])||n[a].push(t[r]);else n[a]=[t[r].clone()]}return En(n).flat().map(r=>ege(r,e.config)).filter(r=>r!==void 0)}function ege(e,t){var n,i,r;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=Qhe(o,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of MI)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0?void 0:r.update)&&oe(l.encode.labels.update.text)&&(c=hu(s,"datum.label",l.encode.labels.update.text.signal)),Zhe(l,"labels","text",{signal:c})}return l}}function tge(e){return Dc(e)||hS(e)?nge(e):l6(e)}function nge(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),l6(e))}function l6(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,s)=>{const u=oe(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return Me(a,u)||a.push(u),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const ige=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class c6 extends ta{constructor(t,n,i,r){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function f6(e){e.component.projection=kt(e)?rge(e):sge(e)}function rge(e){var t;if(e.hasProjection){const n=si(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?oge(e):void 0,a=new c6(e.projectionName(!0),Object.assign(Object.assign({},(t=si(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),r,o);return a.get("type")||a.set("type","equalEarth",!1),a}}function oge(e){const t=[],{encoding:n}=e;for(const i of[[io,no],[Bi,vr]])($t(n[i[0]])||$t(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(oi)&&e.typedFieldDef(oi).type===hc&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(at.Main)),t}function age(e,t){const n=hE(ige,r=>!!(!re(e.explicit,r)&&!re(t.explicit,r)||re(e.explicit,r)&&re(t.explicit,r)&&Qr(e.get(r),t.get(r))));if(Qr(e.size,t.size)){if(n)return e;if(Qr(e.explicit,{}))return t;if(Qr(t.explicit,{}))return e}return null}function sge(e){if(e.children.length===0)return;let t;for(const i of e.children)f6(i);const n=hE(e.children,i=>{const r=i.component.projection;if(r)if(t){const o=age(t,r);return o&&(t=o),!!o}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new c6(i,t.specifiedProjection,t.size,be(t.data));for(const o of e.children){const a=o.component.projection;a&&(a.isFit&&r.data.push(...o.component.projection.data),o.renameProjection(a.get("name"),i),a.merged=!0)}return r}}var uge=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function lge(e,t,n,i){var r,o;if(yh(t,n)){const a=kt(e)?(o=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&o!==void 0?o:{}:{},s=V(t,{expr:"datum"}),u=V(t,{expr:"datum",binSuffix:"end"});return{formulaAs:V(t,{binSuffix:"range",forAs:!0}),formula:W0(s,u,a.format,a.formatType,i)}}return{}}function d6(e,t){return`${H$(e)}_${t}`}function cge(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function eS(e,t,n){var i;const r=(i=Q0(n,void 0))!==null&&i!==void 0?i:{},o=d6(r,t);return e.getName(`${o}_bins`)}function fge(e){return"as"in e}function h6(e,t,n){let i,r;fge(e)?i=K(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[V(e,{forAs:!0}),V(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},Q0(t,void 0)),a=d6(o,e.field),{signal:s,extentSignal:u}=cge(n,a);if(R0(o.extent)){const c=o.extent;r=IP(n,c.param,c),delete o.extent}const l=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[i]},s?{signal:s}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:a,binComponent:l}}class yo extends et{constructor(t,n){super(t);this.bins=n}clone(){return new yo(null,be(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o,a)=>{if(qi(o)&&ot(o.bin)){const{key:s,binComponent:u}=h6(o,o.bin,n);r[s]=Object.assign(Object.assign(Object.assign({},u),r[s]),lge(n,o,a,n.config))}return r},{});return Ze(i)?null:new yo(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:o}=h6(n,n.bin,i);return new yo(t,{[r]:o})}merge(t,n){for(const i of U(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=Zr([...this.bins[i].as,...t.bins[i].as],De)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(En(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(En(this.bins).map(t=>t.field))}hash(){return`Bin ${De(this.bins)}`}assemble(){return En(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,o=t.bin,{extent:a}=o,s=uge(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:zi(t.field),as:i,signal:t.signal},R0(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!a&&t.extentSignal&&(n.push({type:"extent",field:zi(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:V({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function dge(e,t,n,i){var r;const o=kt(i)?i.encoding[Xo(t)]:void 0;if(qi(n)&&kt(i)&&eI(n,o,i.markDef,i.config))e.add(V(n,{})),e.add(V(n,{suffix:"end"})),n.bin&&yh(n,t)&&e.add(V(n,{binSuffix:"range"}));else if(Wse(t)){const a=qse(t);e.add(i.getName(a))}else e.add(V(n));return Eu(n)&&tce((r=n.scale)===null||r===void 0?void 0:r.range)&&e.add(n.scale.range.field),e}function hge(e,t){var n;for(const i of U(t)){const r=t[i];for(const o of U(r))i in e?e[i][o]=new Set([...(n=e[i][o])!==null&&n!==void 0?n:[],...r[o]]):e[i]={[o]:r[o]}}}class wr extends et{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new wr(null,new Set(this.dimensions),be(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(a=>{a.aggregate&&(i=!0)});const r={},o=new Set;return!i||(n.forEachFieldDef((a,s)=>{var u,l,c,f;const{aggregate:d,field:h}=a;if(d)if(d==="count")(u=r["*"])!==null&&u!==void 0||(r["*"]={}),r["*"].count=new Set([V(a,{forAs:!0})]);else{if(Ko(d)||as(d)){const g=Ko(d)?"argmin":"argmax",p=d[g];(l=r[p])!==null&&l!==void 0||(r[p]={}),r[p][g]=new Set([V({op:g,field:p},{forAs:!0})])}else(c=r[h])!==null&&c!==void 0||(r[h]={}),r[h][d]=new Set([V(a,{forAs:!0})]);os(s)&&n.scaleDomain(s)==="unaggregated"&&((f=r[h])!==null&&f!==void 0||(r[h]={}),r[h].min=new Set([V({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([V({field:h,aggregate:"max"},{forAs:!0})]))}else dge(o,s,a,n)}),o.size+U(r).length===0)?null:new wr(t,o,r)}static makeFromTransform(t,n){var i,r,o;const a=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((i=s["*"])!==null&&i!==void 0||(s["*"]={}),s["*"].count=new Set([f||V(u,{forAs:!0})])):((r=s[c])!==null&&r!==void 0||(s[c]={}),s[c][l]=new Set([f||V(u,{forAs:!0})])))}for(const u of(o=n.groupby)!==null&&o!==void 0?o:[])a.add(u);return a.size+U(s).length===0?null:new wr(t,a,s)}merge(t){return k$(this.dimensions,t.dimensions)?(hge(this.measures,t.measures),!0):(Ale("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...U(this.measures)])}producedFields(){const t=new Set;for(const n of U(this.measures))for(const i of U(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${De({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const o of U(this.measures))for(const a of U(this.measures[o]))for(const s of this.measures[o][a])i.push(s),t.push(a),n.push(o==="*"?null:zi(o));return{type:"aggregate",groupby:[...this.dimensions].map(zi),ops:t,fields:n,as:i}}}class Tc extends et{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const o of Ui){const a=n.facet[o];if(a){const{bin:s,sort:u}=a;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[V(a),...ot(s)?[V(a,{binSuffix:"end"})]:[]]},lo(u)?{sortField:u}:P(u)?{sortIndexField:kc(a,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Ui)this[n]&&(t+=` ${n.charAt(0)}:${De(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Ui)((t=this[i])===null||t===void 0?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Ui)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of ao){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),o=i.get("range");if(Ht(r)&&us(o)){const a=w1(this.childModel,n),s=cS(a);s?t[n]=s:q(FE(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],o=[],a=[],s=[];r&&i&&i[r]&&(n?(o.push(`distinct_${i[r]}`),a.push("max")):(o.push(i[r]),a.push("distinct")),s.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=H0,field:f}=u;o.push(f),a.push(c),s.push(V(u,{forAs:!0}))}else l&&(o.push(l),a.push("max"),s.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:a,as:s}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:o}=this.model.component,a=[],s={};for(const c of YO){for(const f of XO){const d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((i=h.axes)===null||i===void 0?void 0:i.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const i=[];let r=null;const o=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:u}=this;if(a&&s&&(o.x||o.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Wo,qo])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,o));if(u){const l=this.assembleFacetHeaderData(o);l&&i.push(...l)}return i}}function g6(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function gge(e,t){const n=yE(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=g6(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=g6(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return q(Nue(t)),null}function pge(e){const t={};return O0(e.filter,n=>{var i;if(OL(n)){let r=null;LE(n)?r=Ai(n.equal):PE(n)?r=Ai(n.lte):IE(n)?r=Ai(n.lt):zE(n)?r=Ai(n.gt):BE(n)?r=Ai(n.gte):UE(n)?r=n.range[0]:qE(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(bu(r)?t[n.field]="date":Je(r)?t[n.field]="number":K(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function mge(e){const t={};function n(i){vc(i)?t[i.field]="date":i.type==="quantitative"&&cue(i.aggregate)?t[i.field]="number":sc(i.field)>1?i.field in t||(t[i.field]="flatten"):Eu(i)&&lo(i.sort)&&sc(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((kt(e)||Er(e))&&e.forEachFieldDef((i,r)=>{if(qi(i))n(i);else{const o=mu(r),a=e.fieldDef(o);n(Object.assign(Object.assign({},i),{type:a.type}))}}),kt(e)){const{mark:i,markDef:r,encoding:o}=e;if(ls(i)&&!e.encoding.order){const a=r.orient==="horizontal"?"y":"x",s=o[a];G(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function yge(e){const t={};if(kt(e)&&e.component.selection)for(const n of U(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&sc(r.field)>1&&(t[r.field]="flatten")}return t}class Sn extends et{constructor(t,n){super(t);this._parse=n}clone(){return new Sn(null,be(this._parse))}hash(){return`Parse ${De(this._parse)}`}static makeExplicit(t,n,i){var r;let o={};const a=n.data;return!hs(a)&&((r=a==null?void 0:a.format)===null||r===void 0?void 0:r.parse)&&(o=a.format.parse),this.makeWithAncestors(t,o,{},i)}static makeWithAncestors(t,n,i,r){for(const s of U(i)){const u=r.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===i[s]||u.value==="derived"||i[s]==="flatten"?delete i[s]:q(lL(s,i[s],u.value)))}for(const s of U(n)){const u=r.get(s);u!==void 0&&(u===n[s]?delete n[s]:q(lL(s,n[s],u)))}const o=new ta(n,i);r.copyAll(o);const a={};for(const s of U(o.combine())){const u=o.get(s);u!==null&&(a[s]=u)}return U(a).length===0||r.parseNothing?null:new Sn(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of U(this._parse)){const i=this._parse[n];sc(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(U(this._parse))}dependentFields(){return new Set(U(this._parse))}assembleTransforms(t=!1){return U(this._parse).filter(n=>t?sc(n)>1:!0).map(n=>{const i=gge(n,this._parse[n]);return i?{type:"formula",expr:i,as:vE(n)}:null}).filter(n=>n!==null)}}class ys extends et{clone(){return new ys(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([bh])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:bh}}}class Sh extends et{constructor(t,n){super(t);this.params=n}clone(){return new Sh(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${De(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Ah extends et{constructor(t,n){super(t);this.params=n}clone(){return new Ah(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${De(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class Au extends et{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(hs(t)||(n=t.format?Object.assign({},Si(t.format,["parse"])):{}),xh(t))this._data={values:t.values};else if(xc(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];Me(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else cP(t)?this._data={values:[{type:"Sphere"}]}:(uP(t)||hs(t))&&(this._data={});this._generator=hs(t),t.name&&(this._name=t.name),n&&!Ze(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var p6=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},vge=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},kh;function tS(e){return e instanceof Au||e instanceof Sh||e instanceof Ah}class nS{constructor(){kh.set(this,void 0),p6(this,kh,!1,"f")}setModified(){p6(this,kh,!0,"f")}get modifiedFlag(){return vge(this,kh,"f")}}kh=new WeakMap;class ku extends nS{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,o)=>o[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class iS extends nS{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class bge extends iS{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of U(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class xge extends iS{constructor(t){super();this.requiresSelectionId=t&&qO(t)}run(t){t instanceof ys&&(this.requiresSelectionId&&(tS(t.parent)||t.parent instanceof wr||t.parent instanceof Sn)||(this.setModified(),t.remove()))}}class wge extends nS{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof mo&&(i=t.producedFields(),gE(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class _ge extends iS{constructor(){super()}run(t){t instanceof qn&&!t.isRequired()&&(this.setModified(),t.remove())}}class Ege extends ku{run(t){if(!tS(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Sn)if(t instanceof Sn)this.setModified(),t.merge(n);else{if(mE(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class Oge extends ku{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Sn);if(t.numChildren()>1&&i.length>=1){const r={},o=new Set;for(const a of i){const s=a.parse;for(const u of U(s))u in r?r[u]!==s[u]&&o.add(u):r[u]=s[u]}for(const a of o)delete r[a];if(!Ze(r)){this.setModified();const a=new Sn(t,r);for(const s of n){if(s instanceof Sn)for(const u of U(r))delete s.parse[u];t.removeChild(s),s.parent=a,s instanceof Sn&&U(s.parse).length===0&&s.remove()}}}}}class Sge extends ku{run(t){t instanceof qn||t.numChildren()>0||t instanceof Tc||t instanceof Au||(this.setModified(),t.remove())}}class Age extends ku{run(t){const n=t.children.filter(r=>r instanceof mo),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class kge extends ku{run(t){const n=t.children.filter(r=>r instanceof wr),i={};for(const r of n){const o=De(r.groupBy);o in i||(i[o]=[]),i[o].push(r)}for(const r of U(i)){const o=i[r];if(o.length>1){const a=o.pop();for(const s of o)a.merge(s)&&(t.removeChild(s),s.parent=a,s.remove(),this.setModified())}}}}class Cge extends ku{constructor(t){super();this.model=t}run(t){const n=!(tS(t)||t instanceof Sc||t instanceof Sn||t instanceof ys),i=[],r=[];for(const o of t.children)o instanceof yo&&(n&&!mE(t.producedFields(),o.dependentFields())?i.push(o):r.push(o));if(i.length>0){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof yo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(r.length>1){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class Tge extends ku{run(t){const n=[...t.children];if(!du(n,a=>a instanceof qn)||t.numChildren()<=1)return;const r=[];let o;for(const a of n)if(a instanceof qn){let s=a;for(;s.numChildren()===1;){const[u]=s.children;if(u instanceof qn)s=u;else break}r.push(...s.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=s,this.setModified()):o=s}else r.push(a);if(r.length){this.setModified();for(const a of r)a.parent.removeChild(a),a.parent=o}}}class Cu extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Cu(null,be(this.transform))}addDimensions(t){this.transform.groupby=Zr(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:V(t)}hash(){return`JoinAggregateTransform ${De(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const o of this.transform.joinaggregate)n.push(o.op),i.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function Fge(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=V(i);return r&&t.push(r),t},[])}function Dge(e){return P(e)&&e.every(t=>K(t))&&e.length>1}class na extends et{constructor(t,n){super(t);this._stack=n}clone(){return new na(null,be(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:o,offset:a="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(At(f.order,"ascending"));const l={field:s,order:u};let c;return Dge(o)?c=o:K(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new na(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:o,fieldChannel:a,offset:s,impute:u}=i,l=o.map(h=>{const g=r[h];return ho(g)}).filter(h=>!!h),c=Fge(n),f=n.encoding.order;let d;return P(f)||G(f)?d=Z$(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new na(t,{dimensionFieldDefs:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${De(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[V(r,{binSuffix:"mid"})]:[V(r,{}),V(r,{binSuffix:"end"})]:[V(r)]).flat():i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:o,sort:a,offset:s,impute:u,as:l}=this._stack;if(u)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const h=V(c,{expr:"datum"}),g=V(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${g}`,as:V(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...o,...n],key:V(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:a,as:l,offset:s}),t}}class Fc extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Fc(null,be(this.transform))}addDimensions(t){this.transform.groupby=Zr(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:V(t)}hash(){return`WindowTransform ${De(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],o=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const a=this.transform.frame,s=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&i.every(d=>AE(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),a!==void 0?{frame:a}:{})}}function Mge(e){function t(n){if(!(n instanceof Tc)){const i=n.clone();if(i instanceof qn){const r=oS+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof wr||i instanceof na||i instanceof Fc||i instanceof Cu)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function rS(e){if(e instanceof Tc)if(e.numChildren()===1&&!(e.children[0]instanceof qn)){const t=e.children[0];(t instanceof wr||t instanceof na||t instanceof Fc||t instanceof Cu)&&t.addDimensions(e.fields),t.swapWithParent(),rS(e)}else{const t=e.model.component.data.main;m6(t);const n=Mge(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(rS)}function m6(e){if(e instanceof qn&&e.type===at.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Tc||(t.swapWithParent(),m6(e))}}const oS="scale_",x1=5;function aS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!aS(t.children))return!1}return!0}function _r(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function y6(e,t,n){let i=e.sources,r=!1;return r=_r(new _ge,i)||r,r=_r(new xge(t),i)||r,i=i.filter(o=>o.numChildren()>0),r=_r(new Sge,i)||r,i=i.filter(o=>o.numChildren()>0),n||(r=_r(new Ege,i)||r,r=_r(new Cge(t),i)||r,r=_r(new wge,i)||r,r=_r(new Oge,i)||r,r=_r(new kge,i)||r,r=_r(new Age,i)||r,r=_r(new bge,i)||r,r=_r(new Tge,i)||r),e.sources=i,r}function Nge(e,t){aS(e.sources);let n=0,i=0;for(let r=0;r<x1&&y6(e,t,!0);r++)n++;e.sources.map(rS);for(let r=0;r<x1&&y6(e,t,!1);r++)i++;aS(e.sources),Math.max(n,i)===x1&&q(`Maximum optimization runs(${x1}) reached.`)}class li{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new li(()=>t(n))}}var Rge=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function v6(e){kt(e)?jge(e):$ge(e)}function jge(e){const t=e.component.scales;for(const n of U(t)){const i=Ige(e,n);if(t[n].setWithExplicit("domains",i),zge(e,n),e.component.data.isFaceted){let o=e;for(;!Er(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const s of i.value)Jo(s)&&(s.data=oS+s.data.replace(oS,""))}}}function $ge(e){for(const n of e.children)v6(n);const t=e.component.scales;for(const n of U(t)){let i,r=null;for(const o of e.children){const a=o.component.scales[n];if(a){i===void 0?i=a.getWithExplicit("domains"):i=ds(i,a.getWithExplicit("domains"),"domains","scale",lS);const s=a.get("selectionExtent");r&&s&&r.param!==s.param&&q(Tue),r=s}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function Lge(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:o}=b6(t,n);if(!r){q(o);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=b6(t,n);if(r)return"unaggregated"}return e}function Ige(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=Lge(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&$t(i.x2)?$t(i.x)?ds(vs(n,r,e,"x"),vs(n,r,e,"x2"),"domain","scale",lS):vs(n,r,e,"x2"):t==="y"&&$t(i.y2)?$t(i.y)?ds(vs(n,r,e,"y"),vs(n,r,e,"y2"),"domain","scale",lS):vs(n,r,e,"y2"):vs(n,r,e,t)}function Pge(e,t,n){return e.map(i=>({signal:`{data: ${Z0(i,{timeUnit:n,type:t})}}`}))}function sS(e,t,n){var i;const r=(i=Bn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?Pge(e,t,r):[e]}function vs(e,t,n,i){const{encoding:r}=n,o=$t(r[i]),{type:a}=o,s=o.timeUnit;if(ece(t)){const f=vs(e,void 0,n,i),d=sS(t.unionWith,a,s);return po([...f.value,...d])}else{if(oe(t))return po([t]);if(t&&t!=="unaggregated"&&!ML(t))return po(sS(t,a,s))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return Ci([[0,1]]);const f=n.requestDataName(at.Main);return Ci([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=os(i)&&G(o)?Bge(n,i,e):void 0;if(co(o)){const f=sS([o.datum],a,s);return Ci(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(at.Main),{field:d}=o;return Ci([{data:f,field:V({field:d,aggregate:"min"})},{data:f,field:V({field:d,aggregate:"max"})}])}else if(ot(c.bin)){if(Ht(e))return Ci(e==="bin-ordinal"?[]:[{data:ih(l)?n.requestDataName(at.Main):n.requestDataName(at.Raw),field:n.vgField(i,yh(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!Q(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(ot(f)){const d=eS(n,c.field,f);return Ci([new li(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Ci([{data:n.requestDataName(at.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&Me(["time","utc"],e)&&eI(c,kt(n)?n.encoding[Xo(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(at.Main);return Ci([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return Ci(l?[{data:ih(l)?n.requestDataName(at.Main):n.requestDataName(at.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(at.Main),field:n.vgField(i)}])}function uS(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":H0},i?{field:zi(i)}:{}),r?{order:r}:{})}function zge(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=ML(r)&&r,s=yu(o)&&R0(o.extent)&&o.extent;(a||s)&&i.set("selectionExtent",a!=null?a:s,!0)}function Bge(e,t,n){if(!Ht(n))return;const i=e.fieldDef(t),r=i.sort;if(KL(r))return{op:"min",field:kc(i,t),order:"ascending"};const{stack:o}=e,a=o?new Set([...o.groupbyFields,...o.stackBy.map(s=>s.fieldDef.field)]):void 0;if(lo(r)){const s=o&&!a.has(r.field);return uS(r,s)}else if(XL(r)){const{encoding:s,order:u}=r,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=o&&!a.has(f);if(Ko(c)||as(c))return uS({field:V(l),order:u},d);if(AE(c)||!c)return uS({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(Me(["ascending",void 0],r))return!0}}function b6(e,t){const{aggregate:n,type:i}=e;return n?K(n)&&!due.has(n)?{valid:!1,reason:ile(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:rle(e)}:{valid:!0}:{valid:!1,reason:nle(e)}}function lS(e,t,n,i){return e.explicit&&t.explicit&&q(lle(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function Uge(e){const t=Zr(e.map(a=>Jo(a)?Rge(a,["sort"]):a),De),n=Zr(e.map(a=>{if(Jo(a)){const s=a.sort;return s!==void 0&&!ih(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(a=>a!==void 0),De);if(t.length===0)return;if(t.length===1){const a=e[0];if(Jo(a)&&n.length>0){let s=n[0];if(n.length>1)q(pL),s=!0;else if(Q(s)&&"field"in s){const u=s.field;a.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},a),{sort:s})}return a}const i=Zr(n.map(a=>ih(a)||!("op"in a)||K(a.op)&&a.op in uue?a:(q(fle(a)),!0)),De);let r;i.length===1?r=i[0]:i.length>1&&(q(pL),r=!0);const o=Zr(e.map(a=>Jo(a)?a.data:null),a=>a);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(s=>s.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function cS(e){if(Jo(e)&&K(e.field))return e.field;if(gue(e)){let t;for(const n of e.fields)if(Jo(n)&&K(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(dle),t}return q(hle),t}else if(pue(e)){q(gle);const t=e.fields[0];return K(t)?t:void 0}}function w1(e,t){const i=e.component.scales[t].get("domains").map(r=>(Jo(r)&&(r.data=e.lookupDataSource(r.data)),r));return Uge(i)}var qge=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function x6(e){return Dc(e)||hS(e)?e.children.reduce((t,n)=>t.concat(x6(n)),w6(e)):w6(e)}function w6(e){return U(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=r,f=qge(r,["name","type","selectionExtent","domains","range","reverse"]),d=Wge(r.range,o,n,e),h=w1(e,n),g=s?Rde(e,s,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function Wge(e,t,n,i){if(rn(n)){if(us(e))return{step:{signal:`${t}_step`}}}else if(Q(e)&&Jo(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}class _6 extends ta{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:du(this.get("domains"),t=>P(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const Hge=["range","scheme"];function Gge(e){const t=e.component.scales;for(const n of N0){const i=t[n];if(!i)continue;const r=Vge(n,e);i.setWithExplicit("range",r)}}function E6(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,o=ai(t),a=e.getName(o);if(Q(i)&&i.binned&&i.step!==void 0)return new li(()=>{const s=e.scaleName(t),u=`(domain("${s}")[1] - domain("${s}")[0]) / ${i.step}`;return`${e.getSignalName(a)} / (${u})`});if(ot(i)){const s=eS(e,r,i);return new li(()=>{const u=e.getSignalName(s),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function Vge(e,t){const n=t.specifiedScales[e],{size:i}=t,o=t.getScaleComponent(e).get("type");for(const f of Hge)if(n[f]!==void 0){const d=YE(o,f),h=NL(e,f);if(!d)q(hL(o,f,e));else if(h)q(h);else switch(f){case"range":{const g=n.range;if(P(g)){if(rn(e))return po(g.map(p=>{if(p==="width"||p==="height"){const m=t.getName(p),y=t.getSignalName.bind(t);return li.fromName(y,m)}return p}))}else if(Q(g))return po({data:t.requestDataName(at.Main),field:g.field,sort:{op:"min",field:t.vgField(e)}});return po(g)}case"scheme":return po(Yge(n[f]))}}const a=e===pt||e==="xOffset"?"width":"height",s=i[a];if(go(s)){if(rn(e))if(Ht(o)){const f=O6(s,t,e);if(f)return po({step:f})}else q(gL(a));else if(cc(e)){const f=e===Za?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const g=S6(s,o);if(g)return po(g)}}}const{rangeMin:u,rangeMax:l}=n,c=Xge(e,t);return(u!==void 0||l!==void 0)&&YE(o,"rangeMin")&&P(c)&&c.length===2?po([u!=null?u:c[0],l!=null?l:c[1]]):Ci(c)}function Yge(e){return Zle(e)?Object.assign({scheme:e.name},Si(e,["name"])):{scheme:e}}function Xge(e,t){const{size:n,config:i,mark:r,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=$t(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case pt:case Wt:{if(Me(["point","band"],l)){const g=A6(e,n,i.view);if(go(g))return{step:O6(g,t,e)}}const d=ai(e),h=t.getName(d);return e===Wt&&ki(l)?[li.fromName(a,h),0]:[0,li.fromName(a,h)]}case Za:case uc:return Kge(e,t,l);case Vo:{const d=t.component.scales[e].get("zero"),h=k6(r,d,i),g=Zge(r,n,t,i);return gc(l)?Qge(h,g,Jge(l,i,c,e)):[h,g]}case yr:return[0,Math.PI*2];case gu:return[0,360];case to:return[0,new li(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case ns:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case is:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case oi:return"symbol";case ri:case ro:case oo:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Yo:case es:case ts:return[i.scale.minOpacity,i.scale.maxOpacity]}}function O6(e,t,n){var i,r,o,a,s;const{encoding:u}=t,l=t.getScaleComponent(n),c=I$(n),f=u[c];if(RI({step:e,offsetIsDiscrete:ye(f)&&AL(f.type)})==="offset"&&hI(u,c)){const h=t.getScaleComponent(c);let p=`domain('${t.scaleName(c)}').length`;if(h.get("type")==="band"){const y=(r=(i=h.get("paddingInner"))!==null&&i!==void 0?i:h.get("padding"))!==null&&r!==void 0?r:0,v=(a=(o=h.get("paddingOuter"))!==null&&o!==void 0?o:h.get("padding"))!==null&&a!==void 0?a:0;p=`bandspace(${p}, ${y}, ${v})`}const m=(s=l.get("paddingInner"))!==null&&s!==void 0?s:l.get("padding");return{signal:`${e.step} * ${p} / (1-${bue(m)})`}}else return e.step}function S6(e,t){if(RI({step:e,offsetIsDiscrete:Ht(t)})==="offset")return{step:e.step}}function Kge(e,t,n){const i=e===Za?"x":"y",o=t.getScaleComponent(i).get("type"),a=t.scaleName(i);if(o==="band"){const s=A6(i,t.size,t.config.view);if(go(s)){const u=S6(s,n);if(u)return u}return[0,{signal:`bandwidth('${a}')`}]}else return S$(`Cannot use ${e} scale if ${i} scale is not discrete.`)}function A6(e,t,n){const i=e===pt?"width":"height",r=t[i];return r||s1(n,i)}function Jge(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&P(n)?n.length+1:(q(Ele(i)),3)}}function Qge(e,t,n){const i=()=>{const r=Qo(t),o=Qo(e),a=`(${r} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${r} + ${a}, ${a})`};return oe(t)?new li(i):{signal:i()}}function k6(e,t,n){if(t)return oe(t)?{signal:`${t.signal} ? 0 : ${k6(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error($0("size",e))}const C6=.95;function Zge(e,t,n,i){const r={x:E6(n,"x"),y:E6(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const o=T6(t,r,i.view);return Je(o)?o-1:new li(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const o=T6(t,r,i.view);return Je(o)?Math.pow(C6*o,2):new li(()=>`pow(${C6} * ${o.signal}, 2)`)}}throw new Error($0("size",e))}function T6(e,t,n){const i=go(e.width)?e.width.step:a1(n,"width"),r=go(e.height)?e.height.step:a1(n,"height");return t.x||t.y?new li(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function F6(e,t){kt(e)?epe(e,t):N6(e,t)}function epe(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:o,specifiedScales:a}=e;for(const s of U(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=$t(r[s]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=YE(h,t),y=NL(s,t);if(d!==void 0&&(m?y&&q(y):q(hL(h,t,s))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":bu(u[t])||x==="temporal"||v?l.set(t,{signal:Z0(u[t],{type:x,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in D6?D6[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:i,hasNestedOffsetScale:dO(r,s)}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const D6={bins:({model:e,fieldOrDatumDef:t})=>G(t)?tpe(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>npe(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:o})=>ipe(e,t,n,i,r,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>rpe(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:o})=>ope(e,t,n.type,i,r.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:o})=>ape(e,t,n,i,r.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=G(e)?e.sort:void 0;return spe(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>upe(e,t,n,i,r)};function M6(e){kt(e)?Gge(e):N6(e,"range")}function N6(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?M6(i):F6(i,t);for(const i of U(n)){let r;for(const o of e.children){const a=o.component.scales[i];if(a){const s=a.getWithExplicit(t);r=ds(r,s,t,"scale",sP((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function tpe(e,t){const n=t.bin;if(ot(n)){const i=eS(e,t.field,n);return new li(()=>e.getSignalName(i))}else if(zn(n)&&yu(n)&&n.step!==void 0)return{step:n.step}}function npe(e,t){if(Me([ri,ro,oo],e)&&t!=="nominal")return"hcl"}function ipe(e,t,n,i,r,o){var a;if(!(((a=ho(o))===null||a===void 0?void 0:a.bin)||P(n)||r!=null||i!=null||Me([ui.TIME,ui.UTC],e)))return rn(t)?!0:void 0}function rpe(e,t,n,i,r,o){if(rn(e)){if(br(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:s}=r;if(a==="bar"&&!(G(i)&&(i.bin||i.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===ui.POINT)return n.pointPadding}}function ope(e,t,n,i,r,o=!1){if(e===void 0){if(rn(t)){const{bandPaddingInner:a,barBandPaddingInner:s,rectBandPaddingInner:u,bandWithNestedOffsetPaddingInner:l}=r;return o?l:At(a,n==="bar"?s:u)}else if(cc(t)&&i===ui.BAND)return r.offsetBandPaddingInner}}function ape(e,t,n,i,r,o=!1){if(e===void 0){if(rn(t)){const{bandPaddingOuter:a,bandWithNestedOffsetPaddingOuter:s}=r;if(o)return s;if(n===ui.BAND)return At(a,oe(i)?{signal:`${i.signal}/2`}:i/2)}else if(cc(t)){if(n===ui.POINT)return .5;if(n===ui.BAND)return r.offsetBandPaddingOuter}}}function spe(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return ki(e)&&t==="descending"?oe(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(ki(e)&&t==="descending")return!0}function upe(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&ki(r)){if(P(n)){const a=n[0],s=n[n.length-1];if(a<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!gc(r))return!0;if(!(G(t)&&t.bin)&&Me([...ao,...eue],e)){const{orient:a,type:s}=i;return!(Me(["bar","area","line","trail"],s)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function lpe(e,t,n,i,r=!1){const o=cpe(t,n,i,r),{type:a}=e;return os(t)?a!==void 0?ace(t,a)?G(n)&&!oce(a,n.type)?(q(sle(a,o)),o):a:(q(ale(t,a,o)),o):o:null}function cpe(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":{if(lc(e)||SE(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(ME(e,"ordinal")),"ordinal";if(rn(e)||cc(e)){if(Me(["rect","bar","image","rule"],n.type)||i)return"band"}else if(n.type==="arc"&&e in OE)return"band";const o=n[ai(e)];return pc(o)||uO(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point"}case"temporal":return lc(e)?"time":SE(e)==="discrete"?(q(ME(e,"temporal")),"ordinal"):G(t)&&t.timeUnit&&Bn(t.timeUnit).utc?"utc":"time";case"quantitative":return lc(e)?G(t)&&ot(t.bin)?"bin-ordinal":"linear":SE(e)==="discrete"?(q(ME(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(fL(t.type))}function fpe(e,{ignoreRange:t}={}){R6(e),v6(e);for(const n of rce)F6(e,n);t||M6(e)}function R6(e){kt(e)?e.component.scales=dpe(e):e.component.scales=gpe(e)}function dpe(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const o of N0){const a=$t(t[o]);if(a&&n===$L&&o===oi&&a.type===hc)continue;let s=a&&a.scale;if(cc(o)){const u=P$(o);if(!dO(t,u)){s&&q(Gue(o));continue}}if(a&&s!==null&&s!==!1){s!=null||(s={});const u=dO(t,o),l=lpe(s,o,a,i,u);r[o]=new _6(e.scaleName(`${o}`,!0),{value:l,explicit:s.type===l})}}return r}const hpe=sP((e,t)=>kL(e)-kL(t));function gpe(e){var t,n;const i=e.component.scales={},r={},o=e.component.resolve;for(const a of e.children){R6(a);for(const s of U(a.component.scales))if((t=(n=o.scale)[s])!==null&&t!==void 0||(n[s]=QP(s,e)),o.scale[s]==="shared"){const u=r[s],l=a.component.scales[s].getWithExplicit("type");u?Yle(u.value,l.value)?r[s]=ds(u,l,"type","scale",hpe):(o.scale[s]="independent",delete r[s]):r[s]=l}}for(const a of U(r)){const s=e.scaleName(a,!0),u=r[a];i[a]=new _6(s,u);for(const l of e.children){const c=l.component.scales[a];c&&(l.renameScale(c.get("name"),s),c.merged=!0)}}return i}var fS=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class dS{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function kt(e){return(e==null?void 0:e.type)==="unit"}function Er(e){return(e==null?void 0:e.type)==="facet"}function hS(e){return(e==null?void 0:e.type)==="concat"}function Dc(e){return(e==null?void 0:e.type)==="layer"}class gS{constructor(t,n,i,r,o,a,s){var u,l;this.type=n,this.parent=i,this.config=o,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=o,this.view=si(s),this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=ss(t.title)?{text:t.title}:t.title?si(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new dS,this.projectionNameMap=i?i.projectionNameMap:new dS,this.signalNameMap=i?i.signalNameMap:new dS,this.data=t.data,this.description=t.description,this.transforms=yde((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Efe(t,n,o),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:G0(t)||(i==null?void 0:i.component.data.isFaceted)&&t.data===void 0},layoutSize:new ta,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?be(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){fpe(this)}parseProjection(){f6(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){a6(this)}assembleEncodeFromView(t){const n=fS(t,["style"]),i={};for(const r of U(n)){const o=n[r];o!==void 0&&(i[r]=lt(o))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=lt(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):Ze(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=fS(t,["spacing"]),{component:r,config:o}=this,a=Dhe(r.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Ui)t[i].title&&n.push(She(this,i));for(const i of YO)n=n.concat(Ahe(this,i));return n}assembleAxes(){return hhe(this.component.axes,this.config)}assembleLegends(){return u6(this)}assembleProjections(){return tge(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=r,a=fS(r,["encoding"]),s=Object.assign(Object.assign(Object.assign({},V$(this.config.title).nonMarkTitleProperties),a),o?{encode:{update:o}}:{});if(s.text)return Me(["unit","layer"],this.type)?Me(["middle",void 0],s.anchor)&&((n=s.frame)!==null&&n!==void 0||(s.frame="group")):(i=s.anchor)!==null&&i!==void 0||(s.anchor="start"),Ze(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Er(this.parent)?x6(this):[];r.length>0&&(n.scales=r);const o=this.assembleAxes();o.length>0&&(n.axes=o);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return ht((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(at[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Er(this.parent)){const n=KP(t),i=M0(n),r=this.component.scales[i];if(r&&!r.merged){const o=r.get("type"),a=r.get("range");if(Ht(o)&&us(a)){const s=r.get("name"),u=w1(this,i),l=cS(u);if(l){const c=V({aggregate:"distinct",field:l},{expr:"datum"});return{signal:XP(s,r,c)}}else return q(FE(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if($$(t)&&os(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Oue(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class j6 extends gS{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return V(i,n)}reduceFieldDef(t,n){return Jce(this.getMapping(),(i,r,o)=>{const a=ho(r);return a?t(i,a,o):i},n)}forEachFieldDef(t,n){gO(this.getMapping(),(i,r)=>{const o=ho(i);o&&t(o,r)},n)}}var ppe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class _1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"value",(o=a[1])!==null&&o!==void 0?o:"density"]}clone(){return new _1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${De(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=ppe(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class Ch extends et{constructor(t,n){super(t);this.filter=n}clone(){return new Ch(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:o}=n;if(He("invalid",o,i)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=os(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");ki(d)&&l.aggregate!=="count"&&!ls(r)&&(u[l.field]=l)}return u},{});return U(s).length?new Ch(t,s):null}dependentFields(){return new Set(U(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${De(this.filter)}`}assemble(){const t=U(this.filter).reduce((n,i)=>{const r=this.filter[i],o=V(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):r.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class E1 extends et{constructor(t,n){super(t);this.transform=n,this.transform=be(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((o,a)=>{var s;return(s=r[a])!==null&&s!==void 0?s:o})}clone(){return new E1(this.parent,be(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${De(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class O1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"key",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new O1(null,be(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${De(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Mc extends et{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new Mc(null,be(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[io,no],[Bi,vr]]){const o=r.map(a=>{const s=$t(n.encoding[a]);return G(s)?s.field:co(s)?{expr:`${s.datum}`}:xr(s)?{expr:`${s.value}`}:void 0});(o[0]||o[1])&&(t=new Mc(t,o,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(oi)){const r=n.typedFieldDef(oi);r.type===hc&&(t=new Mc(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(K);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${De(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class Th extends et{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new Th(null,this.projection,be(this.fields),be(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[io,no],[Bi,vr]]){const r=i.map(a=>{const s=$t(n.encoding[a]);return G(s)?s.field:co(s)?{expr:`${s.datum}`}:xr(s)?{expr:`${s.value}`}:void 0}),o=i[0]===Bi?"2":"";(r[0]||r[1])&&(t=new Th(t,n.projectionName(),r,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(K))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${De(this.fields)} ${De(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Tu extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Tu(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Tu(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,o=i.y;if(G(r)&&G(o)){const a=r.impute?r:o.impute?o:void 0;if(a===void 0)return;const s=r.impute?o:o.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=pI(n.mark,i);return new Tu(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${De(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:o,value:a,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Zfe(i)?this.processSequence(i):i}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!r||r==="value"?a:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:s,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var mpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class S1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.loess]}clone(){return new S1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${De(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=mpe(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class Fh extends et{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new Fh(null,be(this.transform),this.secondary)}static make(t,n,i,r){const o=n.component.data.sources,{from:a}=i;let s=null;if(ede(a)){let u=P6(a.data,o);u||(u=new Au(a.data),o.push(u));const l=n.getName(`lookup_${r}`);s=new qn(u,l,at.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(tde(a)){const u=a.param;i=Object.assign({as:u},i);let l;try{l=n.getSelectionComponent(ht(u),u)}catch{throw new Error(kue(u))}if(s=l.materialized,!s)throw new Error(Cue(u))}return new Fh(t,i,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?J(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${De({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:J(this.transform.as)}:{});else{let n=this.transform.as;K(n)||(q($ue),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var ype=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class A1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"prob",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new A1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${De(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=ype(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}var vpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class k1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.regression]}clone(){return new k1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${De(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=vpe(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class C1 extends et{constructor(t,n){super(t);this.transform=n}clone(){return new C1(null,be(this.transform))}addDimensions(t){var n;this.transform.groupby=Zr(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${De(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),o!==void 0?{op:o}:{}),i!==void 0?{groupby:i}:{})}}class T1 extends et{constructor(t,n){super(t);this.transform=n}clone(){return new T1(null,be(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${De(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function $6(e){let t=0;function n(i,r){var o;if(i instanceof Au&&!i.isGenerator&&!xc(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Sn&&(i.parent instanceof Au&&!r.source?(r.format=Object.assign(Object.assign({},(o=r.format)!==null&&o!==void 0?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Tc){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof Sh||i instanceof Ah||i instanceof Ch||i instanceof Sc||i instanceof Ac||i instanceof Th||i instanceof wr||i instanceof Fh||i instanceof Fc||i instanceof Cu||i instanceof O1||i instanceof E1||i instanceof _1||i instanceof S1||i instanceof A1||i instanceof k1||i instanceof ys||i instanceof T1||i instanceof C1)&&r.transform.push(i.assemble()),(i instanceof yo||i instanceof mo||i instanceof Tu||i instanceof na||i instanceof Mc)&&r.transform.push(...i.assemble()),i instanceof qn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof qn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof qn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let a=r.name;!r.source||r.transform.length>0?e.push(r):a=r.source;for(const s of i.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function bpe(e){const t=[],n=$6(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function xpe(e,t){var n,i;const r=[],o=$6(r);let a=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${a++}`);const l=u.assemble();o(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(s++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function wpe(e){return e==="top"||e==="left"||oe(e)?"header":"footer"}function _pe(e){for(const t of Ui)Epe(e,t);I6(e,"x"),I6(e,"y")}function Epe(e,t){var n;const{facet:i,config:r,child:o,component:a}=e;if(e.channelHasField(t)){const s=i[t],u=Cc("title",null,r,t);let l=mc(s,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});o.component.layoutHeaders[t].title&&(l=P(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=Cc("labelOrient",s.header,r,t),f=s.header!==null?At((n=s.header)===null||n===void 0?void 0:n.labels,r.header.labels,!0):!1,d=Me(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:s.header!==null?l:null,facetFieldDef:s,[d]:t==="facet"?[]:[L6(e,t,f)]}}}function L6(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function I6(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:o}=e.component;if(o.axis[t]=QO(o,t),o.axis[t]==="shared"){const a=t==="x"?"column":"row",s=r[a];for(const u of i.component.axes[t]){const l=wpe(u.get("orient"));(n=s[l])!==null&&n!==void 0||(s[l]=[L6(e,a,!1)]);const c=Oh(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function Ope(e){pS(e),F1(e,"width"),F1(e,"height")}function Spe(e){pS(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";F1(e,t),F1(e,n)}function pS(e){for(const t of e.children)t.parseLayoutSize()}function F1(e,t){var n;const i=KP(t),r=M0(i),o=e.component.resolve,a=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(i),c=(n=o.scale[r])!==null&&n!==void 0?n:QP(r,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=ds(s,l,i,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(i),e.getName(t)),u.component.layoutSize.set(i,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function Ape(e){const{size:t,component:n}=e;for(const i of ao){const r=ai(i);if(t[r]){const o=t[r];n.layoutSize.set(r,go(o)?"step":o,!0)}else{const o=kpe(e,r);n.layoutSize.set(r,o,!1)}}}function kpe(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const o=r.get("type"),a=r.get("range");if(Ht(o)){const s=s1(i.view,t);return us(a)||go(s)?"step":s}else return AO(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return AO(i.view,t);{const o=s1(i.view,t);return go(o)?o.step:o}}}function mS(e,t,n){return V(t,Object.assign({suffix:`by_${V(e)}`},n!=null?n:{}))}class Dh extends j6{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=wS(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!ph(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=U(t),i={};for(const r of n){if(![qo,Wo].includes(r)){q($0(r,"facet"));break}const o=t[r];if(o.field===void 0){q(DE(o,r));break}i[r]=this.initFacetFieldDef(o,r)}return i}initFacetFieldDef(t,n){const i=fO(t,n);return i.header?i.header=si(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=D1(this),this.child.parseData()}parseLayoutSize(){pS(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),_pe(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const o of Ui)for(const a of XO){const s=this.component.layoutHeaders[o],u=s[a],{facetFieldDef:l}=s;if(l){const c=Cc("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=y1(o,c);(t=r.titleAnchor)!==null&&t!==void 0||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=r[f])!==null&&n!==void 0||(r[f]={}),r[f][o]=.5),s.title&&((i=r.offset)!==null&&i!==void 0||(r.offset={}),r.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Dh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Dh?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:V(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Dh){if(this.child.channelHasField("column")){const r=V(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of ao){const o=this.child.component.scales[r];if(o&&!o.merged){const a=o.get("type"),s=o.get("range");if(Ht(a)&&us(s)){const u=w1(this.child,r),l=cS(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):q(FE(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:o,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Ui){const f=this.facet[c];if(f){u.push(V(f));const{bin:d,sort:h}=f;if(ot(d)&&u.push(V(f,{binSuffix:"end"})),lo(h)){const{field:g,op:p=H0}=h,m=mS(f,h);i&&r?(o.push(m),a.push("max"),s.push(m)):(o.push(g),a.push(p),s.push(m))}else if(P(h)){const g=kc(f,c);o.push(g),a.push("max"),s.push(g)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:a,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?lo(i.sort)?[mS(i,i.sort,{expr:"datum"})]:P(i.sort)?[kc(i,t,{expr:"datum"})]:[V(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(lo(r)?r.order:!P(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return KO(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const o of YO)if(n[o]){const a=Cc("labelOrient",(t=n[o])===null||t===void 0?void 0:t.header,i,o);if(r[o].includes(a))return KO(n[o],o,i)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=bpe(n),r=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Ui.map(u=>this.facetSortFields(u)).flat(),order:Ui.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(Fde(this,[])))]}getMapping(){return this.facet}}function Cpe(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const o of[n,i])if(lo(o.sort)){const{field:a,op:s=H0}=o.sort;e=r=new Cu(e,{joinaggregate:[{op:s,field:a,as:mS(o,o.sort,{forAs:!0})}],groupby:[V(o)]})}return r}return null}function P6(e,t){var n,i,r,o;for(const a of t){const s=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(i=s.format)===null||i===void 0?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)===null||r===void 0?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(o=s.format)===null||o===void 0?void 0:o.mesh;if(!((u||f)&&u!==f)){if(xh(e)&&xh(s)){if(Qr(e.values,s.values))return a}else if(xc(e)&&xc(s)){if(e.url===s.url)return a}else if(uP(e)&&e.name===a.dataName)return a}}return null}function Tpe(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Au({values:[]});return t.push(i),i}const n=P6(e.data,t);if(n)return hs(e.data)||(n.data.format=A$({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Au(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Fpe(e,t,n){var i,r;let o=0;for(const a of t.transforms){let s,u;if(fde(a))u=e=new Ac(e,a),s="derived";else if(DO(a)){const l=pge(a);u=e=(i=Sn.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new Sc(e,t,a.filter)}else if(ZI(a))u=e=yo.makeFromTransform(e,a,t),s="number";else if(hde(a))s="date",n.getWithExplicit(a.field).value===void 0&&(e=new Sn(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=mo.makeFromTransform(e,a);else if(gde(a))u=e=wr.makeFromTransform(e,a),s="number",qO(t)&&(e=new ys(e));else if(QI(a))u=e=Fh.make(e,t,a,o++),s="derived";else if(ude(a))u=e=new Fc(e,a),s="number";else if(lde(a))u=e=new Cu(e,a),s="number";else if(pde(a))u=e=na.makeFromTransform(e,a),s="derived";else if(mde(a))u=e=new O1(e,a),s="derived";else if(cde(a))u=e=new E1(e,a),s="derived";else if(nde(a))u=e=new C1(e,a),s="derived";else if(sde(a))e=new T1(e,a);else if(dde(a))u=e=Tu.makeFromTransform(e,a),s="derived";else if(ide(a))u=e=new _1(e,a),s="derived";else if(rde(a))u=e=new A1(e,a),s="derived";else if(ode(a))u=e=new k1(e,a),s="derived";else if(ade(a))u=e=new S1(e,a),s="derived";else{q(jue(a));continue}if(u&&s!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,s,!1)}return e}function D1(e){var t,n,i,r,o,a,s,u,l,c;let f=Tpe(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(hs(g)||xc(g)||xh(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new kde;hs(g)?(lP(g)?f=new Ah(f,g.sequence):RO(g)&&(f=new Sh(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=Sn.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new ys(f);const y=e.parent&&Dc(e.parent);(kt(e)||Er(e))&&y&&(f=(i=yo.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=Fpe(f,e,m));const v=yge(e),x=mge(e);f=(r=Sn.makeWithAncestors(f,{},Object.assign(Object.assign({},v),x),m))!==null&&r!==void 0?r:f,kt(e)&&(f=Mc.parseAll(f,e),f=Th.parseAll(f,e)),(kt(e)||Er(e))&&(y||(f=(o=yo.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(a=mo.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=Ac.parseAllForSortIndex(f,e));const b=e.getDataName(at.Raw),_=new qn(f,b,at.Raw,h);if(d[b]=_,f=_,kt(e)){const S=wr.makeFromEncoding(f,e);S&&(f=S,qO(e)&&(f=new ys(f))),f=(s=Tu.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=na.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}kt(e)&&(f=(l=Ch.make(f,e))!==null&&l!==void 0?l:f);const E=e.getDataName(at.Main),w=new qn(f,E,at.Main,h);d[E]=w,f=w,kt(e)&&fhe(e,w);let O=null;if(Er(e)){const S=e.getName("facet");f=(c=Cpe(f,e.facet))!==null&&c!==void 0?c:f,O=new Tc(f,e,S,w.getSource()),d[S]=O}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:_,main:w,facetRoot:O,ancestorParse:m})}class Dpe extends gS{constructor(t,n,i,r){var o,a,s,u;super(t,"concat",n,i,r,t.resolve);(((a=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||a===void 0?void 0:a.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&q(Mue),this.children=this.getChildren(t).map((l,c)=>wS(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=D1(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return o1(t)?t.vconcat:SO(t)?t.hconcat:t.concat}parseLayoutSize(){Spe(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=JO(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function Mpe(e){return e===!1||e===null}const Npe=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},cI),{labelExpr:1,encode:1}),z6=U(Npe);class yS extends ta{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new yS(be(this.explicit),be(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!Mpe(this.get(t))}hasOrientSignalRef(){return oe(this.explicit.orient)}}function Rpe(e,t,n){var i;const{encoding:r,config:o}=e,a=(i=$t(r[t]))!==null&&i!==void 0?i:$t(r[Xo(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return _u(l)?Object.assign({text:nO({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}function jpe(e){return ao.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Upe(n,e)]),t),{})}const $pe={bottom:"top",top:"bottom",left:"right",right:"left"};function Lpe(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const a of U(o.component.axes))i.axis[a]=QO(e.component.resolve,a),i.axis[a]==="shared"&&(n[a]=Ipe(n[a],o.component.axes[a]),n[a]||(i.axis[a]="independent",delete n[a]))}for(const o of ao){for(const a of e.children)if(!!a.component.axes[o]){if(i.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(a.component.axes[o]);for(const s of a.component.axes[o]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!oe(u)){if(r[u]>0&&!l){const c=$pe[u];r[u]>r[c]&&s.set("orient",c,!1)}r[u]++}}}delete a.component.axes[o]}if(i.axis[o]==="independent"&&n[o]&&n[o].length>1)for(const a of n[o])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function Ipe(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],o=t[i];if(!!r!=!!o)return;if(r&&o){const a=r.getWithExplicit("orient"),s=o.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;e[i]=Ppe(r,o)}}}else return t.map(n=>n.clone());return e}function Ppe(e,t){for(const n of z6){const i=ds(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,o)=>{switch(n){case"title":return nL(r,o);case"gridScale":return{explicit:r.explicit,value:At(r.value,o.value)}}return l1(r,o,n,"axis")});e.setWithExplicit(n,i)}return e}function zpe(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(oe(n.labelAngle)?n.labelAngle:ah(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===WP(i,r))return!0}return e===n[t]}const Bpe=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Upe(e,t){var n,i,r;let o=t.axis(e);const a=new yS,s=$t(t.encoding[e]),{mark:u,config:l}=t,c=(o==null?void 0:o.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||whe(e),f=t.getScaleComponent(e).get("type"),d=ghe(e,f,c,t.config),h=o!==void 0?!o:GO("disable",l.style,o==null?void 0:o.style,d).configValue;if(a.set("disable",h,o!==void 0),h)return a;o=o||{};const g=vhe(s,o,e,l.style,d),p={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const v of z6){const x=v in BP?BP[v](p):fI(v)?o[v]:void 0,b=x!==void 0,_=zpe(x,v,o,t,e);if(b&&_)a.set(v,x,_);else{const{configValue:E=void 0,configFrom:w=void 0}=fI(v)&&v!=="values"?GO(v,l.style,o.style,d):{},O=E!==void 0;b&&!O?a.set(v,x,_):(w!=="vgAxisConfig"||Bpe.has(v)&&O||vh(E)||oe(E))&&a.set(v,E,!1)}}const m=(r=o.encoding)!==null&&r!==void 0?r:{},y=lI.reduce((v,x)=>{var b;if(!a.hasAxisPart(x))return v;const _=JP((b=m[x])!==null&&b!==void 0?b:{},t),E=x==="labels"?Rpe(t,e,_):_;return E!==void 0&&!Ze(E)&&(v[x]={update:E}),v},{});return Ze(y)||a.set("encode",y,!!o.encoding||o.labelAngle!==void 0),a}function qpe({encoding:e,size:t}){for(const n of ao){const i=ai(n);go(t[i])&&fo(e[n])&&(delete t[i],q(gL(i)))}return t}function Wpe(e,t,n){const i=si(e),r=He("orient",i,n);if(i.orient=Ype(i.type,t,r),r!==void 0&&r!==i.orient&&q(Zue(i.orient,r)),i.type==="bar"&&i.orient){const s=He("cornerRadiusEnd",i,n);if(s!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:vce[i.orient];for(const l of u)i[l]=s;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return He("opacity",i,n)===void 0&&(i.opacity=Gpe(i.type,t)),He("cursor",i,n)===void 0&&(i.cursor=Hpe(i,t,n)),i}function Hpe(e,t,n){return t.href||e.href||He("href",e,n)?"pointer":e.cursor}function Gpe(e,t){if(Me([B0,XE,KE,JE],e)&&!hO(t))return .7}function Vpe(e,t,{graticule:n}){if(n)return!1;const i=vu("filled",e,t),r=e.type;return At(i,r!==B0&&r!==z0&&r!==U0)}function Ype(e,t,n){switch(e){case B0:case KE:case JE:case jL:case uce:case sce:return}const{x:i,y:r,x2:o,y2:a}=t;switch(e){case P0:if(G(i)&&(zn(i.bin)||G(r)&&r.aggregate&&!i.aggregate))return"vertical";if(G(r)&&(zn(r.bin)||G(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(G(i)&&i.type===xu&&!ot(i.bin)||sO(i)))return"horizontal";if(!a&&(G(r)&&r.type===xu&&!ot(r.bin)||sO(r)))return"vertical"}case U0:if(o&&!(G(i)&&zn(i.bin))&&a&&!(G(r)&&zn(r.bin)))return;case I0:if(a)return G(r)&&zn(r.bin)?"horizontal":"vertical";if(o)return G(i)&&zn(i.bin)?"vertical":"horizontal";if(e===U0){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case z0:case XE:{const s=fo(i),u=fo(r);if(n)return n;if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=i,c=r,f=l.type===dc,d=c.type===dc;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const Xpe={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),ps(e,"radius")),ps(e,"theta"))},Kpe={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),f1("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),f1("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),BO(e))},Jpe={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ps(e,"x")),ps(e,"y"))},Qpe={vgMark:"shape",encodeEntry:e=>Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&G(n)&&n.type===hc?{field:V(n,{expr:"datum"})}:{})]}},Zpe={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),ps(e,"x")),ps(e,"y")),PO(e,"url"))},eme={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e,{vgChannel:"strokeWidth"})),BO(e))},tme={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e)),BO(e))};function vS(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e)),Gt("angle",e)),nme(e,n,t))}function nme(e,t,n){return n?{shape:{value:n}}:Gt("shape",e)}const ime={vgMark:"symbol",encodeEntry:e=>vS(e)},rme={vgMark:"symbol",encodeEntry:e=>vS(e,"circle")},ome={vgMark:"symbol",encodeEntry:e=>vS(e,"square")},ame={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ps(e,"x")),ps(e,"y"))},sme={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),f1("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),f1("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Gt("size",e,{vgChannel:"strokeWidth"}))}},ume={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),PO(e)),Gt("size",e,{vgChannel:"fontSize"})),Gt("angle",e)),_P("align",lme(e.markDef,n,t))),_P("baseline",cme(e.markDef,n,t))),On("radius",e,{defaultPos:null})),On("theta",e,{defaultPos:null}))}};function lme(e,t,n){if(He("align",e,n)===void 0)return"center"}function cme(e,t,n){if(He("baseline",e,n)===void 0)return"middle"}const fme={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Wi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid",vgChannel:"xc"})),On("y",e,{defaultPos:"mid",vgChannel:"yc"})),Gt("size",e,{defaultValue:dme(e),vgChannel:r})),{[o]:lt(He("thickness",n,t))})}};function dme(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,o=r==="horizontal"?"width":"height",a=e.getScaleComponent(r==="horizontal"?"x":"y"),s=(t=He("size",i,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=a?a.get("range"):void 0;return u&&us(u)&&Je(u.step)?u.step*3/4:a1(n.view,o)*3/4}}const M1={arc:Xpe,area:Kpe,bar:Jpe,circle:rme,geoshape:Qpe,image:Zpe,line:eme,point:ime,rect:ame,rule:sme,square:ome,text:ume,tick:fme,trail:tme};function hme(e){if(Me([z0,I0,lce],e.mark)){const t=pI(e.mark,e.encoding);if(t.length>0)return gme(e,t)}else if(e.mark===P0){const t=kE.some(n=>He(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return pme(e)}return bS(e)}const B6="faceted_path_";function gme(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:B6+e.requestDataName(at.Main),data:e.requestDataName(at.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:bS(e,{fromPrefix:B6})}]}const U6="stack_group_";function pme(e){var t;const[n]=bS(e,{fromPrefix:U6}),i=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),o=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${i}',${h})`).join(",")})`};let a,s;e.stack.fieldChannel==="x"?(a=Object.assign(Object.assign({},ac(n.encode.update,["y","yc","y2","height",...kE])),{x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Si(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},ac(n.encode.update,["x","xc","x2","width"])),{y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Si(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of kE){const f=vu(c,e.markDef,e.config);n.encode.update[c]?(a[c]=n.encode.update[c],delete n.encode.update[c]):f&&(a[c]=lt(f)),f&&(n.encode.update[c]={value:0})}const u=[];if(((t=e.stack.groupbyChannels)===null||t===void 0?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=V(f);d&&u.push(d),((f==null?void 0:f.bin)||(f==null?void 0:f.timeUnit))&&u.push(V(f,{binSuffix:"end"}))}return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(n.encode.update[f])return Object.assign(Object.assign({},c),{[f]:n.encode.update[f]});{const d=vu(f,e.markDef,e.config);return d!==void 0?Object.assign(Object.assign({},c),{[f]:lt(d)}):c}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(at.Main),name:U6+e.requestDataName(at.Main),groupby:u,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}function mme(e){var t;const{encoding:n,stack:i,mark:r,markDef:o,config:a}=e,s=n.order;if(!(!P(s)&&xr(s)&&dE(s.value)||!s&&dE(He("order",o,a)))){if((P(s)||G(s))&&!i)return Z$(s,{expr:"datum"});if(ls(r)){const u=o.orient==="horizontal"?"y":"x",l=n[u];if(G(l)){const c=l.sort;if(P(c))return{field:V(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(lo(c))return{field:V({aggregate:hO(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(XL(c)){const f=e.fieldDef(c.encoding);return{field:V(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:V(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function bS(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,a=At(i.clip,yme(e),vme(e)),s=J$(i),u=r.key,l=mme(e),c=bme(e),f=He("aria",i,o),d=M1[n].postEncodingTransform?M1[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:M1[n].vgMark},a?{clip:!0}:{}),s?{style:s}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(at.Main)},encode:{update:M1[n].encodeEntry(e)}}),d?{transform:d}:{})]}function yme(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return(t==null?void 0:t.get("selectionExtent"))||(n==null?void 0:n.get("selectionExtent"))?!0:void 0}function vme(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function bme(e){if(!e.component.selection)return null;const t=U(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=U(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class q6 extends j6{constructor(t,n,i,r={},o){var a;super(t,"unit",n,i,o,void 0,jI(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=uo(t.mark)?Object.assign({},t.mark):{type:t.mark},u=s.type;s.filled===void 0&&(s.filled=Vpe(s,o,{graticule:t.data&&RO(t.data)}));const l=this.encoding=Xce(t.encoding||{},u,s.filled,o);this.markDef=Wpe(s,l,o),this.size=qpe({encoding:l,size:jI(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=qI(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((a=t.params)!==null&&a!==void 0?a:[]).filter(c=>EO(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===$L,i=t&&Hse.some(r=>ye(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return N0.reduce((i,r)=>{var o;const a=$t(n[r]);return a&&(i[r]=this.initScale((o=a.scale)!==null&&o!==void 0?o:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=si(t);return P(n)&&(r.domain=n.map(Ai)),P(i)&&(r.range=i.map(Ai)),r}initAxes(t){return ao.reduce((n,i)=>{const r=t[i];if(ye(r)||i===pt&&ye(t.x2)||i===Wt&&ye(t.y2)){const o=ye(r)?r.axis:void 0;n[i]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=U(t),i={};for(const r of n){const o=t[r];i[r]=vh(o)?Y$(o):Ai(o)}return i}initLegends(t){return tue.reduce((n,i)=>{const r=$t(t[i]);if(r&&iue(i)){const o=r.legend;n[i]=o&&si(o)}return n},{})}parseData(){this.component.data=D1(this)}parseLayoutSize(){Ape(this)}parseSelections(){this.component.selection=che(this,this.selection)}parseMarkGroup(){this.component.mark=hme(this)}parseAxesAndHeaders(){this.component.axes=jpe(this)}assembleSelectionTopLevelSignals(t){return Dde(this,t)}assembleSignals(){return[...PP(this),...Tde(this,[])]}assembleSelectionData(t){return Mde(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return JO(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!Dc(this.parent))&&(n=fP(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Ou(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return ho(n)}typedFieldDef(t){const n=this.fieldDef(t);return qi(n)?n:null}}class xS extends gS{constructor(t,n,i,r,o){super(t,"layer",n,i,o,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(u1(s))return new xS(s,this,this.getName(`layer_${u}`),a,o);if(Zo(s))return new q6(s,this,this.getName(`layer_${u}`),a,o);throw new Error(TE(s))})}parseData(){this.component.data=D1(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Ope(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){Lpe(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),PP(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),JO(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of J(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return Nde(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),u6(this))}}function wS(e,t,n,i,r){if(G0(e))return new Dh(e,t,n,r);if(u1(e))return new xS(e,t,n,i,r);if(Zo(e))return new q6(e,t,n,i,r);if(xfe(e))return new Dpe(e,t,n,r);throw new Error(TE(e))}var xme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function wme(e,t={}){t.logger&&Ole(t.logger),t.fieldTitle&&oI(t.fieldTitle);try{const n=BI(il(t.config,e.config)),i=rP(e,n),r=wS(i,null,"",void 0,n);return r.parse(),Nge(r.component.data,r),{spec:Eme(r,_me(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&Sle(),t.fieldTitle&&Pce()}}function _me(e,t,n,i){const r=i.component.layoutSize.get("width"),o=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):K(t)&&(t={type:t}),r&&o&&Ode(t.type)){if(r==="step"&&o==="step")q(oL()),t.type="pad";else if(r==="step"||o==="step"){const a=r==="step"?"width":"height";q(oL(M0(a)));const s=a==="width"?"height":"width";t.type=Sde(s)}}return Object.assign(Object.assign(Object.assign({},U(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),aP(n,!1)),aP(e,!0))}function Eme(e,t,n={},i){const r=e.config?jfe(e.config):void 0,o=[].concat(e.assembleSelectionData([]),xpe(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=xme(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...NI(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const Ome=jse.version;var Sme=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Ome,compile:wme,normalize:rP,deepEqual:Qr,duplicate:be,never:S$,pick:ac,omit:Si,stringify:rt,hash:De,isNullOrFalse:dE,contains:Me,some:du,every:hE,mergeDeep:A$,unique:Zr,isEqual:Pse,setEqual:k$,hasIntersection:gE,prefixGenerator:pE,fieldIntersection:mE,isEmpty:Ze,keys:U,vals:En,entries:Qa,isBoolean:ih,varName:ht,logicalExpr:rh,deleteNestedProperty:S0,titleCase:oh,accessPathWithDatum:yE,flatAccessWithDatum:C$,replacePathInField:zi,replaceAll:hu,removePathFromField:vE,accessPathDepth:sc,getFirstDefined:At,uniqueId:F$,resetIdCounter:Bse,internalField:D$,isInternalField:M$,normalizeAngle:ah,isNumeric:A0});function W6(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var Ame="vega-themes",kme="2.10.0",Cme="Themes for stylized Vega and Vega-Lite visualizations.",Tme=["vega","vega-lite","themes","style"],Fme="BSD-3-Clause",Dme={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},Mme=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],Nme="build/vega-themes.js",Rme="build/vega-themes.module.js",jme="build/vega-themes.min.js",$me="build/vega-themes.min.js",Lme="build/vega-themes.module.d.ts",Ime={type:"git",url:"https://github.com/vega/vega-themes.git"},Pme=["src","build"],zme={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},Bme={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},Ume={vega:"*","vega-lite":"*"},qme={name:Ame,version:kme,description:Cme,keywords:Tme,license:Fme,author:Dme,contributors:Mme,main:Nme,module:Rme,unpkg:jme,jsdelivr:$me,types:Lme,repository:Ime,files:Pme,scripts:zme,devDependencies:Bme,peerDependencies:Ume};const Nc="#fff",Wme="#888",Hme={background:"#333",title:{color:Nc,subtitleColor:Nc},style:{"guide-label":{fill:Nc},"guide-title":{fill:Nc}},axis:{domainColor:Nc,gridColor:Wme,tickColor:Nc}},Fu="#4572a7",Gme={background:"#fff",arc:{fill:Fu},area:{fill:Fu},line:{stroke:Fu,strokeWidth:2},path:{stroke:Fu},rect:{fill:Fu},shape:{stroke:Fu},symbol:{fill:Fu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Du="#30a2da",_S="#cbcbcb",Vme="#999",Yme="#333",H6="#f0f0f0",G6="#333",Xme={arc:{fill:Du},area:{fill:Du},axis:{domainColor:_S,grid:!0,gridColor:_S,gridWidth:1,labelColor:Vme,labelFontSize:10,titleColor:Yme,tickColor:_S,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:H6,group:{fill:H6},legend:{labelColor:G6,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:G6,titleFontSize:14,titlePadding:10},line:{stroke:Du,strokeWidth:2},path:{stroke:Du,strokeWidth:.5},rect:{fill:Du},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Du},bar:{binSpacing:2,fill:Du,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Mu="#000",Kme={group:{fill:"#e5e5e5"},arc:{fill:Mu},area:{fill:Mu},line:{stroke:Mu},path:{stroke:Mu},rect:{fill:Mu},shape:{stroke:Mu},symbol:{fill:Mu,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Jme=22,Qme="normal",V6="Benton Gothic, sans-serif",Y6=11.5,Zme="normal",Nu="#82c6df",ES="Benton Gothic Bold, sans-serif",X6="normal",K6=13,Mh={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},e0e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:ES,fontSize:Jme,fontWeight:Qme},arc:{fill:Nu},area:{fill:Nu},line:{stroke:Nu,strokeWidth:2},path:{stroke:Nu},rect:{fill:Nu},shape:{stroke:Nu},symbol:{fill:Nu,size:30},axis:{labelFont:V6,labelFontSize:Y6,labelFontWeight:Zme,titleFont:ES,titleFontSize:K6,titleFontWeight:X6},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:V6,labelFontSize:Y6,symbolType:"square",titleFont:ES,titleFontSize:K6,titleFontWeight:X6},range:{category:Mh["category-6"],diverging:Mh["fireandice-6"],heatmap:Mh["fire-7"],ordinal:Mh["fire-7"],ramp:Mh["fire-7"]}},Ru="#ab5787",N1="#979797",t0e={background:"#f9f9f9",arc:{fill:Ru},area:{fill:Ru},line:{stroke:Ru},path:{stroke:Ru},rect:{fill:Ru},shape:{stroke:Ru},symbol:{fill:Ru,size:30},axis:{domainColor:N1,domainWidth:.5,gridWidth:.2,labelColor:N1,tickColor:N1,tickWidth:.2,titleColor:N1},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},ju="#3e5c69",n0e={background:"#fff",arc:{fill:ju},area:{fill:ju},line:{stroke:ju},path:{stroke:ju},rect:{fill:ju},shape:{stroke:ju},symbol:{fill:ju},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Hi="#1696d2",J6="#000000",i0e="#FFFFFF",R1="Lato",OS="Lato",r0e="Lato",o0e="#DEDDDD",a0e=18,Nh={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},s0e={background:i0e,title:{anchor:"start",fontSize:a0e,font:R1},axisX:{domain:!0,domainColor:J6,domainWidth:1,grid:!1,labelFontSize:12,labelFont:OS,labelAngle:0,tickColor:J6,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:R1},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:o0e,gridWidth:1,labelFontSize:12,labelFont:OS,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:R1,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:OS,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:R1,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Nh["six-groups-cat-1"],diverging:Nh["diverging-colors"],heatmap:Nh["diverging-colors"],ordinal:Nh["six-groups-seq"],ramp:Nh["shades-blue"]},area:{fill:Hi},rect:{fill:Hi},line:{color:Hi,stroke:Hi,strokeWidth:5},trail:{color:Hi,stroke:Hi,strokeWidth:0,size:1},path:{stroke:Hi,strokeWidth:.5},point:{filled:!0},text:{font:r0e,color:Hi,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Hi,stroke:null}},arc:{fill:Hi},shape:{stroke:Hi},symbol:{fill:Hi,size:30}},$u="#3366CC",Q6="#ccc",j1="Arial, sans-serif",u0e={arc:{fill:$u},area:{fill:$u},path:{stroke:$u},rect:{fill:$u},shape:{stroke:$u},symbol:{stroke:$u},circle:{fill:$u},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:j1,fontSize:12},"guide-title":{font:j1,fontSize:12},"group-title":{font:j1,fontSize:12}},title:{font:j1,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Q6,tickColor:Q6,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},l0e=qme.version;var c0e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:Hme,excel:Gme,fivethirtyeight:Xme,ggplot2:Kme,googlecharts:u0e,latimes:e0e,quartz:t0e,urbaninstitute:s0e,version:l0e,vox:n0e});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function f0e(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function d0e(e,t,n){if(P(e))return`[${e.map(i=>t(K(i)?i:Z6(i,n))).join(", ")}]`;if(Q(e)){let i="";const r=e,{title:o,image:a}=r,s=f0e(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),a&&(i+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){i+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Q(c)&&(c=Z6(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function h0e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function Z6(e,t){return JSON.stringify(e,h0e(t))}var g0e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const e4="vg-tooltip-element",p0e={offsetX:10,offsetY:10,id:e4,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:m0e,maxDepth:2,formatTooltip:d0e};function m0e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function y0e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return g0e.toString().replace(e4,e)}function v0e(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}class b0e{constructor(t){this.options=Object.assign(Object.assign({},p0e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=y0e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((o=document.fullscreenElement)!==null&&o!==void 0?o:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:u}=v0e(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${s}px`)}}function x0e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t4(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(l){n(l);return}s.done?t(u):Promise.resolve(u).then(i,r)}function $1(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(u){t4(o,i,r,a,s,"next",u)}function s(u){t4(o,i,r,a,s,"throw",u)}a(void 0)})}}var n4=Object.prototype,Lu=n4.hasOwnProperty,vo,SS=typeof Symbol=="function"?Symbol:{},L1=SS.iterator||"@@iterator",w0e=SS.asyncIterator||"@@asyncIterator",I1=SS.toStringTag||"@@toStringTag";function i4(e,t,n,i){var r=t&&t.prototype instanceof kS?t:kS,o=Object.create(r.prototype),a=new DS(i||[]);return o._invoke=A0e(e,n,a),o}function AS(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var r4="suspendedStart",_0e="suspendedYield",o4="executing",P1="completed",Or={};function kS(){}function z1(){}function Rc(){}var CS={};CS[L1]=function(){return this};var TS=Object.getPrototypeOf,B1=TS&&TS(TS(MS([])));B1&&B1!==n4&&Lu.call(B1,L1)&&(CS=B1);var jc=Rc.prototype=kS.prototype=Object.create(CS);z1.prototype=jc.constructor=Rc;Rc.constructor=z1;Rc[I1]=z1.displayName="GeneratorFunction";function a4(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function s4(e){var t=typeof e=="function"&&e.constructor;return t?t===z1||(t.displayName||t.name)==="GeneratorFunction":!1}function E0e(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,Rc):(e.__proto__=Rc,I1 in e||(e[I1]="GeneratorFunction")),e.prototype=Object.create(jc),e}function O0e(e){return{__await:e}}function U1(e,t){function n(o,a,s,u){var l=AS(e[o],e,a);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&Lu.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,s,u)},function(d){n("throw",d,s,u)}):t.resolve(f).then(function(d){c.value=d,s(c)},function(d){return n("throw",d,s,u)})}}var i;function r(o,a){function s(){return new t(function(u,l){n(o,a,u,l)})}return i=i?i.then(s,s):s()}this._invoke=r}a4(U1.prototype);U1.prototype[w0e]=function(){return this};function S0e(e,t,n,i,r){r===void 0&&(r=Promise);var o=new U1(i4(e,t,n,i),r);return s4(t)?o:o.next().then(function(a){return a.done?a.value:o.next()})}function A0e(e,t,n){var i=r4;return function(o,a){if(i===o4)throw new Error("Generator is already running");if(i===P1){if(o==="throw")throw a;return l4()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=u4(s,n);if(u){if(u===Or)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===r4)throw i=P1,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=o4;var l=AS(e,t,n);if(l.type==="normal"){if(i=n.done?P1:_0e,l.arg===Or)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=P1,n.method="throw",n.arg=l.arg)}}}function u4(e,t){var n=e.iterator[t.method];if(n===vo){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=vo,u4(e,t),t.method==="throw"))return Or;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Or}var i=AS(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,Or;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Or;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=vo);else return r;return t.delegate=null,Or}a4(jc);jc[I1]="Generator";jc[L1]=function(){return this};jc.toString=function(){return"[object Generator]"};function k0e(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function FS(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function DS(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k0e,this),this.reset(!0)}function C0e(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function MS(e){if(e){var t=e[L1];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(Lu.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=vo,r.done=!0,r};return i.next=i}}return{next:l4}}function l4(){return{value:vo,done:!0}}DS.prototype={constructor:DS,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=vo,this.done=!1,this.delegate=null,this.method="next",this.arg=vo,this.tryEntries.forEach(FS),!t)for(var n in this)n.charAt(0)==="t"&&Lu.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=vo)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return a.type="throw",a.arg=t,n.next=l,c&&(n.method="next",n.arg=vo),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if(o.tryLoc==="root")return i("end");if(o.tryLoc<=this.prev){var s=Lu.call(o,"catchLoc"),u=Lu.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&Lu.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,Or):this.complete(a)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),Or},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),FS(i),Or}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var o=r.arg;FS(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:MS(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=vo),Or}};var bo={wrap:i4,isGeneratorFunction:s4,AsyncIterator:U1,mark:E0e,awrap:O0e,async:S0e,keys:C0e,values:MS},T0e=ze;ze.Node=Iu;ze.create=ze;function ze(e){var t=this;if(t instanceof ze||(t=new ze),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}ze.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};ze.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};ze.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};ze.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)D0e(this,arguments[e]);return this.length};ze.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)M0e(this,arguments[e]);return this.length};ze.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};ze.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};ze.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next};ze.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev};ze.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};ze.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};ze.prototype.map=function(e,t){t=t||this;for(var n=new ze,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n};ze.prototype.mapReverse=function(e,t){t=t||this;for(var n=new ze,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n};ze.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n};ze.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n};ze.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};ze.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};ze.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ze;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n};ze.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ze;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n};ze.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var r=[],n=0;i&&n<t;n++)r.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<(arguments.length<=2?0:arguments.length-2);n++)i=F0e(this,i,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return r};ze.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function F0e(e,t,n){var i=t===e.head?new Iu(n,null,t,e):new Iu(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function D0e(e,t){e.tail=new Iu(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function M0e(e,t){e.head=new Iu(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Iu(e,t,n,i){if(!(this instanceof Iu))return new Iu(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{ze.prototype[Symbol.iterator]=bo.mark(function e(){var t;return bo.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=this.head;case 1:if(!t){i.next=7;break}return i.next=4,t.value;case 4:t=t.next,i.next=1;break;case 7:case"end":return i.stop()}},e,this)})}catch{}var N0e=T0e,Pu=Symbol("max"),ia=Symbol("length"),$c=Symbol("lengthCalculator"),Rh=Symbol("allowStale"),zu=Symbol("maxAge"),ra=Symbol("dispose"),c4=Symbol("noDisposeOnSet"),Vt=Symbol("lruList"),Sr=Symbol("cache"),f4=Symbol("updateAgeOnGet"),NS=()=>1;class R0e{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Pu]=t.max||1/0;var n=t.length||NS;if(this[$c]=typeof n!="function"?NS:n,this[Rh]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[zu]=t.maxAge||0,this[ra]=t.dispose,this[c4]=t.noDisposeOnSet||!1,this[f4]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Pu]=t||1/0,jh(this)}get max(){return this[Pu]}set allowStale(t){this[Rh]=!!t}get allowStale(){return this[Rh]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[zu]=t,jh(this)}get maxAge(){return this[zu]}set lengthCalculator(t){typeof t!="function"&&(t=NS),t!==this[$c]&&(this[$c]=t,this[ia]=0,this[Vt].forEach(n=>{n.length=this[$c](n.value,n.key),this[ia]+=n.length})),jh(this)}get lengthCalculator(){return this[$c]}get length(){return this[ia]}get itemCount(){return this[Vt].length}rforEach(t,n){n=n||this;for(var i=this[Vt].tail;i!==null;){var r=i.prev;d4(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(var i=this[Vt].head;i!==null;){var r=i.next;d4(this,t,i,n),i=r}}keys(){return this[Vt].toArray().map(t=>t.key)}values(){return this[Vt].toArray().map(t=>t.value)}reset(){this[ra]&&this[Vt]&&this[Vt].length&&this[Vt].forEach(t=>this[ra](t.key,t.value)),this[Sr]=new Map,this[Vt]=new N0e,this[ia]=0}dump(){return this[Vt].map(t=>q1(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Vt]}set(t,n,i){if(i=i||this[zu],i&&typeof i!="number")throw new TypeError("maxAge must be a number");var r=i?Date.now():0,o=this[$c](n,t);if(this[Sr].has(t)){if(o>this[Pu])return Lc(this,this[Sr].get(t)),!1;var a=this[Sr].get(t),s=a.value;return this[ra]&&(this[c4]||this[ra](t,s.value)),s.now=r,s.maxAge=i,s.value=n,this[ia]+=o-s.length,s.length=o,this.get(t),jh(this),!0}var u=new j0e(t,n,o,r,i);return u.length>this[Pu]?(this[ra]&&this[ra](t,n),!1):(this[ia]+=u.length,this[Vt].unshift(u),this[Sr].set(t,this[Vt].head),jh(this),!0)}has(t){if(!this[Sr].has(t))return!1;var n=this[Sr].get(t).value;return!q1(this,n)}get(t){return RS(this,t,!0)}peek(t){return RS(this,t,!1)}pop(){var t=this[Vt].tail;return t?(Lc(this,t),t.value):null}del(t){Lc(this,this[Sr].get(t))}load(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],o=r.e||0;if(o===0)this.set(r.k,r.v);else{var a=o-n;a>0&&this.set(r.k,r.v,a)}}}prune(){this[Sr].forEach((t,n)=>RS(this,n,!1))}}var RS=(e,t,n)=>{var i=e[Sr].get(t);if(i){var r=i.value;if(q1(e,r)){if(Lc(e,i),!e[Rh])return}else n&&(e[f4]&&(i.value.now=Date.now()),e[Vt].unshiftNode(i));return r.value}},q1=(e,t)=>{if(!t||!t.maxAge&&!e[zu])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[zu]&&n>e[zu]},jh=e=>{if(e[ia]>e[Pu])for(var t=e[Vt].tail;e[ia]>e[Pu]&&t!==null;){var n=t.prev;Lc(e,t),t=n}},Lc=(e,t)=>{if(t){var n=t.value;e[ra]&&e[ra](n.key,n.value),e[ia]-=n.length,e[Sr].delete(n.key),e[Vt].removeNode(t)}};class j0e{constructor(t,n,i,r,o){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=o||0}}var d4=(e,t,n,i)=>{var r=n.value;q1(e,r)&&(Lc(e,n),e[Rh]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},$0e=R0e,L0e=["includePrerelease","loose","rtl"],I0e=e=>e?typeof e!="object"?{loose:!0}:L0e.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},jS=I0e,Ar={exports:{}},P0e="2.0.0",z0e=256,B0e=Number.MAX_SAFE_INTEGER||9007199254740991,U0e=16,$S={SEMVER_SPEC_VERSION:P0e,MAX_LENGTH:z0e,MAX_SAFE_INTEGER:B0e,MAX_SAFE_COMPONENT_LENGTH:U0e},q0e=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},W1=q0e;(function(e,t){var n=$S.MAX_SAFE_COMPONENT_LENGTH,i=W1;t=e.exports={};var r=t.re=[],o=t.src=[],a=t.t={},s=0,u=(l,c,f)=>{var d=s++;i(d,c),a[l]=d,o[d]=c,r[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION","(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")")),u("MAINVERSIONLOOSE","(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")")),u("PRERELEASEIDENTIFIER","(?:".concat(o[a.NUMERICIDENTIFIER],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[a.NUMERICIDENTIFIERLOOSE],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASE","(?:-(".concat(o[a.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIER],")*))")),u("PRERELEASELOOSE","(?:-?(".concat(o[a.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIERLOOSE],")*))")),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD","(?:\\+(".concat(o[a.BUILDIDENTIFIER],"(?:\\.").concat(o[a.BUILDIDENTIFIER],")*))")),u("FULLPLAIN","v?".concat(o[a.MAINVERSION]).concat(o[a.PRERELEASE],"?").concat(o[a.BUILD],"?")),u("FULL","^".concat(o[a.FULLPLAIN],"$")),u("LOOSEPLAIN","[v=\\s]*".concat(o[a.MAINVERSIONLOOSE]).concat(o[a.PRERELEASELOOSE],"?").concat(o[a.BUILD],"?")),u("LOOSE","^".concat(o[a.LOOSEPLAIN],"$")),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE","".concat(o[a.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),u("XRANGEIDENTIFIER","".concat(o[a.NUMERICIDENTIFIER],"|x|X|\\*")),u("XRANGEPLAIN","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:".concat(o[a.PRERELEASE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[a.PRERELEASELOOSE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAIN],"$")),u("XRANGELOOSE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAINLOOSE],"$")),u("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM","(\\s*)".concat(o[a.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",u("TILDE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAIN],"$")),u("TILDELOOSE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("LONECARET","(?:\\^)"),u("CARETTRIM","(\\s*)".concat(o[a.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",u("CARET","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAIN],"$")),u("CARETLOOSE","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("COMPARATORLOOSE","^".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],")$|^$")),u("COMPARATOR","^".concat(o[a.GTLT],"\\s*(").concat(o[a.FULLPLAIN],")$|^$")),u("COMPARATORTRIM","(\\s*)".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],"|").concat(o[a.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE","^\\s*(".concat(o[a.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAIN],")")+"\\s*$"),u("HYPHENRANGELOOSE","^\\s*(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s*$"),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Ar,Ar.exports);var h4=/^[0-9]+$/,g4=(e,t)=>{var n=h4.test(e),i=h4.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},W0e=(e,t)=>g4(t,e),H0e={compareIdentifiers:g4,rcompareIdentifiers:W0e},H1=W1,p4=$S.MAX_LENGTH,G1=$S.MAX_SAFE_INTEGER,m4=Ar.exports.re,y4=Ar.exports.t,G0e=jS,$h=H0e.compareIdentifiers;class kr{constructor(t,n){if(n=G0e(n),t instanceof kr){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: ".concat(t));if(t.length>p4)throw new TypeError("version is longer than ".concat(p4," characters"));H1("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?m4[y4.LOOSE]:m4[y4.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>G1||this.major<0)throw new TypeError("Invalid major version");if(this.minor>G1||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>G1||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){var o=+r;if(o>=0&&o<G1)return o}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(H1("SemVer.compare",this.version,this.options,t),!(t instanceof kr)){if(typeof t=="string"&&t===this.version)return 0;t=new kr(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof kr||(t=new kr(t,this.options)),$h(this.major,t.major)||$h(this.minor,t.minor)||$h(this.patch,t.patch)}comparePre(t){if(t instanceof kr||(t=new kr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var i=this.prerelease[n],r=t.prerelease[n];if(H1("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return $h(i,r)}while(++n)}compareBuild(t){t instanceof kr||(t=new kr(t,this.options));var n=0;do{var i=this.build[n],r=t.build[n];if(H1("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return $h(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var LS=kr,v4=LS,V0e=(e,t,n)=>new v4(e,n).compare(new v4(t,n)),Ic=V0e,Y0e=Ic,X0e=(e,t,n)=>Y0e(e,t,n)===0,K0e=X0e,J0e=Ic,Q0e=(e,t,n)=>J0e(e,t,n)!==0,Z0e=Q0e,e1e=Ic,t1e=(e,t,n)=>e1e(e,t,n)>0,n1e=t1e,i1e=Ic,r1e=(e,t,n)=>i1e(e,t,n)>=0,o1e=r1e,a1e=Ic,s1e=(e,t,n)=>a1e(e,t,n)<0,u1e=s1e,l1e=Ic,c1e=(e,t,n)=>l1e(e,t,n)<=0,f1e=c1e,d1e=K0e,h1e=Z0e,g1e=n1e,p1e=o1e,m1e=u1e,y1e=f1e,v1e=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return d1e(e,n,i);case"!=":return h1e(e,n,i);case">":return g1e(e,n,i);case">=":return p1e(e,n,i);case"<":return m1e(e,n,i);case"<=":return y1e(e,n,i);default:throw new TypeError("Invalid operator: ".concat(t))}},b1e=v1e,Lh=Symbol("SemVer ANY");class V1{static get ANY(){return Lh}constructor(t,n){if(n=w1e(n),t instanceof V1){if(t.loose===!!n.loose)return t;t=t.value}PS("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Lh?this.value="":this.value=this.operator+this.semver.version,PS("comp",this)}parse(t){var n=this.options.loose?b4[x4.COMPARATORLOOSE]:b4[x4.COMPARATOR],i=t.match(n);if(!i)throw new TypeError("Invalid comparator: ".concat(t));this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new w4(i[2],this.options.loose):this.semver=Lh}toString(){return this.value}test(t){if(PS("Comparator.test",t,this.options.loose),this.semver===Lh||t===Lh)return!0;if(typeof t=="string")try{t=new w4(t,this.options)}catch{return!1}return IS(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof V1))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new _4(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new _4(this.value,n).test(t.semver);var i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=IS(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=IS(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||o&&a||s||u}}var x1e=V1,w1e=jS,b4=Ar.exports.re,x4=Ar.exports.t,IS=b1e,PS=W1,w4=LS,_4=S4;function E4(e,t){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_1e(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,a=!1,s;return{s:function(){n=n.call(e)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(a)throw s}}}}function _1e(e,t){if(!!e){if(typeof e=="string")return O4(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O4(e,t)}}function O4(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}class Ih{constructor(t,n){if(n=O1e(n),t instanceof Ih)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Ih(t.raw,n);if(t instanceof zS)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter(s=>!k4(s[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){var r=E4(this.set),o;try{for(r.s();!(o=r.n()).done;){var a=o.value;if(a.length===1&&T1e(a[0])){this.set=[a];break}}}catch(s){r.e(s)}finally{r.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(t),r=A4.get(i);if(r)return r;var o=this.options.loose,a=o?An[on.HYPHENRANGELOOSE]:An[on.HYPHENRANGE];t=t.replace(a,P1e(this.options.includePrerelease)),Et("hyphen replace",t),t=t.replace(An[on.COMPARATORTRIM],A1e),Et("comparator trim",t,An[on.COMPARATORTRIM]),t=t.replace(An[on.TILDETRIM],k1e),t=t.replace(An[on.CARETTRIM],C1e),t=t.split(/\s+/).join(" ");var s=o?An[on.COMPARATORLOOSE]:An[on.COMPARATOR],u=t.split(" ").map(g=>F1e(g,this.options)).join(" ").split(/\s+/).map(g=>I1e(g,this.options)).filter(this.options.loose?g=>!!g.match(s):()=>!0).map(g=>new zS(g,this.options));u.length;var l=new Map,c=E4(u),f;try{for(c.s();!(f=c.n()).done;){var d=f.value;if(k4(d))return[d];l.set(d.value,d)}}catch(g){c.e(g)}finally{c.f()}l.size>1&&l.has("")&&l.delete("");var h=[...l.values()];return A4.set(i,h),h}intersects(t,n){if(!(t instanceof Ih))throw new TypeError("a Range is required");return this.set.some(i=>C4(i,n)&&t.set.some(r=>C4(r,n)&&i.every(o=>r.every(a=>o.intersects(a,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new S1e(t,this.options)}catch{return!1}for(var n=0;n<this.set.length;n++)if(z1e(this.set[n],t,this.options))return!0;return!1}}var S4=Ih,E1e=$0e,A4=new E1e({max:1e3}),O1e=jS,zS=x1e,Et=W1,S1e=LS,An=Ar.exports.re,on=Ar.exports.t,A1e=Ar.exports.comparatorTrimReplace,k1e=Ar.exports.tildeTrimReplace,C1e=Ar.exports.caretTrimReplace,k4=e=>e.value==="<0.0.0-0",T1e=e=>e.value==="",C4=(e,t)=>{for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every(o=>r.intersects(o,t)),r=i.pop();return n},F1e=(e,t)=>(Et("comp",e,t),e=N1e(e,t),Et("caret",e),e=D1e(e,t),Et("tildes",e),e=j1e(e,t),Et("xrange",e),e=L1e(e,t),Et("stars",e),e),Wn=e=>!e||e.toLowerCase()==="x"||e==="*",D1e=(e,t)=>e.trim().split(/\s+/).map(n=>M1e(n,t)).join(" "),M1e=(e,t)=>{var n=t.loose?An[on.TILDELOOSE]:An[on.TILDE];return e.replace(n,(i,r,o,a,s)=>{Et("tilde",e,i,r,o,a,s);var u;return Wn(r)?u="":Wn(o)?u=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):Wn(a)?u=">=".concat(r,".").concat(o,".0 <").concat(r,".").concat(+o+1,".0-0"):s?(Et("replaceTilde pr",s),u=">=".concat(r,".").concat(o,".").concat(a,"-").concat(s," <").concat(r,".").concat(+o+1,".0-0")):u=">=".concat(r,".").concat(o,".").concat(a," <").concat(r,".").concat(+o+1,".0-0"),Et("tilde return",u),u})},N1e=(e,t)=>e.trim().split(/\s+/).map(n=>R1e(n,t)).join(" "),R1e=(e,t)=>{Et("caret",e,t);var n=t.loose?An[on.CARETLOOSE]:An[on.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,o,a,s,u)=>{Et("caret",e,r,o,a,s,u);var l;return Wn(o)?l="":Wn(a)?l=">=".concat(o,".0.0").concat(i," <").concat(+o+1,".0.0-0"):Wn(s)?o==="0"?l=">=".concat(o,".").concat(a,".0").concat(i," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".0").concat(i," <").concat(+o+1,".0.0-0"):u?(Et("replaceCaret pr",u),o==="0"?a==="0"?l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(o,".").concat(a,".").concat(+s+1,"-0"):l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(+o+1,".0.0-0")):(Et("no pr"),o==="0"?a==="0"?l=">=".concat(o,".").concat(a,".").concat(s).concat(i," <").concat(o,".").concat(a,".").concat(+s+1,"-0"):l=">=".concat(o,".").concat(a,".").concat(s).concat(i," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".").concat(s," <").concat(+o+1,".0.0-0")),Et("caret return",l),l})},j1e=(e,t)=>(Et("replaceXRanges",e,t),e.split(/\s+/).map(n=>$1e(n,t)).join(" ")),$1e=(e,t)=>{e=e.trim();var n=t.loose?An[on.XRANGELOOSE]:An[on.XRANGE];return e.replace(n,(i,r,o,a,s,u)=>{Et("xRange",e,i,r,o,a,s,u);var l=Wn(o),c=l||Wn(a),f=c||Wn(s),d=f;return r==="="&&d&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&d?(c&&(a=0),s=0,r===">"?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):r==="<="&&(r="<",c?o=+o+1:a=+a+1),r==="<"&&(u="-0"),i="".concat(r+o,".").concat(a,".").concat(s).concat(u)):c?i=">=".concat(o,".0.0").concat(u," <").concat(+o+1,".0.0-0"):f&&(i=">=".concat(o,".").concat(a,".0").concat(u," <").concat(o,".").concat(+a+1,".0-0")),Et("xRange return",i),i})},L1e=(e,t)=>(Et("replaceStars",e,t),e.trim().replace(An[on.STAR],"")),I1e=(e,t)=>(Et("replaceGTE0",e,t),e.trim().replace(An[t.includePrerelease?on.GTE0PRE:on.GTE0],"")),P1e=e=>(t,n,i,r,o,a,s,u,l,c,f,d,h)=>(Wn(i)?n="":Wn(r)?n=">=".concat(i,".0.0").concat(e?"-0":""):Wn(o)?n=">=".concat(i,".").concat(r,".0").concat(e?"-0":""):a?n=">=".concat(n):n=">=".concat(n).concat(e?"-0":""),Wn(l)?u="":Wn(c)?u="<".concat(+l+1,".0.0-0"):Wn(f)?u="<".concat(l,".").concat(+c+1,".0-0"):d?u="<=".concat(l,".").concat(c,".").concat(f,"-").concat(d):e?u="<".concat(l,".").concat(c,".").concat(+f+1,"-0"):u="<=".concat(u),"".concat(n," ").concat(u).trim()),z1e=(e,t,n)=>{for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++)if(Et(e[r].semver),e[r].semver!==zS.ANY&&e[r].semver.prerelease.length>0){var o=e[r].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0},B1e=S4,U1e=(e,t,n)=>{try{t=new B1e(t,n)}catch{return!1}return t.test(e)},T4=U1e;function q1e(e,t,n){var i=e.open(t),r=1e4,o=250,a=new URL(t),s=a.origin,u=~~(r/o);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,s),setTimeout(c,o),u-=1)}setTimeout(c,o)}var W1e=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  outline: none;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid #0000;
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid #0000;
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function F4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r];H1e(e,a)}return e}function H1e(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];rl(e,r,t[r],!0)}}var BS;function D4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function bs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D4(Object(n),!0).forEach(function(i){x0e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D4(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var xs=nse,Ph=Sme,Y1=typeof window!="undefined"?window:void 0;Ph===void 0&&Y1!==null&&Y1!==void 0&&(BS=Y1.vl)!==null&&BS!==void 0&&BS.compile&&(Ph=Y1.vl);var G1e={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},V1e={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},zh={vega:"Vega","vega-lite":"Vega-Lite"},X1={vega:xs.version,"vega-lite":Ph?Ph.version:"not available"},Y1e={vega:e=>e,"vega-lite":(e,t)=>Ph.compile(e,{config:t}).spec},X1e=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,K1e="chart-wrapper";function J1e(e){return typeof e=="function"}function M4(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(r+e+o),a.document.title="".concat(zh[i]," JSON Source")}function Q1e(e,t){if(e.$schema){var n=W6(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(zh[n.library],", but mode argument sets ").concat((i=zh[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return T4(X1[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(zh[r]," ").concat(n.version,", but the current version of ").concat(zh[r]," is v").concat(X1[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function Z1e(e){return!!(e&&"load"in e)}function N4(e){return Z1e(e)?e:xs.loader(e)}function R4(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function abe(e,t){return US.apply(this,arguments)}function US(){return US=$1(bo.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h=arguments;return bo.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!K(n)){p.next=10;break}return s=N4(o.loader),p.t0=JSON,p.next=6,s.load(n);case 6:p.t1=p.sent,a=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:a=n;case 11:return u=R4(a).loader,(!s||u)&&(s=N4((l=o.loader)!==null&&l!==void 0?l:u)),p.next=15,j4(R4(a),s);case 15:return c=p.sent,p.next=18,j4(o,s);case 18:return f=p.sent,d=bs(bs({},F4(f,c)),{},{config:il((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),p.next=22,tye(t,a,d,s);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),US.apply(this,arguments)}function j4(e,t){return qS.apply(this,arguments)}function qS(){return qS=$1(bo.mark(function e(t,n){var i,r,o;return bo.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!K(t.config)){s.next=8;break}return s.t1=JSON,s.next=4,n.load(t.config);case 4:s.t2=s.sent,s.t0=s.t1.parse.call(s.t1,s.t2),s.next=9;break;case 8:s.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=s.t0,!K(t.patch)){s.next=18;break}return s.t4=JSON,s.next=14,n.load(t.patch);case 14:s.t5=s.sent,s.t3=s.t4.parse.call(s.t4,s.t5),s.next=19;break;case 18:s.t3=t.patch;case 19:return o=s.t3,s.abrupt("return",bs(bs(bs({},t),o?{patch:o}:{}),r?{config:r}:{}));case 21:case"end":return s.stop()}},e)})),qS.apply(this,arguments)}function eye(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function tye(e,t){return WS.apply(this,arguments)}function WS(){return WS=$1(bo.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h,g,p,m,y,v,x,b,_,E,w,O,S,k,A,F,C,M,D,N,I,z,X,te,xe,ge,je,Oe,ke,Xe,xt,Ge,Y,ne,fe,B,Ve,pe,tt,qe=arguments;return bo.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(tt=function(){ge&&document.removeEventListener("click",ge),N.finalize()},c=qe.length>2&&qe[2]!==void 0?qe[2]:{},f=qe.length>3?qe[3]:void 0,d=c.theme?il(c0e[c.theme],(i=c.config)!==null&&i!==void 0?i:{}):c.config,h=ha(c.actions)?c.actions:F4({},G1e,(r=c.actions)!==null&&r!==void 0?r:{}),g=bs(bs({},V1e),c.i18n),p=(o=c.renderer)!==null&&o!==void 0?o:"canvas",m=(a=c.logLevel)!==null&&a!==void 0?a:xs.Warn,y=(s=c.downloadFileName)!==null&&s!==void 0?s:"visualization",v=typeof t=="string"?document.querySelector(t):t,v){me.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(x="vega-embed-style",b=eye(v),_=b.root,E=b.rootContainer,_.getElementById(x)||(w=document.createElement("style"),w.id=x,w.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?W1e.toString():c.defaultStyle,E.appendChild(w))),O=Q1e(n,c.mode),S=Y1e[O](n,d),O==="vega-lite"&&S.$schema&&(k=W6(S.$schema),T4(X1.vega,"^".concat(k.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(k.version,", but current version is v").concat(X1.vega,"."))),v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="",A=v,h&&(F=document.createElement("div"),F.classList.add(K1e),v.appendChild(F),A=F),C=c.patch,C&&(S=C instanceof Function?C(S):lg(S,C,!0,!1).newDocument),c.formatLocale&&xs.formatLocale(c.formatLocale),c.timeFormatLocale&&xs.timeFormatLocale(c.timeFormatLocale),M=c.ast,D=xs.parse(S,O==="vega-lite"?{}:d,{ast:M}),N=new(c.viewClass||xs.View)(D,bs({loader:f,logLevel:m,renderer:p},M?{expr:(u=(l=xs.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:dse}:{})),N.addSignalListener("autosize",(Ct,Ke)=>{var st=Ke.type;st=="fit-x"?(A.classList.add("fit-x"),A.classList.remove("fit-y")):st=="fit-y"?(A.classList.remove("fit-x"),A.classList.add("fit-y")):st=="fit"?A.classList.add("fit-x","fit-y"):A.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(I=J1e(c.tooltip)?c.tooltip:new b0e(c.tooltip===!0?{}:c.tooltip).call,N.tooltip(I)),z=c.hover,z===void 0&&(z=O==="vega"),z&&(X=typeof z=="boolean"?{}:z,te=X.hoverSet,xe=X.updateSet,N.hover(te,xe)),c&&(c.width!=null&&N.width(c.width),c.height!=null&&N.height(c.height),c.padding!=null&&N.padding(c.padding)),me.next=36,N.initialize(A,c.bind).runAsync();case 36:if(h!==!1){if(je=v,c.defaultStyle!==!1&&(Oe=document.createElement("details"),Oe.title=g.CLICK_TO_VIEW_ACTIONS,v.append(Oe),je=Oe,ke=document.createElement("summary"),ke.innerHTML=X1e,Oe.append(ke),ge=Ct=>{Oe.contains(Ct.target)||Oe.removeAttribute("open")},document.addEventListener("click",ge)),Xe=document.createElement("div"),je.append(Xe),Xe.classList.add("vega-actions"),h===!0||h.export!==!1)for(xt=function(){var Ke=Y[Ge];if(h===!0||h.export===!0||h.export[Ke]){var st=g["".concat(Ke.toUpperCase(),"_ACTION")],wt=document.createElement("a");wt.text=st,wt.href="#",wt.target="_blank",wt.download="".concat(y,".").concat(Ke),wt.addEventListener("mousedown",function(){var an=$1(bo.mark(function Yt(Xi){var nt;return bo.wrap(function(sn){for(;;)switch(sn.prev=sn.next){case 0:return Xi.preventDefault(),sn.next=3,N.toImageURL(Ke,c.scaleFactor);case 3:nt=sn.sent,this.href=nt;case 5:case"end":return sn.stop()}},Yt,this)}));return function(Yt){return an.apply(this,arguments)}}()),Xe.append(wt)}},Ge=0,Y=["svg","png"];Ge<Y.length;Ge++)xt();(h===!0||h.source!==!1)&&(ne=document.createElement("a"),ne.text=g.SOURCE_ACTION,ne.href="#",ne.addEventListener("click",function(Ct){var Ke,st;M4(_y(n),(Ke=c.sourceHeader)!==null&&Ke!==void 0?Ke:"",(st=c.sourceFooter)!==null&&st!==void 0?st:"",O),Ct.preventDefault()}),Xe.append(ne)),O==="vega-lite"&&(h===!0||h.compiled!==!1)&&(fe=document.createElement("a"),fe.text=g.COMPILED_ACTION,fe.href="#",fe.addEventListener("click",function(Ct){var Ke,st;M4(_y(S),(Ke=c.sourceHeader)!==null&&Ke!==void 0?Ke:"",(st=c.sourceFooter)!==null&&st!==void 0?st:"","vega"),Ct.preventDefault()}),Xe.append(fe)),(h===!0||h.editor!==!1)&&(Ve=(B=c.editorUrl)!==null&&B!==void 0?B:"https://vega.github.io/editor/",pe=document.createElement("a"),pe.text=g.EDITOR_ACTION,pe.href="#",pe.addEventListener("click",function(Ct){q1e(window,Ve,{config:d,mode:O,renderer:p,spec:_y(n)}),Ct.preventDefault()}),Xe.append(pe))}return me.abrupt("return",{view:N,spec:n,vgSpec:S,finalize:tt});case 38:case"end":return me.stop()}},e)})),WS.apply(this,arguments)}function sbe(e,{delay:t=0,duration:n=400,easing:i=ry}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:i,css:o=>`opacity: ${o*r}`}}var ci="top",Gi="bottom",Vi="right",fi="left",HS="auto",Bh=[ci,Gi,Vi,fi],Pc="start",Uh="end",nye="clippingParents",$4="viewport",qh="popper",iye="reference",L4=Bh.reduce(function(e,t){return e.concat([t+"-"+Pc,t+"-"+Uh])},[]),I4=[].concat(Bh,[HS]).reduce(function(e,t){return e.concat([t,t+"-"+Pc,t+"-"+Uh])},[]),rye="beforeRead",oye="read",aye="afterRead",sye="beforeMain",uye="main",lye="afterMain",cye="beforeWrite",fye="write",dye="afterWrite",hye=[rye,oye,aye,sye,uye,lye,cye,fye,dye];function xo(e){return e?(e.nodeName||"").toLowerCase():null}function Cr(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function zc(e){var t=Cr(e).Element;return e instanceof t||e instanceof Element}function Yi(e){var t=Cr(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function P4(e){if(typeof ShadowRoot=="undefined")return!1;var t=Cr(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function gye(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var i=t.styles[n]||{},r=t.attributes[n]||{},o=t.elements[n];!Yi(o)||!xo(o)||(Object.assign(o.style,i),Object.keys(r).forEach(function(a){var s=r[a];s===!1?o.removeAttribute(a):o.setAttribute(a,s===!0?"":s)}))})}function pye(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],o=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:n[i]),s=a.reduce(function(u,l){return u[l]="",u},{});!Yi(r)||!xo(r)||(Object.assign(r.style,s),Object.keys(o).forEach(function(u){r.removeAttribute(u)}))})}}var z4={name:"applyStyles",enabled:!0,phase:"write",fn:gye,effect:pye,requires:["computeStyles"]};function wo(e){return e.split("-")[0]}var Bu=Math.max,K1=Math.min,Bc=Math.round;function Uc(e,t){t===void 0&&(t=!1);var n=e.getBoundingClientRect(),i=1,r=1;if(Yi(e)&&t){var o=e.offsetHeight,a=e.offsetWidth;a>0&&(i=Bc(n.width)/a||1),o>0&&(r=Bc(n.height)/o||1)}return{width:n.width/i,height:n.height/r,top:n.top/r,right:n.right/i,bottom:n.bottom/r,left:n.left/i,x:n.left/i,y:n.top/r}}function GS(e){var t=Uc(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function B4(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&P4(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function _o(e){return Cr(e).getComputedStyle(e)}function mye(e){return["table","td","th"].indexOf(xo(e))>=0}function ws(e){return((zc(e)?e.ownerDocument:e.document)||window.document).documentElement}function J1(e){return xo(e)==="html"?e:e.assignedSlot||e.parentNode||(P4(e)?e.host:null)||ws(e)}function U4(e){return!Yi(e)||_o(e).position==="fixed"?null:e.offsetParent}function yye(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,n=navigator.userAgent.indexOf("Trident")!==-1;if(n&&Yi(e)){var i=_o(e);if(i.position==="fixed")return null}for(var r=J1(e);Yi(r)&&["html","body"].indexOf(xo(r))<0;){var o=_o(r);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return r;r=r.parentNode}return null}function Wh(e){for(var t=Cr(e),n=U4(e);n&&mye(n)&&_o(n).position==="static";)n=U4(n);return n&&(xo(n)==="html"||xo(n)==="body"&&_o(n).position==="static")?t:n||yye(e)||t}function VS(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Hh(e,t,n){return Bu(e,K1(t,n))}function vye(e,t,n){var i=Hh(e,t,n);return i>n?n:i}function q4(){return{top:0,right:0,bottom:0,left:0}}function W4(e){return Object.assign({},q4(),e)}function H4(e,t){return t.reduce(function(n,i){return n[i]=e,n},{})}var bye=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,W4(typeof t!="number"?t:H4(t,Bh))};function xye(e){var t,n=e.state,i=e.name,r=e.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=wo(n.placement),u=VS(s),l=[fi,Vi].indexOf(s)>=0,c=l?"height":"width";if(!(!o||!a)){var f=bye(r.padding,n),d=GS(o),h=u==="y"?ci:fi,g=u==="y"?Gi:Vi,p=n.rects.reference[c]+n.rects.reference[u]-a[u]-n.rects.popper[c],m=a[u]-n.rects.reference[u],y=Wh(o),v=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,x=p/2-m/2,b=f[h],_=v-d[c]-f[g],E=v/2-d[c]/2+x,w=Hh(b,E,_),O=u;n.modifiersData[i]=(t={},t[O]=w,t.centerOffset=w-E,t)}}function wye(e){var t=e.state,n=e.options,i=n.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||!B4(t.elements.popper,r)||(t.elements.arrow=r))}var _ye={name:"arrow",enabled:!0,phase:"main",fn:xye,effect:wye,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function qc(e){return e.split("-")[1]}var Eye={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Oye(e){var t=e.x,n=e.y,i=window,r=i.devicePixelRatio||1;return{x:Bc(t*r)/r||0,y:Bc(n*r)/r||0}}function G4(e){var t,n=e.popper,i=e.popperRect,r=e.placement,o=e.variation,a=e.offsets,s=e.position,u=e.gpuAcceleration,l=e.adaptive,c=e.roundOffsets,f=e.isFixed,d=c===!0?Oye(a):typeof c=="function"?c(a):a,h=d.x,g=h===void 0?0:h,p=d.y,m=p===void 0?0:p,y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),x=fi,b=ci,_=window;if(l){var E=Wh(n),w="clientHeight",O="clientWidth";if(E===Cr(n)&&(E=ws(n),_o(E).position!=="static"&&s==="absolute"&&(w="scrollHeight",O="scrollWidth")),E=E,r===ci||(r===fi||r===Vi)&&o===Uh){b=Gi;var S=f&&_.visualViewport?_.visualViewport.height:E[w];m-=S-i.height,m*=u?1:-1}if(r===fi||(r===ci||r===Gi)&&o===Uh){x=Vi;var k=f&&_.visualViewport?_.visualViewport.width:E[O];g-=k-i.width,g*=u?1:-1}}var A=Object.assign({position:s},l&&Eye);if(u){var F;return Object.assign({},A,(F={},F[b]=v?"0":"",F[x]=y?"0":"",F.transform=(_.devicePixelRatio||1)<=1?"translate("+g+"px, "+m+"px)":"translate3d("+g+"px, "+m+"px, 0)",F))}return Object.assign({},A,(t={},t[b]=v?m+"px":"",t[x]=y?g+"px":"",t.transform="",t))}function Sye(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=i===void 0?!0:i,o=n.adaptive,a=o===void 0?!0:o,s=n.roundOffsets,u=s===void 0?!0:s,l={placement:wo(t.placement),variation:qc(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,G4(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,G4(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var Aye={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Sye,data:{}},Q1={passive:!0};function kye(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,o=r===void 0?!0:r,a=i.resize,s=a===void 0?!0:a,u=Cr(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&l.forEach(function(c){c.addEventListener("scroll",n.update,Q1)}),s&&u.addEventListener("resize",n.update,Q1),function(){o&&l.forEach(function(c){c.removeEventListener("scroll",n.update,Q1)}),s&&u.removeEventListener("resize",n.update,Q1)}}var Cye={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:kye,data:{}},Tye={left:"right",right:"left",bottom:"top",top:"bottom"};function Z1(e){return e.replace(/left|right|bottom|top/g,function(t){return Tye[t]})}var Fye={start:"end",end:"start"};function V4(e){return e.replace(/start|end/g,function(t){return Fye[t]})}function YS(e){var t=Cr(e),n=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:n,scrollTop:i}}function XS(e){return Uc(ws(e)).left+YS(e).scrollLeft}function Dye(e){var t=Cr(e),n=ws(e),i=t.visualViewport,r=n.clientWidth,o=n.clientHeight,a=0,s=0;return i&&(r=i.width,o=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=i.offsetLeft,s=i.offsetTop)),{width:r,height:o,x:a+XS(e),y:s}}function Mye(e){var t,n=ws(e),i=YS(e),r=(t=e.ownerDocument)==null?void 0:t.body,o=Bu(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Bu(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-i.scrollLeft+XS(e),u=-i.scrollTop;return _o(r||n).direction==="rtl"&&(s+=Bu(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}function KS(e){var t=_o(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function Y4(e){return["html","body","#document"].indexOf(xo(e))>=0?e.ownerDocument.body:Yi(e)&&KS(e)?e:Y4(J1(e))}function Gh(e,t){var n;t===void 0&&(t=[]);var i=Y4(e),r=i===((n=e.ownerDocument)==null?void 0:n.body),o=Cr(i),a=r?[o].concat(o.visualViewport||[],KS(i)?i:[]):i,s=t.concat(a);return r?s:s.concat(Gh(J1(a)))}function JS(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Nye(e){var t=Uc(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function X4(e,t){return t===$4?JS(Dye(e)):zc(t)?Nye(t):JS(Mye(ws(e)))}function Rye(e){var t=Gh(J1(e)),n=["absolute","fixed"].indexOf(_o(e).position)>=0,i=n&&Yi(e)?Wh(e):e;return zc(i)?t.filter(function(r){return zc(r)&&B4(r,i)&&xo(r)!=="body"&&(n?_o(r).position!=="static":!0)}):[]}function jye(e,t,n){var i=t==="clippingParents"?Rye(e):[].concat(t),r=[].concat(i,[n]),o=r[0],a=r.reduce(function(s,u){var l=X4(e,u);return s.top=Bu(l.top,s.top),s.right=K1(l.right,s.right),s.bottom=K1(l.bottom,s.bottom),s.left=Bu(l.left,s.left),s},X4(e,o));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function K4(e){var t=e.reference,n=e.element,i=e.placement,r=i?wo(i):null,o=i?qc(i):null,a=t.x+t.width/2-n.width/2,s=t.y+t.height/2-n.height/2,u;switch(r){case ci:u={x:a,y:t.y-n.height};break;case Gi:u={x:a,y:t.y+t.height};break;case Vi:u={x:t.x+t.width,y:s};break;case fi:u={x:t.x-n.width,y:s};break;default:u={x:t.x,y:t.y}}var l=r?VS(r):null;if(l!=null){var c=l==="y"?"height":"width";switch(o){case Pc:u[l]=u[l]-(t[c]/2-n[c]/2);break;case Uh:u[l]=u[l]+(t[c]/2-n[c]/2);break}}return u}function Vh(e,t){t===void 0&&(t={});var n=t,i=n.placement,r=i===void 0?e.placement:i,o=n.boundary,a=o===void 0?nye:o,s=n.rootBoundary,u=s===void 0?$4:s,l=n.elementContext,c=l===void 0?qh:l,f=n.altBoundary,d=f===void 0?!1:f,h=n.padding,g=h===void 0?0:h,p=W4(typeof g!="number"?g:H4(g,Bh)),m=c===qh?iye:qh,y=e.rects.popper,v=e.elements[d?m:c],x=jye(zc(v)?v:v.contextElement||ws(e.elements.popper),a,u),b=Uc(e.elements.reference),_=K4({reference:b,element:y,strategy:"absolute",placement:r}),E=JS(Object.assign({},y,_)),w=c===qh?E:b,O={top:x.top-w.top+p.top,bottom:w.bottom-x.bottom+p.bottom,left:x.left-w.left+p.left,right:w.right-x.right+p.right},S=e.modifiersData.offset;if(c===qh&&S){var k=S[r];Object.keys(O).forEach(function(A){var F=[Vi,Gi].indexOf(A)>=0?1:-1,C=[ci,Gi].indexOf(A)>=0?"y":"x";O[A]+=k[C]*F})}return O}function $ye(e,t){t===void 0&&(t={});var n=t,i=n.placement,r=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,u=n.allowedAutoPlacements,l=u===void 0?I4:u,c=qc(i),f=c?s?L4:L4.filter(function(g){return qc(g)===c}):Bh,d=f.filter(function(g){return l.indexOf(g)>=0});d.length===0&&(d=f);var h=d.reduce(function(g,p){return g[p]=Vh(e,{placement:p,boundary:r,rootBoundary:o,padding:a})[wo(p)],g},{});return Object.keys(h).sort(function(g,p){return h[g]-h[p]})}function Lye(e){if(wo(e)===HS)return[];var t=Z1(e);return[V4(e),t,V4(t)]}function Iye(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,o=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!0:a,u=n.fallbackPlacements,l=n.padding,c=n.boundary,f=n.rootBoundary,d=n.altBoundary,h=n.flipVariations,g=h===void 0?!0:h,p=n.allowedAutoPlacements,m=t.options.placement,y=wo(m),v=y===m,x=u||(v||!g?[Z1(m)]:Lye(m)),b=[m].concat(x).reduce(function(Oe,ke){return Oe.concat(wo(ke)===HS?$ye(t,{placement:ke,boundary:c,rootBoundary:f,padding:l,flipVariations:g,allowedAutoPlacements:p}):ke)},[]),_=t.rects.reference,E=t.rects.popper,w=new Map,O=!0,S=b[0],k=0;k<b.length;k++){var A=b[k],F=wo(A),C=qc(A)===Pc,M=[ci,Gi].indexOf(F)>=0,D=M?"width":"height",N=Vh(t,{placement:A,boundary:c,rootBoundary:f,altBoundary:d,padding:l}),I=M?C?Vi:fi:C?Gi:ci;_[D]>E[D]&&(I=Z1(I));var z=Z1(I),X=[];if(o&&X.push(N[F]<=0),s&&X.push(N[I]<=0,N[z]<=0),X.every(function(Oe){return Oe})){S=A,O=!1;break}w.set(A,X)}if(O)for(var te=g?3:1,xe=function(ke){var Xe=b.find(function(xt){var Ge=w.get(xt);if(Ge)return Ge.slice(0,ke).every(function(Y){return Y})});if(Xe)return S=Xe,"break"},ge=te;ge>0;ge--){var je=xe(ge);if(je==="break")break}t.placement!==S&&(t.modifiersData[i]._skip=!0,t.placement=S,t.reset=!0)}}var Pye={name:"flip",enabled:!0,phase:"main",fn:Iye,requiresIfExists:["offset"],data:{_skip:!1}};function J4(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Q4(e){return[ci,Vi,Gi,fi].some(function(t){return e[t]>=0})}function zye(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,a=Vh(t,{elementContext:"reference"}),s=Vh(t,{altBoundary:!0}),u=J4(a,i),l=J4(s,r,o),c=Q4(u),f=Q4(l);t.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:c,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}var Bye={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:zye};function Uye(e,t,n){var i=wo(e),r=[fi,ci].indexOf(i)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*r,[fi,Vi].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}function qye(e){var t=e.state,n=e.options,i=e.name,r=n.offset,o=r===void 0?[0,0]:r,a=I4.reduce(function(c,f){return c[f]=Uye(f,t.rects,o),c},{}),s=a[t.placement],u=s.x,l=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=l),t.modifiersData[i]=a}var Wye={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:qye};function Hye(e){var t=e.state,n=e.name;t.modifiersData[n]=K4({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var Gye={name:"popperOffsets",enabled:!0,phase:"read",fn:Hye,data:{}};function Vye(e){return e==="x"?"y":"x"}function Yye(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,o=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!1:a,u=n.boundary,l=n.rootBoundary,c=n.altBoundary,f=n.padding,d=n.tether,h=d===void 0?!0:d,g=n.tetherOffset,p=g===void 0?0:g,m=Vh(t,{boundary:u,rootBoundary:l,padding:f,altBoundary:c}),y=wo(t.placement),v=qc(t.placement),x=!v,b=VS(y),_=Vye(b),E=t.modifiersData.popperOffsets,w=t.rects.reference,O=t.rects.popper,S=typeof p=="function"?p(Object.assign({},t.rects,{placement:t.placement})):p,k=typeof S=="number"?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,F={x:0,y:0};if(!!E){if(o){var C,M=b==="y"?ci:fi,D=b==="y"?Gi:Vi,N=b==="y"?"height":"width",I=E[b],z=I+m[M],X=I-m[D],te=h?-O[N]/2:0,xe=v===Pc?w[N]:O[N],ge=v===Pc?-O[N]:-w[N],je=t.elements.arrow,Oe=h&&je?GS(je):{width:0,height:0},ke=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:q4(),Xe=ke[M],xt=ke[D],Ge=Hh(0,w[N],Oe[N]),Y=x?w[N]/2-te-Ge-Xe-k.mainAxis:xe-Ge-Xe-k.mainAxis,ne=x?-w[N]/2+te+Ge+xt+k.mainAxis:ge+Ge+xt+k.mainAxis,fe=t.elements.arrow&&Wh(t.elements.arrow),B=fe?b==="y"?fe.clientTop||0:fe.clientLeft||0:0,Ve=(C=A==null?void 0:A[b])!=null?C:0,pe=I+Y-Ve-B,tt=I+ne-Ve,qe=Hh(h?K1(z,pe):z,I,h?Bu(X,tt):X);E[b]=qe,F[b]=qe-I}if(s){var ie,me=b==="x"?ci:fi,Ct=b==="x"?Gi:Vi,Ke=E[_],st=_==="y"?"height":"width",wt=Ke+m[me],an=Ke-m[Ct],Yt=[ci,fi].indexOf(y)!==-1,Xi=(ie=A==null?void 0:A[_])!=null?ie:0,nt=Yt?wt:Ke-w[st]-O[st]-Xi+k.altAxis,Tt=Yt?Ke+w[st]+O[st]-Xi-k.altAxis:an,sn=h&&Yt?vye(nt,Ke,Tt):Hh(h?nt:wt,Ke,h?Tt:an);E[_]=sn,F[_]=sn-Ke}t.modifiersData[i]=F}}var Xye={name:"preventOverflow",enabled:!0,phase:"main",fn:Yye,requiresIfExists:["offset"]};function Kye(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Jye(e){return e===Cr(e)||!Yi(e)?YS(e):Kye(e)}function Qye(e){var t=e.getBoundingClientRect(),n=Bc(t.width)/e.offsetWidth||1,i=Bc(t.height)/e.offsetHeight||1;return n!==1||i!==1}function Zye(e,t,n){n===void 0&&(n=!1);var i=Yi(t),r=Yi(t)&&Qye(t),o=ws(t),a=Uc(e,r),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&((xo(t)!=="body"||KS(o))&&(s=Jye(t)),Yi(t)?(u=Uc(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):o&&(u.x=XS(o))),{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function eve(e){var t=new Map,n=new Set,i=[];e.forEach(function(o){t.set(o.name,o)});function r(o){n.add(o.name);var a=[].concat(o.requires||[],o.requiresIfExists||[]);a.forEach(function(s){if(!n.has(s)){var u=t.get(s);u&&r(u)}}),i.push(o)}return e.forEach(function(o){n.has(o.name)||r(o)}),i}function tve(e){var t=eve(e);return hye.reduce(function(n,i){return n.concat(t.filter(function(r){return r.phase===i}))},[])}function nve(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function ive(e){var t=e.reduce(function(n,i){var r=n[i.name];return n[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,n},{});return Object.keys(t).map(function(n){return t[n]})}var Z4={placement:"bottom",modifiers:[],strategy:"absolute"};function e8(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function rve(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,i=n===void 0?[]:n,r=t.defaultOptions,o=r===void 0?Z4:r;return function(s,u,l){l===void 0&&(l=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Z4,o),modifiersData:{},elements:{reference:s,popper:u},attributes:{},styles:{}},f=[],d=!1,h={state:c,setOptions:function(y){var v=typeof y=="function"?y(c.options):y;p(),c.options=Object.assign({},o,c.options,v),c.scrollParents={reference:zc(s)?Gh(s):s.contextElement?Gh(s.contextElement):[],popper:Gh(u)};var x=tve(ive([].concat(i,c.options.modifiers)));return c.orderedModifiers=x.filter(function(b){return b.enabled}),g(),h.update()},forceUpdate:function(){if(!d){var y=c.elements,v=y.reference,x=y.popper;if(!!e8(v,x)){c.rects={reference:Zye(v,Wh(x),c.options.strategy==="fixed"),popper:GS(x)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(k){return c.modifiersData[k.name]=Object.assign({},k.data)});for(var b=0;b<c.orderedModifiers.length;b++){if(c.reset===!0){c.reset=!1,b=-1;continue}var _=c.orderedModifiers[b],E=_.fn,w=_.options,O=w===void 0?{}:w,S=_.name;typeof E=="function"&&(c=E({state:c,options:O,name:S,instance:h})||c)}}}},update:nve(function(){return new Promise(function(m){h.forceUpdate(),m(c)})}),destroy:function(){p(),d=!0}};if(!e8(s,u))return h;h.setOptions(l).then(function(m){!d&&l.onFirstUpdate&&l.onFirstUpdate(m)});function g(){c.orderedModifiers.forEach(function(m){var y=m.name,v=m.options,x=v===void 0?{}:v,b=m.effect;if(typeof b=="function"){var _=b({state:c,name:y,instance:h,options:x}),E=function(){};f.push(_||E)}})}function p(){f.forEach(function(m){return m()}),f=[]}return h}}var ove=[Cye,Gye,Aye,z4,Wye,Pye,Xye,_ye,Bye],ave=rve({defaultModifiers:ove}),sve="tippy-box",t8="tippy-content",uve="tippy-backdrop",n8="tippy-arrow",i8="tippy-svg-arrow",Uu={passive:!0,capture:!0},r8=function(){return document.body};function QS(e,t,n){if(Array.isArray(e)){var i=e[t];return i==null?Array.isArray(n)?n[t]:n:i}return e}function ZS(e,t){var n={}.toString.call(e);return n.indexOf("[object")===0&&n.indexOf(t+"]")>-1}function o8(e,t){return typeof e=="function"?e.apply(void 0,t):e}function a8(e,t){if(t===0)return e;var n;return function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}}function lve(e){return e.split(/\s+/).filter(Boolean)}function Wc(e){return[].concat(e)}function s8(e,t){e.indexOf(t)===-1&&e.push(t)}function cve(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function fve(e){return e.split("-")[0]}function ey(e){return[].slice.call(e)}function u8(e){return Object.keys(e).reduce(function(t,n){return e[n]!==void 0&&(t[n]=e[n]),t},{})}function Yh(){return document.createElement("div")}function ty(e){return["Element","Fragment"].some(function(t){return ZS(e,t)})}function dve(e){return ZS(e,"NodeList")}function hve(e){return ZS(e,"MouseEvent")}function gve(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function pve(e){return ty(e)?[e]:dve(e)?ey(e):Array.isArray(e)?e:ey(document.querySelectorAll(e))}function eA(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function l8(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function mve(e){var t,n=Wc(e),i=n[0];return i!=null&&(t=i.ownerDocument)!=null&&t.body?i.ownerDocument:document}function yve(e,t){var n=t.clientX,i=t.clientY;return e.every(function(r){var o=r.popperRect,a=r.popperState,s=r.props,u=s.interactiveBorder,l=fve(a.placement),c=a.modifiersData.offset;if(!c)return!0;var f=l==="bottom"?c.top.y:0,d=l==="top"?c.bottom.y:0,h=l==="right"?c.left.x:0,g=l==="left"?c.right.x:0,p=o.top-i+f>u,m=i-o.bottom-d>u,y=o.left-n+h>u,v=n-o.right-g>u;return p||m||y||v})}function tA(e,t,n){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(r){e[i](r,n)})}function c8(e,t){for(var n=t;n;){var i;if(e.contains(n))return!0;n=n.getRootNode==null||(i=n.getRootNode())==null?void 0:i.host}return!1}var Eo={isTouch:!1},f8=0;function vve(){Eo.isTouch||(Eo.isTouch=!0,window.performance&&document.addEventListener("mousemove",d8))}function d8(){var e=performance.now();e-f8<20&&(Eo.isTouch=!1,document.removeEventListener("mousemove",d8)),f8=e}function bve(){var e=document.activeElement;if(gve(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function xve(){document.addEventListener("touchstart",vve,Uu),window.addEventListener("blur",bve)}var wve=typeof window!="undefined"&&typeof document!="undefined",_ve=wve?!!window.msCrypto:!1,Eve={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Ove={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Tr=Object.assign({appendTo:r8,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},Eve,Ove),Sve=Object.keys(Tr),Ave=function(t){var n=Object.keys(t);n.forEach(function(i){Tr[i]=t[i]})};function h8(e){var t=e.plugins||[],n=t.reduce(function(i,r){var o=r.name,a=r.defaultValue;if(o){var s;i[o]=e[o]!==void 0?e[o]:(s=Tr[o])!=null?s:a}return i},{});return Object.assign({},e,n)}function kve(e,t){var n=t?Object.keys(h8(Object.assign({},Tr,{plugins:t}))):Sve,i=n.reduce(function(r,o){var a=(e.getAttribute("data-tippy-"+o)||"").trim();if(!a)return r;if(o==="content")r[o]=a;else try{r[o]=JSON.parse(a)}catch{r[o]=a}return r},{});return i}function g8(e,t){var n=Object.assign({},t,{content:o8(t.content,[e])},t.ignoreAttributes?{}:kve(e,t.plugins));return n.aria=Object.assign({},Tr.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?t.interactive:n.aria.expanded,content:n.aria.content==="auto"?t.interactive?null:"describedby":n.aria.content},n}var Cve=function(){return"innerHTML"};function nA(e,t){e[Cve()]=t}function p8(e){var t=Yh();return e===!0?t.className=n8:(t.className=i8,ty(e)?t.appendChild(e):nA(t,e)),t}function m8(e,t){ty(t.content)?(nA(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?nA(e,t.content):e.textContent=t.content)}function iA(e){var t=e.firstElementChild,n=ey(t.children);return{box:t,content:n.find(function(i){return i.classList.contains(t8)}),arrow:n.find(function(i){return i.classList.contains(n8)||i.classList.contains(i8)}),backdrop:n.find(function(i){return i.classList.contains(uve)})}}function y8(e){var t=Yh(),n=Yh();n.className=sve,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var i=Yh();i.className=t8,i.setAttribute("data-state","hidden"),m8(i,e.props),t.appendChild(n),n.appendChild(i),r(e.props,e.props);function r(o,a){var s=iA(t),u=s.box,l=s.content,c=s.arrow;a.theme?u.setAttribute("data-theme",a.theme):u.removeAttribute("data-theme"),typeof a.animation=="string"?u.setAttribute("data-animation",a.animation):u.removeAttribute("data-animation"),a.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof a.maxWidth=="number"?a.maxWidth+"px":a.maxWidth,a.role?u.setAttribute("role",a.role):u.removeAttribute("role"),(o.content!==a.content||o.allowHTML!==a.allowHTML)&&m8(l,e.props),a.arrow?c?o.arrow!==a.arrow&&(u.removeChild(c),u.appendChild(p8(a.arrow))):u.appendChild(p8(a.arrow)):c&&u.removeChild(c)}return{popper:t,onUpdate:r}}y8.$$tippy=!0;var Tve=1,ny=[],rA=[];function Fve(e,t){var n=g8(e,Object.assign({},Tr,h8(u8(t)))),i,r,o,a=!1,s=!1,u=!1,l=!1,c,f,d,h=[],g=a8(pe,n.interactiveDebounce),p,m=Tve++,y=null,v=cve(n.plugins),x={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},b={id:m,reference:e,popper:Yh(),popperInstance:y,props:n,state:x,plugins:v,clearDelayTimeouts:nt,setProps:Tt,setContent:sn,show:Xt,hide:di,hideWithInteractivity:Hc,enable:Yt,disable:Xi,unmount:Oo,destroy:Gc};if(!n.render)return b;var _=n.render(b),E=_.popper,w=_.onUpdate;E.setAttribute("data-tippy-root",""),E.id="tippy-"+b.id,b.popper=E,e._tippy=b,E._tippy=b;var O=v.map(function($){return $.fn(b)}),S=e.hasAttribute("aria-expanded");return fe(),te(),I(),z("onCreate",[b]),n.showOnCreate&&wt(),E.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),E.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&M().addEventListener("mousemove",g)}),b;function k(){var $=b.props.touch;return Array.isArray($)?$:[$,0]}function A(){return k()[0]==="hold"}function F(){var $;return!!(($=b.props.render)!=null&&$.$$tippy)}function C(){return p||e}function M(){var $=C().parentNode;return $?mve($):document}function D(){return iA(E)}function N($){return b.state.isMounted&&!b.state.isVisible||Eo.isTouch||c&&c.type==="focus"?0:QS(b.props.delay,$?0:1,Tr.delay)}function I($){$===void 0&&($=!1),E.style.pointerEvents=b.props.interactive&&!$?"":"none",E.style.zIndex=""+b.props.zIndex}function z($,Z,de){if(de===void 0&&(de=!0),O.forEach(function(Ce){Ce[$]&&Ce[$].apply(Ce,Z)}),de){var Be;(Be=b.props)[$].apply(Be,Z)}}function X(){var $=b.props.aria;if(!!$.content){var Z="aria-"+$.content,de=E.id,Be=Wc(b.props.triggerTarget||e);Be.forEach(function(Ce){var Kt=Ce.getAttribute(Z);if(b.state.isVisible)Ce.setAttribute(Z,Kt?Kt+" "+de:de);else{var kn=Kt&&Kt.replace(de,"").trim();kn?Ce.setAttribute(Z,kn):Ce.removeAttribute(Z)}})}}function te(){if(!(S||!b.props.aria.expanded)){var $=Wc(b.props.triggerTarget||e);$.forEach(function(Z){b.props.interactive?Z.setAttribute("aria-expanded",b.state.isVisible&&Z===C()?"true":"false"):Z.removeAttribute("aria-expanded")})}}function xe(){M().removeEventListener("mousemove",g),ny=ny.filter(function($){return $!==g})}function ge($){if(!(Eo.isTouch&&(u||$.type==="mousedown"))){var Z=$.composedPath&&$.composedPath()[0]||$.target;if(!(b.props.interactive&&c8(E,Z))){if(Wc(b.props.triggerTarget||e).some(function(de){return c8(de,Z)})){if(Eo.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else z("onClickOutside",[b,$]);b.props.hideOnClick===!0&&(b.clearDelayTimeouts(),b.hide(),s=!0,setTimeout(function(){s=!1}),b.state.isMounted||Xe())}}}function je(){u=!0}function Oe(){u=!1}function ke(){var $=M();$.addEventListener("mousedown",ge,!0),$.addEventListener("touchend",ge,Uu),$.addEventListener("touchstart",Oe,Uu),$.addEventListener("touchmove",je,Uu)}function Xe(){var $=M();$.removeEventListener("mousedown",ge,!0),$.removeEventListener("touchend",ge,Uu),$.removeEventListener("touchstart",Oe,Uu),$.removeEventListener("touchmove",je,Uu)}function xt($,Z){Y($,function(){!b.state.isVisible&&E.parentNode&&E.parentNode.contains(E)&&Z()})}function Ge($,Z){Y($,Z)}function Y($,Z){var de=D().box;function Be(Ce){Ce.target===de&&(tA(de,"remove",Be),Z())}if($===0)return Z();tA(de,"remove",f),tA(de,"add",Be),f=Be}function ne($,Z,de){de===void 0&&(de=!1);var Be=Wc(b.props.triggerTarget||e);Be.forEach(function(Ce){Ce.addEventListener($,Z,de),h.push({node:Ce,eventType:$,handler:Z,options:de})})}function fe(){A()&&(ne("touchstart",Ve,{passive:!0}),ne("touchend",tt,{passive:!0})),lve(b.props.trigger).forEach(function($){if($!=="manual")switch(ne($,Ve),$){case"mouseenter":ne("mouseleave",tt);break;case"focus":ne(_ve?"focusout":"blur",qe);break;case"focusin":ne("focusout",qe);break}})}function B(){h.forEach(function($){var Z=$.node,de=$.eventType,Be=$.handler,Ce=$.options;Z.removeEventListener(de,Be,Ce)}),h=[]}function Ve($){var Z,de=!1;if(!(!b.state.isEnabled||ie($)||s)){var Be=((Z=c)==null?void 0:Z.type)==="focus";c=$,p=$.currentTarget,te(),!b.state.isVisible&&hve($)&&ny.forEach(function(Ce){return Ce($)}),$.type==="click"&&(b.props.trigger.indexOf("mouseenter")<0||a)&&b.props.hideOnClick!==!1&&b.state.isVisible?de=!0:wt($),$.type==="click"&&(a=!de),de&&!Be&&an($)}}function pe($){var Z=$.target,de=C().contains(Z)||E.contains(Z);if(!($.type==="mousemove"&&de)){var Be=st().concat(E).map(function(Ce){var Kt,kn=Ce._tippy,oa=(Kt=kn.popperInstance)==null?void 0:Kt.state;return oa?{popperRect:Ce.getBoundingClientRect(),popperState:oa,props:n}:null}).filter(Boolean);yve(Be,$)&&(xe(),an($))}}function tt($){var Z=ie($)||b.props.trigger.indexOf("click")>=0&&a;if(!Z){if(b.props.interactive){b.hideWithInteractivity($);return}an($)}}function qe($){b.props.trigger.indexOf("focusin")<0&&$.target!==C()||b.props.interactive&&$.relatedTarget&&E.contains($.relatedTarget)||an($)}function ie($){return Eo.isTouch?A()!==$.type.indexOf("touch")>=0:!1}function me(){Ct();var $=b.props,Z=$.popperOptions,de=$.placement,Be=$.offset,Ce=$.getReferenceClientRect,Kt=$.moveTransition,kn=F()?iA(E).arrow:null,oa=Ce?{getBoundingClientRect:Ce,contextElement:Ce.contextElement||C()}:e,_s={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Os){var So=Os.state;if(F()){var qu=D(),Wu=qu.box;["placement","reference-hidden","escaped"].forEach(function(Hu){Hu==="placement"?Wu.setAttribute("data-placement",So.placement):So.attributes.popper["data-popper-"+Hu]?Wu.setAttribute("data-"+Hu,""):Wu.removeAttribute("data-"+Hu)}),So.attributes.popper={}}}},Fr=[{name:"offset",options:{offset:Be}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Kt}},_s];F()&&kn&&Fr.push({name:"arrow",options:{element:kn,padding:3}}),Fr.push.apply(Fr,(Z==null?void 0:Z.modifiers)||[]),b.popperInstance=ave(oa,E,Object.assign({},Z,{placement:de,onFirstUpdate:d,modifiers:Fr}))}function Ct(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Ke(){var $=b.props.appendTo,Z,de=C();b.props.interactive&&$===r8||$==="parent"?Z=de.parentNode:Z=o8($,[de]),Z.contains(E)||Z.appendChild(E),b.state.isMounted=!0,me()}function st(){return ey(E.querySelectorAll("[data-tippy-root]"))}function wt($){b.clearDelayTimeouts(),$&&z("onTrigger",[b,$]),ke();var Z=N(!0),de=k(),Be=de[0],Ce=de[1];Eo.isTouch&&Be==="hold"&&Ce&&(Z=Ce),Z?i=setTimeout(function(){b.show()},Z):b.show()}function an($){if(b.clearDelayTimeouts(),z("onUntrigger",[b,$]),!b.state.isVisible){Xe();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf($.type)>=0&&a)){var Z=N(!1);Z?r=setTimeout(function(){b.state.isVisible&&b.hide()},Z):o=requestAnimationFrame(function(){b.hide()})}}function Yt(){b.state.isEnabled=!0}function Xi(){b.hide(),b.state.isEnabled=!1}function nt(){clearTimeout(i),clearTimeout(r),cancelAnimationFrame(o)}function Tt($){if(!b.state.isDestroyed){z("onBeforeUpdate",[b,$]),B();var Z=b.props,de=g8(e,Object.assign({},Z,u8($),{ignoreAttributes:!0}));b.props=de,fe(),Z.interactiveDebounce!==de.interactiveDebounce&&(xe(),g=a8(pe,de.interactiveDebounce)),Z.triggerTarget&&!de.triggerTarget?Wc(Z.triggerTarget).forEach(function(Be){Be.removeAttribute("aria-expanded")}):de.triggerTarget&&e.removeAttribute("aria-expanded"),te(),I(),w&&w(Z,de),b.popperInstance&&(me(),st().forEach(function(Be){requestAnimationFrame(Be._tippy.popperInstance.forceUpdate)})),z("onAfterUpdate",[b,$])}}function sn($){b.setProps({content:$})}function Xt(){var $=b.state.isVisible,Z=b.state.isDestroyed,de=!b.state.isEnabled,Be=Eo.isTouch&&!b.props.touch,Ce=QS(b.props.duration,0,Tr.duration);if(!($||Z||de||Be)&&!C().hasAttribute("disabled")&&(z("onShow",[b],!1),b.props.onShow(b)!==!1)){if(b.state.isVisible=!0,F()&&(E.style.visibility="visible"),I(),ke(),b.state.isMounted||(E.style.transition="none"),F()){var Kt=D(),kn=Kt.box,oa=Kt.content;eA([kn,oa],0)}d=function(){var Fr;if(!(!b.state.isVisible||l)){if(l=!0,E.offsetHeight,E.style.transition=b.props.moveTransition,F()&&b.props.animation){var Es=D(),Os=Es.box,So=Es.content;eA([Os,So],Ce),l8([Os,So],"visible")}X(),te(),s8(rA,b),(Fr=b.popperInstance)==null||Fr.forceUpdate(),z("onMount",[b]),b.props.animation&&F()&&Ge(Ce,function(){b.state.isShown=!0,z("onShown",[b])})}},Ke()}}function di(){var $=!b.state.isVisible,Z=b.state.isDestroyed,de=!b.state.isEnabled,Be=QS(b.props.duration,1,Tr.duration);if(!($||Z||de)&&(z("onHide",[b],!1),b.props.onHide(b)!==!1)){if(b.state.isVisible=!1,b.state.isShown=!1,l=!1,a=!1,F()&&(E.style.visibility="hidden"),xe(),Xe(),I(!0),F()){var Ce=D(),Kt=Ce.box,kn=Ce.content;b.props.animation&&(eA([Kt,kn],Be),l8([Kt,kn],"hidden"))}X(),te(),b.props.animation?F()&&xt(Be,b.unmount):b.unmount()}}function Hc($){M().addEventListener("mousemove",g),s8(ny,g),g($)}function Oo(){b.state.isVisible&&b.hide(),!!b.state.isMounted&&(Ct(),st().forEach(function($){$._tippy.unmount()}),E.parentNode&&E.parentNode.removeChild(E),rA=rA.filter(function($){return $!==b}),b.state.isMounted=!1,z("onHidden",[b]))}function Gc(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),B(),delete e._tippy,b.state.isDestroyed=!0,z("onDestroy",[b]))}}function iy(e,t){t===void 0&&(t={});var n=Tr.plugins.concat(t.plugins||[]);xve();var i=Object.assign({},t,{plugins:n}),r=pve(e),o=r.reduce(function(a,s){var u=s&&Fve(s,i);return u&&a.push(u),a},[]);return ty(e)?o[0]:o}iy.defaultProps=Tr;iy.setDefaultProps=Ave;iy.currentInput=Eo;Object.assign({},z4,{effect:function(t){var n=t.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow)}});iy.setDefaultProps({render:y8});export{Gve as $,Pve as A,j8 as B,ibe as C,Xc as D,Ot as E,Jc as F,Qc as G,Kc as H,Qi as I,Dve as J,ay as K,Wve as L,Ku as M,$ve as N,Mve as O,pi as P,ef as Q,Vve as R,r7 as S,Yve as T,sa as U,Yc as V,sbe as W,rbe as X,ig as Y,ebe as Z,Nve as _,ln as a,Jve as a0,Xve as a1,Kve as a2,abe as a3,Uve as a4,G8 as a5,jve as a6,Rve as a7,Lve as a8,Ive as a9,iy as aa,Hve as ab,Zh as ac,SA as ad,Bve as ae,obe as af,Te as b,cn as c,we as d,Ft as e,ct as f,Zi as g,Ss as h,i7 as i,tbe as j,ua as k,un as l,nbe as m,la as n,e7 as o,Qve as p,Zve as q,Qu as r,gA as s,gi as t,Lt as u,t7 as v,Zu as w,ft as x,qve as y,zve as z};
