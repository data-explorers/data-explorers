function Ti(){}const eg=e=>e;function L8(e,t){for(const n in t)e[n]=t[n];return e}function yA(e){return e()}function vA(){return Object.create(null)}function ko(e){e.forEach(yA)}function Ku(e){return typeof e=="function"}function bA(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let tg;function Mve(e,t){return tg||(tg=document.createElement("a")),tg.href=t,e===tg.href}function I8(e){return Object.keys(e).length===0}function P8(e,...t){if(e==null)return Ti;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function Dve(e,t,n){e.$$.on_destroy.push(P8(t,n))}function Jc(e,t,n,i){if(e){const r=xA(e,t,n,i);return e[0](r)}}function xA(e,t,n,i){return e[1]&&i?L8(n.ctx.slice(),e[1](i(t))):n.ctx}function Qc(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(t.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(t.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=t.dirty[s]|r[s];return o}return t.dirty|r}return t.dirty}function Zc(e,t,n,i,r,o){if(r){const a=xA(t,n,i,o);e.p(a,r)}}function ef(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let i=0;i<n;i++)t[i]=-1;return t}return-1}function Nve(e){return e&&Ku(e.destroy)?e.destroy:Ti}const wA=typeof window!="undefined";let uy=wA?()=>window.performance.now():()=>Date.now(),ly=wA?e=>requestAnimationFrame(e):Ti;const Ju=new Set;function _A(e){Ju.forEach(t=>{t.c(e)||(Ju.delete(t),t.f())}),Ju.size!==0&&ly(_A)}function cy(e){let t;return Ju.size===0&&ly(_A),{promise:new Promise(n=>{Ju.add(t={c:e,f:n})}),abort(){Ju.delete(t)}}}let ng=!1;function z8(){ng=!0}function B8(){ng=!1}function U8(e,t,n,i){for(;e<t;){const r=e+(t-e>>1);n(r)<=i?e=r+1:t=r}return e}function q8(e){if(e.hydrate_init)return;e.hydrate_init=!0;let t=e.childNodes;if(e.nodeName==="HEAD"){const u=[];for(let l=0;l<t.length;l++){const c=t[l];c.claim_order!==void 0&&u.push(c)}t=u}const n=new Int32Array(t.length+1),i=new Int32Array(t.length);n[0]=-1;let r=0;for(let u=0;u<t.length;u++){const l=t[u].claim_order,c=(r>0&&t[n[r]].claim_order<=l?r+1:U8(1,r,d=>t[n[d]].claim_order,l))-1;i[u]=n[c]+1;const f=c+1;n[f]=u,r=Math.max(f,r)}const o=[],a=[];let s=t.length-1;for(let u=n[r]+1;u!=0;u=i[u-1]){for(o.push(t[u-1]);s>=u;s--)a.push(t[s]);s--}for(;s>=0;s--)a.push(t[s]);o.reverse(),a.sort((u,l)=>u.claim_order-l.claim_order);for(let u=0,l=0;u<a.length;u++){for(;l<o.length&&a[u].claim_order>=o[l].claim_order;)l++;const c=l<o.length?o[l]:null;e.insertBefore(a[u],c)}}function W8(e,t){e.appendChild(t)}function EA(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function H8(e){const t=Ft("style");return G8(EA(e),t),t}function G8(e,t){W8(e.head||e,t)}function Ot(e,t){if(ng){for(q8(e),(e.actual_end_child===void 0||e.actual_end_child!==null&&e.actual_end_child.parentElement!==e)&&(e.actual_end_child=e.firstChild);e.actual_end_child!==null&&e.actual_end_child.claim_order===void 0;)e.actual_end_child=e.actual_end_child.nextSibling;t!==e.actual_end_child?(t.claim_order!==void 0||t.parentNode!==e)&&e.insertBefore(t,e.actual_end_child):e.actual_end_child=t.nextSibling}else(t.parentNode!==e||t.nextSibling!==null)&&e.appendChild(t)}function V8(e,t,n){e.insertBefore(t,n||null)}function ct(e,t,n){ng&&!n?Ot(e,t):(t.parentNode!==e||t.nextSibling!=n)&&e.insertBefore(t,n||null)}function we(e){e.parentNode.removeChild(e)}function fy(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function Ft(e){return document.createElement(e)}function Y8(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function gi(e){return document.createTextNode(e)}function la(){return gi(" ")}function un(){return gi("")}function pi(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function X8(e){return function(t){return t.preventDefault(),e.call(this,t)}}function Rve(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function Te(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function ln(e){return Array.from(e.childNodes)}function OA(e){e.claim_info===void 0&&(e.claim_info={last_index:0,total_claimed:0})}function SA(e,t,n,i,r=!1){OA(e);const o=(()=>{for(let a=e.claim_info.last_index;a<e.length;a++){const s=e[a];if(t(s)){const u=n(s);return u===void 0?e.splice(a,1):e[a]=u,r||(e.claim_info.last_index=a),s}}for(let a=e.claim_info.last_index-1;a>=0;a--){const s=e[a];if(t(s)){const u=n(s);return u===void 0?e.splice(a,1):e[a]=u,r?u===void 0&&e.claim_info.last_index--:e.claim_info.last_index=a,s}}return i()})();return o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1,o}function AA(e,t,n,i){return SA(e,r=>r.nodeName===t,r=>{const o=[];for(let a=0;a<r.attributes.length;a++){const s=r.attributes[a];n[s.name]||o.push(s.name)}o.forEach(a=>r.removeAttribute(a))},()=>i(t))}function cn(e,t,n){return AA(e,t,n,Ft)}function jve(e,t,n){return AA(e,t,n,Y8)}function Zi(e,t){return SA(e,n=>n.nodeType===3,n=>{const i=""+t;if(n.data.startsWith(i)){if(n.data.length!==i.length)return n.splitText(i.length)}else n.data=i},()=>gi(t),!0)}function ca(e){return Zi(e," ")}function kA(e,t,n){for(let i=n;i<e.length;i+=1){const r=e[i];if(r.nodeType===8&&r.textContent.trim()===t)return i}return e.length}function CA(e){const t=kA(e,"HTML_TAG_START",0),n=kA(e,"HTML_TAG_END",t);if(t===n)return new ig;OA(e);const i=e.splice(t,n+1);we(i[0]),we(i[i.length-1]);const r=i.slice(1,i.length-1);for(const o of r)o.claim_order=e.claim_info.total_claimed,e.claim_info.total_claimed+=1;return new ig(r)}function Ss(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function TA(e,t){e.value=t==null?"":t}function $ve(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}function Lve(e,t){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t){i.selected=!0;return}}e.selectedIndex=-1}function Ive(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function Qu(e,t,n){e.classList[n?"add":"remove"](t)}function FA(e,t,n=!1){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,!1,t),i}class K8{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,n,i=null){this.e||(this.e=Ft(n.nodeName),this.t=n,this.c(t)),this.i(i)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let n=0;n<this.n.length;n+=1)V8(this.t,this.n[n],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(we)}}class ig extends K8{constructor(t){super();this.e=this.n=null,this.l=t}c(t){this.l?this.n=this.l:super.c(t)}i(t){for(let n=0;n<this.n.length;n+=1)ct(this.t,this.n[n],t)}}const dy=new Set;let rg=0;function J8(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function og(e,t,n,i,r,o,a,s=0){const u=16.666/i;let l=`{
`;for(let m=0;m<=1;m+=u){const y=t+(n-t)*o(m);l+=m*100+`%{${a(y,1-y)}}
`}const c=l+`100% {${a(n,1-n)}}
}`,f=`__svelte_${J8(c)}_${s}`,d=EA(e);dy.add(d);const h=d.__svelte_stylesheet||(d.__svelte_stylesheet=H8(e).sheet),g=d.__svelte_rules||(d.__svelte_rules={});g[f]||(g[f]=!0,h.insertRule(`@keyframes ${f} ${c}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${i}ms linear ${r}ms 1 both`,rg+=1,f}function ag(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),r=n.length-i.length;r&&(e.style.animation=i.join(", "),rg-=r,rg||Q8())}function Q8(){ly(()=>{rg||(dy.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),dy.clear())})}let tf;function nf(e){tf=e}function Zu(){if(!tf)throw new Error("Function called outside component initialization");return tf}function Pve(e){Zu().$$.on_mount.push(e)}function zve(e){Zu().$$.after_update.push(e)}function Bve(e){Zu().$$.on_destroy.push(e)}function Uve(){const e=Zu();return(t,n)=>{const i=e.$$.callbacks[t];if(i){const r=FA(t,n);i.slice().forEach(o=>{o.call(e,r)})}}}function qve(e,t){Zu().$$.context.set(e,t)}function Wve(e){return Zu().$$.context.get(e)}function Hve(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(i=>i.call(this,t))}const rf=[],sg=[],ug=[],hy=[],MA=Promise.resolve();let gy=!1;function DA(){gy||(gy=!0,MA.then(NA))}function Gve(){return DA(),MA}function el(e){ug.push(e)}function Vve(e){hy.push(e)}const py=new Set;let lg=0;function NA(){const e=tf;do{for(;lg<rf.length;){const t=rf[lg];lg++,nf(t),Z8(t.$$)}for(nf(null),rf.length=0,lg=0;sg.length;)sg.pop()();for(let t=0;t<ug.length;t+=1){const n=ug[t];py.has(n)||(py.add(n),n())}ug.length=0}while(rf.length);for(;hy.length;)hy.pop()();gy=!1,py.clear(),nf(e)}function Z8(e){if(e.fragment!==null){e.update(),ko(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(el)}}let of;function my(){return of||(of=Promise.resolve(),of.then(()=>{of=null})),of}function As(e,t,n){e.dispatchEvent(FA(`${t?"intro":"outro"}${n}`))}const cg=new Set;let Mr;function tl(){Mr={r:0,c:[],p:Mr}}function nl(){Mr.r||ko(Mr.c),Mr=Mr.p}function ft(e,t){e&&e.i&&(cg.delete(e),e.i(t))}function Lt(e,t,n,i){if(e&&e.o){if(cg.has(e))return;cg.add(e),Mr.c.push(()=>{cg.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}}const yy={duration:0};function Yve(e,t,n){let i=t(e,n),r=!1,o,a,s=0;function u(){o&&ag(e,o)}function l(){const{delay:f=0,duration:d=300,easing:h=eg,tick:g=Ti,css:p}=i||yy;p&&(o=og(e,0,1,d,f,h,p,s++)),g(0,1);const m=uy()+f,y=m+d;a&&a.abort(),r=!0,el(()=>As(e,!0,"start")),a=cy(v=>{if(r){if(v>=y)return g(1,0),As(e,!0,"end"),u(),r=!1;if(v>=m){const x=h((v-m)/d);g(x,1-x)}}return r})}let c=!1;return{start(){c||(c=!0,ag(e),Ku(i)?(i=i(),my().then(l)):l())},invalidate(){c=!1},end(){r&&(u(),r=!1)}}}function Xve(e,t,n){let i=t(e,n),r=!0,o;const a=Mr;a.r+=1;function s(){const{delay:u=0,duration:l=300,easing:c=eg,tick:f=Ti,css:d}=i||yy;d&&(o=og(e,1,0,l,u,c,d));const h=uy()+u,g=h+l;el(()=>As(e,!1,"start")),cy(p=>{if(r){if(p>=g)return f(0,1),As(e,!1,"end"),--a.r||ko(a.c),!1;if(p>=h){const m=c((p-h)/l);f(1-m,m)}}return r})}return Ku(i)?my().then(()=>{i=i(),s()}):s(),{end(u){u&&i.tick&&i.tick(1,0),r&&(o&&ag(e,o),r=!1)}}}function Kve(e,t,n,i){let r=t(e,n),o=i?0:1,a=null,s=null,u=null;function l(){u&&ag(e,u)}function c(d,h){const g=d.b-o;return h*=Math.abs(g),{a:o,b:d.b,d:g,duration:h,start:d.start,end:d.start+h,group:d.group}}function f(d){const{delay:h=0,duration:g=300,easing:p=eg,tick:m=Ti,css:y}=r||yy,v={start:uy()+h,b:d};d||(v.group=Mr,Mr.r+=1),a||s?s=v:(y&&(l(),u=og(e,o,d,g,h,p,y)),d&&m(0,1),a=c(v,g),el(()=>As(e,d,"start")),cy(x=>{if(s&&x>s.start&&(a=c(s,g),s=null,As(e,a.b,"start"),y&&(l(),u=og(e,o,a.b,a.duration,0,p,r.css))),a){if(x>=a.end)m(o=a.b,1-o),As(e,a.b,"end"),s||(a.b?l():--a.group.r||ko(a.group.c)),a=null;else if(x>=a.start){const b=x-a.start;o=a.a+a.d*p(b/a.duration),m(o,1-o)}}return!!(a||s)}))}return{run(d){Ku(r)?my().then(()=>{r=r(),f(d)}):f(d)},end(){l(),a=s=null}}}const Jve=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function Qve(e,t){Lt(e,1,1,()=>{t.delete(e.key)})}function Zve(e,t,n,i,r,o,a,s,u,l,c,f){let d=e.length,h=o.length,g=d;const p={};for(;g--;)p[e[g].key]=g;const m=[],y=new Map,v=new Map;for(g=h;g--;){const E=f(r,o,g),w=n(E);let O=a.get(w);O?i&&O.p(E,t):(O=l(w,E),O.c()),y.set(w,m[g]=O),w in p&&v.set(w,Math.abs(g-p[w]))}const x=new Set,b=new Set;function _(E){ft(E,1),E.m(s,c),a.set(E.key,E),c=E.first,h--}for(;d&&h;){const E=m[h-1],w=e[d-1],O=E.key,S=w.key;E===w?(c=E.first,d--,h--):y.has(S)?!a.has(O)||x.has(O)?_(E):b.has(S)?d--:v.get(O)>v.get(S)?(b.add(O),_(E)):(x.add(S),d--):(u(w,a),d--)}for(;d--;){const E=e[d];y.has(E.key)||u(E,a)}for(;h;)_(m[h-1]);return m}function ebe(e,t){const n={},i={},r={$$scope:1};let o=e.length;for(;o--;){const a=e[o],s=t[o];if(s){for(const u in a)u in s||(i[u]=1);for(const u in s)r[u]||(n[u]=s[u],r[u]=1);e[o]=s}else for(const u in a)r[u]=1}for(const a in i)a in n||(n[a]=void 0);return n}function tbe(e){return typeof e=="object"&&e!==null?e:{}}function nbe(e,t,n){const i=e.$$.props[t];i!==void 0&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function ibe(e){e&&e.c()}function rbe(e,t){e&&e.l(t)}function e7(e,t,n,i){const{fragment:r,on_mount:o,on_destroy:a,after_update:s}=e.$$;r&&r.m(t,n),i||el(()=>{const u=o.map(yA).filter(Ku);a?a.push(...u):ko(u),e.$$.on_mount=[]}),s.forEach(el)}function t7(e,t){const n=e.$$;n.fragment!==null&&(ko(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function n7(e,t){e.$$.dirty[0]===-1&&(rf.push(e),DA(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function i7(e,t,n,i,r,o,a,s=[-1]){const u=tf;nf(e);const l=e.$$={fragment:null,ctx:null,props:o,update:Ti,not_equal:r,bound:vA(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:vA(),dirty:s,skip_bound:!1,root:t.target||u.$$.root};a&&a(l.root);let c=!1;if(l.ctx=n?n(e,t.props||{},(f,d,...h)=>{const g=h.length?h[0]:d;return l.ctx&&r(l.ctx[f],l.ctx[f]=g)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](g),c&&n7(e,f)),d}):[],l.update(),c=!0,ko(l.before_update),l.fragment=i?i(l.ctx):!1,t.target){if(t.hydrate){z8();const f=ln(t.target);l.fragment&&l.fragment.l(f),f.forEach(we)}else l.fragment&&l.fragment.c();t.intro&&ft(e.$$.fragment),e7(e,t.target,t.anchor,t.customElement),B8(),NA()}nf(u)}class r7{$destroy(){t7(this,1),this.$destroy=Ti}$on(t,n){const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(t){this.$$set&&!I8(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const il=[];function obe(e,t=Ti){let n;const i=new Set;function r(s){if(bA(e,s)&&(e=s,n)){const u=!il.length;for(const l of i)l[1](),il.push(l,e);if(u){for(let l=0;l<il.length;l+=2)il[l][0](il[l+1]);il.length=0}}}function o(s){r(s(e))}function a(s,u=Ti){const l=[s,u];return i.add(l),i.size===1&&(n=t(r)||Ti),s(e),()=>{i.delete(l),i.size===0&&(n(),n=null)}}return{set:r,update:o,subscribe:a}}function abe(e,{delay:t=0,duration:n=400,easing:i=eg}={}){const r=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:i,css:o=>`opacity: ${o*r}`}}const o7=e=>({noResultsText:e[0]&2048}),RA=e=>({noResultsText:e[11]}),a7=e=>({createText:e[0]&8192}),jA=e=>({createText:e[13]}),s7=e=>({loadingText:e[0]&4096}),$A=e=>({loadingText:e[12]});function LA(e,t,n){const i=e.slice();return i[108]=t[n],i[110]=n,i}const u7=e=>({item:e[0]&134217728,label:e[0]&134217728}),IA=e=>({item:e[108].item,label:e[108].highlighted?e[108].highlighted:e[108].label});function PA(e,t,n){const i=e.slice();return i[111]=t[n],i}const l7=e=>({label:e[0]&2,item:e[0]&2}),zA=e=>({label:e[34](e[111]),item:e[111],unselectItem:e[41]});function BA(e,t,n){const i=e.slice();return i[110]=t[n],i}function c7(e){let t,n=e[1],i=[];for(let r=0;r<n.length;r+=1)i[r]=UA(BA(e,n,r));return{c(){for(let r=0;r<i.length;r+=1)i[r].c();t=un()},l(r){for(let o=0;o<i.length;o+=1)i[o].l(r);t=un()},m(r,o){for(let a=0;a<i.length;a+=1)i[a].m(r,o);ct(r,t,o)},p(r,o){if(o[0]&18|o[1]&8){n=r[1];let a;for(a=0;a<n.length;a+=1){const s=BA(r,n,a);i[a]?i[a].p(s,o):(i[a]=UA(s),i[a].c(),i[a].m(t.parentNode,t))}for(;a<i.length;a+=1)i[a].d(1);i.length=n.length}},d(r){fy(i,r),r&&we(t)}}}function f7(e){let t,n;return{c(){t=Ft("option"),n=gi(e[3]),this.h()},l(i){t=cn(i,"OPTION",{class:!0});var r=ln(t);n=Zi(r,e[3]),r.forEach(we),this.h()},h(){t.__value=e[2],t.value=t.__value,t.selected=!0,Te(t,"class","svelte-878r4m")},m(i,r){ct(i,t,r),Ot(t,n)},p(i,r){r[0]&8&&Ss(n,i[3]),r[0]&4&&(t.__value=i[2],t.value=t.__value)},d(i){i&&we(t)}}}function UA(e){let t,n=e[34](e[110])+"",i,r,o;return{c(){t=Ft("option"),i=gi(n),r=la(),this.h()},l(a){t=cn(a,"OPTION",{class:!0});var s=ln(t);i=Zi(s,n),r=ca(s),s.forEach(we),this.h()},h(){t.__value=o=e[4](e[110],!0),t.value=t.__value,t.selected=!0,Te(t,"class","svelte-878r4m")},m(a,s){ct(a,t,s),Ot(t,i),Ot(t,r)},p(a,s){s[0]&2&&n!==(n=a[34](a[110])+"")&&Ss(i,n),s[0]&18&&o!==(o=a[4](a[110],!0))&&(t.__value=o,t.value=t.__value)},d(a){a&&we(t)}}}function qA(e){let t,n,i=e[1],r=[];for(let a=0;a<i.length;a+=1)r[a]=WA(PA(e,i,a));const o=a=>Lt(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();t=un()},l(a){for(let s=0;s<r.length;s+=1)r[s].l(a);t=un()},m(a,s){for(let u=0;u<r.length;u+=1)r[u].m(a,s);ct(a,t,s),n=!0},p(a,s){if(s[0]&2|s[1]&1032|s[2]&8192){i=a[1];let u;for(u=0;u<i.length;u+=1){const l=PA(a,i,u);r[u]?(r[u].p(l,s),ft(r[u],1)):(r[u]=WA(l),r[u].c(),ft(r[u],1),r[u].m(t.parentNode,t))}for(tl(),u=i.length;u<r.length;u+=1)o(u);nl()}},i(a){if(!n){for(let s=0;s<i.length;s+=1)ft(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Lt(r[s]);n=!1},d(a){fy(r,a),a&&we(t)}}}function d7(e){let t,n,i=e[34](e[111])+"",r,o,a,s,u,l;return{c(){t=Ft("div"),n=Ft("span"),r=gi(i),o=la(),a=Ft("span"),s=la(),this.h()},l(c){t=cn(c,"DIV",{class:!0});var f=ln(t);n=cn(f,"SPAN",{class:!0});var d=ln(n);r=Zi(d,i),d.forEach(we),o=ca(f),a=cn(f,"SPAN",{class:!0}),ln(a).forEach(we),f.forEach(we),s=ca(c),this.h()},h(){Te(n,"class","tag svelte-878r4m"),Te(a,"class","tag is-delete svelte-878r4m"),Te(t,"class","tags has-addons svelte-878r4m")},m(c,f){ct(c,t,f),Ot(t,n),Ot(n,r),Ot(t,o),Ot(t,a),ct(c,s,f),u||(l=pi(a,"click",X8(function(){Ku(e[41](e[111]))&&e[41](e[111]).apply(this,arguments)})),u=!0)},p(c,f){e=c,f[0]&2&&i!==(i=e[34](e[111])+"")&&Ss(r,i)},d(c){c&&we(t),c&&we(s),u=!1,l()}}}function WA(e){let t;const n=e[76].tag,i=Jc(n,e,e[75],zA),r=i||d7(e);return{c(){r&&r.c()},l(o){r&&r.l(o)},m(o,a){r&&r.m(o,a),t=!0},p(o,a){i?i.p&&(!t||a[0]&2|a[2]&8192)&&Zc(i,n,o,o[75],t?Qc(n,o[75],a,l7):ef(o[75]),zA):r&&r.p&&(!t||a[0]&2)&&r.p(o,t?a:[-1,-1,-1,-1])},i(o){t||(ft(r,o),t=!0)},o(o){Lt(r,o),t=!1},d(o){r&&r.d(o)}}}function HA(e){let t,n,i,r;return{c(){t=Ft("span"),n=gi("\u2716"),this.h()},l(o){t=cn(o,"SPAN",{class:!0});var a=ln(t);n=Zi(a,"\u2716"),a.forEach(we),this.h()},h(){Te(t,"class","autocomplete-clear-button svelte-878r4m")},m(o,a){ct(o,t,a),Ot(t,n),i||(r=pi(t,"click",e[45]),i=!0)},p:Ti,d(o){o&&we(t),i=!1,r()}}}function h7(e){let t,n;const i=e[76]["no-results"],r=Jc(i,e,e[75],RA),o=r||y7(e);return{c(){t=Ft("div"),o&&o.c(),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);o&&o.l(s),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-no-results svelte-878r4m")},m(a,s){ct(a,t,s),o&&o.m(t,null),n=!0},p(a,s){r?r.p&&(!n||s[0]&2048|s[2]&8192)&&Zc(r,i,a,a[75],n?Qc(i,a[75],s,o7):ef(a[75]),RA):o&&o.p&&(!n||s[0]&2048)&&o.p(a,n?s:[-1,-1,-1,-1])},i(a){n||(ft(o,a),n=!0)},o(a){Lt(o,a),n=!1},d(a){a&&we(t),o&&o.d(a)}}}function g7(e){let t,n,i,r;const o=e[76].create,a=Jc(o,e,e[75],jA),s=a||v7(e);return{c(){t=Ft("div"),s&&s.c(),this.h()},l(u){t=cn(u,"DIV",{class:!0});var l=ln(t);s&&s.l(l),l.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-create svelte-878r4m")},m(u,l){ct(u,t,l),s&&s.m(t,null),n=!0,i||(r=pi(t,"click",e[35]),i=!0)},p(u,l){a?a.p&&(!n||l[0]&8192|l[2]&8192)&&Zc(a,o,u,u[75],n?Qc(o,u[75],l,a7):ef(u[75]),jA):s&&s.p&&(!n||l[0]&8192)&&s.p(u,n?l:[-1,-1,-1,-1])},i(u){n||(ft(s,u),n=!0)},o(u){Lt(s,u),n=!1},d(u){u&&we(t),s&&s.d(u),i=!1,r()}}}function p7(e){let t,n;const i=e[76].loading,r=Jc(i,e,e[75],$A),o=r||b7(e);return{c(){t=Ft("div"),o&&o.c(),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);o&&o.l(s),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-loading svelte-878r4m")},m(a,s){ct(a,t,s),o&&o.m(t,null),n=!0},p(a,s){r?r.p&&(!n||s[0]&4096|s[2]&8192)&&Zc(r,i,a,a[75],n?Qc(i,a[75],s,s7):ef(a[75]),$A):o&&o.p&&(!n||s[0]&4096)&&o.p(a,n?s:[-1,-1,-1,-1])},i(a){n||(ft(o,a),n=!0)},o(a){Lt(o,a),n=!1},d(a){a&&we(t),o&&o.d(a)}}}function m7(e){let t,n,i,r=e[27],o=[];for(let u=0;u<r.length;u+=1)o[u]=YA(LA(e,r,u));const a=u=>Lt(o[u],1,1,()=>{o[u]=null});let s=e[5]>0&&e[27].length>e[5]&&XA(e);return{c(){for(let u=0;u<o.length;u+=1)o[u].c();t=la(),s&&s.c(),n=un()},l(u){for(let l=0;l<o.length;l+=1)o[l].l(u);t=ca(u),s&&s.l(u),n=un()},m(u,l){for(let c=0;c<o.length;c+=1)o[c].m(u,l);ct(u,t,l),s&&s.m(u,l),ct(u,n,l),i=!0},p(u,l){if(l[0]&201326624|l[1]&32800|l[2]&8192){r=u[27];let c;for(c=0;c<r.length;c+=1){const f=LA(u,r,c);o[c]?(o[c].p(f,l),ft(o[c],1)):(o[c]=YA(f),o[c].c(),ft(o[c],1),o[c].m(t.parentNode,t))}for(tl(),c=r.length;c<o.length;c+=1)a(c);nl()}u[5]>0&&u[27].length>u[5]?s?s.p(u,l):(s=XA(u),s.c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i(u){if(!i){for(let l=0;l<r.length;l+=1)ft(o[l]);i=!0}},o(u){o=o.filter(Boolean);for(let l=0;l<o.length;l+=1)Lt(o[l]);i=!1},d(u){fy(o,u),u&&we(t),s&&s.d(u),u&&we(n)}}}function y7(e){let t;return{c(){t=gi(e[11])},l(n){t=Zi(n,e[11])},m(n,i){ct(n,t,i)},p(n,i){i[0]&2048&&Ss(t,n[11])},d(n){n&&we(t)}}}function v7(e){let t;return{c(){t=gi(e[13])},l(n){t=Zi(n,e[13])},m(n,i){ct(n,t,i)},p(n,i){i[0]&8192&&Ss(t,n[13])},d(n){n&&we(t)}}}function b7(e){let t;return{c(){t=gi(e[12])},l(n){t=Zi(n,e[12])},m(n,i){ct(n,t,i)},p(n,i){i[0]&4096&&Ss(t,n[12])},d(n){n&&we(t)}}}function GA(e){let t,n,i=e[108]&&VA(e);return{c(){i&&i.c(),t=un()},l(r){i&&i.l(r),t=un()},m(r,o){i&&i.m(r,o),ct(r,t,o),n=!0},p(r,o){r[108]?i?(i.p(r,o),o[0]&134217728&&ft(i,1)):(i=VA(r),i.c(),ft(i,1),i.m(t.parentNode,t)):i&&(tl(),Lt(i,1,1,()=>{i=null}),nl())},i(r){n||(ft(i),n=!0)},o(r){Lt(i),n=!1},d(r){i&&i.d(r),r&&we(t)}}}function VA(e){let t,n,i,r,o;const a=e[76].item,s=Jc(a,e,e[75],IA),u=s||_7(e);function l(){return e[79](e[108])}function c(){return e[80](e[110])}return{c(){t=Ft("div"),u&&u.c(),this.h()},l(f){t=cn(f,"DIV",{class:!0});var d=ln(t);u&&u.l(d),d.forEach(we),this.h()},h(){Te(t,"class",n="autocomplete-list-item "+(e[110]===e[26]?"selected":"")+" svelte-878r4m"),Qu(t,"confirmed",e[46](e[108].item))},m(f,d){ct(f,t,d),u&&u.m(t,null),i=!0,r||(o=[pi(t,"click",l),pi(t,"pointerenter",c)],r=!0)},p(f,d){e=f,s?s.p&&(!i||d[0]&134217728|d[2]&8192)&&Zc(s,a,e,e[75],i?Qc(a,e[75],d,u7):ef(e[75]),IA):u&&u.p&&(!i||d[0]&134217728)&&u.p(e,i?d:[-1,-1,-1,-1]),(!i||d[0]&67108864&&n!==(n="autocomplete-list-item "+(e[110]===e[26]?"selected":"")+" svelte-878r4m"))&&Te(t,"class",n),d[0]&201326592|d[1]&32768&&Qu(t,"confirmed",e[46](e[108].item))},i(f){i||(ft(u,f),i=!0)},o(f){Lt(u,f),i=!1},d(f){f&&we(t),u&&u.d(f),r=!1,ko(o)}}}function x7(e){let t,n=e[108].label+"",i;return{c(){t=new ig,i=un(),this.h()},l(r){t=CA(r),i=un(),this.h()},h(){t.a=i},m(r,o){t.m(n,r,o),ct(r,i,o)},p(r,o){o[0]&134217728&&n!==(n=r[108].label+"")&&t.p(n)},d(r){r&&we(i),r&&t.d()}}}function w7(e){let t,n=e[108].highlighted+"",i;return{c(){t=new ig,i=un(),this.h()},l(r){t=CA(r),i=un(),this.h()},h(){t.a=i},m(r,o){t.m(n,r,o),ct(r,i,o)},p(r,o){o[0]&134217728&&n!==(n=r[108].highlighted+"")&&t.p(n)},d(r){r&&we(i),r&&t.d()}}}function _7(e){let t;function n(o,a){return o[108].highlighted?w7:x7}let i=n(e),r=i(e);return{c(){r.c(),t=un()},l(o){r.l(o),t=un()},m(o,a){r.m(o,a),ct(o,t,a)},p(o,a){i===(i=n(o))&&r?r.p(o,a):(r.d(1),r=i(o),r&&(r.c(),r.m(t.parentNode,t)))},d(o){r.d(o),o&&we(t)}}}function YA(e){let t,n,i=e[108]&&(e[5]<=0||e[110]<e[5])&&GA(e);return{c(){i&&i.c(),t=un()},l(r){i&&i.l(r),t=un()},m(r,o){i&&i.m(r,o),ct(r,t,o),n=!0},p(r,o){r[108]&&(r[5]<=0||r[110]<r[5])?i?(i.p(r,o),o[0]&134217760&&ft(i,1)):(i=GA(r),i.c(),ft(i,1),i.m(t.parentNode,t)):i&&(tl(),Lt(i,1,1,()=>{i=null}),nl())},i(r){n||(ft(i),n=!0)},o(r){Lt(i),n=!1},d(r){i&&i.d(r),r&&we(t)}}}function XA(e){let t,n,i=e[27].length-e[5]+"",r,o;return{c(){t=Ft("div"),n=gi("..."),r=gi(i),o=gi(" results not shown"),this.h()},l(a){t=cn(a,"DIV",{class:!0});var s=ln(t);n=Zi(s,"..."),r=Zi(s,i),o=Zi(s," results not shown"),s.forEach(we),this.h()},h(){Te(t,"class","autocomplete-list-item-no-results svelte-878r4m")},m(a,s){ct(a,t,s),Ot(t,n),Ot(t,r),Ot(t,o)},p(a,s){s[0]&134217760&&i!==(i=a[27].length-a[5]+"")&&Ss(r,i)},d(a){a&&we(t)}}}function E7(e){let t,n,i,r,o,a,s,u,l,c,f,d,h,g,p,m,y,v,x,b;function _(C,D){if(!C[6]&&C[2])return f7;if(C[6]&&C[1])return c7}let E=_(e),w=E&&E(e),O=e[6]&&e[1]&&qA(e),S=e[31]&&HA(e);const k=[m7,p7,g7,h7],A=[];function M(C,D){return C[27]&&C[27].length>0?0:C[30]&&C[12]?1:C[7]?2:C[11]?3:-1}return~(g=M(e))&&(p=A[g]=k[g](e)),{c(){t=Ft("div"),n=Ft("select"),w&&w.c(),i=la(),r=Ft("div"),O&&O.c(),o=la(),a=Ft("input"),f=la(),S&&S.c(),d=la(),h=Ft("div"),p&&p.c(),this.h()},l(C){t=cn(C,"DIV",{class:!0});var D=ln(t);n=cn(D,"SELECT",{name:!0,id:!0,class:!0});var F=ln(n);w&&w.l(F),F.forEach(we),i=ca(D),r=cn(D,"DIV",{class:!0});var N=ln(r);O&&O.l(N),o=ca(N),a=cn(N,"INPUT",{type:!0,class:!0,id:!0,autocomplete:!0,placeholder:!0,name:!0,title:!0}),f=ca(N),S&&S.l(N),N.forEach(we),d=ca(D),h=cn(D,"DIV",{class:!0});var I=ln(h);p&&p.l(I),I.forEach(we),D.forEach(we),this.h()},h(){Te(n,"name",e[19]),Te(n,"id",e[20]),n.multiple=e[6],Te(n,"class","svelte-878r4m"),Te(a,"type","text"),Te(a,"class",s=""+((e[16]?e[16]:"")+" input autocomplete-input svelte-878r4m")),Te(a,"id",u=e[17]?e[17]:""),Te(a,"autocomplete",l=e[22]?"on":"some-other-text"),Te(a,"placeholder",e[14]),Te(a,"name",e[18]),a.disabled=e[25],Te(a,"title",e[21]),a.readOnly=c=e[23]||e[8]&&e[1],Te(r,"class","input-container svelte-878r4m"),Te(h,"class",m=""+((e[24]?e[24]:"")+" autocomplete-list "+(e[32]?"":"hidden")+" is-fullwidth svelte-878r4m")),Te(t,"class",y=""+((e[15]?e[15]:"")+" "+(e[9]||!e[0].length?"hide-arrow":"")+" "+(e[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+e[33]+" svelte-878r4m")),Qu(t,"show-clear",e[31]),Qu(t,"is-loading",e[10]&&e[30])},m(C,D){ct(C,t,D),Ot(t,n),w&&w.m(n,null),Ot(t,i),Ot(t,r),O&&O.m(r,null),Ot(r,o),Ot(r,a),e[77](a),TA(a,e[3]),Ot(r,f),S&&S.m(r,null),Ot(t,d),Ot(t,h),~g&&A[g].m(h,null),e[81](h),v=!0,x||(b=[pi(window,"click",e[37]),pi(a,"input",e[78]),pi(a,"input",e[40]),pi(a,"focus",e[43]),pi(a,"blur",e[44]),pi(a,"keydown",e[38]),pi(a,"click",e[42]),pi(a,"keypress",e[39])],x=!0)},p(C,D){E===(E=_(C))&&w?w.p(C,D):(w&&w.d(1),w=E&&E(C),w&&(w.c(),w.m(n,null))),(!v||D[0]&524288)&&Te(n,"name",C[19]),(!v||D[0]&1048576)&&Te(n,"id",C[20]),(!v||D[0]&64)&&(n.multiple=C[6]),C[6]&&C[1]?O?(O.p(C,D),D[0]&66&&ft(O,1)):(O=qA(C),O.c(),ft(O,1),O.m(r,o)):O&&(tl(),Lt(O,1,1,()=>{O=null}),nl()),(!v||D[0]&65536&&s!==(s=""+((C[16]?C[16]:"")+" input autocomplete-input svelte-878r4m")))&&Te(a,"class",s),(!v||D[0]&131072&&u!==(u=C[17]?C[17]:""))&&Te(a,"id",u),(!v||D[0]&4194304&&l!==(l=C[22]?"on":"some-other-text"))&&Te(a,"autocomplete",l),(!v||D[0]&16384)&&Te(a,"placeholder",C[14]),(!v||D[0]&262144)&&Te(a,"name",C[18]),(!v||D[0]&33554432)&&(a.disabled=C[25]),(!v||D[0]&2097152)&&Te(a,"title",C[21]),(!v||D[0]&8388866&&c!==(c=C[23]||C[8]&&C[1]))&&(a.readOnly=c),D[0]&8&&a.value!==C[3]&&TA(a,C[3]),C[31]?S?S.p(C,D):(S=HA(C),S.c(),S.m(r,null)):S&&(S.d(1),S=null);let F=g;g=M(C),g===F?~g&&A[g].p(C,D):(p&&(tl(),Lt(A[F],1,1,()=>{A[F]=null}),nl()),~g?(p=A[g],p?p.p(C,D):(p=A[g]=k[g](C),p.c()),ft(p,1),p.m(h,null)):p=null),(!v||D[0]&16777216|D[1]&2&&m!==(m=""+((C[24]?C[24]:"")+" autocomplete-list "+(C[32]?"":"hidden")+" is-fullwidth svelte-878r4m")))&&Te(h,"class",m),(!v||D[0]&33345&&y!==(y=""+((C[15]?C[15]:"")+" "+(C[9]||!C[0].length?"hide-arrow":"")+" "+(C[6]?"is-multiple":"")+" autocomplete select is-fullwidth "+C[33]+" svelte-878r4m")))&&Te(t,"class",y),D[0]&33345|D[1]&1&&Qu(t,"show-clear",C[31]),D[0]&1073776193&&Qu(t,"is-loading",C[10]&&C[30])},i(C){v||(ft(O),ft(p),v=!0)},o(C){Lt(O),Lt(p),v=!1},d(C){C&&we(t),w&&w.d(),O&&O.d(),e[77](null),S&&S.d(),~g&&A[g].d(),e[81](null),x=!1,ko(b)}}}function vy(e,t){typeof e!="function"&&console.error("Not a function: "+e+", argument: "+t);let n;try{n=e(t)}catch{console.warn("Error executing Autocomplete function on value: "+t+" function: "+e)}let i=n;return i==null&&(i=""),typeof i!="string"&&(i=i.toString()),i}function by(e,t){if(!e)return 0;const n=e.keywords;let i=0;return t.forEach(r=>{n.includes(r)&&i++}),i}function O7(e,t,n){return by(t,n)-by(e,n)}function fg(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function S7(e,t,n){let i,r,{$$slots:o={},$$scope:a}=t,{items:s=[]}=t,{searchFunction:u=!1}=t,{labelFieldName:l=void 0}=t,{keywordsFieldName:c=l}=t,{valueFieldName:f=void 0}=t,{labelFunction:d=function(T){return T==null?"":l?T[l]:T}}=t,{keywordsFunction:h=function(T){return T==null?"":c?T[c]:d(T)}}=t,{valueFunction:g=function(T,he=!1){return T==null?T:!S||he?f?T[f]:T:T.map(ve=>f?ve[f]:ve)}}=t,{keywordsCleanFunction:p=function(T){return T}}=t,{textCleanFunction:m=function(T){return T}}=t,{beforeChange:y=function(T,he){return!0}}=t,{onChange:v=function(T){}}=t,{onFocus:x=function(){}}=t,{onBlur:b=function(){}}=t,{onCreate:_=function(T){ie&&console.log("onCreate: "+T)}}=t,{selectFirstIfEmpty:E=!1}=t,{minCharactersToSearch:w=1}=t,{maxItemsToShowInList:O=0}=t,{multiple:S=!1}=t,{create:k=!1}=t,{ignoreAccents:A=!0}=t,{matchAllKeywords:M=!0}=t,{sortByMatchedKeywords:C=!1}=t,{itemFilterFunction:D=void 0}=t,{itemSortFunction:F=void 0}=t,{lock:N=!1}=t,{delay:I=0}=t,{localFiltering:z=!0}=t,{hideArrow:X=!1}=t,{showClear:te=!1}=t,{showLoadingIndicator:xe=!1}=t,{noResultsText:ge="No results found"}=t,{loadingText:je="Loading results..."}=t,{createText:Oe="Not found, add anyway?"}=t,{placeholder:ke=void 0}=t,{className:Xe=void 0}=t,{inputClassName:xt=void 0}=t,{inputId:Ge=void 0}=t,{name:Y=void 0}=t,{selectName:ne=void 0}=t,{selectId:fe=void 0}=t,{title:B=void 0}=t,{html5autocomplete:Ve=void 0}=t,{readonly:pe=void 0}=t,{dropdownClassName:tt=void 0}=t,{disabled:qe=!1}=t,{debug:ie=!1}=t,{selectedItem:me=S?[]:void 0}=t,{value:Ct=void 0}=t,{highlightedItem:Ke=void 0}=t;const st="sautocomplete-"+Math.floor(Math.random()*1e3);let wt,an,Yt=!1,Ki=!1,nt=-1,{text:Tt}=t,sn=0,Xt,di=[],Yc=0,Oo=0,Xc;function $(T){return vy(d,T)}function Z(T){const he=vy(h,T);let ve=vy(p,he);return ve=ve.toLowerCase().trim(),A&&(ve=fg(ve)),ie&&console.log("Extracted keywords: '"+ve+"' from item: "+JSON.stringify(T)),ve}function de(){let T;ie&&(T=`Autocomplete prepare list ${Ge?`(id: ${Ge})`:""}`,console.time(T),console.log("Prepare items to search"),console.log("items: "+JSON.stringify(s))),Array.isArray(s)||(console.warn("Autocomplete items / search function did not return array but",s),n(0,s=[]));const he=s?s.length:0;di=new Array(he),he>0&&s.forEach((ve,$e)=>{const hi=Be(ve);hi==null&&console.log("Undefined item for: ",ve),di[$e]=hi}),ie&&(console.log(di.length+" items to search"),console.timeEnd(T))}function Be(T){return{keywords:Z(T),label:$(T),item:T}}function Ce(){n(2,Ct=g(me)),n(3,Tt=S?"":$(me)),n(27,Xt=di),v(me)}function Kt(T){if(T==null)return"";const he=T.replace(/[&/\\#,+()$~%.'":*?<>{}]/g," ").trim();if(n(74,sn=he.length),w>1&&sn<w)return"";const $e=m(he).toLowerCase().trim();return ie&&console.log("Change user entered text '"+T+"' into '"+$e+"'"),$e}async function kn(){let T;ie&&(T=`Autocomplete search ${Ge?`(id: ${Ge})`:""})`,console.time(T),console.log("Searching user entered text: '"+Tt+"'"));const he=Kt(Tt);if(he===""){u?(n(0,s=[]),ie&&console.log("User entered text is empty clear list of items")):(n(27,Xt=di),ie&&console.log("User entered text is empty set the list of items to all items")),pA(),ie&&console.timeEnd(T);return}if(!u)_s(he);else{Yc=Yc+1;const ve=Yc;if(n(30,Ki=!0),u.constructor.name==="AsyncGeneratorFunction"){for await(const $e of u(he)){if(ve<Oo)return!1;ve>Oo&&n(0,s=[]),Oo=ve,n(0,s=[...s,...$e]),_s(he)}Oo<ve&&(Oo=ve,n(0,s=[]),_s(he))}else{let $e=await u(he);if(ve<Oo)return!1;Oo=ve,n(0,s=$e),_s(he)}n(30,Ki=!1)}ie&&(console.timeEnd(T),console.log("Search found "+Xt.length+" items"))}function sa(T,he){var ve=by(T,he);return M?ve>=he.length:ve>0}function _s(T){de();const ve=(A?fg(T):T).split(/\s+/g);let $e;z?(D?$e=di.filter(Ao=>D(Ao.item,ve)):$e=di.filter(Ao=>sa(Ao,ve)),F?$e=$e.sort((Ao,ua)=>F(Ao.item,ua.item,ve)):C&&($e=$e.sort((Ao,ua)=>O7(Ao,ua,ve)))):$e=di;const hi=mA(ve,"label"),Kc=$e.map(hi);return n(27,Xt=Kc),pA(),!0}function Fr(T){if(ie&&console.log("selectListItem",T),typeof T=="undefined"&&k){const ve=_(Tt);if(typeof ve!="undefined"){de(),n(27,Xt=di);const $e=hA(ve,Xt);$e>=0&&(n(26,nt=$e),T=Xt[nt])}}if(typeof T=="undefined")return ie&&console.log("listItem is undefined. Can not select."),!1;const he=T.item;return y(me,he)&&(S?me?me.includes(he)?n(1,me=me.filter(ve=>ve!==he)):n(1,me=[...me,he]):n(1,me=[he]):(n(1,me=void 0),n(1,me=he))),!0}function Es(){ie&&console.log("selectItem",nt);const T=Xt[nt];Fr(T)&&(Vu(),S&&wt.focus())}function Os(){ie&&console.log("up"),Qh(),nt>0&&n(26,nt--,nt),Wu()}function So(){ie&&console.log("down"),Qh(),nt<Xt.length-1&&n(26,nt++,nt),Wu()}function Wu(){ie&&console.log("highlight");const T=".selected";ie&&console.log("Seaching DOM element: "+T+" in "+an);const he=an&&an.querySelector(T);he?typeof he.scrollIntoViewIfNeeded=="function"?(ie&&console.log("Scrolling selected item into view"),he.scrollIntoViewIfNeeded()):ie&&console.warn("Could not scroll selected item into view, scrollIntoViewIfNeeded not supported"):ie&&console.warn("Selected item not found to scroll into view")}function Hu(T){ie&&console.log("onListItemClick"),Fr(T)&&(Vu(),S&&wt.focus())}function Gu(T){ie&&console.log("onDocumentClick: "+JSON.stringify(T.composedPath())),T.composedPath().some(he=>he.classList&&he.classList.contains(st))?(ie&&console.log("onDocumentClick inside"),Wu()):(ie&&console.log("onDocumentClick outside"),Vu())}function x8(T){ie&&console.log("onKeyDown");let he=T.key;he==="Tab"&&T.shiftKey&&(he="ShiftTab");const $e={Tab:Yt?So.bind(this):null,ShiftTab:Yt?Os.bind(this):null,ArrowDown:So.bind(this),ArrowUp:Os.bind(this),Escape:S8.bind(this),Backspace:S&&me&&me.length&&!Tt?A8.bind(this):null}[he];typeof $e=="function"&&$e(T)}function w8(T){ie&&console.log("onKeyPress"),T.key==="Enter"&&Yt&&(T.preventDefault(),_8())}function _8(){Es()}function E8(T){ie&&console.log("onInput"),n(3,Tt=T.target.value),Xc&&clearTimeout(Xc),I?Xc=setTimeout(fA,I):fA()}function cA(T){ie&&console.log("unselectItem",T),n(1,me=me.filter(he=>he!==T)),wt.focus()}function fA(){kn()&&(n(26,nt=0),Qh())}function O8(){ie&&console.log("onInputClick"),dA()}function S8(T){ie&&console.log("onEsc"),T.stopPropagation(),Yt&&(wt.focus(),Vu())}function A8(T){ie&&console.log("onBackspace"),cA(me[me.length-1])}function k8(){ie&&console.log("onFocus"),x(),dA()}function C8(){ie&&console.log("onBlur"),b()}function dA(){if(ie&&console.log("resetListToAllItemsAndOpen"),Tt?!di.length&&me&&u&&kn():n(27,Xt=di),Qh(),me){ie&&console.log("Searching currently selected item: "+JSON.stringify(me));const T=hA(me,Xt);T>=0&&(n(26,nt=T),Wu())}}function hA(T,he){ie&&console.log("Finding index for item",T);let ve=-1;for(let $e=0;$e<he.length;$e++){const hi=he[$e];if(typeof hi=="undefined"){ie&&console.log(`listItem ${$e} is undefined. Skipping.`);continue}if(ie&&console.log("Item "+$e+": "+JSON.stringify(hi)),T==hi.item){ve=$e;break}}return ie&&(ve>=0?console.log("Found index for item: "+ve):console.warn("Not found index for item: "+T)),ve}function Qh(){ie&&console.log("open"),!gA()&&n(73,Yt=!0)}function Vu(){ie&&console.log("close"),n(73,Yt=!1),n(30,Ki=!1),!Tt&&E&&(n(26,nt=0),Es())}function gA(){return w>1&&sn<w}function pA(){gA()&&Vu()}function T8(){ie&&console.log("clear"),n(3,Tt=""),n(1,me=S?[]:void 0),setTimeout(()=>{wt.focus(),Vu()})}function mA(T,he){return ve=>{let $e=ve[he];const hi=Object.assign({highlighted:void 0},ve);hi.highlighted=$e;const Kc=$e.toLowerCase(),Ao=A?fg(Kc):Kc;if(T&&T.length){const ua=[];for(let Yu=0;Yu<T.length;Yu++){let Ji=T[Yu];A&&(Ji=fg(Ji));const Xu=Ji.length;let Qi=0;do if(Qi=Ao.indexOf(Ji,Qi),Qi>=0){let Zh=Qi+Xu;ua.push([Qi,Zh]),Qi=Zh}while(Qi!==-1)}if(ua.length>0){const Yu=new Set;for(let Ji=0;Ji<ua.length;Ji++){const Xu=ua[Ji],Qi=Xu[0],Zh=Xu[1],$8=Kc.substring(Qi,Zh);Yu.add($8)}for(let Ji of Yu){if(Ji==="b")continue;const Xu=new RegExp("("+Ji+")","ig"),Qi=hi.highlighted.replace(Xu,"<b>$1</b>");hi.highlighted=Qi}}}return hi}}function F8(T){return me?S?me.includes(T):T==me:!1}function M8(T){sg[T?"unshift":"push"](()=>{wt=T,n(28,wt)})}function D8(){Tt=this.value,n(3,Tt)}const N8=T=>Hu(T),R8=T=>{n(26,nt=T)};function j8(T){sg[T?"unshift":"push"](()=>{an=T,n(29,an)})}return e.$$set=T=>{"items"in T&&n(0,s=T.items),"searchFunction"in T&&n(48,u=T.searchFunction),"labelFieldName"in T&&n(49,l=T.labelFieldName),"keywordsFieldName"in T&&n(50,c=T.keywordsFieldName),"valueFieldName"in T&&n(51,f=T.valueFieldName),"labelFunction"in T&&n(52,d=T.labelFunction),"keywordsFunction"in T&&n(53,h=T.keywordsFunction),"valueFunction"in T&&n(4,g=T.valueFunction),"keywordsCleanFunction"in T&&n(54,p=T.keywordsCleanFunction),"textCleanFunction"in T&&n(55,m=T.textCleanFunction),"beforeChange"in T&&n(56,y=T.beforeChange),"onChange"in T&&n(57,v=T.onChange),"onFocus"in T&&n(58,x=T.onFocus),"onBlur"in T&&n(59,b=T.onBlur),"onCreate"in T&&n(60,_=T.onCreate),"selectFirstIfEmpty"in T&&n(61,E=T.selectFirstIfEmpty),"minCharactersToSearch"in T&&n(62,w=T.minCharactersToSearch),"maxItemsToShowInList"in T&&n(5,O=T.maxItemsToShowInList),"multiple"in T&&n(6,S=T.multiple),"create"in T&&n(7,k=T.create),"ignoreAccents"in T&&n(63,A=T.ignoreAccents),"matchAllKeywords"in T&&n(64,M=T.matchAllKeywords),"sortByMatchedKeywords"in T&&n(65,C=T.sortByMatchedKeywords),"itemFilterFunction"in T&&n(66,D=T.itemFilterFunction),"itemSortFunction"in T&&n(67,F=T.itemSortFunction),"lock"in T&&n(8,N=T.lock),"delay"in T&&n(68,I=T.delay),"localFiltering"in T&&n(69,z=T.localFiltering),"hideArrow"in T&&n(9,X=T.hideArrow),"showClear"in T&&n(70,te=T.showClear),"showLoadingIndicator"in T&&n(10,xe=T.showLoadingIndicator),"noResultsText"in T&&n(11,ge=T.noResultsText),"loadingText"in T&&n(12,je=T.loadingText),"createText"in T&&n(13,Oe=T.createText),"placeholder"in T&&n(14,ke=T.placeholder),"className"in T&&n(15,Xe=T.className),"inputClassName"in T&&n(16,xt=T.inputClassName),"inputId"in T&&n(17,Ge=T.inputId),"name"in T&&n(18,Y=T.name),"selectName"in T&&n(19,ne=T.selectName),"selectId"in T&&n(20,fe=T.selectId),"title"in T&&n(21,B=T.title),"html5autocomplete"in T&&n(22,Ve=T.html5autocomplete),"readonly"in T&&n(23,pe=T.readonly),"dropdownClassName"in T&&n(24,tt=T.dropdownClassName),"disabled"in T&&n(25,qe=T.disabled),"debug"in T&&n(71,ie=T.debug),"selectedItem"in T&&n(1,me=T.selectedItem),"value"in T&&n(2,Ct=T.value),"highlightedItem"in T&&n(47,Ke=T.highlightedItem),"text"in T&&n(3,Tt=T.text),"$$scope"in T&&n(75,a=T.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&1&&de(),e.$$.dirty[0]&2&&Ce(),e.$$.dirty[0]&201326592&&n(47,Ke=Xt&&nt&&nt>=0&&nt<Xt.length?Xt[nt].item:null),e.$$.dirty[0]&1|e.$$.dirty[2]&6144&&n(32,i=Yt&&(s&&s.length>0||sn>0)),e.$$.dirty[0]&322|e.$$.dirty[2]&256&&n(31,r=te||(N||S)&&me)},[s,me,Ct,Tt,g,O,S,k,N,X,xe,ge,je,Oe,ke,Xe,xt,Ge,Y,ne,fe,B,Ve,pe,tt,qe,nt,Xt,wt,an,Ki,r,i,st,$,Es,Hu,Gu,x8,w8,E8,cA,O8,k8,C8,T8,F8,Ke,u,l,c,f,d,h,p,m,y,v,x,b,_,E,w,A,M,C,D,F,I,z,te,ie,mA,Yt,sn,a,o,M8,D8,N8,R8,j8]}class sbe extends r7{constructor(t){super();i7(this,t,S7,E7,bA,{items:0,searchFunction:48,labelFieldName:49,keywordsFieldName:50,valueFieldName:51,labelFunction:52,keywordsFunction:53,valueFunction:4,keywordsCleanFunction:54,textCleanFunction:55,beforeChange:56,onChange:57,onFocus:58,onBlur:59,onCreate:60,selectFirstIfEmpty:61,minCharactersToSearch:62,maxItemsToShowInList:5,multiple:6,create:7,ignoreAccents:63,matchAllKeywords:64,sortByMatchedKeywords:65,itemFilterFunction:66,itemSortFunction:67,lock:8,delay:68,localFiltering:69,hideArrow:9,showClear:70,showLoadingIndicator:10,noResultsText:11,loadingText:12,createText:13,placeholder:14,className:15,inputClassName:16,inputId:17,name:18,selectName:19,selectId:20,title:21,html5autocomplete:22,readonly:23,dropdownClassName:24,disabled:25,debug:71,selectedItem:1,value:2,highlightedItem:47,text:3,highlightFilter:72},null,[-1,-1,-1,-1])}get highlightFilter(){return this.$$.ctx[72]}}var Hn="top",Fi="bottom",Mi="right",Gn="left",xy="auto",af=[Hn,Fi,Mi,Gn],rl="start",sf="end",A7="clippingParents",KA="viewport",uf="popper",k7="reference",JA=af.reduce(function(e,t){return e.concat([t+"-"+rl,t+"-"+sf])},[]),QA=[].concat(af,[xy]).reduce(function(e,t){return e.concat([t,t+"-"+rl,t+"-"+sf])},[]),C7="beforeRead",T7="read",F7="afterRead",M7="beforeMain",D7="main",N7="afterMain",R7="beforeWrite",j7="write",$7="afterWrite",L7=[C7,T7,F7,M7,D7,N7,R7,j7,$7];function Dr(e){return e?(e.nodeName||"").toLowerCase():null}function er(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function ol(e){var t=er(e).Element;return e instanceof t||e instanceof Element}function Di(e){var t=er(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function ZA(e){if(typeof ShadowRoot=="undefined")return!1;var t=er(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function I7(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var i=t.styles[n]||{},r=t.attributes[n]||{},o=t.elements[n];!Di(o)||!Dr(o)||(Object.assign(o.style,i),Object.keys(r).forEach(function(a){var s=r[a];s===!1?o.removeAttribute(a):o.setAttribute(a,s===!0?"":s)}))})}function P7(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(i){var r=t.elements[i],o=t.attributes[i]||{},a=Object.keys(t.styles.hasOwnProperty(i)?t.styles[i]:n[i]),s=a.reduce(function(u,l){return u[l]="",u},{});!Di(r)||!Dr(r)||(Object.assign(r.style,s),Object.keys(o).forEach(function(u){r.removeAttribute(u)}))})}}var ek={name:"applyStyles",enabled:!0,phase:"write",fn:I7,effect:P7,requires:["computeStyles"]};function Nr(e){return e.split("-")[0]}var ks=Math.max,dg=Math.min,al=Math.round;function sl(e,t){t===void 0&&(t=!1);var n=e.getBoundingClientRect(),i=1,r=1;if(Di(e)&&t){var o=e.offsetHeight,a=e.offsetWidth;a>0&&(i=al(n.width)/a||1),o>0&&(r=al(n.height)/o||1)}return{width:n.width/i,height:n.height/r,top:n.top/r,right:n.right/i,bottom:n.bottom/r,left:n.left/i,x:n.left/i,y:n.top/r}}function wy(e){var t=sl(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function tk(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&ZA(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Co(e){return er(e).getComputedStyle(e)}function z7(e){return["table","td","th"].indexOf(Dr(e))>=0}function fa(e){return((ol(e)?e.ownerDocument:e.document)||window.document).documentElement}function hg(e){return Dr(e)==="html"?e:e.assignedSlot||e.parentNode||(ZA(e)?e.host:null)||fa(e)}function nk(e){return!Di(e)||Co(e).position==="fixed"?null:e.offsetParent}function B7(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,n=navigator.userAgent.indexOf("Trident")!==-1;if(n&&Di(e)){var i=Co(e);if(i.position==="fixed")return null}for(var r=hg(e);Di(r)&&["html","body"].indexOf(Dr(r))<0;){var o=Co(r);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||t&&o.willChange==="filter"||t&&o.filter&&o.filter!=="none")return r;r=r.parentNode}return null}function lf(e){for(var t=er(e),n=nk(e);n&&z7(n)&&Co(n).position==="static";)n=nk(n);return n&&(Dr(n)==="html"||Dr(n)==="body"&&Co(n).position==="static")?t:n||B7(e)||t}function _y(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function cf(e,t,n){return ks(e,dg(t,n))}function U7(e,t,n){var i=cf(e,t,n);return i>n?n:i}function ik(){return{top:0,right:0,bottom:0,left:0}}function rk(e){return Object.assign({},ik(),e)}function ok(e,t){return t.reduce(function(n,i){return n[i]=e,n},{})}var q7=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,rk(typeof t!="number"?t:ok(t,af))};function W7(e){var t,n=e.state,i=e.name,r=e.options,o=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Nr(n.placement),u=_y(s),l=[Gn,Mi].indexOf(s)>=0,c=l?"height":"width";if(!(!o||!a)){var f=q7(r.padding,n),d=wy(o),h=u==="y"?Hn:Gn,g=u==="y"?Fi:Mi,p=n.rects.reference[c]+n.rects.reference[u]-a[u]-n.rects.popper[c],m=a[u]-n.rects.reference[u],y=lf(o),v=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,x=p/2-m/2,b=f[h],_=v-d[c]-f[g],E=v/2-d[c]/2+x,w=cf(b,E,_),O=u;n.modifiersData[i]=(t={},t[O]=w,t.centerOffset=w-E,t)}}function H7(e){var t=e.state,n=e.options,i=n.element,r=i===void 0?"[data-popper-arrow]":i;r!=null&&(typeof r=="string"&&(r=t.elements.popper.querySelector(r),!r)||!tk(t.elements.popper,r)||(t.elements.arrow=r))}var G7={name:"arrow",enabled:!0,phase:"main",fn:W7,effect:H7,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ul(e){return e.split("-")[1]}var V7={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Y7(e){var t=e.x,n=e.y,i=window,r=i.devicePixelRatio||1;return{x:al(t*r)/r||0,y:al(n*r)/r||0}}function ak(e){var t,n=e.popper,i=e.popperRect,r=e.placement,o=e.variation,a=e.offsets,s=e.position,u=e.gpuAcceleration,l=e.adaptive,c=e.roundOffsets,f=e.isFixed,d=a.x,h=d===void 0?0:d,g=a.y,p=g===void 0?0:g,m=typeof c=="function"?c({x:h,y:p}):{x:h,y:p};h=m.x,p=m.y;var y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),x=Gn,b=Hn,_=window;if(l){var E=lf(n),w="clientHeight",O="clientWidth";if(E===er(n)&&(E=fa(n),Co(E).position!=="static"&&s==="absolute"&&(w="scrollHeight",O="scrollWidth")),E=E,r===Hn||(r===Gn||r===Mi)&&o===sf){b=Fi;var S=f&&_.visualViewport?_.visualViewport.height:E[w];p-=S-i.height,p*=u?1:-1}if(r===Gn||(r===Hn||r===Fi)&&o===sf){x=Mi;var k=f&&_.visualViewport?_.visualViewport.width:E[O];h-=k-i.width,h*=u?1:-1}}var A=Object.assign({position:s},l&&V7),M=c===!0?Y7({x:h,y:p}):{x:h,y:p};if(h=M.x,p=M.y,u){var C;return Object.assign({},A,(C={},C[b]=v?"0":"",C[x]=y?"0":"",C.transform=(_.devicePixelRatio||1)<=1?"translate("+h+"px, "+p+"px)":"translate3d("+h+"px, "+p+"px, 0)",C))}return Object.assign({},A,(t={},t[b]=v?p+"px":"",t[x]=y?h+"px":"",t.transform="",t))}function X7(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=i===void 0?!0:i,o=n.adaptive,a=o===void 0?!0:o,s=n.roundOffsets,u=s===void 0?!0:s,l={placement:Nr(t.placement),variation:ul(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,ak(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,ak(Object.assign({},l,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var K7={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:X7,data:{}},gg={passive:!0};function J7(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,o=r===void 0?!0:r,a=i.resize,s=a===void 0?!0:a,u=er(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&l.forEach(function(c){c.addEventListener("scroll",n.update,gg)}),s&&u.addEventListener("resize",n.update,gg),function(){o&&l.forEach(function(c){c.removeEventListener("scroll",n.update,gg)}),s&&u.removeEventListener("resize",n.update,gg)}}var Q7={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:J7,data:{}},Z7={left:"right",right:"left",bottom:"top",top:"bottom"};function pg(e){return e.replace(/left|right|bottom|top/g,function(t){return Z7[t]})}var e9={start:"end",end:"start"};function sk(e){return e.replace(/start|end/g,function(t){return e9[t]})}function Ey(e){var t=er(e),n=t.pageXOffset,i=t.pageYOffset;return{scrollLeft:n,scrollTop:i}}function Oy(e){return sl(fa(e)).left+Ey(e).scrollLeft}function t9(e){var t=er(e),n=fa(e),i=t.visualViewport,r=n.clientWidth,o=n.clientHeight,a=0,s=0;return i&&(r=i.width,o=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=i.offsetLeft,s=i.offsetTop)),{width:r,height:o,x:a+Oy(e),y:s}}function n9(e){var t,n=fa(e),i=Ey(e),r=(t=e.ownerDocument)==null?void 0:t.body,o=ks(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=ks(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-i.scrollLeft+Oy(e),u=-i.scrollTop;return Co(r||n).direction==="rtl"&&(s+=ks(n.clientWidth,r?r.clientWidth:0)-o),{width:o,height:a,x:s,y:u}}function Sy(e){var t=Co(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function uk(e){return["html","body","#document"].indexOf(Dr(e))>=0?e.ownerDocument.body:Di(e)&&Sy(e)?e:uk(hg(e))}function ff(e,t){var n;t===void 0&&(t=[]);var i=uk(e),r=i===((n=e.ownerDocument)==null?void 0:n.body),o=er(i),a=r?[o].concat(o.visualViewport||[],Sy(i)?i:[]):i,s=t.concat(a);return r?s:s.concat(ff(hg(a)))}function Ay(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function i9(e){var t=sl(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function lk(e,t){return t===KA?Ay(t9(e)):ol(t)?i9(t):Ay(n9(fa(e)))}function r9(e){var t=ff(hg(e)),n=["absolute","fixed"].indexOf(Co(e).position)>=0,i=n&&Di(e)?lf(e):e;return ol(i)?t.filter(function(r){return ol(r)&&tk(r,i)&&Dr(r)!=="body"}):[]}function o9(e,t,n){var i=t==="clippingParents"?r9(e):[].concat(t),r=[].concat(i,[n]),o=r[0],a=r.reduce(function(s,u){var l=lk(e,u);return s.top=ks(l.top,s.top),s.right=dg(l.right,s.right),s.bottom=dg(l.bottom,s.bottom),s.left=ks(l.left,s.left),s},lk(e,o));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function ck(e){var t=e.reference,n=e.element,i=e.placement,r=i?Nr(i):null,o=i?ul(i):null,a=t.x+t.width/2-n.width/2,s=t.y+t.height/2-n.height/2,u;switch(r){case Hn:u={x:a,y:t.y-n.height};break;case Fi:u={x:a,y:t.y+t.height};break;case Mi:u={x:t.x+t.width,y:s};break;case Gn:u={x:t.x-n.width,y:s};break;default:u={x:t.x,y:t.y}}var l=r?_y(r):null;if(l!=null){var c=l==="y"?"height":"width";switch(o){case rl:u[l]=u[l]-(t[c]/2-n[c]/2);break;case sf:u[l]=u[l]+(t[c]/2-n[c]/2);break}}return u}function df(e,t){t===void 0&&(t={});var n=t,i=n.placement,r=i===void 0?e.placement:i,o=n.boundary,a=o===void 0?A7:o,s=n.rootBoundary,u=s===void 0?KA:s,l=n.elementContext,c=l===void 0?uf:l,f=n.altBoundary,d=f===void 0?!1:f,h=n.padding,g=h===void 0?0:h,p=rk(typeof g!="number"?g:ok(g,af)),m=c===uf?k7:uf,y=e.rects.popper,v=e.elements[d?m:c],x=o9(ol(v)?v:v.contextElement||fa(e.elements.popper),a,u),b=sl(e.elements.reference),_=ck({reference:b,element:y,strategy:"absolute",placement:r}),E=Ay(Object.assign({},y,_)),w=c===uf?E:b,O={top:x.top-w.top+p.top,bottom:w.bottom-x.bottom+p.bottom,left:x.left-w.left+p.left,right:w.right-x.right+p.right},S=e.modifiersData.offset;if(c===uf&&S){var k=S[r];Object.keys(O).forEach(function(A){var M=[Mi,Fi].indexOf(A)>=0?1:-1,C=[Hn,Fi].indexOf(A)>=0?"y":"x";O[A]+=k[C]*M})}return O}function a9(e,t){t===void 0&&(t={});var n=t,i=n.placement,r=n.boundary,o=n.rootBoundary,a=n.padding,s=n.flipVariations,u=n.allowedAutoPlacements,l=u===void 0?QA:u,c=ul(i),f=c?s?JA:JA.filter(function(g){return ul(g)===c}):af,d=f.filter(function(g){return l.indexOf(g)>=0});d.length===0&&(d=f);var h=d.reduce(function(g,p){return g[p]=df(e,{placement:p,boundary:r,rootBoundary:o,padding:a})[Nr(p)],g},{});return Object.keys(h).sort(function(g,p){return h[g]-h[p]})}function s9(e){if(Nr(e)===xy)return[];var t=pg(e);return[sk(e),t,sk(t)]}function u9(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,o=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!0:a,u=n.fallbackPlacements,l=n.padding,c=n.boundary,f=n.rootBoundary,d=n.altBoundary,h=n.flipVariations,g=h===void 0?!0:h,p=n.allowedAutoPlacements,m=t.options.placement,y=Nr(m),v=y===m,x=u||(v||!g?[pg(m)]:s9(m)),b=[m].concat(x).reduce(function(Oe,ke){return Oe.concat(Nr(ke)===xy?a9(t,{placement:ke,boundary:c,rootBoundary:f,padding:l,flipVariations:g,allowedAutoPlacements:p}):ke)},[]),_=t.rects.reference,E=t.rects.popper,w=new Map,O=!0,S=b[0],k=0;k<b.length;k++){var A=b[k],M=Nr(A),C=ul(A)===rl,D=[Hn,Fi].indexOf(M)>=0,F=D?"width":"height",N=df(t,{placement:A,boundary:c,rootBoundary:f,altBoundary:d,padding:l}),I=D?C?Mi:Gn:C?Fi:Hn;_[F]>E[F]&&(I=pg(I));var z=pg(I),X=[];if(o&&X.push(N[M]<=0),s&&X.push(N[I]<=0,N[z]<=0),X.every(function(Oe){return Oe})){S=A,O=!1;break}w.set(A,X)}if(O)for(var te=g?3:1,xe=function(ke){var Xe=b.find(function(xt){var Ge=w.get(xt);if(Ge)return Ge.slice(0,ke).every(function(Y){return Y})});if(Xe)return S=Xe,"break"},ge=te;ge>0;ge--){var je=xe(ge);if(je==="break")break}t.placement!==S&&(t.modifiersData[i]._skip=!0,t.placement=S,t.reset=!0)}}var l9={name:"flip",enabled:!0,phase:"main",fn:u9,requiresIfExists:["offset"],data:{_skip:!1}};function fk(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function dk(e){return[Hn,Mi,Fi,Gn].some(function(t){return e[t]>=0})}function c9(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,a=df(t,{elementContext:"reference"}),s=df(t,{altBoundary:!0}),u=fk(a,i),l=fk(s,r,o),c=dk(u),f=dk(l);t.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:l,isReferenceHidden:c,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}var f9={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:c9};function d9(e,t,n){var i=Nr(e),r=[Gn,Hn].indexOf(i)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,a=o[0],s=o[1];return a=a||0,s=(s||0)*r,[Gn,Mi].indexOf(i)>=0?{x:s,y:a}:{x:a,y:s}}function h9(e){var t=e.state,n=e.options,i=e.name,r=n.offset,o=r===void 0?[0,0]:r,a=QA.reduce(function(c,f){return c[f]=d9(f,t.rects,o),c},{}),s=a[t.placement],u=s.x,l=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=l),t.modifiersData[i]=a}var g9={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:h9};function p9(e){var t=e.state,n=e.name;t.modifiersData[n]=ck({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var m9={name:"popperOffsets",enabled:!0,phase:"read",fn:p9,data:{}};function y9(e){return e==="x"?"y":"x"}function v9(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,o=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!1:a,u=n.boundary,l=n.rootBoundary,c=n.altBoundary,f=n.padding,d=n.tether,h=d===void 0?!0:d,g=n.tetherOffset,p=g===void 0?0:g,m=df(t,{boundary:u,rootBoundary:l,padding:f,altBoundary:c}),y=Nr(t.placement),v=ul(t.placement),x=!v,b=_y(y),_=y9(b),E=t.modifiersData.popperOffsets,w=t.rects.reference,O=t.rects.popper,S=typeof p=="function"?p(Object.assign({},t.rects,{placement:t.placement})):p,k=typeof S=="number"?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),A=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,M={x:0,y:0};if(!!E){if(o){var C,D=b==="y"?Hn:Gn,F=b==="y"?Fi:Mi,N=b==="y"?"height":"width",I=E[b],z=I+m[D],X=I-m[F],te=h?-O[N]/2:0,xe=v===rl?w[N]:O[N],ge=v===rl?-O[N]:-w[N],je=t.elements.arrow,Oe=h&&je?wy(je):{width:0,height:0},ke=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:ik(),Xe=ke[D],xt=ke[F],Ge=cf(0,w[N],Oe[N]),Y=x?w[N]/2-te-Ge-Xe-k.mainAxis:xe-Ge-Xe-k.mainAxis,ne=x?-w[N]/2+te+Ge+xt+k.mainAxis:ge+Ge+xt+k.mainAxis,fe=t.elements.arrow&&lf(t.elements.arrow),B=fe?b==="y"?fe.clientTop||0:fe.clientLeft||0:0,Ve=(C=A==null?void 0:A[b])!=null?C:0,pe=I+Y-Ve-B,tt=I+ne-Ve,qe=cf(h?dg(z,pe):z,I,h?ks(X,tt):X);E[b]=qe,M[b]=qe-I}if(s){var ie,me=b==="x"?Hn:Gn,Ct=b==="x"?Fi:Mi,Ke=E[_],st=_==="y"?"height":"width",wt=Ke+m[me],an=Ke-m[Ct],Yt=[Hn,Gn].indexOf(y)!==-1,Ki=(ie=A==null?void 0:A[_])!=null?ie:0,nt=Yt?wt:Ke-w[st]-O[st]-Ki+k.altAxis,Tt=Yt?Ke+w[st]+O[st]-Ki-k.altAxis:an,sn=h&&Yt?U7(nt,Ke,Tt):cf(h?nt:wt,Ke,h?Tt:an);E[_]=sn,M[_]=sn-Ke}t.modifiersData[i]=M}}var b9={name:"preventOverflow",enabled:!0,phase:"main",fn:v9,requiresIfExists:["offset"]};function x9(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function w9(e){return e===er(e)||!Di(e)?Ey(e):x9(e)}function _9(e){var t=e.getBoundingClientRect(),n=al(t.width)/e.offsetWidth||1,i=al(t.height)/e.offsetHeight||1;return n!==1||i!==1}function E9(e,t,n){n===void 0&&(n=!1);var i=Di(t),r=Di(t)&&_9(t),o=fa(t),a=sl(e,r),s={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&((Dr(t)!=="body"||Sy(o))&&(s=w9(t)),Di(t)?(u=sl(t,!0),u.x+=t.clientLeft,u.y+=t.clientTop):o&&(u.x=Oy(o))),{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function O9(e){var t=new Map,n=new Set,i=[];e.forEach(function(o){t.set(o.name,o)});function r(o){n.add(o.name);var a=[].concat(o.requires||[],o.requiresIfExists||[]);a.forEach(function(s){if(!n.has(s)){var u=t.get(s);u&&r(u)}}),i.push(o)}return e.forEach(function(o){n.has(o.name)||r(o)}),i}function S9(e){var t=O9(e);return L7.reduce(function(n,i){return n.concat(t.filter(function(r){return r.phase===i}))},[])}function A9(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function k9(e){var t=e.reduce(function(n,i){var r=n[i.name];return n[i.name]=r?Object.assign({},r,i,{options:Object.assign({},r.options,i.options),data:Object.assign({},r.data,i.data)}):i,n},{});return Object.keys(t).map(function(n){return t[n]})}var hk={placement:"bottom",modifiers:[],strategy:"absolute"};function gk(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function C9(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,i=n===void 0?[]:n,r=t.defaultOptions,o=r===void 0?hk:r;return function(s,u,l){l===void 0&&(l=o);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},hk,o),modifiersData:{},elements:{reference:s,popper:u},attributes:{},styles:{}},f=[],d=!1,h={state:c,setOptions:function(y){var v=typeof y=="function"?y(c.options):y;p(),c.options=Object.assign({},o,c.options,v),c.scrollParents={reference:ol(s)?ff(s):s.contextElement?ff(s.contextElement):[],popper:ff(u)};var x=S9(k9([].concat(i,c.options.modifiers)));return c.orderedModifiers=x.filter(function(b){return b.enabled}),g(),h.update()},forceUpdate:function(){if(!d){var y=c.elements,v=y.reference,x=y.popper;if(!!gk(v,x)){c.rects={reference:E9(v,lf(x),c.options.strategy==="fixed"),popper:wy(x)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(k){return c.modifiersData[k.name]=Object.assign({},k.data)});for(var b=0;b<c.orderedModifiers.length;b++){if(c.reset===!0){c.reset=!1,b=-1;continue}var _=c.orderedModifiers[b],E=_.fn,w=_.options,O=w===void 0?{}:w,S=_.name;typeof E=="function"&&(c=E({state:c,options:O,name:S,instance:h})||c)}}}},update:A9(function(){return new Promise(function(m){h.forceUpdate(),m(c)})}),destroy:function(){p(),d=!0}};if(!gk(s,u))return h;h.setOptions(l).then(function(m){!d&&l.onFirstUpdate&&l.onFirstUpdate(m)});function g(){c.orderedModifiers.forEach(function(m){var y=m.name,v=m.options,x=v===void 0?{}:v,b=m.effect;if(typeof b=="function"){var _=b({state:c,name:y,instance:h,options:x}),E=function(){};f.push(_||E)}})}function p(){f.forEach(function(m){return m()}),f=[]}return h}}var T9=[Q7,m9,K7,ek,g9,l9,b9,G7,f9],F9=C9({defaultModifiers:T9}),M9="tippy-box",pk="tippy-content",D9="tippy-backdrop",mk="tippy-arrow",yk="tippy-svg-arrow",Cs={passive:!0,capture:!0},vk=function(){return document.body};function ky(e,t,n){if(Array.isArray(e)){var i=e[t];return i==null?Array.isArray(n)?n[t]:n:i}return e}function Cy(e,t){var n={}.toString.call(e);return n.indexOf("[object")===0&&n.indexOf(t+"]")>-1}function bk(e,t){return typeof e=="function"?e.apply(void 0,t):e}function xk(e,t){if(t===0)return e;var n;return function(i){clearTimeout(n),n=setTimeout(function(){e(i)},t)}}function N9(e){return e.split(/\s+/).filter(Boolean)}function ll(e){return[].concat(e)}function wk(e,t){e.indexOf(t)===-1&&e.push(t)}function R9(e){return e.filter(function(t,n){return e.indexOf(t)===n})}function j9(e){return e.split("-")[0]}function mg(e){return[].slice.call(e)}function _k(e){return Object.keys(e).reduce(function(t,n){return e[n]!==void 0&&(t[n]=e[n]),t},{})}function hf(){return document.createElement("div")}function yg(e){return["Element","Fragment"].some(function(t){return Cy(e,t)})}function $9(e){return Cy(e,"NodeList")}function L9(e){return Cy(e,"MouseEvent")}function I9(e){return!!(e&&e._tippy&&e._tippy.reference===e)}function P9(e){return yg(e)?[e]:$9(e)?mg(e):Array.isArray(e)?e:mg(document.querySelectorAll(e))}function Ty(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function Ek(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function z9(e){var t,n=ll(e),i=n[0];return i!=null&&(t=i.ownerDocument)!=null&&t.body?i.ownerDocument:document}function B9(e,t){var n=t.clientX,i=t.clientY;return e.every(function(r){var o=r.popperRect,a=r.popperState,s=r.props,u=s.interactiveBorder,l=j9(a.placement),c=a.modifiersData.offset;if(!c)return!0;var f=l==="bottom"?c.top.y:0,d=l==="top"?c.bottom.y:0,h=l==="right"?c.left.x:0,g=l==="left"?c.right.x:0,p=o.top-i+f>u,m=i-o.bottom-d>u,y=o.left-n+h>u,v=n-o.right-g>u;return p||m||y||v})}function Fy(e,t,n){var i=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(r){e[i](r,n)})}function Ok(e,t){for(var n=t;n;){var i;if(e.contains(n))return!0;n=n.getRootNode==null||(i=n.getRootNode())==null?void 0:i.host}return!1}var Rr={isTouch:!1},Sk=0;function U9(){Rr.isTouch||(Rr.isTouch=!0,window.performance&&document.addEventListener("mousemove",Ak))}function Ak(){var e=performance.now();e-Sk<20&&(Rr.isTouch=!1,document.removeEventListener("mousemove",Ak)),Sk=e}function q9(){var e=document.activeElement;if(I9(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}function W9(){document.addEventListener("touchstart",U9,Cs),window.addEventListener("blur",q9)}var H9=typeof window!="undefined"&&typeof document!="undefined",G9=H9?!!window.msCrypto:!1,V9={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Y9={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},tr=Object.assign({appendTo:vk,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},V9,Y9),X9=Object.keys(tr),K9=function(t){var n=Object.keys(t);n.forEach(function(i){tr[i]=t[i]})};function kk(e){var t=e.plugins||[],n=t.reduce(function(i,r){var o=r.name,a=r.defaultValue;if(o){var s;i[o]=e[o]!==void 0?e[o]:(s=tr[o])!=null?s:a}return i},{});return Object.assign({},e,n)}function J9(e,t){var n=t?Object.keys(kk(Object.assign({},tr,{plugins:t}))):X9,i=n.reduce(function(r,o){var a=(e.getAttribute("data-tippy-"+o)||"").trim();if(!a)return r;if(o==="content")r[o]=a;else try{r[o]=JSON.parse(a)}catch{r[o]=a}return r},{});return i}function Ck(e,t){var n=Object.assign({},t,{content:bk(t.content,[e])},t.ignoreAttributes?{}:J9(e,t.plugins));return n.aria=Object.assign({},tr.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?t.interactive:n.aria.expanded,content:n.aria.content==="auto"?t.interactive?null:"describedby":n.aria.content},n}var Q9=function(){return"innerHTML"};function My(e,t){e[Q9()]=t}function Tk(e){var t=hf();return e===!0?t.className=mk:(t.className=yk,yg(e)?t.appendChild(e):My(t,e)),t}function Fk(e,t){yg(t.content)?(My(e,""),e.appendChild(t.content)):typeof t.content!="function"&&(t.allowHTML?My(e,t.content):e.textContent=t.content)}function Dy(e){var t=e.firstElementChild,n=mg(t.children);return{box:t,content:n.find(function(i){return i.classList.contains(pk)}),arrow:n.find(function(i){return i.classList.contains(mk)||i.classList.contains(yk)}),backdrop:n.find(function(i){return i.classList.contains(D9)})}}function Mk(e){var t=hf(),n=hf();n.className=M9,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var i=hf();i.className=pk,i.setAttribute("data-state","hidden"),Fk(i,e.props),t.appendChild(n),n.appendChild(i),r(e.props,e.props);function r(o,a){var s=Dy(t),u=s.box,l=s.content,c=s.arrow;a.theme?u.setAttribute("data-theme",a.theme):u.removeAttribute("data-theme"),typeof a.animation=="string"?u.setAttribute("data-animation",a.animation):u.removeAttribute("data-animation"),a.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof a.maxWidth=="number"?a.maxWidth+"px":a.maxWidth,a.role?u.setAttribute("role",a.role):u.removeAttribute("role"),(o.content!==a.content||o.allowHTML!==a.allowHTML)&&Fk(l,e.props),a.arrow?c?o.arrow!==a.arrow&&(u.removeChild(c),u.appendChild(Tk(a.arrow))):u.appendChild(Tk(a.arrow)):c&&u.removeChild(c)}return{popper:t,onUpdate:r}}Mk.$$tippy=!0;var Z9=1,vg=[],Ny=[];function ez(e,t){var n=Ck(e,Object.assign({},tr,kk(_k(t)))),i,r,o,a=!1,s=!1,u=!1,l=!1,c,f,d,h=[],g=xk(pe,n.interactiveDebounce),p,m=Z9++,y=null,v=R9(n.plugins),x={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},b={id:m,reference:e,popper:hf(),popperInstance:y,props:n,state:x,plugins:v,clearDelayTimeouts:nt,setProps:Tt,setContent:sn,show:Xt,hide:di,hideWithInteractivity:Yc,enable:Yt,disable:Ki,unmount:Oo,destroy:Xc};if(!n.render)return b;var _=n.render(b),E=_.popper,w=_.onUpdate;E.setAttribute("data-tippy-root",""),E.id="tippy-"+b.id,b.popper=E,e._tippy=b,E._tippy=b;var O=v.map(function($){return $.fn(b)}),S=e.hasAttribute("aria-expanded");return fe(),te(),I(),z("onCreate",[b]),n.showOnCreate&&wt(),E.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),E.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&D().addEventListener("mousemove",g)}),b;function k(){var $=b.props.touch;return Array.isArray($)?$:[$,0]}function A(){return k()[0]==="hold"}function M(){var $;return!!(($=b.props.render)!=null&&$.$$tippy)}function C(){return p||e}function D(){var $=C().parentNode;return $?z9($):document}function F(){return Dy(E)}function N($){return b.state.isMounted&&!b.state.isVisible||Rr.isTouch||c&&c.type==="focus"?0:ky(b.props.delay,$?0:1,tr.delay)}function I($){$===void 0&&($=!1),E.style.pointerEvents=b.props.interactive&&!$?"":"none",E.style.zIndex=""+b.props.zIndex}function z($,Z,de){if(de===void 0&&(de=!0),O.forEach(function(Ce){Ce[$]&&Ce[$].apply(Ce,Z)}),de){var Be;(Be=b.props)[$].apply(Be,Z)}}function X(){var $=b.props.aria;if(!!$.content){var Z="aria-"+$.content,de=E.id,Be=ll(b.props.triggerTarget||e);Be.forEach(function(Ce){var Kt=Ce.getAttribute(Z);if(b.state.isVisible)Ce.setAttribute(Z,Kt?Kt+" "+de:de);else{var kn=Kt&&Kt.replace(de,"").trim();kn?Ce.setAttribute(Z,kn):Ce.removeAttribute(Z)}})}}function te(){if(!(S||!b.props.aria.expanded)){var $=ll(b.props.triggerTarget||e);$.forEach(function(Z){b.props.interactive?Z.setAttribute("aria-expanded",b.state.isVisible&&Z===C()?"true":"false"):Z.removeAttribute("aria-expanded")})}}function xe(){D().removeEventListener("mousemove",g),vg=vg.filter(function($){return $!==g})}function ge($){if(!(Rr.isTouch&&(u||$.type==="mousedown"))){var Z=$.composedPath&&$.composedPath()[0]||$.target;if(!(b.props.interactive&&Ok(E,Z))){if(ll(b.props.triggerTarget||e).some(function(de){return Ok(de,Z)})){if(Rr.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else z("onClickOutside",[b,$]);b.props.hideOnClick===!0&&(b.clearDelayTimeouts(),b.hide(),s=!0,setTimeout(function(){s=!1}),b.state.isMounted||Xe())}}}function je(){u=!0}function Oe(){u=!1}function ke(){var $=D();$.addEventListener("mousedown",ge,!0),$.addEventListener("touchend",ge,Cs),$.addEventListener("touchstart",Oe,Cs),$.addEventListener("touchmove",je,Cs)}function Xe(){var $=D();$.removeEventListener("mousedown",ge,!0),$.removeEventListener("touchend",ge,Cs),$.removeEventListener("touchstart",Oe,Cs),$.removeEventListener("touchmove",je,Cs)}function xt($,Z){Y($,function(){!b.state.isVisible&&E.parentNode&&E.parentNode.contains(E)&&Z()})}function Ge($,Z){Y($,Z)}function Y($,Z){var de=F().box;function Be(Ce){Ce.target===de&&(Fy(de,"remove",Be),Z())}if($===0)return Z();Fy(de,"remove",f),Fy(de,"add",Be),f=Be}function ne($,Z,de){de===void 0&&(de=!1);var Be=ll(b.props.triggerTarget||e);Be.forEach(function(Ce){Ce.addEventListener($,Z,de),h.push({node:Ce,eventType:$,handler:Z,options:de})})}function fe(){A()&&(ne("touchstart",Ve,{passive:!0}),ne("touchend",tt,{passive:!0})),N9(b.props.trigger).forEach(function($){if($!=="manual")switch(ne($,Ve),$){case"mouseenter":ne("mouseleave",tt);break;case"focus":ne(G9?"focusout":"blur",qe);break;case"focusin":ne("focusout",qe);break}})}function B(){h.forEach(function($){var Z=$.node,de=$.eventType,Be=$.handler,Ce=$.options;Z.removeEventListener(de,Be,Ce)}),h=[]}function Ve($){var Z,de=!1;if(!(!b.state.isEnabled||ie($)||s)){var Be=((Z=c)==null?void 0:Z.type)==="focus";c=$,p=$.currentTarget,te(),!b.state.isVisible&&L9($)&&vg.forEach(function(Ce){return Ce($)}),$.type==="click"&&(b.props.trigger.indexOf("mouseenter")<0||a)&&b.props.hideOnClick!==!1&&b.state.isVisible?de=!0:wt($),$.type==="click"&&(a=!de),de&&!Be&&an($)}}function pe($){var Z=$.target,de=C().contains(Z)||E.contains(Z);if(!($.type==="mousemove"&&de)){var Be=st().concat(E).map(function(Ce){var Kt,kn=Ce._tippy,sa=(Kt=kn.popperInstance)==null?void 0:Kt.state;return sa?{popperRect:Ce.getBoundingClientRect(),popperState:sa,props:n}:null}).filter(Boolean);B9(Be,$)&&(xe(),an($))}}function tt($){var Z=ie($)||b.props.trigger.indexOf("click")>=0&&a;if(!Z){if(b.props.interactive){b.hideWithInteractivity($);return}an($)}}function qe($){b.props.trigger.indexOf("focusin")<0&&$.target!==C()||b.props.interactive&&$.relatedTarget&&E.contains($.relatedTarget)||an($)}function ie($){return Rr.isTouch?A()!==$.type.indexOf("touch")>=0:!1}function me(){Ct();var $=b.props,Z=$.popperOptions,de=$.placement,Be=$.offset,Ce=$.getReferenceClientRect,Kt=$.moveTransition,kn=M()?Dy(E).arrow:null,sa=Ce?{getBoundingClientRect:Ce,contextElement:Ce.contextElement||C()}:e,_s={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Os){var So=Os.state;if(M()){var Wu=F(),Hu=Wu.box;["placement","reference-hidden","escaped"].forEach(function(Gu){Gu==="placement"?Hu.setAttribute("data-placement",So.placement):So.attributes.popper["data-popper-"+Gu]?Hu.setAttribute("data-"+Gu,""):Hu.removeAttribute("data-"+Gu)}),So.attributes.popper={}}}},Fr=[{name:"offset",options:{offset:Be}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Kt}},_s];M()&&kn&&Fr.push({name:"arrow",options:{element:kn,padding:3}}),Fr.push.apply(Fr,(Z==null?void 0:Z.modifiers)||[]),b.popperInstance=F9(sa,E,Object.assign({},Z,{placement:de,onFirstUpdate:d,modifiers:Fr}))}function Ct(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Ke(){var $=b.props.appendTo,Z,de=C();b.props.interactive&&$===vk||$==="parent"?Z=de.parentNode:Z=bk($,[de]),Z.contains(E)||Z.appendChild(E),b.state.isMounted=!0,me()}function st(){return mg(E.querySelectorAll("[data-tippy-root]"))}function wt($){b.clearDelayTimeouts(),$&&z("onTrigger",[b,$]),ke();var Z=N(!0),de=k(),Be=de[0],Ce=de[1];Rr.isTouch&&Be==="hold"&&Ce&&(Z=Ce),Z?i=setTimeout(function(){b.show()},Z):b.show()}function an($){if(b.clearDelayTimeouts(),z("onUntrigger",[b,$]),!b.state.isVisible){Xe();return}if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf($.type)>=0&&a)){var Z=N(!1);Z?r=setTimeout(function(){b.state.isVisible&&b.hide()},Z):o=requestAnimationFrame(function(){b.hide()})}}function Yt(){b.state.isEnabled=!0}function Ki(){b.hide(),b.state.isEnabled=!1}function nt(){clearTimeout(i),clearTimeout(r),cancelAnimationFrame(o)}function Tt($){if(!b.state.isDestroyed){z("onBeforeUpdate",[b,$]),B();var Z=b.props,de=Ck(e,Object.assign({},Z,_k($),{ignoreAttributes:!0}));b.props=de,fe(),Z.interactiveDebounce!==de.interactiveDebounce&&(xe(),g=xk(pe,de.interactiveDebounce)),Z.triggerTarget&&!de.triggerTarget?ll(Z.triggerTarget).forEach(function(Be){Be.removeAttribute("aria-expanded")}):de.triggerTarget&&e.removeAttribute("aria-expanded"),te(),I(),w&&w(Z,de),b.popperInstance&&(me(),st().forEach(function(Be){requestAnimationFrame(Be._tippy.popperInstance.forceUpdate)})),z("onAfterUpdate",[b,$])}}function sn($){b.setProps({content:$})}function Xt(){var $=b.state.isVisible,Z=b.state.isDestroyed,de=!b.state.isEnabled,Be=Rr.isTouch&&!b.props.touch,Ce=ky(b.props.duration,0,tr.duration);if(!($||Z||de||Be)&&!C().hasAttribute("disabled")&&(z("onShow",[b],!1),b.props.onShow(b)!==!1)){if(b.state.isVisible=!0,M()&&(E.style.visibility="visible"),I(),ke(),b.state.isMounted||(E.style.transition="none"),M()){var Kt=F(),kn=Kt.box,sa=Kt.content;Ty([kn,sa],0)}d=function(){var Fr;if(!(!b.state.isVisible||l)){if(l=!0,E.offsetHeight,E.style.transition=b.props.moveTransition,M()&&b.props.animation){var Es=F(),Os=Es.box,So=Es.content;Ty([Os,So],Ce),Ek([Os,So],"visible")}X(),te(),wk(Ny,b),(Fr=b.popperInstance)==null||Fr.forceUpdate(),z("onMount",[b]),b.props.animation&&M()&&Ge(Ce,function(){b.state.isShown=!0,z("onShown",[b])})}},Ke()}}function di(){var $=!b.state.isVisible,Z=b.state.isDestroyed,de=!b.state.isEnabled,Be=ky(b.props.duration,1,tr.duration);if(!($||Z||de)&&(z("onHide",[b],!1),b.props.onHide(b)!==!1)){if(b.state.isVisible=!1,b.state.isShown=!1,l=!1,a=!1,M()&&(E.style.visibility="hidden"),xe(),Xe(),I(!0),M()){var Ce=F(),Kt=Ce.box,kn=Ce.content;b.props.animation&&(Ty([Kt,kn],Be),Ek([Kt,kn],"hidden"))}X(),te(),b.props.animation?M()&&xt(Be,b.unmount):b.unmount()}}function Yc($){D().addEventListener("mousemove",g),wk(vg,g),g($)}function Oo(){b.state.isVisible&&b.hide(),!!b.state.isMounted&&(Ct(),st().forEach(function($){$._tippy.unmount()}),E.parentNode&&E.parentNode.removeChild(E),Ny=Ny.filter(function($){return $!==b}),b.state.isMounted=!1,z("onHidden",[b]))}function Xc(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),B(),delete e._tippy,b.state.isDestroyed=!0,z("onDestroy",[b]))}}function bg(e,t){t===void 0&&(t={});var n=tr.plugins.concat(t.plugins||[]);W9();var i=Object.assign({},t,{plugins:n}),r=P9(e),o=r.reduce(function(a,s){var u=s&&ez(s,i);return u&&a.push(u),a},[]);return yg(e)?o[0]:o}bg.defaultProps=tr;bg.setDefaultProps=K9;bg.currentInput=Rr;Object.assign({},ek,{effect:function(t){var n=t.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow)}});bg.setDefaultProps({render:Mk});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var tz=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),nz=Object.prototype.hasOwnProperty;function Ry(e,t){return nz.call(e,t)}function jy(e){if(Array.isArray(e)){for(var n=new Array(e.length),t=0;t<n.length;t++)n[t]=""+t;return n}if(Object.keys)return Object.keys(e);var n=[];for(var i in e)Ry(e,i)&&n.push(i);return n}function mi(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function $y(e){for(var t=0,n=e.length,i;t<n;){if(i=e.charCodeAt(t),i>=48&&i<=57){t++;continue}return!1}return!0}function Ts(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function Dk(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function Ly(e){if(e===void 0)return!0;if(e){if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(Ly(e[t]))return!0}else if(typeof e=="object"){for(var i=jy(e),r=i.length,t=0;t<r;t++)if(Ly(e[i[t]]))return!0}}return!1}function Nk(e,t){var n=[e];for(var i in t){var r=typeof t[i]=="object"?JSON.stringify(t[i],null,2):t[i];typeof r!="undefined"&&n.push(i+": "+r)}return n.join(`
`)}var Rk=function(e){tz(t,e);function t(n,i,r,o,a){var s=this.constructor,u=e.call(this,Nk(n,{name:i,index:r,operation:o,tree:a}))||this;return u.name=i,u.index=r,u.operation=o,u.tree=a,Object.setPrototypeOf(u,s.prototype),u.message=Nk(n,{name:i,index:r,operation:o,tree:a}),u}return t}(Error),mt=Rk,iz=mi,cl={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var i=e[t];return delete e[t],{newDocument:n,removed:i}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:function(e,t,n){var i=xg(n,this.path);i&&(i=mi(i));var r=Fs(n,{op:"remove",path:this.from}).removed;return Fs(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(e,t,n){var i=xg(n,this.from);return Fs(n,{op:"add",path:this.path,value:mi(i)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:gf(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},rz={add:function(e,t,n){return $y(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){var i=e.splice(t,1);return{newDocument:n,removed:i[0]}},replace:function(e,t,n){var i=e[t];return e[t]=this.value,{newDocument:n,removed:i}},move:cl.move,copy:cl.copy,test:cl.test,_get:cl._get};function xg(e,t){if(t=="")return e;var n={op:"_get",path:t};return Fs(e,n),n.value}function Fs(e,t,n,i,r,o){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=0),n&&(typeof n=="function"?n(t,0,e,t.path):_g(t,0)),t.path===""){var a={newDocument:e};if(t.op==="add")return a.newDocument=t.value,a;if(t.op==="replace")return a.newDocument=t.value,a.removed=e,a;if(t.op==="move"||t.op==="copy")return a.newDocument=xg(e,t.from),t.op==="move"&&(a.removed=e),a;if(t.op==="test"){if(a.test=gf(e,t.value),a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a.newDocument=e,a}else{if(t.op==="remove")return a.removed=e,a.newDocument=null,a;if(t.op==="_get")return t.value=e,a;if(n)throw new mt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,t,e);return a}}else{i||(e=mi(e));var s=t.path||"",u=s.split("/"),l=e,c=1,f=u.length,d=void 0,h=void 0,g=void 0;for(typeof n=="function"?g=n:g=_g;;){if(h=u[c],h&&h.indexOf("~")!=-1&&(h=Dk(h)),r&&h=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[h]===void 0?d=u.slice(0,c).join("/"):c==f-1&&(d=t.path),d!==void 0&&g(t,0,e,d)),c++,Array.isArray(l)){if(h==="-")h=l.length;else{if(n&&!$y(h))throw new mt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,t,e);$y(h)&&(h=~~h)}if(c>=f){if(n&&t.op==="add"&&h>l.length)throw new mt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,t,e);var a=rz[t.op].call(t,l,h,e);if(a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}}else if(c>=f){var a=cl[t.op].call(t,l,h,e);if(a.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",o,t,e);return a}if(l=l[h],n&&c<f&&(!l||typeof l!="object"))throw new mt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,t,e)}}}function wg(e,t,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(t))throw new mt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=mi(e));for(var o=new Array(t.length),a=0,s=t.length;a<s;a++)o[a]=Fs(e,t[a],n,!0,r,a),e=o[a].newDocument;return o.newDocument=e,o}function oz(e,t,n){var i=Fs(e,t);if(i.test===!1)throw new mt("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return i.newDocument}function _g(e,t,n,i){if(typeof e!="object"||e===null||Array.isArray(e))throw new mt("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(cl[e.op]){if(typeof e.path!="string")throw new mt("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(e.path.indexOf("/")!==0&&e.path.length>0)throw new mt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if((e.op==="move"||e.op==="copy")&&typeof e.from!="string")throw new mt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&e.value===void 0)throw new mt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if((e.op==="add"||e.op==="replace"||e.op==="test")&&Ly(e.value))throw new mt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n){if(e.op=="add"){var r=e.path.split("/").length,o=i.split("/").length;if(r!==o+1&&r!==o)throw new mt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if(e.op==="replace"||e.op==="remove"||e.op==="_get"){if(e.path!==i)throw new mt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if(e.op==="move"||e.op==="copy"){var a={op:"_get",path:e.from,value:void 0},s=jk([a],n);if(s&&s.name==="OPERATION_PATH_UNRESOLVABLE")throw new mt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}}else throw new mt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n)}function jk(e,t,n){try{if(!Array.isArray(e))throw new mt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)wg(mi(t),mi(e),n||!0);else{n=n||_g;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(r){if(r instanceof mt)return r;throw r}}function gf(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=Array.isArray(e),i=Array.isArray(t),r,o,a;if(n&&i){if(o=e.length,o!=t.length)return!1;for(r=o;r--!=0;)if(!gf(e[r],t[r]))return!1;return!0}if(n!=i)return!1;var s=Object.keys(e);if(o=s.length,o!==Object.keys(t).length)return!1;for(r=o;r--!=0;)if(!t.hasOwnProperty(s[r]))return!1;for(r=o;r--!=0;)if(a=s[r],!gf(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}var az=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:mt,deepClone:iz,getValueByPointer:xg,applyOperation:Fs,applyPatch:wg,applyReducer:oz,validator:_g,validate:jk,_areEquals:gf});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Iy=new WeakMap,sz=function(){function e(t){this.observers=new Map,this.obj=t}return e}(),uz=function(){function e(t,n){this.callback=t,this.observer=n}return e}();function lz(e){return Iy.get(e)}function cz(e,t){return e.observers.get(t)}function fz(e,t){e.observers.delete(t.callback)}function dz(e,t){t.unobserve()}function hz(e,t){var n=[],i,r=lz(e);if(!r)r=new sz(e),Iy.set(e,r);else{var o=cz(r,t);i=o&&o.observer}if(i)return i;if(i={},r.value=mi(e),t){i.callback=t,i.next=null;var a=function(){Py(i)},s=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window!="undefined"&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return i.patches=n,i.object=e,i.unobserve=function(){Py(i),clearTimeout(i.next),fz(r,i),typeof window!="undefined"&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(t,new uz(t,i)),i}function Py(e,t){t===void 0&&(t=!1);var n=Iy.get(e.object);zy(n.value,e.object,e.patches,"",t),e.patches.length&&wg(n.value,e.patches);var i=e.patches;return i.length>0&&(e.patches=[],e.callback&&e.callback(i)),i}function zy(e,t,n,i,r){if(t!==e){typeof t.toJSON=="function"&&(t=t.toJSON());for(var o=jy(t),a=jy(e),s=!1,u=a.length-1;u>=0;u--){var l=a[u],c=e[l];if(Ry(t,l)&&!(t[l]===void 0&&c!==void 0&&Array.isArray(t)===!1)){var f=t[l];typeof c=="object"&&c!=null&&typeof f=="object"&&f!=null&&Array.isArray(c)===Array.isArray(f)?zy(c,f,n,i+"/"+Ts(l),r):c!==f&&(r&&n.push({op:"test",path:i+"/"+Ts(l),value:mi(c)}),n.push({op:"replace",path:i+"/"+Ts(l),value:mi(f)}))}else Array.isArray(e)===Array.isArray(t)?(r&&n.push({op:"test",path:i+"/"+Ts(l),value:mi(c)}),n.push({op:"remove",path:i+"/"+Ts(l)}),s=!0):(r&&n.push({op:"test",path:i,value:e}),n.push({op:"replace",path:i,value:t}))}if(!(!s&&o.length==a.length))for(var u=0;u<o.length;u++){var l=o[u];!Ry(e,l)&&t[l]!==void 0&&n.push({op:"add",path:i+"/"+Ts(l),value:mi(t[l])})}}}function gz(e,t,n){n===void 0&&(n=!1);var i=[];return zy(e,t,i,"",n),i}var pz=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:dz,observe:hz,generate:Py,compare:gz});Object.assign({},az,pz,{JsonPatchError:Rk,deepClone:mi,escapePathComponent:Ts,unescapePathComponent:Dk});var ube=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},mz=/("(?:[^\\"]|\\.)*")|[:,]/g,By=function(t,n){var i,r,o;return n=n||{},i=JSON.stringify([1],void 0,n.indent===void 0?2:n.indent).slice(2,-3),r=i===""?1/0:n.maxLength===void 0?80:n.maxLength,o=n.replacer,function a(s,u,l){var c,f,d,h,g,p,m,y,v,x,b,_;if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),b=JSON.stringify(s,o),b===void 0)return b;if(m=r-u.length-l,b.length<=m&&(v=b.replace(mz,function(E,w){return w||E+" "}),v.length<=m))return v;if(o!=null&&(s=JSON.parse(b),o=void 0),typeof s=="object"&&s!==null){if(y=u+i,d=[],f=0,Array.isArray(s))for(x="[",c="]",m=s.length;f<m;f++)d.push(a(s[f],y,f===m-1?0:1)||"null");else for(x="{",c="}",p=Object.keys(s),m=p.length;f<m;f++)h=p[f],g=JSON.stringify(h)+": ",_=a(s[h],y,g.length+(f===m-1?0:1)),_!==void 0&&d.push(g+_);if(d.length>0)return[x,i+d.join(`,
`+y),c].join(`
`+u)}return b}(t,"",0)};function Vn(e,t,n){return e.fields=t||[],e.fname=n,e}function yt(e){return e==null?null:e.fname}function fn(e){return e==null?null:e.fields}function $k(e){return e.length===1?yz(e[0]):vz(e)}const yz=e=>function(t){return t[e]},vz=e=>{const t=e.length;return function(n){for(let i=0;i<t;++i)n=n[e[i]];return n}};function L(e){throw Error(e)}function jr(e){const t=[],n=e.length;let i=null,r=0,o="",a,s,u;e=e+"";function l(){t.push(o+e.substring(a,s)),o="",a=s+1}for(a=s=0;s<n;++s)if(u=e[s],u==="\\")o+=e.substring(a,s),o+=e.substring(++s,++s),a=s;else if(u===i)l(),i=null,r=-1;else{if(i)continue;a===r&&u==='"'||a===r&&u==="'"?(a=s+1,i=u):u==="."&&!r?s>a?l():a=s+1:u==="["?(s>a&&l(),r=a=s+1):u==="]"&&(r||L("Access path missing open bracket: "+e),r>0&&l(),r=0,a=s+1)}return r&&L("Access path missing closing bracket: "+e),i&&L("Access path missing closing quote: "+e),s>a&&(s++,l()),t}function Yn(e,t,n){const i=jr(e);return e=i.length===1?i[0]:e,Vn((n&&n.get||$k)(i),[e],t||e)}const pf=Yn("id"),dn=Vn(e=>e,[],"identity"),da=Vn(()=>0,[],"zero"),fl=Vn(()=>1,[],"one"),Ni=Vn(()=>!0,[],"true"),ha=Vn(()=>!1,[],"false");function bz(e,t,n){const i=[t].concat([].slice.call(n));console[e].apply(console,i)}const Lk=0,Uy=1,qy=2,Ik=3,Pk=4;function Wy(e,t,n=bz){let i=e||Lk;return{level(r){return arguments.length?(i=+r,this):i},error(){return i>=Uy&&n(t||"error","ERROR",arguments),this},warn(){return i>=qy&&n(t||"warn","WARN",arguments),this},info(){return i>=Ik&&n(t||"log","INFO",arguments),this},debug(){return i>=Pk&&n(t||"log","DEBUG",arguments),this}}}var P=Array.isArray;function Q(e){return e===Object(e)}const zk=e=>e!=="__proto__";function dl(...e){return e.reduce((t,n)=>{for(const i in n)if(i==="signals")t.signals=xz(t.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;hl(t,i,n[i],r)}return t},{})}function hl(e,t,n,i){if(!zk(t))return;let r,o;if(Q(n)&&!P(n)){o=Q(e[t])?e[t]:e[t]={};for(r in n)i&&(i===!0||i[r])?hl(o,r,n[r]):zk(r)&&(o[r]=n[r])}else e[t]=n}function xz(e,t){if(e==null)return t;const n={},i=[];function r(o){n[o.name]||(n[o.name]=1,i.push(o))}return t.forEach(r),e.forEach(r),i}function Fe(e){return e[e.length-1]}function hn(e){return e==null||e===""?null:+e}const Bk=e=>t=>e*Math.exp(t),Uk=e=>t=>Math.log(e*t),qk=e=>t=>Math.sign(t)*Math.log1p(Math.abs(t/e)),Wk=e=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*e,Eg=e=>t=>t<0?-Math.pow(-t,e):Math.pow(t,e);function Og(e,t,n,i){const r=n(e[0]),o=n(Fe(e)),a=(o-r)*t;return[i(r-a),i(o-a)]}function Hk(e,t){return Og(e,t,hn,dn)}function Gk(e,t){var n=Math.sign(e[0]);return Og(e,t,Uk(n),Bk(n))}function Vk(e,t,n){return Og(e,t,Eg(n),Eg(1/n))}function Yk(e,t,n){return Og(e,t,qk(n),Wk(n))}function Sg(e,t,n,i,r){const o=i(e[0]),a=i(Fe(e)),s=t!=null?i(t):(o+a)/2;return[r(s+(o-s)*n),r(s+(a-s)*n)]}function Hy(e,t,n){return Sg(e,t,n,hn,dn)}function Gy(e,t,n){const i=Math.sign(e[0]);return Sg(e,t,n,Uk(i),Bk(i))}function Ag(e,t,n,i){return Sg(e,t,n,Eg(i),Eg(1/i))}function Vy(e,t,n,i){return Sg(e,t,n,qk(i),Wk(i))}function Xk(e){return 1+~~(new Date(e).getMonth()/3)}function Kk(e){return 1+~~(new Date(e).getUTCMonth()/3)}function J(e){return e!=null?P(e)?e:[e]:[]}function Jk(e,t,n){let i=e[0],r=e[1],o;return r<i&&(o=r,r=i,i=o),o=r-i,o>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-o),i+o]}function _e(e){return typeof e=="function"}const wz="descending";function Yy(e,t,n){n=n||{},t=J(t)||[];const i=[],r=[],o={},a=n.comparator||_z;return J(e).forEach((s,u)=>{s!=null&&(i.push(t[u]===wz?-1:1),r.push(s=_e(s)?s:Yn(s,null,n)),(fn(s)||[]).forEach(l=>o[l]=1))}),r.length===0?null:Vn(a(r,i),Object.keys(o))}const kg=(e,t)=>(e<t||e==null)&&t!=null?-1:(e>t||t==null)&&e!=null?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0),_z=(e,t)=>e.length===1?Ez(e[0],t[0]):Oz(e,t,e.length),Ez=(e,t)=>function(n,i){return kg(e(n),e(i))*t},Oz=(e,t,n)=>(t.push(0),function(i,r){let o,a=0,s=-1;for(;a===0&&++s<n;)o=e[s],a=kg(o(i),o(r));return a*t[s]});function gn(e){return _e(e)?e:()=>e}function Xy(e,t){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(t(i),n=null),e)}}function Ee(e){for(let t,n,i=1,r=arguments.length;i<r;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e}function $r(e,t){let n=0,i,r,o,a;if(e&&(i=e.length))if(t==null){for(r=e[n];n<i&&(r==null||r!==r);r=e[++n]);for(o=a=r;n<i;++n)r=e[n],r!=null&&(r<o&&(o=r),r>a&&(a=r))}else{for(r=t(e[n]);n<i&&(r==null||r!==r);r=t(e[++n]));for(o=a=r;n<i;++n)r=t(e[n]),r!=null&&(r<o&&(o=r),r>a&&(a=r))}return[o,a]}function Qk(e,t){const n=e.length;let i=-1,r,o,a,s,u;if(t==null){for(;++i<n;)if(o=e[i],o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=e[i],o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}else{for(;++i<n;)if(o=t(e[i],i,e),o!=null&&o>=o){r=a=o;break}if(i===n)return[-1,-1];for(s=u=i;++i<n;)o=t(e[i],i,e),o!=null&&(r>o&&(r=o,s=i),a<o&&(a=o,u=i))}return[s,u]}const Sz=Object.prototype.hasOwnProperty;function re(e,t){return Sz.call(e,t)}const Cg={};function gl(e){let t={},n;function i(o){return re(t,o)&&t[o]!==Cg}const r={size:0,empty:0,object:t,has:i,get(o){return i(o)?t[o]:void 0},set(o,a){return i(o)||(++r.size,t[o]===Cg&&--r.empty),t[o]=a,this},delete(o){return i(o)&&(--r.size,++r.empty,t[o]=Cg),this},clear(){r.size=r.empty=0,r.object=t={}},test(o){return arguments.length?(n=o,r):n},clean(){const o={};let a=0;for(const s in t){const u=t[s];u!==Cg&&(!n||!n(u))&&(o[s]=u,++a)}r.size=a,r.empty=0,r.object=t=o}};return e&&Object.keys(e).forEach(o=>{r.set(o,e[o])}),r}function Zk(e,t,n,i,r,o){if(!n&&n!==0)return o;const a=+n;let s=e[0],u=Fe(e),l;u<s&&(l=s,s=u,u=l),l=Math.abs(t-s);const c=Math.abs(u-t);return l<c&&l<=a?i:c<=a?r:o}function W(e,t,n){const i=e.prototype=Object.create(t.prototype);return Object.defineProperty(i,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Ee(i,n)}function pl(e,t,n,i){let r=t[0],o=t[t.length-1],a;return r>o&&(a=r,r=o,o=a),n=n===void 0||n,i=i===void 0||i,(n?r<=e:r<e)&&(i?e<=o:e<o)}function ga(e){return typeof e=="boolean"}function pa(e){return Object.prototype.toString.call(e)==="[object Date]"}function eC(e){return e&&_e(e[Symbol.iterator])}function Je(e){return typeof e=="number"}function tC(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function K(e){return typeof e=="string"}function Ky(e,t,n){e&&(e=t?J(e).map(s=>s.replace(/\\(.)/g,"$1")):J(e));const i=e&&e.length,r=n&&n.get||$k,o=s=>r(t?[s]:jr(s));let a;if(!i)a=function(){return""};else if(i===1){const s=o(e[0]);a=function(u){return""+s(u)}}else{const s=e.map(o);a=function(u){let l=""+s[0](u),c=0;for(;++c<i;)l+="|"+s[c](u);return l}}return Vn(a,e,"key")}function nC(e,t){const n=e[0],i=Fe(e),r=+t;return r?r===1?i:n+r*(i-n):n}const Az=1e4;function iC(e){e=+e||Az;let t,n,i;const r=()=>{t={},n={},i=0},o=(a,s)=>(++i>e&&(n=t,t={},i=1),t[a]=s);return r(),{clear:r,has:a=>re(t,a)||re(n,a),get:a=>re(t,a)?t[a]:re(n,a)?o(a,n[a]):void 0,set:(a,s)=>re(t,a)?t[a]=s:o(a,s)}}function rC(e,t,n,i){const r=t.length,o=n.length;if(!o)return t;if(!r)return n;const a=i||new t.constructor(r+o);let s=0,u=0,l=0;for(;s<r&&u<o;++l)a[l]=e(t[s],n[u])>0?n[u++]:t[s++];for(;s<r;++s,++l)a[l]=t[s];for(;u<o;++u,++l)a[l]=n[u];return a}function mf(e,t){let n="";for(;--t>=0;)n+=e;return n}function oC(e,t,n,i){const r=n||" ",o=e+"",a=t-o.length;return a<=0?o:i==="left"?mf(r,a)+o:i==="center"?mf(r,~~(a/2))+o+mf(r,Math.ceil(a/2)):o+mf(r,a)}function yf(e){return e&&Fe(e)-e[0]||0}function H(e){return P(e)?"["+e.map(H)+"]":Q(e)||K(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Jy(e){return e==null||e===""?null:!e||e==="false"||e==="0"?!1:!!e}const kz=e=>Je(e)||pa(e)?e:Date.parse(e);function Qy(e,t){return t=t||kz,e==null||e===""?null:t(e)}function Zy(e){return e==null||e===""?null:e+""}function nr(e){const t={},n=e.length;for(let i=0;i<n;++i)t[e[i]]=!0;return t}function aC(e,t,n,i){const r=i!=null?i:"\u2026",o=e+"",a=o.length,s=Math.max(0,t-r.length);return a<=t?o:n==="left"?r+o.slice(a-s):n==="center"?o.slice(0,Math.ceil(s/2))+r+o.slice(a-~~(s/2)):o.slice(0,s)+r}function ma(e,t,n){if(e)if(t){const i=e.length;for(let r=0;r<i;++r){const o=t(e[r]);o&&n(o,r,e)}}else e.forEach(n)}var sC={},ev={},tv=34,vf=10,nv=13;function uC(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function Cz(e,t){var n=uC(e);return function(i,r){return t(n(i),r,e)}}function lC(e){var t=Object.create(null),n=[];return e.forEach(function(i){for(var r in i)r in t||n.push(t[r]=r)}),n}function Xn(e,t){var n=e+"",i=n.length;return i<t?new Array(t-i+1).join(0)+n:n}function Tz(e){return e<0?"-"+Xn(-e,6):e>9999?"+"+Xn(e,6):Xn(e,4)}function Fz(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),i=e.getUTCSeconds(),r=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":Tz(e.getUTCFullYear())+"-"+Xn(e.getUTCMonth()+1,2)+"-"+Xn(e.getUTCDate(),2)+(r?"T"+Xn(t,2)+":"+Xn(n,2)+":"+Xn(i,2)+"."+Xn(r,3)+"Z":i?"T"+Xn(t,2)+":"+Xn(n,2)+":"+Xn(i,2)+"Z":n||t?"T"+Xn(t,2)+":"+Xn(n,2)+"Z":"")}function Mz(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function i(f,d){var h,g,p=r(f,function(m,y){if(h)return h(m,y-1);g=m,h=d?Cz(m,d):uC(m)});return p.columns=g||[],p}function r(f,d){var h=[],g=f.length,p=0,m=0,y,v=g<=0,x=!1;f.charCodeAt(g-1)===vf&&--g,f.charCodeAt(g-1)===nv&&--g;function b(){if(v)return ev;if(x)return x=!1,sC;var E,w=p,O;if(f.charCodeAt(w)===tv){for(;p++<g&&f.charCodeAt(p)!==tv||f.charCodeAt(++p)===tv;);return(E=p)>=g?v=!0:(O=f.charCodeAt(p++))===vf?x=!0:O===nv&&(x=!0,f.charCodeAt(p)===vf&&++p),f.slice(w+1,E-1).replace(/""/g,'"')}for(;p<g;){if((O=f.charCodeAt(E=p++))===vf)x=!0;else if(O===nv)x=!0,f.charCodeAt(p)===vf&&++p;else if(O!==n)continue;return f.slice(w,E)}return v=!0,f.slice(w,g)}for(;(y=b())!==ev;){for(var _=[];y!==sC&&y!==ev;)_.push(y),y=b();d&&(_=d(_,m++))==null||h.push(_)}return h}function o(f,d){return f.map(function(h){return d.map(function(g){return c(h[g])}).join(e)})}function a(f,d){return d==null&&(d=lC(f)),[d.map(c).join(e)].concat(o(f,d)).join(`
`)}function s(f,d){return d==null&&(d=lC(f)),o(f,d).join(`
`)}function u(f){return f.map(l).join(`
`)}function l(f){return f.map(c).join(e)}function c(f){return f==null?"":f instanceof Date?Fz(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:i,parseRows:r,format:a,formatBody:s,formatRows:u,formatRow:l,formatValue:c}}function Dz(e){return e}function Nz(e){if(e==null)return Dz;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],a=e.translate[1];return function(s,u){u||(t=n=0);var l=2,c=s.length,f=new Array(c);for(f[0]=(t+=s[0])*i+o,f[1]=(n+=s[1])*r+a;l<c;)f[l]=s[l],++l;return f}}function Rz(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function jz(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return cC(e,n)})}:cC(e,t)}function cC(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,o=fC(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function fC(e,t){var n=Nz(e.transform),i=e.arcs;function r(c,f){f.length&&f.pop();for(var d=i[c<0?~c:c],h=0,g=d.length;h<g;++h)f.push(n(d[h],h));c<0&&Rz(f,g)}function o(c){return n(c)}function a(c){for(var f=[],d=0,h=c.length;d<h;++d)r(c[d],f);return f.length<2&&f.push(f[0]),f}function s(c){for(var f=a(c);f.length<4;)f.push(f[0]);return f}function u(c){return c.map(s)}function l(c){var f=c.type,d;switch(f){case"GeometryCollection":return{type:f,geometries:c.geometries.map(l)};case"Point":d=o(c.coordinates);break;case"MultiPoint":d=c.coordinates.map(o);break;case"LineString":d=a(c.arcs);break;case"MultiLineString":d=c.arcs.map(a);break;case"Polygon":d=u(c.arcs);break;case"MultiPolygon":d=c.arcs.map(u);break;default:return null}return{type:f,coordinates:d}}return l(t)}function $z(e,t){var n={},i={},r={},o=[],a=-1;t.forEach(function(l,c){var f=e.arcs[l<0?~l:l],d;f.length<3&&!f[1][0]&&!f[1][1]&&(d=t[++a],t[a]=l,t[c]=d)}),t.forEach(function(l){var c=s(l),f=c[0],d=c[1],h,g;if(h=r[f])if(delete r[h.end],h.push(l),h.end=d,g=i[d]){delete i[g.start];var p=g===h?h:h.concat(g);i[p.start=h.start]=r[p.end=g.end]=p}else i[h.start]=r[h.end]=h;else if(h=i[d])if(delete i[h.start],h.unshift(l),h.start=f,g=r[f]){delete r[g.end];var m=g===h?h:g.concat(h);i[m.start=g.start]=r[m.end=h.end]=m}else i[h.start]=r[h.end]=h;else h=[l],i[h.start=f]=r[h.end=d]=h});function s(l){var c=e.arcs[l<0?~l:l],f=c[0],d;return e.transform?(d=[0,0],c.forEach(function(h){d[0]+=h[0],d[1]+=h[1]})):d=c[c.length-1],l<0?[d,f]:[f,d]}function u(l,c){for(var f in l){var d=l[f];delete c[d.start],delete d.start,delete d.end,d.forEach(function(h){n[h<0?~h:h]=1}),o.push(d)}}return u(r,i),u(i,r),t.forEach(function(l){n[l<0?~l:l]||o.push([l])}),o}function Lz(e){return fC(e,Iz.apply(this,arguments))}function Iz(e,t,n){var i,r,o;if(arguments.length>1)i=Pz(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:$z(e,i)}}function Pz(e,t,n){var i=[],r=[],o;function a(f){var d=f<0?~f:f;(r[d]||(r[d]=[])).push({i:f,g:o})}function s(f){f.forEach(a)}function u(f){f.forEach(s)}function l(f){f.forEach(u)}function c(f){switch(o=f,f.type){case"GeometryCollection":f.geometries.forEach(c);break;case"LineString":s(f.arcs);break;case"MultiLineString":case"Polygon":u(f.arcs);break;case"MultiPolygon":l(f.arcs);break}}return c(t),r.forEach(n==null?function(f){i.push(f[0].i)}:function(f){n(f[0].g,f[f.length-1].g)&&i.push(f[0].i)}),i}function ml(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function bf(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=zz(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function zz(e){return(t,n)=>ml(e(t),n)}function dC(e){return e===null?NaN:+e}function*Bz(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(i=+i)>=i&&(yield i)}}const hC=bf(ml),Tg=hC.right,Uz=hC.left;bf(dC).center;var xf=Tg;function qz(e,t){let n=0,i,r=0,o=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(i=a-r,r+=i/++n,o+=i*(a-r));else{let a=-1;for(let s of e)(s=t(s,++a,e))!=null&&(s=+s)>=s&&(i=s-r,r+=i/++n,o+=i*(s-r))}if(n>1)return o/(n-1)}function Wz(e,t){const n=qz(e,t);return n&&Math.sqrt(n)}class Cn{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],a=t+o,s=Math.abs(t)<Math.abs(o)?t-(a-o):o-(a-t);s&&(n[i++]=s),t=a}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,o,a=0;if(n>0){for(a=t[--n];n>0&&(i=a,r=t[--n],a=i+r,o=r-(a-i),!o););n>0&&(o<0&&t[n-1]<0||o>0&&t[n-1]>0)&&(r=o*2,i=a+r,r==i-a&&(a=i))}return a}}function Hz(e,t){return Array.from(t,n=>e[n])}var iv=Math.sqrt(50),rv=Math.sqrt(10),ov=Math.sqrt(2);function av(e,t,n){var i,r=-1,o,a,s;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((i=t<e)&&(o=e,e=t,t=o),(s=gC(e,t,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(e/s),l=Math.round(t/s);for(u*s<e&&++u,l*s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)*s}else{s=-s;let u=Math.round(e*s),l=Math.round(t*s);for(u/s<e&&++u,l/s>t&&--l,a=new Array(o=l-u+1);++r<o;)a[r]=(u+r)/s}return i&&a.reverse(),a}function gC(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=iv?10:o>=rv?5:o>=ov?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=iv?10:o>=rv?5:o>=ov?2:1)}function ya(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=iv?r*=10:o>=rv?r*=5:o>=ov&&(r*=2),t<e?-r:r}function Ms(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function sv(e,t){let n;if(t===void 0)for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of e)(r=t(r,++i,e))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function pC(e,t,n=0,i=e.length-1,r=ml){for(;i>n;){if(i-n>600){const u=i-n+1,l=t-n+1,c=Math.log(u),f=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*f*(u-f)/u)*(l-u/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/u+d)),g=Math.min(i,Math.floor(t+(u-l)*f/u+d));pC(e,t,h,g,r)}const o=e[t];let a=n,s=i;for(wf(e,n,t),r(e[i],o)>0&&wf(e,n,i);a<s;){for(wf(e,a,s),++a,--s;r(e[a],o)<0;)++a;for(;r(e[s],o)>0;)--s}r(e[n],o)===0?wf(e,n,s):(++s,wf(e,s,i)),s<=t&&(n=s+1),t<=s&&(i=s-1)}return e}function wf(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function uv(e,t,n){if(e=Float64Array.from(Bz(e,n)),!!(i=e.length)){if((t=+t)<=0||i<2)return sv(e);if(t>=1)return Ms(e);var i,r=(i-1)*t,o=Math.floor(r),a=Ms(pC(e,o).subarray(0,o+1)),s=sv(e.subarray(o+1));return a+(s-a)*(r-o)}}function mC(e,t,n=dC){if(!!(i=e.length)){if((t=+t)<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,r=(i-1)*t,o=Math.floor(r),a=+n(e[o],o,e),s=+n(e[o+1],o+1,e);return a+(s-a)*(r-o)}}function Gz(e,t){let n=0,i=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let o of e)(o=t(o,++r,e))!=null&&(o=+o)>=o&&(++n,i+=o)}if(n)return i/n}function yC(e,t){return uv(e,.5,t)}function*Vz(e){for(const t of e)yield*t}function vC(e){return Array.from(Vz(e))}function yi(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(r);++i<r;)o[i]=e+i*n;return o}function bC(e,t){let n=0;if(t===void 0)for(let i of e)(i=+i)&&(n+=i);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function Yz(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Fg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function yl(e){return e=Fg(Math.abs(e)),e?e[1]:NaN}function Xz(e,t){return function(n,i){for(var r=n.length,o=[],a=0,s=e[0],u=0;r>0&&s>0&&(u+s+1>i&&(s=Math.max(1,i-u)),o.push(n.substring(r-=s,r+s)),!((u+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function Kz(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Jz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vl(e){if(!(t=Jz.exec(e)))throw new Error("invalid format: "+e);var t;return new lv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}vl.prototype=lv.prototype;function lv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}lv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Qz(e){e:for(var t=e.length,n=1,i=-1,r;n<t;++n)switch(e[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(r+1):e}var xC;function Zz(e,t){var n=Fg(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(xC=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+Fg(e,Math.max(0,t+o-1))[0]}function wC(e,t){var n=Fg(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var _C={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Yz,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>wC(e*100,t),r:wC,s:Zz,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function EC(e){return e}var OC=Array.prototype.map,SC=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function AC(e){var t=e.grouping===void 0||e.thousands===void 0?EC:Xz(OC.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?EC:Kz(OC.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function l(f){f=vl(f);var d=f.fill,h=f.align,g=f.sign,p=f.symbol,m=f.zero,y=f.width,v=f.comma,x=f.precision,b=f.trim,_=f.type;_==="n"?(v=!0,_="g"):_C[_]||(x===void 0&&(x=12),b=!0,_="g"),(m||d==="0"&&h==="=")&&(m=!0,d="0",h="=");var E=p==="$"?n:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",w=p==="$"?i:/[%p]/.test(_)?a:"",O=_C[_],S=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function k(A){var M=E,C=w,D,F,N;if(_==="c")C=O(A)+C,A="";else{A=+A;var I=A<0||1/A<0;if(A=isNaN(A)?u:O(Math.abs(A),x),b&&(A=Qz(A)),I&&+A==0&&g!=="+"&&(I=!1),M=(I?g==="("?g:s:g==="-"||g==="("?"":g)+M,C=(_==="s"?SC[8+xC/3]:"")+C+(I&&g==="("?")":""),S){for(D=-1,F=A.length;++D<F;)if(N=A.charCodeAt(D),48>N||N>57){C=(N===46?r+A.slice(D+1):A.slice(D))+C,A=A.slice(0,D);break}}}v&&!m&&(A=t(A,1/0));var z=M.length+A.length+C.length,X=z<y?new Array(y-z+1).join(d):"";switch(v&&m&&(A=t(X+A,X.length?y-C.length:1/0),X=""),h){case"<":A=M+A+C+X;break;case"=":A=M+X+A+C;break;case"^":A=X.slice(0,z=X.length>>1)+M+A+C+X.slice(z);break;default:A=X+M+A+C;break}return o(A)}return k.toString=function(){return f+""},k}function c(f,d){var h=l((f=vl(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(yl(d)/3)))*3,p=Math.pow(10,-g),m=SC[8+g/3];return function(y){return h(p*y)+m}}return{format:l,formatPrefix:c}}var Mg,Dg,cv;eB({thousands:",",grouping:[3],currency:["$",""]});function eB(e){return Mg=AC(e),Dg=Mg.format,cv=Mg.formatPrefix,Mg}function kC(e){return Math.max(0,-yl(Math.abs(e)))}function CC(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yl(t)/3)))*3-yl(Math.abs(e)))}function TC(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,yl(t)-yl(e))+1}var fv=new Date,dv=new Date;function It(e,t,n,i){function r(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return r.floor=function(o){return e(o=new Date(+o)),o},r.ceil=function(o){return e(o=new Date(o-1)),t(o,1),e(o),o},r.round=function(o){var a=r(o),s=r.ceil(o);return o-a<s-o?a:s},r.offset=function(o,a){return t(o=new Date(+o),a==null?1:Math.floor(a)),o},r.range=function(o,a,s){var u=[],l;if(o=r.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),t(o,s),e(o);while(l<o&&o<a);return u},r.filter=function(o){return It(function(a){if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););})},n&&(r.count=function(o,a){return fv.setTime(+o),dv.setTime(+a),e(fv),e(dv),Math.floor(n(fv,dv))},r.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?r.filter(i?function(a){return i(a)%o==0}:function(a){return r.count(0,a)%o==0}):r}),r}var hv=It(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});hv.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?It(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):hv};var gv=hv;const To=1e3,Ri=To*60,Fo=Ri*60,Ds=Fo*24,pv=Ds*7,FC=Ds*30,mv=Ds*365;var tB=It(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*To)},function(e,t){return(t-e)/To},function(e){return e.getUTCSeconds()}),va=tB,nB=It(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*To)},function(e,t){e.setTime(+e+t*Ri)},function(e,t){return(t-e)/Ri},function(e){return e.getMinutes()}),yv=nB,iB=It(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*To-e.getMinutes()*Ri)},function(e,t){e.setTime(+e+t*Fo)},function(e,t){return(t-e)/Fo},function(e){return e.getHours()}),vv=iB,rB=It(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ri)/Ds,e=>e.getDate()-1),ba=rB;function Ns(e){return It(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ri)/pv})}var _f=Ns(0),bv=Ns(1);Ns(2);Ns(3);var Ef=Ns(4);Ns(5);Ns(6);var oB=It(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),Ng=oB,MC=It(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});MC.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:It(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var xa=MC,aB=It(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Ri)},function(e,t){return(t-e)/Ri},function(e){return e.getUTCMinutes()}),xv=aB,sB=It(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Fo)},function(e,t){return(t-e)/Fo},function(e){return e.getUTCHours()}),wv=sB,uB=It(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/Ds},function(e){return e.getUTCDate()-1}),wa=uB;function Rs(e){return It(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/pv})}var Of=Rs(0),_v=Rs(1);Rs(2);Rs(3);var Sf=Rs(4);Rs(5);Rs(6);var lB=It(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),Rg=lB,DC=It(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});DC.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:It(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var _a=DC;function NC(e,t,n,i,r,o){const a=[[va,1,To],[va,5,5*To],[va,15,15*To],[va,30,30*To],[o,1,Ri],[o,5,5*Ri],[o,15,15*Ri],[o,30,30*Ri],[r,1,Fo],[r,3,3*Fo],[r,6,6*Fo],[r,12,12*Fo],[i,1,Ds],[i,2,2*Ds],[n,1,pv],[t,1,FC],[t,3,3*FC],[e,1,mv]];function s(l,c,f){const d=c<l;d&&([l,c]=[c,l]);const h=f&&typeof f.range=="function"?f:u(l,c,f),g=h?h.range(l,+c+1):[];return d?g.reverse():g}function u(l,c,f){const d=Math.abs(c-l)/f,h=bf(([,,m])=>m).right(a,d);if(h===a.length)return e.every(ya(l/mv,c/mv,f));if(h===0)return gv.every(Math.max(ya(l,c,f),1));const[g,p]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return g.every(p)}return[s,u]}const[cB,fB]=NC(_a,Rg,Of,wa,wv,xv),[dB,hB]=NC(xa,Ng,_f,ba,vv,yv),Jt="year",Kn="quarter",pn="month",Mt="week",Jn="date",mn="day",Lr="dayofyear",vi="hours",bi="minutes",ji="seconds",ir="milliseconds",Ev=[Jt,Kn,pn,Mt,Jn,mn,Lr,vi,bi,ji,ir],Ov=Ev.reduce((e,t,n)=>(e[t]=1+n,e),{});function Sv(e){const t=J(e).slice(),n={};return t.length||L("Missing time unit."),t.forEach(r=>{re(Ov,r)?n[r]=1:L("Invalid time unit: ".concat(r,"."))}),(n[Mt]||n[mn]?1:0)+(n[Kn]||n[pn]||n[Jn]?1:0)+(n[Lr]?1:0)>1&&L("Incompatible time units: ".concat(e)),t.sort((r,o)=>Ov[r]-Ov[o]),t}const gB={[Jt]:"%Y ",[Kn]:"Q%q ",[pn]:"%b ",[Jn]:"%d ",[Mt]:"W%U ",[mn]:"%a ",[Lr]:"%j ",[vi]:"%H:00",[bi]:"00:%M",[ji]:":%S",[ir]:".%L",["".concat(Jt,"-").concat(pn)]:"%Y-%m ",["".concat(Jt,"-").concat(pn,"-").concat(Jn)]:"%Y-%m-%d ",["".concat(vi,"-").concat(bi)]:"%H:%M"};function RC(e,t){const n=Ee({},gB,t),i=Sv(e),r=i.length;let o="",a=0,s,u;for(a=0;a<r;)for(s=i.length;s>a;--s)if(u=i.slice(a,s).join("-"),n[u]!=null){o+=n[u],a=s;break}return o.trim()}const js=new Date;function Av(e){return js.setFullYear(e),js.setMonth(0),js.setDate(1),js.setHours(0,0,0,0),js}function jC(e){return LC(new Date(e))}function $C(e){return kv(new Date(e))}function LC(e){return ba.count(Av(e.getFullYear())-1,e)}function kv(e){return _f.count(Av(e.getFullYear())-1,e)}function Cv(e){return Av(e).getDay()}function pB(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(-1,t,n,i,r,o,a);return s.setFullYear(e),s}return new Date(e,t,n,i,r,o,a)}function IC(e){return zC(new Date(e))}function PC(e){return Tv(new Date(e))}function zC(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return wa.count(t-1,e)}function Tv(e){const t=Date.UTC(e.getUTCFullYear(),0,1);return Of.count(t-1,e)}function Fv(e){return js.setTime(Date.UTC(e,0,1)),js.getUTCDay()}function mB(e,t,n,i,r,o,a){if(0<=e&&e<100){const s=new Date(Date.UTC(-1,t,n,i,r,o,a));return s.setUTCFullYear(n.y),s}return new Date(Date.UTC(e,t,n,i,r,o,a))}function BC(e,t,n,i,r){const o=t||1,a=Fe(e),s=(y,v,x)=>(x=x||y,yB(n[x],i[x],y===a&&o,v)),u=new Date,l=nr(e),c=l[Jt]?s(Jt):gn(2012),f=l[pn]?s(pn):l[Kn]?s(Kn):da,d=l[Mt]&&l[mn]?s(mn,1,Mt+mn):l[Mt]?s(Mt,1):l[mn]?s(mn,1):l[Jn]?s(Jn,1):l[Lr]?s(Lr,1):fl,h=l[vi]?s(vi):da,g=l[bi]?s(bi):da,p=l[ji]?s(ji):da,m=l[ir]?s(ir):da;return function(y){u.setTime(+y);const v=c(u);return r(v,f(u),d(u,v),h(u),g(u),p(u),m(u))}}function yB(e,t,n,i){const r=n<=1?e:i?(o,a)=>i+n*Math.floor((e(o,a)-i)/n):(o,a)=>n*Math.floor(e(o,a)/n);return t?(o,a)=>t(r(o,a),a):r}function bl(e,t,n){return t+e*7-(n+6)%7}const vB={[Jt]:e=>e.getFullYear(),[Kn]:e=>Math.floor(e.getMonth()/3),[pn]:e=>e.getMonth(),[Jn]:e=>e.getDate(),[vi]:e=>e.getHours(),[bi]:e=>e.getMinutes(),[ji]:e=>e.getSeconds(),[ir]:e=>e.getMilliseconds(),[Lr]:e=>LC(e),[Mt]:e=>kv(e),[Mt+mn]:(e,t)=>bl(kv(e),e.getDay(),Cv(t)),[mn]:(e,t)=>bl(1,e.getDay(),Cv(t))},bB={[Kn]:e=>3*e,[Mt]:(e,t)=>bl(e,0,Cv(t))};function UC(e,t){return BC(e,t||1,vB,bB,pB)}const xB={[Jt]:e=>e.getUTCFullYear(),[Kn]:e=>Math.floor(e.getUTCMonth()/3),[pn]:e=>e.getUTCMonth(),[Jn]:e=>e.getUTCDate(),[vi]:e=>e.getUTCHours(),[bi]:e=>e.getUTCMinutes(),[ji]:e=>e.getUTCSeconds(),[ir]:e=>e.getUTCMilliseconds(),[Lr]:e=>zC(e),[Mt]:e=>Tv(e),[mn]:(e,t)=>bl(1,e.getUTCDay(),Fv(t)),[Mt+mn]:(e,t)=>bl(Tv(e),e.getUTCDay(),Fv(t))},wB={[Kn]:e=>3*e,[Mt]:(e,t)=>bl(e,0,Fv(t))};function qC(e,t){return BC(e,t||1,xB,wB,mB)}const _B={[Jt]:xa,[Kn]:Ng.every(3),[pn]:Ng,[Mt]:_f,[Jn]:ba,[mn]:ba,[Lr]:ba,[vi]:vv,[bi]:yv,[ji]:va,[ir]:gv},EB={[Jt]:_a,[Kn]:Rg.every(3),[pn]:Rg,[Mt]:Of,[Jn]:wa,[mn]:wa,[Lr]:wa,[vi]:wv,[bi]:xv,[ji]:va,[ir]:gv};function xl(e){return _B[e]}function wl(e){return EB[e]}function WC(e,t,n){return e?e.offset(t,n):void 0}function HC(e,t,n){return WC(xl(e),t,n)}function GC(e,t,n){return WC(wl(e),t,n)}function VC(e,t,n,i){return e?e.range(t,n,i):void 0}function YC(e,t,n,i){return VC(xl(e),t,n,i)}function XC(e,t,n,i){return VC(wl(e),t,n,i)}const Af=1e3,kf=Af*60,Cf=kf*60,jg=Cf*24,OB=jg*7,KC=jg*30,Mv=jg*365,JC=[Jt,pn,Jn,vi,bi,ji,ir],Tf=JC.slice(0,-1),Ff=Tf.slice(0,-1),Mf=Ff.slice(0,-1),SB=Mf.slice(0,-1),AB=[Jt,Mt],QC=[Jt,pn],ZC=[Jt],Df=[[Tf,1,Af],[Tf,5,5*Af],[Tf,15,15*Af],[Tf,30,30*Af],[Ff,1,kf],[Ff,5,5*kf],[Ff,15,15*kf],[Ff,30,30*kf],[Mf,1,Cf],[Mf,3,3*Cf],[Mf,6,6*Cf],[Mf,12,12*Cf],[SB,1,jg],[AB,1,OB],[QC,1,KC],[QC,3,3*KC],[ZC,1,Mv]];function eT(e){const t=e.extent,n=e.maxbins||40,i=Math.abs(yf(t))/n;let r=bf(s=>s[2]).right(Df,i),o,a;return r===Df.length?(o=ZC,a=ya(t[0]/Mv,t[1]/Mv,n)):r?(r=Df[i/Df[r-1][2]<Df[r][2]/i?r-1:r],o=r[0],a=r[1]):(o=JC,a=Math.max(ya(t[0],t[1],n),1)),{units:o,step:a}}function Dv(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Nv(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Nf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function tT(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,a=e.shortDays,s=e.months,u=e.shortMonths,l=Rf(r),c=jf(r),f=Rf(o),d=jf(o),h=Rf(a),g=jf(a),p=Rf(s),m=jf(s),y=Rf(u),v=jf(u),x={a:I,A:z,b:X,B:te,c:null,d:sT,e:sT,f:XB,g:oU,G:sU,H:GB,I:VB,j:YB,L:uT,m:KB,M:JB,p:xe,q:ge,Q:gT,s:pT,S:QB,u:ZB,U:eU,V:tU,w:nU,W:iU,x:null,X:null,y:rU,Y:aU,Z:uU,"%":hT},b={a:je,A:Oe,b:ke,B:Xe,c:null,d:cT,e:cT,f:dU,g:_U,G:OU,H:lU,I:cU,j:fU,L:fT,m:hU,M:gU,p:xt,q:Ge,Q:gT,s:pT,S:pU,u:mU,U:yU,V:vU,w:bU,W:xU,x:null,X:null,y:wU,Y:EU,Z:SU,"%":hT},_={a:k,A,b:M,B:C,c:D,d:oT,e:oT,f:UB,g:rT,G:iT,H:aT,I:aT,j:IB,L:BB,m:LB,M:PB,p:S,q:$B,Q:WB,s:HB,S:zB,u:MB,U:DB,V:NB,w:FB,W:RB,x:F,X:N,y:rT,Y:iT,Z:jB,"%":qB};x.x=E(n,x),x.X=E(i,x),x.c=E(t,x),b.x=E(n,b),b.X=E(i,b),b.c=E(t,b);function E(Y,ne){return function(fe){var B=[],Ve=-1,pe=0,tt=Y.length,qe,ie,me;for(fe instanceof Date||(fe=new Date(+fe));++Ve<tt;)Y.charCodeAt(Ve)===37&&(B.push(Y.slice(pe,Ve)),(ie=nT[qe=Y.charAt(++Ve)])!=null?qe=Y.charAt(++Ve):ie=qe==="e"?" ":"0",(me=ne[qe])&&(qe=me(fe,ie)),B.push(qe),pe=Ve+1);return B.push(Y.slice(pe,Ve)),B.join("")}}function w(Y,ne){return function(fe){var B=Nf(1900,void 0,1),Ve=O(B,Y,fe+="",0),pe,tt;if(Ve!=fe.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(ne&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(pe=Nv(Nf(B.y,0,1)),tt=pe.getUTCDay(),pe=tt>4||tt===0?_v.ceil(pe):_v(pe),pe=wa.offset(pe,(B.V-1)*7),B.y=pe.getUTCFullYear(),B.m=pe.getUTCMonth(),B.d=pe.getUTCDate()+(B.w+6)%7):(pe=Dv(Nf(B.y,0,1)),tt=pe.getDay(),pe=tt>4||tt===0?bv.ceil(pe):bv(pe),pe=ba.offset(pe,(B.V-1)*7),B.y=pe.getFullYear(),B.m=pe.getMonth(),B.d=pe.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),tt="Z"in B?Nv(Nf(B.y,0,1)).getUTCDay():Dv(Nf(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(tt+5)%7:B.w+B.U*7-(tt+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,Nv(B)):Dv(B)}}function O(Y,ne,fe,B){for(var Ve=0,pe=ne.length,tt=fe.length,qe,ie;Ve<pe;){if(B>=tt)return-1;if(qe=ne.charCodeAt(Ve++),qe===37){if(qe=ne.charAt(Ve++),ie=_[qe in nT?ne.charAt(Ve++):qe],!ie||(B=ie(Y,fe,B))<0)return-1}else if(qe!=fe.charCodeAt(B++))return-1}return B}function S(Y,ne,fe){var B=l.exec(ne.slice(fe));return B?(Y.p=c.get(B[0].toLowerCase()),fe+B[0].length):-1}function k(Y,ne,fe){var B=h.exec(ne.slice(fe));return B?(Y.w=g.get(B[0].toLowerCase()),fe+B[0].length):-1}function A(Y,ne,fe){var B=f.exec(ne.slice(fe));return B?(Y.w=d.get(B[0].toLowerCase()),fe+B[0].length):-1}function M(Y,ne,fe){var B=y.exec(ne.slice(fe));return B?(Y.m=v.get(B[0].toLowerCase()),fe+B[0].length):-1}function C(Y,ne,fe){var B=p.exec(ne.slice(fe));return B?(Y.m=m.get(B[0].toLowerCase()),fe+B[0].length):-1}function D(Y,ne,fe){return O(Y,t,ne,fe)}function F(Y,ne,fe){return O(Y,n,ne,fe)}function N(Y,ne,fe){return O(Y,i,ne,fe)}function I(Y){return a[Y.getDay()]}function z(Y){return o[Y.getDay()]}function X(Y){return u[Y.getMonth()]}function te(Y){return s[Y.getMonth()]}function xe(Y){return r[+(Y.getHours()>=12)]}function ge(Y){return 1+~~(Y.getMonth()/3)}function je(Y){return a[Y.getUTCDay()]}function Oe(Y){return o[Y.getUTCDay()]}function ke(Y){return u[Y.getUTCMonth()]}function Xe(Y){return s[Y.getUTCMonth()]}function xt(Y){return r[+(Y.getUTCHours()>=12)]}function Ge(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var ne=E(Y+="",x);return ne.toString=function(){return Y},ne},parse:function(Y){var ne=w(Y+="",!1);return ne.toString=function(){return Y},ne},utcFormat:function(Y){var ne=E(Y+="",b);return ne.toString=function(){return Y},ne},utcParse:function(Y){var ne=w(Y+="",!0);return ne.toString=function(){return Y},ne}}}var nT={"-":"",_:" ","0":"0"},Pt=/^\s*\d+/,kB=/^%/,CB=/[\\^$*+?|[\]().{}]/g;function Le(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function TB(e){return e.replace(CB,"\\$&")}function Rf(e){return new RegExp("^(?:"+e.map(TB).join("|")+")","i")}function jf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function FB(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function MB(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function DB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function NB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function RB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function iT(e,t,n){var i=Pt.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function rT(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function jB(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function $B(e,t,n){var i=Pt.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function LB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function oT(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function IB(e,t,n){var i=Pt.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function aT(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function PB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function zB(e,t,n){var i=Pt.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function BB(e,t,n){var i=Pt.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function UB(e,t,n){var i=Pt.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function qB(e,t,n){var i=kB.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function WB(e,t,n){var i=Pt.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function HB(e,t,n){var i=Pt.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function sT(e,t){return Le(e.getDate(),t,2)}function GB(e,t){return Le(e.getHours(),t,2)}function VB(e,t){return Le(e.getHours()%12||12,t,2)}function YB(e,t){return Le(1+ba.count(xa(e),e),t,3)}function uT(e,t){return Le(e.getMilliseconds(),t,3)}function XB(e,t){return uT(e,t)+"000"}function KB(e,t){return Le(e.getMonth()+1,t,2)}function JB(e,t){return Le(e.getMinutes(),t,2)}function QB(e,t){return Le(e.getSeconds(),t,2)}function ZB(e){var t=e.getDay();return t===0?7:t}function eU(e,t){return Le(_f.count(xa(e)-1,e),t,2)}function lT(e){var t=e.getDay();return t>=4||t===0?Ef(e):Ef.ceil(e)}function tU(e,t){return e=lT(e),Le(Ef.count(xa(e),e)+(xa(e).getDay()===4),t,2)}function nU(e){return e.getDay()}function iU(e,t){return Le(bv.count(xa(e)-1,e),t,2)}function rU(e,t){return Le(e.getFullYear()%100,t,2)}function oU(e,t){return e=lT(e),Le(e.getFullYear()%100,t,2)}function aU(e,t){return Le(e.getFullYear()%1e4,t,4)}function sU(e,t){var n=e.getDay();return e=n>=4||n===0?Ef(e):Ef.ceil(e),Le(e.getFullYear()%1e4,t,4)}function uU(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Le(t/60|0,"0",2)+Le(t%60,"0",2)}function cT(e,t){return Le(e.getUTCDate(),t,2)}function lU(e,t){return Le(e.getUTCHours(),t,2)}function cU(e,t){return Le(e.getUTCHours()%12||12,t,2)}function fU(e,t){return Le(1+wa.count(_a(e),e),t,3)}function fT(e,t){return Le(e.getUTCMilliseconds(),t,3)}function dU(e,t){return fT(e,t)+"000"}function hU(e,t){return Le(e.getUTCMonth()+1,t,2)}function gU(e,t){return Le(e.getUTCMinutes(),t,2)}function pU(e,t){return Le(e.getUTCSeconds(),t,2)}function mU(e){var t=e.getUTCDay();return t===0?7:t}function yU(e,t){return Le(Of.count(_a(e)-1,e),t,2)}function dT(e){var t=e.getUTCDay();return t>=4||t===0?Sf(e):Sf.ceil(e)}function vU(e,t){return e=dT(e),Le(Sf.count(_a(e),e)+(_a(e).getUTCDay()===4),t,2)}function bU(e){return e.getUTCDay()}function xU(e,t){return Le(_v.count(_a(e)-1,e),t,2)}function wU(e,t){return Le(e.getUTCFullYear()%100,t,2)}function _U(e,t){return e=dT(e),Le(e.getUTCFullYear()%100,t,2)}function EU(e,t){return Le(e.getUTCFullYear()%1e4,t,4)}function OU(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Sf(e):Sf.ceil(e),Le(e.getUTCFullYear()%1e4,t,4)}function SU(){return"+0000"}function hT(){return"%"}function gT(e){return+e}function pT(e){return Math.floor(+e/1e3)}var _l,Rv,mT,jv,yT;AU({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function AU(e){return _l=tT(e),Rv=_l.format,mT=_l.parse,jv=_l.utcFormat,yT=_l.utcParse,_l}function $f(e){const t={};return n=>t[n]||(t[n]=e(n))}function kU(e,t){return n=>{const i=e(n),r=i.indexOf(t);if(r<0)return i;let o=CU(i,r);const a=o<i.length?i.slice(o):"";for(;--o>r;)if(i[o]!=="0"){++o;break}return i.slice(0,o)+a}}function CU(e,t){let n=e.lastIndexOf("e"),i;if(n>0)return n;for(n=e.length;--n>t;)if(i=e.charCodeAt(n),i>=48&&i<=57)return n+1}function vT(e){const t=$f(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat(i){const r=vl(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return kU(t(r),t(".1f")(1)[1])}else return t(r)},formatSpan(i,r,o,a){a=vl(a==null?",f":a);const s=ya(i,r,o),u=Math.max(Math.abs(i),Math.abs(r));let l;if(a.precision==null)switch(a.type){case"s":return isNaN(l=CC(s,u))||(a.precision=l),n(a,u);case"":case"e":case"g":case"p":case"r":{isNaN(l=TC(s,u))||(a.precision=l-(a.type==="e"));break}case"f":case"%":{isNaN(l=kC(s))||(a.precision=l-(a.type==="%")*2);break}}return t(a)}}}let $v;bT();function bT(){return $v=vT({format:Dg,formatPrefix:cv})}function xT(e){return vT(AC(e))}function $g(e){return arguments.length?$v=xT(e):$v}function wT(e,t,n){n=n||{},Q(n)||L("Invalid time multi-format specifier: ".concat(n));const i=t(ji),r=t(bi),o=t(vi),a=t(Jn),s=t(Mt),u=t(pn),l=t(Kn),c=t(Jt),f=e(n[ir]||".%L"),d=e(n[ji]||":%S"),h=e(n[bi]||"%I:%M"),g=e(n[vi]||"%I %p"),p=e(n[Jn]||n[mn]||"%a %d"),m=e(n[Mt]||"%b %d"),y=e(n[pn]||"%B"),v=e(n[Kn]||"%B"),x=e(n[Jt]||"%Y");return b=>(i(b)<b?f:r(b)<b?d:o(b)<b?h:a(b)<b?g:u(b)<b?s(b)<b?p:m:c(b)<b?l(b)<b?y:v:x)(b)}function _T(e){const t=$f(e.format),n=$f(e.utcFormat);return{timeFormat:i=>K(i)?t(i):wT(t,xl,i),utcFormat:i=>K(i)?n(i):wT(n,wl,i),timeParse:$f(e.parse),utcParse:$f(e.utcParse)}}let Lv;ET();function ET(){return Lv=_T({format:Rv,parse:mT,utcFormat:jv,utcParse:yT})}function OT(e){return _T(tT(e))}function Lf(e){return arguments.length?Lv=OT(e):Lv}const Iv=(e,t)=>Ee({},e,t);function ST(e,t){const n=e?xT(e):$g(),i=t?OT(t):Lf();return Iv(n,i)}function Pv(e,t){const n=arguments.length;return n&&n!==2&&L("defaultLocale expects either zero or two arguments."),n?Iv($g(e),Lf(t)):Iv($g(),Lf())}function TU(){return bT(),ET(),Pv()}const FU=/^(data:|([A-Za-z]+:)?\/\/)/,MU=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,DU=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,AT="file://";function NU(e,t){return n=>({options:n||{},sanitize:jU,load:RU,fileAccess:!!t,file:$U(t),http:IU(e)})}async function RU(e,t){const n=await this.sanitize(e,t),i=n.href;return n.localFile?this.file(i):this.http(i,t)}async function jU(e,t){t=Ee({},this.options,t);const n=this.fileAccess,i={href:null};let r,o,a;const s=MU.test(e.replace(DU,""));(e==null||typeof e!="string"||!s)&&L("Sanitize failure, invalid URI: "+H(e));const u=FU.test(e);return(a=t.baseURL)&&!u&&(!e.startsWith("/")&&!a.endsWith("/")&&(e="/"+e),e=a+e),o=(r=e.startsWith(AT))||t.mode==="file"||t.mode!=="http"&&!u&&n,r?e=e.slice(AT.length):e.startsWith("//")&&(t.defaultProtocol==="file"?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(i,"localFile",{value:!!o}),i.href=e,t.target&&(i.target=t.target+""),t.rel&&(i.rel=t.rel+""),t.context==="image"&&t.crossOrigin&&(i.crossOrigin=t.crossOrigin+""),i}function $U(e){return e?t=>new Promise((n,i)=>{e.readFile(t,(r,o)=>{r?i(r):n(o)})}):LU}async function LU(){L("No file system access.")}function IU(e){return e?async function(t,n){const i=Ee({},this.options.http,n),r=n&&n.response,o=await e(t,i);return o.ok?_e(o[r])?o[r]():o.text():L(o.status+""+o.statusText)}:PU}async function PU(){L("No HTTP fetch method available.")}const zU=e=>e!=null&&e===e,BU=e=>e==="true"||e==="false"||e===!0||e===!1,UU=e=>!Number.isNaN(Date.parse(e)),kT=e=>!Number.isNaN(+e)&&!(e instanceof Date),qU=e=>kT(e)&&Number.isInteger(+e),zv={boolean:Jy,integer:hn,number:hn,date:Qy,string:Zy,unknown:dn},Lg=[BU,qU,kT,UU],WU=["boolean","integer","number","date"];function CT(e,t){if(!e||!e.length)return"unknown";const n=e.length,i=Lg.length,r=Lg.map((o,a)=>a+1);for(let o=0,a=0,s,u;o<n;++o)for(u=t?e[o][t]:e[o],s=0;s<i;++s)if(r[s]&&zU(u)&&!Lg[s](u)&&(r[s]=0,++a,a===Lg.length))return"string";return WU[r.reduce((o,a)=>o===0?a:o,0)-1]}function TT(e,t){return t.reduce((n,i)=>(n[i]=CT(e,i),n),{})}function FT(e){const t=function(n,i){const r={delimiter:e};return Bv(n,i?Ee(i,r):r)};return t.responseType="text",t}function Bv(e,t){return t.header&&(e=t.header.map(H).join(t.delimiter)+`
`+e),Mz(t.delimiter).parse(e+"")}Bv.responseType="text";function HU(e){return typeof Buffer=="function"&&_e(Buffer.isBuffer)?Buffer.isBuffer(e):!1}function Uv(e,t){const n=t&&t.property?Yn(t.property):dn;return Q(e)&&!HU(e)?GU(n(e),t):n(JSON.parse(e))}Uv.responseType="json";function GU(e,t){return!P(e)&&eC(e)&&(e=[...e]),t&&t.copy?JSON.parse(JSON.stringify(e)):e}const VU={interior:(e,t)=>e!==t,exterior:(e,t)=>e===t};function MT(e,t){let n,i,r,o;return e=Uv(e,t),t&&t.feature?(n=jz,r=t.feature):t&&t.mesh?(n=Lz,r=t.mesh,o=VU[t.filter]):L("Missing TopoJSON feature or mesh parameter."),i=(i=e.objects[r])?n(e,i,o):L("Invalid TopoJSON object: "+r),i&&i.features||[i]}MT.responseType="json";const Ig={dsv:Bv,csv:FT(","),tsv:FT("	"),json:Uv,topojson:MT};function qv(e,t){return arguments.length>1?(Ig[e]=t,this):re(Ig,e)?Ig[e]:null}function DT(e){const t=qv(e);return t&&t.responseType||"text"}function NT(e,t,n,i){t=t||{};const r=qv(t.type||"json");return r||L("Unknown data format type: "+t.type),e=r(e,t),t.parse&&YU(e,t.parse,n,i),re(e,"columns")&&delete e.columns,e}function YU(e,t,n,i){if(!e.length)return;const r=Lf();n=n||r.timeParse,i=i||r.utcParse;let o=e.columns||Object.keys(e[0]),a,s,u,l,c,f;t==="auto"&&(t=TT(e,o)),o=Object.keys(t);const d=o.map(h=>{const g=t[h];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?i:n)(m);if(!zv[g])throw Error("Illegal format pattern: "+h+":"+g);return zv[g]});for(u=0,c=e.length,f=o.length;u<c;++u)for(a=e[u],l=0;l<f;++l)s=o[l],a[s]=d[l](a[s])}const Pg=NU(typeof fetch!="undefined"&&fetch,null);function zg(e){const t=e||dn,n=[],i={};return n.add=r=>{const o=t(r);return i[o]||(i[o]=1,n.push(r)),n},n.remove=r=>{const o=t(r);if(i[o]){i[o]=0;const a=n.indexOf(r);a>=0&&n.splice(a,1)}return n},n}async function Bg(e,t){try{await t(e)}catch(n){e.error(n)}}const RT=Symbol("vega_id");let XU=1;function Ug(e){return!!(e&&ae(e))}function ae(e){return e[RT]}function jT(e,t){return e[RT]=t,e}function Ue(e){const t=e===Object(e)?e:{data:e};return ae(t)?t:jT(t,XU++)}function Wv(e){return qg(e,Ue({}))}function qg(e,t){for(const n in e)t[n]=e[n];return t}function $T(e,t){return jT(t,ae(e))}function $s(e,t){return e?t?(n,i)=>e(n,i)||ae(t(n))-ae(t(i)):(n,i)=>e(n,i)||ae(n)-ae(i):null}function LT(e){return e&&e.constructor===Ls}function Ls(){const e=[],t=[],n=[],i=[],r=[];let o=null,a=!1;return{constructor:Ls,insert(s){const u=J(s),l=u.length;for(let c=0;c<l;++c)e.push(u[c]);return this},remove(s){const u=_e(s)?i:t,l=J(s),c=l.length;for(let f=0;f<c;++f)u.push(l[f]);return this},modify(s,u,l){const c={field:u,value:gn(l)};return _e(s)?(c.filter=s,r.push(c)):(c.tuple=s,n.push(c)),this},encode(s,u){return _e(s)?r.push({filter:s,field:u}):n.push({tuple:s,field:u}),this},clean(s){return o=s,this},reflow(){return a=!0,this},pulse(s,u){const l={},c={};let f,d,h,g,p,m;for(f=0,d=u.length;f<d;++f)l[ae(u[f])]=1;for(f=0,d=t.length;f<d;++f)p=t[f],l[ae(p)]=-1;for(f=0,d=i.length;f<d;++f)g=i[f],u.forEach(v=>{g(v)&&(l[ae(v)]=-1)});for(f=0,d=e.length;f<d;++f)p=e[f],m=ae(p),l[m]?l[m]=1:s.add.push(Ue(e[f]));for(f=0,d=u.length;f<d;++f)p=u[f],l[ae(p)]<0&&s.rem.push(p);function y(v,x,b){b?v[x]=b(v):s.encode=x,a||(c[ae(v)]=v)}for(f=0,d=n.length;f<d;++f)h=n[f],p=h.tuple,g=h.field,m=l[ae(p)],m>0&&(y(p,g,h.value),s.modifies(g));for(f=0,d=r.length;f<d;++f)h=r[f],g=h.filter,u.forEach(v=>{g(v)&&l[ae(v)]>0&&y(v,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=t.length||i.length?u.filter(v=>l[ae(v)]>0):u.slice();else for(m in c)s.mod.push(c[m]);return(o||o==null&&(t.length||i.length))&&s.clean(!0),s}}}const Wg="_:mod:_";function Hg(){Object.defineProperty(this,Wg,{writable:!0,value:{}})}Hg.prototype={set(e,t,n,i){const r=this,o=r[e],a=r[Wg];return t!=null&&t>=0?(o[t]!==n||i)&&(o[t]=n,a[t+":"+e]=-1,a[e]=-1):(o!==n||i)&&(r[e]=n,a[e]=P(n)?1+n.length:-1),r},modified(e,t){const n=this[Wg];if(arguments.length){if(P(e)){for(let i=0;i<e.length;++i)if(n[e[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return t!=null&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear(){return this[Wg]={},this}};let KU=0;const JU="pulse",QU=new Hg,ZU=1,eq=2;function it(e,t,n,i){this.id=++KU,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,i)}function IT(e){return function(t){const n=this.flags;return arguments.length===0?!!(n&e):(this.flags=t?n|e:n&~e,this)}}it.prototype={targets(){return this._targets||(this._targets=zg(pf))},set(e){return this.value!==e?(this.value=e,1):0},skip:IT(ZU),modified:IT(eq),parameters(e,t,n){t=t!==!1;const i=this._argval=this._argval||new Hg,r=this._argops=this._argops||[],o=[];let a,s,u,l;const c=(f,d,h)=>{h instanceof it?(h!==this&&(t&&h.targets().add(this),o.push(h)),r.push({op:h,name:f,index:d})):i.set(f,d,h)};for(a in e)if(s=e[a],a===JU)J(s).forEach(f=>{f instanceof it?f!==this&&(f.targets().add(this),o.push(f)):L("Pulse parameters must be operator instances.")}),this.source=s;else if(P(s))for(i.set(a,-1,Array(u=s.length)),l=0;l<u;++l)c(a,l,s[l]);else c(a,-1,s);return this.marshall().clear(),n&&(r.initonly=!0),o},marshall(e){const t=this._argval||QU,n=this._argops;let i,r,o,a;if(n){const s=n.length;for(r=0;r<s;++r)i=n[r],o=i.op,a=o.modified()&&o.stamp===e,t.set(i.name,i.index,o.value,a);if(n.initonly){for(r=0;r<s;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return t},detach(){const e=this._argops;let t,n,i,r;if(e)for(t=0,n=e.length;t<n;++t)i=e[t],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(e){const t=this._update;if(t){const n=this.marshall(e.stamp),i=t.call(this,n,e);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return e.StopPropagation}},run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e}};function tq(e,t,n,i){let r=1,o;return e instanceof it?o=e:e&&e.prototype instanceof it?o=new e:_e(e)?o=new it(null,e):(r=0,o=new it(e,t)),this.rank(o),r&&(i=n,n=t),n&&this.connect(o,o.parameters(n,i)),this.touch(o),o}function nq(e,t){const n=e.rank,i=t.length;for(let r=0;r<i;++r)if(n<t[r].rank){this.rerank(e);return}}let iq=0;function Gg(e,t,n){this.id=++iq,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ea(e,t,n){return new Gg(e,t,n)}Gg.prototype={_filter:Ni,_apply:dn,targets(){return this._targets||(this._targets=zg(pf))},consume(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive(e){if(this._filter(e)){const t=this.value=this._apply(e),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter(e){const t=Ea(e);return this.targets().add(t),t},apply(e){const t=Ea(null,e);return this.targets().add(t),t},merge(){const e=Ea();this.targets().add(e);for(let t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle(e){let t=-1;return this.filter(()=>{const n=Date.now();return n-t>e?(t=n,1):0})},debounce(e){const t=Ea();return this.targets().add(Ea(null,null,Xy(e,n=>{const i=n.dataflow;t.receive(n),i&&i.run&&i.run()}))),t},between(e,t){let n=!1;return e.targets().add(Ea(null,null,()=>n=!0)),t.targets().add(Ea(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Ni,this._targets=null}};function rq(e,t,n,i){const r=this,o=Ea(n,i),a=function(l){l.dataflow=r;try{o.receive(l)}catch(c){r.error(c)}finally{r.run()}};let s;typeof e=="string"&&typeof document!="undefined"?s=document.querySelectorAll(e):s=J(e);const u=s.length;for(let l=0;l<u;++l)s[l].addEventListener(t,a);return o}function oq(e,t){const n=this.locale();return NT(e,t,n.timeParse,n.utcParse)}function aq(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))}async function sq(e,t){const n=this;let i=0,r;try{r=await n.loader().load(e,{context:"dataflow",response:DT(t&&t.type)});try{r=n.parse(r,t)}catch(o){i=-2,n.warn("Data ingestion failed",e,o)}}catch(o){i=-1,n.warn("Loading failed",e,o)}return{data:r,status:i}}async function uq(e,t,n){const i=this,r=i._pending||lq(i);r.requests+=1;const o=await i.request(t,n);return i.pulse(e,i.changeset().remove(Ni).insert(o.data||[])),r.done(),o}function lq(e){let t;const n=new Promise(i=>t=i);return n.requests=0,n.done=()=>{--n.requests==0&&(e._pending=null,t(e))},e._pending=n}const cq={skip:!0};function fq(e,t,n,i,r){return(e instanceof it?hq:dq)(this,e,t,n,i,r),this}function dq(e,t,n,i,r,o){const a=Ee({},o,cq);let s,u;_e(n)||(n=gn(n)),i===void 0?s=l=>e.touch(n(l)):_e(i)?(u=new it(null,i,r,!1),s=l=>{u.evaluate(l);const c=n(l),f=u.value;LT(f)?e.pulse(c,f,o):e.update(c,f,a)}):s=l=>e.update(n(l),i,a),t.apply(s)}function hq(e,t,n,i,r,o){if(i===void 0)t.targets().add(n);else{const a=o||{},s=new it(null,gq(n,i),r,!1);s.modified(a.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}function gq(e,t){return t=_e(t)?t:gn(t),e?function(n,i){const r=t(n,i);return e.skip()||(e.skip(r!==this.value).value=r),r}:t}function pq(e){e.rank=++this._rank}function mq(e){const t=[e];let n,i,r;for(;t.length;)if(this.rank(n=t.pop()),i=n._targets)for(r=i.length;--r>=0;)t.push(n=i[r]),n===e&&L("Cycle detected in dataflow graph.")}const Vg={},Ir=1<<0,Oa=1<<1,Mo=1<<2,yq=Ir|Oa,PT=Ir|Mo,El=Ir|Oa|Mo,zT=1<<3,If=1<<4,BT=1<<5,UT=1<<6;function Sa(e,t,n){this.dataflow=e,this.stamp=t==null?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function Hv(e,t){const n=[];return ma(e,t,i=>n.push(i)),n}function qT(e,t){const n={};return e.visit(t,i=>{n[ae(i)]=1}),i=>n[ae(i)]?null:i}function Yg(e,t){return e?(n,i)=>e(n,i)&&t(n,i):t}Sa.prototype={StopPropagation:Vg,ADD:Ir,REM:Oa,MOD:Mo,ADD_REM:yq,ADD_MOD:PT,ALL:El,REFLOW:zT,SOURCE:If,NO_SOURCE:BT,NO_FIELDS:UT,fork(e){return new Sa(this.dataflow).init(this,e)},clone(){const e=this.fork(El);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(El|If)},addAll(){let e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||(e=new Sa(this.dataflow).init(this),e.add=e.source,e.rem=[]),e},init(e,t){const n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(t&UT)&&(n.fields=e.fields),t&Ir?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),t&Oa?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),t&Mo?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),t&BT?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter(e){this.dataflow.runAfter(e)},changed(e){const t=e||El;return t&Ir&&this.add.length||t&Oa&&this.rem.length||t&Mo&&this.mod.length},reflow(e){if(e)return this.fork(El).reflow();const t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(Mo,qT(this,Ir))),this},clean(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies(e){const t=this.fields||(this.fields={});return P(e)?e.forEach(n=>t[n]=!0):t[e]=!0,this},modified(e,t){const n=this.fields;return(t||this.mod.length)&&n?arguments.length?P(e)?e.some(i=>n[i]):n[e]:!!n:!1},filter(e,t){const n=this;return e&Ir&&(n.addF=Yg(n.addF,t)),e&Oa&&(n.remF=Yg(n.remF,t)),e&Mo&&(n.modF=Yg(n.modF,t)),e&If&&(n.srcF=Yg(n.srcF,t)),n},materialize(e){e=e||El;const t=this;return e&Ir&&t.addF&&(t.add=Hv(t.add,t.addF),t.addF=null),e&Oa&&t.remF&&(t.rem=Hv(t.rem,t.remF),t.remF=null),e&Mo&&t.modF&&(t.mod=Hv(t.mod,t.modF),t.modF=null),e&If&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit(e,t){const n=this,i=t;if(e&If)return ma(n.source,n.srcF,i),n;e&Ir&&ma(n.add,n.addF,i),e&Oa&&ma(n.rem,n.remF,i),e&Mo&&ma(n.mod,n.modF,i);const r=n.source;if(e&zT&&r){const o=n.add.length+n.mod.length;o===r.length||(o?ma(r,qT(n,PT),i):ma(r,n.srcF,i))}return n}};function Gv(e,t,n,i){const r=this,o=n.length;let a=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=i||null,this.pulses=n;for(let s=0;s<o;++s){const u=n[s];if(u.stamp===t){if(u.fields){const l=r.fields||(r.fields={});for(const c in u.fields)l[c]=1}u.changed(r.ADD)&&(a|=r.ADD),u.changed(r.REM)&&(a|=r.REM),u.changed(r.MOD)&&(a|=r.MOD)}}this.changes=a}W(Gv,Sa,{fork(e){const t=new Sa(this.dataflow).init(this,e&this.NO_FIELDS);return e!==void 0&&(e&t.ADD&&this.visit(t.ADD,n=>t.add.push(n)),e&t.REM&&this.visit(t.REM,n=>t.rem.push(n)),e&t.MOD&&this.visit(t.MOD,n=>t.mod.push(n))),t},changed(e){return this.changes&e},modified(e){const t=this,n=t.fields;return n&&t.changes&t.MOD?P(e)?e.some(i=>n[i]):n[e]:0},filter(){L("MultiPulse does not support filtering.")},materialize(){L("MultiPulse does not support materialization.")},visit(e,t){const n=this,i=n.pulses,r=i.length;let o=0;if(e&n.SOURCE)for(;o<r;++o)i[o].visit(e,t);else for(;o<r;++o)i[o].stamp===n.stamp&&i[o].visit(e,t);return n}});async function vq(e,t,n){const i=this,r=[];if(i._pulse)return WT(i);if(i._pending&&await i._pending,t&&await Bg(i,t),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const o=++i._clock;i._pulse=new Sa(i,o,e),i._touched.forEach(c=>i._enqueue(c,!0)),i._touched=zg(pf);let a=0,s,u,l;try{for(;i._heap.size()>0;){if(s=i._heap.pop(),s.rank!==s.qrank){i._enqueue(s,!0);continue}u=s.run(i._getPulse(s,e)),u.then?u=await u:u.async&&(r.push(u.async),u=Vg),u!==Vg&&s._targets&&s._targets.forEach(c=>i._enqueue(c)),++a}}catch(c){i._heap.clear(),l=c}if(i._input={},i._pulse=null,i.debug(`Pulse ${o}: ${a} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const c=i._postrun.sort((f,d)=>d.priority-f.priority);i._postrun=[];for(let f=0;f<c.length;++f)await Bg(i,c[f].callback)}return n&&await Bg(i,n),r.length&&Promise.all(r).then(c=>i.runAsync(null,()=>{c.forEach(f=>{try{f(i)}catch(d){i.error(d)}})})),i}async function bq(e,t,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(e,t,n)).then(i,i),this._running}function xq(e,t,n){return this._pulse?WT(this):(this.evaluate(e,t,n),this)}function wq(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(i){this.error(i)}}function WT(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}function _q(e,t){const n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))}function Eq(e,t){const n=e.source,i=this._clock;return n&&P(n)?new Gv(this,i,n.map(r=>r.pulse),t):this._input[e.id]||Oq(this._pulse,n&&n.pulse)}function Oq(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==Vg&&(e.source=t.source),e)}const Vv={skip:!1,force:!1};function Sq(e,t){const n=t||Vv;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this}function Aq(e,t,n){const i=n||Vv;return(e.set(t)||i.force)&&this.touch(e,i),this}function kq(e,t,n){this.touch(e,n||Vv);const i=new Sa(this,this._clock+(this._pulse?0:1)),r=e.pulse&&e.pulse.source||[];return i.target=e,this._input[e.id]=t.pulse(i,r),this}function Cq(e){let t=[];return{clear:()=>t=[],size:()=>t.length,peek:()=>t[0],push:n=>(t.push(n),HT(t,0,t.length-1,e)),pop:()=>{const n=t.pop();let i;return t.length?(i=t[0],t[0]=n,Tq(t,0,e)):i=n,i}}}function HT(e,t,n,i){let r,o;const a=e[n];for(;n>t;){if(o=n-1>>1,r=e[o],i(a,r)<0){e[n]=r,n=o;continue}break}return e[n]=a}function Tq(e,t,n){const i=t,r=e.length,o=e[t];let a=(t<<1)+1,s;for(;a<r;)s=a+1,s<r&&n(e[a],e[s])>=0&&(a=s),e[t]=e[a],t=a,a=(t<<1)+1;return e[t]=o,HT(e,i,t,n)}function Ol(){this.logger(Wy()),this.logLevel(Uy),this._clock=0,this._rank=0,this._locale=Pv();try{this._loader=Pg()}catch{}this._touched=zg(pf),this._input={},this._pulse=null,this._heap=Cq((e,t)=>e.qrank-t.qrank),this._postrun=[]}function Pf(e){return function(){return this._log[e].apply(this,arguments)}}Ol.prototype={stamp(){return this._clock},loader(e){return arguments.length?(this._loader=e,this):this._loader},locale(e){return arguments.length?(this._locale=e,this):this._locale},logger(e){return arguments.length?(this._log=e,this):this._log},error:Pf("error"),warn:Pf("warn"),info:Pf("info"),debug:Pf("debug"),logLevel:Pf("level"),cleanThreshold:1e4,add:tq,connect:nq,rank:pq,rerank:mq,pulse:kq,touch:Sq,update:Aq,changeset:Ls,ingest:aq,parse:oq,preload:uq,request:sq,events:rq,on:fq,evaluate:vq,run:xq,runAsync:bq,runAfter:wq,_enqueue:_q,_getPulse:Eq};function R(e,t){it.call(this,e,null,t)}W(R,it,{run(e){if(e.stamp<this.stamp)return e.StopPropagation;let t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t.then?t=t.then(n=>this.pulse=n):t!==e.StopPropagation&&(this.pulse=t),t},evaluate(e){const t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform(){}});const Sl={};function GT(e){const t=VT(e);return t&&t.Definition||null}function VT(e){return e=e&&e.toLowerCase(),re(Sl,e)?Sl[e]:null}function*YT(e,t){if(t==null)for(let n of e)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of e)i=t(i,++n,e),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function Yv(e,t,n){const i=Float64Array.from(YT(e,n));return i.sort(ml),t.map(r=>mC(i,r))}function Xv(e,t){return Yv(e,[.25,.5,.75],t)}function Kv(e,t){const n=e.length,i=Wz(e,t),r=Xv(e,t),o=(r[2]-r[0])/1.34,a=Math.min(i,o)||i||Math.abs(r[0])||1;return 1.06*a*Math.pow(n,-.2)}function XT(e){const t=e.maxbins||20,n=e.base||10,i=Math.log(n),r=e.divide||[5,2];let o=e.extent[0],a=e.extent[1],s,u,l,c,f,d;const h=e.span||a-o||Math.abs(o)||1;if(e.step)s=e.step;else if(e.steps){for(c=h/t,f=0,d=e.steps.length;f<d&&e.steps[f]<c;++f);s=e.steps[Math.max(0,f-1)]}else{for(u=Math.ceil(Math.log(t)/i),l=e.minstep||0,s=Math.max(l,Math.pow(n,Math.round(Math.log(h)/i)-u));Math.ceil(h/s)>t;)s*=n;for(f=0,d=r.length;f<d;++f)c=s/r[f],c>=l&&h/c<=t&&(s=c)}c=Math.log(s);const g=c>=0?0:~~(-c/i)+1,p=Math.pow(n,-g-1);return(e.nice||e.nice===void 0)&&(c=Math.floor(o/s+p)*s,o=o<c?c-s:c,a=Math.ceil(a/s)*s),{start:o,stop:a===o?o+s:a,step:s}}var $i=Math.random;function Fq(e){$i=e}function KT(e,t,n,i){if(!e.length)return[void 0,void 0];const r=Float64Array.from(YT(e,i)),o=r.length,a=t;let s,u,l,c;for(l=0,c=Array(a);l<a;++l){for(s=0,u=0;u<o;++u)s+=r[~~($i()*o)];c[l]=s/o}return c.sort(ml),[uv(c,n/2),uv(c,1-n/2)]}function JT(e,t,n,i){i=i||(d=>d);const r=e.length,o=new Float64Array(r);let a=0,s=1,u=i(e[0]),l=u,c=u+t,f;for(;s<r;++s){if(f=i(e[s]),f>=c){for(l=(u+l)/2;a<s;++a)o[a]=l;c=f+t,u=f}l=f}for(l=(u+l)/2;a<s;++a)o[a]=l;return n?Mq(o,t+t/4):o}function Mq(e,t){const n=e.length;let i=0,r=1,o,a;for(;e[i]===e[r];)++r;for(;r<n;){for(o=r+1;e[r]===e[o];)++o;if(e[r]-e[r-1]<t){for(a=r+(i+o-r-r>>1);a<r;)e[a++]=e[r];for(;a>r;)e[a--]=e[i]}i=r,r=o}return e}function Dq(e){return function(){return e=(1103515245*e+12345)%2147483647,e/2147483647}}function Nq(e,t){t==null&&(t=e,e=0);let n,i,r;const o={min(a){return arguments.length?(n=a||0,r=i-n,o):n},max(a){return arguments.length?(i=a||0,r=i-n,o):i},sample(){return n+Math.floor(r*$i())},pdf(a){return a===Math.floor(a)&&a>=n&&a<i?1/r:0},cdf(a){const s=Math.floor(a);return s<n?0:s>=i?1:(s-n+1)/r},icdf(a){return a>=0&&a<=1?n-1+Math.floor(a*r):NaN}};return o.min(e).max(t)}const QT=Math.sqrt(2*Math.PI),Rq=Math.SQRT2;let zf=NaN;function Xg(e,t){e=e||0,t=t==null?1:t;let n=0,i=0,r,o;if(zf===zf)n=zf,zf=NaN;else{do n=$i()*2-1,i=$i()*2-1,r=n*n+i*i;while(r===0||r>1);o=Math.sqrt(-2*Math.log(r)/r),n*=o,zf=i*o}return e+n*t}function Jv(e,t,n){n=n==null?1:n;const i=(e-(t||0))/n;return Math.exp(-.5*i*i)/(n*QT)}function Kg(e,t,n){t=t||0,n=n==null?1:n;const i=(e-t)/n,r=Math.abs(i);let o;if(r>37)o=0;else{const a=Math.exp(-r*r/2);let s;r<7.07106781186547?(s=.0352624965998911*r+.700383064443688,s=s*r+6.37396220353165,s=s*r+33.912866078383,s=s*r+112.079291497871,s=s*r+221.213596169931,s=s*r+220.206867912376,o=a*s,s=.0883883476483184*r+1.75566716318264,s=s*r+16.064177579207,s=s*r+86.7807322029461,s=s*r+296.564248779674,s=s*r+637.333633378831,s=s*r+793.826512519948,s=s*r+440.413735824752,o=o/s):(s=r+.65,s=r+4/s,s=r+3/s,s=r+2/s,s=r+1/s,o=a/s/2.506628274631)}return i>0?1-o:o}function Jg(e,t,n){return e<0||e>1?NaN:(t||0)+(n==null?1:n)*Rq*jq(2*e-1)}function jq(e){let t=-Math.log((1-e)*(1+e)),n;return t<6.25?(t-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*t,n=128584807152564e-32+n*t,n=11157877678025181e-33+n*t,n=-1333171662854621e-31+n*t,n=20972767875968562e-33+n*t,n=6637638134358324e-30+n*t,n=-4054566272975207e-29+n*t,n=-8151934197605472e-29+n*t,n=26335093153082323e-28+n*t,n=-12975133253453532e-27+n*t,n=-5415412054294628e-26+n*t,n=10512122733215323e-25+n*t,n=-4112633980346984e-24+n*t,n=-29070369957882005e-24+n*t,n=42347877827932404e-23+n*t,n=-13654692000834679e-22+n*t,n=-13882523362786469e-21+n*t,n=.00018673420803405714+n*t,n=-.000740702534166267+n*t,n=-.006033670871430149+n*t,n=.24015818242558962+n*t,n=1.6536545626831027+n*t):t<16?(t=Math.sqrt(t)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*t,n=-27517406297064545e-23+n*t,n=18239629214389228e-24+n*t,n=15027403968909828e-22+n*t,n=-4013867526981546e-21+n*t,n=29234449089955446e-22+n*t,n=12475304481671779e-21+n*t,n=-47318229009055734e-21+n*t,n=6828485145957318e-20+n*t,n=24031110387097894e-21+n*t,n=-.0003550375203628475+n*t,n=.0009532893797373805+n*t,n=-.0016882755560235047+n*t,n=.002491442096107851+n*t,n=-.003751208507569241+n*t,n=.005370914553590064+n*t,n=1.0052589676941592+n*t,n=3.0838856104922208+n*t):Number.isFinite(t)?(t=Math.sqrt(t)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*t,n=15076572693500548e-25+n*t,n=-3789465440126737e-24+n*t,n=761570120807834e-23+n*t,n=-1496002662714924e-23+n*t,n=2914795345090108e-23+n*t,n=-6771199775845234e-23+n*t,n=22900482228026655e-23+n*t,n=-99298272942317e-20+n*t,n=4526062597223154e-21+n*t,n=-1968177810553167e-20+n*t,n=7599527703001776e-20+n*t,n=-.00021503011930044477+n*t,n=-.00013871931833623122+n*t,n=1.0103004648645344+n*t,n=4.849906401408584+n*t):n=1/0,n*e}function Qv(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>Xg(n,i),pdf:o=>Jv(o,n,i),cdf:o=>Kg(o,n,i),icdf:o=>Jg(o,n,i)};return r.mean(e).stdev(t)}function Zv(e,t){const n=Qv();let i=0;const r={data(o){return arguments.length?(e=o,i=o?o.length:0,r.bandwidth(t)):e},bandwidth(o){return arguments.length?(t=o,!t&&e&&(t=Kv(e)),r):t},sample(){return e[~~($i()*i)]+t*n.sample()},pdf(o){let a=0,s=0;for(;s<i;++s)a+=n.pdf((o-e[s])/t);return a/t/i},cdf(o){let a=0,s=0;for(;s<i;++s)a+=n.cdf((o-e[s])/t);return a/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(e)}function eb(e,t){return e=e||0,t=t==null?1:t,Math.exp(e+Xg()*t)}function tb(e,t,n){if(e<=0)return 0;t=t||0,n=n==null?1:n;const i=(Math.log(e)-t)/n;return Math.exp(-.5*i*i)/(n*QT*e)}function nb(e,t,n){return Kg(Math.log(e),t,n)}function ib(e,t,n){return Math.exp(Jg(e,t,n))}function ZT(e,t){let n,i;const r={mean(o){return arguments.length?(n=o||0,r):n},stdev(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>eb(n,i),pdf:o=>tb(o,n,i),cdf:o=>nb(o,n,i),icdf:o=>ib(o,n,i)};return r.mean(e).stdev(t)}function eF(e,t){let n=0,i;function r(a){const s=[];let u=0,l;for(l=0;l<n;++l)u+=s[l]=a[l]==null?1:+a[l];for(l=0;l<n;++l)s[l]/=u;return s}const o={weights(a){return arguments.length?(i=r(t=a||[]),o):t},distributions(a){return arguments.length?(a?(n=a.length,e=a):(n=0,e=[]),o.weights(t)):e},sample(){const a=$i();let s=e[n-1],u=i[0],l=0;for(;l<n-1;u+=i[++l])if(a<u){s=e[l];break}return s.sample()},pdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].pdf(a);return s},cdf(a){let s=0,u=0;for(;u<n;++u)s+=i[u]*e[u].cdf(a);return s},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(e).weights(t)}function rb(e,t){return t==null&&(t=e==null?1:e,e=0),e+(t-e)*$i()}function ob(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function ab(e,t,n){return n==null&&(n=t==null?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function sb(e,t,n){return n==null&&(n=t==null?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function tF(e,t){let n,i;const r={min(o){return arguments.length?(n=o||0,r):n},max(o){return arguments.length?(i=o==null?1:o,r):i},sample:()=>rb(n,i),pdf:o=>ob(o,n,i),cdf:o=>ab(o,n,i),icdf:o=>sb(o,n,i)};return t==null&&(t=e==null?1:e,e=0),r.min(e).max(t)}function Bf(e,t,n,i){const r=i-e*e,o=Math.abs(r)<1e-24?0:(n-e*t)/r;return[t-o*e,o]}function Qg(e,t,n,i){e=e.filter(h=>{let g=t(h),p=n(h);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),i&&e.sort((h,g)=>t(h)-t(g));const r=e.length,o=new Float64Array(r),a=new Float64Array(r);let s=0,u=0,l=0,c,f,d;for(d of e)o[s]=c=+t(d),a[s]=f=+n(d),++s,u+=(c-u)/s,l+=(f-l)/s;for(s=0;s<r;++s)o[s]-=u,a[s]-=l;return[o,a,u,l]}function Uf(e,t,n,i){let r=-1,o,a;for(const s of e)o=t(s),a=n(s),o!=null&&(o=+o)>=o&&a!=null&&(a=+a)>=a&&i(o,a,++r)}function Al(e,t,n,i,r){let o=0,a=0;return Uf(e,t,n,(s,u)=>{const l=u-r(s),c=u-i;o+=l*l,a+=c*c}),1-o/a}function ub(e,t,n){let i=0,r=0,o=0,a=0,s=0;Uf(e,t,n,(c,f)=>{++s,i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Bf(i,r,o,a),l=c=>u[0]+u[1]*c;return{coef:u,predict:l,rSquared:Al(e,t,n,r,l)}}function nF(e,t,n){let i=0,r=0,o=0,a=0,s=0;Uf(e,t,n,(c,f)=>{++s,c=Math.log(c),i+=(c-i)/s,r+=(f-r)/s,o+=(c*f-o)/s,a+=(c*c-a)/s});const u=Bf(i,r,o,a),l=c=>u[0]+u[1]*Math.log(c);return{coef:u,predict:l,rSquared:Al(e,t,n,r,l)}}function iF(e,t,n){const[i,r,o,a]=Qg(e,t,n);let s=0,u=0,l=0,c=0,f=0,d,h,g;Uf(e,t,n,(v,x)=>{d=i[f++],h=Math.log(x),g=d*x,s+=(x*h-s)/f,u+=(g-u)/f,l+=(g*h-l)/f,c+=(d*g-c)/f});const[p,m]=Bf(u/a,s/a,l/a,c/a),y=v=>Math.exp(p+m*(v-o));return{coef:[Math.exp(p-m*o),m],predict:y,rSquared:Al(e,t,n,a,y)}}function rF(e,t,n){let i=0,r=0,o=0,a=0,s=0,u=0;Uf(e,t,n,(f,d)=>{const h=Math.log(f),g=Math.log(d);++u,i+=(h-i)/u,r+=(g-r)/u,o+=(h*g-o)/u,a+=(h*h-a)/u,s+=(d-s)/u});const l=Bf(i,r,o,a),c=f=>l[0]*Math.pow(f,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Al(e,t,n,s,c)}}function lb(e,t,n){const[i,r,o,a]=Qg(e,t,n),s=i.length;let u=0,l=0,c=0,f=0,d=0,h,g,p,m;for(h=0;h<s;)g=i[h],p=r[h++],m=g*g,u+=(m-u)/h,l+=(m*g-l)/h,c+=(m*m-c)/h,f+=(g*p-f)/h,d+=(m*p-d)/h;const y=c-u*u,v=u*y-l*l,x=(d*u-f*l)/v,b=(f*y-d*l)/v,_=-x*u,E=w=>(w=w-o,x*w*w+b*w+_+a);return{coef:[_-b*o+x*o*o+a,b-2*x*o,x],predict:E,rSquared:Al(e,t,n,a,E)}}function oF(e,t,n,i){if(i===1)return ub(e,t,n);if(i===2)return lb(e,t,n);const[r,o,a,s]=Qg(e,t,n),u=r.length,l=[],c=[],f=i+1;let d,h,g,p,m;for(d=0;d<f;++d){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d)*o[g];for(l.push(p),m=new Float64Array(f),h=0;h<f;++h){for(g=0,p=0;g<u;++g)p+=Math.pow(r[g],d+h);m[h]=p}c.push(m)}c.push(l);const y=Lq(c),v=x=>{x-=a;let b=s+y[0]+y[1]*x+y[2]*x*x;for(d=3;d<f;++d)b+=y[d]*Math.pow(x,d);return b};return{coef:$q(f,y,-a,s),predict:v,rSquared:Al(e,t,n,s,v)}}function $q(e,t,n,i){const r=Array(e);let o,a,s,u;for(o=0;o<e;++o)r[o]=0;for(o=e-1;o>=0;--o)for(s=t[o],u=1,r[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,r[o-a]+=s*Math.pow(n,a)*u;return r[0]+=i,r}function Lq(e){const t=e.length-1,n=[];let i,r,o,a,s;for(i=0;i<t;++i){for(a=i,r=i+1;r<t;++r)Math.abs(e[i][r])>Math.abs(e[i][a])&&(a=r);for(o=i;o<t+1;++o)s=e[o][i],e[o][i]=e[o][a],e[o][a]=s;for(r=i+1;r<t;++r)for(o=t;o>=i;o--)e[o][r]-=e[o][i]*e[i][r]/e[i][i]}for(r=t-1;r>=0;--r){for(s=0,o=r+1;o<t;++o)s+=e[o][r]*n[o];n[r]=(e[t][r]-s)/e[r][r]}return n}const aF=2,sF=1e-12;function uF(e,t,n,i){const[r,o,a,s]=Qg(e,t,n,!0),u=r.length,l=Math.max(2,~~(i*u)),c=new Float64Array(u),f=new Float64Array(u),d=new Float64Array(u).fill(1);for(let h=-1;++h<=aF;){const g=[0,l-1];for(let m=0;m<u;++m){const y=r[m],v=g[0],x=g[1],b=y-r[v]>r[x]-y?v:x;let _=0,E=0,w=0,O=0,S=0;const k=1/Math.abs(r[b]-y||1);for(let C=v;C<=x;++C){const D=r[C],F=o[C],N=Iq(Math.abs(y-D)*k)*d[C],I=D*N;_+=N,E+=I,w+=F*N,O+=F*I,S+=D*I}const[A,M]=Bf(E/_,w/_,O/_,S/_);c[m]=A+M*y,f[m]=Math.abs(o[m]-c[m]),Pq(r,m+1,g)}if(h===aF)break;const p=yC(f);if(Math.abs(p)<sF)break;for(let m=0,y,v;m<u;++m)y=f[m]/(6*p),d[m]=y>=1?sF:(v=1-y*y)*v}return zq(r,c,a,s)}function Iq(e){return(e=1-e*e*e)*e*e}function Pq(e,t,n){const i=e[t];let r=n[0],o=n[1]+1;if(!(o>=e.length))for(;t>r&&e[o]-i<=i-e[r];)n[0]=++r,n[1]=o,++o}function zq(e,t,n,i){const r=e.length,o=[];let a=0,s=0,u=[],l;for(;a<r;++a)l=e[a]+n,u[0]===l?u[1]+=(t[a]-u[1])/++s:(s=0,u[1]+=i,u=[l,t[a]],o.push(u));return u[1]+=i,o}const Bq=.5*Math.PI/180;function Zg(e,t,n,i){n=n||25,i=Math.max(n,i||200);const r=p=>[p,e(p)],o=t[0],a=t[1],s=a-o,u=s/i,l=[r(o)],c=[];if(n===i){for(let p=1;p<i;++p)l.push(r(o+p/n*s));return l.push(r(a)),l}else{c.push(r(a));for(let p=n;--p>0;)c.push(r(o+p/n*s))}let f=l[0],d=c[c.length-1];const h=1/s,g=Uq(f[1],c);for(;d;){const p=r((f[0]+d[0])/2);p[0]-f[0]>=u&&qq(f,p,d,h,g)>Bq?c.push(p):(f=d,l.push(d),c.pop()),d=c[c.length-1]}return l}function Uq(e,t){let n=e,i=e;const r=t.length;for(let o=0;o<r;++o){const a=t[o][1];a<n&&(n=a),a>i&&(i=a)}return 1/(i-n)}function qq(e,t,n,i,r){const o=Math.atan2(r*(n[1]-e[1]),i*(n[0]-e[0])),a=Math.atan2(r*(t[1]-e[1]),i*(t[0]-e[0]));return Math.abs(o-a)}function Wq(e){return t=>{const n=e.length;let i=1,r=String(e[0](t));for(;i<n;++i)r+="|"+e[i](t);return r}}function cb(e){return!e||!e.length?function(){return""}:e.length===1?e[0]:Wq(e)}function lF(e,t,n){return n||e+(t?"_"+t:"")}const fb=()=>{},Hq={init:fb,add:fb,rem:fb,idx:0},qf={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.sum,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||e.min===void 0)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||e.max===void 0)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n)},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n)},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},Wf=Object.keys(qf);function Gq(e,t){return n=>Ee({name:e,out:n||e},Hq,t)}Wf.forEach(e=>{qf[e]=Gq(e,qf[e])});function cF(e,t){return qf[e](t)}function fF(e,t){return e.idx-t.idx}function Vq(e){const t={};e.forEach(i=>t[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{t[r]||n(t[r]=qf[r]())})};return e.forEach(n),Object.values(t).sort(fF)}function Yq(){this.valid=0,this.missing=0,this._ops.forEach(e=>e.init(this))}function Xq(e,t){if(e==null||e===""){++this.missing;return}e===e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t)))}function Kq(e,t){if(e==null||e===""){--this.missing;return}e===e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t)))}function Jq(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e}function dF(e,t){const n=t||dn,i=Vq(e),r=e.slice().sort(fF);function o(a){this._ops=i,this._out=r,this.cell=a,this.init()}return o.prototype.init=Yq,o.prototype.add=Xq,o.prototype.rem=Kq,o.prototype.set=Jq,o.prototype.get=n,o.fields=e.map(a=>a.out),o}function db(e){this._key=e?Yn(e):ae,this.reset()}const Qt=db.prototype;Qt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};Qt.add=function(e){this._add.push(e)};Qt.rem=function(e){this._rem.push(e)};Qt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,r=t.length,o=Array(i-r),a={};let s,u,l;for(s=0;s<r;++s)a[n(t[s])]=1;for(s=0,u=0;s<i;++s)a[n(l=e[s])]?a[n(l)]=0:o[u++]=l;return this._rem=[],this._add=o};Qt.distinct=function(e){const t=this.values(),n={};let i=t.length,r=0,o;for(;--i>=0;)o=e(t[i])+"",re(n,o)||(n[o]=1,++r);return r};Qt.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=Qk(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext};Qt.argmin=function(e){return this.extent(e)[0]||{}};Qt.argmax=function(e){return this.extent(e)[1]||{}};Qt.min=function(e){const t=this.extent(e)[0];return t!=null?e(t):void 0};Qt.max=function(e){const t=this.extent(e)[1];return t!=null?e(t):void 0};Qt.quartile=function(e){return(this._get!==e||!this._q)&&(this._q=Xv(this.values(),e),this._get=e),this._q};Qt.q1=function(e){return this.quartile(e)[0]};Qt.q2=function(e){return this.quartile(e)[1]};Qt.q3=function(e){return this.quartile(e)[2]};Qt.ci=function(e){return(this._get!==e||!this._ci)&&(this._ci=KT(this.values(),1e3,.05,e),this._get=e),this._ci};Qt.ci0=function(e){return this.ci(e)[0]};Qt.ci1=function(e){return this.ci(e)[1]};function Aa(e){R.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Aa.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Wf},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};W(Aa,R,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.modified();return n.stamp=i.stamp,n.value&&(r||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(n.value=n.value||n.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),i.modifies(n._outputs),n._drop=e.drop!==!1,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),r=n.length;function o(s){let u,l,c,f;for(u in s)for(c=s[u].tuple,l=0;l<r;++l)i[l][f=c[n[l]]]=f}o(e._prev),o(t);function a(s,u,l){const c=n[l],f=i[l++];for(const d in f){const h=s?s+"|"+d:d;u[c]=f[d],l<r?a(h,u,l):t[h]||e.cell(h,u)}}a("",{},0)},init(e){const t=this._inputs=[],n=this._outputs=[],i={};function r(m){const y=J(fn(m)),v=y.length;let x=0,b;for(;x<v;++x)i[b=y[x]]||(i[b]=1,t.push(b))}this._dims=J(e.groupby),this._dnames=this._dims.map(m=>{const y=yt(m);return r(m),n.push(y),y}),this.cellkey=e.key?e.key:cb(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e.fields||[null],a=e.ops||["count"],s=e.as||[],u=o.length,l={};let c,f,d,h,g,p;for(u!==a.length&&L("Unmatched number of fields and aggregate ops."),p=0;p<u;++p){if(c=o[p],f=a[p],c==null&&f!=="count"&&L("Null aggregate field specified."),h=yt(c),g=lF(f,h,s[p]),n.push(g),f==="count"){this._counts.push(g);continue}d=l[h],d||(r(c),d=l[h]=[],d.field=c,this._measures.push(d)),f!=="count"&&(this._countOnly=!1),d.push(cF(f,g))}return this._measures=this._measures.map(m=>dF(m,m.field)),{}},cellkey:cb(),cell(e,t){let n=this.value[e];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let o=0;o<r;++o)n.agg[o]=new i[o](n)}return n.store&&(n.data=new db),n},newtuple(e,t){const n=this._dnames,i=this._dims,r=i.length,o={};for(let a=0;a<r;++a)o[n[a]]=i[a](e);return t?$T(t.tuple,o):Ue(o)},clean(){const e=this.value;for(const t in e)e[t].num===0&&delete e[t]},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].add(i[r].get(e),e)},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let r=0,o=i.length;r<o;++r)i[r].rem(i[r].get(e),e)},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,r=n.length;i<r;++i)t[n[i]]=e.num;if(!this._countOnly){const i=e.agg;for(let r=0,o=i.length;r<o;++r)i[r].set(t)}return t},changes(e){const t=this._adds,n=this._mods,i=this._prev,r=this._drop,o=e.add,a=e.rem,s=e.mod;let u,l,c,f;if(i)for(l in i)u=i[l],(!r||u.num)&&a.push(u.tuple);for(c=0,f=this._alen;c<f;++c)o.push(this.celltuple(t[c])),t[c]=null;for(c=0,f=this._mlen;c<f;++c)u=n[c],(u.num===0&&r?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,e}});const Qq=1e-14;function hb(e){R.call(this,null,e)}hb.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};W(hb,R,{transform(e,t){const n=e.interval!==!1,i=this._bins(e),r=i.start,o=i.step,a=e.as||["bin0","bin1"],s=a[0],u=a[1];let l;return e.modified()?(t=t.reflow(!0),l=t.SOURCE):l=t.modified(fn(e.field))?t.ADD_MOD:t.ADD,t.visit(l,n?c=>{const f=i(c);c[s]=f,c[u]=f==null?null:r+o*(1+(f-r)/o)}:c=>c[s]=i(c)),t.modifies(n?a:s)},_bins(e){if(this.value&&!e.modified())return this.value;const t=e.field,n=XT(e),i=n.step;let r=n.start,o=r+Math.ceil((n.stop-r)/i)*i,a,s;(a=e.anchor)!=null&&(s=a-(r+i*Math.floor((a-r)/i)),r+=s,o+=s);const u=function(l){let c=hn(t(l));return c==null?null:c<r?-1/0:c>o?1/0:(c=Math.max(r,Math.min(c,o-i)),r+i*Math.floor(Qq+(c-r)/i))};return u.start=r,u.stop=n.stop,u.step=i,this.value=Vn(u,fn(t),e.name||"bin_"+yt(t))}});function hF(e,t,n){const i=e;let r=t||[],o=n||[],a={},s=0;return{add:u=>o.push(u),remove:u=>a[i(u)]=++s,size:()=>r.length,data:(u,l)=>(s&&(r=r.filter(c=>!a[i(c)]),a={},s=0),l&&u&&r.sort(u),o.length&&(r=u?rC(u,r,o.sort(u)):r.concat(o),o=[]),r)}}function gb(e){R.call(this,[],e)}gb.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};W(gb,R,{transform(e,t){const n=t.fork(t.ALL),i=hF(ae,this.value,n.materialize(n.ADD).add),r=e.sort,o=t.changed()||r&&(e.modified("sort")||t.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(o),this.value=n.source=i.data($s(r),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}});function gF(e){it.call(this,null,Zq,e)}W(gF,it);function Zq(e){return this.value&&!e.modified()?this.value:Yy(e.fields,e.orders)}function pb(e){R.call(this,null,e)}pb.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function eW(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();break}return e.match(n)}W(pb,R,{transform(e,t){const n=f=>d=>{for(var h=eW(s(d),e.case,o)||[],g,p=0,m=h.length;p<m;++p)a.test(g=h[p])||f(g)},i=this._parameterCheck(e,t),r=this._counts,o=this._match,a=this._stop,s=e.field,u=e.as||["text","count"],l=n(f=>r[f]=1+(r[f]||0)),c=n(f=>r[f]-=1);return i?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,u)},_parameterCheck(e,t){let n=!1;return(e.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),(e.modified("pattern")||!this._match)&&(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),r=t[0],o=t[1],a=e.fork(e.NO_SOURCE|e.NO_FIELDS);let s,u,l;for(s in n)u=i[s],l=n[s]||0,!u&&l?(i[s]=u=Ue({}),u[r]=s,u[o]=l,a.add.push(u)):l===0?(u&&a.rem.push(u),n[s]=null,i[s]=null):u[o]!==l&&(u[o]=l,a.mod.push(u));return a.modifies(t)}});function mb(e){R.call(this,null,e)}mb.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};W(mb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],r=i[0],o=i[1],a=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let s=this.value;return a?(s&&(n.rem=s),s=t.materialize(t.SOURCE).source,n.add=this.value=tW(s,r,o,e.filter||Ni)):n.mod=s,n.source=this.value,n.modifies(i)}});function tW(e,t,n,i){for(var r=[],o={},a=e.length,s=0,u,l;s<a;++s)for(o[t]=l=e[s],u=0;u<a;++u)o[n]=e[u],i(o)&&(r.push(Ue(o)),o={},o[t]=l);return r}const pF={kde:Zv,mixture:eF,normal:Qv,lognormal:ZT,uniform:tF},nW="distributions",mF="function",iW="field";function yF(e,t){const n=e[mF];re(pF,n)||L("Unknown distribution function: "+n);const i=pF[n]();for(const r in e)r===iW?i.data((e.from||t()).map(e[r])):r===nW?i[r](e[r].map(o=>yF(o,t))):typeof i[r]===mF&&i[r](e[r]);return i}function yb(e){R.call(this,null,e)}const vF=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],rW={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:vF},{name:"weights",type:"number",array:!0}]};yb.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:vF.concat(rW)},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(yb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=yF(e.distribution,oW(t)),r=e.steps||e.minsteps||25,o=e.steps||e.maxsteps||200;let a=e.method||"pdf";a!=="pdf"&&a!=="cdf"&&L("Invalid density method: "+a),!e.extent&&!i.data&&L("Missing density extent parameter."),a=i[a];const s=e.as||["value","density"],u=e.extent||$r(i.data()),l=Zg(a,u,r,o).map(c=>{const f={};return f[s[0]]=c[0],f[s[1]]=c[1],Ue(f)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function oW(e){return()=>e.materialize(e.SOURCE).source}function bF(e,t){return e?e.map((n,i)=>t[i]||yt(n)):null}function vb(e,t,n){const i=[],r=f=>f(u);let o,a,s,u,l,c;if(t==null)i.push(e.map(n));else for(o={},a=0,s=e.length;a<s;++a)u=e[a],l=t.map(r),c=o[l],c||(o[l]=c=[],c.dims=l,i.push(c)),c.push(n(u));return i}const xF="bin";function bb(e){R.call(this,null,e)}bb.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:xF}]};const aW=(e,t)=>yf($r(e,t))/30;W(bb,R,{transform(e,t){if(this.value&&!(e.modified()||t.changed()))return t;const n=t.materialize(t.SOURCE).source,i=vb(t.source,e.groupby,dn),r=e.smooth||!1,o=e.field,a=e.step||aW(n,o),s=$s((g,p)=>o(g)-o(p)),u=e.as||xF,l=i.length;let c=1/0,f=-1/0,d=0,h;for(;d<l;++d){const g=i[d].sort(s);h=-1;for(const p of JT(g,a,r,o))p<c&&(c=p),p>f&&(f=p),g[++h][u]=p}return this.value={start:c,stop:f,step:a},t.reflow(!0).modifies(u)}});function wF(e){it.call(this,null,sW,e),this.modified(!0)}W(wF,it);function sW(e){const t=e.expr;return this.value&&!e.modified("expr")?this.value:Vn(n=>t(n,e),fn(t),yt(t))}function xb(e){R.call(this,[void 0,void 0],e)}xb.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};W(xb,R,{transform(e,t){const n=this.value,i=e.field,r=t.changed()||t.modified(i.fields)||e.modified("field");let o=n[0],a=n[1];if((r||o==null)&&(o=1/0,a=-1/0),t.visit(r?t.SOURCE:t.ADD,s=>{const u=hn(i(s));u!=null&&(u<o&&(o=u),u>a&&(a=u))}),!Number.isFinite(o)||!Number.isFinite(a)){let s=yt(i);s&&(s=` for field "${s}"`),t.dataflow.warn(`Infinite extent${s}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}});function wb(e,t){it.call(this,e),this.parent=t,this.count=0}W(wb,it,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add(e){this.count+=1,this.value.add.push(e)},rem(e){this.count-=1,this.value.rem.push(e)},mod(e){this.value.mod.push(e)},init(e){this.value.init(e,e.NO_SOURCE)},evaluate(){return this.value}});function ep(e){R.call(this,{},e),this._keys=gl();const t=this._targets=[];t.active=0,t.forEach=n=>{for(let i=0,r=t.active;i<r;++i)n(t[i],i,t)}}W(ep,R,{activate(e){this._targets[this._targets.active++]=e},subflow(e,t,n,i){const r=this.value;let o=re(r,e)&&r[e],a,s;return o?o.value.stamp<n.stamp&&(o.init(n),this.activate(o)):(s=i||(s=this._group[e])&&s.tuple,a=n.dataflow,o=new wb(n.fork(n.NO_SOURCE),this),a.add(o).connect(t(a,e,s)),r[e]=o,this.activate(o)),o},clean(){const e=this.value;let t=0;for(const n in e)if(e[n].count===0){const i=e[n].detachSubflow;i&&i(),delete e[n],++t}if(t){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let r=0;for(;r<i;++r)t[r]=e[r];for(;r<n&&t[r]!=null;++r)t[r]=null;t.active=i},transform(e,t){const n=t.dataflow,i=e.key,r=e.subflow,o=this._keys,a=e.modified("key"),s=u=>this.subflow(u,r,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,u=>{const l=ae(u),c=o.get(l);c!==void 0&&(o.delete(l),s(c).rem(u))}),t.visit(t.ADD,u=>{const l=i(u);o.set(ae(u),l),s(l).add(u)}),a||t.modified(i.fields)?t.visit(t.MOD,u=>{const l=ae(u),c=o.get(l),f=i(u);c===f?s(f).mod(u):(o.set(l,f),s(c).rem(u),s(f).add(u))}):t.changed(t.MOD)&&t.visit(t.MOD,u=>{s(o.get(ae(u))).mod(u)}),a&&t.visit(t.REFLOW,u=>{const l=ae(u),c=o.get(l),f=i(u);c!==f&&(o.set(l,f),s(c).rem(u),s(f).add(u))}),t.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),t}});function _F(e){it.call(this,null,uW,e)}W(_F,it);function uW(e){return this.value&&!e.modified()?this.value:P(e.name)?J(e.name).map(t=>Yn(t)):Yn(e.name,e.as)}function _b(e){R.call(this,gl(),e)}_b.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};W(_b,R,{transform(e,t){const n=t.dataflow,i=this.value,r=t.fork(),o=r.add,a=r.rem,s=r.mod,u=e.expr;let l=!0;t.visit(t.REM,f=>{const d=ae(f);i.has(d)?i.delete(d):a.push(f)}),t.visit(t.ADD,f=>{u(f,e)?o.push(f):i.set(ae(f),1)});function c(f){const d=ae(f),h=u(f,e),g=i.get(d);h&&g?(i.delete(d),o.push(f)):!h&&!g?(i.set(d,1),a.push(f)):l&&h&&!g&&s.push(f)}return t.visit(t.MOD,c),e.modified()&&(l=!1,t.visit(t.REFLOW,c)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function Eb(e){R.call(this,[],e)}Eb.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};W(Eb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=bF(i,e.as||[]),o=e.index||null,a=r.length;return n.rem=this.value,t.visit(t.SOURCE,s=>{const u=i.map(g=>g(s)),l=u.reduce((g,p)=>Math.max(g,p.length),0);let c=0,f,d,h;for(;c<l;++c){for(d=Wv(s),f=0;f<a;++f)d[r[f]]=(h=u[f][c])==null?null:h;o&&(d[o]=c),n.add.push(d)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(r)}});function Ob(e){R.call(this,[],e)}Ob.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};W(Ob,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=i.map(yt),o=e.as||["key","value"],a=o[0],s=o[1],u=i.length;return n.rem=this.value,t.visit(t.SOURCE,l=>{for(let c=0,f;c<u;++c)f=Wv(l),f[a]=r[c],f[s]=i[c](l),n.add.push(f)}),this.value=n.source=n.add,n.modifies(o)}});function Sb(e){R.call(this,null,e)}Sb.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};W(Sb,R,{transform(e,t){const n=e.expr,i=e.as,r=e.modified(),o=e.initonly?t.ADD:r?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return r&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(o,a=>a[i]=n(a,e))}});function EF(e){R.call(this,[],e)}W(EF,R,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let r=this.value,o=e.size-r.length,a,s,u;if(o>0){for(a=[];--o>=0;)a.push(u=Ue(i(e))),r.push(u);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a}else s=r.slice(0,-o),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,r=r.slice(-o);return n.source=this.value=r,n}});const tp={value:"value",median:yC,mean:Gz,min:sv,max:Ms},lW=[];function Ab(e){R.call(this,[],e)}Ab.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function cW(e){var t=e.method||tp.value,n;if(tp[t]==null)L("Unrecognized imputation method: "+t);else return t===tp.value?(n=e.value!==void 0?e.value:0,()=>n):tp[t]}function fW(e){const t=e.field;return n=>n?t(n):NaN}W(Ab,R,{transform(e,t){var n=t.fork(t.ALL),i=cW(e),r=fW(e),o=yt(e.field),a=yt(e.key),s=(e.groupby||[]).map(yt),u=dW(t.source,e.groupby,e.key,e.keyvals),l=[],c=this.value,f=u.domain.length,d,h,g,p,m,y,v,x,b,_;for(m=0,x=u.length;m<x;++m)for(d=u[m],g=d.values,h=NaN,v=0;v<f;++v)if(d[v]==null){for(p=u.domain[v],_={_impute:!0},y=0,b=g.length;y<b;++y)_[s[y]]=g[y];_[a]=p,_[o]=Number.isNaN(h)?h=i(d,r):h,l.push(Ue(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),c.length&&(n.rem=n.materialize(n.REM).rem.concat(c)),this.value=l,n}});function dW(e,t,n,i){var r=y=>y(m),o=[],a=i?i.slice():[],s={},u={},l,c,f,d,h,g,p,m;for(a.forEach((y,v)=>s[y]=v+1),d=0,p=e.length;d<p;++d)m=e[d],g=n(m),h=s[g]||(s[g]=a.push(g)),c=(l=t?t.map(r):lW)+"",(f=u[c])||(f=u[c]=[],o.push(f),f.values=l),f[h-1]=m;return o.domain=a,o}function kb(e){Aa.call(this,e)}kb.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Wf},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};W(kb,Aa,{transform(e,t){const n=this,i=e.modified();let r;return n.value&&(i||t.modified(n._inputs,!0))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,o=>n.add(o))):(r=n.value=n.value||this.init(e),t.visit(t.REM,o=>n.rem(o)),t.visit(t.ADD,o=>n.add(o))),n.changes(),t.visit(t.SOURCE,o=>{Ee(o,r[n.cellkey(o)].tuple)}),t.reflow(i).modifies(this._outputs)},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0}});function Cb(e){R.call(this,null,e)}Cb.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};W(Cb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=vb(i,e.groupby,e.field),o=(e.groupby||[]).map(yt),a=e.bandwidth,s=e.cumulative?"cdf":"pdf",u=e.as||["value","density"],l=[];let c=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;s!=="pdf"&&s!=="cdf"&&L("Invalid density method: "+s),e.resolve==="shared"&&(c||(c=$r(i,e.field)),f=d=e.steps||d),r.forEach(h=>{const g=Zv(h,a)[s],p=e.counts?h.length:1,m=c||$r(h);Zg(g,m,f,d).forEach(y=>{const v={};for(let x=0;x<o.length;++x)v[o[x]]=h.dims[x];v[u[0]]=y[0],v[u[1]]=y[1]*p,l.push(Ue(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function OF(e){it.call(this,null,hW,e)}W(OF,it);function hW(e){return this.value&&!e.modified()?this.value:Ky(e.fields,e.flat)}function SF(e){R.call(this,[],e),this._pending=null}W(SF,R,{transform(e,t){const n=t.dataflow;return this._pending?Tb(this,t,this._pending):gW(e)?t.StopPropagation:e.values?Tb(this,t,n.parse(e.values,e.format)):e.async?{async:n.request(e.url,e.format).then(r=>(this._pending=J(r.data),o=>o.touch(this)))}:n.request(e.url,e.format).then(i=>Tb(this,t,J(i.data)))}});function gW(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}function Tb(e,t,n){n.forEach(Ue);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i}function Fb(e){R.call(this,{},e)}Fb.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};W(Fb,R,{transform(e,t){const n=e.fields,i=e.index,r=e.values,o=e.default==null?null:e.default,a=e.modified(),s=n.length;let u=a?t.SOURCE:t.ADD,l=t,c=e.as,f,d,h;return r?(d=r.length,s>1&&!c&&L('Multi-field lookup requires explicit "as" parameter.'),c&&c.length!==s*d&&L('The "as" parameter has too few output field names.'),c=c||r.map(yt),f=function(g){for(var p=0,m=0,y,v;p<s;++p)if(v=i.get(n[p](g)),v==null)for(y=0;y<d;++y,++m)g[c[m]]=o;else for(y=0;y<d;++y,++m)g[c[m]]=r[y](v)}):(c||L("Missing output field names."),f=function(g){for(var p=0,m;p<s;++p)m=i.get(n[p](g)),g[c[p]]=m==null?o:m}),a?l=t.reflow(!0):(h=n.some(g=>t.modified(g.fields)),u|=h?t.MOD:0),t.visit(u,f),l.modifies(c)}});function AF(e){it.call(this,null,pW,e)}W(AF,it);function pW(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i=1/0,r=-1/0,o,a;for(o=0;o<n;++o)a=t[o],a[0]<i&&(i=a[0]),a[1]>r&&(r=a[1]);return[i,r]}function kF(e){it.call(this,null,mW,e)}W(kF,it);function mW(e){return this.value&&!e.modified()?this.value:e.values.reduce((t,n)=>t.concat(n),[])}function CF(e){R.call(this,null,e)}W(CF,R,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function Mb(e){Aa.call(this,e)}Mb.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Wf,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};W(Mb,Aa,{_transform:Aa.prototype.transform,transform(e,t){return this._transform(yW(e,t),t)}});function yW(e,t){const n=e.field,i=e.value,r=(e.op==="count"?"__count__":e.op)||"sum",o=fn(n).concat(fn(i)),a=bW(n,e.limit||0,t);return t.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:a.map(()=>r),fields:a.map(s=>vW(s,n,i,o)),as:a.map(s=>s+""),modified:e.modified.bind(e)}}function vW(e,t,n,i){return Vn(r=>t(r)===e?n(r):NaN,i,e+"")}function bW(e,t,n){const i={},r=[];return n.visit(n.SOURCE,o=>{const a=e(o);i[a]||(i[a]=1,r.push(a))}),r.sort(kg),t?r.slice(0,t):r}function TF(e){ep.call(this,e)}W(TF,ep,{transform(e,t){const n=e.subflow,i=e.field,r=o=>this.subflow(ae(o),n,t,o);return(e.modified("field")||i&&t.modified(fn(i)))&&L("PreFacet does not support field modification."),this.initTargets(),i?(t.visit(t.MOD,o=>{const a=r(o);i(o).forEach(s=>a.mod(s))}),t.visit(t.ADD,o=>{const a=r(o);i(o).forEach(s=>a.add(Ue(s)))}),t.visit(t.REM,o=>{const a=r(o);i(o).forEach(s=>a.rem(s))})):(t.visit(t.MOD,o=>r(o).mod(o)),t.visit(t.ADD,o=>r(o).add(o)),t.visit(t.REM,o=>r(o).rem(o))),t.clean()&&t.runAfter(()=>this.clean()),t}});function Db(e){R.call(this,null,e)}Db.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};W(Db,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,r=bF(e.fields,e.as||[]),o=i?(s,u)=>xW(s,u,i,r):qg;let a;return this.value?a=this.value:(t=t.addAll(),a=this.value={}),t.visit(t.REM,s=>{const u=ae(s);n.rem.push(a[u]),a[u]=null}),t.visit(t.ADD,s=>{const u=o(s,Ue({}));a[ae(s)]=u,n.add.push(u)}),t.visit(t.MOD,s=>{n.mod.push(o(s,a[ae(s)]))}),n}});function xW(e,t,n,i){for(let r=0,o=n.length;r<o;++r)t[i[r]]=n[r](e);return t}function FF(e){R.call(this,null,e)}W(FF,R,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function Nb(e){R.call(this,null,e)}Nb.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const wW=1e-14;W(Nb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;const r=t.materialize(t.SOURCE).source,o=vb(r,e.groupby,e.field),a=(e.groupby||[]).map(yt),s=[],u=e.step||.01,l=e.probs||yi(u/2,1-wW,u),c=l.length;return o.forEach(f=>{const d=Yv(f,l);for(let h=0;h<c;++h){const g={};for(let p=0;p<a.length;++p)g[a[p]]=f.dims[p];g[i[0]]=l[h],g[i[1]]=d[h],s.push(Ue(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}});function MF(e){R.call(this,null,e)}W(MF,R,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,r=>{const o=ae(r);n.rem.push(i[o]),i[o]=null}),t.visit(t.ADD,r=>{const o=Wv(r);i[ae(r)]=o,n.add.push(o)}),t.visit(t.MOD,r=>{const o=i[ae(r)];for(const a in r)o[a]=r[a],n.modifies(a);n.mod.push(o)})),n}});function Rb(e){R.call(this,[],e),this.count=0}Rb.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};W(Rb,R,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),r=e.size,o=this.value.reduce((c,f)=>(c[ae(f)]=1,c),{});let a=this.value,s=this.count,u=0;function l(c){let f,d;a.length<r?a.push(c):(d=~~((s+1)*$i()),d<a.length&&d>=u&&(f=a[d],o[ae(f)]&&n.rem.push(f),a[d]=c)),++s}if(t.rem.length&&(t.visit(t.REM,c=>{const f=ae(c);o[f]&&(o[f]=-1,n.rem.push(c)),--s}),a=a.filter(c=>o[ae(c)]!==-1)),(t.rem.length||i)&&a.length<r&&t.source&&(u=s=a.length,t.visit(t.SOURCE,c=>{o[ae(c)]||l(c)}),u=-1),i&&a.length>r){const c=a.length-r;for(let f=0;f<c;++f)o[ae(a[f])]=-1,n.rem.push(a[f]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,c=>{o[ae(c)]&&n.mod.push(c)}),t.add.length&&t.visit(t.ADD,l),(t.add.length||u<0)&&(n.add=a.filter(c=>!o[ae(c)])),this.count=s,this.value=n.source=a,n}});function jb(e){R.call(this,null,e)}jb.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};W(jb,R,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=yi(e.start,e.stop,e.step||1).map(r=>{const o={};return o[i]=r,Ue(o)}),n.add=t.add.concat(this.value),n}});function DF(e){R.call(this,null,e),this.modified(!0)}W(DF,R,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});function $b(e){R.call(this,null,e)}const NF=["unit0","unit1"];$b.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Ev,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:NF}]};W($b,R,{transform(e,t){const n=e.field,i=e.interval!==!1,r=e.timezone==="utc",o=this._floor(e,t),a=(r?wl:xl)(o.unit).offset,s=e.as||NF,u=s[0],l=s[1],c=o.step;let f=o.start||1/0,d=o.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(fn(n)))&&(t=t.reflow(!0),h=t.SOURCE,f=1/0,d=-1/0),t.visit(h,g=>{const p=n(g);let m,y;p==null?(g[u]=null,i&&(g[l]=null)):(g[u]=m=y=o(p),i&&(g[l]=y=a(m,c)),m<f&&(f=m),y>d&&(d=y))}),o.start=f,o.stop=d,t.modifies(i?s:u)},_floor(e,t){const n=e.timezone==="utc",{units:i,step:r}=e.units?{units:e.units,step:e.step||1}:eT({extent:e.extent||$r(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),o=Sv(i),a=this.value||{},s=(n?qC:UC)(o,r);return s.unit=Fe(o),s.units=o,s.step=r,s.start=a.start,s.stop=a.stop,this.value=s}});function RF(e){R.call(this,gl(),e)}W(RF,R,{transform(e,t){const n=t.dataflow,i=e.field,r=this.value,o=s=>r.set(i(s),s);let a=!0;return e.modified("field")||t.modified(i.fields)?(r.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,s=>r.delete(i(s))),t.visit(t.ADD,o)):a=!1,this.modified(a),r.empty>n.cleanThreshold&&n.runAfter(r.clean),t.fork()}});function jF(e){R.call(this,null,e)}W(jF,R,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort($s(e.sort)):t.source).map(e.field))}});function _W(e,t,n,i){const r=Hf[e](t,n);return{init:r.init||da,update:function(o,a){a[i]=r.next(o)}}}const Hf={row_number:function(){return{next:e=>e.index+1}},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e}}},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e}}},percent_rank:function(){const e=Hf.rank(),t=e.next;return{init:e.init,next:n=>(t(n)-1)/(n.data.length-1)}},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let r=t.index;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){t=+t,t>0||L("ntile num must be greater than zero.");const n=Hf.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(t*i(r))}},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null}}},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,r=n.data;return i<r.length?e(r[i]):null}}},first_value:function(e){return{next:t=>e(t.data[t.i0])}},last_value:function(e){return{next:t=>e(t.data[t.i1-1])}},nth_value:function(e,t){return t=+t,t>0||L("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null}}},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return i!=null?t=i:t}}},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const r=i.data;return i.index<=n?t:(n=EW(e,r,i.index))<0?(n=r.length,t=null):t=e(r[n])}}}};function EW(e,t,n){for(let i=t.length;n<i;++n)if(e(t[n])!=null)return n;return-1}const OW=Object.keys(Hf);function $F(e){const t=J(e.ops),n=J(e.fields),i=J(e.params),r=J(e.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=[],c=[];let f=!0;function d(h){J(fn(h)).forEach(g=>s[g]=1)}d(e.sort),t.forEach((h,g)=>{const p=n[g],m=yt(p),y=lF(h,m,r[g]);if(d(p),o.push(y),re(Hf,h))a.push(_W(h,n[g],i[g],y));else{if(p==null&&h!=="count"&&L("Null aggregate field specified."),h==="count"){l.push(y);return}f=!1;let v=u[m];v||(v=u[m]=[],v.field=p,c.push(v)),v.push(cF(h,y))}}),(l.length||c.length)&&(this.cell=SW(c,l,f)),this.inputs=Object.keys(s)}const LF=$F.prototype;LF.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init()};LF.update=function(e,t){const n=this.cell,i=this.windows,r=e.data,o=i&&i.length;let a;if(n){for(a=e.p0;a<e.i0;++a)n.rem(r[a]);for(a=e.p1;a<e.i1;++a)n.add(r[a]);n.set(t)}for(a=0;a<o;++a)i[a].update(e,t)};function SW(e,t,n){e=e.map(u=>dF(u,u.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var r=e.length,o=i.agg=Array(r),a=0;a<r;++a)o[a]=new e[a](i);if(i.store)var s=i.data=new db;return i.add=function(u){if(i.num+=1,!n){s&&s.add(u);for(let l=0;l<r;++l)o[l].add(o[l].get(u),u)}},i.rem=function(u){if(i.num-=1,!n){s&&s.rem(u);for(let l=0;l<r;++l)o[l].rem(o[l].get(u),u)}},i.set=function(u){let l,c;for(s&&s.values(),l=0,c=t.length;l<c;++l)u[t[l]]=i.num;if(!n)for(l=0,c=o.length;l<c;++l)o[l].set(u)},i.init=function(){i.num=0,s&&s.reset();for(let u=0;u<r;++u)o[u].init()},i}function Lb(e){R.call(this,{},e),this._mlen=0,this._mods=[]}Lb.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:OW.concat(Wf)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};W(Lb,R,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=$s(e.sort),r=cb(e.groupby),o=s=>this.group(r(s));let a=this.state;(!a||n)&&(a=this.state=new $F(e)),n||t.modified(a.inputs)?(this.value={},t.visit(t.SOURCE,s=>o(s).add(s))):(t.visit(t.REM,s=>o(s).remove(s)),t.visit(t.ADD,s=>o(s).add(s)));for(let s=0,u=this._mlen;s<u;++s)AW(this._mods[s],a,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(a.outputs)},group(e){let t=this.value[e];return t||(t=this.value[e]=hF(ae),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});function AW(e,t,n,i){const r=i.sort,o=r&&!i.ignorePeers,a=i.frame||[null,0],s=e.data(n),u=s.length,l=o?bf(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:r||gn(-1)};t.init();for(let f=0;f<u;++f)kW(c,a,f,u),o&&CW(c,l),t.update(c,s[f])}function kW(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=t[0]==null?0:Math.max(0,n-Math.abs(t[0])),e.i1=t[1]==null?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n}function CW(e,t){const n=e.i0,i=e.i1-1,r=e.compare,o=e.data,a=o.length-1;n>0&&!r(o[n],o[n-1])&&(e.i0=t.left(o,o[n])),i<a&&!r(o[i],o[i+1])&&(e.i1=t.right(o,o[i]))}var TW=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Aa,bin:hb,collect:gb,compare:gF,countpattern:pb,cross:mb,density:yb,dotbin:bb,expression:wF,extent:xb,facet:ep,field:_F,filter:_b,flatten:Eb,fold:Ob,formula:Sb,generate:EF,impute:Ab,joinaggregate:kb,kde:Cb,key:OF,load:SF,lookup:Fb,multiextent:AF,multivalues:kF,params:CF,pivot:Mb,prefacet:TF,project:Db,proxy:FF,quantile:Nb,relay:MF,sample:Rb,sequence:jb,sieve:DF,subflow:wb,timeunit:$b,tupleindex:RF,values:jF,window:Lb});const Ib=Math.PI,Pb=2*Ib,Is=1e-6,FW=Pb-Is;function zb(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ps(){return new zb}zb.prototype=Ps.prototype={constructor:zb,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-e,u=i-t,l=o-e,c=a-t,f=l*l+c*c;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Is)if(!(Math.abs(c*s-u*l)>Is)||!r)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var d=n-o,h=i-a,g=s*s+u*u,p=d*d+h*h,m=Math.sqrt(g),y=Math.sqrt(f),v=r*Math.tan((Ib-Math.acos((g+f-p)/(2*m*y)))/2),x=v/y,b=v/m;Math.abs(x-1)>Is&&(this._+="L"+(e+x*l)+","+(t+x*c)),this._+="A"+r+","+r+",0,0,"+ +(c*d>l*h)+","+(this._x1=e+b*s)+","+(this._y1=t+b*u)}},arc:function(e,t,n,i,r,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(i),s=n*Math.sin(i),u=e+a,l=t+s,c=1^o,f=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>Is||Math.abs(this._y1-l)>Is)&&(this._+="L"+u+","+l),!!n&&(f<0&&(f=f%Pb+Pb),f>FW?this._+="A"+n+","+n+",0,1,"+c+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):f>Is&&(this._+="A"+n+","+n+",0,"+ +(f>=Ib)+","+c+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function We(e){return function(){return e}}var IF=Math.abs,yn=Math.atan2,zs=Math.cos,MW=Math.max,Bb=Math.min,Pr=Math.sin,kl=Math.sqrt,vn=1e-12,Cl=Math.PI,np=Cl/2,PF=2*Cl;function DW(e){return e>1?0:e<-1?Cl:Math.acos(e)}function zF(e){return e>=1?np:e<=-1?-np:Math.asin(e)}function NW(e){return e.innerRadius}function RW(e){return e.outerRadius}function jW(e){return e.startAngle}function $W(e){return e.endAngle}function LW(e){return e&&e.padAngle}function IW(e,t,n,i,r,o,a,s){var u=n-e,l=i-t,c=a-r,f=s-o,d=f*u-c*l;if(!(d*d<vn))return d=(c*(t-o)-f*(e-r))/d,[e+d*u,t+d*l]}function ip(e,t,n,i,r,o,a){var s=e-n,u=t-i,l=(a?o:-o)/kl(s*s+u*u),c=l*u,f=-l*s,d=e+c,h=t+f,g=n+c,p=i+f,m=(d+g)/2,y=(h+p)/2,v=g-d,x=p-h,b=v*v+x*x,_=r-o,E=d*p-g*h,w=(x<0?-1:1)*kl(MW(0,_*_*b-E*E)),O=(E*x-v*w)/b,S=(-E*v-x*w)/b,k=(E*x+v*w)/b,A=(-E*v+x*w)/b,M=O-m,C=S-y,D=k-m,F=A-y;return M*M+C*C>D*D+F*F&&(O=k,S=A),{cx:O,cy:S,x01:-c,y01:-f,x11:O*(r/_-1),y11:S*(r/_-1)}}function PW(){var e=NW,t=RW,n=We(0),i=null,r=jW,o=$W,a=LW,s=null;function u(){var l,c,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=r.apply(this,arguments)-np,g=o.apply(this,arguments)-np,p=IF(g-h),m=g>h;if(s||(s=l=Ps()),d<f&&(c=d,d=f,f=c),!(d>vn))s.moveTo(0,0);else if(p>PF-vn)s.moveTo(d*zs(h),d*Pr(h)),s.arc(0,0,d,h,g,!m),f>vn&&(s.moveTo(f*zs(g),f*Pr(g)),s.arc(0,0,f,g,h,m));else{var y=h,v=g,x=h,b=g,_=p,E=p,w=a.apply(this,arguments)/2,O=w>vn&&(i?+i.apply(this,arguments):kl(f*f+d*d)),S=Bb(IF(d-f)/2,+n.apply(this,arguments)),k=S,A=S,M,C;if(O>vn){var D=zF(O/f*Pr(w)),F=zF(O/d*Pr(w));(_-=D*2)>vn?(D*=m?1:-1,x+=D,b-=D):(_=0,x=b=(h+g)/2),(E-=F*2)>vn?(F*=m?1:-1,y+=F,v-=F):(E=0,y=v=(h+g)/2)}var N=d*zs(y),I=d*Pr(y),z=f*zs(b),X=f*Pr(b);if(S>vn){var te=d*zs(v),xe=d*Pr(v),ge=f*zs(x),je=f*Pr(x),Oe;if(p<Cl&&(Oe=IW(N,I,ge,je,te,xe,z,X))){var ke=N-Oe[0],Xe=I-Oe[1],xt=te-Oe[0],Ge=xe-Oe[1],Y=1/Pr(DW((ke*xt+Xe*Ge)/(kl(ke*ke+Xe*Xe)*kl(xt*xt+Ge*Ge)))/2),ne=kl(Oe[0]*Oe[0]+Oe[1]*Oe[1]);k=Bb(S,(f-ne)/(Y-1)),A=Bb(S,(d-ne)/(Y+1))}}E>vn?A>vn?(M=ip(ge,je,N,I,d,A,m),C=ip(te,xe,z,X,d,A,m),s.moveTo(M.cx+M.x01,M.cy+M.y01),A<S?s.arc(M.cx,M.cy,A,yn(M.y01,M.x01),yn(C.y01,C.x01),!m):(s.arc(M.cx,M.cy,A,yn(M.y01,M.x01),yn(M.y11,M.x11),!m),s.arc(0,0,d,yn(M.cy+M.y11,M.cx+M.x11),yn(C.cy+C.y11,C.cx+C.x11),!m),s.arc(C.cx,C.cy,A,yn(C.y11,C.x11),yn(C.y01,C.x01),!m))):(s.moveTo(N,I),s.arc(0,0,d,y,v,!m)):s.moveTo(N,I),!(f>vn)||!(_>vn)?s.lineTo(z,X):k>vn?(M=ip(z,X,te,xe,f,-k,m),C=ip(N,I,ge,je,f,-k,m),s.lineTo(M.cx+M.x01,M.cy+M.y01),k<S?s.arc(M.cx,M.cy,k,yn(M.y01,M.x01),yn(C.y01,C.x01),!m):(s.arc(M.cx,M.cy,k,yn(M.y01,M.x01),yn(M.y11,M.x11),!m),s.arc(0,0,f,yn(M.cy+M.y11,M.cx+M.x11),yn(C.cy+C.y11,C.cx+C.x11),m),s.arc(C.cx,C.cy,k,yn(C.y11,C.x11),yn(C.y01,C.x01),!m))):s.arc(0,0,f,b,x,m)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,c=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Cl/2;return[zs(c)*l,Pr(c)*l]},u.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:We(+l),u):e},u.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:We(+l),u):t},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:We(+l),u):n},u.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:We(+l),u):i},u.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:We(+l),u):r},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:We(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:We(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}function BF(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function UF(e){this._context=e}UF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ub(e){return new UF(e)}function qF(e){return e[0]}function WF(e){return e[1]}function HF(e,t){var n=We(!0),i=null,r=Ub,o=null;e=typeof e=="function"?e:e===void 0?qF:We(e),t=typeof t=="function"?t:t===void 0?WF:We(t);function a(s){var u,l=(s=BF(s)).length,c,f=!1,d;for(i==null&&(o=r(d=Ps())),u=0;u<=l;++u)!(u<l&&n(c=s[u],u,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(c,u,s),+t(c,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(e=typeof s=="function"?s:We(+s),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:We(+s),a):t},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:We(!!s),a):n},a.curve=function(s){return arguments.length?(r=s,i!=null&&(o=r(i)),a):r},a.context=function(s){return arguments.length?(s==null?i=o=null:o=r(i=s),a):i},a}function GF(e,t,n){var i=null,r=We(!0),o=null,a=Ub,s=null;e=typeof e=="function"?e:e===void 0?qF:We(+e),t=typeof t=="function"?t:We(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?WF:We(+n);function u(c){var f,d,h,g=(c=BF(c)).length,p,m=!1,y,v=new Array(g),x=new Array(g);for(o==null&&(s=a(y=Ps())),f=0;f<=g;++f){if(!(f<g&&r(p=c[f],f,c))===m)if(m=!m)d=f,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=f-1;h>=d;--h)s.point(v[h],x[h]);s.lineEnd(),s.areaEnd()}m&&(v[f]=+e(p,f,c),x[f]=+t(p,f,c),s.point(i?+i(p,f,c):v[f],n?+n(p,f,c):x[f]))}if(y)return s=null,y+""||null}function l(){return HF().defined(r).curve(a).context(o)}return u.x=function(c){return arguments.length?(e=typeof c=="function"?c:We(+c),i=null,u):e},u.x0=function(c){return arguments.length?(e=typeof c=="function"?c:We(+c),u):e},u.x1=function(c){return arguments.length?(i=c==null?null:typeof c=="function"?c:We(+c),u):i},u.y=function(c){return arguments.length?(t=typeof c=="function"?c:We(+c),n=null,u):t},u.y0=function(c){return arguments.length?(t=typeof c=="function"?c:We(+c),u):t},u.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:We(+c),u):n},u.lineX0=u.lineY0=function(){return l().x(e).y(t)},u.lineY1=function(){return l().x(e).y(n)},u.lineX1=function(){return l().x(i).y(t)},u.defined=function(c){return arguments.length?(r=typeof c=="function"?c:We(!!c),u):r},u.curve=function(c){return arguments.length?(a=c,o!=null&&(s=a(o)),u):a},u.context=function(c){return arguments.length?(c==null?o=s=null:s=a(o=c),u):o},u}var zW={draw:function(e,t){var n=Math.sqrt(t/Cl);e.moveTo(n,0),e.arc(0,0,n,0,PF)}};function BW(e,t){var n=null;e=typeof e=="function"?e:We(e||zW),t=typeof t=="function"?t:We(t===void 0?64:+t);function i(){var r;if(n||(n=r=Ps()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(e=typeof r=="function"?r:We(r),i):e},i.size=function(r){return arguments.length?(t=typeof r=="function"?r:We(+r),i):t},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function ka(){}function rp(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function op(e){this._context=e}op.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function UW(e){return new op(e)}function VF(e){this._context=e}VF.prototype={areaStart:ka,areaEnd:ka,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function qW(e){return new VF(e)}function YF(e){this._context=e}YF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:rp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function WW(e){return new YF(e)}function XF(e,t){this._basis=new op(e),this._beta=t}XF.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var i=e[0],r=t[0],o=e[n]-i,a=t[n]-r,s=-1,u;++s<=n;)u=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(i+u*o),this._beta*t[s]+(1-this._beta)*(r+u*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var HW=function e(t){function n(i){return t===1?new op(i):new XF(i,t)}return n.beta=function(i){return e(+i)},n}(.85);function ap(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function qb(e,t){this._context=e,this._k=(1-t)/6}qb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ap(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:ap(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var GW=function e(t){function n(i){return new qb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Wb(e,t){this._context=e,this._k=(1-t)/6}Wb.prototype={areaStart:ka,areaEnd:ka,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:ap(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var VW=function e(t){function n(i){return new Wb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Hb(e,t){this._context=e,this._k=(1-t)/6}Hb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ap(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var YW=function e(t){function n(i){return new Hb(i,t)}return n.tension=function(i){return e(+i)},n}(0);function Gb(e,t,n){var i=e._x1,r=e._y1,o=e._x2,a=e._y2;if(e._l01_a>vn){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,r=(r*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>vn){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,c=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/c,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/c}e._context.bezierCurveTo(i,r,o,a,e._x2,e._y2)}function KF(e,t){this._context=e,this._alpha=t}KF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Gb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var XW=function e(t){function n(i){return t?new KF(i,t):new qb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function JF(e,t){this._context=e,this._alpha=t}JF.prototype={areaStart:ka,areaEnd:ka,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Gb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var KW=function e(t){function n(i){return t?new JF(i,t):new Wb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function QF(e,t){this._context=e,this._alpha=t}QF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Gb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var JW=function e(t){function n(i){return t?new QF(i,t):new Hb(i,0)}return n.alpha=function(i){return e(+i)},n}(.5);function ZF(e){this._context=e}ZF.prototype={areaStart:ka,areaEnd:ka,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function QW(e){return new ZF(e)}function eM(e){return e<0?-1:1}function tM(e,t,n){var i=e._x1-e._x0,r=t-e._x1,o=(e._y1-e._y0)/(i||r<0&&-0),a=(n-e._y1)/(r||i<0&&-0),s=(o*r+a*i)/(i+r);return(eM(o)+eM(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function nM(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Vb(e,t,n){var i=e._x0,r=e._y0,o=e._x1,a=e._y1,s=(o-i)/3;e._context.bezierCurveTo(i+s,r+s*t,o-s,a-s*n,o,a)}function sp(e){this._context=e}sp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vb(this,this._t0,nM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Vb(this,nM(this,n=tM(this,e,t)),n);break;default:Vb(this,this._t0,n=tM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function iM(e){this._context=new rM(e)}(iM.prototype=Object.create(sp.prototype)).point=function(e,t){sp.prototype.point.call(this,t,e)};function rM(e){this._context=e}rM.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,r,o){this._context.bezierCurveTo(t,e,i,n,o,r)}};function ZW(e){return new sp(e)}function eH(e){return new iM(e)}function oM(e){this._context=e}oM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=aM(e),r=aM(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function aM(e){var t,n=e.length-1,i,r=new Array(n),o=new Array(n),a=new Array(n);for(r[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)r[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(r[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=r[t]/o[t-1],o[t]-=i,a[t]-=i*a[t-1];for(r[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)r[t]=(a[t]-r[t+1])/o[t];for(o[n-1]=(e[n]+r[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-r[t+1];return[r,o]}function tH(e){return new oM(e)}function up(e,t){this._context=e,this._t=t}up.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function nH(e){return new up(e,.5)}function iH(e){return new up(e,0)}function rH(e){return new up(e,1)}function Tl(e,t){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}const oH=()=>typeof Image!="undefined"?Image:null;function zr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ca(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Yb=Symbol("implicit");function Xb(){var e=new Map,t=[],n=[],i=Yb;function r(o){var a=o+"",s=e.get(a);if(!s){if(i!==Yb)return i;e.set(a,s=t.push(o))}return n[(s-1)%n.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new Map;for(const a of o){const s=a+"";e.has(s)||e.set(s,t.push(a))}return r},r.range=function(o){return arguments.length?(n=Array.from(o),r):n.slice()},r.unknown=function(o){return arguments.length?(i=o,r):i},r.copy=function(){return Xb(t,n).unknown(i)},zr.apply(r,arguments),r}function Fl(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Gf(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Ta(){}var Bs=.7,Ml=1/Bs,Dl="\\s*([+-]?\\d+)\\s*",Vf="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Br="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aH=/^#([0-9a-f]{3,8})$/,sH=new RegExp("^rgb\\("+[Dl,Dl,Dl]+"\\)$"),uH=new RegExp("^rgb\\("+[Br,Br,Br]+"\\)$"),lH=new RegExp("^rgba\\("+[Dl,Dl,Dl,Vf]+"\\)$"),cH=new RegExp("^rgba\\("+[Br,Br,Br,Vf]+"\\)$"),fH=new RegExp("^hsl\\("+[Vf,Br,Br]+"\\)$"),dH=new RegExp("^hsla\\("+[Vf,Br,Br,Vf]+"\\)$"),sM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fl(Ta,Yf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:uM,formatHex:uM,formatHsl:hH,formatRgb:lM,toString:lM});function uM(){return this.rgb().formatHex()}function hH(){return gM(this).formatHsl()}function lM(){return this.rgb().formatRgb()}function Yf(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=aH.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?cM(t):n===3?new Zt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?lp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?lp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sH.exec(e))?new Zt(t[1],t[2],t[3],1):(t=uH.exec(e))?new Zt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=lH.exec(e))?lp(t[1],t[2],t[3],t[4]):(t=cH.exec(e))?lp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=fH.exec(e))?hM(t[1],t[2]/100,t[3]/100,1):(t=dH.exec(e))?hM(t[1],t[2]/100,t[3]/100,t[4]):sM.hasOwnProperty(e)?cM(sM[e]):e==="transparent"?new Zt(NaN,NaN,NaN,0):null}function cM(e){return new Zt(e>>16&255,e>>8&255,e&255,1)}function lp(e,t,n,i){return i<=0&&(e=t=n=NaN),new Zt(e,t,n,i)}function Kb(e){return e instanceof Ta||(e=Yf(e)),e?(e=e.rgb(),new Zt(e.r,e.g,e.b,e.opacity)):new Zt}function Fa(e,t,n,i){return arguments.length===1?Kb(e):new Zt(e,t,n,i==null?1:i)}function Zt(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Fl(Zt,Fa,Gf(Ta,{brighter:function(e){return e=e==null?Ml:Math.pow(Ml,e),new Zt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Bs:Math.pow(Bs,e),new Zt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fM,formatHex:fM,formatRgb:dM,toString:dM}));function fM(){return"#"+Jb(this.r)+Jb(this.g)+Jb(this.b)}function dM(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Jb(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function hM(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ur(e,t,n,i)}function gM(e){if(e instanceof Ur)return new Ur(e.h,e.s,e.l,e.opacity);if(e instanceof Ta||(e=Yf(e)),!e)return new Ur;if(e instanceof Ur)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),a=NaN,s=o-r,u=(o+r)/2;return s?(t===o?a=(n-i)/s+(n<i)*6:n===o?a=(i-t)/s+2:a=(t-n)/s+4,s/=u<.5?o+r:2-o-r,a*=60):s=u>0&&u<1?0:a,new Ur(a,s,u,e.opacity)}function cp(e,t,n,i){return arguments.length===1?gM(e):new Ur(e,t,n,i==null?1:i)}function Ur(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Fl(Ur,cp,Gf(Ta,{brighter:function(e){return e=e==null?Ml:Math.pow(Ml,e),new Ur(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Bs:Math.pow(Bs,e),new Ur(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Zt(Qb(e>=240?e-240:e+120,r,i),Qb(e,r,i),Qb(e<120?e+240:e-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Qb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const pM=Math.PI/180,mM=180/Math.PI,fp=18,yM=.96422,vM=1,bM=.82521,xM=4/29,Nl=6/29,wM=3*Nl*Nl,gH=Nl*Nl*Nl;function _M(e){if(e instanceof qr)return new qr(e.l,e.a,e.b,e.opacity);if(e instanceof Do)return EM(e);e instanceof Zt||(e=Kb(e));var t=nx(e.r),n=nx(e.g),i=nx(e.b),r=Zb((.2225045*t+.7168786*n+.0606169*i)/vM),o,a;return t===n&&n===i?o=a=r:(o=Zb((.4360747*t+.3850649*n+.1430804*i)/yM),a=Zb((.0139322*t+.0971045*n+.7141733*i)/bM)),new qr(116*r-16,500*(o-r),200*(r-a),e.opacity)}function dp(e,t,n,i){return arguments.length===1?_M(e):new qr(e,t,n,i==null?1:i)}function qr(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}Fl(qr,dp,Gf(Ta,{brighter:function(e){return new qr(this.l+fp*(e==null?1:e),this.a,this.b,this.opacity)},darker:function(e){return new qr(this.l-fp*(e==null?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=yM*ex(t),e=vM*ex(e),n=bM*ex(n),new Zt(tx(3.1338561*t-1.6168667*e-.4906146*n),tx(-.9787684*t+1.9161415*e+.033454*n),tx(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Zb(e){return e>gH?Math.pow(e,1/3):e/wM+xM}function ex(e){return e>Nl?e*e*e:wM*(e-xM)}function tx(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function nx(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function pH(e){if(e instanceof Do)return new Do(e.h,e.c,e.l,e.opacity);if(e instanceof qr||(e=_M(e)),e.a===0&&e.b===0)return new Do(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*mM;return new Do(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hp(e,t,n,i){return arguments.length===1?pH(e):new Do(e,t,n,i==null?1:i)}function Do(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function EM(e){if(isNaN(e.h))return new qr(e.l,0,0,e.opacity);var t=e.h*pM;return new qr(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Fl(Do,hp,Gf(Ta,{brighter:function(e){return new Do(this.h,this.c,this.l+fp*(e==null?1:e),this.opacity)},darker:function(e){return new Do(this.h,this.c,this.l-fp*(e==null?1:e),this.opacity)},rgb:function(){return EM(this).rgb()}}));var OM=-.14861,ix=1.78277,rx=-.29227,gp=-.90649,Xf=1.97294,SM=Xf*gp,AM=Xf*ix,kM=ix*rx-gp*OM;function mH(e){if(e instanceof Us)return new Us(e.h,e.s,e.l,e.opacity);e instanceof Zt||(e=Kb(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(kM*i+SM*t-AM*n)/(kM+SM-AM),o=i-r,a=(Xf*(n-r)-rx*o)/gp,s=Math.sqrt(a*a+o*o)/(Xf*r*(1-r)),u=s?Math.atan2(a,o)*mM-120:NaN;return new Us(u<0?u+360:u,s,r,e.opacity)}function ox(e,t,n,i){return arguments.length===1?mH(e):new Us(e,t,n,i==null?1:i)}function Us(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Fl(Us,ox,Gf(Ta,{brighter:function(e){return e=e==null?Ml:Math.pow(Ml,e),new Us(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Bs:Math.pow(Bs,e),new Us(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*pM,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new Zt(255*(t+n*(OM*i+ix*r)),255*(t+n*(rx*i+gp*r)),255*(t+n*(Xf*i)),this.opacity)}}));function CM(e,t,n,i,r){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*n+(1+3*e+3*o-3*a)*i+a*r)/6}function TM(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],a=i>0?e[i-1]:2*r-o,s=i<t-1?e[i+2]:2*o-r;return CM((n-i/t)*t,a,r,o,s)}}function FM(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],a=e[(i+1)%t],s=e[(i+2)%t];return CM((n-i/t)*t,r,o,a,s)}}var pp=e=>()=>e;function MM(e,t){return function(n){return e+n*t}}function yH(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function mp(e,t){var n=t-e;return n?MM(e,n>180||n<-180?n-360*Math.round(n/360):n):pp(isNaN(e)?t:e)}function vH(e){return(e=+e)==1?zt:function(t,n){return n-t?yH(t,n,e):pp(isNaN(t)?n:t)}}function zt(e,t){var n=t-e;return n?MM(e,n):pp(isNaN(e)?t:e)}var ax=function e(t){var n=vH(t);function i(r,o){var a=n((r=Fa(r)).r,(o=Fa(o)).r),s=n(r.g,o.g),u=n(r.b,o.b),l=zt(r.opacity,o.opacity);return function(c){return r.r=a(c),r.g=s(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=e,i}(1);function DM(e){return function(t){var n=t.length,i=new Array(n),r=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Fa(t[a]),i[a]=s.r||0,r[a]=s.g||0,o[a]=s.b||0;return i=e(i),r=e(r),o=e(o),s.opacity=1,function(u){return s.r=i(u),s.g=r(u),s.b=o(u),s+""}}}var bH=DM(TM),xH=DM(FM);function sx(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=e[r]*(1-o)+t[r]*o;return i}}function NM(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function wH(e,t){return(NM(t)?sx:RM)(e,t)}function RM(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n),a;for(a=0;a<i;++a)r[a]=Ma(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(s){for(a=0;a<i;++a)o[a]=r[a](s);return o}}function jM(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function rr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $M(e,t){var n={},i={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Ma(e[r],t[r]):i[r]=t[r];return function(o){for(r in n)i[r]=n[r](o);return i}}var ux=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lx=new RegExp(ux.source,"g");function _H(e){return function(){return e}}function EH(e){return function(t){return e(t)+""}}function LM(e,t){var n=ux.lastIndex=lx.lastIndex=0,i,r,o,a=-1,s=[],u=[];for(e=e+"",t=t+"";(i=ux.exec(e))&&(r=lx.exec(t));)(o=r.index)>n&&(o=t.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(i=i[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:rr(i,r)})),n=lx.lastIndex;return n<t.length&&(o=t.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?EH(u[0].x):_H(t):(t=u.length,function(l){for(var c=0,f;c<t;++c)s[(f=u[c]).i]=f.x(l);return s.join("")})}function Ma(e,t){var n=typeof t,i;return t==null||n==="boolean"?pp(t):(n==="number"?rr:n==="string"?(i=Yf(t))?(t=i,ax):LM:t instanceof Yf?ax:t instanceof Date?jM:NM(t)?sx:Array.isArray(t)?RM:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$M:rr)(e,t)}function OH(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function SH(e,t){var n=mp(+e,+t);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function Kf(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var IM=180/Math.PI,cx={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function PM(e,t,n,i,r,o){var a,s,u;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(u=e*n+t*i)&&(n-=e*u,i-=t*u),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,u/=s),e*i<t*n&&(e=-e,t=-t,u=-u,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*IM,skewX:Math.atan(u)*IM,scaleX:a,scaleY:s}}var yp;function AH(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?cx:PM(t.a,t.b,t.c,t.d,t.e,t.f)}function kH(e){return e==null||(yp||(yp=document.createElementNS("http://www.w3.org/2000/svg","g")),yp.setAttribute("transform",e),!(e=yp.transform.baseVal.consolidate()))?cx:(e=e.matrix,PM(e.a,e.b,e.c,e.d,e.e,e.f))}function zM(e,t,n,i){function r(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push("translate(",null,t,null,n);g.push({i:p-4,x:rr(l,f)},{i:p-2,x:rr(c,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:rr(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function s(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:rr(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,h,g){if(l!==f||c!==d){var p=h.push(r(h)+"scale(",null,",",null,")");g.push({i:p-4,x:rr(l,f)},{i:p-2,x:rr(c,d)})}else(f!==1||d!==1)&&h.push(r(h)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=e(l),c=e(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),a(l.rotate,c.rotate,f,d),s(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(h){for(var g=-1,p=d.length,m;++g<p;)f[(m=d[g]).i]=m.x(h);return f.join("")}}}var CH=zM(AH,"px, ","px)","deg)"),TH=zM(kH,", ",")",")"),FH=1e-12;function BM(e){return((e=Math.exp(e))+1/e)/2}function MH(e){return((e=Math.exp(e))-1/e)/2}function DH(e){return((e=Math.exp(2*e))-1)/(e+1)}var NH=function e(t,n,i){function r(o,a){var s=o[0],u=o[1],l=o[2],c=a[0],f=a[1],d=a[2],h=c-s,g=f-u,p=h*h+g*g,m,y;if(p<FH)y=Math.log(d/l)/t,m=function(w){return[s+w*h,u+w*g,l*Math.exp(t*w*y)]};else{var v=Math.sqrt(p),x=(d*d-l*l+i*p)/(2*l*n*v),b=(d*d-l*l-i*p)/(2*d*n*v),_=Math.log(Math.sqrt(x*x+1)-x),E=Math.log(Math.sqrt(b*b+1)-b);y=(E-_)/t,m=function(w){var O=w*y,S=BM(_),k=l/(n*v)*(S*DH(t*O+_)-MH(_));return[s+k*h,u+k*g,l*S/BM(t*O+_)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return r.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return e(a,s,u)},r}(Math.SQRT2,2,4);function UM(e){return function(t,n){var i=e((t=cp(t)).h,(n=cp(n)).h),r=zt(t.s,n.s),o=zt(t.l,n.l),a=zt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.s=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var RH=UM(mp),jH=UM(zt);function $H(e,t){var n=zt((e=dp(e)).l,(t=dp(t)).l),i=zt(e.a,t.a),r=zt(e.b,t.b),o=zt(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=i(a),e.b=r(a),e.opacity=o(a),e+""}}function qM(e){return function(t,n){var i=e((t=hp(t)).h,(n=hp(n)).h),r=zt(t.c,n.c),o=zt(t.l,n.l),a=zt(t.opacity,n.opacity);return function(s){return t.h=i(s),t.c=r(s),t.l=o(s),t.opacity=a(s),t+""}}}var LH=qM(mp),IH=qM(zt);function WM(e){return function t(n){n=+n;function i(r,o){var a=e((r=ox(r)).h,(o=ox(o)).h),s=zt(r.s,o.s),u=zt(r.l,o.l),l=zt(r.opacity,o.opacity);return function(c){return r.h=a(c),r.s=s(c),r.l=u(Math.pow(c,n)),r.opacity=l(c),r+""}}return i.gamma=t,i}(1)}var PH=WM(mp),zH=WM(zt);function fx(e,t){t===void 0&&(t=e,e=Ma);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(a){var s=Math.max(0,Math.min(i-1,Math.floor(a*=i)));return o[s](a-s)}}function BH(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}var UH=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:Ma,interpolateArray:wH,interpolateBasis:TM,interpolateBasisClosed:FM,interpolateDate:jM,interpolateDiscrete:OH,interpolateHue:SH,interpolateNumber:rr,interpolateNumberArray:sx,interpolateObject:$M,interpolateRound:Kf,interpolateString:LM,interpolateTransformCss:CH,interpolateTransformSvg:TH,interpolateZoom:NH,interpolateRgb:ax,interpolateRgbBasis:bH,interpolateRgbBasisClosed:xH,interpolateHsl:RH,interpolateHslLong:jH,interpolateLab:$H,interpolateHcl:LH,interpolateHclLong:IH,interpolateCubehelix:PH,interpolateCubehelixLong:zH,piecewise:fx,quantize:BH});function qH(e){return function(){return e}}function dx(e){return+e}var HM=[0,1];function Qn(e){return e}function hx(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:qH(isNaN(t)?NaN:.5)}function WH(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function HH(e,t,n){var i=e[0],r=e[1],o=t[0],a=t[1];return r<i?(i=hx(r,i),o=n(a,o)):(i=hx(i,r),o=n(o,a)),function(s){return o(i(s))}}function GH(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)r[a]=hx(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(s){var u=xf(e,s,1,i)-1;return o[u](r[u](s))}}function Jf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function vp(){var e=HM,t=HM,n=Ma,i,r,o,a=Qn,s,u,l;function c(){var d=Math.min(e.length,t.length);return a!==Qn&&(a=WH(e[0],e[d-1])),s=d>2?GH:HH,u=l=null,f}function f(d){return d==null||isNaN(d=+d)?o:(u||(u=s(e.map(i),t,n)))(i(a(d)))}return f.invert=function(d){return a(r((l||(l=s(t,e.map(i),rr)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,dx),c()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),c()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Kf,c()},f.clamp=function(d){return arguments.length?(a=d?!0:Qn,c()):a!==Qn},f.interpolate=function(d){return arguments.length?(n=d,c()):n},f.unknown=function(d){return arguments.length?(o=d,f):o},function(d,h){return i=d,r=h,c()}}function GM(){return vp()(Qn,Qn)}function VM(e,t,n,i){var r=ya(e,t,n),o;switch(i=vl(i==null?",f":i),i.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(o=CC(r,a))&&(i.precision=o),cv(i,a)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(o=TC(r,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=o-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(o=kC(r))&&(i.precision=o-(i.type==="%")*2);break}}return Dg(i)}function qs(e){var t=e.domain;return e.ticks=function(n){var i=t();return av(i[0],i[i.length-1],n==null?10:n)},e.tickFormat=function(n,i){var r=t();return VM(r[0],r[r.length-1],n==null?10:n,i)},e.nice=function(n){n==null&&(n=10);var i=t(),r=0,o=i.length-1,a=i[r],s=i[o],u,l,c=10;for(s<a&&(l=a,a=s,s=l,l=r,r=o,o=l);c-- >0;){if(l=gC(a,s,n),l===u)return i[r]=a,i[o]=s,t(i);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return e},e}function YM(){var e=GM();return e.copy=function(){return Jf(e,YM())},zr.apply(e,arguments),qs(e)}function XM(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,dx),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return XM(e).unknown(t)},e=arguments.length?Array.from(e,dx):[0,1],qs(n)}function KM(e,t){e=e.slice();var n=0,i=e.length-1,r=e[n],o=e[i],a;return o<r&&(a=n,n=i,i=a,a=r,r=o,o=a),e[n]=t.floor(r),e[i]=t.ceil(o),e}function JM(e){return Math.log(e)}function QM(e){return Math.exp(e)}function VH(e){return-Math.log(-e)}function YH(e){return-Math.exp(-e)}function XH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KH(e){return e===10?XH:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function JH(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function ZM(e){return function(t){return-e(-t)}}function gx(e){var t=e(JM,QM),n=t.domain,i=10,r,o;function a(){return r=JH(i),o=KH(i),n()[0]<0?(r=ZM(r),o=ZM(o),e(VH,YH)):e(JM,QM),t}return t.base=function(s){return arguments.length?(i=+s,a()):i},t.domain=function(s){return arguments.length?(n(s),a()):n()},t.ticks=function(s){var u=n(),l=u[0],c=u[u.length-1],f;(f=c<l)&&(d=l,l=c,c=d);var d=r(l),h=r(c),g,p,m,y=s==null?10:+s,v=[];if(!(i%1)&&h-d<y){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1,g=o(d);p<i;++p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}}else for(;d<=h;++d)for(p=i-1,g=o(d);p>=1;--p)if(m=g*p,!(m<l)){if(m>c)break;v.push(m)}v.length*2<y&&(v=av(l,c,y))}else v=av(d,h,Math.min(h-d,y)).map(o);return f?v.reverse():v},t.tickFormat=function(s,u){if(u==null&&(u=i===10?".0e":","),typeof u!="function"&&(u=Dg(u)),s===1/0)return u;s==null&&(s=10);var l=Math.max(1,i*s/t.ticks().length);return function(c){var f=c/o(Math.round(r(c)));return f*i<i-.5&&(f*=i),f<=l?u(c):""}},t.nice=function(){return n(KM(n(),{floor:function(s){return o(Math.floor(r(s)))},ceil:function(s){return o(Math.ceil(r(s)))}}))},t}function eD(){var e=gx(vp()).domain([1,10]);return e.copy=function(){return Jf(e,eD()).base(e.base())},zr.apply(e,arguments),e}function tD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function px(e){var t=1,n=e(tD(t),nD(t));return n.constant=function(i){return arguments.length?e(tD(t=+i),nD(t)):t},qs(n)}function iD(){var e=px(vp());return e.copy=function(){return Jf(e,iD()).constant(e.constant())},zr.apply(e,arguments)}function rD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function QH(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ZH(e){return e<0?-e*e:e*e}function mx(e){var t=e(Qn,Qn),n=1;function i(){return n===1?e(Qn,Qn):n===.5?e(QH,ZH):e(rD(n),rD(1/n))}return t.exponent=function(r){return arguments.length?(n=+r,i()):n},qs(t)}function yx(){var e=mx(vp());return e.copy=function(){return Jf(e,yx()).exponent(e.exponent())},zr.apply(e,arguments),e}function eG(){return yx.apply(null,arguments).exponent(.5)}function oD(){var e=[],t=[],n=[],i;function r(){var a=0,s=Math.max(1,t.length);for(n=new Array(s-1);++a<s;)n[a-1]=mC(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?i:t[xf(n,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?n[s-1]:e[0],s<n.length?n[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(ml),r()},o.range=function(a){return arguments.length?(t=Array.from(a),r()):t.slice()},o.unknown=function(a){return arguments.length?(i=a,o):i},o.quantiles=function(){return n.slice()},o.copy=function(){return oD().domain(e).range(t).unknown(i)},zr.apply(o,arguments)}function aD(){var e=0,t=1,n=1,i=[.5],r=[0,1],o;function a(u){return u!=null&&u<=u?r[xf(i,u,0,n)]:o}function s(){var u=-1;for(i=new Array(n);++u<n;)i[u]=((u+1)*t-(u-n)*e)/(n+1);return a}return a.domain=function(u){return arguments.length?([e,t]=u,e=+e,t=+t,s()):[e,t]},a.range=function(u){return arguments.length?(n=(r=Array.from(u)).length-1,s()):r.slice()},a.invertExtent=function(u){var l=r.indexOf(u);return l<0?[NaN,NaN]:l<1?[e,i[0]]:l>=n?[i[n-1],t]:[i[l-1],i[l]]},a.unknown=function(u){return arguments.length&&(o=u),a},a.thresholds=function(){return i.slice()},a.copy=function(){return aD().domain([e,t]).range(r).unknown(o)},zr.apply(qs(a),arguments)}function sD(){var e=[.5],t=[0,1],n,i=1;function r(o){return o!=null&&o<=o?t[xf(e,o,0,i)]:n}return r.domain=function(o){return arguments.length?(e=Array.from(o),i=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(o){return arguments.length?(t=Array.from(o),i=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return sD().domain(e).range(t).unknown(n)},zr.apply(r,arguments)}function tG(e){return new Date(e)}function nG(e){return e instanceof Date?+e:+new Date(+e)}function vx(e,t,n,i,r,o,a,s,u,l){var c=GM(),f=c.invert,d=c.domain,h=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function _(E){return(u(E)<E?h:s(E)<E?g:a(E)<E?p:o(E)<E?m:i(E)<E?r(E)<E?y:v:n(E)<E?x:b)(E)}return c.invert=function(E){return new Date(f(E))},c.domain=function(E){return arguments.length?d(Array.from(E,nG)):d().map(tG)},c.ticks=function(E){var w=d();return e(w[0],w[w.length-1],E==null?10:E)},c.tickFormat=function(E,w){return w==null?_:l(w)},c.nice=function(E){var w=d();return(!E||typeof E.range!="function")&&(E=t(w[0],w[w.length-1],E==null?10:E)),E?d(KM(w,E)):c},c.copy=function(){return Jf(c,vx(e,t,n,i,r,o,a,s,u,l))},c}function iG(){return zr.apply(vx(dB,hB,xa,Ng,_f,ba,vv,yv,va,Rv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function rG(){return zr.apply(vx(cB,fB,_a,Rg,Of,wa,wv,xv,va,jv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bp(){var e=0,t=1,n,i,r,o,a=Qn,s=!1,u;function l(f){return f==null||isNaN(f=+f)?u:a(r===0?.5:(f=(o(f)-n)*r,s?Math.max(0,Math.min(1,f)):f))}l.domain=function(f){return arguments.length?([e,t]=f,n=o(e=+e),i=o(t=+t),r=n===i?0:1/(i-n),l):[e,t]},l.clamp=function(f){return arguments.length?(s=!!f,l):s},l.interpolator=function(f){return arguments.length?(a=f,l):a};function c(f){return function(d){var h,g;return arguments.length?([h,g]=d,a=f(h,g),l):[a(0),a(1)]}}return l.range=c(Ma),l.rangeRound=c(Kf),l.unknown=function(f){return arguments.length?(u=f,l):u},function(f){return o=f,n=f(e),i=f(t),r=n===i?0:1/(i-n),l}}function Da(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function bx(){var e=qs(bp()(Qn));return e.copy=function(){return Da(e,bx())},Ca.apply(e,arguments)}function uD(){var e=gx(bp()).domain([1,10]);return e.copy=function(){return Da(e,uD()).base(e.base())},Ca.apply(e,arguments)}function lD(){var e=px(bp());return e.copy=function(){return Da(e,lD()).constant(e.constant())},Ca.apply(e,arguments)}function xx(){var e=mx(bp());return e.copy=function(){return Da(e,xx()).exponent(e.exponent())},Ca.apply(e,arguments)}function oG(){return xx.apply(null,arguments).exponent(.5)}function xp(){var e=0,t=.5,n=1,i=1,r,o,a,s,u,l=Qn,c,f=!1,d;function h(p){return isNaN(p=+p)?d:(p=.5+((p=+c(p))-o)*(i*p<i*o?s:u),l(f?Math.max(0,Math.min(1,p)):p))}h.domain=function(p){return arguments.length?([e,t,n]=p,r=c(e=+e),o=c(t=+t),a=c(n=+n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h):[e,t,n]},h.clamp=function(p){return arguments.length?(f=!!p,h):f},h.interpolator=function(p){return arguments.length?(l=p,h):l};function g(p){return function(m){var y,v,x;return arguments.length?([y,v,x]=m,l=fx(p,[y,v,x]),h):[l(0),l(.5),l(1)]}}return h.range=g(Ma),h.rangeRound=g(Kf),h.unknown=function(p){return arguments.length?(d=p,h):d},function(p){return c=p,r=p(e),o=p(t),a=p(n),s=r===o?0:.5/(o-r),u=o===a?0:.5/(a-o),i=o<r?-1:1,h}}function cD(){var e=qs(xp()(Qn));return e.copy=function(){return Da(e,cD())},Ca.apply(e,arguments)}function fD(){var e=gx(xp()).domain([.1,1,10]);return e.copy=function(){return Da(e,fD()).base(e.base())},Ca.apply(e,arguments)}function dD(){var e=px(xp());return e.copy=function(){return Da(e,dD()).constant(e.constant())},Ca.apply(e,arguments)}function wx(){var e=mx(xp());return e.copy=function(){return Da(e,wx()).exponent(e.exponent())},Ca.apply(e,arguments)}function aG(){return wx.apply(null,arguments).exponent(.5)}function _x(e,t,n){const i=e-t+n*2;return e?i>0?i:1:0}const sG="identity",Rl="linear",No="log",Qf="pow",Zf="sqrt",wp="symlog",Ws="time",Hs="utc",Wr="sequential",jl="diverging",$l="quantile",_p="quantize",Ep="threshold",Ex="ordinal",Ox="point",hD="band",Sx="bin-ordinal",Dt="continuous",ed="discrete",td="discretizing",Li="interpolating",Ax="temporal";function uG(e){return function(t){let n=t[0],i=t[1],r;return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}function lG(e){return function(t){const n=e.range();let i=t[0],r=t[1],o=-1,a,s,u,l;for(r<i&&(s=i,i=r,r=s),u=0,l=n.length;u<l;++u)n[u]>=i&&n[u]<=r&&(o<0&&(o=u),a=u);if(!(o<0))return i=e.invertExtent(n[o]),r=e.invertExtent(n[a]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function kx(){const e=Xb().unknown(void 0),t=e.domain,n=e.range;let i=[0,1],r,o,a=!1,s=0,u=0,l=.5;delete e.unknown;function c(){const f=t().length,d=i[1]<i[0],h=i[1-d],g=_x(f,s,u);let p=i[d-0];r=(h-p)/(g||1),a&&(r=Math.floor(r)),p+=(h-p-r*(f-s))*l,o=r*(1-s),a&&(p=Math.round(p),o=Math.round(o));const m=yi(f).map(y=>p+r*y);return n(d?m.reverse():m)}return e.domain=function(f){return arguments.length?(t(f),c()):t()},e.range=function(f){return arguments.length?(i=[+f[0],+f[1]],c()):i.slice()},e.rangeRound=function(f){return i=[+f[0],+f[1]],a=!0,c()},e.bandwidth=function(){return o},e.step=function(){return r},e.round=function(f){return arguments.length?(a=!!f,c()):a},e.padding=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),s=u,c()):s},e.paddingInner=function(f){return arguments.length?(s=Math.max(0,Math.min(1,f)),c()):s},e.paddingOuter=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),c()):u},e.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),c()):l},e.invertRange=function(f){if(f[0]==null||f[1]==null)return;const d=i[1]<i[0],h=d?n().reverse():n(),g=h.length-1;let p=+f[0],m=+f[1],y,v,x;if(!(p!==p||m!==m)&&(m<p&&(x=p,p=m,m=x),!(m<h[0]||p>i[1-d])))return y=Math.max(0,Tg(h,p)-1),v=p===m?y:Tg(h,m)-1,p-h[y]>o+1e-10&&++y,d&&(x=y,y=g-v,v=g-x),y>v?void 0:t().slice(y,v+1)},e.invert=function(f){const d=e.invertRange([f,f]);return d&&d[0]},e.copy=function(){return kx().domain(t()).range(i).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}function gD(e){const t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return gD(t())},e}function cG(){return gD(kx().paddingInner(1))}var fG=Array.prototype.map;function dG(e){return fG.call(e,hn)}const hG=Array.prototype.slice;function pD(){let e=[],t=[];function n(i){return i==null||i!==i?void 0:t[(xf(e,i)-1)%t.length]}return n.domain=function(i){return arguments.length?(e=dG(i),n):e.slice()},n.range=function(i){return arguments.length?(t=hG.call(i),n):t.slice()},n.tickFormat=function(i,r){return VM(e[0],Fe(e),i==null?10:i,r)},n.copy=function(){return pD().domain(n.domain()).range(n.range())},n}const Op={};function gG(e,t,n){const i=function(){const o=t();return o.invertRange||(o.invertRange=o.invert?uG(o):o.invertExtent?lG(o):void 0),o.type=e,o};return i.metadata=nr(J(n)),i}function Ie(e,t,n){return arguments.length>1?(Op[e]=gG(e,t,n),this):mD(e)?Op[e]:void 0}Ie(sG,XM);Ie(Rl,YM,Dt);Ie(No,eD,[Dt,No]);Ie(Qf,yx,Dt);Ie(Zf,eG,Dt);Ie(wp,iD,Dt);Ie(Ws,iG,[Dt,Ax]);Ie(Hs,rG,[Dt,Ax]);Ie(Wr,bx,[Dt,Li]);Ie("".concat(Wr,"-").concat(Rl),bx,[Dt,Li]);Ie("".concat(Wr,"-").concat(No),uD,[Dt,Li,No]);Ie("".concat(Wr,"-").concat(Qf),xx,[Dt,Li]);Ie("".concat(Wr,"-").concat(Zf),oG,[Dt,Li]);Ie("".concat(Wr,"-").concat(wp),lD,[Dt,Li]);Ie("".concat(jl,"-").concat(Rl),cD,[Dt,Li]);Ie("".concat(jl,"-").concat(No),fD,[Dt,Li,No]);Ie("".concat(jl,"-").concat(Qf),wx,[Dt,Li]);Ie("".concat(jl,"-").concat(Zf),aG,[Dt,Li]);Ie("".concat(jl,"-").concat(wp),dD,[Dt,Li]);Ie($l,oD,[td,$l]);Ie(_p,aD,td);Ie(Ep,sD,td);Ie(Sx,pD,[ed,td]);Ie(Ex,Xb,ed);Ie(hD,kx,ed);Ie(Ox,cG,ed);function mD(e){return re(Op,e)}function Gs(e,t){const n=Op[e];return n&&n.metadata[t]}function Cx(e){return Gs(e,Dt)}function Ll(e){return Gs(e,ed)}function Tx(e){return Gs(e,td)}function yD(e){return Gs(e,No)}function pG(e){return Gs(e,Ax)}function vD(e){return Gs(e,Li)}function bD(e){return Gs(e,$l)}const mG=["clamp","base","constant","exponent"];function xD(e,t){const n=t[0],i=Fe(t)-n;return function(r){return e(n+r*i)}}function Sp(e,t,n){return fx(Fx(t||"rgb",n),e)}function wD(e,t){const n=new Array(t),i=t+1;for(let r=0;r<t;)n[r]=e(++r/i);return n}function _D(e,t,n){const i=n-t;let r,o,a;return!i||!Number.isFinite(i)?gn(.5):(r=(o=e.type).indexOf("-"),o=r<0?o:o.slice(r+1),a=Ie(o)().domain([t,n]).range([0,1]),mG.forEach(s=>e[s]?a[s](e[s]()):0),a)}function Fx(e,t){const n=UH[yG(e)];return t!=null&&n&&n.gamma?n.gamma(t):n}function yG(e){return"interpolate"+e.toLowerCase().split("-").map(t=>t[0].toUpperCase()+t.slice(1)).join("")}const vG={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},bG={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function ED(e){const t=e.length/6|0,n=new Array(t);for(let i=0;i<t;)n[i]="#"+e.slice(i*6,++i*6);return n}function OD(e,t){for(const n in e)Mx(n,t(e[n]))}const SD={};OD(bG,ED);OD(vG,e=>Sp(ED(e)));function Mx(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(SD[e]=t,this):SD[e]}const Ap="symbol",xG="discrete",wG="gradient",_G=e=>P(e)?e.map(t=>String(t)):String(e),EG=(e,t)=>e[1]-t[1],OG=(e,t)=>t[1]-e[1];function Dx(e,t,n){let i;return Je(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),n!=null&&(t=Math.min(t,Math.floor(yf(e.domain())/n||1)))),Q(t)&&(i=t.step,t=t.interval),K(t)&&(t=e.type===Ws?xl(t):e.type==Hs?wl(t):L("Only time and utc scales accept interval strings."),i&&(t=t.every(i))),t}function AD(e,t,n){let i=e.range(),r=i[0],o=Fe(i),a=EG;if(r>o&&(i=o,o=r,r=i,a=OG),r=Math.floor(r),o=Math.ceil(o),t=t.map(s=>[s,e(s)]).filter(s=>r<=s[1]&&s[1]<=o).sort(a).map(s=>s[0]),n>0&&t.length>1){const s=[t[0],Fe(t)];for(;t.length>n&&t.length>=3;)t=t.filter((u,l)=>!(l%2));t.length<3&&(t=s)}return t}function Nx(e,t){return e.bins?AD(e,e.bins):e.ticks?e.ticks(t):e.domain()}function kD(e,t,n,i,r,o){const a=t.type;let s=_G;if(a===Ws||r===Ws)s=e.timeFormat(i);else if(a===Hs||r===Hs)s=e.utcFormat(i);else if(yD(a)){const u=e.formatFloat(i);if(o||t.bins)s=u;else{const l=CD(t,n,!1);s=c=>l(c)?u(c):""}}else if(t.tickFormat){const u=t.domain();s=e.formatSpan(u[0],u[u.length-1],n,i)}else i&&(s=e.format(i));return s}function CD(e,t,n){const i=Nx(e,t),r=e.base(),o=Math.log(r),a=Math.max(1,r*t/i.length),s=u=>{let l=u/Math.pow(r,Math.round(Math.log(u)/o));return l*r<r-.5&&(l*=r),l<=a};return n?i.filter(s):s}const Rx={[$l]:"quantiles",[_p]:"thresholds",[Ep]:"domain"},TD={[$l]:"quantiles",[_p]:"domain"};function FD(e,t){return e.bins?kG(e.bins):e.type===No?CD(e,t,!0):Rx[e.type]?AG(e[Rx[e.type]]()):Nx(e,t)}function SG(e,t,n){const i=t[TD[t.type]](),r=i.length;let o=r>1?i[1]-i[0]:i[0],a;for(a=1;a<r;++a)o=Math.min(o,i[a]-i[a-1]);return e.formatSpan(0,o,3*10,n)}function AG(e){const t=[-1/0].concat(e);return t.max=1/0,t}function kG(e){const t=e.slice(0,-1);return t.max=Fe(e),t}const CG=e=>Rx[e.type]||e.bins;function MD(e,t,n,i,r,o,a){const s=TD[t.type]&&o!==Ws&&o!==Hs?SG(e,t,r):kD(e,t,n,r,o,a);return i===Ap&&CG(t)?TG(s):i===xG?FG(s):MG(s)}const TG=e=>(t,n,i)=>{const r=DD(i[n+1],DD(i.max,1/0)),o=ND(t,e),a=ND(r,e);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},DD=(e,t)=>e!=null?e:t,FG=e=>(t,n)=>n?e(t):null,MG=e=>t=>e(t),ND=(e,t)=>Number.isFinite(e)?t(e):null;function DG(e){const t=e.domain(),n=t.length-1;let i=+t[0],r=+Fe(t),o=r-i;if(e.type===Ep){const a=n?o/n:.1;i-=a,r+=a,o=r-i}return a=>(a-i)/o}function NG(e,t,n,i){const r=i||t.type;return K(n)&&pG(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Ws?e.timeFormat("%A, %d %B %Y, %X"):!n&&r===Hs?e.utcFormat("%A, %d %B %Y, %X UTC"):MD(e,t,5,null,n,i,!0)}function RD(e,t,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=NG(e,t,n.format,n.formatType);if(Tx(t.type)){const o=FD(t).slice(1).map(r),a=o.length;return"".concat(a," boundar").concat(a===1?"y":"ies",": ").concat(o.join(", "))}else if(Ll(t.type)){const o=t.domain(),a=o.length,s=a>i?o.slice(0,i-2).map(r).join(", ")+", ending with "+o.slice(-1).map(r):o.map(r).join(", ");return"".concat(a," value").concat(a===1?"":"s",": ").concat(s)}else{const o=t.domain();return"values from ".concat(r(o[0])," to ").concat(r(Fe(o)))}}let jD=0;function RG(){jD=0}const kp="p_";function jx(e){return e&&e.gradient}function $D(e,t,n){const i=e.gradient;let r=e.id,o=i==="radial"?kp:"";return r||(r=e.id="gradient_"+jD++,i==="radial"?(e.x1=Hr(e.x1,.5),e.y1=Hr(e.y1,.5),e.r1=Hr(e.r1,0),e.x2=Hr(e.x2,.5),e.y2=Hr(e.y2,.5),e.r2=Hr(e.r2,.5),o=kp):(e.x1=Hr(e.x1,0),e.y1=Hr(e.y1,0),e.x2=Hr(e.x2,1),e.y2=Hr(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+o+r+")"}function Hr(e,t){return e!=null?e:t}function LD(e,t){var n=[],i;return i={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(r,o){return n.push({offset:r,color:o}),i}}}const ID={basis:{curve:UW},"basis-closed":{curve:qW},"basis-open":{curve:WW},bundle:{curve:HW,tension:"beta",value:.85},cardinal:{curve:GW,tension:"tension",value:0},"cardinal-open":{curve:YW,tension:"tension",value:0},"cardinal-closed":{curve:VW,tension:"tension",value:0},"catmull-rom":{curve:XW,tension:"alpha",value:.5},"catmull-rom-closed":{curve:KW,tension:"alpha",value:.5},"catmull-rom-open":{curve:JW,tension:"alpha",value:.5},linear:{curve:Ub},"linear-closed":{curve:QW},monotone:{horizontal:eH,vertical:ZW},natural:{curve:tH},step:{curve:nH},"step-after":{curve:rH},"step-before":{curve:iH}};function $x(e,t,n){var i=re(ID,e)&&ID[e],r=null;return i&&(r=i.curve||i[t||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const jG={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},nd=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Il(e){const t=[];let n,i,r,o,a,s,u,l,c,f;const d=e.slice().replace(nd[0],"###$1").split(nd[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=d[u],i=n.slice(1).trim().replace(nd[2],"$1###$2").replace(nd[3],"$1###$2").split(nd[4]),a=n.charAt(0),r=[a],l=0,f=i.length;l<f;++l)(o=+i[l])===o&&r.push(o);if(s=jG[a.toLowerCase()],r.length-1>s){const h=r.length;for(l=1,t.push([a].concat(r.slice(l,l+=s))),a=a==="M"?"L":a==="m"?"l":a;l<h;l+=s)t.push([a].concat(r.slice(l,l+s)))}else t.push(r)}return t}const Na=Math.PI/180,$G=1e-14,Vs=Math.PI/2,Gr=Math.PI*2,Pl=Math.sqrt(3)/2;var Lx={},Ix={},PD=[].join;function LG(e,t,n,i,r,o,a,s,u){const l=PD.call(arguments);if(Lx[l])return Lx[l];const c=a*Na,f=Math.sin(c),d=Math.cos(c);n=Math.abs(n),i=Math.abs(i);const h=d*(s-e)*.5+f*(u-t)*.5,g=d*(u-t)*.5-f*(s-e)*.5;let p=h*h/(n*n)+g*g/(i*i);p>1&&(p=Math.sqrt(p),n*=p,i*=p);const m=d/n,y=f/n,v=-f/i,x=d/i,b=m*s+y*u,_=v*s+x*u,E=m*e+y*t,w=v*e+x*t,O=(E-b)*(E-b)+(w-_)*(w-_);let S=1/O-.25;S<0&&(S=0);let k=Math.sqrt(S);o==r&&(k=-k);const A=.5*(b+E)-k*(w-_),M=.5*(_+w)+k*(E-b),C=Math.atan2(_-M,b-A);let F=Math.atan2(w-M,E-A)-C;F<0&&o===1?F+=Gr:F>0&&o===0&&(F-=Gr);const N=Math.ceil(Math.abs(F/(Vs+.001))),I=[];for(let z=0;z<N;++z){const X=C+z*F/N,te=C+(z+1)*F/N;I[z]=[A,M,X,te,n,i,f,d]}return Lx[l]=I}function IG(e){const t=PD.call(e);if(Ix[t])return Ix[t];var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7];const c=l*a,f=-u*s,d=u*a,h=l*s,g=Math.cos(r),p=Math.sin(r),m=Math.cos(o),y=Math.sin(o),v=.5*(o-r),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),_=n+g-b*p,E=i+p+b*g,w=n+m,O=i+y,S=w+b*y,k=O-b*m;return Ix[t]=[c*_+f*E,d*_+h*E,c*S+f*k,d*S+h*k,c*w+f*O,d*w+h*O]}const Ii=["l",0,0,0,0,0,0,0];function PG(e,t,n){const i=Ii[0]=e[0];if(i==="a"||i==="A")Ii[1]=t*e[1],Ii[2]=n*e[2],Ii[3]=e[3],Ii[4]=e[4],Ii[5]=e[5],Ii[6]=t*e[6],Ii[7]=n*e[7];else if(i==="h"||i==="H")Ii[1]=t*e[1];else if(i==="v"||i==="V")Ii[1]=n*e[1];else for(var r=1,o=e.length;r<o;++r)Ii[r]=(r%2==1?t:n)*e[r];return Ii}function id(e,t,n,i,r,o){var a,s=null,u=0,l=0,c=0,f=0,d,h,g,p;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),o==null&&(o=r),e.beginPath&&e.beginPath();for(var m=0,y=t.length;m<y;++m){switch(a=t[m],(r!==1||o!==1)&&(a=PG(a,r,o)),a[0]){case"l":u+=a[1],l+=a[2],e.lineTo(u+n,l+i);break;case"L":u=a[1],l=a[2],e.lineTo(u+n,l+i);break;case"h":u+=a[1],e.lineTo(u+n,l+i);break;case"H":u=a[1],e.lineTo(u+n,l+i);break;case"v":l+=a[1],e.lineTo(u+n,l+i);break;case"V":l=a[1],e.lineTo(u+n,l+i);break;case"m":u+=a[1],l+=a[2],e.moveTo(u+n,l+i);break;case"M":u=a[1],l=a[2],e.moveTo(u+n,l+i);break;case"c":d=u+a[5],h=l+a[6],c=u+a[3],f=l+a[4],e.bezierCurveTo(u+a[1]+n,l+a[2]+i,c+n,f+i,d+n,h+i),u=d,l=h;break;case"C":u=a[5],l=a[6],c=a[3],f=a[4],e.bezierCurveTo(a[1]+n,a[2]+i,c+n,f+i,u+n,l+i);break;case"s":d=u+a[3],h=l+a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,u+a[1]+n,l+a[2]+i,d+n,h+i),c=u+a[1],f=l+a[2],u=d,l=h;break;case"S":d=a[3],h=a[4],c=2*u-c,f=2*l-f,e.bezierCurveTo(c+n,f+i,a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"q":d=u+a[3],h=l+a[4],c=u+a[1],f=l+a[2],e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"Q":d=a[3],h=a[4],e.quadraticCurveTo(a[1]+n,a[2]+i,d+n,h+i),u=d,l=h,c=a[1],f=a[2];break;case"t":d=u+a[1],h=l+a[2],s[0].match(/[QqTt]/)===null?(c=u,f=l):s[0]==="t"?(c=2*u-g,f=2*l-p):s[0]==="q"&&(c=2*u-c,f=2*l-f),g=c,p=f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h,c=u+a[1],f=l+a[2];break;case"T":d=a[1],h=a[2],c=2*u-c,f=2*l-f,e.quadraticCurveTo(c+n,f+i,d+n,h+i),u=d,l=h;break;case"a":zD(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+u+n,a[7]+l+i]),u+=a[6],l+=a[7];break;case"A":zD(e,u+n,l+i,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+i]),u=a[6],l=a[7];break;case"z":case"Z":e.closePath();break}s=a}}function zD(e,t,n,i){const r=LG(i[5],i[6],i[0],i[1],i[3],i[4],i[2],t,n);for(let o=0;o<r.length;++o){const a=IG(r[o]);e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}const BD=.5773502691896257,UD={circle:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Gr)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/2.5;e.moveTo(-n,-i),e.lineTo(-n,i),e.lineTo(-i,i),e.lineTo(-i,n),e.lineTo(i,n),e.lineTo(i,i),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(i,-i),e.lineTo(i,-n),e.lineTo(-i,-n),e.lineTo(-i,-i),e.closePath()}},diamond:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),i=-n/2;e.rect(i,i,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,i=n/7,r=n/2.5,o=n/8;e.moveTo(-i,n),e.lineTo(i,n),e.lineTo(i,-o),e.lineTo(r,-o),e.lineTo(0,-n),e.lineTo(-r,-o),e.lineTo(-i,-o),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n,r=i-n*BD,o=n/4;e.moveTo(0,-i-r),e.lineTo(-o,i-r),e.lineTo(o,i-r),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n,r=i-n*BD;e.moveTo(0,-i-r),e.lineTo(-n,i-r),e.lineTo(n,i-r),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n;e.moveTo(0,-i),e.lineTo(-n,i),e.lineTo(n,i),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n;e.moveTo(0,i),e.lineTo(-n,-i),e.lineTo(n,-i),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n;e.moveTo(i,0),e.lineTo(-i,-n),e.lineTo(-i,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,i=Pl*n;e.moveTo(-i,0),e.lineTo(i,-n),e.lineTo(i,n),e.closePath()}},stroke:{draw:function(e,t){const n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function qD(e){return re(UD,e)?UD[e]:zG(e)}var Px={};function zG(e){if(!re(Px,e)){const t=Il(e);Px[e]={draw:function(n,i){id(n,t,0,0,Math.sqrt(i)/2)}}}return Px[e]}const Ra=.448084975506;function BG(e){return e.x}function UG(e){return e.y}function qG(e){return e.width}function WG(e){return e.height}function Ro(e){return typeof e=="function"?e:()=>+e}function Cp(e,t,n){return Math.max(t,Math.min(e,n))}function WD(){var e=BG,t=UG,n=qG,i=WG,r=Ro(0),o=r,a=r,s=r,u=null;function l(c,f,d){var h,g=f!=null?f:+e.call(this,c),p=d!=null?d:+t.call(this,c),m=+n.call(this,c),y=+i.call(this,c),v=Math.min(m,y)/2,x=Cp(+r.call(this,c),0,v),b=Cp(+o.call(this,c),0,v),_=Cp(+a.call(this,c),0,v),E=Cp(+s.call(this,c),0,v);if(u||(u=h=Ps()),x<=0&&b<=0&&_<=0&&E<=0)u.rect(g,p,m,y);else{var w=g+m,O=p+y;u.moveTo(g+x,p),u.lineTo(w-b,p),u.bezierCurveTo(w-Ra*b,p,w,p+Ra*b,w,p+b),u.lineTo(w,O-E),u.bezierCurveTo(w,O-Ra*E,w-Ra*E,O,w-E,O),u.lineTo(g+_,O),u.bezierCurveTo(g+Ra*_,O,g,O-Ra*_,g,O-_),u.lineTo(g,p+x),u.bezierCurveTo(g,p+Ra*x,g+Ra*x,p,g+x,p),u.closePath()}if(h)return u=null,h+""||null}return l.x=function(c){return arguments.length?(e=Ro(c),l):e},l.y=function(c){return arguments.length?(t=Ro(c),l):t},l.width=function(c){return arguments.length?(n=Ro(c),l):n},l.height=function(c){return arguments.length?(i=Ro(c),l):i},l.cornerRadius=function(c,f,d,h){return arguments.length?(r=Ro(c),o=f!=null?Ro(f):r,s=d!=null?Ro(d):r,a=h!=null?Ro(h):o,l):r},l.context=function(c){return arguments.length?(u=c==null?null:c,l):u},l}function HD(){var e,t,n,i,r=null,o,a,s,u;function l(f,d,h){const g=h/2;if(o){var p=s-d,m=f-a;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*u,x=(m/=y)*u,b=Math.atan2(m,p);r.moveTo(a-v,s-x),r.lineTo(f-p*g,d-m*g),r.arc(f,d,g,b-Math.PI,b),r.lineTo(a+v,s+x),r.arc(a,s,u,b,b+Math.PI)}else r.arc(f,d,g,0,Gr);r.closePath()}else o=1;a=f,s=d,u=g}function c(f){var d,h=f.length,g,p=!1,m;for(r==null&&(r=m=Ps()),d=0;d<=h;++d)!(d<h&&i(g=f[d],d,f))===p&&(p=!p)&&(o=0),p&&l(+e(g,d,f),+t(g,d,f),+n(g,d,f));if(m)return r=null,m+""||null}return c.x=function(f){return arguments.length?(e=f,c):e},c.y=function(f){return arguments.length?(t=f,c):t},c.size=function(f){return arguments.length?(n=f,c):n},c.defined=function(f){return arguments.length?(i=f,c):i},c.context=function(f){return arguments.length?(f==null?r=null:r=f,c):r},c}function rd(e,t){return e!=null?e:t}const od=e=>e.x||0,ad=e=>e.y||0,HG=e=>e.width||0,GG=e=>e.height||0,VG=e=>(e.x||0)+(e.width||0),YG=e=>(e.y||0)+(e.height||0),XG=e=>e.startAngle||0,KG=e=>e.endAngle||0,JG=e=>e.padAngle||0,QG=e=>e.innerRadius||0,ZG=e=>e.outerRadius||0,eV=e=>e.cornerRadius||0,tV=e=>rd(e.cornerRadiusTopLeft,e.cornerRadius)||0,nV=e=>rd(e.cornerRadiusTopRight,e.cornerRadius)||0,iV=e=>rd(e.cornerRadiusBottomRight,e.cornerRadius)||0,rV=e=>rd(e.cornerRadiusBottomLeft,e.cornerRadius)||0,oV=e=>rd(e.size,64),aV=e=>e.size||1,Tp=e=>e.defined!==!1,sV=e=>qD(e.shape||"circle"),uV=PW().startAngle(XG).endAngle(KG).padAngle(JG).innerRadius(QG).outerRadius(ZG).cornerRadius(eV),lV=GF().x(od).y1(ad).y0(YG).defined(Tp),cV=GF().y(ad).x1(od).x0(VG).defined(Tp),fV=HF().x(od).y(ad).defined(Tp),dV=WD().x(od).y(ad).width(HG).height(GG).cornerRadius(tV,nV,iV,rV),hV=BW().type(sV).size(oV),gV=HD().x(od).y(ad).defined(Tp).size(aV);function zx(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function pV(e,t){return uV.context(e)(t)}function mV(e,t){const n=t[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?cV:lV).curve($x(i,n.orient,n.tension)).context(e)(t)}function yV(e,t){const n=t[0],i=n.interpolate||"linear";return fV.curve($x(i,n.orient,n.tension)).context(e)(t)}function zl(e,t,n,i){return dV.context(e)(t,n,i)}function vV(e,t){return(t.mark.shape||t.shape).context(e)(t)}function bV(e,t){return hV.context(e)(t)}function xV(e,t){return gV.context(e)(t)}var GD=1;function VD(){GD=1}function Bx(e,t,n){var i=t.clip,r=e._defs,o=t.clip_id||(t.clip_id="clip"+GD++),a=r.clipping[o]||(r.clipping[o]={id:o});return _e(i)?a.path=i(null):zx(n)?a.path=zl(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"}function Nt(e){this.clear(),e&&this.union(e)}Nt.prototype={clone(){return new Nt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set(e,t,n,i){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),i<t?(this.y2=t,this.y1=i):(this.y1=t,this.y2=i),this},add(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate(e,t,n){const i=this.rotatedPoints(e,t,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(e,t,n){var{x1:i,y1:r,x2:o,y2:a}=this,s=Math.cos(e),u=Math.sin(e),l=t-t*s+n*u,c=n-t*u-n*s;return[s*i-u*r+l,u*i+s*r+c,s*i-u*a+l,u*i+s*a+c,s*o-u*r+l,u*o+s*r+c,s*o-u*a+l,u*o+s*a+c]},union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function Fp(e){this.mark=e,this.bounds=this.bounds||new Nt}function Mp(e){Fp.call(this,e),this.items=this.items||[]}W(Mp,Fp);function Ux(e){this._pending=0,this._loader=e||Pg()}function YD(e){e._pending+=1}function sd(e){e._pending-=1}Ux.prototype={pending(){return this._pending},sanitizeURL(e){const t=this;return YD(t),t._loader.sanitize(e,{context:"href"}).then(n=>(sd(t),n)).catch(()=>(sd(t),null))},loadImage(e){const t=this,n=oH();return YD(t),t._loader.sanitize(e,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const o=new n,a=re(i,"crossOrigin")?i.crossOrigin:"anonymous";return a!=null&&(o.crossOrigin=a),o.onload=()=>sd(t),o.onerror=()=>sd(t),o.src=r,o}).catch(i=>(sd(t),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const e=this;return new Promise(t=>{function n(i){e.pending()?setTimeout(()=>{n(!0)},10):t(i)}n(!1)})}};function jo(e,t,n){if(t.stroke&&t.opacity!==0&&t.strokeOpacity!==0){const i=t.strokeWidth!=null?+t.strokeWidth:1;e.expand(i+(n?wV(t,i):0))}return e}function wV(e,t){return e.strokeJoin&&e.strokeJoin!=="miter"?0:t}const _V=Gr-1e-8;let Dp,Np,Rp,Ys,qx,jp,Wx,Hx;const ja=(e,t)=>Dp.add(e,t),$p=(e,t)=>ja(Np=e,Rp=t),XD=e=>ja(e,Dp.y1),KD=e=>ja(Dp.x1,e),Xs=(e,t)=>qx*e+Wx*t,Ks=(e,t)=>jp*e+Hx*t,Gx=(e,t)=>ja(Xs(e,t),Ks(e,t)),Vx=(e,t)=>$p(Xs(e,t),Ks(e,t));function ud(e,t){return Dp=e,t?(Ys=t*Na,qx=Hx=Math.cos(Ys),jp=Math.sin(Ys),Wx=-jp):(qx=Hx=1,Ys=jp=Wx=0),EV}const EV={beginPath(){},closePath(){},moveTo:Vx,lineTo:Vx,rect(e,t,n,i){Ys?(Gx(e+n,t),Gx(e+n,t+i),Gx(e,t+i),Vx(e,t)):(ja(e+n,t+i),$p(e,t))},quadraticCurveTo(e,t,n,i){const r=Xs(e,t),o=Ks(e,t),a=Xs(n,i),s=Ks(n,i);JD(Np,r,a,XD),JD(Rp,o,s,KD),$p(a,s)},bezierCurveTo(e,t,n,i,r,o){const a=Xs(e,t),s=Ks(e,t),u=Xs(n,i),l=Ks(n,i),c=Xs(r,o),f=Ks(r,o);QD(Np,a,u,c,XD),QD(Rp,s,l,f,KD),$p(c,f)},arc(e,t,n,i,r,o){if(i+=Ys,r+=Ys,Np=n*Math.cos(r)+e,Rp=n*Math.sin(r)+t,Math.abs(r-i)>_V)ja(e-n,t-n),ja(e+n,t+n);else{const a=l=>ja(n*Math.cos(l)+e,n*Math.sin(l)+t);let s,u;if(a(i),a(r),r!==i)if(i=i%Gr,i<0&&(i+=Gr),r=r%Gr,r<0&&(r+=Gr),r<i&&(o=!o,s=i,i=r,r=s),o)for(r-=Gr,s=i-i%Vs,u=0;u<4&&s>r;++u,s-=Vs)a(s);else for(s=i-i%Vs+Vs,u=0;u<4&&s<r;++u,s=s+Vs)a(s)}}};function JD(e,t,n,i){const r=(e-t)/(e+n-2*t);0<r&&r<1&&i(e+(t-e)*r)}function QD(e,t,n,i,r){const o=i-e+3*t-3*n,a=e+n-2*t,s=e-t;let u=0,l=0,c;Math.abs(o)>$G?(c=a*a+s*o,c>=0&&(c=Math.sqrt(c),u=(-a+c)/o,l=(-a-c)/o)):u=.5*s/a,0<u&&u<1&&r(ZD(u,e,t,n,i)),0<l&&l<1&&r(ZD(l,e,t,n,i))}function ZD(e,t,n,i,r){const o=1-e,a=o*o,s=e*e;return a*o*t+3*a*e*n+3*o*s*i+s*e*r}var $a=($a=Tl(1,1))?$a.getContext("2d"):null;const Yx=new Nt;function Xx(e){return function(t,n){if(!$a)return!0;e($a,t),Yx.clear().union(t.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:a}=Yx;for(let s=r;s<=a;++s)for(let u=i;u<=o;++u)if($a.isPointInPath(u,s))return!0;return!1}}function Kx(e,t){return t.contains(e.x||0,e.y||0)}function e3(e,t){const n=e.x||0,i=e.y||0,r=e.width||0,o=e.height||0;return t.intersects(Yx.set(n,i,n+r,i+o))}function t3(e,t){const n=e.x||0,i=e.y||0,r=e.x2!=null?e.x2:n,o=e.y2!=null?e.y2:i;return Bl(t,n,i,r,o)}function Bl(e,t,n,i,r){const{x1:o,y1:a,x2:s,y2:u}=e,l=i-t,c=r-n;let f=0,d=1,h,g,p,m;for(m=0;m<4;++m){if(m===0&&(h=-l,g=-(o-t)),m===1&&(h=l,g=s-t),m===2&&(h=-c,g=-(a-n)),m===3&&(h=c,g=u-n),Math.abs(h)<1e-10&&g<0)return!1;if(p=g/h,h<0){if(p>d)return!1;p>f&&(f=p)}else if(h>0){if(p<f)return!1;p<d&&(d=p)}}return!0}function Ul(e,t){e.globalCompositeOperation=t.blend||"source-over"}function or(e,t){return e==null?t:e}function n3(e,t){const n=t.length;for(let i=0;i<n;++i)e.addColorStop(t[i].offset,t[i].color);return e}function OV(e,t,n){const i=n.width(),r=n.height();let o;if(t.gradient==="radial")o=e.createRadialGradient(n.x1+or(t.x1,.5)*i,n.y1+or(t.y1,.5)*r,Math.max(i,r)*or(t.r1,0),n.x1+or(t.x2,.5)*i,n.y1+or(t.y2,.5)*r,Math.max(i,r)*or(t.r2,.5));else{const a=or(t.x1,0),s=or(t.y1,0),u=or(t.x2,1),l=or(t.y2,0);if(a===u||s===l||i===r)o=e.createLinearGradient(n.x1+a*i,n.y1+s*r,n.x1+u*i,n.y1+l*r);else{const c=Tl(Math.ceil(i),Math.ceil(r)),f=c.getContext("2d");return f.scale(i,r),f.fillStyle=n3(f.createLinearGradient(a,s,u,l),t.stops),f.fillRect(0,0,i,r),e.createPattern(c,"no-repeat")}}return n3(o,t.stops)}function i3(e,t,n){return jx(n)?OV(e,n,t.bounds):n}function Lp(e,t,n){return n*=t.fillOpacity==null?1:t.fillOpacity,n>0?(e.globalAlpha=n,e.fillStyle=i3(e,t,t.fill),!0):!1}var SV=[];function ql(e,t,n){var i=(i=t.strokeWidth)!=null?i:1;return i<=0?!1:(n*=t.strokeOpacity==null?1:t.strokeOpacity,n>0?(e.globalAlpha=n,e.strokeStyle=i3(e,t,t.stroke),e.lineWidth=i,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||SV),e.lineDashOffset=t.strokeDashOffset||0),!0):!1)}function AV(e,t){return e.zindex-t.zindex||e.index-t.index}function Jx(e){if(!e.zdirty)return e.zitems;var t=e.items,n=[],i,r,o;for(r=0,o=t.length;r<o;++r)i=t[r],i.index=r,i.zindex&&n.push(i);return e.zdirty=!1,e.zitems=n.sort(AV)}function ar(e,t){var n=e.items,i,r;if(!n||!n.length)return;const o=Jx(e);if(o&&o.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||t(n[i]);n=o}for(i=0,r=n.length;i<r;++i)t(n[i])}function Ip(e,t){var n=e.items,i,r;if(!n||!n.length)return null;const o=Jx(e);for(o&&o.length&&(n=o),r=n.length;--r>=0;)if(i=t(n[r]))return i;if(n===o){for(n=e.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=t(n[r])))return i}return null}function Qx(e){return function(t,n,i){ar(n,r=>{(!i||i.intersects(r.bounds))&&r3(e,t,r,r)})}}function kV(e){return function(t,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&r3(e,t,n.items[0],n.items)}}function r3(e,t,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(e(t,i)||(Ul(t,n),n.fill&&Lp(t,n,r)&&t.fill(),n.stroke&&ql(t,n,r)&&t.stroke()))}function Pp(e){return e=e||Ni,function(t,n,i,r,o,a){return i*=t.pixelRatio,r*=t.pixelRatio,Ip(n,s=>{const u=s.bounds;if(!(u&&!u.contains(o,a)||!u)&&e(t,s,i,r,o,a))return s})}}function ld(e,t){return function(n,i,r,o){var a=Array.isArray(i)?i[0]:i,s=t==null?a.fill:t,u=a.stroke&&n.isPointInStroke,l,c;return u&&(l=a.strokeWidth,c=a.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=c!=null?c:"butt"),e(n,i)?!1:s&&n.isPointInPath(r,o)||u&&n.isPointInStroke(r,o)}}function Zx(e){return Pp(ld(e))}function Js(e,t){return"translate("+e+","+t+")"}function e2(e){return"rotate("+e+")"}function CV(e,t){return"scale("+e+","+t+")"}function o3(e){return Js(e.x||0,e.y||0)}function TV(e){return Js(e.x||0,e.y||0)+(e.angle?" "+e2(e.angle):"")}function FV(e){return Js(e.x||0,e.y||0)+(e.angle?" "+e2(e.angle):"")+(e.scaleX||e.scaleY?" "+CV(e.scaleX||1,e.scaleY||1):"")}function t2(e,t,n){function i(a,s){a("transform",TV(s)),a("d",t(null,s))}function r(a,s){return t(ud(a,s.angle),s),jo(a,s).translate(s.x||0,s.y||0)}function o(a,s){var u=s.x||0,l=s.y||0,c=s.angle||0;a.translate(u,l),c&&a.rotate(c*=Na),a.beginPath(),t(a,s),c&&a.rotate(-c),a.translate(-u,-l)}return{type:e,tag:"path",nested:!1,attr:i,bound:r,draw:Qx(o),pick:Zx(o),isect:n||Xx(o)}}var MV=t2("arc",pV);function DV(e,t){for(var n=e[0].orient==="horizontal"?t[1]:t[0],i=e[0].orient==="horizontal"?"y":"x",r=e.length,o=1/0,a,s;--r>=0;)e[r].defined!==!1&&(s=Math.abs(e[r][i]-n),s<o&&(o=s,a=e[r]));return a}function NV(e,t){for(var n=Math.pow(e[0].strokeWidth||1,2),i=e.length,r,o,a;--i>=0;)if(e[i].defined!==!1&&(r=e[i].x-t[0],o=e[i].y-t[1],a=r*r+o*o,a<n))return e[i];return null}function RV(e,t){for(var n=e.length,i,r,o;--n>=0;)if(e[n].defined!==!1&&(i=e[n].x-t[0],r=e[n].y-t[1],o=i*i+r*r,i=e[n].size||1,o<i*i))return e[n];return null}function n2(e,t,n){function i(u,l){var c=l.mark.items;c.length&&u("d",t(null,c))}function r(u,l){var c=l.items;return c.length===0?u:(t(ud(u),c),jo(u,c[0]))}function o(u,l){u.beginPath(),t(u,l)}const a=ld(o);function s(u,l,c,f,d,h){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(d,h)?null:(c*=u.pixelRatio,f*=u.pixelRatio,a(u,g,c,f)?g[0]:null)}return{type:e,tag:"path",nested:!0,attr:i,bound:r,draw:kV(o),pick:s,isect:Kx,tip:n}}var jV=n2("area",mV,DV);function $V(e,t){var n=t.clip;e.save(),_e(n)?(e.beginPath(),n(e),e.clip()):a3(e,t.group)}function a3(e,t){e.beginPath(),zx(t)?zl(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function s3(e){const t=or(e.strokeWidth,1);return e.strokeOffset!=null?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function LV(e,t){e("transform",o3(t))}function u3(e,t){const n=s3(t);e("d",zl(null,t,n,n))}function IV(e,t){e("class","background"),e("aria-hidden",!0),u3(e,t)}function PV(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?u3(e,t):e("d","")}function zV(e,t,n){const i=t.clip?Bx(n,t,t):null;e("clip-path",i)}function BV(e,t){if(!t.clip&&t.items){const n=t.items,i=n.length;for(let r=0;r<i;++r)e.union(n[r].bounds)}return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),jo(e,t),e.translate(t.x||0,t.y||0)}function cd(e,t,n,i){const r=s3(t);e.beginPath(),zl(e,t,(n||0)+r,(i||0)+r)}const UV=ld(cd),qV=ld(cd,!1),WV=ld(cd,!0);function HV(e,t,n){ar(t,i=>{const r=i.x||0,o=i.y||0,a=i.strokeForeground,s=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&s&&(cd(e,i,r,o),Ul(e,i),i.fill&&Lp(e,i,s)&&e.fill(),i.stroke&&!a&&ql(e,i,s)&&e.stroke()),e.save(),e.translate(r,o),i.clip&&a3(e,i),n&&n.translate(-r,-o),ar(i,u=>{this.draw(e,u,n)}),n&&n.translate(r,o),e.restore(),a&&i.stroke&&s&&(cd(e,i,r,o),Ul(e,i),ql(e,i,s)&&e.stroke())})}function GV(e,t,n,i,r,o){if(t.bounds&&!t.bounds.contains(r,o)||!t.items)return null;const a=n*e.pixelRatio,s=i*e.pixelRatio;return Ip(t,u=>{let l,c,f;const d=u.bounds;if(d&&!d.contains(r,o))return;c=u.x||0,f=u.y||0;const h=c+(u.width||0),g=f+(u.height||0),p=u.clip;if(p&&(r<c||r>h||o<f||o>g))return;if(e.save(),e.translate(c,f),c=r-c,f=o-f,p&&zx(u)&&!WV(e,u,a,s))return e.restore(),null;const m=u.strokeForeground,y=t.interactive!==!1;return y&&m&&u.stroke&&qV(e,u,a,s)?(e.restore(),u):(l=Ip(u,v=>VV(v,c,f)?this.pick(v,n,i,c,f):null),!l&&y&&(u.fill||!m&&u.stroke)&&UV(e,u,a,s)&&(l=u),e.restore(),l||null)})}function VV(e,t,n){return(e.interactive!==!1||e.marktype==="group")&&e.bounds&&e.bounds.contains(t,n)}var YV={type:"group",tag:"g",nested:!1,attr:LV,bound:BV,draw:HV,pick:GV,isect:e3,content:zV,background:IV,foreground:PV},fd={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function i2(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then(i=>{e.image=i,e.image.url=e.url})),n}function r2(e,t){return e.width!=null?e.width:!t||!t.width?0:e.aspect!==!1&&e.height?e.height*t.width/t.height:t.width}function o2(e,t){return e.height!=null?e.height:!t||!t.height?0:e.aspect!==!1&&e.width?e.width*t.height/t.width:t.height}function zp(e,t){return e==="center"?t/2:e==="right"?t:0}function Bp(e,t){return e==="middle"?t/2:e==="bottom"?t:0}function XV(e,t,n){const i=i2(t,n),r=r2(t,i),o=o2(t,i),a=(t.x||0)-zp(t.align,r),s=(t.y||0)-Bp(t.baseline,o),u=!i.src&&i.toDataURL?i.toDataURL():i.src||"";e("href",u,fd["xmlns:xlink"],"xlink:href"),e("transform",Js(a,s)),e("width",r),e("height",o),e("preserveAspectRatio",t.aspect===!1?"none":"xMidYMid")}function KV(e,t){const n=t.image,i=r2(t,n),r=o2(t,n),o=(t.x||0)-zp(t.align,i),a=(t.y||0)-Bp(t.baseline,r);return e.set(o,a,o+i,a+r)}function JV(e,t,n){ar(t,i=>{if(n&&!n.intersects(i.bounds))return;const r=i2(i,this);let o=r2(i,r),a=o2(i,r);if(o===0||a===0)return;let s=(i.x||0)-zp(i.align,o),u=(i.y||0)-Bp(i.baseline,a),l,c,f,d;i.aspect!==!1&&(c=r.width/r.height,f=i.width/i.height,c===c&&f===f&&c!==f&&(f<c?(d=o/c,u+=(a-d)/2,a=d):(d=a*c,s+=(o-d)/2,o=d))),(r.complete||r.toDataURL)&&(Ul(e,i),e.globalAlpha=(l=i.opacity)!=null?l:1,e.imageSmoothingEnabled=i.smooth!==!1,e.drawImage(r,s,u,o,a))})}var QV={type:"image",tag:"image",nested:!1,attr:XV,bound:KV,draw:JV,pick:Pp(),isect:Ni,get:i2,xOffset:zp,yOffset:Bp},ZV=n2("line",yV,NV);function eY(e,t){var n=t.scaleX||1,i=t.scaleY||1;(n!==1||i!==1)&&e("vector-effect","non-scaling-stroke"),e("transform",FV(t)),e("d",t.path)}function Up(e,t){var n=t.path;if(n==null)return!0;var i=t.x||0,r=t.y||0,o=t.scaleX||1,a=t.scaleY||1,s=(t.angle||0)*Na,u=t.pathCache;(!u||u.path!==n)&&((t.pathCache=u=Il(n)).path=n),s&&e.rotate&&e.translate?(e.translate(i,r),e.rotate(s),id(e,u,0,0,o,a),e.rotate(-s),e.translate(-i,-r)):id(e,u,i,r,o,a)}function tY(e,t){return Up(ud(e,t.angle),t)?e.set(0,0,0,0):jo(e,t,!0)}var nY={type:"path",tag:"path",nested:!1,attr:eY,bound:tY,draw:Qx(Up),pick:Zx(Up),isect:Xx(Up)};function iY(e,t){e("d",zl(null,t))}function rY(e,t){var n,i;return jo(e.set(n=t.x||0,i=t.y||0,n+t.width||0,i+t.height||0),t)}function l3(e,t){e.beginPath(),zl(e,t)}var oY={type:"rect",tag:"path",nested:!1,attr:iY,bound:rY,draw:Qx(l3),pick:Zx(l3),isect:e3};function aY(e,t){e("transform",o3(t)),e("x2",t.x2!=null?t.x2-(t.x||0):0),e("y2",t.y2!=null?t.y2-(t.y||0):0)}function sY(e,t){var n,i;return jo(e.set(n=t.x||0,i=t.y||0,t.x2!=null?t.x2:n,t.y2!=null?t.y2:i),t)}function c3(e,t,n){var i,r,o,a;return t.stroke&&ql(e,t,n)?(i=t.x||0,r=t.y||0,o=t.x2!=null?t.x2:i,a=t.y2!=null?t.y2:r,e.beginPath(),e.moveTo(i,r),e.lineTo(o,a),!0):!1}function uY(e,t,n){ar(t,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&c3(e,i,r)&&(Ul(e,i),e.stroke())}})}function lY(e,t,n,i){return e.isPointInStroke?c3(e,t,1)&&e.isPointInStroke(n,i):!1}var cY={type:"rule",tag:"line",nested:!1,attr:aY,bound:sY,draw:uY,pick:Pp(lY),isect:t3},fY=t2("shape",vV),dY=t2("symbol",bV,Kx);const f3=iC();var Vr={height:Yr,measureWidth:s2,estimateWidth:a2,width:a2,canvas:d3};d3(!0);function d3(e){Vr.width=e&&$a?s2:a2}function a2(e,t){return h3(Ia(e,t),Yr(e))}function h3(e,t){return~~(.8*e.length*t)}function s2(e,t){return Yr(e)<=0||!(t=Ia(e,t))?0:g3(t,qp(e))}function g3(e,t){const n=`(${t}) ${e}`;let i=f3.get(n);return i===void 0&&($a.font=t,i=$a.measureText(e).width,f3.set(n,i)),i}function Yr(e){return e.fontSize!=null?+e.fontSize||0:11}function La(e){return e.lineHeight!=null?e.lineHeight:Yr(e)+2}function hY(e){return P(e)?e.length>1?e:e[0]:e}function dd(e){return hY(e.lineBreak&&e.text&&!P(e.text)?e.text.split(e.lineBreak):e.text)}function u2(e){const t=dd(e);return(P(t)?t.length-1:0)*La(e)}function Ia(e,t){const n=t==null?"":(t+"").trim();return e.limit>0&&n.length?pY(e,n):n}function gY(e){if(Vr.width===s2){const t=qp(e);return n=>g3(n,t)}else{const t=Yr(e);return n=>h3(n,t)}}function pY(e,t){var n=+e.limit,i=gY(e);if(i(t)<n)return t;var r=e.ellipsis||"\u2026",o=e.dir==="rtl",a=0,s=t.length,u;if(n-=i(r),o){for(;a<s;)u=a+s>>>1,i(t.slice(u))>n?a=u+1:s=u;return r+t.slice(a)}else{for(;a<s;)u=1+(a+s>>>1),i(t.slice(0,u))<n?a=u:s=u-1;return t.slice(0,a)+r}}function hd(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function qp(e,t){return""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+Yr(e)+"px "+hd(e,t)}function l2(e){var t=e.baseline,n=Yr(e);return Math.round(t==="top"?.79*n:t==="middle"?.3*n:t==="bottom"?-.21*n:t==="line-top"?.29*n+.5*La(e):t==="line-bottom"?.29*n-.5*La(e):0)}const mY={left:"start",center:"middle",right:"end"},gd=new Nt;function Wp(e){var t=e.x||0,n=e.y||0,i=e.radius||0,r;return i&&(r=(e.theta||0)-Vs,t+=i*Math.cos(r),n+=i*Math.sin(r)),gd.x1=t,gd.y1=n,gd}function yY(e,t){var n=t.dx||0,i=(t.dy||0)+l2(t),r=Wp(t),o=r.x1,a=r.y1,s=t.angle||0,u;e("text-anchor",mY[t.align]||"start"),s?(u=Js(o,a)+" "+e2(s),(n||i)&&(u+=" "+Js(n,i))):u=Js(o+n,a+i),e("transform",u)}function c2(e,t,n){var i=Vr.height(t),r=t.align,o=Wp(t),a=o.x1,s=o.y1,u=t.dx||0,l=(t.dy||0)+l2(t)-Math.round(.8*i),c=dd(t),f;if(P(c)?(i+=La(t)*(c.length-1),f=c.reduce((d,h)=>Math.max(d,Vr.width(t,h)),0)):f=Vr.width(t,c),r==="center"?u-=f/2:r==="right"&&(u-=f),e.set(u+=a,l+=s,u+f,l+i),t.angle&&!n)e.rotate(t.angle*Na,a,s);else if(n===2)return e.rotatedPoints(t.angle*Na,a,s);return e}function vY(e,t,n){ar(t,i=>{var r=i.opacity==null?1:i.opacity,o,a,s,u,l,c,f;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(e.font=qp(i),e.textAlign=i.align||"left",o=Wp(i),a=o.x1,s=o.y1,i.angle&&(e.save(),e.translate(a,s),e.rotate(i.angle*Na),a=s=0),a+=i.dx||0,s+=(i.dy||0)+l2(i),c=dd(i),Ul(e,i),P(c))for(l=La(i),u=0;u<c.length;++u)f=Ia(i,c[u]),i.fill&&Lp(e,i,r)&&e.fillText(f,a,s),i.stroke&&ql(e,i,r)&&e.strokeText(f,a,s),s+=l;else f=Ia(i,c),i.fill&&Lp(e,i,r)&&e.fillText(f,a,s),i.stroke&&ql(e,i,r)&&e.strokeText(f,a,s);i.angle&&e.restore()}})}function bY(e,t,n,i,r,o){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var a=Wp(t),s=a.x1,u=a.y1,l=c2(gd,t,1),c=-t.angle*Na,f=Math.cos(c),d=Math.sin(c),h=f*r-d*o+(s-f*s+d*u),g=d*r+f*o+(u-d*s-f*u);return l.contains(h,g)}function xY(e,t){const n=c2(gd,e,2);return Bl(t,n[0],n[1],n[2],n[3])||Bl(t,n[0],n[1],n[4],n[5])||Bl(t,n[4],n[5],n[6],n[7])||Bl(t,n[2],n[3],n[6],n[7])}var wY={type:"text",tag:"text",nested:!1,attr:yY,bound:c2,draw:vY,pick:Pp(bY),isect:xY},_Y=n2("trail",xV,RV),xi={arc:MV,area:jV,group:YV,image:QV,line:ZV,path:nY,rect:oY,rule:cY,shape:fY,symbol:dY,text:wY,trail:_Y};function f2(e,t,n){var i=xi[e.mark.marktype],r=t||i.bound;return i.nested&&(e=e.mark),r(e.bounds||(e.bounds=new Nt),e,n)}var p3={mark:null};function m3(e,t,n){var i=xi[e.marktype],r=i.bound,o=e.items,a=o&&o.length,s,u,l,c;if(i.nested)return a?l=o[0]:(p3.mark=e,l=p3),c=f2(l,r,n),t=t&&t.union(c)||c,t;if(t=t||e.bounds&&e.bounds.clear()||new Nt,a)for(s=0,u=o.length;s<u;++s)t.union(f2(o[s],r,n));return e.bounds=t}const EY=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function y3(e,t){return JSON.stringify(e,EY,t)}function v3(e){const t=typeof e=="string"?JSON.parse(e):e;return b3(t)}function b3(e){var t=e.marktype,n=e.items,i,r,o;if(n)for(r=0,o=n.length;r<o;++r)i=t?"mark":"group",n[r][i]=e,n[r].zindex&&(n[r][i].zdirty=!0),(t||i)==="group"&&b3(n[r]);return t&&m3(e),e}function d2(e){arguments.length?this.root=v3(e):(this.root=x3({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Mp(this.root)])}d2.prototype={toJSON(e){return y3(this.root,e||0)},mark(e,t,n){t=t||this.root.items[0];const i=x3(e,t);return t.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function x3(e,t){const n={bounds:new Nt,clip:!!e.clip,group:t,interactive:e.interactive!==!1,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return e.aria!=null&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Pa(e,t,n){return!e&&typeof document!="undefined"&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function h2(e,t){t=t.toLowerCase();for(var n=e.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===t)return n[i]}function Zn(e,t,n,i){var r=e.childNodes[t],o;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(o=r||null,r=Pa(e.ownerDocument,n,i),e.insertBefore(r,o)),r}function sr(e,t){for(var n=e.childNodes,i=n.length;i>t;)e.removeChild(n[--i]);return e}function w3(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Hp(e,t){const n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function OY(e,t,n,i){var r=e&&e.mark,o,a;if(r&&(o=xi[r.marktype]).tip){for(a=Hp(t,n),a[0]-=i[0],a[1]-=i[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=o.tip(r.items,a)}return e}function za(e,t){this._active=null,this._handlers={},this._loader=e||Pg(),this._tooltip=t||SY}function SY(e,t,n,i){e.element().setAttribute("title",i||"")}za.prototype={initialize(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene(e){return arguments.length?(this._scene=e,this):this._scene},on(){},off(){},_handlerIndex(e,t,n){for(let i=e?e.length:0;--i>=0;)if(e[i].type===t&&(!n||e[i].handler===n))return i;return-1},handlers(e){const t=this._handlers,n=[];if(e)n.push(...t[this.eventName(e)]);else for(const i in t)n.push(...t[i]);return n},eventName(e){const t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref(e,t,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(e.type,e),o=Pa(null,"a");for(const a in i)o.setAttribute(a,i[a]);o.dispatchEvent(r)}).catch(()=>{})},handleTooltip(e,t,n){if(t&&t.tooltip!=null){t=OY(t,e,this.canvas(),this._origin);const i=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,i)}},getItemBoundingClientRect(e){const t=this.canvas();if(!t)return;const n=t.getBoundingClientRect(),i=this._origin,r=e.bounds,o=r.width(),a=r.height();let s=r.x1+i[0]+n.left,u=r.y1+i[1]+n.top;for(;e.mark&&(e=e.mark.group);)s+=e.x||0,u+=e.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}};function Xr(e){this._el=null,this._bgcolor=null,this._loader=new Ux(e)}Xr.prototype={initialize(e,t,n,i,r){return this._el=e,this.resize(t,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(e){return arguments.length===0?this._bgcolor:(this._bgcolor=e,this)},resize(e,t,n,i){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(e){const t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render(){},renderAsync(e){const t=this.render(e);return this._ready?this._ready.then(()=>t):Promise.resolve(t)},_load(e,t){var n=this,i=n._loader[e](t);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(o=>{o&&r(),n._ready=null})}return i},sanitizeURL(e){return this._load("sanitizeURL",e)},loadImage(e){return this._load("loadImage",e)}};const AY="keydown",kY="keypress",CY="keyup",_3="dragenter",Gp="dragleave",E3="dragover",g2="mousedown",TY="mouseup",Vp="mousemove",pd="mouseout",O3="mouseover",Yp="click",FY="dblclick",MY="wheel",S3="mousewheel",Xp="touchstart",Kp="touchmove",Jp="touchend",DY=[AY,kY,CY,_3,Gp,E3,g2,TY,Vp,pd,O3,Yp,FY,MY,S3,Xp,Kp,Jp],p2=Vp,md=pd,m2=Yp;function yd(e,t){za.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}const NY=e=>e===Xp||e===Kp||e===Jp?[Xp,Kp,Jp]:[e];function A3(e,t){NY(t).forEach(n=>RY(e,n))}function RY(e,t){const n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?i=>e[t](i):i=>e.fire(t,i)))}function k3(e,t,n){return function(i){const r=this._active,o=this.pickEvent(i);o===r?this.fire(e,i):((!r||!r.exit)&&this.fire(n,i),this._active=o,this.fire(t,i),this.fire(e,i))}}function C3(e){return function(t){this.fire(e,t),this._active=null}}W(yd,za,{initialize(e,t,n){return this._canvas=e&&h2(e,"canvas"),[Yp,g2,Vp,pd,Gp].forEach(i=>A3(this,i)),za.prototype.initialize.call(this,e,t,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:DY,DOMMouseScroll(e){this.fire(S3,e)},mousemove:k3(Vp,O3,pd),dragover:k3(E3,_3,Gp),mouseout:C3(pd),dragleave:C3(Gp),mousedown(e){this._down=this._active,this.fire(g2,e)},click(e){this._down===this._active&&(this.fire(Yp,e),this._down=null)},touchstart(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Xp,e,!0)},touchmove(e){this.fire(Kp,e,!0)},touchend(e){this.fire(Jp,e,!0),this._touch=null},fire(e,t,n){const i=n?this._touch:this._active,r=this._handlers[e];if(t.vegaType=e,e===m2&&i&&i.href?this.handleHref(t,i,i.href):(e===p2||e===md)&&this.handleTooltip(t,i,e!==md),r)for(let o=0,a=r.length;o<a;++o)r[o].handler.call(this._obj,t,i)},on(e,t){const n=this.eventName(e),i=this._handlers;return this._handlerIndex(i[n],e,t)<0&&(A3(this,e),(i[n]||(i[n]=[])).push({type:e,handler:t})),this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&i.splice(r,1),this},pickEvent(e){const t=Hp(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick(e,t,n,i,r){const o=this.context();return xi[e.marktype].pick.call(this,o,e,t,n,i,r)}});function jY(){return typeof window!="undefined"&&window.devicePixelRatio||1}var $Y=jY();function LY(e,t,n,i,r,o){const a=typeof HTMLElement!="undefined"&&e instanceof HTMLElement&&e.parentNode!=null,s=e.getContext("2d"),u=a?$Y:r;e.width=t*u,e.height=n*u;for(const l in o)s[l]=o[l];return a&&u!==1&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*i[0],u*i[1]),e}function Qp(e){Xr.call(this,e),this._options={},this._redraw=!1,this._dirty=new Nt,this._tempb=new Nt}const T3=Xr.prototype,IY=(e,t,n)=>new Nt().set(0,0,t,n).translate(-e[0],-e[1]);function PY(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}W(Qp,Xr,{initialize(e,t,n,i,r,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Tl(1,1,this._options.type),e&&this._canvas&&(sr(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),T3.initialize.call(this,e,t,n,i,r)},resize(e,t,n,i){if(T3.resize.call(this,e,t,n,i),this._canvas)LY(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||L("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(e){const t=this._tempb.clear().union(e.bounds);let n=e.mark.group;for(;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render(e){const t=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,a=IY(n,i,r);t.save();const s=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):PY(t,a.intersect(o),n);return this.clear(-n[0],-n[1],i,r),this.draw(t,e,s),t.restore(),o.clear(),this},draw(e,t,n){const i=xi[t.marktype];t.clip&&$V(e,t),i.draw.call(this,e,t,n),t.clip&&e.restore()},clear(e,t,n,i){const r=this._options,o=this.context();r.type!=="pdf"&&!r.externalContext&&o.clearRect(e,t,n,i),this._bgcolor!=null&&(o.fillStyle=this._bgcolor,o.fillRect(e,t,n,i))}});function y2(e,t){za.call(this,e,t);const n=this;n._hrefHandler=v2(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=v2(n,(i,r)=>{n.handleTooltip(i,r,i.type!==md)})}const v2=(e,t)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,t.call(e._obj,n,i)};W(y2,za,{initialize(e,t,n){let i=this._svg;return i&&(i.removeEventListener(m2,this._hrefHandler),i.removeEventListener(p2,this._tooltipHandler),i.removeEventListener(md,this._tooltipHandler)),this._svg=i=e&&h2(e,"svg"),i&&(i.addEventListener(m2,this._hrefHandler),i.addEventListener(p2,this._tooltipHandler),i.addEventListener(md,this._tooltipHandler)),za.prototype.initialize.call(this,e,t,n)},canvas(){return this._svg},on(e,t){const n=this.eventName(e),i=this._handlers;if(this._handlerIndex(i[n],e,t)<0){const o={type:e,handler:t,listener:v2(this,t)};(i[n]||(i[n]=[])).push(o),this._svg&&this._svg.addEventListener(n,o.listener)}return this},off(e,t){const n=this.eventName(e),i=this._handlers[n],r=this._handlerIndex(i,e,t);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const F3="aria-hidden",b2="aria-label",x2="role",w2="aria-roledescription",M3="graphics-object",_2="graphics-symbol",D3=(e,t,n)=>({[x2]:e,[w2]:t,[b2]:n||void 0}),zY=nr(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),N3={axis:{desc:"axis",caption:qY},legend:{desc:"legend",caption:WY},"title-text":{desc:"title",caption:e=>`Title text '${L3(e)}'`},"title-subtitle":{desc:"subtitle",caption:e=>`Subtitle text '${L3(e)}'`}},R3={ariaRole:x2,ariaRoleDescription:w2,description:b2};function j3(e,t){const n=t.aria===!1;if(e(F3,n||void 0),n||t.description==null)for(const i in R3)e(R3[i],void 0);else{const i=t.mark.marktype;e(b2,t.description),e(x2,t.ariaRole||(i==="group"?M3:_2)),e(w2,t.ariaRoleDescription||`${i} mark`)}}function $3(e){return e.aria===!1?{[F3]:!0}:zY[e.role]?null:N3[e.role]?UY(e,N3[e.role]):BY(e)}function BY(e){const t=e.marktype,n=t==="group"||t==="text"||e.items.some(i=>i.description!=null&&i.aria!==!1);return D3(n?M3:_2,`${t} mark container`,e.description)}function UY(e,t){try{const n=e.items[0],i=t.caption||(()=>"");return D3(t.role||_2,t.desc,n.description||i(n))}catch{return null}}function L3(e){return J(e.text).join(" ")}function qY(e){const t=e.datum,n=e.orient,i=t.title?I3(e):null,r=e.context,o=r.scales[t.scale].value,a=r.dataflow.locale(),s=o.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Ll(s)?"discrete":s} scale with ${RD(a,o,e)}`}function WY(e){const t=e.datum,n=t.title?I3(e):null,i=`${t.type||""} legend`.trim(),r=t.scales,o=Object.keys(r),a=e.context,s=a.scales[r[o[0]]].value,u=a.dataflow.locale();return GY(i)+(n?` titled '${n}'`:"")+` for ${HY(o)} with ${RD(u,s,e)}`}function I3(e){try{return J(Fe(e.items).items[0].text).join(" ")}catch{return null}}function HY(e){return e=e.map(t=>t+(t==="fill"||t==="stroke"?" color":"")),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Fe(e)}function GY(e){return e.length?e[0].toUpperCase()+e.slice(1):e}const P3=e=>(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),VY=e=>P3(e).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function E2(){let e="",t="",n="";const i=[],r=()=>t=n="",o=u=>{t&&(e+=`${t}>${n}`,r()),i.push(u)},a=(u,l)=>(l!=null&&(t+=` ${u}="${VY(l)}"`),s),s={open(u,...l){o(u),t="<"+u;for(const c of l)for(const f in c)a(f,c[f]);return s},close(){const u=i.pop();return t?e+=t+(n?`>${n}</${u}>`:"/>"):e+=`</${u}>`,r(),s},attr:a,text:u=>(n+=P3(u),s),toString:()=>e};return s}const z3=e=>B3(E2(),e)+"";function B3(e,t){if(e.open(t.tagName),t.hasAttributes()){const n=t.attributes,i=n.length;for(let r=0;r<i;++r)e.attr(n[r].name,n[r].value)}if(t.hasChildNodes()){const n=t.childNodes,i=n.length;for(let r=0;r<i;r++){const o=n[r];o.nodeType===3?e.text(o.nodeValue):B3(e,o)}}return e.close()}const Zp={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},U3={fill:"none","stroke-miterlimit":10},vd=0,q3="http://www.w3.org/2000/xmlns/",Rt=fd.xmlns;function O2(e){Xr.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const S2=Xr.prototype;W(O2,Xr,{initialize(e,t,n,i,r){return this._defs={},this._clearDefs(),e&&(this._svg=Zn(e,0,"svg",Rt),this._svg.setAttributeNS(q3,"xmlns",Rt),this._svg.setAttributeNS(q3,"xmlns:xlink",fd["xmlns:xlink"]),this._svg.setAttribute("version",fd.version),this._svg.setAttribute("class","marks"),sr(e,1),this._root=Zn(this._svg,vd,"g",Rt),Ba(this._root,U3),sr(this._svg,vd+1)),this.background(this._bgcolor),S2.initialize.call(this,e,t,n,i,r)},background(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),S2.background.apply(this,arguments)},resize(e,t,n,i){return S2.resize.call(this,e,t,n,i),this._svg&&(Ba(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const e=this._svg,t=this._bgcolor;if(!e)return null;let n;t&&(e.removeAttribute("style"),n=Zn(e,vd,"rect",Rt),Ba(n,{width:this._width,height:this._height,fill:t}));const i=z3(e);return t&&(e.removeChild(n),this._svg.style.setProperty("background-color",t)),i},_render(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),sr(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const e=this._dirty;if(!e.length||!this._dirtyID)return!0;const t=++this._dirtyID;let n,i,r,o,a,s,u;for(a=0,s=e.length;a<s;++a)if(n=e[a],i=n.mark,i.marktype!==r&&(r=i.marktype,o=xi[r]),i.zdirty&&i.dirty!==t&&(this._dirtyAll=!1,W3(n,t),i.items.forEach(l=>{l.dirty=t})),!i.zdirty){if(n.exit){o.nested&&i.items.length?(u=i.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null;continue}n=o.nested?i.items[0]:n,n._update!==t&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,W3(n,t)):this._update(o,n._svg,n),n._update=t)}return!this._dirtyAll},mark(e,t,n){if(!this.isDirty(t))return t._svg;const i=this._svg,r=xi[t.marktype],o=t.interactive===!1?"none":null,a=r.tag==="g";let s=null,u=0;const l=H3(t,e,n,"g",i);l.setAttribute("class",w3(t));const c=$3(t);for(const d in c)Tn(l,d,c[d]);a||Tn(l,"pointer-events",o),Tn(l,"clip-path",t.clip?Bx(this,t,t.group):null);const f=d=>{const h=this.isDirty(d),g=H3(d,l,s,r.tag,i);h&&(this._update(r,g,d),a&&KY(this,g,d)),s=g,++u};return r.nested?t.items.length&&f(t.items[0]):ar(t,f),sr(l,u),l},_update(e,t,n){$o=t,bn=t.__values__,j3(bd,n),e.attr(bd,n,this);const i=QY[e.type];i&&i.call(this,e,t,n),$o&&this.style($o,n)},style(e,t){if(t!=null)for(const n in Zp){let i=n==="font"?hd(t):t[n];if(i===bn[n])continue;const r=Zp[n];i==null?e.removeAttribute(r):(jx(i)&&(i=$D(i,this._defs.gradient,G3())),e.setAttribute(r,i+"")),bn[n]=i}},defs(){const e=this._svg,t=this._defs;let n=t.el,i=0;for(const r in t.gradient)n||(t.el=n=Zn(e,vd+1,"defs",Rt)),i=YY(n,t.gradient[r],i);for(const r in t.clipping)n||(t.el=n=Zn(e,vd+1,"defs",Rt)),i=XY(n,t.clipping[r],i);n&&(i===0?(e.removeChild(n),t.el=null):sr(n,i))},_clearDefs(){const e=this._defs;e.gradient={},e.clipping={}}});function W3(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}function YY(e,t,n){let i,r,o;if(t.gradient==="radial"){let a=Zn(e,n++,"pattern",Rt);Ba(a,{id:kp+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),a=Zn(a,0,"rect",Rt),Ba(a,{width:1,height:1,fill:`url(${G3()}#${t.id})`}),e=Zn(e,n++,"radialGradient",Rt),Ba(e,{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else e=Zn(e,n++,"linearGradient",Rt),Ba(e,{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(i=0,r=t.stops.length;i<r;++i)o=Zn(e,i,"stop",Rt),o.setAttribute("offset",t.stops[i].offset),o.setAttribute("stop-color",t.stops[i].color);return sr(e,i),n}function XY(e,t,n){let i;return e=Zn(e,n,"clipPath",Rt),e.setAttribute("id",t.id),t.path?(i=Zn(e,0,"path",Rt),i.setAttribute("d",t.path)):(i=Zn(e,0,"rect",Rt),Ba(i,{x:0,y:0,width:t.width,height:t.height})),sr(e,1),n+1}function KY(e,t,n){t=t.lastChild.previousSibling;let i,r=0;ar(n,o=>{i=e.mark(t,o,i),++r}),sr(t,1+r)}function H3(e,t,n,i,r){let o=e._svg,a;if(!o&&(a=t.ownerDocument,o=Pa(a,i,Rt),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},i==="g"))){const s=Pa(a,"path",Rt);o.appendChild(s),s.__data__=e;const u=Pa(a,"g",Rt);o.appendChild(u),u.__data__=e;const l=Pa(a,"path",Rt);o.appendChild(l),l.__data__=e,l.__values__={fill:"default"}}return(o.ownerSVGElement!==r||JY(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}function JY(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}let $o=null,bn=null;const QY={group(e,t,n){const i=$o=t.childNodes[2];bn=i.__values__,e.foreground(bd,n,this),bn=t.__values__,$o=t.childNodes[1],e.content(bd,n,this);const r=$o=t.childNodes[0];e.background(bd,n,this);const o=n.mark.interactive===!1?"none":null;if(o!==bn.events&&(Tn(i,"pointer-events",o),Tn(r,"pointer-events",o),bn.events=o),n.strokeForeground&&n.stroke){const a=n.fill;Tn(i,"display",null),this.style(r,n),Tn(r,"stroke",null),a&&(n.fill=null),bn=i.__values__,this.style(i,n),a&&(n.fill=a),$o=null}else Tn(i,"display","none")},image(e,t,n){n.smooth===!1?(A2(t,"image-rendering","optimizeSpeed"),A2(t,"image-rendering","pixelated")):A2(t,"image-rendering",null)},text(e,t,n){const i=dd(n);let r,o,a,s;P(i)?(o=i.map(u=>Ia(n,u)),r=o.join(`
`),r!==bn.text&&(sr(t,0),a=t.ownerDocument,s=La(n),o.forEach((u,l)=>{const c=Pa(a,"tspan",Rt);c.__data__=n,c.textContent=u,l&&(c.setAttribute("x",0),c.setAttribute("dy",s)),t.appendChild(c)}),bn.text=r)):(o=Ia(n,i),o!==bn.text&&(t.textContent=o,bn.text=o)),Tn(t,"font-family",hd(n)),Tn(t,"font-size",Yr(n)+"px"),Tn(t,"font-style",n.fontStyle),Tn(t,"font-variant",n.fontVariant),Tn(t,"font-weight",n.fontWeight)}};function bd(e,t,n){t!==bn[e]&&(n?ZY($o,e,t,n):Tn($o,e,t),bn[e]=t)}function A2(e,t,n){n!==bn[t]&&(n==null?e.style.removeProperty(t):e.style.setProperty(t,n+""),bn[t]=n)}function Ba(e,t){for(const n in t)Tn(e,n,t[n])}function Tn(e,t,n){n!=null?e.setAttribute(t,n):e.removeAttribute(t)}function ZY(e,t,n,i){n!=null?e.setAttributeNS(i,t,n):e.removeAttributeNS(i,t)}function G3(){let e;return typeof window=="undefined"?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function k2(e){Xr.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}W(k2,Xr,{svg(){return this._text},_render(e){const t=E2();t.open("svg",Ee({},fd,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",U3,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark(e,t){const n=xi[t.marktype],i=n.tag,r=[j3,n.attr];e.open("g",{class:w3(t),"clip-path":t.clip?Bx(this,t,t.group):null},$3(t),{"pointer-events":i!=="g"&&t.interactive===!1?"none":null});const o=a=>{const s=this.href(a);if(s&&e.open("a",s),e.open(i,this.attr(t,a,r,i!=="g"?i:null)),i==="text"){const u=dd(a);if(P(u)){const l={x:0,dy:La(a)};for(let c=0;c<u.length;++c)e.open("tspan",c?l:null).text(Ia(a,u[c])).close()}else e.text(Ia(a,u))}else if(i==="g"){const u=a.strokeForeground,l=a.fill,c=a.stroke;u&&c&&(a.stroke=null),e.open("path",this.attr(t,a,n.background,"bgrect")).close(),e.open("g",this.attr(t,a,n.content)),ar(a,f=>this.mark(e,f)),e.close(),u&&c?(l&&(a.fill=null),a.stroke=c,e.open("path",this.attr(t,a,n.foreground,"bgrect")).close(),l&&(a.fill=l)):e.open("path",this.attr(t,a,n.foreground,"bgfore")).close()}e.close(),s&&e.close()};return n.nested?t.items&&t.items.length&&o(t.items[0]):ar(t,o),e.close()},href(e){const t=e.href;let n;if(t){if(n=this._hrefs&&this._hrefs[t])return n;this.sanitizeURL(t).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[t]=i})}return null},attr(e,t,n,i){const r={},o=(a,s,u,l)=>{r[l||a]=s};return Array.isArray(n)?n.forEach(a=>a(o,t,this)):n(o,t,this),i&&eX(r,t,e,i,this._defs),r},defs(e){const t=this._defs.gradient,n=this._defs.clipping;if(Object.keys(t).length+Object.keys(n).length!==0){e.open("defs");for(const r in t){const o=t[r],a=o.stops;o.gradient==="radial"?(e.open("pattern",{id:kp+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:o.x1,fy:o.y1,fr:o.r1,cx:o.x2,cy:o.y2,r:o.r2})):e.open("linearGradient",{id:r,x1:o.x1,x2:o.x2,y1:o.y1,y2:o.y2});for(let s=0;s<a.length;++s)e.open("stop",{offset:a[s].offset,"stop-color":a[s].color}).close();e.close()}for(const r in n){const o=n[r];e.open("clipPath",{id:r}),o.path?e.open("path",{d:o.path}).close():e.open("rect",{x:0,y:0,width:o.width,height:o.height}).close(),e.close()}e.close()}}});function eX(e,t,n,i,r){if(t==null||(i==="bgrect"&&n.interactive===!1&&(e["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(e["pointer-events"]="none"),e.display="none",t.fill!==null)))return e;i==="image"&&t.smooth===!1&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(e["font-family"]=hd(t),e["font-size"]=Yr(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(const o in Zp){let a=t[o];const s=Zp[o];a==="transparent"&&(s==="fill"||s==="stroke")||a!=null&&(jx(a)&&(a=$D(a,r.gradient,"")),e[s]=a)}return e}const V3="canvas",Y3="png",X3="svg",K3="none",Ua={Canvas:V3,PNG:Y3,SVG:X3,None:K3},Wl={};Wl[V3]=Wl[Y3]={renderer:Qp,headless:Qp,handler:yd};Wl[X3]={renderer:O2,headless:k2,handler:y2};Wl[K3]={};function em(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Wl[e]=t,this):Wl[e]}function J3(e,t,n){const i=[],r=new Nt().union(t),o=e.marktype;return o?Q3(e,r,n,i):o==="group"?Z3(e,r,n,i):L("Intersect scene must be mark node or group item.")}function Q3(e,t,n,i){if(tX(e,t,n)){const r=e.items,o=e.marktype,a=r.length;let s=0;if(o==="group")for(;s<a;++s)Z3(r[s],t,n,i);else for(const u=xi[o].isect;s<a;++s){const l=r[s];eN(l,t,u)&&i.push(l)}}return i}function tX(e,t,n){return e.bounds&&t.intersects(e.bounds)&&(e.marktype==="group"||e.interactive!==!1&&(!n||n(e)))}function Z3(e,t,n,i){n&&n(e.mark)&&eN(e,t,xi.group.isect)&&i.push(e);const r=e.items,o=r&&r.length;if(o){const a=e.x||0,s=e.y||0;t.translate(-a,-s);for(let u=0;u<o;++u)Q3(r[u],t,n,i);t.translate(a,s)}return i}function eN(e,t,n){const i=e.bounds;return t.encloses(i)||t.intersects(i)&&n(e,t)}const C2=new Nt;function tN(e){const t=e.clip;if(_e(t))t(ud(C2.clear()));else if(t)C2.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(C2)}const nX=1e-9;function T2(e,t,n){return e===t?!0:n==="path"?nN(e,t):e instanceof Date&&t instanceof Date?+e==+t:Je(e)&&Je(t)?Math.abs(e-t)<=nX:!e||!t||!Q(e)&&!Q(t)?e==t:iX(e,t)}function nN(e,t){return T2(Il(e),Il(t))}function iX(e,t){var n=Object.keys(e),i=Object.keys(t),r,o;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),o=n.length-1;o>=0;o--)if(n[o]!=i[o])return!1;for(o=n.length-1;o>=0;o--)if(r=n[o],!T2(e[r],t[r],r))return!1;return typeof e==typeof t}function rX(){VD(),RG()}const Hl="top",ur="left",lr="right",qa="bottom",oX="top-left",aX="top-right",sX="bottom-left",uX="bottom-right",F2="start",M2="middle",Fn="end",lX="x",cX="y",tm="group",D2="axis",N2="title",fX="frame",dX="scope",R2="legend",iN="row-header",rN="row-footer",oN="row-title",aN="column-header",sN="column-footer",uN="column-title",hX="padding",gX="symbol",lN="fit",pX="fit-x",mX="fit-y",yX="pad",j2="none",nm="all",$2="each",L2="flush",Wa="column",Ha="row";function cN(e){R.call(this,null,e)}W(cN,R,{transform(e,t){const n=t.dataflow,i=e.mark,r=i.marktype,o=xi[r],a=o.bound;let s=i.bounds,u;if(o.nested)i.items.length&&n.dirty(i.items[0]),s=im(i,a),i.items.forEach(l=>{l.bounds.clear().union(s)});else if(r===tm||e.modified())switch(t.visit(t.MOD,l=>n.dirty(l)),s.clear(),i.items.forEach(l=>s.union(im(l,a))),i.role){case D2:case R2:case N2:t.reflow()}else u=t.changed(t.REM),t.visit(t.ADD,l=>{s.union(im(l,a))}),t.visit(t.MOD,l=>{u=u||s.alignsWith(l.bounds),n.dirty(l),s.union(im(l,a))}),u&&(s.clear(),i.items.forEach(l=>s.union(l.bounds)));return tN(i),t.modifies("bounds")}});function im(e,t,n){return t(e.bounds.clear(),e,n)}const fN=":vega_identifier:";function I2(e){R.call(this,0,e)}I2.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};W(I2,R,{transform(e,t){const n=vX(t.dataflow),i=e.as;let r=n.value;return t.visit(t.ADD,o=>o[i]=o[i]||++r),n.set(this.value=r),t}});function vX(e){return e._signals[fN]||(e._signals[fN]=e.add(0))}function dN(e){R.call(this,null,e)}W(dN,R,{transform(e,t){let n=this.value;n||(n=t.dataflow.scenegraph().mark(e.markdef,bX(e),e.index),n.group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);const i=n.marktype===tm?Mp:Fp;return t.visit(t.ADD,r=>i.call(r,n)),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});function bX(e){const t=e.groups,n=e.parent;return t&&t.size===1?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}function hN(e){R.call(this,null,e)}const gN={parity:e=>e.filter((t,n)=>n%2?t.opacity=0:1),greedy:(e,t)=>{let n;return e.filter((i,r)=>!r||!pN(n.bounds,i.bounds,t)?(n=i,1):i.opacity=0)}},pN=(e,t,n)=>n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2),mN=(e,t)=>{for(var n=1,i=e.length,r=e[0].bounds,o;n<i;r=o,++n)if(pN(r,o=e[n].bounds,t))return!0},xX=e=>{const t=e.bounds;return t.width()>1&&t.height()>1},wX=(e,t,n)=>{var i=e.range(),r=new Nt;return t===Hl||t===qa?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),o=>r.encloses(o.bounds)},yN=e=>(e.forEach(t=>t.opacity=1),e),vN=(e,t)=>e.reflow(t.modified()).modifies("opacity");W(hN,R,{transform(e,t){const n=gN[e.method]||gN.parity,i=e.separation||0;let r=t.materialize(t.SOURCE).source,o,a;if(!r||!r.length)return;if(!e.method)return e.modified("method")&&(yN(r),t=vN(t,e)),t;if(r=r.filter(xX),!r.length)return;if(e.sort&&(r=r.slice().sort(e.sort)),o=yN(r),t=vN(t,e),o.length>=3&&mN(o,i)){do o=n(o,i);while(o.length>=3&&mN(o,i));o.length<3&&!Fe(r).opacity&&(o.length>1&&(Fe(o).opacity=0),Fe(r).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(a=wX(e.boundScale,e.boundOrient,+e.boundTolerance),r.forEach(u=>{a(u)||(u.opacity=0)}));const s=o[0].mark.bounds.clear();return r.forEach(u=>{u.opacity&&s.union(u.bounds)}),t}});function bN(e){R.call(this,null,e)}W(bN,R,{transform(e,t){const n=t.dataflow;if(t.visit(t.ALL,i=>n.dirty(i)),t.fields&&t.fields.zindex){const i=t.source&&t.source[0];i&&(i.mark.zdirty=!0)}}});const xn=new Nt;function Gl(e,t,n){return e[t]===n?0:(e[t]=n,1)}function _X(e){var t=e.items[0].orient;return t===ur||t===lr}function EX(e){let t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}function OX(e,t,n,i){var r=t.items[0],o=r.datum,a=r.translate!=null?r.translate:.5,s=r.orient,u=EX(o),l=r.range,c=r.offset,f=r.position,d=r.minExtent,h=r.maxExtent,g=o.title&&r.items[u[2]].items[0],p=r.titlePadding,m=r.bounds,y=g&&u2(g),v=0,x=0,b,_;switch(xn.clear().union(m),m.clear(),(b=u[0])>-1&&m.union(r.items[b].bounds),(b=u[1])>-1&&m.union(r.items[b].bounds),s){case Hl:v=f||0,x=-c,_=Math.max(d,Math.min(h,-m.y1)),m.add(0,-_).add(l,0),g&&rm(e,g,_,p,y,0,-1,m);break;case ur:v=-c,x=f||0,_=Math.max(d,Math.min(h,-m.x1)),m.add(-_,0).add(0,l),g&&rm(e,g,_,p,y,1,-1,m);break;case lr:v=n+c,x=f||0,_=Math.max(d,Math.min(h,m.x2)),m.add(0,0).add(_,l),g&&rm(e,g,_,p,y,1,1,m);break;case qa:v=f||0,x=i+c,_=Math.max(d,Math.min(h,m.y2)),m.add(0,0).add(l,_),g&&rm(e,g,_,p,0,0,1,m);break;default:v=r.x,x=r.y}return jo(m.translate(v,x),r),Gl(r,"x",v+a)|Gl(r,"y",x+a)&&(r.bounds=xn,e.dirty(r),r.bounds=m,e.dirty(r)),r.mark.bounds.clear().union(m)}function rm(e,t,n,i,r,o,a,s){const u=t.bounds;if(t.auto){const l=a*(n+r+i);let c=0,f=0;e.dirty(t),o?c=(t.x||0)-(t.x=l):f=(t.y||0)-(t.y=l),t.mark.bounds.clear().union(u.translate(-c,-f)),e.dirty(t)}s.union(u)}const xN=(e,t)=>Math.floor(Math.min(e,t)),wN=(e,t)=>Math.ceil(Math.max(e,t));function SX(e){var t=e.items,n=t.length,i=0,r,o;const a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=t[i],o=r.items,r.marktype===tm)switch(r.role){case D2:case R2:case N2:break;case iN:a.rowheaders.push(...o);break;case rN:a.rowfooters.push(...o);break;case aN:a.colheaders.push(...o);break;case sN:a.colfooters.push(...o);break;case oN:a.rowtitle=o[0];break;case uN:a.coltitle=o[0];break;default:a.marks.push(...o)}return a}function AX(e){return new Nt().set(0,0,e.width||0,e.height||0)}function kX(e){const t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function dt(e,t,n){const i=Q(e)?e[t]:e;return i!=null?i:n!==void 0?n:0}function _N(e){return e<0?Math.ceil(-e):0}function EN(e,t,n){var i=!n.nodirty,r=n.bounds===L2?AX:kX,o=xn.set(0,0,0,0),a=dt(n.align,Wa),s=dt(n.align,Ha),u=dt(n.padding,Wa),l=dt(n.padding,Ha),c=n.columns||t.length,f=c<=0?1:Math.ceil(t.length/c),d=t.length,h=Array(d),g=Array(c),p=0,m=Array(d),y=Array(f),v=0,x=Array(d),b=Array(d),_=Array(d),E,w,O,S,k,A,M,C,D,F,N;for(w=0;w<c;++w)g[w]=0;for(w=0;w<f;++w)y[w]=0;for(w=0;w<d;++w)A=t[w],k=_[w]=r(A),A.x=A.x||0,x[w]=0,A.y=A.y||0,b[w]=0,O=w%c,S=~~(w/c),p=Math.max(p,M=Math.ceil(k.x2)),v=Math.max(v,C=Math.ceil(k.y2)),g[O]=Math.max(g[O],M),y[S]=Math.max(y[S],C),h[w]=u+_N(k.x1),m[w]=l+_N(k.y1),i&&e.dirty(t[w]);for(w=0;w<d;++w)w%c==0&&(h[w]=0),w<c&&(m[w]=0);if(a===$2)for(O=1;O<c;++O){for(N=0,w=O;w<d;w+=c)N<h[w]&&(N=h[w]);for(w=O;w<d;w+=c)h[w]=N+g[O-1]}else if(a===nm){for(N=0,w=0;w<d;++w)w%c&&N<h[w]&&(N=h[w]);for(w=0;w<d;++w)w%c&&(h[w]=N+p)}else for(a=!1,O=1;O<c;++O)for(w=O;w<d;w+=c)h[w]+=g[O-1];if(s===$2)for(S=1;S<f;++S){for(N=0,w=S*c,E=w+c;w<E;++w)N<m[w]&&(N=m[w]);for(w=S*c;w<E;++w)m[w]=N+y[S-1]}else if(s===nm){for(N=0,w=c;w<d;++w)N<m[w]&&(N=m[w]);for(w=c;w<d;++w)m[w]=N+v}else for(s=!1,S=1;S<f;++S)for(w=S*c,E=w+c;w<E;++w)m[w]+=y[S-1];for(D=0,w=0;w<d;++w)D=h[w]+(w%c?D:0),x[w]+=D-t[w].x;for(O=0;O<c;++O)for(F=0,w=O;w<d;w+=c)F+=m[w],b[w]+=F-t[w].y;if(a&&dt(n.center,Wa)&&f>1)for(w=0;w<d;++w)k=a===nm?p:g[w%c],D=k-_[w].x2-t[w].x-x[w],D>0&&(x[w]+=D/2);if(s&&dt(n.center,Ha)&&c!==1)for(w=0;w<d;++w)k=s===nm?v:y[~~(w/c)],F=k-_[w].y2-t[w].y-b[w],F>0&&(b[w]+=F/2);for(w=0;w<d;++w)o.union(_[w].translate(x[w],b[w]));switch(D=dt(n.anchor,lX),F=dt(n.anchor,cX),dt(n.anchor,Wa)){case Fn:D-=o.width();break;case M2:D-=o.width()/2}switch(dt(n.anchor,Ha)){case Fn:F-=o.height();break;case M2:F-=o.height()/2}for(D=Math.round(D),F=Math.round(F),o.clear(),w=0;w<d;++w)t[w].mark.bounds.clear();for(w=0;w<d;++w)A=t[w],A.x+=x[w]+=D,A.y+=b[w]+=F,o.union(A.mark.bounds.union(A.bounds.translate(x[w],b[w]))),i&&e.dirty(A);return o}function CX(e,t,n){var i=SX(t),r=i.marks,o=n.bounds===L2?TX:FX,a=n.offset,s=n.columns||r.length,u=s<=0?1:Math.ceil(r.length/s),l=u*s,c,f,d,h,g,p,m;const y=EN(e,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(p=dt(n.headerBand,Ha,null),c=om(e,i.rowheaders,r,s,u,-dt(a,"rowHeader"),xN,0,o,"x1",0,s,1,p)),i.colheaders&&(p=dt(n.headerBand,Wa,null),f=om(e,i.colheaders,r,s,s,-dt(a,"columnHeader"),xN,1,o,"y1",0,1,s,p)),i.rowfooters&&(p=dt(n.footerBand,Ha,null),d=om(e,i.rowfooters,r,s,u,dt(a,"rowFooter"),wN,0,o,"x2",s-1,s,1,p)),i.colfooters&&(p=dt(n.footerBand,Wa,null),h=om(e,i.colfooters,r,s,s,dt(a,"columnFooter"),wN,1,o,"y2",l-s,1,s,p)),i.rowtitle&&(g=dt(n.titleAnchor,Ha),m=dt(a,"rowTitle"),m=g===Fn?d+m:c-m,p=dt(n.titleBand,Ha,.5),ON(e,i.rowtitle,m,0,y,p)),i.coltitle&&(g=dt(n.titleAnchor,Wa),m=dt(a,"columnTitle"),m=g===Fn?h+m:f-m,p=dt(n.titleBand,Wa,.5),ON(e,i.coltitle,m,1,y,p))}function TX(e,t){return t==="x1"?e.x||0:t==="y1"?e.y||0:t==="x2"?(e.x||0)+(e.width||0):t==="y2"?(e.y||0)+(e.height||0):void 0}function FX(e,t){return e.bounds[t]}function om(e,t,n,i,r,o,a,s,u,l,c,f,d,h){var g=n.length,p=0,m=0,y,v,x,b,_,E,w,O,S;if(!g)return p;for(y=c;y<g;y+=f)n[y]&&(p=a(p,u(n[y],l)));if(!t.length)return p;for(t.length>r&&(e.warn("Grid headers exceed limit: "+r),t=t.slice(0,r)),p+=o,v=0,b=t.length;v<b;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(y=c,v=0,b=t.length;v<b;++v,y+=f){for(E=t[v],_=E.mark.bounds,x=y;x>=0&&(w=n[x])==null;x-=d);s?(O=h==null?w.x:Math.round(w.bounds.x1+h*w.bounds.width()),S=p):(O=p,S=h==null?w.y:Math.round(w.bounds.y1+h*w.bounds.height())),_.union(E.bounds.translate(O-(E.x||0),S-(E.y||0))),E.x=O,E.y=S,e.dirty(E),m=a(m,_[l])}return m}function ON(e,t,n,i,r,o){if(!!t){e.dirty(t);var a=n,s=n;i?a=Math.round(r.x1+o*r.width()):s=Math.round(r.y1+o*r.height()),t.bounds.translate(a-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=a,t.y=s,e.dirty(t)}}function MX(e,t){const n=e[t]||{};return(i,r)=>n[i]!=null?n[i]:e[i]!=null?e[i]:r}function DX(e,t){let n=-1/0;return e.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:t}function NX(e,t,n,i,r,o,a){const s=MX(n,t),u=DX(e,s("offset",0)),l=s("anchor",F2),c=l===Fn?1:l===M2?.5:0,f={align:$2,bounds:s("bounds",L2),columns:s("direction")==="vertical"?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case ur:f.anchor={x:Math.floor(i.x1)-u,column:Fn,y:c*(a||i.height()+2*i.y1),row:l};break;case lr:f.anchor={x:Math.ceil(i.x2)+u,y:c*(a||i.height()+2*i.y1),row:l};break;case Hl:f.anchor={y:Math.floor(r.y1)-u,row:Fn,x:c*(o||r.width()+2*r.x1),column:l};break;case qa:f.anchor={y:Math.ceil(r.y2)+u,x:c*(o||r.width()+2*r.x1),column:l};break;case oX:f.anchor={x:u,y:u};break;case aX:f.anchor={x:o-u,y:u,column:Fn};break;case sX:f.anchor={x:u,y:a-u,row:Fn};break;case uX:f.anchor={x:o-u,y:a-u,column:Fn,row:Fn};break}return f}function RX(e,t){var n=t.items[0],i=n.datum,r=n.orient,o=n.bounds,a=n.x,s=n.y,u,l;return n._bounds?n._bounds.clear().union(o):n._bounds=o.clone(),o.clear(),$X(e,n,n.items[0].items[0]),o=jX(n,o),u=2*n.padding,l=2*n.padding,o.empty()||(u=Math.ceil(o.width()+u),l=Math.ceil(o.height()+l)),i.type===gX&&LX(n.items[0].items[0].items[0].items),r!==j2&&(n.x=a=0,n.y=s=0),n.width=u,n.height=l,jo(o.set(a,s,a+u,s+l),n),n.mark.bounds.clear().union(o),n}function jX(e,t){return e.items.forEach(n=>t.union(n.bounds)),t.x1=e.padding,t.y1=e.padding,t}function $X(e,t,n){var i=t.padding,r=i-n.x,o=i-n.y;if(!t.datum.title)(r||o)&&xd(e,n,r,o);else{var a=t.items[1].items[0],s=a.anchor,u=t.titlePadding||0,l=i-a.x,c=i-a.y;switch(a.orient){case ur:r+=Math.ceil(a.bounds.width())+u;break;case lr:case qa:break;default:o+=a.bounds.height()+u}switch((r||o)&&xd(e,n,r,o),a.orient){case ur:c+=Vl(t,n,a,s,1,1);break;case lr:l+=Vl(t,n,a,Fn,0,0)+u,c+=Vl(t,n,a,s,1,1);break;case qa:l+=Vl(t,n,a,s,0,0),c+=Vl(t,n,a,Fn,-1,0,1)+u;break;default:l+=Vl(t,n,a,s,0,0)}(l||c)&&xd(e,a,l,c),(l=Math.round(a.bounds.x1-i))<0&&(xd(e,n,-l,0),xd(e,a,-l,0))}}function Vl(e,t,n,i,r,o,a){const s=e.datum.type!=="symbol",u=n.datum.vgrad,l=s&&(o||!u)&&!a?t.items[0]:t,c=l.bounds[r?"y2":"x2"]-e.padding,f=u&&o?c:0,d=u&&o?0:c,h=r<=0?0:u2(n);return Math.round(i===F2?f:i===Fn?d-h:.5*(c-h))}function xd(e,t,n,i){t.x+=n,t.y+=i,t.bounds.translate(n,i),t.mark.bounds.translate(n,i),e.dirty(t)}function LX(e){const t=e.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});e.forEach(n=>{n.width=t[n.column],n.height=n.bounds.y2-n.y})}function IX(e,t,n,i,r){var o=t.items[0],a=o.frame,s=o.orient,u=o.anchor,l=o.offset,c=o.padding,f=o.items[0].items[0],d=o.items[1]&&o.items[1].items[0],h=s===ur||s===lr?i:n,g=0,p=0,m=0,y=0,v=0,x;if(a!==tm?s===ur?(g=r.y2,h=r.y1):s===lr?(g=r.y1,h=r.y2):(g=r.x1,h=r.x2):s===ur&&(g=i,h=0),x=u===F2?g:u===Fn?h:(g+h)/2,d&&d.text){switch(s){case Hl:case qa:v=f.bounds.height()+c;break;case ur:y=f.bounds.width()+c;break;case lr:y=-f.bounds.width()-c;break}xn.clear().union(d.bounds),xn.translate(y-(d.x||0),v-(d.y||0)),Gl(d,"x",y)|Gl(d,"y",v)&&(e.dirty(d),d.bounds.clear().union(xn),d.mark.bounds.clear().union(xn),e.dirty(d)),xn.clear().union(d.bounds)}else xn.clear();switch(xn.union(f.bounds),s){case Hl:p=x,m=r.y1-xn.height()-l;break;case ur:p=r.x1-xn.width()-l,m=x;break;case lr:p=r.x2+xn.width()+l,m=x;break;case qa:p=x,m=r.y2+l;break;default:p=o.x,m=o.y}return Gl(o,"x",p)|Gl(o,"y",m)&&(xn.translate(p,m),e.dirty(o),o.bounds.clear().union(xn),t.bounds.clear().union(xn),e.dirty(o)),o.bounds}function SN(e){R.call(this,null,e)}W(SN,R,{transform(e,t){const n=t.dataflow;return e.mark.items.forEach(i=>{e.layout&&CX(n,i,e.layout),zX(n,i,e)}),PX(e.mark.group)?t.reflow():t}});function PX(e){return e&&e.mark.role!=="legend-entry"}function zX(e,t,n){var i=t.items,r=Math.max(0,t.width||0),o=Math.max(0,t.height||0),a=new Nt().set(0,0,r,o),s=a.clone(),u=a.clone(),l=[],c,f,d,h,g,p;for(g=0,p=i.length;g<p;++g)switch(f=i[g],f.role){case D2:h=_X(f)?s:u,h.union(OX(e,f,r,o));break;case N2:c=f;break;case R2:l.push(RX(e,f));break;case fX:case dX:case iN:case rN:case oN:case aN:case sN:case uN:s.union(f.bounds),u.union(f.bounds);break;default:a.union(f.bounds)}if(l.length){const m={};l.forEach(y=>{d=y.orient||lr,d!==j2&&(m[d]||(m[d]=[])).push(y)});for(const y in m){const v=m[y];EN(e,v,NX(v,y,n.legends,s,u,r,o))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,e.dirty(y),y.bounds=v,e.dirty(y)),n.autosize&&n.autosize.type===lN)switch(y.orient){case ur:case lr:a.add(v.x1,0).add(v.x2,0);break;case Hl:case qa:a.add(0,v.y1).add(0,v.y2)}else a.union(v)})}a.union(s).union(u),c&&a.union(IX(e,c,r,o,a)),t.clip&&a.set(0,0,t.width||0,t.height||0),BX(e,t,a,n)}function BX(e,t,n,i){const r=i.autosize||{},o=r.type;if(e._autosize<1||!o)return;let a=e._width,s=e._height,u=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1));const d=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,Math.ceil(n.y2-c));if(r.contains===hX){const g=e.padding();a-=g.left+g.right,s-=g.top+g.bottom}o===j2?(l=0,f=0,u=a,c=s):o===lN?(u=Math.max(0,a-l-d),c=Math.max(0,s-f-h)):o===pX?(u=Math.max(0,a-l-d),s=c+f+h):o===mX?(a=u+l+d,c=Math.max(0,s-f-h)):o===yX&&(a=u+l+d,s=c+f+h),e._resizeView(a,s,u,c,[l,f],r.resize)}var UX=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:cN,identifier:I2,mark:dN,overlap:hN,render:bN,viewlayout:SN});function AN(e){R.call(this,null,e)}W(AN,R,{transform(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.scale,a=e.count==null?e.values?e.values.length:10:e.count,s=Dx(o,a,e.minstep),u=e.format||kD(n,o,s,e.formatSpecifier,e.formatType,!!e.values),l=e.values?AD(o,e.values,s):Nx(o,s);return r&&(i.rem=r),r=l.map((c,f)=>Ue({index:f/(l.length-1||1),value:c,label:u(c)})),e.extra&&r.length&&r.push(Ue({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function kN(e){R.call(this,null,e)}function qX(){return Ue({})}function WX(e){const t=gl().test(n=>n.exit);return t.lookup=n=>t.get(e(n)),t}W(kN,R,{transform(e,t){var n=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||qX,o=e.key||ae,a=this.value;return P(i.encode)&&(i.encode=null),a&&(e.modified("key")||t.modified(o))&&L("DataJoin does not support modified key function or fields."),a||(t=t.addAll(),this.value=a=WX(o)),t.visit(t.ADD,s=>{const u=o(s);let l=a.get(u);l?l.exit?(a.empty--,i.add.push(l)):i.mod.push(l):(l=r(s),a.set(u,l),i.add.push(l)),l.datum=s,l.exit=!1}),t.visit(t.MOD,s=>{const u=o(s),l=a.get(u);l&&(l.datum=s,i.mod.push(l))}),t.visit(t.REM,s=>{const u=o(s),l=a.get(u);s===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++a.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),i}});function CN(e){R.call(this,null,e)}W(CN,R,{transform(e,t){var n=t.fork(t.ADD_REM),i=e.mod||!1,r=e.encoders,o=t.encode;if(P(o))if(n.changed()||o.every(f=>r[f]))o=o[0],n.encode=null;else return t.StopPropagation;var a=o==="enter",s=r.update||ha,u=r.enter||ha,l=r.exit||ha,c=(o&&!a?r[o]:s)||ha;if(t.changed(t.ADD)&&(t.visit(t.ADD,f=>{u(f,e),s(f,e)}),n.modifies(u.output),n.modifies(s.output),c!==ha&&c!==s&&(t.visit(t.ADD,f=>{c(f,e)}),n.modifies(c.output))),t.changed(t.REM)&&l!==ha&&(t.visit(t.REM,f=>{l(f,e)}),n.modifies(l.output)),a||c!==ha){const f=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(f,d=>{const h=u(d,e)||i;(c(d,e)||h)&&n.mod.push(d)}),n.mod.length&&n.modifies(u.output)):t.visit(f,d=>{(c(d,e)||i)&&n.mod.push(d)}),n.mod.length&&n.modifies(c.output)}return n.changed()?n:t.StopPropagation}});function TN(e){R.call(this,[],e)}W(TN,R,{transform(e,t){if(this.value!=null&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,o=e.type||Ap,a=e.scale,s=+e.limit,u=Dx(a,e.count==null?5:e.count,e.minstep),l=!!e.values||o===Ap,c=e.format||MD(n,a,u,o,e.formatSpecifier,e.formatType,l),f=e.values||FD(a,u),d,h,g,p,m;return r&&(i.rem=r),o===Ap?(s&&f.length>s?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=f.slice(0,s-1),m=!0):r=f,_e(g=e.size)?(!e.values&&a(r[0])===0&&(r=r.slice(1)),p=r.reduce((y,v)=>Math.max(y,g(v,e)),0)):g=gn(p=g||8),r=r.map((y,v)=>Ue({index:v,label:c(y,v,r),value:y,offset:p,size:g(y,e)})),m&&(m=f[r.length],r.push(Ue({index:r.length,label:"\u2026".concat(f.length-r.length," entries"),value:m,offset:p,size:g(m,e)})))):o===wG?(d=a.domain(),h=_D(a,d[0],Fe(d)),f.length<3&&!e.values&&d[0]!==Fe(d)&&(f=[d[0],Fe(d)]),r=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:h(y)}))):(g=f.length-1,h=DG(a),r=f.map((y,v)=>Ue({index:v,label:c(y,v,f),value:y,perc:v?h(y):0,perc2:v===g?1:h(f[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const HX=e=>e.source.x,GX=e=>e.source.y,VX=e=>e.target.x,YX=e=>e.target.y;function P2(e){R.call(this,{},e)}P2.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};W(P2,R,{transform(e,t){var n=e.sourceX||HX,i=e.sourceY||GX,r=e.targetX||VX,o=e.targetY||YX,a=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",l=NN.get(u+"-"+s)||NN.get(u);return l||L("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,c=>{c[a]=l(n(c),i(c),r(c),o(c))}),t.reflow(e.modified()).modifies(a)}});const FN=(e,t,n,i)=>"M"+e+","+t+"L"+n+","+i,XX=(e,t,n,i)=>FN(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),MN=(e,t,n,i)=>{var r=n-e,o=i-t,a=Math.sqrt(r*r+o*o)/2,s=180*Math.atan2(o,r)/Math.PI;return"M"+e+","+t+"A"+a+","+a+" "+s+" 0 1 "+n+","+i},KX=(e,t,n,i)=>MN(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),DN=(e,t,n,i)=>{const r=n-e,o=i-t,a=.2*(r+o),s=.2*(o-r);return"M"+e+","+t+"C"+(e+a)+","+(t+s)+" "+(n+s)+","+(i-a)+" "+n+","+i},JX=(e,t,n,i)=>DN(t*Math.cos(e),t*Math.sin(e),i*Math.cos(n),i*Math.sin(n)),QX=(e,t,n,i)=>"M"+e+","+t+"V"+i+"H"+n,ZX=(e,t,n,i)=>"M"+e+","+t+"H"+n+"V"+i,eK=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*r+","+t*o+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*a+","+t*s+"L"+i*a+","+i*s},tK=(e,t,n,i)=>{const r=(e+n)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+i+" "+n+","+i},nK=(e,t,n,i)=>{const r=(t+i)/2;return"M"+e+","+t+"C"+e+","+r+" "+n+","+r+" "+n+","+i},iK=(e,t,n,i)=>{const r=Math.cos(e),o=Math.sin(e),a=Math.cos(n),s=Math.sin(n),u=(t+i)/2;return"M"+t*r+","+t*o+"C"+u*r+","+u*o+" "+u*a+","+u*s+" "+i*a+","+i*s},NN=gl({line:FN,"line-radial":XX,arc:MN,"arc-radial":KX,curve:DN,"curve-radial":JX,"orthogonal-horizontal":QX,"orthogonal-vertical":ZX,"orthogonal-radial":eK,"diagonal-horizontal":tK,"diagonal-vertical":nK,"diagonal-radial":iK});function z2(e){R.call(this,null,e)}z2.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};W(z2,R,{transform(e,t){var n=e.as||["startAngle","endAngle"],i=n[0],r=n[1],o=e.field||fl,a=e.startAngle||0,s=e.endAngle!=null?e.endAngle:2*Math.PI,u=t.source,l=u.map(o),c=l.length,f=a,d=(s-a)/bC(l),h=yi(c),g,p,m;for(e.sort&&h.sort((y,v)=>l[y]-l[v]),g=0;g<c;++g)m=l[h[g]],p=u[h[g]],p[i]=f,p[r]=f+=m*d;return this.value=l,t.reflow(e.modified()).modifies(n)}});const rK=5;function oK(e){const t=e.type;return!e.bins&&(t===Rl||t===Qf||t===Zf)}function RN(e){return Cx(e)&&e!==Wr}const aK=nr(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function jN(e){R.call(this,null,e),this.modified(!0)}W(jN,R,{transform(e,t){var n=t.dataflow,i=this.value,r=sK(e);(!i||r!==i.type)&&(this.value=i=Ie(r)());for(r in e)if(!aK[r]){if(r==="padding"&&RN(i.type))continue;_e(i[r])?i[r](e[r]):n.warn("Unsupported scale property: "+r)}return hK(i,e,dK(i,e,lK(i,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function sK(e){var t=e.type,n="",i;return t===Wr?Wr+"-"+Rl:(uK(e)&&(i=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(e.domainMid!=null):0,n=i===2?Wr+"-":i===3?jl+"-":""),(n+t||Rl).toLowerCase())}function uK(e){const t=e.type;return Cx(t)&&t!==Ws&&t!==Hs&&(e.scheme||e.range&&e.range.length&&e.range.every(K))}function lK(e,t,n){const i=cK(e,t.domainRaw,n);if(i>-1)return i;var r=t.domain,o=e.type,a=t.zero||t.zero===void 0&&oK(e),s,u;if(!r)return 0;if(RN(o)&&t.padding&&r[0]!==Fe(r)&&(r=fK(o,r,t.range,t.padding,t.exponent,t.constant)),(a||t.domainMin!=null||t.domainMax!=null||t.domainMid!=null)&&(s=(r=r.slice()).length-1||1,a&&(r[0]>0&&(r[0]=0),r[s]<0&&(r[s]=0)),t.domainMin!=null&&(r[0]=t.domainMin),t.domainMax!=null&&(r[s]=t.domainMax),t.domainMid!=null)){u=t.domainMid;const l=u>r[s]?s+1:u<r[0]?0:s;l!==s&&n.warn("Scale domainMid exceeds domain min or max.",u),r.splice(l,0,u)}return e.domain($N(o,r,n)),o===Ex&&e.unknown(t.domainImplicit?Yb:void 0),t.nice&&e.nice&&e.nice(t.nice!==!0&&Dx(e,t.nice)||null),r.length}function cK(e,t,n){return t?(e.domain($N(e.type,t,n)),t.length):-1}function fK(e,t,n,i,r,o){var a=Math.abs(Fe(n)-n[0]),s=a/(a-2*i),u=e===No?Gy(t,null,s):e===Zf?Ag(t,null,s,.5):e===Qf?Ag(t,null,s,r||1):e===wp?Vy(t,null,s,o||1):Hy(t,null,s);return t=t.slice(),t[0]=u[0],t[t.length-1]=u[1],t}function $N(e,t,n){if(yD(e)){var i=Math.abs(t.reduce((r,o)=>r+(o<0?-1:o>0?1:0),0));i!==t.length&&n.warn("Log scale domain includes zero: "+H(t))}return t}function dK(e,t,n){let i=t.bins;if(i&&!P(i)){const r=e.domain(),o=r[0],a=Fe(r),s=i.step;let u=i.start==null?o:i.start,l=i.stop==null?a:i.stop;s||L("Scale bins parameter missing step property."),u<o&&(u=s*Math.ceil(o/s)),l>a&&(l=s*Math.floor(a/s)),i=yi(u,l+s/2,s)}return i?e.bins=i:e.bins&&delete e.bins,e.type===Sx&&(i?!t.domain&&!t.domainRaw&&(e.domain(i),n=i.length):e.bins=e.domain()),n}function hK(e,t,n){var i=e.type,r=t.round||!1,o=t.range;if(t.rangeStep!=null)o=gK(i,t,n);else if(t.scheme&&(o=pK(i,t,n),_e(o))){if(e.interpolator)return e.interpolator(o);L("Scale type ".concat(i," does not support interpolating color schemes."))}if(o&&vD(i))return e.interpolator(Sp(B2(o,t.reverse),t.interpolate,t.interpolateGamma));o&&t.interpolate&&e.interpolate?e.interpolate(Fx(t.interpolate,t.interpolateGamma)):_e(e.round)?e.round(r):_e(e.rangeRound)&&e.interpolate(r?Kf:Ma),o&&e.range(B2(o,t.reverse))}function gK(e,t,n){e!==hD&&e!==Ox&&L("Only band and point scales support rangeStep.");var i=(t.paddingOuter!=null?t.paddingOuter:t.padding)||0,r=e===Ox?1:(t.paddingInner!=null?t.paddingInner:t.padding)||0;return[0,t.rangeStep*_x(n,r,i)]}function pK(e,t,n){var i=t.schemeExtent,r,o;return P(t.scheme)?o=Sp(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),o=Mx(r),o||L("Unrecognized scheme name: ".concat(t.scheme))),n=e===Ep?n+1:e===Sx?n-1:e===$l||e===_p?+t.schemeCount||rK:n,vD(e)?LN(o,i,t.reverse):_e(o)?wD(LN(o,i),n):e===Ex?o:o.slice(0,n)}function LN(e,t,n){return _e(e)&&(t||n)?xD(e,B2(t||[0,1],n)):e}function B2(e,t){return t?e.slice().reverse():e}function IN(e){R.call(this,null,e)}W(IN,R,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort($s(e.sort)),this.modified(n),t}});const PN="zero",zN="center",BN="normalize",UN=["y0","y1"];function U2(e){R.call(this,null,e)}U2.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:PN,values:[PN,zN,BN]},{name:"as",type:"string",array:!0,length:2,default:UN}]};W(U2,R,{transform(e,t){var n=e.as||UN,i=n[0],r=n[1],o=$s(e.sort),a=e.field||fl,s=e.offset===zN?mK:e.offset===BN?yK:vK,u,l,c,f;for(u=bK(t.source,e.groupby,o,a),l=0,c=u.length,f=u.max;l<c;++l)s(u[l],f,a,i,r);return t.reflow(e.modified()).modifies(n)}});function mK(e,t,n,i,r){for(var o=(t-e.sum)/2,a=e.length,s=0,u;s<a;++s)u=e[s],u[i]=o,u[r]=o+=Math.abs(n(u))}function yK(e,t,n,i,r){for(var o=1/e.sum,a=0,s=e.length,u=0,l=0,c;u<s;++u)c=e[u],c[i]=a,c[r]=a=o*(l+=Math.abs(n(c)))}function vK(e,t,n,i,r){for(var o=0,a=0,s=e.length,u=0,l,c;u<s;++u)c=e[u],l=+n(c),l<0?(c[i]=a,c[r]=a+=l):(c[i]=o,c[r]=o+=l)}function bK(e,t,n,i){var r=[],o=p=>p(c),a,s,u,l,c,f,d,h,g;if(t==null)r.push(e.slice());else for(a={},s=0,u=e.length;s<u;++s)c=e[s],f=t.map(o),d=a[f],d||(a[f]=d=[],r.push(d)),d.push(c);for(f=0,g=0,l=r.length;f<l;++f){for(d=r[f],s=0,h=0,u=d.length;s<u;++s)h+=Math.abs(i(d[s]));d.sum=h,h>g&&(g=h),n&&d.sort(n)}return r.max=g,r}var xK=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:AN,datajoin:kN,encode:CN,legendentries:TN,linkpath:P2,pie:z2,scale:jN,sortitems:IN,stack:U2}),le=1e-6,am=1e-12,Se=Math.PI,vt=Se/2,sm=Se/4,Mn=Se*2,_t=180/Se,Ae=Se/180,Ne=Math.abs,Yl=Math.atan,Pi=Math.atan2,ce=Math.cos,um=Math.ceil,qN=Math.exp,q2=Math.hypot,lm=Math.log,W2=Math.pow,se=Math.sin,zi=Math.sign||function(e){return e>0?1:e<0?-1:0},Dn=Math.sqrt,H2=Math.tan;function WN(e){return e>1?0:e<-1?Se:Math.acos(e)}function ei(e){return e>1?vt:e<-1?-vt:Math.asin(e)}function en(){}function cm(e,t){e&&GN.hasOwnProperty(e.type)&&GN[e.type](e,t)}var HN={Feature:function(e,t){cm(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)cm(n[i].geometry,t)}},GN={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){G2(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)G2(n[i],t,0)},Polygon:function(e,t){VN(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)VN(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)cm(n[i],t)}};function G2(e,t,n){var i=-1,r=e.length-n,o;for(t.lineStart();++i<r;)o=e[i],t.point(o[0],o[1],o[2]);t.lineEnd()}function VN(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)G2(e[n],t,1);t.polygonEnd()}function Lo(e,t){e&&HN.hasOwnProperty(e.type)?HN[e.type](e,t):cm(e,t)}var fm=new Cn,dm=new Cn,YN,XN,V2,Y2,X2,Kr={point:en,lineStart:en,lineEnd:en,polygonStart:function(){fm=new Cn,Kr.lineStart=wK,Kr.lineEnd=_K},polygonEnd:function(){var e=+fm;dm.add(e<0?Mn+e:e),this.lineStart=this.lineEnd=this.point=en},sphere:function(){dm.add(Mn)}};function wK(){Kr.point=EK}function _K(){KN(YN,XN)}function EK(e,t){Kr.point=KN,YN=e,XN=t,e*=Ae,t*=Ae,V2=e,Y2=ce(t=t/2+sm),X2=se(t)}function KN(e,t){e*=Ae,t*=Ae,t=t/2+sm;var n=e-V2,i=n>=0?1:-1,r=i*n,o=ce(t),a=se(t),s=X2*a,u=Y2*o+s*ce(r),l=s*i*se(r);fm.add(Pi(l,u)),V2=e,Y2=o,X2=a}function OK(e){return dm=new Cn,Lo(e,Kr),dm*2}function hm(e){return[Pi(e[1],e[0]),ei(e[2])]}function Qs(e){var t=e[0],n=e[1],i=ce(n);return[i*ce(t),i*se(t),se(n)]}function gm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Xl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function K2(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function pm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function mm(e){var t=Dn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var gt,ti,bt,wi,Zs,JN,QN,Kl,wd,Ga,Io,Po={point:J2,lineStart:e5,lineEnd:t5,polygonStart:function(){Po.point=n5,Po.lineStart=SK,Po.lineEnd=AK,wd=new Cn,Kr.polygonStart()},polygonEnd:function(){Kr.polygonEnd(),Po.point=J2,Po.lineStart=e5,Po.lineEnd=t5,fm<0?(gt=-(bt=180),ti=-(wi=90)):wd>le?wi=90:wd<-le&&(ti=-90),Io[0]=gt,Io[1]=bt},sphere:function(){gt=-(bt=180),ti=-(wi=90)}};function J2(e,t){Ga.push(Io=[gt=e,bt=e]),t<ti&&(ti=t),t>wi&&(wi=t)}function ZN(e,t){var n=Qs([e*Ae,t*Ae]);if(Kl){var i=Xl(Kl,n),r=[i[1],-i[0],0],o=Xl(r,i);mm(o),o=hm(o);var a=e-Zs,s=a>0?1:-1,u=o[0]*_t*s,l,c=Ne(a)>180;c^(s*Zs<u&&u<s*e)?(l=o[1]*_t,l>wi&&(wi=l)):(u=(u+360)%360-180,c^(s*Zs<u&&u<s*e)?(l=-o[1]*_t,l<ti&&(ti=l)):(t<ti&&(ti=t),t>wi&&(wi=t))),c?e<Zs?_i(gt,e)>_i(gt,bt)&&(bt=e):_i(e,bt)>_i(gt,bt)&&(gt=e):bt>=gt?(e<gt&&(gt=e),e>bt&&(bt=e)):e>Zs?_i(gt,e)>_i(gt,bt)&&(bt=e):_i(e,bt)>_i(gt,bt)&&(gt=e)}else Ga.push(Io=[gt=e,bt=e]);t<ti&&(ti=t),t>wi&&(wi=t),Kl=n,Zs=e}function e5(){Po.point=ZN}function t5(){Io[0]=gt,Io[1]=bt,Po.point=J2,Kl=null}function n5(e,t){if(Kl){var n=e-Zs;wd.add(Ne(n)>180?n+(n>0?360:-360):n)}else JN=e,QN=t;Kr.point(e,t),ZN(e,t)}function SK(){Kr.lineStart()}function AK(){n5(JN,QN),Kr.lineEnd(),Ne(wd)>le&&(gt=-(bt=180)),Io[0]=gt,Io[1]=bt,Kl=null}function _i(e,t){return(t-=e)<0?t+360:t}function kK(e,t){return e[0]-t[0]}function i5(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function CK(e){var t,n,i,r,o,a,s;if(wi=bt=-(gt=ti=1/0),Ga=[],Lo(e,Po),n=Ga.length){for(Ga.sort(kK),t=1,i=Ga[0],o=[i];t<n;++t)r=Ga[t],i5(i,r[0])||i5(i,r[1])?(_i(i[0],r[1])>_i(i[0],i[1])&&(i[1]=r[1]),_i(r[0],i[1])>_i(i[0],i[1])&&(i[0]=r[0])):o.push(i=r);for(a=-1/0,n=o.length-1,t=0,i=o[n];t<=n;i=r,++t)r=o[t],(s=_i(i[1],r[0]))>a&&(a=s,gt=r[0],bt=i[1])}return Ga=Io=null,gt===1/0||ti===1/0?[[NaN,NaN],[NaN,NaN]]:[[gt,ti],[bt,wi]]}var _d,ym,vm,bm,xm,wm,_m,Em,Q2,Z2,ew,r5,o5,Nn,Rn,jn,cr={sphere:en,point:tw,lineStart:a5,lineEnd:s5,polygonStart:function(){cr.lineStart=MK,cr.lineEnd=DK},polygonEnd:function(){cr.lineStart=a5,cr.lineEnd=s5}};function tw(e,t){e*=Ae,t*=Ae;var n=ce(t);Ed(n*ce(e),n*se(e),se(t))}function Ed(e,t,n){++_d,vm+=(e-vm)/_d,bm+=(t-bm)/_d,xm+=(n-xm)/_d}function a5(){cr.point=TK}function TK(e,t){e*=Ae,t*=Ae;var n=ce(t);Nn=n*ce(e),Rn=n*se(e),jn=se(t),cr.point=FK,Ed(Nn,Rn,jn)}function FK(e,t){e*=Ae,t*=Ae;var n=ce(t),i=n*ce(e),r=n*se(e),o=se(t),a=Pi(Dn((a=Rn*o-jn*r)*a+(a=jn*i-Nn*o)*a+(a=Nn*r-Rn*i)*a),Nn*i+Rn*r+jn*o);ym+=a,wm+=a*(Nn+(Nn=i)),_m+=a*(Rn+(Rn=r)),Em+=a*(jn+(jn=o)),Ed(Nn,Rn,jn)}function s5(){cr.point=tw}function MK(){cr.point=NK}function DK(){u5(r5,o5),cr.point=tw}function NK(e,t){r5=e,o5=t,e*=Ae,t*=Ae,cr.point=u5;var n=ce(t);Nn=n*ce(e),Rn=n*se(e),jn=se(t),Ed(Nn,Rn,jn)}function u5(e,t){e*=Ae,t*=Ae;var n=ce(t),i=n*ce(e),r=n*se(e),o=se(t),a=Rn*o-jn*r,s=jn*i-Nn*o,u=Nn*r-Rn*i,l=q2(a,s,u),c=ei(l),f=l&&-c/l;Q2.add(f*a),Z2.add(f*s),ew.add(f*u),ym+=c,wm+=c*(Nn+(Nn=i)),_m+=c*(Rn+(Rn=r)),Em+=c*(jn+(jn=o)),Ed(Nn,Rn,jn)}function RK(e){_d=ym=vm=bm=xm=wm=_m=Em=0,Q2=new Cn,Z2=new Cn,ew=new Cn,Lo(e,cr);var t=+Q2,n=+Z2,i=+ew,r=q2(t,n,i);return r<am&&(t=wm,n=_m,i=Em,ym<le&&(t=vm,n=bm,i=xm),r=q2(t,n,i),r<am)?[NaN,NaN]:[Pi(n,t)*_t,ei(i/r)*_t]}function nw(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function iw(e,t){return[Ne(e)>Se?e+Math.round(-e/Mn)*Mn:e,t]}iw.invert=iw;function l5(e,t,n){return(e%=Mn)?t||n?nw(f5(e),d5(t,n)):f5(e):t||n?d5(t,n):iw}function c5(e){return function(t,n){return t+=e,[t>Se?t-Mn:t<-Se?t+Mn:t,n]}}function f5(e){var t=c5(e);return t.invert=c5(-e),t}function d5(e,t){var n=ce(e),i=se(e),r=ce(t),o=se(t);function a(s,u){var l=ce(u),c=ce(s)*l,f=se(s)*l,d=se(u),h=d*n+c*i;return[Pi(f*r-h*o,c*n-d*i),ei(h*r+f*o)]}return a.invert=function(s,u){var l=ce(u),c=ce(s)*l,f=se(s)*l,d=se(u),h=d*r-f*o;return[Pi(f*r+d*o,c*n+h*i),ei(h*n-c*i)]},a}function jK(e){e=l5(e[0]*Ae,e[1]*Ae,e.length>2?e[2]*Ae:0);function t(n){return n=e(n[0]*Ae,n[1]*Ae),n[0]*=_t,n[1]*=_t,n}return t.invert=function(n){return n=e.invert(n[0]*Ae,n[1]*Ae),n[0]*=_t,n[1]*=_t,n},t}function $K(e,t,n,i,r,o){if(!!n){var a=ce(t),s=se(t),u=i*n;r==null?(r=t+i*Mn,o=t-u/2):(r=h5(a,r),o=h5(a,o),(i>0?r<o:r>o)&&(r+=i*Mn));for(var l,c=r;i>0?c>o:c<o;c-=u)l=hm([a,-s*ce(c),-s*se(c)]),e.point(l[0],l[1])}}function h5(e,t){t=Qs(t),t[0]-=e,mm(t);var n=WN(-t[1]);return((-t[2]<0?-n:n)+Mn-le)%Mn}function g5(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:en,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Om(e,t){return Ne(e[0]-t[0])<le&&Ne(e[1]-t[1])<le}function Sm(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function p5(e,t,n,i,r){var o=[],a=[],s,u;if(e.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(Om(m,y)){if(!m[2]&&!y[2]){for(r.lineStart(),s=0;s<p;++s)r.point((m=g[s])[0],m[1]);r.lineEnd();return}y[0]+=2*le}o.push(v=new Sm(m,g,null,!0)),a.push(v.o=new Sm(m,null,v,!1)),o.push(v=new Sm(y,g,null,!1)),a.push(v.o=new Sm(y,null,v,!0))}}),!!o.length){for(a.sort(t),m5(o),m5(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var l=o[0],c,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;c=d.z,r.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(s=0,u=c.length;s<u;++s)r.point((f=c[s])[0],f[1]);else i(d.x,d.n.x,1,r);d=d.n}else{if(h)for(c=d.p.z,s=c.length-1;s>=0;--s)r.point((f=c[s])[0],f[1]);else i(d.x,d.p.x,-1,r);d=d.p}d=d.o,c=d.z,h=!h}while(!d.v);r.lineEnd()}}}function m5(e){if(!!(t=e.length)){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function rw(e){return Ne(e[0])<=Se?e[0]:zi(e[0])*((Ne(e[0])+Se)%Mn-Se)}function LK(e,t){var n=rw(t),i=t[1],r=se(i),o=[se(n),-ce(n),0],a=0,s=0,u=new Cn;r===1?i=vt+le:r===-1&&(i=-vt-le);for(var l=0,c=e.length;l<c;++l)if(!!(d=(f=e[l]).length))for(var f,d,h=f[d-1],g=rw(h),p=h[1]/2+sm,m=se(p),y=ce(p),v=0;v<d;++v,g=b,m=E,y=w,h=x){var x=f[v],b=rw(x),_=x[1]/2+sm,E=se(_),w=ce(_),O=b-g,S=O>=0?1:-1,k=S*O,A=k>Se,M=m*E;if(u.add(Pi(M*S*se(k),y*w+M*ce(k))),a+=A?O+S*Mn:O,A^g>=n^b>=n){var C=Xl(Qs(h),Qs(x));mm(C);var D=Xl(o,C);mm(D);var F=(A^O>=0?-1:1)*ei(D[2]);(i>F||i===F&&(C[0]||C[1]))&&(s+=A^O>=0?1:-1)}}return(a<-le||a<le&&u<-am)^s&1}function y5(e,t,n,i){return function(r){var o=t(r),a=g5(),s=t(a),u=!1,l,c,f,d={point:h,lineStart:p,lineEnd:m,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=x,c=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=m,c=vC(c);var b=LK(l,i);c.length?(u||(r.polygonStart(),u=!0),p5(c,PK,b,n,r)):b&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),c=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(b,_){e(b,_)&&r.point(b,_)}function g(b,_){o.point(b,_)}function p(){d.point=g,o.lineStart()}function m(){d.point=h,o.lineEnd()}function y(b,_){f.push([b,_]),s.point(b,_)}function v(){s.lineStart(),f=[]}function x(){y(f[0][0],f[0][1]),s.lineEnd();var b=s.clean(),_=a.result(),E,w=_.length,O,S,k;if(f.pop(),l.push(f),f=null,!!w){if(b&1){if(S=_[0],(O=S.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),E=0;E<O;++E)r.point((k=S[E])[0],k[1]);r.lineEnd()}return}w>1&&b&2&&_.push(_.pop().concat(_.shift())),c.push(_.filter(IK))}}return d}}function IK(e){return e.length>1}function PK(e,t){return((e=e.x)[0]<0?e[1]-vt-le:vt-e[1])-((t=t.x)[0]<0?t[1]-vt-le:vt-t[1])}var v5=y5(function(){return!0},zK,UK,[-Se,-vt]);function zK(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,a){var s=o>0?Se:-Se,u=Ne(o-t);Ne(u-Se)<le?(e.point(t,n=(n+a)/2>0?vt:-vt),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),e.point(o,n),r=0):i!==s&&u>=Se&&(Ne(t-i)<le&&(t-=i*le),Ne(o-s)<le&&(o-=s*le),n=BK(t,n,o,a),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(s,n),r=0),e.point(t=o,n=a),i=s},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function BK(e,t,n,i){var r,o,a=se(e-n);return Ne(a)>le?Yl((se(t)*(o=ce(i))*se(n)-se(i)*(r=ce(t))*se(e))/(r*o*a)):(t+i)/2}function UK(e,t,n,i){var r;if(e==null)r=n*vt,i.point(-Se,r),i.point(0,r),i.point(Se,r),i.point(Se,0),i.point(Se,-r),i.point(0,-r),i.point(-Se,-r),i.point(-Se,0),i.point(-Se,r);else if(Ne(e[0]-t[0])>le){var o=e[0]<t[0]?Se:-Se;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(t[0],t[1])}function qK(e){var t=ce(e),n=6*Ae,i=t>0,r=Ne(t)>le;function o(c,f,d,h){$K(h,e,n,d,c,f)}function a(c,f){return ce(c)*ce(f)>t}function s(c){var f,d,h,g,p;return{lineStart:function(){g=h=!1,p=1},point:function(m,y){var v=[m,y],x,b=a(m,y),_=i?b?0:l(m,y):b?l(m+(m<0?Se:-Se),y):0;if(!f&&(g=h=b)&&c.lineStart(),b!==h&&(x=u(f,v),(!x||Om(f,x)||Om(v,x))&&(v[2]=1)),b!==h)p=0,b?(c.lineStart(),x=u(v,f),c.point(x[0],x[1])):(x=u(f,v),c.point(x[0],x[1],2),c.lineEnd()),f=x;else if(r&&f&&i^b){var E;!(_&d)&&(E=u(v,f,!0))&&(p=0,i?(c.lineStart(),c.point(E[0][0],E[0][1]),c.point(E[1][0],E[1][1]),c.lineEnd()):(c.point(E[1][0],E[1][1]),c.lineEnd(),c.lineStart(),c.point(E[0][0],E[0][1],3)))}b&&(!f||!Om(f,v))&&c.point(v[0],v[1]),f=v,h=b,d=_},lineEnd:function(){h&&c.lineEnd(),f=null},clean:function(){return p|(g&&h)<<1}}}function u(c,f,d){var h=Qs(c),g=Qs(f),p=[1,0,0],m=Xl(h,g),y=gm(m,m),v=m[0],x=y-v*v;if(!x)return!d&&c;var b=t*y/x,_=-t*v/x,E=Xl(p,m),w=pm(p,b),O=pm(m,_);K2(w,O);var S=E,k=gm(w,S),A=gm(S,S),M=k*k-A*(gm(w,w)-1);if(!(M<0)){var C=Dn(M),D=pm(S,(-k-C)/A);if(K2(D,w),D=hm(D),!d)return D;var F=c[0],N=f[0],I=c[1],z=f[1],X;N<F&&(X=F,F=N,N=X);var te=N-F,xe=Ne(te-Se)<le,ge=xe||te<le;if(!xe&&z<I&&(X=I,I=z,z=X),ge?xe?I+z>0^D[1]<(Ne(D[0]-F)<le?I:z):I<=D[1]&&D[1]<=z:te>Se^(F<=D[0]&&D[0]<=N)){var je=pm(S,(-k+C)/A);return K2(je,w),[D,hm(je)]}}}function l(c,f){var d=i?e:Se-e,h=0;return c<-d?h|=1:c>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return y5(a,s,o,i?[0,-e]:[-Se,e-Se])}function WK(e,t,n,i,r,o){var a=e[0],s=e[1],u=t[0],l=t[1],c=0,f=1,d=u-a,h=l-s,g;if(g=n-a,!(!d&&g>0)){if(g/=d,d<0){if(g<c)return;g<f&&(f=g)}else if(d>0){if(g>f)return;g>c&&(c=g)}if(g=r-a,!(!d&&g<0)){if(g/=d,d<0){if(g>f)return;g>c&&(c=g)}else if(d>0){if(g<c)return;g<f&&(f=g)}if(g=i-s,!(!h&&g>0)){if(g/=h,h<0){if(g<c)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>c&&(c=g)}if(g=o-s,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>c&&(c=g)}else if(h>0){if(g<c)return;g<f&&(f=g)}return c>0&&(e[0]=a+c*d,e[1]=s+c*h),f<1&&(t[0]=a+f*d,t[1]=s+f*h),!0}}}}}var Od=1e9,Am=-Od;function b5(e,t,n,i){function r(l,c){return e<=l&&l<=n&&t<=c&&c<=i}function o(l,c,f,d){var h=0,g=0;if(l==null||(h=a(l,f))!==(g=a(c,f))||u(l,c)<0^f>0)do d.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==g);else d.point(c[0],c[1])}function a(l,c){return Ne(l[0]-e)<le?c>0?0:3:Ne(l[0]-n)<le?c>0?2:1:Ne(l[1]-t)<le?c>0?1:0:c>0?3:2}function s(l,c){return u(l.x,c.x)}function u(l,c){var f=a(l,1),d=a(c,1);return f!==d?f-d:f===0?c[1]-l[1]:f===1?l[0]-c[0]:f===2?l[1]-c[1]:c[0]-l[0]}return function(l){var c=l,f=g5(),d,h,g,p,m,y,v,x,b,_,E,w={point:O,lineStart:M,lineEnd:C,polygonStart:k,polygonEnd:A};function O(F,N){r(F,N)&&c.point(F,N)}function S(){for(var F=0,N=0,I=h.length;N<I;++N)for(var z=h[N],X=1,te=z.length,xe=z[0],ge,je,Oe=xe[0],ke=xe[1];X<te;++X)ge=Oe,je=ke,xe=z[X],Oe=xe[0],ke=xe[1],je<=i?ke>i&&(Oe-ge)*(i-je)>(ke-je)*(e-ge)&&++F:ke<=i&&(Oe-ge)*(i-je)<(ke-je)*(e-ge)&&--F;return F}function k(){c=f,d=[],h=[],E=!0}function A(){var F=S(),N=E&&F,I=(d=vC(d)).length;(N||I)&&(l.polygonStart(),N&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),I&&p5(d,s,F,o,l),l.polygonEnd()),c=l,d=h=g=null}function M(){w.point=D,h&&h.push(g=[]),_=!0,b=!1,v=x=NaN}function C(){d&&(D(p,m),y&&b&&f.rejoin(),d.push(f.result())),w.point=O,b&&c.lineEnd()}function D(F,N){var I=r(F,N);if(h&&g.push([F,N]),_)p=F,m=N,y=I,_=!1,I&&(c.lineStart(),c.point(F,N));else if(I&&b)c.point(F,N);else{var z=[v=Math.max(Am,Math.min(Od,v)),x=Math.max(Am,Math.min(Od,x))],X=[F=Math.max(Am,Math.min(Od,F)),N=Math.max(Am,Math.min(Od,N))];WK(z,X,e,t,n,i)?(b||(c.lineStart(),c.point(z[0],z[1])),c.point(X[0],X[1]),I||c.lineEnd(),E=!1):I&&(c.lineStart(),c.point(F,N),E=!1)}v=F,x=N,b=I}return w}}function x5(e,t,n){var i=yi(e,t-le,n).concat(t);return function(r){return i.map(function(o){return[r,o]})}}function w5(e,t,n){var i=yi(e,t-le,n).concat(t);return function(r){return i.map(function(o){return[o,r]})}}function HK(){var e,t,n,i,r,o,a,s,u=10,l=u,c=90,f=360,d,h,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return yi(um(i/c)*c,n,c).map(g).concat(yi(um(s/f)*f,a,f).map(p)).concat(yi(um(t/u)*u,e,u).filter(function(x){return Ne(x%c)>le}).map(d)).concat(yi(um(o/l)*l,r,l).filter(function(x){return Ne(x%f)>le}).map(h))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(p(a).slice(1),g(n).reverse().slice(1),p(s).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(i=+x[0][0],n=+x[1][0],s=+x[0][1],a=+x[1][1],i>n&&(x=i,i=n,n=x),s>a&&(x=s,s=a,a=x),y.precision(m)):[[i,s],[n,a]]},y.extentMinor=function(x){return arguments.length?(t=+x[0][0],e=+x[1][0],o=+x[0][1],r=+x[1][1],t>e&&(x=t,t=e,e=x),o>r&&(x=o,o=r,r=x),y.precision(m)):[[t,o],[e,r]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(c=+x[0],f=+x[1],y):[c,f]},y.stepMinor=function(x){return arguments.length?(u=+x[0],l=+x[1],y):[u,l]},y.precision=function(x){return arguments.length?(m=+x,d=x5(o,r,90),h=w5(t,e,m),g=x5(s,a,90),p=w5(i,n,m),y):m},y.extentMajor([[-180,-90+le],[180,90-le]]).extentMinor([[-180,-80-le],[180,80+le]])}var Sd=e=>e,ow=new Cn,aw=new Cn,_5,E5,sw,uw,Va={point:en,lineStart:en,lineEnd:en,polygonStart:function(){Va.lineStart=GK,Va.lineEnd=YK},polygonEnd:function(){Va.lineStart=Va.lineEnd=Va.point=en,ow.add(Ne(aw)),aw=new Cn},result:function(){var e=ow/2;return ow=new Cn,e}};function GK(){Va.point=VK}function VK(e,t){Va.point=O5,_5=sw=e,E5=uw=t}function O5(e,t){aw.add(uw*e-sw*t),sw=e,uw=t}function YK(){O5(_5,E5)}var S5=Va,Jl=1/0,km=Jl,Ad=-Jl,Cm=Ad,XK={point:KK,lineStart:en,lineEnd:en,polygonStart:en,polygonEnd:en,result:function(){var e=[[Jl,km],[Ad,Cm]];return Ad=Cm=-(km=Jl=1/0),e}};function KK(e,t){e<Jl&&(Jl=e),e>Ad&&(Ad=e),t<km&&(km=t),t>Cm&&(Cm=t)}var Tm=XK,lw=0,cw=0,kd=0,Fm=0,Mm=0,Ql=0,fw=0,dw=0,Cd=0,A5,k5,Jr,Qr,fr={point:eu,lineStart:C5,lineEnd:T5,polygonStart:function(){fr.lineStart=ZK,fr.lineEnd=eJ},polygonEnd:function(){fr.point=eu,fr.lineStart=C5,fr.lineEnd=T5},result:function(){var e=Cd?[fw/Cd,dw/Cd]:Ql?[Fm/Ql,Mm/Ql]:kd?[lw/kd,cw/kd]:[NaN,NaN];return lw=cw=kd=Fm=Mm=Ql=fw=dw=Cd=0,e}};function eu(e,t){lw+=e,cw+=t,++kd}function C5(){fr.point=JK}function JK(e,t){fr.point=QK,eu(Jr=e,Qr=t)}function QK(e,t){var n=e-Jr,i=t-Qr,r=Dn(n*n+i*i);Fm+=r*(Jr+e)/2,Mm+=r*(Qr+t)/2,Ql+=r,eu(Jr=e,Qr=t)}function T5(){fr.point=eu}function ZK(){fr.point=tJ}function eJ(){F5(A5,k5)}function tJ(e,t){fr.point=F5,eu(A5=Jr=e,k5=Qr=t)}function F5(e,t){var n=e-Jr,i=t-Qr,r=Dn(n*n+i*i);Fm+=r*(Jr+e)/2,Mm+=r*(Qr+t)/2,Ql+=r,r=Qr*e-Jr*t,fw+=r*(Jr+e),dw+=r*(Qr+t),Cd+=r*3,eu(Jr=e,Qr=t)}var M5=fr;function D5(e){this._context=e}D5.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Mn);break}}},result:en};var hw=new Cn,gw,N5,R5,Td,Fd,Dm={point:en,lineStart:function(){Dm.point=nJ},lineEnd:function(){gw&&j5(N5,R5),Dm.point=en},polygonStart:function(){gw=!0},polygonEnd:function(){gw=null},result:function(){var e=+hw;return hw=new Cn,e}};function nJ(e,t){Dm.point=j5,N5=Td=e,R5=Fd=t}function j5(e,t){Td-=e,Fd-=t,hw.add(Dn(Td*Td+Fd*Fd)),Td=e,Fd=t}var $5=Dm;function L5(){this._string=[]}L5.prototype={_radius:4.5,_circle:I5(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=I5(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function I5(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function P5(e,t){var n=4.5,i,r;function o(a){return a&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),Lo(a,i(r))),r.result()}return o.area=function(a){return Lo(a,i(S5)),S5.result()},o.measure=function(a){return Lo(a,i($5)),$5.result()},o.bounds=function(a){return Lo(a,i(Tm)),Tm.result()},o.centroid=function(a){return Lo(a,i(M5)),M5.result()},o.projection=function(a){return arguments.length?(i=a==null?(e=null,Sd):(e=a).stream,o):e},o.context=function(a){return arguments.length?(r=a==null?(t=null,new L5):new D5(t=a),typeof n!="function"&&r.pointRadius(n),o):t},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(r.pointRadius(+a),+a),o):n},o.projection(e).context(t)}function Nm(e){return function(t){var n=new pw;for(var i in e)n[i]=e[i];return n.stream=t,n}}function pw(){}pw.prototype={constructor:pw,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function mw(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Lo(n,e.stream(Tm)),t(Tm.result()),i!=null&&e.clipExtent(i),e}function Rm(e,t,n){return mw(e,function(i){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],a=Math.min(r/(i[1][0]-i[0][0]),o/(i[1][1]-i[0][1])),s=+t[0][0]+(r-a*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(o-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([s,u])},n)}function yw(e,t,n){return Rm(e,[[0,0],t],n)}function vw(e,t,n){return mw(e,function(i){var r=+t,o=r/(i[1][0]-i[0][0]),a=(r-o*(i[1][0]+i[0][0]))/2,s=-o*i[0][1];e.scale(150*o).translate([a,s])},n)}function bw(e,t,n){return mw(e,function(i){var r=+t,o=r/(i[1][1]-i[0][1]),a=-o*i[0][0],s=(r-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,s])},n)}var z5=16,iJ=ce(30*Ae);function B5(e,t){return+t?oJ(e,t):rJ(e)}function rJ(e){return Nm({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function oJ(e,t){function n(i,r,o,a,s,u,l,c,f,d,h,g,p,m){var y=l-i,v=c-r,x=y*y+v*v;if(x>4*t&&p--){var b=a+d,_=s+h,E=u+g,w=Dn(b*b+_*_+E*E),O=ei(E/=w),S=Ne(Ne(E)-1)<le||Ne(o-f)<le?(o+f)/2:Pi(_,b),k=e(S,O),A=k[0],M=k[1],C=A-i,D=M-r,F=v*C-y*D;(F*F/x>t||Ne((y*C+v*D)/x-.5)>.3||a*d+s*h+u*g<iJ)&&(n(i,r,o,a,s,u,A,M,S,b/=w,_/=w,E,p,m),m.point(A,M),n(A,M,S,b,_,E,l,c,f,d,h,g,p,m))}}return function(i){var r,o,a,s,u,l,c,f,d,h,g,p,m={point:y,lineStart:v,lineEnd:b,polygonStart:function(){i.polygonStart(),m.lineStart=_},polygonEnd:function(){i.polygonEnd(),m.lineStart=v}};function y(O,S){O=e(O,S),i.point(O[0],O[1])}function v(){f=NaN,m.point=x,i.lineStart()}function x(O,S){var k=Qs([O,S]),A=e(O,S);n(f,d,c,h,g,p,f=A[0],d=A[1],c=O,h=k[0],g=k[1],p=k[2],z5,i),i.point(f,d)}function b(){m.point=y,i.lineEnd()}function _(){v(),m.point=E,m.lineEnd=w}function E(O,S){x(r=O,S),o=f,a=d,s=h,u=g,l=p,m.point=x}function w(){n(f,d,c,h,g,p,o,a,r,s,u,l,z5,i),m.lineEnd=b,b()}return m}}var aJ=Nm({point:function(e,t){this.stream.point(e*Ae,t*Ae)}});function sJ(e){return Nm({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function uJ(e,t,n,i,r){function o(a,s){return a*=i,s*=r,[t+e*a,n-e*s]}return o.invert=function(a,s){return[(a-t)/e*i,(n-s)/e*r]},o}function U5(e,t,n,i,r,o){if(!o)return uJ(e,t,n,i,r);var a=ce(o),s=se(o),u=a*e,l=s*e,c=a/e,f=s/e,d=(s*n-a*t)/e,h=(s*t+a*n)/e;function g(p,m){return p*=i,m*=r,[u*p-l*m+t,n-l*p-u*m]}return g.invert=function(p,m){return[i*(c*p-f*m+d),r*(h-f*p-c*m)]},g}function Zr(e){return q5(function(){return e})()}function q5(e){var t,n=150,i=480,r=250,o=0,a=0,s=0,u=0,l=0,c,f=0,d=1,h=1,g=null,p=v5,m=null,y,v,x,b=Sd,_=.5,E,w,O,S,k;function A(F){return O(F[0]*Ae,F[1]*Ae)}function M(F){return F=O.invert(F[0],F[1]),F&&[F[0]*_t,F[1]*_t]}A.stream=function(F){return S&&k===F?S:S=aJ(sJ(c)(p(E(b(k=F)))))},A.preclip=function(F){return arguments.length?(p=F,g=void 0,D()):p},A.postclip=function(F){return arguments.length?(b=F,m=y=v=x=null,D()):b},A.clipAngle=function(F){return arguments.length?(p=+F?qK(g=F*Ae):(g=null,v5),D()):g*_t},A.clipExtent=function(F){return arguments.length?(b=F==null?(m=y=v=x=null,Sd):b5(m=+F[0][0],y=+F[0][1],v=+F[1][0],x=+F[1][1]),D()):m==null?null:[[m,y],[v,x]]},A.scale=function(F){return arguments.length?(n=+F,C()):n},A.translate=function(F){return arguments.length?(i=+F[0],r=+F[1],C()):[i,r]},A.center=function(F){return arguments.length?(o=F[0]%360*Ae,a=F[1]%360*Ae,C()):[o*_t,a*_t]},A.rotate=function(F){return arguments.length?(s=F[0]%360*Ae,u=F[1]%360*Ae,l=F.length>2?F[2]%360*Ae:0,C()):[s*_t,u*_t,l*_t]},A.angle=function(F){return arguments.length?(f=F%360*Ae,C()):f*_t},A.reflectX=function(F){return arguments.length?(d=F?-1:1,C()):d<0},A.reflectY=function(F){return arguments.length?(h=F?-1:1,C()):h<0},A.precision=function(F){return arguments.length?(E=B5(w,_=F*F),D()):Dn(_)},A.fitExtent=function(F,N){return Rm(A,F,N)},A.fitSize=function(F,N){return yw(A,F,N)},A.fitWidth=function(F,N){return vw(A,F,N)},A.fitHeight=function(F,N){return bw(A,F,N)};function C(){var F=U5(n,0,0,d,h,f).apply(null,t(o,a)),N=U5(n,i-F[0],r-F[1],d,h,f);return c=l5(s,u,l),w=nw(t,N),O=nw(c,w),E=B5(w,_),D()}function D(){return S=k=null,A}return function(){return t=e.apply(this,arguments),A.invert=t.invert&&M,C()}}function xw(e){var t=0,n=Se/3,i=q5(e),r=i(t,n);return r.parallels=function(o){return arguments.length?i(t=o[0]*Ae,n=o[1]*Ae):[t*_t,n*_t]},r}function lJ(e){var t=ce(e);function n(i,r){return[i*t,se(r)/t]}return n.invert=function(i,r){return[i/t,ei(r*t)]},n}function cJ(e,t){var n=se(e),i=(n+se(t))/2;if(Ne(i)<le)return lJ(e);var r=1+n*(2*i-n),o=Dn(r)/i;function a(s,u){var l=Dn(r-2*i*se(u))/i;return[l*se(s*=i),o-l*ce(s)]}return a.invert=function(s,u){var l=o-u,c=Pi(s,Ne(l))*zi(l);return l*i<0&&(c-=Se*zi(s)*zi(l)),[c/i,ei((r-(s*s+l*l)*i*i)/(2*i))]},a}function jm(){return xw(cJ).scale(155.424).center([0,33.6442])}function W5(){return jm().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function fJ(e){var t=e.length;return{point:function(n,i){for(var r=-1;++r<t;)e[r].point(n,i)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function dJ(){var e,t,n=W5(),i,r=jm().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,a=jm().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s,u,l={point:function(d,h){u=[d,h]}};function c(d){var h=d[0],g=d[1];return u=null,i.point(h,g),u||(o.point(h,g),u)||(s.point(h,g),u)}c.invert=function(d){var h=n.scale(),g=n.translate(),p=(d[0]-g[0])/h,m=(d[1]-g[1])/h;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?r:m>=.166&&m<.234&&p>=-.214&&p<-.115?a:n).invert(d)},c.stream=function(d){return e&&t===d?e:e=fJ([n.stream(t=d),r.stream(d),a.stream(d)])},c.precision=function(d){return arguments.length?(n.precision(d),r.precision(d),a.precision(d),f()):n.precision()},c.scale=function(d){return arguments.length?(n.scale(d),r.scale(d*.35),a.scale(d),c.translate(n.translate())):n.scale()},c.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),g=+d[0],p=+d[1];return i=n.translate(d).clipExtent([[g-.455*h,p-.238*h],[g+.455*h,p+.238*h]]).stream(l),o=r.translate([g-.307*h,p+.201*h]).clipExtent([[g-.425*h+le,p+.12*h+le],[g-.214*h-le,p+.234*h-le]]).stream(l),s=a.translate([g-.205*h,p+.212*h]).clipExtent([[g-.214*h+le,p+.166*h+le],[g-.115*h-le,p+.234*h-le]]).stream(l),f()},c.fitExtent=function(d,h){return Rm(c,d,h)},c.fitSize=function(d,h){return yw(c,d,h)},c.fitWidth=function(d,h){return vw(c,d,h)},c.fitHeight=function(d,h){return bw(c,d,h)};function f(){return e=t=null,c}return c.scale(1070)}function H5(e){return function(t,n){var i=ce(t),r=ce(n),o=e(i*r);return o===1/0?[2,0]:[o*r*se(t),o*se(n)]}}function Md(e){return function(t,n){var i=Dn(t*t+n*n),r=e(i),o=se(r),a=ce(r);return[Pi(t*o,i*a),ei(i&&n*o/i)]}}var G5=H5(function(e){return Dn(2/(1+e))});G5.invert=Md(function(e){return 2*ei(e/2)});function hJ(){return Zr(G5).scale(124.75).clipAngle(180-.001)}var V5=H5(function(e){return(e=WN(e))&&e/se(e)});V5.invert=Md(function(e){return e});function gJ(){return Zr(V5).scale(79.4188).clipAngle(180-.001)}function $m(e,t){return[e,lm(H2((vt+t)/2))]}$m.invert=function(e,t){return[e,2*Yl(qN(t))-vt]};function pJ(){return Y5($m).scale(961/Mn)}function Y5(e){var t=Zr(e),n=t.center,i=t.scale,r=t.translate,o=t.clipExtent,a=null,s,u,l;t.scale=function(f){return arguments.length?(i(f),c()):i()},t.translate=function(f){return arguments.length?(r(f),c()):r()},t.center=function(f){return arguments.length?(n(f),c()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=s=u=l=null:(a=+f[0][0],s=+f[0][1],u=+f[1][0],l=+f[1][1]),c()):a==null?null:[[a,s],[u,l]]};function c(){var f=Se*i(),d=t(jK(t.rotate()).invert([0,0]));return o(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===$m?[[Math.max(d[0]-f,a),s],[Math.min(d[0]+f,u),l]]:[[a,Math.max(d[1]-f,s)],[u,Math.min(d[1]+f,l)]])}return c()}function Lm(e){return H2((vt+e)/2)}function mJ(e,t){var n=ce(e),i=e===t?se(e):lm(n/ce(t))/lm(Lm(t)/Lm(e)),r=n*W2(Lm(e),i)/i;if(!i)return $m;function o(a,s){r>0?s<-vt+le&&(s=-vt+le):s>vt-le&&(s=vt-le);var u=r/W2(Lm(s),i);return[u*se(i*a),r-u*ce(i*a)]}return o.invert=function(a,s){var u=r-s,l=zi(i)*Dn(a*a+u*u),c=Pi(a,Ne(u))*zi(u);return u*i<0&&(c-=Se*zi(a)*zi(u)),[c/i,2*Yl(W2(r/l,1/i))-vt]},o}function yJ(){return xw(mJ).scale(109.5).parallels([30,30])}function Im(e,t){return[e,t]}Im.invert=Im;function vJ(){return Zr(Im).scale(152.63)}function bJ(e,t){var n=ce(e),i=e===t?se(e):(n-ce(t))/(t-e),r=n/i+e;if(Ne(i)<le)return Im;function o(a,s){var u=r-s,l=i*a;return[u*se(l),r-u*ce(l)]}return o.invert=function(a,s){var u=r-s,l=Pi(a,Ne(u))*zi(u);return u*i<0&&(l-=Se*zi(a)*zi(u)),[l/i,r-zi(i)*Dn(a*a+u*u)]},o}function xJ(){return xw(bJ).scale(131.154).center([0,13.9389])}var Dd=1.340264,Nd=-.081106,Rd=893e-6,jd=.003796,Pm=Dn(3)/2,wJ=12;function X5(e,t){var n=ei(Pm*se(t)),i=n*n,r=i*i*i;return[e*ce(n)/(Pm*(Dd+3*Nd*i+r*(7*Rd+9*jd*i))),n*(Dd+Nd*i+r*(Rd+jd*i))]}X5.invert=function(e,t){for(var n=t,i=n*n,r=i*i*i,o=0,a,s,u;o<wJ&&(s=n*(Dd+Nd*i+r*(Rd+jd*i))-t,u=Dd+3*Nd*i+r*(7*Rd+9*jd*i),n-=a=s/u,i=n*n,r=i*i*i,!(Ne(a)<am));++o);return[Pm*e*(Dd+3*Nd*i+r*(7*Rd+9*jd*i))/ce(n),ei(se(n)/Pm)]};function _J(){return Zr(X5).scale(177.158)}function K5(e,t){var n=ce(t),i=ce(e)*n;return[n*se(e)/i,se(t)/i]}K5.invert=Md(Yl);function EJ(){return Zr(K5).scale(144.049).clipAngle(60)}function OJ(){var e=1,t=0,n=0,i=1,r=1,o=0,a,s,u=null,l,c,f,d=1,h=1,g=Nm({point:function(b,_){var E=x([b,_]);this.stream.point(E[0],E[1])}}),p=Sd,m,y;function v(){return d=e*i,h=e*r,m=y=null,x}function x(b){var _=b[0]*d,E=b[1]*h;if(o){var w=E*a-_*s;_=_*a+E*s,E=w}return[_+t,E+n]}return x.invert=function(b){var _=b[0]-t,E=b[1]-n;if(o){var w=E*a+_*s;_=_*a-E*s,E=w}return[_/d,E/h]},x.stream=function(b){return m&&y===b?m:m=g(p(y=b))},x.postclip=function(b){return arguments.length?(p=b,u=l=c=f=null,v()):p},x.clipExtent=function(b){return arguments.length?(p=b==null?(u=l=c=f=null,Sd):b5(u=+b[0][0],l=+b[0][1],c=+b[1][0],f=+b[1][1]),v()):u==null?null:[[u,l],[c,f]]},x.scale=function(b){return arguments.length?(e=+b,v()):e},x.translate=function(b){return arguments.length?(t=+b[0],n=+b[1],v()):[t,n]},x.angle=function(b){return arguments.length?(o=b%360*Ae,s=se(o),a=ce(o),v()):o*_t},x.reflectX=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.reflectY=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.fitExtent=function(b,_){return Rm(x,b,_)},x.fitSize=function(b,_){return yw(x,b,_)},x.fitWidth=function(b,_){return vw(x,b,_)},x.fitHeight=function(b,_){return bw(x,b,_)},x}function J5(e,t){var n=t*t,i=n*n;return[e*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),t*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}J5.invert=function(e,t){var n=t,i=25,r;do{var o=n*n,a=o*o;n-=r=(n*(1.007226+o*(.015085+a*(-.044475+.028874*o-.005916*a)))-t)/(1.007226+o*(.015085*3+a*(-.044475*7+.028874*9*o-.005916*11*a)))}while(Ne(r)>le&&--i>0);return[e/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function SJ(){return Zr(J5).scale(175.295)}function Q5(e,t){return[ce(t)*se(e),se(t)]}Q5.invert=Md(ei);function AJ(){return Zr(Q5).scale(249.5).clipAngle(90+le)}function Z5(e,t){var n=ce(t),i=1+ce(e)*n;return[n*se(e)/i,se(t)/i]}Z5.invert=Md(function(e){return 2*Yl(e)});function kJ(){return Zr(Z5).scale(250).clipAngle(142)}function eR(e,t){return[lm(H2((vt+t)/2)),-e]}eR.invert=function(e,t){return[-t,2*Yl(qN(e))-vt]};function CJ(){var e=Y5(eR),t=e.center,n=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var TJ=Math.abs,ww=Math.cos,zm=Math.sin,FJ=1e-6,tR=Math.PI,_w=tR/2,nR=MJ(2);function iR(e){return e>1?_w:e<-1?-_w:Math.asin(e)}function MJ(e){return e>0?Math.sqrt(e):0}function DJ(e,t){var n=e*zm(t),i=30,r;do t-=r=(t+zm(t)-n)/(1+ww(t));while(TJ(r)>FJ&&--i>0);return t/2}function NJ(e,t,n){function i(r,o){return[e*r*ww(o=DJ(n,o)),t*zm(o)]}return i.invert=function(r,o){return o=iR(o/t),[r/(e*ww(o)),iR((2*o+zm(2*o))/n)]},i}var RJ=NJ(nR/_w,nR,tR);function jJ(){return Zr(RJ).scale(169.529)}const $J=P5(),Ew=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function LJ(e,t){return function n(){const i=t();return i.type=e,i.path=P5().projection(i),i.copy=i.copy||function(){const r=n();return Ew.forEach(o=>{i[o]&&r[o](i[o]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function Ow(e,t){if(!e||typeof e!="string")throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(Bm[e]=LJ(e,t),this):Bm[e]||null}function rR(e){return e&&e.path||$J}const Bm={albers:W5,albersusa:dJ,azimuthalequalarea:hJ,azimuthalequidistant:gJ,conicconformal:yJ,conicequalarea:jm,conicequidistant:xJ,equalEarth:_J,equirectangular:vJ,gnomonic:EJ,identity:OJ,mercator:pJ,mollweide:jJ,naturalEarth1:SJ,orthographic:AJ,stereographic:kJ,transversemercator:CJ};for(const e in Bm)Ow(e,Bm[e]);function IJ(){}const zo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function oR(){var e=1,t=1,n=s;function i(u,l){return l.map(c=>r(u,c))}function r(u,l){var c=[],f=[];return o(u,l,d=>{n(d,u,l),PJ(d)>0?c.push([d]):f.push(d)}),f.forEach(d=>{for(var h=0,g=c.length,p;h<g;++h)if(zJ((p=c[h])[0],d)!==-1){p.push(d);return}}),{type:"MultiPolygon",value:l,coordinates:c}}function o(u,l,c){var f=new Array,d=new Array,h,g,p,m,y,v;for(h=g=-1,m=u[0]>=l,zo[m<<1].forEach(x);++h<e-1;)p=m,m=u[h+1]>=l,zo[p|m<<1].forEach(x);for(zo[m<<0].forEach(x);++g<t-1;){for(h=-1,m=u[g*e+e]>=l,y=u[g*e]>=l,zo[m<<1|y<<2].forEach(x);++h<e-1;)p=m,m=u[g*e+e+h+1]>=l,v=y,y=u[g*e+h+1]>=l,zo[p|m<<1|y<<2|v<<3].forEach(x);zo[m|y<<3].forEach(x)}for(h=-1,y=u[g*e]>=l,zo[y<<2].forEach(x);++h<e-1;)v=y,y=u[g*e+h+1]>=l,zo[y<<2|v<<3].forEach(x);zo[y<<3].forEach(x);function x(b){var _=[b[0][0]+h,b[0][1]+g],E=[b[1][0]+h,b[1][1]+g],w=a(_),O=a(E),S,k;(S=d[w])?(k=f[O])?(delete d[S.end],delete f[k.start],S===k?(S.ring.push(E),c(S.ring)):f[S.start]=d[k.end]={start:S.start,end:k.end,ring:S.ring.concat(k.ring)}):(delete d[S.end],S.ring.push(E),d[S.end=O]=S):(S=f[O])?(k=d[w])?(delete f[S.start],delete d[k.end],S===k?(S.ring.push(E),c(S.ring)):f[k.start]=d[S.end]={start:k.start,end:S.end,ring:k.ring.concat(S.ring)}):(delete f[S.start],S.ring.unshift(_),f[S.start=w]=S):f[w]=d[O]={start:w,end:O,ring:[_,E]}}}function a(u){return u[0]*2+u[1]*(e+1)*4}function s(u,l,c){u.forEach(f=>{var d=f[0],h=f[1],g=d|0,p=h|0,m,y=l[p*e+g];d>0&&d<e&&g===d&&(m=l[p*e+g-1],f[0]=d+(c-m)/(y-m)-.5),h>0&&h<t&&p===h&&(m=l[(p-1)*e+g],f[1]=h+(c-m)/(y-m)-.5)})}return i.contour=r,i.size=function(u){if(!arguments.length)return[e,t];var l=Math.floor(u[0]),c=Math.floor(u[1]);return l>=0&&c>=0||L("invalid size"),e=l,t=c,i},i.smooth=function(u){return arguments.length?(n=u?s:IJ,i):n===s},i}function PJ(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}function zJ(e,t){for(var n=-1,i=t.length,r;++n<i;)if(r=BJ(e,t[n]))return r;return 0}function BJ(e,t){for(var n=t[0],i=t[1],r=-1,o=0,a=e.length,s=a-1;o<a;s=o++){var u=e[o],l=u[0],c=u[1],f=e[s],d=f[0],h=f[1];if(UJ(u,f,t))return 0;c>i!=h>i&&n<(d-l)*(i-c)/(h-c)+l&&(r=-r)}return r}function UJ(e,t,n){var i;return qJ(e,t,n)&&WJ(e[i=+(e[0]===t[0])],n[i],t[i])}function qJ(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function WJ(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function aR(e,t,n){return function(i){var r=$r(i),o=n?Math.min(r[0],0):r[0],a=r[1],s=a-o,u=t?ya(o,a,e):s/(e+1);return yi(o+u,a,u)}}function Sw(e){R.call(this,null,e)}Sw.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};W(Sw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=e.field||dn,o=oR().smooth(e.smooth!==!1),a=e.thresholds||HJ(i,r,e),s=e.as===null?null:e.as||"contour",u=[];return i.forEach(l=>{const c=r(l),f=o.size([c.width,c.height])(c.values,P(a)?a:a(c.values));GJ(f,c,l,e),f.forEach(d=>{u.push(qg(l,Ue(s!=null?{[s]:d}:d)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function HJ(e,t,n){const i=aR(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(e.map(r=>Ms(t(r).values)))}function GJ(e,t,n,i){let r=i.scale||t.scale,o=i.translate||t.translate;if(_e(r)&&(r=r(n,i)),_e(o)&&(o=o(n,i)),(r===1||r==null)&&!o)return;const a=(Je(r)?r:r[0])||1,s=(Je(r)?r:r[1])||1,u=o&&o[0]||0,l=o&&o[1]||0;e.forEach(sR(t,a,s,u,l))}function sR(e,t,n,i,r){const o=e.x1||0,a=e.y1||0,s=t*n<0;function u(f){f.forEach(l)}function l(f){s&&f.reverse(),f.forEach(c)}function c(f){f[0]=(f[0]-o)*t+i,f[1]=(f[1]-a)*n+r}return function(f){return f.coordinates.forEach(u),f}}function uR(e,t,n){const i=e>=0?e:Kv(t,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Aw(e){return _e(e)?e:gn(+e)}function lR(){var e=u=>u[0],t=u=>u[1],n=fl,i=[-1,-1],r=960,o=500,a=2;function s(u,l){const c=uR(i[0],u,e)>>a,f=uR(i[1],u,t)>>a,d=c?c+2:0,h=f?f+2:0,g=2*d+(r>>a),p=2*h+(o>>a),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;u.forEach(b=>{const _=d+(+e(b)>>a),E=h+(+t(b)>>a);_>=0&&_<g&&E>=0&&E<p&&(m[_+E*g]+=+n(b))}),c>0&&f>0?(Zl(g,p,m,y,c),ec(g,p,y,m,f),Zl(g,p,m,y,c),ec(g,p,y,m,f),Zl(g,p,m,y,c),ec(g,p,y,m,f)):c>0?(Zl(g,p,m,y,c),Zl(g,p,y,m,c),Zl(g,p,m,y,c),v=y):f>0&&(ec(g,p,m,y,f),ec(g,p,y,m,f),ec(g,p,m,y,f),v=y);const x=l?Math.pow(2,-2*a):1/bC(v);for(let b=0,_=g*p;b<_;++b)v[b]*=x;return{values:v,scale:1<<a,width:g,height:p,x1:d,y1:h,x2:d+(r>>a),y2:h+(o>>a)}}return s.x=function(u){return arguments.length?(e=Aw(u),s):e},s.y=function(u){return arguments.length?(t=Aw(u),s):t},s.weight=function(u){return arguments.length?(n=Aw(u),s):n},s.size=function(u){if(!arguments.length)return[r,o];var l=+u[0],c=+u[1];return l>=0&&c>=0||L("invalid size"),r=l,o=c,s},s.cellSize=function(u){return arguments.length?((u=+u)>=1||L("invalid cell size"),a=Math.floor(Math.log(u)/Math.LN2),s):1<<a},s.bandwidth=function(u){return arguments.length?(u=J(u),u.length===1&&(u=[+u[0],+u[0]]),u.length!==2&&L("invalid bandwidth"),i=u,s):i},s}function Zl(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<t;++a)for(let s=0,u=0;s<e+r;++s)s<e&&(u+=n[s+a*e]),s>=r&&(s>=o&&(u-=n[s-o+a*e]),i[s-r+a*e]=u/Math.min(s+1,e-1+o-s,o))}function ec(e,t,n,i,r){const o=(r<<1)+1;for(let a=0;a<e;++a)for(let s=0,u=0;s<t+r;++s)s<t&&(u+=n[a+s*e]),s>=r&&(s>=o&&(u-=n[a+(s-o)*e]),i[a+(s-r)*e]=u/Math.min(s+1,t-1+o-s,o))}function kw(e){R.call(this,null,e)}kw.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const VJ=["x","y","weight","size","cellSize","bandwidth"];function cR(e,t){return VJ.forEach(n=>t[n]!=null?e[n](t[n]):0),e}W(kw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=t.materialize(t.SOURCE).source,r=YJ(i,e.groupby),o=(e.groupby||[]).map(yt),a=cR(lR(),e),s=e.as||"grid",u=[];function l(c,f){for(let d=0;d<o.length;++d)c[o[d]]=f[d];return c}return u=r.map(c=>Ue(l({[s]:a(c,e.counts)},c.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});function YJ(e,t){var n=[],i=c=>c(s),r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function Cw(e){R.call(this,null,e)}Cw.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};W(Cw,R,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=oR().smooth(e.smooth!==!1),r=e.values,o=e.thresholds||aR(e.count||10,e.nice,!!r),a=e.size,s,u;return r||(r=t.materialize(t.SOURCE).source,s=cR(lR(),e)(r,!0),u=sR(s,s.scale||1,s.scale||1,0,0),a=[s.width,s.height],r=s.values),o=P(o)?o:o(r),r=i.size(a)(r,o),u&&r.forEach(u),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(Ue),n}});const Tw="Feature",Fw="FeatureCollection",XJ="MultiPoint";function Mw(e){R.call(this,null,e)}Mw.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};W(Mw,R,{transform(e,t){var n=this._features,i=this._points,r=e.fields,o=r&&r[0],a=r&&r[1],s=e.geojson||!r&&dn,u=t.ADD,l;l=e.modified()||t.changed(t.REM)||t.modified(fn(s))||o&&t.modified(fn(o))||a&&t.modified(fn(a)),(!this.value||l)&&(u=t.SOURCE,this._features=n=[],this._points=i=[]),s&&t.visit(u,c=>n.push(s(c))),o&&a&&(t.visit(u,c=>{var f=o(c),d=a(c);f!=null&&d!=null&&(f=+f)===f&&(d=+d)===d&&i.push([f,d])}),n=n.concat({type:Tw,geometry:{type:XJ,coordinates:i}})),this.value={type:Fw,features:n}}});function Dw(e){R.call(this,null,e)}Dw.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};W(Dw,R,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.field||dn,o=e.as||"path",a=n.SOURCE;!i||e.modified()?(this.value=i=rR(e.projection),n.materialize().reflow()):a=r===dn||t.modified(r.fields)?n.ADD_MOD:n.ADD;const s=KJ(i,e.pointRadius);return n.visit(a,u=>u[o]=i(r(u))),i.pointRadius(s),n.modifies(o)}});function KJ(e,t){const n=e.pointRadius();return e.context(null),t!=null&&e.pointRadius(t),n}function Nw(e){R.call(this,null,e)}Nw.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};W(Nw,R,{transform(e,t){var n=e.projection,i=e.fields[0],r=e.fields[1],o=e.as||["x","y"],a=o[0],s=o[1],u;function l(c){const f=n([i(c),r(c)]);f?(c[a]=f[0],c[s]=f[1]):(c[a]=void 0,c[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(u=t.modified(i.fields)||t.modified(r.fields),t.visit(u?t.ADD_MOD:t.ADD,l)),t.modifies(o)}});function Rw(e){R.call(this,null,e)}Rw.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};W(Rw,R,{transform(e,t){var n=t.fork(t.ALL),i=this.value,r=e.as||"shape",o=n.ADD;return(!i||e.modified())&&(this.value=i=JJ(rR(e.projection),e.field||Yn("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,a=>a[r]=i),n.modifies(r)}});function JJ(e,t,n){const i=n==null?r=>e(t(r)):r=>{var o=e.pointRadius(),a=e.pointRadius(n)(t(r));return e.pointRadius(o),a};return i.context=r=>(e.context(r),i),i}function jw(e){R.call(this,[],e),this.generator=HK()}jw.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};W(jw,R,{transform(e,t){var n=this.value,i=this.generator,r;if(!n.length||e.modified())for(const o in e)_e(i[o])&&i[o](e[o]);return r=i(),n.length?t.mod.push($T(n[0],r)):t.add.push(Ue(r)),n[0]=r,t}});function $w(e){R.call(this,null,e)}$w.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};W($w,R,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,i=e.resolve==="shared",r=e.field||dn,o=ZJ(e.opacity,e),a=QJ(e.color,e),s=e.as||"image",u={$x:0,$y:0,$value:0,$max:i?Ms(n.map(l=>Ms(r(l).values))):0};return n.forEach(l=>{const c=r(l),f=Ee({},l,u);i||(f.$max=Ms(c.values||[])),l[s]=eQ(c,f,a.dep?a:gn(a(f)),o.dep?o:gn(o(f)))}),t.reflow(!0).modifies(s)}});function QJ(e,t){let n;return _e(e)?(n=i=>Fa(e(i,t)),n.dep=fR(e)):n=gn(Fa(e||"#888")),n}function ZJ(e,t){let n;return _e(e)?(n=i=>e(i,t),n.dep=fR(e)):e?n=gn(e):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function fR(e){if(!_e(e))return!1;const t=nr(fn(e));return t.$x||t.$y||t.$value||t.$max}function eQ(e,t,n,i){const r=e.width,o=e.height,a=e.x1||0,s=e.y1||0,u=e.x2||r,l=e.y2||o,c=e.values,f=c?m=>c[m]:da,d=Tl(u-a,l-s),h=d.getContext("2d"),g=h.getImageData(0,0,u-a,l-s),p=g.data;for(let m=s,y=0;m<l;++m){t.$y=m-s;for(let v=a,x=m*r;v<u;++v,y+=4){t.$x=v-a,t.$value=f(v+x);const b=n(t);p[y+0]=b.r,p[y+1]=b.g,p[y+2]=b.b,p[y+3]=~~(255*i(t))}}return h.putImageData(g,0,0),d}function dR(e){R.call(this,null,e),this.modified(!0)}W(dR,R,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=nQ(e.type),Ew.forEach(i=>{e[i]!=null&&hR(n,i,e[i])})):Ew.forEach(i=>{e.modified(i)&&hR(n,i,e[i])}),e.pointRadius!=null&&n.path.pointRadius(e.pointRadius),e.fit&&tQ(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});function tQ(e,t){const n=iQ(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}function nQ(e){const t=Ow((e||"mercator").toLowerCase());return t||L("Unrecognized projection type: "+e),t()}function hR(e,t,n){_e(e[t])&&e[t](n)}function iQ(e){return e=J(e),e.length===1?e[0]:{type:Fw,features:e.reduce((t,n)=>t.concat(rQ(n)),[])}}function rQ(e){return e.type===Fw?e.features:J(e).filter(t=>t!=null).map(t=>t.type===Tw?t:{type:Tw,geometry:t})}var oQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:Cw,geojson:Mw,geopath:Dw,geopoint:Nw,geoshape:Rw,graticule:jw,heatmap:$w,isocontour:Sw,kde2d:kw,projection:dR});function aQ(e,t){var n,i=1;e==null&&(e=0),t==null&&(t=0);function r(){var o,a=n.length,s,u=0,l=0;for(o=0;o<a;++o)s=n[o],u+=s.x,l+=s.y;for(u=(u/a-e)*i,l=(l/a-t)*i,o=0;o<a;++o)s=n[o],s.x-=u,s.y-=l}return r.initialize=function(o){n=o},r.x=function(o){return arguments.length?(e=+o,r):e},r.y=function(o){return arguments.length?(t=+o,r):t},r.strength=function(o){return arguments.length?(i=+o,r):i},r}function sQ(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return gR(this.cover(t,n),t,n,e)}function gR(e,t,n,i){if(isNaN(t)||isNaN(n))return e;var r,o=e._root,a={data:i},s=e._x0,u=e._y0,l=e._x1,c=e._y1,f,d,h,g,p,m,y,v;if(!o)return e._root=a,e;for(;o.length;)if((p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d,r=o,!(o=o[y=m<<1|p]))return r[y]=a,e;if(h=+e._x.call(null,o.data),g=+e._y.call(null,o.data),t===h&&n===g)return a.next=o,r?r[y]=a:e._root=a,e;do r=r?r[y]=new Array(4):e._root=new Array(4),(p=t>=(f=(s+l)/2))?s=f:l=f,(m=n>=(d=(u+c)/2))?u=d:c=d;while((y=m<<1|p)==(v=(g>=d)<<1|h>=f));return r[v]=o,r[y]=a,e}function uQ(e){var t,n,i=e.length,r,o,a=new Array(i),s=new Array(i),u=1/0,l=1/0,c=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=r,s[n]=o,r<u&&(u=r),r>c&&(c=r),o<l&&(l=o),o>f&&(f=o));if(u>c||l>f)return this;for(this.cover(u,l).cover(c,f),n=0;n<i;++n)gR(this,a[n],s[n],e[n]);return this}function lQ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n))r=(n=Math.floor(e))+1,o=(i=Math.floor(t))+1;else{for(var a=r-n||1,s=this._root,u,l;n>e||e>=r||i>t||t>=o;)switch(l=(t<i)<<1|e<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:r=n+a,o=i+a;break;case 1:n=r-a,o=i+a;break;case 2:r=n+a,i=o-a;break;case 3:n=r-a,i=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=i,this._x1=r,this._y1=o,this}function cQ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function fQ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function $n(e,t,n,i,r){this.node=e,this.x0=t,this.y0=n,this.x1=i,this.y1=r}function dQ(e,t,n){var i,r=this._x0,o=this._y0,a,s,u,l,c=this._x1,f=this._y1,d=[],h=this._root,g,p;for(h&&d.push(new $n(h,r,o,c,f)),n==null?n=1/0:(r=e-n,o=t-n,c=e+n,f=t+n,n*=n);g=d.pop();)if(!(!(h=g.node)||(a=g.x0)>c||(s=g.y0)>f||(u=g.x1)<r||(l=g.y1)<o))if(h.length){var m=(a+u)/2,y=(s+l)/2;d.push(new $n(h[3],m,y,u,l),new $n(h[2],a,y,m,l),new $n(h[1],m,s,u,y),new $n(h[0],a,s,m,y)),(p=(t>=y)<<1|e>=m)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-p],d[d.length-1-p]=g)}else{var v=e-+this._x.call(null,h.data),x=t-+this._y.call(null,h.data),b=v*v+x*x;if(b<n){var _=Math.sqrt(n=b);r=e-_,o=t-_,c=e+_,f=t+_,i=h.data}}return i}function hQ(e){if(isNaN(c=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,i,r,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,c,f,d,h,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=c>=(d=(a+u)/2))?a=d:u=d,(p=f>=(h=(s+l)/2))?s=h:l=h,t=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(t[m+1&3]||t[m+2&3]||t[m+3&3])&&(i=t,y=m)}for(;n.data!==e;)if(r=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,r?(o?r.next=o:delete r.next,this):t?(o?t[m]=o:delete t[m],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(i?i[y]=n:this._root=n),this):(this._root=o,this)}function gQ(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function pQ(){return this._root}function mQ(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function yQ(e){var t=[],n,i=this._root,r,o,a,s,u;for(i&&t.push(new $n(i,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(i=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&i.length){var l=(o+s)/2,c=(a+u)/2;(r=i[3])&&t.push(new $n(r,l,c,s,u)),(r=i[2])&&t.push(new $n(r,o,c,l,u)),(r=i[1])&&t.push(new $n(r,l,a,s,c)),(r=i[0])&&t.push(new $n(r,o,a,l,c))}return this}function vQ(e){var t=[],n=[],i;for(this._root&&t.push(new $n(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var r=i.node;if(r.length){var o,a=i.x0,s=i.y0,u=i.x1,l=i.y1,c=(a+u)/2,f=(s+l)/2;(o=r[0])&&t.push(new $n(o,a,s,c,f)),(o=r[1])&&t.push(new $n(o,c,s,u,f)),(o=r[2])&&t.push(new $n(o,a,f,c,l)),(o=r[3])&&t.push(new $n(o,c,f,u,l))}n.push(i)}for(;i=n.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function bQ(e){return e[0]}function xQ(e){return arguments.length?(this._x=e,this):this._x}function wQ(e){return e[1]}function _Q(e){return arguments.length?(this._y=e,this):this._y}function Lw(e,t,n){var i=new Iw(t==null?bQ:t,n==null?wQ:n,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function Iw(e,t,n,i,r,o){this._x=e,this._y=t,this._x0=n,this._y0=i,this._x1=r,this._y1=o,this._root=void 0}function pR(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Ln=Lw.prototype=Iw.prototype;Ln.copy=function(){var e=new Iw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,i;if(!t)return e;if(!t.length)return e._root=pR(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var r=0;r<4;++r)(i=t.source[r])&&(i.length?n.push({source:i,target:t.target[r]=new Array(4)}):t.target[r]=pR(i));return e};Ln.add=sQ;Ln.addAll=uQ;Ln.cover=lQ;Ln.data=cQ;Ln.extent=fQ;Ln.find=dQ;Ln.remove=hQ;Ln.removeAll=gQ;Ln.root=pQ;Ln.size=mQ;Ln.visit=yQ;Ln.visitAfter=vQ;Ln.x=xQ;Ln.y=_Q;function In(e){return function(){return e}}function Ya(e){return(e()-.5)*1e-6}function EQ(e){return e.x+e.vx}function OQ(e){return e.y+e.vy}function SQ(e){var t,n,i,r=1,o=1;typeof e!="function"&&(e=In(e==null?1:+e));function a(){for(var l,c=t.length,f,d,h,g,p,m,y=0;y<o;++y)for(f=Lw(t,EQ,OQ).visitAfter(s),l=0;l<c;++l)d=t[l],p=n[d.index],m=p*p,h=d.x+d.vx,g=d.y+d.vy,f.visit(v);function v(x,b,_,E,w){var O=x.data,S=x.r,k=p+S;if(O){if(O.index>d.index){var A=h-O.x-O.vx,M=g-O.y-O.vy,C=A*A+M*M;C<k*k&&(A===0&&(A=Ya(i),C+=A*A),M===0&&(M=Ya(i),C+=M*M),C=(k-(C=Math.sqrt(C)))/C*r,d.vx+=(A*=C)*(k=(S*=S)/(m+S)),d.vy+=(M*=C)*k,O.vx-=A*(k=1-k),O.vy-=M*k)}return}return b>h+k||E<h-k||_>g+k||w<g-k}}function s(l){if(l.data)return l.r=n[l.data.index];for(var c=l.r=0;c<4;++c)l[c]&&l[c].r>l.r&&(l.r=l[c].r)}function u(){if(!!t){var l,c=t.length,f;for(n=new Array(c),l=0;l<c;++l)f=t[l],n[f.index]=+e(f,l,t)}}return a.initialize=function(l,c){t=l,i=c,u()},a.iterations=function(l){return arguments.length?(o=+l,a):o},a.strength=function(l){return arguments.length?(r=+l,a):r},a.radius=function(l){return arguments.length?(e=typeof l=="function"?l:In(+l),u(),a):e},a}function AQ(e){return e.index}function mR(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function kQ(e){var t=AQ,n=f,i,r=In(30),o,a,s,u,l,c=1;e==null&&(e=[]);function f(m){return 1/Math.min(s[m.source.index],s[m.target.index])}function d(m){for(var y=0,v=e.length;y<c;++y)for(var x=0,b,_,E,w,O,S,k;x<v;++x)b=e[x],_=b.source,E=b.target,w=E.x+E.vx-_.x-_.vx||Ya(l),O=E.y+E.vy-_.y-_.vy||Ya(l),S=Math.sqrt(w*w+O*O),S=(S-o[x])/S*m*i[x],w*=S,O*=S,E.vx-=w*(k=u[x]),E.vy-=O*k,_.vx+=w*(k=1-k),_.vy+=O*k}function h(){if(!!a){var m,y=a.length,v=e.length,x=new Map(a.map((_,E)=>[t(_,E,a),_])),b;for(m=0,s=new Array(y);m<v;++m)b=e[m],b.index=m,typeof b.source!="object"&&(b.source=mR(x,b.source)),typeof b.target!="object"&&(b.target=mR(x,b.target)),s[b.source.index]=(s[b.source.index]||0)+1,s[b.target.index]=(s[b.target.index]||0)+1;for(m=0,u=new Array(v);m<v;++m)b=e[m],u[m]=s[b.source.index]/(s[b.source.index]+s[b.target.index]);i=new Array(v),g(),o=new Array(v),p()}}function g(){if(!!a)for(var m=0,y=e.length;m<y;++m)i[m]=+n(e[m],m,e)}function p(){if(!!a)for(var m=0,y=e.length;m<y;++m)o[m]=+r(e[m],m,e)}return d.initialize=function(m,y){a=m,l=y,h()},d.links=function(m){return arguments.length?(e=m,h(),d):e},d.id=function(m){return arguments.length?(t=m,d):t},d.iterations=function(m){return arguments.length?(c=+m,d):c},d.strength=function(m){return arguments.length?(n=typeof m=="function"?m:In(+m),g(),d):n},d.distance=function(m){return arguments.length?(r=typeof m=="function"?m:In(+m),p(),d):r},d}var CQ={value:()=>{}};function yR(){for(var e=0,t=arguments.length,n={},i;e<t;++e){if(!(i=arguments[e]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Um(n)}function Um(e){this._=e}function TQ(e,t){return e.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Um.prototype=yR.prototype={constructor:Um,on:function(e,t){var n=this._,i=TQ(e+"",n),r,o=-1,a=i.length;if(arguments.length<2){for(;++o<a;)if((r=(e=i[o]).type)&&(r=FQ(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<a;)if(r=(e=i[o]).type)n[r]=vR(n[r],e.name,t);else if(t==null)for(r in n)n[r]=vR(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Um(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],i=0,r=o.length;i<r;++i)o[i].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};function FQ(e,t){for(var n=0,i=e.length,r;n<i;++n)if((r=e[n]).name===t)return r.value}function vR(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=CQ,e=e.slice(0,i).concat(e.slice(i+1));break}return n!=null&&e.push({name:t,value:n}),e}var tc=0,$d=0,Ld=0,bR=1e3,qm,Id,Wm=0,tu=0,Hm=0,Pd=typeof performance=="object"&&performance.now?performance:Date,xR=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Pw(){return tu||(xR(MQ),tu=Pd.now()+Hm)}function MQ(){tu=0}function Gm(){this._call=this._time=this._next=null}Gm.prototype=wR.prototype={constructor:Gm,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Pw():+n)+(t==null?0:+t),!this._next&&Id!==this&&(Id?Id._next=this:qm=this,Id=this),this._call=e,this._time=n,zw()},stop:function(){this._call&&(this._call=null,this._time=1/0,zw())}};function wR(e,t,n){var i=new Gm;return i.restart(e,t,n),i}function DQ(){Pw(),++tc;for(var e=qm,t;e;)(t=tu-e._time)>=0&&e._call.call(null,t),e=e._next;--tc}function _R(){tu=(Wm=Pd.now())+Hm,tc=$d=0;try{DQ()}finally{tc=0,RQ(),tu=0}}function NQ(){var e=Pd.now(),t=e-Wm;t>bR&&(Hm-=t,Wm=e)}function RQ(){for(var e,t=qm,n,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:qm=n);Id=e,zw(i)}function zw(e){if(!tc){$d&&($d=clearTimeout($d));var t=e-tu;t>24?(e<1/0&&($d=setTimeout(_R,e-Pd.now()-Hm)),Ld&&(Ld=clearInterval(Ld))):(Ld||(Wm=Pd.now(),Ld=setInterval(NQ,bR)),tc=1,xR(_R))}}function jQ(e,t,n){var i=new Gm,r=t;return t==null?(i.restart(e,t,n),i):(i._restart=i.restart,i.restart=function(o,a,s){a=+a,s=s==null?Pw():+s,i._restart(function u(l){l+=r,i._restart(u,r+=a,s),o(l)},a,s)},i.restart(e,t,n),i)}const $Q=1664525,LQ=1013904223,ER=4294967296;function IQ(){let e=1;return()=>(e=($Q*e+LQ)%ER)/ER}function PQ(e){return e.x}function zQ(e){return e.y}var BQ=10,UQ=Math.PI*(3-Math.sqrt(5));function qQ(e){var t,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,a=.6,s=new Map,u=wR(f),l=yR("tick","end"),c=IQ();e==null&&(e=[]);function f(){d(),l.call("tick",t),n<i&&(u.stop(),l.call("end",t))}function d(p){var m,y=e.length,v;p===void 0&&(p=1);for(var x=0;x<p;++x)for(n+=(o-n)*r,s.forEach(function(b){b(n)}),m=0;m<y;++m)v=e[m],v.fx==null?v.x+=v.vx*=a:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=a:(v.y=v.fy,v.vy=0);return t}function h(){for(var p=0,m=e.length,y;p<m;++p){if(y=e[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=BQ*Math.sqrt(.5+p),x=p*UQ;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(e,c),p}return h(),t={tick:d,restart:function(){return u.restart(f),t},stop:function(){return u.stop(),t},nodes:function(p){return arguments.length?(e=p,h(),s.forEach(g),t):e},alpha:function(p){return arguments.length?(n=+p,t):n},alphaMin:function(p){return arguments.length?(i=+p,t):i},alphaDecay:function(p){return arguments.length?(r=+p,t):+r},alphaTarget:function(p){return arguments.length?(o=+p,t):o},velocityDecay:function(p){return arguments.length?(a=1-p,t):1-a},randomSource:function(p){return arguments.length?(c=p,s.forEach(g),t):c},force:function(p,m){return arguments.length>1?(m==null?s.delete(p):s.set(p,g(m)),t):s.get(p)},find:function(p,m,y){var v=0,x=e.length,b,_,E,w,O;for(y==null?y=1/0:y*=y,v=0;v<x;++v)w=e[v],b=p-w.x,_=m-w.y,E=b*b+_*_,E<y&&(O=w,y=E);return O},on:function(p,m){return arguments.length>1?(l.on(p,m),t):l.on(p)}}}function WQ(){var e,t,n,i,r=In(-30),o,a=1,s=1/0,u=.81;function l(h){var g,p=e.length,m=Lw(e,PQ,zQ).visitAfter(f);for(i=h,g=0;g<p;++g)t=e[g],m.visit(d)}function c(){if(!!e){var h,g=e.length,p;for(o=new Array(g),h=0;h<g;++h)p=e[h],o[p.index]=+r(p,h,e)}}function f(h){var g=0,p,m,y=0,v,x,b;if(h.length){for(v=x=b=0;b<4;++b)(p=h[b])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,x+=m*p.y);h.x=v/y,h.y=x/y}else{p=h,p.x=p.data.x,p.y=p.data.y;do g+=o[p.data.index];while(p=p.next)}h.value=g}function d(h,g,p,m){if(!h.value)return!0;var y=h.x-t.x,v=h.y-t.y,x=m-g,b=y*y+v*v;if(x*x/u<b)return b<s&&(y===0&&(y=Ya(n),b+=y*y),v===0&&(v=Ya(n),b+=v*v),b<a&&(b=Math.sqrt(a*b)),t.vx+=y*h.value*i/b,t.vy+=v*h.value*i/b),!0;if(h.length||b>=s)return;(h.data!==t||h.next)&&(y===0&&(y=Ya(n),b+=y*y),v===0&&(v=Ya(n),b+=v*v),b<a&&(b=Math.sqrt(a*b)));do h.data!==t&&(x=o[h.data.index]*i/b,t.vx+=y*x,t.vy+=v*x);while(h=h.next)}return l.initialize=function(h,g){e=h,n=g,c()},l.strength=function(h){return arguments.length?(r=typeof h=="function"?h:In(+h),c(),l):r},l.distanceMin=function(h){return arguments.length?(a=h*h,l):Math.sqrt(a)},l.distanceMax=function(h){return arguments.length?(s=h*h,l):Math.sqrt(s)},l.theta=function(h){return arguments.length?(u=h*h,l):Math.sqrt(u)},l}function HQ(e){var t=In(.1),n,i,r;typeof e!="function"&&(e=In(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vx+=(r[u]-c.x)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:In(+s),a(),o):t},o.x=function(s){return arguments.length?(e=typeof s=="function"?s:In(+s),a(),o):e},o}function GQ(e){var t=In(.1),n,i,r;typeof e!="function"&&(e=In(e==null?0:+e));function o(s){for(var u=0,l=n.length,c;u<l;++u)c=n[u],c.vy+=(r[u]-c.y)*i[u]*s}function a(){if(!!n){var s,u=n.length;for(i=new Array(u),r=new Array(u),s=0;s<u;++s)i[s]=isNaN(r[s]=+e(n[s],s,n))?0:+t(n[s],s,n)}}return o.initialize=function(s){n=s,a()},o.strength=function(s){return arguments.length?(t=typeof s=="function"?s:In(+s),a(),o):t},o.y=function(s){return arguments.length?(e=typeof s=="function"?s:In(+s),a(),o):e},o}const OR={center:aQ,collide:SQ,nbody:WQ,link:kQ,x:HQ,y:GQ},zd="forces",Bw=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],VQ=["static","iterations"],SR=["x","y","vx","vy"];function Uw(e){R.call(this,null,e)}Uw.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:SR}]};W(Uw,R,{transform(e,t){var n=this.value,i=t.changed(t.ADD_REM),r=e.modified(Bw),o=e.iterations||300;if(n?(i&&(t.modifies("index"),n.nodes(t.source)),(r||t.changed(t.MOD))&&AR(n,e,0,t)):(this.value=n=XQ(t.source,e),n.on("tick",YQ(t.dataflow,this)),e.static||(i=!0,n.tick()),t.modifies("index")),r||i||e.modified(VQ)||t.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o)),e.static)for(n.stop();--o>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return t.StopPropagation}return this.finish(e,t)},finish(e,t){const n=t.dataflow;for(let s=this._argops,u=0,l=s.length,c;u<l;++u)if(c=s[u],!(c.name!==zd||c.op._argval.force!=="link")){for(var i=c.op._argops,r=0,o=i.length,a;r<o;++r)if(i[r].name==="links"&&(a=i[r].op.source)){n.pulse(a,n.changeset().reflow());break}}return t.reflow(e.modified()).modifies(SR)}});function YQ(e,t){return()=>e.touch(t).run()}function XQ(e,t){const n=qQ(e),i=n.stop,r=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,r()),n.stop=()=>(o=!0,i()),AR(n,t,!0).on("end",()=>o=!0)}function AR(e,t,n,i){var r=J(t.forces),o,a,s,u;for(o=0,a=Bw.length;o<a;++o)s=Bw[o],s!==zd&&t.modified(s)&&e[s](t[s]);for(o=0,a=r.length;o<a;++o)u=zd+o,s=n||t.modified(zd,o)?JQ(r[o]):i&&KQ(r[o],i)?e.force(u):null,s&&e.force(u,s);for(a=e.numForces||0;o<a;++o)e.force(zd+o,null);return e.numForces=r.length,e}function KQ(e,t){var n,i;for(n in e)if(_e(i=e[n])&&t.modified(fn(i)))return 1;return 0}function JQ(e){var t,n;re(OR,e.force)||L("Unrecognized force: "+e.force),t=OR[e.force]();for(n in e)_e(t[n])&&QQ(t[n],e[n],e);return t}function QQ(e,t,n){e(_e(t)?i=>t(i,n):t)}var ZQ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:Uw});function eZ(e,t){return e.parent===t.parent?1:2}function tZ(e){return e.reduce(nZ,0)/e.length}function nZ(e,t){return e+t.x}function iZ(e){return 1+e.reduce(rZ,0)}function rZ(e,t){return Math.max(e,t.y)}function oZ(e){for(var t;t=e.children;)e=t[0];return e}function aZ(e){for(var t;t=e.children;)e=t[t.length-1];return e}function sZ(){var e=eZ,t=1,n=1,i=!1;function r(o){var a,s=0;o.eachAfter(function(d){var h=d.children;h?(d.x=tZ(h),d.y=iZ(h)):(d.x=a?s+=e(d,a):0,d.y=0,a=d)});var u=oZ(o),l=aZ(o),c=u.x-e(u,l)/2,f=l.x+e(l,u)/2;return o.eachAfter(i?function(d){d.x=(d.x-o.x)*t,d.y=(o.y-d.y)*n}:function(d){d.x=(d.x-c)/(f-c)*t,d.y=(1-(o.y?d.y/o.y:1))*n})}return r.separation=function(o){return arguments.length?(e=o,r):e},r.size=function(o){return arguments.length?(i=!1,t=+o[0],n=+o[1],r):i?null:[t,n]},r.nodeSize=function(o){return arguments.length?(i=!0,t=+o[0],n=+o[1],r):i?[t,n]:null},r}function uZ(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function lZ(){return this.eachAfter(uZ)}function cZ(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function fZ(e,t){for(var n=this,i=[n],r,o,a=-1;n=i.pop();)if(e.call(t,n,++a,this),r=n.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function dZ(e,t){for(var n=this,i=[n],r=[],o,a,s,u=-1;n=i.pop();)if(r.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)i.push(o[a]);for(;n=r.pop();)e.call(t,n,++u,this);return this}function hZ(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function gZ(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,r=i&&i.length;--r>=0;)n+=i[r].value;t.value=n})}function pZ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function mZ(e){for(var t=this,n=yZ(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var r=i.length;e!==n;)i.splice(r,0,e),e=e.parent;return i}function yZ(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),r=null;for(e=n.pop(),t=i.pop();e===t;)r=e,e=n.pop(),t=i.pop();return r}function vZ(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function bZ(){return Array.from(this)}function xZ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function wZ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*_Z(){var e=this,t,n=[e],i,r,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(r=0,o=i.length;r<o;++r)n.push(i[r]);while(n.length)}function qw(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=SZ)):t===void 0&&(t=OZ);for(var n=new nc(e),i,r=[n],o,a,s,u;i=r.pop();)if((a=t(i.data))&&(u=(a=Array.from(a)).length))for(i.children=a,s=u-1;s>=0;--s)r.push(o=a[s]=new nc(a[s])),o.parent=i,o.depth=i.depth+1;return n.eachBefore(kR)}function EZ(){return qw(this).eachBefore(AZ)}function OZ(e){return e.children}function SZ(e){return Array.isArray(e)?e[1]:null}function AZ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function kR(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function nc(e){this.data=e,this.depth=this.height=0,this.parent=null}nc.prototype=qw.prototype={constructor:nc,count:lZ,each:cZ,eachAfter:dZ,eachBefore:fZ,find:hZ,sum:gZ,sort:pZ,path:mZ,ancestors:vZ,descendants:bZ,leaves:xZ,links:wZ,copy:EZ,[Symbol.iterator]:_Z};function kZ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CZ(e){for(var t=e.length,n,i;t;)i=Math.random()*t--|0,n=e[t],e[t]=e[i],e[i]=n;return e}function TZ(e){for(var t=0,n=(e=CZ(Array.from(e))).length,i=[],r,o;t<n;)r=e[t],o&&CR(o,r)?++t:(o=MZ(i=FZ(i,r)),t=0);return o}function FZ(e,t){var n,i;if(Ww(t,e))return[t];for(n=0;n<e.length;++n)if(Vm(t,e[n])&&Ww(Bd(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(i=n+1;i<e.length;++i)if(Vm(Bd(e[n],e[i]),t)&&Vm(Bd(e[n],t),e[i])&&Vm(Bd(e[i],t),e[n])&&Ww(TR(e[n],e[i],t),e))return[e[n],e[i],t];throw new Error}function Vm(e,t){var n=e.r-t.r,i=t.x-e.x,r=t.y-e.y;return n<0||n*n<i*i+r*r}function CR(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function Ww(e,t){for(var n=0;n<t.length;++n)if(!CR(e,t[n]))return!1;return!0}function MZ(e){switch(e.length){case 1:return DZ(e[0]);case 2:return Bd(e[0],e[1]);case 3:return TR(e[0],e[1],e[2])}}function DZ(e){return{x:e.x,y:e.y,r:e.r}}function Bd(e,t){var n=e.x,i=e.y,r=e.r,o=t.x,a=t.y,s=t.r,u=o-n,l=a-i,c=s-r,f=Math.sqrt(u*u+l*l);return{x:(n+o+u/f*c)/2,y:(i+a+l/f*c)/2,r:(f+r+s)/2}}function TR(e,t,n){var i=e.x,r=e.y,o=e.r,a=t.x,s=t.y,u=t.r,l=n.x,c=n.y,f=n.r,d=i-a,h=i-l,g=r-s,p=r-c,m=u-o,y=f-o,v=i*i+r*r-o*o,x=v-a*a-s*s+u*u,b=v-l*l-c*c+f*f,_=h*g-d*p,E=(g*b-p*x)/(_*2)-i,w=(p*m-g*y)/_,O=(h*x-d*b)/(_*2)-r,S=(d*y-h*m)/_,k=w*w+S*S-1,A=2*(o+E*w+O*S),M=E*E+O*O-o*o,C=-(k?(A+Math.sqrt(A*A-4*k*M))/(2*k):M/A);return{x:i+E+w*C,y:r+O+S*C,r:C}}function FR(e,t,n){var i=e.x-t.x,r,o,a=e.y-t.y,s,u,l=i*i+a*a;l?(o=t.r+n.r,o*=o,u=e.r+n.r,u*=u,o>u?(r=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-r*r)),n.x=e.x-r*i-s*a,n.y=e.y-r*a+s*i):(r=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x+r*i-s*a,n.y=t.y+r*a+s*i)):(n.x=t.x+n.r,n.y=t.y)}function MR(e,t){var n=e.r+t.r-1e-6,i=t.x-e.x,r=t.y-e.y;return n>0&&n*n>i*i+r*r}function DR(e){var t=e._,n=e.next._,i=t.r+n.r,r=(t.x*n.r+n.x*t.r)/i,o=(t.y*n.r+n.y*t.r)/i;return r*r+o*o}function Ym(e){this._=e,this.next=null,this.previous=null}function NZ(e){if(!(r=(e=kZ(e)).length))return 0;var t,n,i,r,o,a,s,u,l,c,f;if(t=e[0],t.x=0,t.y=0,!(r>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(r>2))return t.r+n.r;FR(n,t,i=e[2]),t=new Ym(t),n=new Ym(n),i=new Ym(i),t.next=i.previous=n,n.next=t.previous=i,i.next=n.previous=t;e:for(s=3;s<r;++s){FR(t._,n._,i=e[s]),i=new Ym(i),u=n.next,l=t.previous,c=n._.r,f=t._.r;do if(c<=f){if(MR(u._,i._)){n=u,t.next=n,n.previous=t,--s;continue e}c+=u._.r,u=u.next}else{if(MR(l._,i._)){t=l,t.next=n,n.previous=t,--s;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=t,i.next=n,t.next=n.previous=n=i,o=DR(t);(i=i.next)!==n;)(a=DR(i))<o&&(t=i,o=a);n=t.next}for(t=[n._],i=n;(i=i.next)!==n;)t.push(i._);for(i=TZ(t),s=0;s<r;++s)t=e[s],t.x-=i.x,t.y-=i.y;return i.r}function RZ(e){return e==null?null:Xm(e)}function Xm(e){if(typeof e!="function")throw new Error;return e}function nu(){return 0}function ic(e){return function(){return e}}function jZ(e){return Math.sqrt(e.value)}function $Z(){var e=null,t=1,n=1,i=nu;function r(o){return o.x=t/2,o.y=n/2,e?o.eachBefore(NR(e)).eachAfter(Hw(i,.5)).eachBefore(RR(1)):o.eachBefore(NR(jZ)).eachAfter(Hw(nu,1)).eachAfter(Hw(i,o.r/Math.min(t,n))).eachBefore(RR(Math.min(t,n)/(2*o.r))),o}return r.radius=function(o){return arguments.length?(e=RZ(o),r):e},r.size=function(o){return arguments.length?(t=+o[0],n=+o[1],r):[t,n]},r.padding=function(o){return arguments.length?(i=typeof o=="function"?o:ic(+o),r):i},r}function NR(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Hw(e,t){return function(n){if(i=n.children){var i,r,o=i.length,a=e(n)*t||0,s;if(a)for(r=0;r<o;++r)i[r].r+=a;if(s=NZ(i),a)for(r=0;r<o;++r)i[r].r-=a;n.r=s+a}}}function RR(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function jR(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Ud(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(i-t)/e.value;++s<u;)a=o[s],a.y0=n,a.y1=r,a.x0=t,a.x1=t+=a.value*l}function LZ(){var e=1,t=1,n=0,i=!1;function r(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/s,a.eachBefore(o(t,s)),i&&a.eachBefore(jR),a}function o(a,s){return function(u){u.children&&Ud(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,c=u.y0,f=u.x1-n,d=u.y1-n;f<l&&(l=f=(l+f)/2),d<c&&(c=d=(c+d)/2),u.x0=l,u.y0=c,u.x1=f,u.y1=d}}return r.round=function(a){return arguments.length?(i=!!a,r):i},r.size=function(a){return arguments.length?(e=+a[0],t=+a[1],r):[e,t]},r.padding=function(a){return arguments.length?(n=+a,r):n},r}var IZ={depth:-1},$R={};function PZ(e){return e.id}function zZ(e){return e.parentId}function LR(){var e=PZ,t=zZ;function n(i){var r=Array.from(i),o=r.length,a,s,u,l,c,f,d,h=new Map;for(s=0;s<o;++s)a=r[s],c=r[s]=new nc(a),(f=e(a,s,i))!=null&&(f+="")&&(d=c.id=f,h.set(d,h.has(d)?$R:c)),(f=t(a,s,i))!=null&&(f+="")&&(c.parent=f);for(s=0;s<o;++s)if(c=r[s],f=c.parent){if(l=h.get(f),!l)throw new Error("missing: "+f);if(l===$R)throw new Error("ambiguous: "+f);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(u)throw new Error("multiple roots");u=c}if(!u)throw new Error("no root");if(u.parent=IZ,u.eachBefore(function(g){g.depth=g.parent.depth+1,--o}).eachBefore(kR),u.parent=null,o>0)throw new Error("cycle");return u}return n.id=function(i){return arguments.length?(e=Xm(i),n):e},n.parentId=function(i){return arguments.length?(t=Xm(i),n):t},n}function BZ(e,t){return e.parent===t.parent?1:2}function Gw(e){var t=e.children;return t?t[0]:e.t}function Vw(e){var t=e.children;return t?t[t.length-1]:e.t}function UZ(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function qZ(e){for(var t=0,n=0,i=e.children,r=i.length,o;--r>=0;)o=i[r],o.z+=t,o.m+=t,t+=o.s+(n+=o.c)}function WZ(e,t,n){return e.a.parent===t.parent?e.a:n}function Km(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Km.prototype=Object.create(nc.prototype);function HZ(e){for(var t=new Km(e,0),n,i=[t],r,o,a,s;n=i.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)i.push(r=n.children[a]=new Km(o[a],a)),r.parent=n;return(t.parent=new Km(null,0)).children=[t],t}function GZ(){var e=BZ,t=1,n=1,i=null;function r(l){var c=HZ(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),i)l.eachBefore(u);else{var f=l,d=l,h=l;l.eachBefore(function(v){v.x<f.x&&(f=v),v.x>d.x&&(d=v),v.depth>h.depth&&(h=v)});var g=f===d?1:e(f,d)/2,p=g-f.x,m=t/(d.x+g+p),y=n/(h.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){qZ(l);var h=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+e(l._,d._),l.m=l.z-h):l.z=h}else d&&(l.z=d.z+e(l._,d._));l.parent.A=s(l,d,l.parent.A||f[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,c,f){if(c){for(var d=l,h=l,g=c,p=d.parent.children[0],m=d.m,y=h.m,v=g.m,x=p.m,b;g=Vw(g),d=Gw(d),g&&d;)p=Gw(p),h=Vw(h),h.a=l,b=g.z+v-d.z-m+e(g._,d._),b>0&&(UZ(WZ(g,l,f),l,b),m+=b,y+=b),v+=g.m,m+=d.m,x+=p.m,y+=h.m;g&&!Vw(h)&&(h.t=g,h.m+=v-y),d&&!Gw(p)&&(p.t=d,p.m+=m-x,f=l)}return f}function u(l){l.x*=t,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(e=l,r):e},r.size=function(l){return arguments.length?(i=!1,t=+l[0],n=+l[1],r):i?null:[t,n]},r.nodeSize=function(l){return arguments.length?(i=!0,t=+l[0],n=+l[1],r):i?[t,n]:null},r}function Jm(e,t,n,i,r){for(var o=e.children,a,s=-1,u=o.length,l=e.value&&(r-n)/e.value;++s<u;)a=o[s],a.x0=t,a.x1=i,a.y0=n,a.y1=n+=a.value*l}var IR=(1+Math.sqrt(5))/2;function PR(e,t,n,i,r,o){for(var a=[],s=t.children,u,l,c=0,f=0,d=s.length,h,g,p=t.value,m,y,v,x,b,_,E;c<d;){h=r-n,g=o-i;do m=s[f++].value;while(!m&&f<d);for(y=v=m,_=Math.max(g/h,h/g)/(p*e),E=m*m*_,b=Math.max(v/E,E/y);f<d;++f){if(m+=l=s[f].value,l<y&&(y=l),l>v&&(v=l),E=m*m*_,x=Math.max(v/E,E/y),x>b){m-=l;break}b=x}a.push(u={value:m,dice:h<g,children:s.slice(c,f)}),u.dice?Ud(u,n,i,r,p?i+=g*m/p:o):Jm(u,n,i,p?n+=h*m/p:r,o),p-=m,c=f}return a}var zR=function e(t){function n(i,r,o,a,s){PR(t,i,r,o,a,s)}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(IR);function VZ(){var e=zR,t=!1,n=1,i=1,r=[0],o=nu,a=nu,s=nu,u=nu,l=nu;function c(d){return d.x0=d.y0=0,d.x1=n,d.y1=i,d.eachBefore(f),r=[0],t&&d.eachBefore(jR),d}function f(d){var h=r[d.depth],g=d.x0+h,p=d.y0+h,m=d.x1-h,y=d.y1-h;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),d.x0=g,d.y0=p,d.x1=m,d.y1=y,d.children&&(h=r[d.depth+1]=o(d)/2,g+=l(d)-h,p+=a(d)-h,m-=s(d)-h,y-=u(d)-h,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),e(d,g,p,m,y))}return c.round=function(d){return arguments.length?(t=!!d,c):t},c.size=function(d){return arguments.length?(n=+d[0],i=+d[1],c):[n,i]},c.tile=function(d){return arguments.length?(e=Xm(d),c):e},c.padding=function(d){return arguments.length?c.paddingInner(d).paddingOuter(d):c.paddingInner()},c.paddingInner=function(d){return arguments.length?(o=typeof d=="function"?d:ic(+d),c):o},c.paddingOuter=function(d){return arguments.length?c.paddingTop(d).paddingRight(d).paddingBottom(d).paddingLeft(d):c.paddingTop()},c.paddingTop=function(d){return arguments.length?(a=typeof d=="function"?d:ic(+d),c):a},c.paddingRight=function(d){return arguments.length?(s=typeof d=="function"?d:ic(+d),c):s},c.paddingBottom=function(d){return arguments.length?(u=typeof d=="function"?d:ic(+d),c):u},c.paddingLeft=function(d){return arguments.length?(l=typeof d=="function"?d:ic(+d),c):l},c}function YZ(e,t,n,i,r){var o=e.children,a,s=o.length,u,l=new Array(s+1);for(l[0]=u=a=0;a<s;++a)l[a+1]=u+=o[a].value;c(0,s,e.value,t,n,i,r);function c(f,d,h,g,p,m,y){if(f>=d-1){var v=o[f];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var x=l[f],b=h/2+x,_=f+1,E=d-1;_<E;){var w=_+E>>>1;l[w]<b?_=w+1:E=w}b-l[_-1]<l[_]-b&&f+1<_&&--_;var O=l[_]-x,S=h-O;if(m-g>y-p){var k=h?(g*S+m*O)/h:m;c(f,_,O,g,p,k,y),c(_,d,S,k,p,m,y)}else{var A=h?(p*S+y*O)/h:y;c(f,_,O,g,p,m,A),c(_,d,S,g,A,m,y)}}}function XZ(e,t,n,i,r){(e.depth&1?Jm:Ud)(e,t,n,i,r)}var KZ=function e(t){function n(i,r,o,a,s){if((u=i._squarify)&&u.ratio===t)for(var u,l,c,f,d=-1,h,g=u.length,p=i.value;++d<g;){for(l=u[d],c=l.children,f=l.value=0,h=c.length;f<h;++f)l.value+=c[f].value;l.dice?Ud(l,r,o,a,p?o+=(s-o)*l.value/p:s):Jm(l,r,o,p?r+=(a-r)*l.value/p:a,s),p-=l.value}else i._squarify=u=PR(t,i,r,o,a,s),u.ratio=t}return n.ratio=function(i){return e((i=+i)>1?i:1)},n}(IR);function Yw(e,t,n){const i={};return e.each(r=>{const o=r.data;n(o)&&(i[t(o)]=r)}),e.lookup=i,e}function Xw(e){R.call(this,null,e)}Xw.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const JZ=e=>e.values;W(Xw,R,{transform(e,t){t.source||L("Nest transform requires an upstream data source.");var n=e.generate,i=e.modified(),r=t.clone(),o=this.value;return(!o||i||t.changed())&&(o&&o.each(a=>{a.children&&Ug(a.data)&&r.rem.push(a.data)}),this.value=o=qw({values:J(e.keys).reduce((a,s)=>(a.key(s),a),QZ()).entries(r.source)},JZ),n&&o.each(a=>{a.children&&(a=Ue(a.data),r.add.push(a),r.source.push(a))}),Yw(o,ae,ae)),r.source.root=o,r}});function QZ(){const e=[],t={entries:r=>i(n(r,0),0),key:r=>(e.push(r),t)};function n(r,o){if(o>=e.length)return r;const a=r.length,s=e[o++],u={},l={};let c=-1,f,d,h;for(;++c<a;)f=s(d=r[c])+"",(h=u[f])?h.push(d):u[f]=[d];for(f in u)l[f]=n(u[f],o);return l}function i(r,o){if(++o>e.length)return r;const a=[];for(const s in r)a.push({key:s,values:i(r[s],o)});return a}return t}function Bo(e){R.call(this,null,e)}const ZZ=(e,t)=>e.parent===t.parent?1:2;W(Bo,R,{transform(e,t){(!t.source||!t.source.root)&&L(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(e.method),i=this.fields,r=t.source.root,o=e.as||i;e.field?r.sum(e.field):r.count(),e.sort&&r.sort($s(e.sort,a=>a.data)),eee(n,this.params,e),n.separation&&n.separation(e.separation!==!1?ZZ:fl);try{this.value=n(r)}catch(a){L(a)}return r.each(a=>tee(a,i,o)),t.reflow(e.modified()).modifies(o).modifies("leaf")}});function eee(e,t,n){for(let i,r=0,o=t.length;r<o;++r)i=t[r],i in n&&e[i](n[i])}function tee(e,t,n){const i=e.data,r=t.length-1;for(let o=0;o<r;++o)i[n[o]]=e[t[o]];i[n[r]]=e.children?e.children.length:0}const Kw=["x","y","r","depth","children"];function Jw(e){Bo.call(this,e)}Jw.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Kw.length,default:Kw}]};W(Jw,Bo,{layout:$Z,params:["radius","size","padding"],fields:Kw});const Qw=["x0","y0","x1","y1","depth","children"];function Zw(e){Bo.call(this,e)}Zw.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Qw.length,default:Qw}]};W(Zw,Bo,{layout:LZ,params:["size","round","padding"],fields:Qw});function e_(e){R.call(this,null,e)}e_.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};W(e_,R,{transform(e,t){t.source||L("Stratify transform requires an upstream data source.");let n=this.value;const i=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),o=!n||i||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),o&&(n=r.source.length?Yw(LR().id(e.key).parentId(e.parentKey)(r.source),e.key,Ni):Yw(LR()([{}]),e.key,e.key)),r.source.root=this.value=n,r}});const BR={tidy:GZ,cluster:sZ},t_=["x","y","depth","children"];function n_(e){Bo.call(this,e)}n_.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:t_.length,default:t_}]};W(n_,Bo,{layout(e){const t=e||"tidy";if(re(BR,t))return BR[t]();L("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:t_});function i_(e){R.call(this,[],e)}i_.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};W(i_,R,{transform(e,t){const n=this.value,i=t.source&&t.source.root,r=t.fork(t.NO_SOURCE),o={};return i||L("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(r.rem=n,t.visit(t.SOURCE,a=>o[ae(a)]=1),i.each(a=>{const s=a.data,u=a.parent&&a.parent.data;u&&o[ae(s)]&&o[ae(u)]&&r.add.push(Ue({source:u,target:s}))}),this.value=r.add):t.changed(t.MOD)&&(t.visit(t.MOD,a=>o[ae(a)]=1),n.forEach(a=>{(o[ae(a.source)]||o[ae(a.target)])&&r.mod.push(a)})),r}});const UR={binary:YZ,dice:Ud,slice:Jm,slicedice:XZ,squarify:zR,resquarify:KZ},r_=["x0","y0","x1","y1","depth","children"];function o_(e){Bo.call(this,e)}o_.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:r_.length,default:r_}]};W(o_,Bo,{layout(){const e=VZ();return e.ratio=t=>{const n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=t=>{re(UR,t)?e.tile(UR[t]):L("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:r_});var nee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:Xw,pack:Jw,partition:Zw,stratify:e_,tree:n_,treelinks:i_,treemap:o_});const iee=4278190080,ree=268435456,oee=.0625;function aee(e,t){const n=e.bitmap();return(t||[]).forEach(i=>n.set(e(i.boundary[0]),e(i.boundary[3]))),[n,void 0]}function see(e,t,n,i){const r=e.width,o=e.height,a=n||i,s=Tl(r,o).getContext("2d");t.forEach(m=>qR(s,m,a));const u=new Uint32Array(s.getImageData(0,0,r,o).data.buffer),l=e.bitmap(),c=a&&e.bitmap();let f,d,h,g,p;for(d=0;d<o;++d)for(f=0;f<r;++f)p=u[d*r+f]&iee,p&&(h=e(f),g=e(d),i||l.set(h,g),a&&p^ree&&c.set(h,g));return[l,c]}function qR(e,t,n){if(!t.length)return;const i=t[0].mark.marktype;i==="group"?t.forEach(r=>{r.items.forEach(o=>qR(e,o.items,n))}):xi[i].draw(e,{items:n?t.map(uee):t})}function uee(e){const t=qg(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=oee,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}const Uo=5,Pn=31,qd=32,Xa=new Uint32Array(qd+1),dr=new Uint32Array(qd+1);dr[0]=0;Xa[0]=~dr[0];for(let e=1;e<=qd;++e)dr[e]=dr[e-1]<<1|1,Xa[e]=~dr[e];function lee(e,t){const n=new Uint32Array(~~((e*t+qd)/qd));function i(o,a){n[o]|=a}function r(o,a){n[o]&=a}return{array:n,get:(o,a)=>{const s=a*e+o;return n[s>>>Uo]&1<<(s&Pn)},set:(o,a)=>{const s=a*e+o;i(s>>>Uo,1<<(s&Pn))},clear:(o,a)=>{const s=a*e+o;r(s>>>Uo,~(1<<(s&Pn)))},getRange:(o,a,s,u)=>{let l=u,c,f,d,h;for(;l>=a;--l)if(c=l*e+o,f=l*e+s,d=c>>>Uo,h=f>>>Uo,d===h){if(n[d]&Xa[c&Pn]&dr[(f&Pn)+1])return!0}else{if(n[d]&Xa[c&Pn]||n[h]&dr[(f&Pn)+1])return!0;for(let g=d+1;g<h;++g)if(n[g])return!0}return!1},setRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Uo,d=c>>>Uo,f===d)i(f,Xa[l&Pn]&dr[(c&Pn)+1]);else for(i(f,Xa[l&Pn]),i(d,dr[(c&Pn)+1]),h=f+1;h<d;++h)i(h,4294967295)},clearRange:(o,a,s,u)=>{let l,c,f,d,h;for(;a<=u;++a)if(l=a*e+o,c=a*e+s,f=l>>>Uo,d=c>>>Uo,f===d)r(f,dr[l&Pn]|Xa[(c&Pn)+1]);else for(r(f,dr[l&Pn]),r(d,Xa[(c&Pn)+1]),h=f+1;h<d;++h)r(h,0)},outOfBounds:(o,a,s,u)=>o<0||a<0||u>=t||s>=e}}function cee(e,t,n){const i=Math.max(1,Math.sqrt(e*t/1e6)),r=~~((e+2*n+i)/i),o=~~((t+2*n+i)/i),a=s=>~~((s+n)/i);return a.invert=s=>s*i-n,a.bitmap=()=>lee(r,o),a.ratio=i,a.padding=n,a.width=e,a.height=t,a}function fee(e,t,n,i){const r=e.width,o=e.height;return function(a){const s=a.datum.datum.items[i].items,u=s.length,l=a.datum.fontSize,c=Vr.width(a.datum,a.datum.text);let f=0,d,h,g,p,m,y,v;for(let x=0;x<u;++x)d=s[x].x,g=s[x].y,h=s[x].x2===void 0?d:s[x].x2,p=s[x].y2===void 0?g:s[x].y2,m=(d+h)/2,y=(g+p)/2,v=Math.abs(h-d+p-g),v>=f&&(f=v,a.x=m,a.y=y);return m=c/2,y=l/2,d=a.x-m,h=a.x+m,g=a.y-y,p=a.y+y,a.align="center",d<0&&h<=r?a.align="left":0<=d&&r<h&&(a.align="right"),a.baseline="middle",g<0&&p<=o?a.baseline="top":0<=g&&o<p&&(a.baseline="bottom"),!0}}function dee(e,t,n,i,r,o){let a=n/2;return e-a<0||e+a>r||t-(a=i/2)<0||t+a>o}function hee(){return!1}function gee(e,t,n,i,r,o,a,s){const u=r*o/(i*2),l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return a.outOfBounds(l,f,c,d)||a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function pee(e,t,n,i,r,o,a,s){const u=r*o/(i*2);let l=e(t-u),c=e(t+u),f=e(n-(o=o/2)),d=e(n+o);return l=l>0?l:0,f=f>0?f:0,c=c<e.width?c:e.width-1,d=d<e.height?d:e.height-1,a.getRange(l,f,c,d)||s&&s.getRange(l,f,c,d)}function WR(e){return e?[pee,hee]:[gee,dee]}function mee(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=WR(r),l=t[0],c=t[1];function f(d,h,g,p,m){const y=e.invert(d),v=e.invert(h);let x=g,b=a,_;if(!u(y,v,p,m,o,a)&&!s(e,y,v,m,p,x,l,c)&&!s(e,y,v,m,p,m,l,null)){for(;b-x>=1;)_=(x+b)/2,s(e,y,v,m,p,_,l,c)?b=_:x=_;if(x>g)return[y,v,x,!0]}}return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=Vr.width(d.datum,d.datum.text);let y=n?p:0,v=!1,x=!1,b=0,_,E,w,O,S,k,A,M,C,D,F,N,I,z,X,te,xe;for(let ge=0;ge<g;++ge){for(_=h[ge].x,w=h[ge].y,E=h[ge].x2===void 0?_:h[ge].x2,O=h[ge].y2===void 0?w:h[ge].y2,_>E&&(xe=_,_=E,E=xe),w>O&&(xe=w,w=O,O=xe),C=e(_),F=e(E),D=~~((C+F)/2),N=e(w),z=e(O),I=~~((N+z)/2),A=D;A>=C;--A)for(M=I;M>=N;--M)te=f(A,M,y,m,p),te&&([d.x,d.y,y,v]=te);for(A=D;A<=F;++A)for(M=I;M<=z;++M)te=f(A,M,y,m,p),te&&([d.x,d.y,y,v]=te);!v&&!n&&(X=Math.abs(E-_+O-w),S=(_+E)/2,k=(w+O)/2,X>=b&&!u(S,k,m,p,o,a)&&!s(e,S,k,p,m,p,l,null)&&(b=X,d.x=S,d.y=k,x=!0))}return v||x?(S=m/2,k=p/2,l.setRange(e(d.x-S),e(d.y-k),e(d.x+S),e(d.y+k)),d.align="center",d.baseline="middle",!0):!1}}const yee=[-1,-1,1,1],vee=[-1,1,-1,1];function bee(e,t,n,i,r){const o=e.width,a=e.height,[s,u]=WR(r),l=t[0],c=t[1],f=e.bitmap();return function(d){const h=d.datum.datum.items[i].items,g=h.length,p=d.datum.fontSize,m=Vr.width(d.datum,d.datum.text),y=[];let v=n?p:0,x=!1,b=!1,_=0,E,w,O,S,k,A,M,C,D,F,N,I;for(let z=0;z<g;++z){for(E=h[z].x,O=h[z].y,w=h[z].x2===void 0?E:h[z].x2,S=h[z].y2===void 0?O:h[z].y2,y.push([e((E+w)/2),e((O+S)/2)]);y.length;)if([M,C]=y.pop(),!(l.get(M,C)||c.get(M,C)||f.get(M,C))){f.set(M,C);for(let X=0;X<4;++X)k=M+yee[X],A=C+vee[X],f.outOfBounds(k,A,k,A)||y.push([k,A]);if(k=e.invert(M),A=e.invert(C),D=v,F=a,!u(k,A,m,p,o,a)&&!s(e,k,A,p,m,D,l,c)&&!s(e,k,A,p,m,p,l,null)){for(;F-D>=1;)N=(D+F)/2,s(e,k,A,p,m,N,l,c)?F=N:D=N;D>v&&(d.x=k,d.y=A,v=D,x=!0)}}!x&&!n&&(I=Math.abs(w-E+S-O),k=(E+w)/2,A=(O+S)/2,I>=_&&!u(k,A,m,p,o,a)&&!s(e,k,A,p,m,p,l,null)&&(_=I,d.x=k,d.y=A,b=!0))}return x||b?(k=m/2,A=p/2,l.setRange(e(d.x-k),e(d.y-A),e(d.x+k),e(d.y+A)),d.align="center",d.baseline="middle",!0):!1}}const xee=["right","center","left"],wee=["bottom","middle","top"];function _ee(e,t,n,i,r){const o=e.width,a=e.height,s=t[0],u=t[1],l=i.length;return function(c){const f=c.boundary,d=c.datum.fontSize;if(!r&&(f[2]<0||f[5]<0||f[0]>o||f[3]>a))return!1;let h=0,g,p,m,y,v,x,b,_,E,w,O,S,k,A,M;for(let C=0;C<l;++C){if(g=(n[C]&3)-1,p=(n[C]>>>2&3)-1,m=g===0&&p===0||i[C]<0,y=g&&p?Math.SQRT1_2:1,v=i[C]<0?-1:1,x=f[1+g]+i[C]*g*y,O=f[4+p]+v*d*p/2+i[C]*p*y,_=O-d/2,E=O+d/2,S=e(x),A=e(_),M=e(E),r&&(S=S<0?0:S,A=A<0?0:A,M=M>=e.height?e.height-1:M),!h)if(HR(S,S,A,M,s,u,x,x,_,E,f,m))h=Vr.width(c.datum,c.datum.text);else continue;if(w=x+v*h*g/2,x=w-h/2,b=w+h/2,S=e(x),k=e(b),r&&(S=S<0?0:S,k=k>=e.width?e.width-1:k),HR(S,k,A,M,s,u,x,b,_,E,f,m))return c.x=g?g*v<0?b:x:w,c.y=p?p*v<0?E:_:O,c.align=xee[g*v+1],c.baseline=wee[p*v+1],s.setRange(S,A,k,M),!0}return!1}}function HR(e,t,n,i,r,o,a,s,u,l,c,f){return!(r.outOfBounds(e,n,t,i)||(f&&o?o.getRange(e,n,t,i)||!Eee(a,u,s,l,c):r.getRange(e,n,t,i)))}function Eee(e,t,n,i,r){return r[0]<=e&&n<=r[2]&&r[3]<=t&&i<=r[5]}const a_=0,s_=4,u_=8,l_=0,c_=1,f_=2,Oee={"top-left":a_+l_,top:a_+c_,"top-right":a_+f_,left:s_+l_,middle:s_+c_,right:s_+f_,"bottom-left":u_+l_,bottom:u_+c_,"bottom-right":u_+f_},See={naive:fee,"reduced-search":mee,floodfill:bee};function Aee(e,t,n,i,r,o,a,s,u,l,c){if(!e.length)return e;const f=Math.max(i.length,r.length),d=kee(i,f),h=Cee(r,f),g=Tee(e[0].datum),p=g==="group"&&e[0].datum.items[u].marktype,m=p==="area",y=Fee(g,p,s,u),v=l===null||l===1/0,x=cee(t[0],t[1],v?0:l),b=m&&c==="naive",_=e.map(O=>({datum:O,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(O)}));let E;if(!b){n&&_.sort((S,k)=>n(S.datum,k.datum));let O=!1;for(let S=0;S<h.length&&!O;++S)O=h[S]===5||d[S]<0;g&&(a||m)&&(o=[e.map(S=>S.datum)].concat(o)),E=o.length?see(x,o,O,m):aee(x,a&&_)}const w=m?See[c](x,E,a,u,v):_ee(x,E,h,d,v);return _.forEach(O=>O.opacity=+w(O)),_}function kee(e,t){const n=new Float64Array(t),i=e.length;for(let r=0;r<i;++r)n[r]=e[r]||0;for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Cee(e,t){const n=new Int8Array(t),i=e.length;for(let r=0;r<i;++r)n[r]|=Oee[e[r]];for(let r=i;r<t;++r)n[r]=n[i-1];return n}function Tee(e){return e&&e.mark&&e.mark.marktype}function Fee(e,t,n,i){const r=o=>[o.x,o.x,o.x,o.y,o.y,o.y];return e?e==="line"||e==="area"?o=>r(o.datum):t==="line"?o=>{const a=o.datum.items[i].items;return r(a.length?a[n==="start"?0:a.length-1]:{x:NaN,y:NaN})}:o=>{const a=o.datum.bounds;return[a.x1,(a.x1+a.x2)/2,a.x2,a.y1,(a.y1+a.y2)/2,a.y2]}:r}const d_=["x","y","opacity","align","baseline"],GR=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function h_(e){R.call(this,null,e)}h_.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:GR},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:d_.length,default:d_}]};W(h_,R,{transform(e,t){function n(o){const a=e[o];return _e(a)&&t.modified(a.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||n("sort")))return;(!e.size||e.size.length!==2)&&L("Size parameter should be specified as a [width, height] array.");const r=e.as||d_;return Aee(t.materialize(t.SOURCE).source||[],e.size,e.sort,J(e.offset==null?1:e.offset),J(e.anchor||GR),e.avoidMarks||[],e.avoidBaseMark!==!1,e.lineAnchor||"end",e.markIndex||0,e.padding===void 0?0:e.padding,e.method||"naive").forEach(o=>{const a=o.datum;a[r[0]]=o.x,a[r[1]]=o.y,a[r[2]]=o.opacity,a[r[3]]=o.align,a[r[4]]=o.baseline}),t.reflow(i).modifies(r)}});var Mee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:h_});function VR(e,t){var n=[],i=function(c){return c(s)},r,o,a,s,u,l;if(t==null)n.push(e);else for(r={},o=0,a=e.length;o<a;++o)s=e[o],u=t.map(i),l=r[u],l||(r[u]=l=[],l.dims=u,n.push(l)),l.push(s);return n}function g_(e){R.call(this,null,e)}g_.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};W(g_,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=VR(i,e.groupby),o=(e.groupby||[]).map(yt),a=o.length,s=e.as||[yt(e.x),yt(e.y)],u=[];r.forEach(l=>{uF(l,e.x,e.y,e.bandwidth||.3).forEach(c=>{const f={};for(let d=0;d<a;++d)f[o[d]]=l.dims[d];f[s[0]]=c[0],f[s[1]]=c[1],u.push(Ue(f))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const p_={linear:ub,log:nF,exp:iF,pow:rF,quad:lb,poly:oF},Dee=(e,t)=>e==="poly"?t:e==="quad"?2:1;function m_(e){R.call(this,null,e)}m_.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(p_)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};W(m_,R,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const i=t.materialize(t.SOURCE).source,r=VR(i,e.groupby),o=(e.groupby||[]).map(yt),a=e.method||"linear",s=e.order||3,u=Dee(a,s),l=e.as||[yt(e.x),yt(e.y)],c=p_[a],f=[];let d=e.extent;re(p_,a)||L("Invalid regression method: "+a),d!=null&&a==="log"&&d[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),r.forEach(h=>{if(h.length<=u){t.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=c(h,e.x,e.y,s);if(e.params){f.push(Ue({keys:h.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=d||$r(h,e.x),y=v=>{const x={};for(let b=0;b<o.length;++b)x[o[b]]=h.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],f.push(Ue(x))};a==="linear"?m.forEach(v=>y([v,p.predict(v)])):Zg(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var Nee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:g_,regression:m_});const YR=Math.pow(2,-52),Qm=new Uint32Array(512);class Zm{static from(t,n=Iee,i=Pee){const r=t.length,o=new Float64Array(r*2);for(let a=0;a<r;a++){const s=t[a];o[2*a]=n(s),o[2*a+1]=i(s)}return new Zm(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,a=t.length>>1;let s=1/0,u=1/0,l=-1/0,c=-1/0;for(let k=0;k<a;k++){const A=t[2*k],M=t[2*k+1];A<s&&(s=A),M<u&&(u=M),A>l&&(l=A),M>c&&(c=M),this._ids[k]=k}const f=(s+l)/2,d=(u+c)/2;let h=1/0,g,p,m;for(let k=0;k<a;k++){const A=y_(f,d,t[2*k],t[2*k+1]);A<h&&(g=k,h=A)}const y=t[2*g],v=t[2*g+1];h=1/0;for(let k=0;k<a;k++){if(k===g)continue;const A=y_(y,v,t[2*k],t[2*k+1]);A<h&&A>0&&(p=k,h=A)}let x=t[2*p],b=t[2*p+1],_=1/0;for(let k=0;k<a;k++){if(k===g||k===p)continue;const A=$ee(y,v,x,b,t[2*k],t[2*k+1]);A<_&&(m=k,_=A)}let E=t[2*m],w=t[2*m+1];if(_===1/0){for(let M=0;M<a;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];rc(this._ids,this._dists,0,a-1);const k=new Uint32Array(a);let A=0;for(let M=0,C=-1/0;M<a;M++){const D=this._ids[M];this._dists[D]>C&&(k[A++]=D,C=this._dists[D])}this.hull=k.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(e0(y,v,x,b,E,w)){const k=p,A=x,M=b;p=m,x=E,b=w,m=k,E=A,w=M}const O=Lee(y,v,x,b,E,w);this._cx=O.x,this._cy=O.y;for(let k=0;k<a;k++)this._dists[k]=y_(t[2*k],t[2*k+1],O.x,O.y);rc(this._ids,this._dists,0,a-1),this._hullStart=g;let S=3;i[g]=n[m]=p,i[p]=n[g]=m,i[m]=n[p]=g,r[g]=0,r[p]=1,r[m]=2,o.fill(-1),o[this._hashKey(y,v)]=g,o[this._hashKey(x,b)]=p,o[this._hashKey(E,w)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let k=0,A,M;k<this._ids.length;k++){const C=this._ids[k],D=t[2*C],F=t[2*C+1];if(k>0&&Math.abs(D-A)<=YR&&Math.abs(F-M)<=YR||(A=D,M=F,C===g||C===p||C===m))continue;let N=0;for(let xe=0,ge=this._hashKey(D,F);xe<this._hashSize&&(N=o[(ge+xe)%this._hashSize],!(N!==-1&&N!==i[N]));xe++);N=n[N];let I=N,z;for(;z=i[I],!e0(D,F,t[2*I],t[2*I+1],t[2*z],t[2*z+1]);)if(I=z,I===N){I=-1;break}if(I===-1)continue;let X=this._addTriangle(I,C,i[I],-1,-1,r[I]);r[C]=this._legalize(X+2),r[I]=X,S++;let te=i[I];for(;z=i[te],e0(D,F,t[2*te],t[2*te+1],t[2*z],t[2*z+1]);)X=this._addTriangle(te,C,z,r[C],-1,r[te]),r[C]=this._legalize(X+2),i[te]=te,S--,te=z;if(I===N)for(;z=n[I],e0(D,F,t[2*z],t[2*z+1],t[2*I],t[2*I+1]);)X=this._addTriangle(z,C,I,-1,r[I],r[z]),this._legalize(X+2),r[z]=X,i[I]=I,S--,I=z;this._hullStart=n[C]=I,i[I]=n[te]=C,i[C]=te,o[this._hashKey(D,F)]=C,o[this._hashKey(t[2*I],t[2*I+1])]=I}this.hull=new Uint32Array(S);for(let k=0,A=this._hullStart;k<S;k++)this.hull[k]=A,A=i[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Ree(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,a=0;for(;;){const s=i[t],u=t-t%3;if(a=u+(t+2)%3,s===-1){if(o===0)break;t=Qm[--o];continue}const l=s-s%3,c=u+(t+1)%3,f=l+(s+2)%3,d=n[a],h=n[t],g=n[c],p=n[f];if(jee(r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*g],r[2*g+1],r[2*p],r[2*p+1])){n[t]=p,n[s]=d;const y=i[f];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===f){this._hullTri[x]=t;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(t,y),this._link(s,i[a]),this._link(a,f);const v=l+(s+1)%3;o<Qm.length&&(Qm[o++]=v)}else{if(o===0)break;t=Qm[--o]}}return a}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,a){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=n,this._triangles[s+2]=i,this._link(s,r),this._link(s+1,o),this._link(s+2,a),this.trianglesLen+=3,s}}function Ree(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function y_(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function v_(e,t,n,i,r,o){const a=(i-t)*(r-e),s=(n-e)*(o-t);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function e0(e,t,n,i,r,o){return(v_(r,o,e,t,n,i)||v_(e,t,n,i,r,o)||v_(n,i,r,o,e,t))<0}function jee(e,t,n,i,r,o,a,s){const u=e-a,l=t-s,c=n-a,f=i-s,d=r-a,h=o-s,g=u*u+l*l,p=c*c+f*f,m=d*d+h*h;return u*(f*m-p*h)-l*(c*m-p*d)+g*(c*h-f*d)<0}function $ee(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=(l*c-s*f)*d,g=(a*f-u*c)*d;return h*h+g*g}function Lee(e,t,n,i,r,o){const a=n-e,s=i-t,u=r-e,l=o-t,c=a*a+s*s,f=u*u+l*l,d=.5/(a*l-s*u),h=e+(l*c-s*f)*d,g=t+(a*f-u*c)*d;return{x:h,y:g}}function rc(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],a=t[o];let s=r-1;for(;s>=n&&t[e[s]]>a;)e[s+1]=e[s--];e[s+1]=o}else{const r=n+i>>1;let o=n+1,a=i;Wd(e,r,o),t[e[n]]>t[e[i]]&&Wd(e,n,i),t[e[o]]>t[e[i]]&&Wd(e,o,i),t[e[n]]>t[e[o]]&&Wd(e,n,o);const s=e[o],u=t[s];for(;;){do o++;while(t[e[o]]<u);do a--;while(t[e[a]]>u);if(a<o)break;Wd(e,o,a)}e[n+1]=e[a],e[a]=s,i-o+1>=a-n?(rc(e,t,o,i),rc(e,t,n,a-1)):(rc(e,t,n,a-1),rc(e,t,o,i))}}function Wd(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Iee(e){return e[0]}function Pee(e){return e[1]}const XR=1e-6;class iu{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,i){t=+t,n=+n,i=+i;const r=t+i,o=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${o}`:(Math.abs(this._x1-r)>XR||Math.abs(this._y1-o)>XR)&&(this._+="L"+r+","+o),!!i&&(this._+=`A${i},${i},0,1,1,${t-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=o}`)}rect(t,n,i,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class b_{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class zee{constructor(t,[n,i,r,o]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((o=+o)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=r,this.xmin=n,this.ymax=o,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:i},vectors:r}=this,o=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let h=0,g=0,p=i.length,m,y;h<p;h+=3,g+=2){const v=i[h]*2,x=i[h+1]*2,b=i[h+2]*2,_=t[v],E=t[v+1],w=t[x],O=t[x+1],S=t[b],k=t[b+1],A=w-_,M=O-E,C=S-_,D=k-E,F=A*A+M*M,N=C*C+D*D,I=(A*D-M*C)*2;if(!I)m=(_+S)/2-1e8*D,y=(E+k)/2+1e8*C;else if(Math.abs(I)<1e-8)m=(_+S)/2,y=(E+k)/2;else{const z=1/I;m=_+(D*F-M*N)*z,y=E+(A*N-C*F)*z}o[g]=m,o[g+1]=y}let a=n[n.length-1],s,u=a*4,l,c=t[2*a],f,d=t[2*a+1];r.fill(0);for(let h=0;h<n.length;++h)a=n[h],s=u,l=c,f=d,u=a*4,c=t[2*a],d=t[2*a+1],r[s+2]=r[u]=f-d,r[s+3]=r[u+1]=c-l}render(t){const n=t==null?t=new iu:void 0,{delaunay:{halfedges:i,inedges:r,hull:o},circumcenters:a,vectors:s}=this;if(o.length<=1)return null;for(let c=0,f=i.length;c<f;++c){const d=i[c];if(d<c)continue;const h=Math.floor(c/3)*2,g=Math.floor(d/3)*2,p=a[h],m=a[h+1],y=a[g],v=a[g+1];this._renderSegment(p,m,y,v,t)}let u,l=o[o.length-1];for(let c=0;c<o.length;++c){u=l,l=o[c];const f=Math.floor(r[l]/3)*2,d=a[f],h=a[f+1],g=u*4,p=this._project(d,h,s[g+2],s[g+3]);p&&this._renderSegment(d,h,p[0],p[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new iu:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const i=n==null?n=new iu:void 0,r=this._clip(t);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let o=r.length;for(;r[0]===r[o-2]&&r[1]===r[o-1]&&o>1;)o-=2;for(let a=2;a<o;a+=2)(r[a]!==r[a-2]||r[a+1]!==r[a-1])&&n.lineTo(r[a],r[a+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,i=t.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(t){const n=new b_;return this.renderCell(t,n),n.value()}_renderSegment(t,n,i,r,o){let a;const s=this._regioncode(t,n),u=this._regioncode(i,r);s===0&&u===0?(o.moveTo(t,n),o.lineTo(i,r)):(a=this._clipSegment(t,n,i,r,s,u))&&(o.moveTo(a[0],a[1]),o.lineTo(a[2],a[3]))}contains(t,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(t,n,i)===t}*neighbors(t){const n=this._clip(t);if(n)for(const i of this.delaunay.neighbors(t)){const r=this._clip(i);if(r)e:for(let o=0,a=n.length;o<a;o+=2)for(let s=0,u=r.length;s<u;s+=2)if(n[o]==r[s]&&n[o+1]==r[s+1]&&n[(o+2)%a]==r[(s+u-2)%u]&&n[(o+3)%a]==r[(s+u-1)%u]){yield i;break e}}}_cell(t){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:o}}=this,a=i[t];if(a===-1)return null;const s=[];let u=a;do{const l=Math.floor(u/3);if(s.push(n[l*2],n[l*2+1]),u=u%3==2?u-2:u+1,o[u]!==t)break;u=r[u]}while(u!==a&&u!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:i}=this,r=t*4;return i[r]||i[r+1]?this._clipInfinite(t,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(t,n)}_clipFinite(t,n){const i=n.length;let r=null,o,a,s=n[i-2],u=n[i-1],l,c=this._regioncode(s,u),f,d;for(let h=0;h<i;h+=2)if(o=s,a=u,s=n[h],u=n[h+1],l=c,c=this._regioncode(s,u),l===0&&c===0)f=d,d=0,r?r.push(s,u):r=[s,u];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(o,a,s,u,l,c))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(s,u,o,a,c,l))===null)continue;[y,v,p,m]=g,f=d,d=this._edgecode(p,m),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(p,m):r=[p,m]}f=d,d=this._edgecode(y,v),f&&d&&this._edge(t,f,d,r,r.length),r?r.push(y,v):r=[y,v]}if(r)f=d,d=this._edgecode(r[0],r[1]),f&&d&&this._edge(t,f,d,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(t,n,i,r,o,a){for(;;){if(o===0&&a===0)return[t,n,i,r];if(o&a)return null;let s,u,l=o||a;l&8?(s=t+(i-t)*(this.ymax-n)/(r-n),u=this.ymax):l&4?(s=t+(i-t)*(this.ymin-n)/(r-n),u=this.ymin):l&2?(u=n+(r-n)*(this.xmax-t)/(i-t),s=this.xmax):(u=n+(r-n)*(this.xmin-t)/(i-t),s=this.xmin),o?(t=s,n=u,o=this._regioncode(t,n)):(i=s,r=u,a=this._regioncode(i,r))}}_clipInfinite(t,n,i,r,o,a){let s=Array.from(n),u;if((u=this._project(s[0],s[1],i,r))&&s.unshift(u[0],u[1]),(u=this._project(s[s.length-2],s[s.length-1],o,a))&&s.push(u[0],u[1]),s=this._clipFinite(t,s))for(let l=0,c=s.length,f,d=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)f=d,d=this._edgecode(s[l],s[l+1]),f&&d&&(l=this._edge(t,f,d,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,n,i,r,o){for(;n!==i;){let a,s;switch(n){case 5:n=4;continue;case 4:n=6,a=this.xmax,s=this.ymin;break;case 6:n=2;continue;case 2:n=10,a=this.xmax,s=this.ymax;break;case 10:n=8;continue;case 8:n=9,a=this.xmin,s=this.ymax;break;case 9:n=1;continue;case 1:n=5,a=this.xmin,s=this.ymin;break}(r[o]!==a||r[o+1]!==s)&&this.contains(t,a,s)&&(r.splice(o,0,a,s),o+=2)}if(r.length>4)for(let a=0;a<r.length;a+=2){const s=(a+2)%r.length,u=(a+4)%r.length;(r[a]===r[s]&&r[s]===r[u]||r[a+1]===r[s+1]&&r[s+1]===r[u+1])&&(r.splice(s,2),a-=2)}return o}_project(t,n,i,r){let o=1/0,a,s,u;if(r<0){if(n<=this.ymin)return null;(a=(this.ymin-n)/r)<o&&(u=this.ymin,s=t+(o=a)*i)}else if(r>0){if(n>=this.ymax)return null;(a=(this.ymax-n)/r)<o&&(u=this.ymax,s=t+(o=a)*i)}if(i>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/i)<o&&(s=this.xmax,u=n+(o=a)*r)}else if(i<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/i)<o&&(s=this.xmin,u=n+(o=a)*r)}return[s,u]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const Bee=2*Math.PI,oc=Math.pow;function Uee(e){return e[0]}function qee(e){return e[1]}function Wee(e){const{triangles:t,coords:n}=e;for(let i=0;i<t.length;i+=3){const r=2*t[i],o=2*t[i+1],a=2*t[i+2];if((n[a]-n[r])*(n[o+1]-n[r+1])-(n[o]-n[r])*(n[a+1]-n[r+1])>1e-10)return!1}return!0}function Hee(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class x_{static from(t,n=Uee,i=qee,r){return new x_("length"in t?Gee(t,n,i,r):Float64Array.from(Vee(t,n,i,r)))}constructor(t){this._delaunator=new Zm(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&Wee(t)){this.collinear=Int32Array.from({length:n.length/2},(d,h)=>h).sort((d,h)=>n[2*d]-n[2*h]||n[2*d+1]-n[2*h+1]);const u=this.collinear[0],l=this.collinear[this.collinear.length-1],c=[n[2*u],n[2*u+1],n[2*l],n[2*l+1]],f=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let d=0,h=n.length/2;d<h;++d){const g=Hee(n[2*d],n[2*d+1],f);n[2*d]=g[0],n[2*d+1]=g[1]}this._delaunator=new Zm(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let u=0,l=i.length;u<l;++u){const c=o[u%3==2?u-2:u+1];(i[u]===-1||a[c]===-1)&&(a[c]=u)}for(let u=0,l=r.length;u<l;++u)s[r[u]]=u;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],a[r[0]]=1,r.length===2&&(a[r[1]]=0))}voronoi(t){return new zee(this,t)}*neighbors(t){const{inedges:n,hull:i,_hullIndex:r,halfedges:o,triangles:a,collinear:s}=this;if(s){const f=s.indexOf(t);f>0&&(yield s[f-1]),f<s.length-1&&(yield s[f+1]);return}const u=n[t];if(u===-1)return;let l=u,c=-1;do{if(yield c=a[l],l=l%3==2?l-2:l+1,a[l]!==t)return;if(l=o[l],l===-1){const f=i[(r[t]+1)%i.length];f!==c&&(yield f);return}}while(l!==u)}find(t,n,i=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const r=i;let o;for(;(o=this._step(i,t,n))>=0&&o!==i&&o!==r;)i=o;return o}_step(t,n,i){const{inedges:r,hull:o,_hullIndex:a,halfedges:s,triangles:u,points:l}=this;if(r[t]===-1||!l.length)return(t+1)%(l.length>>1);let c=t,f=oc(n-l[t*2],2)+oc(i-l[t*2+1],2);const d=r[t];let h=d;do{let g=u[h];const p=oc(n-l[g*2],2)+oc(i-l[g*2+1],2);if(p<f&&(f=p,c=g),h=h%3==2?h-2:h+1,u[h]!==t)break;if(h=s[h],h===-1){if(h=o[(a[t]+1)%o.length],h!==g&&oc(n-l[h*2],2)+oc(i-l[h*2+1],2)<f)return h;break}}while(h!==d);return c}render(t){const n=t==null?t=new iu:void 0,{points:i,halfedges:r,triangles:o}=this;for(let a=0,s=r.length;a<s;++a){const u=r[a];if(u<a)continue;const l=o[a]*2,c=o[u]*2;t.moveTo(i[l],i[l+1]),t.lineTo(i[c],i[c+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const i=t==null?t=new iu:void 0,{points:r}=this;for(let o=0,a=r.length;o<a;o+=2){const s=r[o],u=r[o+1];t.moveTo(s+n,u),t.arc(s,u,n,0,Bee)}return i&&i.value()}renderHull(t){const n=t==null?t=new iu:void 0,{hull:i,points:r}=this,o=i[0]*2,a=i.length;t.moveTo(r[o],r[o+1]);for(let s=1;s<a;++s){const u=2*i[s];t.lineTo(r[u],r[u+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new b_;return this.renderHull(t),t.value()}renderTriangle(t,n){const i=n==null?n=new iu:void 0,{points:r,triangles:o}=this,a=o[t*=3]*2,s=o[t+1]*2,u=o[t+2]*2;return n.moveTo(r[a],r[a+1]),n.lineTo(r[s],r[s+1]),n.lineTo(r[u],r[u+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,i=t.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new b_;return this.renderTriangle(t,n),n.value()}}function Gee(e,t,n,i){const r=e.length,o=new Float64Array(r*2);for(let a=0;a<r;++a){const s=e[a];o[a*2]=t.call(i,s,a,e),o[a*2+1]=n.call(i,s,a,e)}return o}function*Vee(e,t,n,i){let r=0;for(const o of e)yield t.call(i,o,r,e),yield n.call(i,o,r,e),++r}function w_(e){R.call(this,null,e)}w_.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const Yee=[-1e5,-1e5,1e5,1e5];W(w_,R,{transform(e,t){const n=e.as||"path",i=t.source;if(!i||!i.length)return t;let r=e.size;r=r?[0,0,r[0],r[1]]:(r=e.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:Yee;const o=this.value=x_.from(i,e.x,e.y).voronoi(r);for(let a=0,s=i.length;a<s;++a){const u=o.cellPolygon(a);i[a][n]=u?Xee(u):null}return t.reflow(e.modified()).modifies(n)}});function Xee(e){const t=e[0][0],n=e[0][1];let i=e.length-1;for(;e[i][0]===t&&e[i][1]===n;--i);return"M"+e.slice(0,i+1).join("L")+"Z"}var Kee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:w_}),__=Math.PI/180,Hd=1<<11>>5,t0=1<<11;function Jee(){var e=[256,256],t,n,i,r,o,a,s,u=KR,l=[],c=Math.random,f={};f.layout=function(){for(var g=d(Tl()),p=ite((e[0]>>5)*e[1]),m=null,y=l.length,v=-1,x=[],b=l.map(E=>({text:t(E),font:n(E),style:r(E),weight:o(E),rotate:a(E),size:~~(i(E)+1e-14),padding:s(E),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:E})).sort((E,w)=>w.size-E.size);++v<y;){var _=b[v];_.x=e[0]*(c()+.5)>>1,_.y=e[1]*(c()+.5)>>1,Qee(g,_,b,v),_.hasText&&h(p,_,m)&&(x.push(_),m?ete(m,_):m=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=e[0]>>1,_.y-=e[1]>>1)}return x};function d(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(Hd<<5)/p,g.height=t0/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function h(g,p,m){for(var y=p.x,v=p.y,x=Math.sqrt(e[0]*e[0]+e[1]*e[1]),b=u(e),_=c()<.5?1:-1,E=-_,w,O,S;(w=b(E+=_))&&(O=~~w[0],S=~~w[1],!(Math.min(Math.abs(O),Math.abs(S))>=x));)if(p.x=y+O,p.y=v+S,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>e[0]||p.y+p.y1>e[1])&&(!m||!Zee(p,g,e[0]))&&(!m||tte(p,m))){for(var k=p.sprite,A=p.width>>5,M=e[0]>>5,C=p.x-(A<<4),D=C&127,F=32-D,N=p.y1-p.y0,I=(p.y+p.y0)*M+(C>>5),z,X=0;X<N;X++){z=0;for(var te=0;te<=A;te++)g[I+te]|=z<<F|(te<A?(z=k[X*A+te])>>>D:0);I+=M}return p.sprite=null,!0}return!1}return f.words=function(g){return arguments.length?(l=g,f):l},f.size=function(g){return arguments.length?(e=[+g[0],+g[1]],f):e},f.font=function(g){return arguments.length?(n=ru(g),f):n},f.fontStyle=function(g){return arguments.length?(r=ru(g),f):r},f.fontWeight=function(g){return arguments.length?(o=ru(g),f):o},f.rotate=function(g){return arguments.length?(a=ru(g),f):a},f.text=function(g){return arguments.length?(t=ru(g),f):t},f.spiral=function(g){return arguments.length?(u=rte[g]||g,f):u},f.fontSize=function(g){return arguments.length?(i=ru(g),f):i},f.padding=function(g){return arguments.length?(s=ru(g),f):s},f.random=function(g){return arguments.length?(c=g,f):c},f}function Qee(e,t,n,i){if(!t.sprite){var r=e.context,o=e.ratio;r.clearRect(0,0,(Hd<<5)/o,t0/o);var a=0,s=0,u=0,l=n.length,c,f,d,h,g;for(--i;++i<l;){if(t=n[i],r.save(),r.font=t.style+" "+t.weight+" "+~~((t.size+1)/o)+"px "+t.font,c=r.measureText(t.text+"m").width*o,d=t.size<<1,t.rotate){var p=Math.sin(t.rotate*__),m=Math.cos(t.rotate*__),y=c*m,v=c*p,x=d*m,b=d*p;c=Math.max(Math.abs(y+b),Math.abs(y-b))+31>>5<<5,d=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else c=c+31>>5<<5;if(d>u&&(u=d),a+c>=Hd<<5&&(a=0,s+=u,u=0),s+d>=t0)break;r.translate((a+(c>>1))/o,(s+(d>>1))/o),t.rotate&&r.rotate(t.rotate*__),r.fillText(t.text,0,0),t.padding&&(r.lineWidth=2*t.padding,r.strokeText(t.text,0,0)),r.restore(),t.width=c,t.height=d,t.xoff=a,t.yoff=s,t.x1=c>>1,t.y1=d>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,a+=c}for(var _=r.getImageData(0,0,(Hd<<5)/o,t0/o).data,E=[];--i>=0;)if(t=n[i],!!t.hasText){for(c=t.width,f=c>>5,d=t.y1-t.y0,h=0;h<d*f;h++)E[h]=0;if(a=t.xoff,a==null)return;s=t.yoff;var w=0,O=-1;for(g=0;g<d;g++){for(h=0;h<c;h++){var S=f*g+(h>>5),k=_[(s+g)*(Hd<<5)+(a+h)<<2]?1<<31-h%32:0;E[S]|=k,w|=k}w?O=g:(t.y0++,d--,g--,s++)}t.y1=t.y0+O,t.sprite=E.slice(0,(t.y1-t.y0)*f)}}}function Zee(e,t,n){n>>=5;for(var i=e.sprite,r=e.width>>5,o=e.x-(r<<4),a=o&127,s=32-a,u=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),c,f=0;f<u;f++){c=0;for(var d=0;d<=r;d++)if((c<<s|(d<r?(c=i[f*r+d])>>>a:0))&t[l+d])return!0;l+=n}return!1}function ete(e,t){var n=e[0],i=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>i.x&&(i.x=t.x+t.x1),t.y+t.y1>i.y&&(i.y=t.y+t.y1)}function tte(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function KR(e){var t=e[0]/e[1];return function(n){return[t*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function nte(e){var t=4,n=t*e[0]/e[1],i=0,r=0;return function(o){var a=o<0?-1:1;switch(Math.sqrt(1+4*a*o)-a&3){case 0:i+=n;break;case 1:r+=t;break;case 2:i-=n;break;default:r-=t;break}return[i,r]}}function ite(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function ru(e){return typeof e=="function"?e:function(){return e}}var rte={archimedean:KR,rectangular:nte};const JR=["x","y","font","fontSize","fontStyle","fontWeight","angle"],ote=["text","font","rotate","fontSize","fontStyle","fontWeight"];function E_(e){R.call(this,Jee(),e)}E_.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:JR}]};W(E_,R,{transform(e,t){e.size&&!(e.size[0]&&e.size[1])&&L("Wordcloud size dimensions must be non-zero.");function n(g){const p=e[g];return _e(p)&&t.modified(p.fields)}const i=e.modified();if(!(i||t.changed(t.ADD_REM)||ote.some(n)))return;const r=t.materialize(t.SOURCE).source,o=this.value,a=e.as||JR;let s=e.fontSize||14,u;if(_e(s)?u=e.fontSizeRange:s=gn(s),u){const g=s,p=Ie("sqrt")().domain($r(r,g)).range(u);s=m=>p(g(m))}r.forEach(g=>{g[a[0]]=NaN,g[a[1]]=NaN,g[a[3]]=0});const l=o.words(r).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random($i).layout(),c=o.size(),f=c[0]>>1,d=c[1]>>1,h=l.length;for(let g=0,p,m;g<h;++g)p=l[g],m=p.datum,m[a[0]]=p.x+f,m[a[1]]=p.y+d,m[a[2]]=p.font,m[a[3]]=p.size,m[a[4]]=p.style,m[a[5]]=p.weight,m[a[6]]=p.rotate;return t.reflow(i).modifies(a)}});var ate=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:E_});const ste=e=>new Uint8Array(e),ute=e=>new Uint16Array(e),Gd=e=>new Uint32Array(e);function lte(){let e=8,t=[],n=Gd(0),i=n0(0,e),r=n0(0,e);return{data:()=>t,seen:()=>n=cte(n,t.length),add(o){for(let a=0,s=t.length,u=o.length,l;a<u;++a)l=o[a],l._index=s++,t.push(l)},remove(o,a){const s=t.length,u=Array(s-o),l=t;let c,f,d;for(f=0;!a[f]&&f<s;++f)u[f]=t[f],l[f]=f;for(d=f;f<s;++f)c=t[f],a[f]?l[f]=-1:(l[f]=d,i[d]=i[f],r[d]=r[f],u[d]=c,c._index=d++),i[f]=0;return t=u,l},size:()=>t.length,curr:()=>i,prev:()=>r,reset:o=>r[o]=i[o],all:()=>e<257?255:e<65537?65535:4294967295,set(o,a){i[o]|=a},clear(o,a){i[o]&=~a},resize(o,a){const s=i.length;(o>s||a>e)&&(e=Math.max(a,e),i=n0(o,e,i),r=n0(o,e))}}}function cte(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function n0(e,t,n){const i=(t<257?ste:t<65537?ute:Gd)(e);return n&&i.set(n),i}function QR(e,t,n){const i=1<<t;return{one:i,zero:~i,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(r,o){const a=this,s=a.bisect(a.range,r.value),u=r.index,l=s[0],c=s[1],f=u.length;let d;for(d=0;d<l;++d)o[u[d]]|=i;for(d=c;d<f;++d)o[u[d]]|=i;return a}}}function ZR(){let e=Gd(0),t=[],n=0;function i(s,u,l){if(!u.length)return[];const c=n,f=u.length,d=Gd(f);let h=Array(f),g,p,m;for(m=0;m<f;++m)h[m]=s(u[m]),d[m]=m;if(h=fte(h,d),c)g=t,p=e,t=Array(c+f),e=Gd(c+f),dte(l,g,p,c,h,d,f,t,e);else{if(l>0)for(m=0;m<f;++m)d[m]+=l;t=h,e=d}return n=c+f,{index:d,value:h}}function r(s,u){const l=n;let c,f,d;for(f=0;!u[e[f]]&&f<l;++f);for(d=f;f<l;++f)u[c=e[f]]||(e[d]=c,t[d]=t[f],++d);n=l-s}function o(s){for(let u=0,l=n;u<l;++u)e[u]=s[e[u]]}function a(s,u){let l;return u?l=u.length:(u=t,l=n),[Uz(u,s[0],0,l),Tg(u,s[1],0,l)]}return{insert:i,remove:r,bisect:a,reindex:o,index:()=>e,size:()=>n}}function fte(e,t){return e.sort.call(t,(n,i)=>{const r=e[n],o=e[i];return r<o?-1:r>o?1:0}),Hz(e,t)}function dte(e,t,n,i,r,o,a,s,u){let l=0,c=0,f;for(f=0;l<i&&c<a;++f)t[l]<r[c]?(s[f]=t[l],u[f]=n[l++]):(s[f]=r[c],u[f]=o[c++]+e);for(;l<i;++l,++f)s[f]=t[l],u[f]=n[l];for(;c<a;++c,++f)s[f]=r[c],u[f]=o[c]+e}function O_(e){R.call(this,lte(),e),this._indices=null,this._dims=null}O_.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};W(O_,R,{transform(e,t){if(this._dims){var n=e.modified("fields")||e.fields.some(i=>t.modified(i.fields));return n?this.reinit(e,t):this.eval(e,t)}else return this.init(e,t)},init(e,t){const n=e.fields,i=e.query,r=this._indices={},o=this._dims=[],a=i.length;let s=0,u,l;for(;s<a;++s)u=n[s].fname,l=r[u]||(r[u]=ZR()),o.push(QR(l,s,i[s]));return this.eval(e,t)},reinit(e,t){const n=t.materialize().fork(),i=e.fields,r=e.query,o=this._indices,a=this._dims,s=this.value,u=s.curr(),l=s.prev(),c=s.all(),f=n.rem=n.add,d=n.mod,h=r.length,g={};let p,m,y,v,x,b,_,E,w;if(l.set(u),t.rem.length&&(x=this.remove(e,t,n)),t.add.length&&s.add(t.add),t.mod.length)for(b={},v=t.mod,_=0,E=v.length;_<E;++_)b[v[_]._index]=1;for(_=0;_<h;++_)w=i[_],(!a[_]||e.modified("fields",_)||t.modified(w.fields))&&(y=w.fname,(p=g[y])||(o[y]=m=ZR(),g[y]=p=m.insert(w,t.source,0)),a[_]=QR(m,_,r[_]).onAdd(p,u));for(_=0,E=s.data().length;_<E;++_)x[_]||(l[_]!==u[_]?f.push(_):b[_]&&u[_]!==c&&d.push(_));return s.mask=(1<<h)-1,n},eval(e,t){const n=t.materialize().fork(),i=this._dims.length;let r=0;return t.rem.length&&(this.remove(e,t,n),r|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(r|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),r|=(1<<i)-1),t.mod.length&&(this.modify(t,n),r|=(1<<i)-1),this.value.mask=r,n},insert(e,t,n){const i=t.add,r=this.value,o=this._dims,a=this._indices,s=e.fields,u={},l=n.add,c=r.size()+i.length,f=o.length;let d=r.size(),h,g,p;r.resize(c,f),r.add(i);const m=r.curr(),y=r.prev(),v=r.all();for(h=0;h<f;++h)g=s[h].fname,p=u[g]||(u[g]=a[g].insert(s[h],i,d)),o[h].onAdd(p,m);for(;d<c;++d)y[d]=v,m[d]!==v&&l.push(d)},modify(e,t){const n=t.mod,i=this.value,r=i.curr(),o=i.all(),a=e.mod;let s,u,l;for(s=0,u=a.length;s<u;++s)l=a[s]._index,r[l]!==o&&n.push(l)},remove(e,t,n){const i=this._indices,r=this.value,o=r.curr(),a=r.prev(),s=r.all(),u={},l=n.rem,c=t.rem;let f,d,h,g;for(f=0,d=c.length;f<d;++f)h=c[f]._index,u[h]=1,a[h]=g=o[h],o[h]=s,g!==s&&l.push(h);for(h in i)i[h].remove(d,u);return this.reindex(t,d,u),u},reindex(e,t,n){const i=this._indices,r=this.value;e.runAfter(()=>{const o=r.remove(t,n);for(const a in i)i[a].reindex(o)})},update(e,t,n){const i=this._dims,r=e.query,o=t.stamp,a=i.length;let s=0,u,l;for(n.filters=0,l=0;l<a;++l)e.modified("query",l)&&(u=l,++s);if(s===1)s=i[u].one,this.incrementOne(i[u],r[u],n.add,n.rem);else for(l=0,s=0;l<a;++l)!e.modified("query",l)||(s|=i[l].one,this.incrementAll(i[l],r[l],o,n.add),n.rem=n.add);return s},incrementAll(e,t,n,i){const r=this.value,o=r.seen(),a=r.curr(),s=r.prev(),u=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],g=l[1],p=e.one;let m,y,v;if(f<h)for(m=f,y=Math.min(h,d);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(f>h)for(m=h,y=Math.min(f,g);m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;if(d>g)for(m=Math.max(f,g),y=d;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;else if(d<g)for(m=Math.max(h,d),y=g;m<y;++m)v=u[m],o[v]!==n&&(s[v]=a[v],o[v]=n,i.push(v)),a[v]^=p;e.range=t.slice()},incrementOne(e,t,n,i){const r=this.value,o=r.curr(),a=e.index(),s=e.bisect(e.range),u=e.bisect(t),l=u[0],c=u[1],f=s[0],d=s[1],h=e.one;let g,p,m;if(l<f)for(g=l,p=Math.min(f,c);g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(l>f)for(g=f,p=Math.min(l,d);g<p;++g)m=a[g],o[m]^=h,i.push(m);if(c>d)for(g=Math.max(l,d),p=c;g<p;++g)m=a[g],o[m]^=h,n.push(m);else if(c<d)for(g=Math.max(f,c),p=d;g<p;++g)m=a[g],o[m]^=h,i.push(m);e.range=t.slice()}});function S_(e){R.call(this,null,e)}S_.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};W(S_,R,{transform(e,t){const n=~(e.ignore||0),i=e.filter,r=i.mask;if((r&n)==0)return t.StopPropagation;const o=t.fork(t.ALL),a=i.data(),s=i.curr(),u=i.prev(),l=c=>s[c]&n?null:a[c];return o.filter(o.MOD,l),r&r-1?(o.filter(o.ADD,c=>{const f=s[c]&n;return!f&&f^u[c]&n?a[c]:null}),o.filter(o.REM,c=>{const f=s[c]&n;return f&&!(f^(f^u[c]&n))?a[c]:null})):(o.filter(o.ADD,l),o.filter(o.REM,c=>(s[c]&n)===r?a[c]:null)),o.filter(o.SOURCE,c=>l(c._index))}});var hte=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:O_,resolvefilter:S_});const gte="RawCode",ou="Literal",pte="Property",mte="Identifier",yte="ArrayExpression",vte="BinaryExpression",ej="CallExpression",bte="ConditionalExpression",xte="LogicalExpression",wte="MemberExpression",_te="ObjectExpression",Ete="UnaryExpression";function hr(e){this.type=e}hr.prototype.visit=function(e){let t,n,i;if(e(this))return 1;for(t=Ote(this),n=0,i=t.length;n<i;++n)if(t[n].visit(e))return 1};function Ote(e){switch(e.type){case yte:return e.elements;case vte:case xte:return[e.left,e.right];case ej:return[e.callee].concat(e.arguments);case bte:return[e.test,e.consequent,e.alternate];case wte:return[e.object,e.property];case _te:return e.properties;case pte:return[e.key,e.value];case Ete:return[e.argument];case mte:case ou:case gte:default:return[]}}var eo,ee,j,wn,Ye,i0=1,Vd=2,au=3,Ka=4,r0=5,su=6,ni=7,Yd=8,Ste=9;eo={};eo[i0]="Boolean";eo[Vd]="<end>";eo[au]="Identifier";eo[Ka]="Keyword";eo[r0]="Null";eo[su]="Numeric";eo[ni]="Punctuator";eo[Yd]="String";eo[Ste]="RegularExpression";var Ate="ArrayExpression",kte="BinaryExpression",Cte="CallExpression",Tte="ConditionalExpression",tj="Identifier",Fte="Literal",Mte="LogicalExpression",Dte="MemberExpression",Nte="ObjectExpression",Rte="Property",jte="UnaryExpression",Bt="Unexpected token %0",$te="Unexpected number",Lte="Unexpected string",Ite="Unexpected identifier",Pte="Unexpected reserved word",zte="Unexpected end of input",A_="Invalid regular expression",k_="Invalid regular expression: missing /",nj="Octal literals are not allowed in strict mode.",Bte="Duplicate data property in object literal not allowed in strict mode",tn="ILLEGAL",Xd="Disabled.",Ute=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),qte=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function o0(e,t){if(!e)throw new Error("ASSERT: "+t)}function qo(e){return e>=48&&e<=57}function C_(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Kd(e){return"01234567".indexOf(e)>=0}function Wte(e){return e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Jd(e){return e===10||e===13||e===8232||e===8233}function Qd(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e===92||e>=128&&Ute.test(String.fromCharCode(e))}function a0(e){return e===36||e===95||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e===92||e>=128&&qte.test(String.fromCharCode(e))}const Hte={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function ij(){for(;j<wn;){const e=ee.charCodeAt(j);if(Wte(e)||Jd(e))++j;else break}}function T_(e){var t,n,i,r=0;for(n=e==="u"?4:2,t=0;t<n;++t)j<wn&&C_(ee[j])?(i=ee[j++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):Pe({},Bt,tn);return String.fromCharCode(r)}function Gte(){var e,t,n,i;for(e=ee[j],t=0,e==="}"&&Pe({},Bt,tn);j<wn&&(e=ee[j++],!!C_(e));)t=t*16+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||e!=="}")&&Pe({},Bt,tn),t<=65535?String.fromCharCode(t):(n=(t-65536>>10)+55296,i=(t-65536&1023)+56320,String.fromCharCode(n,i))}function rj(){var e,t;for(e=ee.charCodeAt(j++),t=String.fromCharCode(e),e===92&&(ee.charCodeAt(j)!==117&&Pe({},Bt,tn),++j,e=T_("u"),(!e||e==="\\"||!Qd(e.charCodeAt(0)))&&Pe({},Bt,tn),t=e);j<wn&&(e=ee.charCodeAt(j),!!a0(e));)++j,t+=String.fromCharCode(e),e===92&&(t=t.substr(0,t.length-1),ee.charCodeAt(j)!==117&&Pe({},Bt,tn),++j,e=T_("u"),(!e||e==="\\"||!a0(e.charCodeAt(0)))&&Pe({},Bt,tn),t+=e);return t}function Vte(){var e,t;for(e=j++;j<wn;){if(t=ee.charCodeAt(j),t===92)return j=e,rj();if(a0(t))++j;else break}return ee.slice(e,j)}function Yte(){var e,t,n;return e=j,t=ee.charCodeAt(j)===92?rj():Vte(),t.length===1?n=au:Hte.hasOwnProperty(t)?n=Ka:t==="null"?n=r0:t==="true"||t==="false"?n=i0:n=au,{type:n,value:t,start:e,end:j}}function F_(){var e=j,t=ee.charCodeAt(j),n,i=ee[j],r,o,a;switch(t){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++j,{type:ni,value:String.fromCharCode(t),start:e,end:j};default:if(n=ee.charCodeAt(j+1),n===61)switch(t){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return j+=2,{type:ni,value:String.fromCharCode(t)+String.fromCharCode(n),start:e,end:j};case 33:case 61:return j+=2,ee.charCodeAt(j)===61&&++j,{type:ni,value:ee.slice(e,j),start:e,end:j}}}if(a=ee.substr(j,4),a===">>>=")return j+=4,{type:ni,value:a,start:e,end:j};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return j+=3,{type:ni,value:o,start:e,end:j};if(r=o.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return j+=2,{type:ni,value:r,start:e,end:j};if(r==="//"&&Pe({},Bt,tn),"<>=!+-*%&|^/".indexOf(i)>=0)return++j,{type:ni,value:i,start:e,end:j};Pe({},Bt,tn)}function Xte(e){let t="";for(;j<wn&&C_(ee[j]);)t+=ee[j++];return t.length===0&&Pe({},Bt,tn),Qd(ee.charCodeAt(j))&&Pe({},Bt,tn),{type:su,value:parseInt("0x"+t,16),start:e,end:j}}function Kte(e){let t="0"+ee[j++];for(;j<wn&&Kd(ee[j]);)t+=ee[j++];return(Qd(ee.charCodeAt(j))||qo(ee.charCodeAt(j)))&&Pe({},Bt,tn),{type:su,value:parseInt(t,8),octal:!0,start:e,end:j}}function oj(){var e,t,n;if(n=ee[j],o0(qo(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),t=j,e="",n!=="."){if(e=ee[j++],n=ee[j],e==="0"){if(n==="x"||n==="X")return++j,Xte(t);if(Kd(n))return Kte(t);n&&qo(n.charCodeAt(0))&&Pe({},Bt,tn)}for(;qo(ee.charCodeAt(j));)e+=ee[j++];n=ee[j]}if(n==="."){for(e+=ee[j++];qo(ee.charCodeAt(j));)e+=ee[j++];n=ee[j]}if(n==="e"||n==="E")if(e+=ee[j++],n=ee[j],(n==="+"||n==="-")&&(e+=ee[j++]),qo(ee.charCodeAt(j)))for(;qo(ee.charCodeAt(j));)e+=ee[j++];else Pe({},Bt,tn);return Qd(ee.charCodeAt(j))&&Pe({},Bt,tn),{type:su,value:parseFloat(e),start:t,end:j}}function Jte(){var e="",t,n,i,r,o=!1;for(t=ee[j],o0(t==="'"||t==='"',"String literal must starts with a quote"),n=j,++j;j<wn;)if(i=ee[j++],i===t){t="";break}else if(i==="\\")if(i=ee[j++],!i||!Jd(i.charCodeAt(0)))switch(i){case"u":case"x":ee[j]==="{"?(++j,e+=Gte()):e+=T_(i);break;case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:Kd(i)?(r="01234567".indexOf(i),r!==0&&(o=!0),j<wn&&Kd(ee[j])&&(o=!0,r=r*8+"01234567".indexOf(ee[j++]),"0123".indexOf(i)>=0&&j<wn&&Kd(ee[j])&&(r=r*8+"01234567".indexOf(ee[j++]))),e+=String.fromCharCode(r)):e+=i;break}else i==="\r"&&ee[j]===`
`&&++j;else{if(Jd(i.charCodeAt(0)))break;e+=i}return t!==""&&Pe({},Bt,tn),{type:Yd,value:e,octal:o,start:n,end:j}}function Qte(e,t){let n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";Pe({},A_)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{Pe({},A_)}try{return new RegExp(e,t)}catch{return null}}function Zte(){var e,t,n,i,r;for(e=ee[j],o0(e==="/","Regular expression literal must start with a slash"),t=ee[j++],n=!1,i=!1;j<wn;)if(e=ee[j++],t+=e,e==="\\")e=ee[j++],Jd(e.charCodeAt(0))&&Pe({},k_),t+=e;else if(Jd(e.charCodeAt(0)))Pe({},k_);else if(n)e==="]"&&(n=!1);else if(e==="/"){i=!0;break}else e==="["&&(n=!0);return i||Pe({},k_),r=t.substr(1,t.length-2),{value:r,literal:t}}function ene(){var e,t,n;for(t="",n="";j<wn&&(e=ee[j],!!a0(e.charCodeAt(0)));)++j,e==="\\"&&j<wn?Pe({},Bt,tn):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Pe({},A_,n),{value:n,literal:t}}function tne(){var e,t,n,i;return Ye=null,ij(),e=j,t=Zte(),n=ene(),i=Qte(t.value,n.value),{literal:t.literal+n.literal,value:i,regex:{pattern:t.value,flags:n.value},start:e,end:j}}function nne(e){return e.type===au||e.type===Ka||e.type===i0||e.type===r0}function aj(){if(ij(),j>=wn)return{type:Vd,start:j,end:j};const e=ee.charCodeAt(j);return Qd(e)?Yte():e===40||e===41||e===59?F_():e===39||e===34?Jte():e===46?qo(ee.charCodeAt(j+1))?oj():F_():qo(e)?oj():F_()}function ii(){const e=Ye;return j=e.end,Ye=aj(),j=e.end,e}function sj(){const e=j;Ye=aj(),j=e}function ine(e){const t=new hr(Ate);return t.elements=e,t}function uj(e,t,n){const i=new hr(e==="||"||e==="&&"?Mte:kte);return i.operator=e,i.left=t,i.right=n,i}function rne(e,t){const n=new hr(Cte);return n.callee=e,n.arguments=t,n}function one(e,t,n){const i=new hr(Tte);return i.test=e,i.consequent=t,i.alternate=n,i}function M_(e){const t=new hr(tj);return t.name=e,t}function Zd(e){const t=new hr(Fte);return t.value=e.value,t.raw=ee.slice(e.start,e.end),e.regex&&(t.raw==="//"&&(t.raw="/(?:)/"),t.regex=e.regex),t}function lj(e,t,n){const i=new hr(Dte);return i.computed=e==="[",i.object=t,i.property=n,i.computed||(n.member=!0),i}function ane(e){const t=new hr(Nte);return t.properties=e,t}function cj(e,t,n){const i=new hr(Rte);return i.key=t,i.value=n,i.kind=e,i}function sne(e,t){const n=new hr(jte);return n.operator=e,n.argument=t,n.prefix=!0,n}function Pe(e,t){var n,i=Array.prototype.slice.call(arguments,2),r=t.replace(/%(\d)/g,(o,a)=>(o0(a<i.length,"Message reference must be in range"),i[a]));throw n=new Error(r),n.index=j,n.description=r,n}function s0(e){e.type===Vd&&Pe(e,zte),e.type===su&&Pe(e,$te),e.type===Yd&&Pe(e,Lte),e.type===au&&Pe(e,Ite),e.type===Ka&&Pe(e,Pte),Pe(e,Bt,e.value)}function _n(e){const t=ii();(t.type!==ni||t.value!==e)&&s0(t)}function ut(e){return Ye.type===ni&&Ye.value===e}function D_(e){return Ye.type===Ka&&Ye.value===e}function une(){const e=[];for(j=Ye.start,_n("[");!ut("]");)ut(",")?(ii(),e.push(null)):(e.push(uu()),ut("]")||_n(","));return ii(),ine(e)}function fj(){j=Ye.start;const e=ii();return e.type===Yd||e.type===su?(e.octal&&Pe(e,nj),Zd(e)):M_(e.value)}function lne(){var e,t,n,i;if(j=Ye.start,e=Ye,e.type===au)return n=fj(),_n(":"),i=uu(),cj("init",n,i);if(e.type===Vd||e.type===ni)s0(e);else return t=fj(),_n(":"),i=uu(),cj("init",t,i)}function cne(){var e=[],t,n,i,r={},o=String;for(j=Ye.start,_n("{");!ut("}");)t=lne(),t.key.type===tj?n=t.key.name:n=o(t.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?Pe({},Bte):r[i]=!0,e.push(t),ut("}")||_n(",");return _n("}"),ane(e)}function fne(){_n("(");const e=N_();return _n(")"),e}const dne={if:1};function hne(){var e,t,n;if(ut("("))return fne();if(ut("["))return une();if(ut("{"))return cne();if(e=Ye.type,j=Ye.start,e===au||dne[Ye.value])n=M_(ii().value);else if(e===Yd||e===su)Ye.octal&&Pe(Ye,nj),n=Zd(ii());else{if(e===Ka)throw new Error(Xd);e===i0?(t=ii(),t.value=t.value==="true",n=Zd(t)):e===r0?(t=ii(),t.value=null,n=Zd(t)):ut("/")||ut("/=")?(n=Zd(tne()),sj()):s0(ii())}return n}function gne(){const e=[];if(_n("("),!ut(")"))for(;j<wn&&(e.push(uu()),!ut(")"));)_n(",");return _n(")"),e}function pne(){j=Ye.start;const e=ii();return nne(e)||s0(e),M_(e.value)}function mne(){return _n("."),pne()}function yne(){_n("[");const e=N_();return _n("]"),e}function vne(){var e,t,n;for(e=hne();;)if(ut("."))n=mne(),e=lj(".",e,n);else if(ut("("))t=gne(),e=rne(e,t);else if(ut("["))n=yne(),e=lj("[",e,n);else break;return e}function dj(){const e=vne();if(Ye.type===ni&&(ut("++")||ut("--")))throw new Error(Xd);return e}function u0(){var e,t;if(Ye.type!==ni&&Ye.type!==Ka)t=dj();else{if(ut("++")||ut("--"))throw new Error(Xd);if(ut("+")||ut("-")||ut("~")||ut("!"))e=ii(),t=u0(),t=sne(e.value,t);else{if(D_("delete")||D_("void")||D_("typeof"))throw new Error(Xd);t=dj()}}return t}function hj(e){let t=0;if(e.type!==ni&&e.type!==Ka)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11;break}return t}function bne(){var e,t,n,i,r,o,a,s,u,l;if(e=Ye,u=u0(),i=Ye,r=hj(i),r===0)return u;for(i.prec=r,ii(),t=[e,Ye],a=u0(),o=[u,i,a];(r=hj(Ye))>0;){for(;o.length>2&&r<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),t.pop(),n=uj(s,u,a),o.push(n);i=ii(),i.prec=r,o.push(i),t.push(Ye),n=u0(),o.push(n)}for(l=o.length-1,n=o[l],t.pop();l>1;)t.pop(),n=uj(o[l-1].value,o[l-2],n),l-=2;return n}function uu(){var e,t,n;return e=bne(),ut("?")&&(ii(),t=uu(),_n(":"),n=uu(),e=one(e,t,n)),e}function N_(){const e=uu();if(ut(","))throw new Error(Xd);return e}function R_(e){ee=e,j=0,wn=ee.length,Ye=null,sj();const t=N_();if(Ye.type!==Vd)throw new Error("Unexpect token after expression.");return t}var gj={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function pj(e){function t(a,s,u,l){let c=e(s[0]);return u&&(c=u+"("+c+")",u.lastIndexOf("new ",0)===0&&(c="("+c+")")),c+"."+a+(l<0?"":l===0?"()":"("+s.slice(1).map(e).join(",")+")")}function n(a,s,u){return l=>t(a,l,s,u)}const i="new Date",r="String",o="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(a){a.length<3&&L("Missing arguments to clamp function."),a.length>3&&L("Too many arguments to clamp function.");const s=a.map(e);return"Math.max("+s[1]+", Math.min("+s[2]+","+s[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:o,test:n("test",o),if:function(a){a.length<3&&L("Missing arguments to if function."),a.length>3&&L("Too many arguments to if function.");const s=a.map(e);return"("+s[0]+"?"+s[1]+":"+s[2]+")"}}}function xne(e){const t=e&&e.length-1;return t&&(e[0]==='"'&&e[t]==='"'||e[0]==="'"&&e[t]==="'")?e.slice(1,-1):e}function mj(e){e=e||{};const t=e.allowed?nr(e.allowed):{},n=e.forbidden?nr(e.forbidden):{},i=e.constants||gj,r=(e.functions||pj)(f),o=e.globalvar,a=e.fieldvar,s=_e(o)?o:g=>`${o}["${g}"]`;let u={},l={},c=0;function f(g){if(K(g))return g;const p=d[g.type];return p==null&&L("Unsupported type: "+g.type),p(g)}const d={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return c>0?p:re(n,p)?L("Illegal identifier: "+p):re(i,p)?i[p]:re(t,p)?p:(u[p]=1,s(p))},MemberExpression:g=>{const p=!g.computed,m=f(g.object);p&&(c+=1);const y=f(g.property);return m===a&&(l[xne(y)]=1),p&&(c-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&L("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=re(r,p)&&r[p];return y||L("Unrecognized function: "+p),_e(y)?y(m):y+"("+m.map(f).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(f).join(",")+"]",BinaryExpression:g=>"("+f(g.left)+" "+g.operator+" "+f(g.right)+")",UnaryExpression:g=>"("+g.operator+f(g.argument)+")",ConditionalExpression:g=>"("+f(g.test)+"?"+f(g.consequent)+":"+f(g.alternate)+")",LogicalExpression:g=>"("+f(g.left)+g.operator+f(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(f).join(",")+"}",Property:g=>{c+=1;const p=f(g.key);return c-=1,p+":"+f(g.value)}};function h(g){const p={code:f(g),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},p}return h.functions=r,h.constants=i,h}function wne(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _ne(e){let t=e,n=e;e.length===1&&(t=(a,s)=>e(a)-s,n=Ene(e));function i(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)<0?u=c+1:l=c}return u}function r(a,s,u,l){for(u==null&&(u=0),l==null&&(l=a.length);u<l;){const c=u+l>>>1;n(a[c],s)>0?l=c:u=c+1}return u}function o(a,s,u,l){u==null&&(u=0),l==null&&(l=a.length);const c=i(a,s,u,l-1);return c>u&&t(a[c-1],s)>-t(a[c],s)?c-1:c}return{left:i,center:o,right:r}}function Ene(e){return(t,n)=>wne(e(t),n)}const j_="intersect",yj="union",One="vlMulti",Sne="vlPoint",vj="or",Ane="and",kne="_vgsid_",Cne="E",Tne="R",Fne="R-E",Mne="R-LE",Dne="R-RE",l0="index:unit";function bj(e,t){for(var n=t.fields,i=t.values,r=n.length,o=0,a,s;o<r;++o)if(s=n[o],s.getter=Yn.getter||Yn(s.field),a=s.getter(e),pa(a)&&(a=hn(a)),pa(i[o])&&(i[o]=hn(i[o])),pa(i[o][0])&&(i[o]=i[o].map(hn)),s.type===Cne){if(P(i[o])?i[o].indexOf(a)<0:a!==i[o])return!1}else if(s.type===Tne){if(!pl(a,i[o]))return!1}else if(s.type===Dne){if(!pl(a,i[o],!0,!1))return!1}else if(s.type===Fne){if(!pl(a,i[o],!1,!1))return!1}else if(s.type===Mne&&!pl(a,i[o],!1,!0))return!1;return!0}function Nne(e,t,n){for(var i=this.context.data[e],r=i?i.values.value:[],o=i?i[l0]&&i[l0].value:void 0,a=n===j_,s=r.length,u=0,l,c,f,d,h;u<s;++u)if(l=r[u],o&&a){if(c=c||{},f=c[d=l.unit]||0,f===-1)continue;if(h=bj(t,l),c[d]=h?-1:++f,h&&o.size===1)return!0;if(!h&&f===o.get(d).count)return!1}else if(h=bj(t,l),a^h)return h;return s&&a}const $_=Yn(kne),xj=_ne($_),Rne=xj.left,jne=xj.right;function $ne(e,t,n){const i=this.context.data[e],r=i?i.values.value:[],o=i?i[l0]&&i[l0].value:void 0,a=n===j_,s=$_(t),u=Rne(r,s);if(u===r.length||$_(r[u])!==s)return!1;if(o&&a){if(o.size===1)return!0;if(jne(r,s)-u<o.size)return!1}return!0}function Lne(e,t){return e.map(n=>Ee({values:t.fields.map(i=>(i.getter||(i.getter=Yn(i.field)))(n.datum))},t))}function Ine(e,t,n,i){for(var r=this.context.data[e],o=r?r.values.value:[],a={},s={},u={},l,c,f,d,h,g,p,m,y,v=o.length,x=0,b,_;x<v;++x){for(l=o[x],d=l.unit,c=l.fields,f=l.values,b=0,_=c.length;b<_;++b)h=c[b],g=a[h.field]||(a[h.field]={}),p=g[d]||(g[d]=[]),u[h.field]=m=h.type.charAt(0),y=wj[m+"_union"],g[d]=y(p,J(f[b]));n&&(p=s[d]||(s[d]=[]),p.push(J(f).reduce((E,w,O)=>(E[c[O].field]=w,E),{})))}if(t=t||yj,Object.keys(a).forEach(E=>{a[E]=Object.keys(a[E]).map(w=>a[E][w]).reduce((w,O)=>w===void 0?O:wj[u[E]+"_"+t](w,O))}),o=Object.keys(s),n&&o.length){const E=i?Sne:One;a[E]=t===yj?{[vj]:o.reduce((w,O)=>(w.push(...s[O]),w),[])}:{[Ane]:o.map(w=>({[vj]:s[w]}))}}return a}var wj={E_union:function(e,t){if(!e.length)return t;for(var n=0,i=t.length;n<i;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(n=>t.indexOf(n)>=0):t},R_union:function(e,t){var n=hn(t[0]),i=hn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<i&&(e[1]=i),e):[n,i]},R_intersect:function(e,t){var n=hn(t[0]),i=hn(t[1]);return n>i&&(n=t[1],i=t[0]),e.length?i<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>i&&(e[1]=i),e):[n,i]}};const Pne=":",zne="@";function L_(e,t,n,i){t[0].type!==ou&&L("First argument to selection functions must be a string literal.");const r=t[0].value,o=t.length>=2&&Fe(t).value,a="unit",s=zne+a,u=Pne+r;o===j_&&!re(i,s)&&(i[s]=n.getData(r).indataRef(n,a)),re(i,u)||(i[u]=n.getData(r).tuplesRef())}function _j(e){const t=this.context.data[e];return t?t.values.value:[]}function Bne(e,t,n){const i=this.context.data[e]["index:"+t],r=i?i.value.get(n):void 0;return r&&r.count}function Une(e,t){const n=this.context.dataflow,i=this.context.data[e],r=i.input;return n.pulse(r,n.changeset().remove(Ni).insert(t)),1}function qne(e,t,n){if(e){const i=this.context.dataflow,r=e.mark.source;i.pulse(r,i.changeset().encode(e,t))}return n!==void 0?n:e}const eh=e=>function(t,n){return this.context.dataflow.locale()[e](n)(t)},Wne=eh("format"),Ej=eh("timeFormat"),Hne=eh("utcFormat"),Gne=eh("timeParse"),Vne=eh("utcParse"),c0=new Date(2e3,0,1);function f0(e,t,n){return!Number.isInteger(e)||!Number.isInteger(t)?"":(c0.setYear(2e3),c0.setMonth(e),c0.setDate(t),Ej.call(this,c0,n))}function Yne(e){return f0.call(this,e,1,"%B")}function Xne(e){return f0.call(this,e,1,"%b")}function Kne(e){return f0.call(this,0,2+e,"%A")}function Jne(e){return f0.call(this,0,2+e,"%a")}const Qne=":",Zne="@",I_="%",Oj="$";function P_(e,t,n,i){t[0].type!==ou&&L("First argument to data functions must be a string literal.");const r=t[0].value,o=Qne+r;if(!re(o,i))try{i[o]=n.getData(r).tuplesRef()}catch{}}function eie(e,t,n,i){t[0].type!==ou&&L("First argument to indata must be a string literal."),t[1].type!==ou&&L("Second argument to indata must be a string literal.");const r=t[0].value,o=t[1].value,a=Zne+o;re(a,i)||(i[a]=n.getData(r).indataRef(n,o))}function ri(e,t,n,i){if(t[0].type===ou)Sj(n,i,t[0].value);else for(e in n.scales)Sj(n,i,e)}function Sj(e,t,n){const i=I_+n;if(!re(t,i))try{t[i]=e.scaleRef(n)}catch{}}function Wo(e,t){let n;return _e(e)?e:K(e)?(n=t.scales[e])&&n.value:void 0}function tie(e,t,n){t.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=ri,n._range=ri,n._scale=ri;const i=r=>"_["+(r.type===ou?H(I_+r.value):H(I_)+"+"+e(r))+"]";return{_bandwidth:r=>`this.__bandwidth(${i(r[0])})`,_range:r=>`${i(r[0])}.range()`,_scale:r=>`${i(r[0])}(${e(r[1])})`}}function z_(e,t){return function(n,i,r){if(n){const o=Wo(n,(r||this).context);return o&&o.path[e](i)}else return t(i)}}const nie=z_("area",OK),iie=z_("bounds",CK),rie=z_("centroid",RK);function oie(e){const t=this.context.group;let n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function B_(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(i){e.warn(i)}return n[n.length-1]}function aie(){return B_(this.context.dataflow,"warn",arguments)}function sie(){return B_(this.context.dataflow,"info",arguments)}function uie(){return B_(this.context.dataflow,"debug",arguments)}function U_(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function q_(e){const t=Fa(e),n=U_(t.r),i=U_(t.g),r=U_(t.b);return .2126*n+.7152*i+.0722*r}function lie(e,t){const n=q_(e),i=q_(t),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}function cie(){const e=[].slice.call(arguments);return e.unshift({}),Ee(...e)}function Aj(e,t){return e===t||e!==e&&t!==t?!0:P(e)?P(t)&&e.length===t.length?fie(e,t):!1:Q(e)&&Q(t)?kj(e,t):!1}function fie(e,t){for(let n=0,i=e.length;n<i;++n)if(!Aj(e[n],t[n]))return!1;return!0}function kj(e,t){for(const n in e)if(!Aj(e[n],t[n]))return!1;return!0}function Cj(e){return t=>kj(e,t)}function die(e,t,n,i,r,o){const a=this.context.dataflow,s=this.context.data[e],u=s.input,l=a.stamp();let c=s.changes,f,d;if(a._trigger===!1||!(u.value.length||t||i))return 0;if((!c||c.stamp<l)&&(s.changes=c=a.changeset(),c.stamp=l,a.runAfter(()=>{s.modified=!0,a.pulse(u,c).run()},!0,1)),n&&(f=n===!0?Ni:P(n)||Ug(n)?n:Cj(n),c.remove(f)),t&&c.insert(t),i&&(f=Cj(i),u.value.some(f)?c.remove(f):c.insert(i)),r)for(d in o)c.modify(r,d,o[d]);return 1}function hie(e){const t=e.touches,n=t[0].clientX-t[1].clientX,i=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+i*i)}function gie(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}const Tj={};function pie(e,t){const n=Tj[t]||(Tj[t]=Yn(t));return P(e)?e.map(n):n(e)}function W_(e){return P(e)||ArrayBuffer.isView(e)?e:null}function H_(e){return W_(e)||(K(e)?e:null)}function mie(e,...t){return W_(e).join(...t)}function yie(e,...t){return H_(e).indexOf(...t)}function vie(e,...t){return H_(e).lastIndexOf(...t)}function bie(e,...t){return H_(e).slice(...t)}function xie(e,t,n){return _e(n)&&L("Function argument passed to replace."),String(e).replace(t,n)}function wie(e){return W_(e).slice().reverse()}function _ie(e,t,n){return _x(e||0,t||0,n||0)}function Eie(e,t){const n=Wo(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function Oie(e,t){const n=Wo(e,(t||this).context);return n?n.copy():void 0}function Sie(e,t){const n=Wo(e,(t||this).context);return n?n.domain():[]}function Aie(e,t,n){const i=Wo(e,(n||this).context);return i?P(t)?(i.invertRange||i.invert)(t):(i.invert||i.invertExtent)(t):void 0}function kie(e,t){const n=Wo(e,(t||this).context);return n&&n.range?n.range():[]}function Cie(e,t,n){const i=Wo(e,(n||this).context);return i?i(t):void 0}function Tie(e,t,n,i,r){e=Wo(e,(r||this).context);const o=LD(t,n);let a=e.domain(),s=a[0],u=Fe(a),l=dn;return u-s?l=_D(e,s,u):e=(e.interpolator?Ie("sequential")().interpolator(e.interpolator()):Ie("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(a=e.ticks(+i||15),s!==a[0]&&a.unshift(s),u!==Fe(a)&&a.push(u)),a.forEach(c=>o.stop(l(c),e(c))),o}function Fie(e,t,n){const i=Wo(e,(n||this).context);return function(r){return i?i.path.context(r)(t):""}}function Mie(e){let t=null;return function(n){return n?id(n,t=t||Il(e)):e}}const Fj=e=>e.data;function Mj(e,t){const n=_j.call(t,e);return n.root&&n.root.lookup||{}}function Die(e,t,n){const i=Mj(e,this),r=i[t],o=i[n];return r&&o?r.path(o).map(Fj):void 0}function Nie(e,t){const n=Mj(e,this)[t];return n?n.ancestors().map(Fj):void 0}const Dj=()=>typeof window!="undefined"&&window||null;function Rie(){const e=Dj();return e?e.screen:{}}function jie(){const e=Dj();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]}function $ie(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}function Lie(e,t,n){if(!e)return[];const[i,r]=e,o=new Nt().set(i[0],i[1],r[0],r[1]),a=n||this.context.dataflow.scenegraph().root;return J3(a,o,Iie(t))}function Iie(e){let t=null;if(e){const n=J(e.marktype),i=J(e.markname);t=r=>(!n.length||n.some(o=>r.marktype===o))&&(!i.length||i.some(o=>r.name===o))}return t}const th={random(){return $i()},cumulativeNormal:Kg,cumulativeLogNormal:nb,cumulativeUniform:ab,densityNormal:Jv,densityLogNormal:tb,densityUniform:ob,quantileNormal:Jg,quantileLogNormal:ib,quantileUniform:sb,sampleNormal:Xg,sampleLogNormal:eb,sampleUniform:rb,isArray:P,isBoolean:ga,isDate:pa,isDefined(e){return e!==void 0},isNumber:Je,isObject:Q,isRegExp:tC,isString:K,isTuple:Ug,isValid(e){return e!=null&&e===e},toBoolean:Jy,toDate:Qy,toNumber:hn,toString:Zy,indexof:yie,join:mie,lastindexof:vie,replace:xie,reverse:wie,slice:bie,flush:Zk,lerp:nC,merge:cie,pad:oC,peek:Fe,pluck:pie,span:yf,inrange:pl,truncate:aC,rgb:Fa,lab:dp,hcl:hp,hsl:cp,luminance:q_,contrast:lie,sequence:yi,format:Wne,utcFormat:Hne,utcParse:Vne,utcOffset:GC,utcSequence:XC,timeFormat:Ej,timeParse:Gne,timeOffset:HC,timeSequence:YC,timeUnitSpecifier:RC,monthFormat:Yne,monthAbbrevFormat:Xne,dayFormat:Kne,dayAbbrevFormat:Jne,quarter:Xk,utcquarter:Kk,week:$C,utcweek:PC,dayofyear:jC,utcdayofyear:IC,warn:aie,info:sie,debug:uie,extent:$r,inScope:oie,intersect:Lie,clampRange:Jk,pinchDistance:hie,pinchAngle:gie,screen:Rie,containerSize:$ie,windowSize:jie,bandspace:_ie,setdata:Une,pathShape:Mie,panLinear:Hk,panLog:Gk,panPow:Vk,panSymlog:Yk,zoomLinear:Hy,zoomLog:Gy,zoomPow:Ag,zoomSymlog:Vy,encode:qne,modify:die},Pie=["view","item","group","xy","x","y"],zie="event.vega.",Nj="this.",G_={},Rj={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:e=>`_[${H(Oj+e)}]`,functions:Bie,constants:gj,visitors:G_},V_=mj(Rj);function Bie(e){const t=pj(e);Pie.forEach(n=>t[n]=zie+n);for(const n in th)t[n]=Nj+n;return Ee(t,tie(e,th,G_)),t}function St(e,t,n){return arguments.length===1?th[e]:(th[e]=t,n&&(G_[e]=n),V_&&(V_.functions[e]=Nj+e),this)}St("bandwidth",Eie,ri);St("copy",Oie,ri);St("domain",Sie,ri);St("range",kie,ri);St("invert",Aie,ri);St("scale",Cie,ri);St("gradient",Tie,ri);St("geoArea",nie,ri);St("geoBounds",iie,ri);St("geoCentroid",rie,ri);St("geoShape",Fie,ri);St("indata",Bne,eie);St("data",_j,P_);St("treePath",Die,P_);St("treeAncestors",Nie,P_);St("vlSelectionTest",Nne,L_);St("vlSelectionIdTest",$ne,L_);St("vlSelectionResolve",Ine,L_);St("vlSelectionTuples",Lne);function to(e,t){const n={};let i;try{e=K(e)?e:H(e)+"",i=R_(e)}catch{L("Expression parse error: "+e)}i.visit(o=>{if(o.type!==ej)return;const a=o.callee.name,s=Rj.visitors[a];s&&s(a,o.arguments,t,n)});const r=V_(i);return r.globals.forEach(o=>{const a=Oj+o;!re(n,a)&&t.getSignal(o)&&(n[a]=t.signalRef(o))}),{$expr:Ee({code:r.code},t.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function Uie(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(i=>t.parseOperator(i)),n.forEach(i=>t.parseOperatorParameters(i)),(e.streams||[]).forEach(i=>t.parseStream(i)),(e.updates||[]).forEach(i=>t.parseUpdate(i)),t.resolve()}const qie=nr(["rule"]),jj=nr(["group","image","rect"]);function Wie(e,t){let n="";return qie[t]||(e.x2&&(e.x?(jj[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(jj[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Y_(e){return(e+"").toLowerCase()}function Hie(e){return Y_(e)==="operator"}function Gie(e){return Y_(e)==="collect"}function nh(e,t,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...t.concat(n));return e&&e.functions?i.bind(e.functions):i}function Vie(e,t,n,i){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var Yie={operator:(e,t)=>nh(e,["_"],t.code),parameter:(e,t)=>nh(e,["datum","_"],t.code),event:(e,t)=>nh(e,["event"],t.code),handler:(e,t)=>{const n="var datum=event.item&&event.item.datum;return ".concat(t.code,";");return nh(e,["_","event"],n)},encode:(e,t)=>{const{marktype:n,channels:i}=t;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const a="o["+H(o)+"]";r+="$=".concat(i[o].code,";if(").concat(a,"!==$)").concat(a,"=$,m=1;")}return r+=Wie(i,n),r+="return m;",nh(e,["item","_"],r)},codegen:{get(e){const t="[".concat(e.map(H).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator(e,t){let n;const i=(o,a)=>{const s=t[a];let u,l;return o.path?(u="a".concat(o.path),l="b".concat(o.path)):((n=n||{})["f"+a]=o,u="this.f".concat(a,"(a)"),l="this.f".concat(a,"(b)")),Vie(u,l,-s,s)},r=Function("a","b","var u, v; return "+e.map(i).join("")+"0;");return n?r.bind(n):r}}};function Xie(e){const t=this;Hie(e.type)||!e.type?t.operator(e,e.update?t.operatorExpression(e.update):null):t.transform(e,e.type)}function Kie(e){const t=this;if(e.params){const n=t.get(e.id);n||L("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}}function Jie(e,t){t=t||{};const n=this;for(const i in e){const r=e[i];t[i]=P(r)?r.map(o=>$j(o,n,t)):$j(r,n,t)}return t}function $j(e,t,n){if(!e||!Q(e))return e;for(let i=0,r=Lj.length,o;i<r;++i)if(o=Lj[i],re(e,o.key))return o.parse(e,t,n);return e}var Lj=[{key:"$ref",parse:Qie},{key:"$key",parse:ere},{key:"$expr",parse:Zie},{key:"$field",parse:tre},{key:"$encode",parse:ire},{key:"$compare",parse:nre},{key:"$context",parse:rre},{key:"$subflow",parse:ore},{key:"$tupleid",parse:are}];function Qie(e,t){return t.get(e.$ref)||L("Operator not defined: "+e.$ref)}function Zie(e,t,n){e.$params&&t.parseParameters(e.$params,n);const i="e:"+e.$expr.code+"_"+e.$name;return t.fn[i]||(t.fn[i]=Vn(t.parameterExpression(e.$expr),e.$fields,e.$name))}function ere(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=Ky(e.$key,e.$flat,t.expr.codegen))}function tre(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Yn(e.$field,e.$name,t.expr.codegen))}function nre(e,t){const n="c:"+e.$compare+"_"+e.$order,i=J(e.$compare).map(r=>r&&r.$tupleid?ae:r);return t.fn[n]||(t.fn[n]=Yy(i,e.$order,t.expr.codegen))}function ire(e,t){const n=e.$encode,i={};for(const r in n){const o=n[r];i[r]=Vn(t.encodeExpression(o.$expr),o.$fields),i[r].output=o.$output}return i}function rre(e,t){return t}function ore(e,t){const n=e.$subflow;return function(i,r,o){const a=t.fork().parse(n),s=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(o),s.detachSubflow=()=>t.detach(a),s}}function are(){return ae}function sre(e){var t=this,n=e.filter!=null?t.eventExpression(e.filter):void 0,i=e.stream!=null?t.get(e.stream):void 0,r;e.source?i=t.events(e.source,e.type,n):e.merge&&(r=e.merge.map(o=>t.get(o)),i=r[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(o=>t.get(o)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),e.throttle!=null&&(i=i.throttle(+e.throttle)),e.debounce!=null&&(i=i.debounce(+e.debounce)),i==null&&L("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}function ure(e){var t=this,n=Q(n=e.source)?n.$ref:n,i=t.get(n),r=null,o=e.update,a=void 0;i||L("Source not defined: "+e.source),r=e.target&&e.target.$expr?t.eventExpression(e.target.$expr):t.get(e.target),o&&o.$expr&&(o.$params&&(a=t.parseParameters(o.$params)),o=t.handlerExpression(o.$expr)),t.update(e,i,r,o,a)}const lre={skip:!0};function cre(e){var t=this,n={};if(e.signals){var i=n.signals={};Object.keys(t.signals).forEach(o=>{const a=t.signals[o];e.signals(o,a)&&(i[o]=a.value)})}if(e.data){var r=n.data={};Object.keys(t.data).forEach(o=>{const a=t.data[o];e.data(o,a)&&(r[o]=a.input.value)})}return t.subcontext&&e.recurse!==!1&&(n.subcontext=t.subcontext.map(o=>o.getState(e))),n}function fre(e){var t=this,n=t.dataflow,i=e.data,r=e.signals;Object.keys(r||{}).forEach(o=>{n.update(t.signals[o],r[o],lre)}),Object.keys(i||{}).forEach(o=>{n.pulse(t.data[o].input,n.changeset().remove(Ni).insert(i[o]))}),(e.subcontext||[]).forEach((o,a)=>{const s=t.subcontext[a];s&&s.setState(o)})}function Ij(e,t,n,i){return new Pj(e,t,n,i)}function Pj(e,t,n,i){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=i||Yie,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function zj(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}Pj.prototype=zj.prototype={fork(){const e=new zj(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach(e){this.subcontext=this.subcontext.filter(n=>n!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null},get(e){return this.nodes[e]},set(e,t){return this.nodes[e]=t},add(e,t){const n=this,i=n.dataflow,r=e.value;if(n.set(e.id,t),Gie(e.type)&&r&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){let o=n.get(e.parent.$ref);o?(i.connect(o,[t]),t.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(e.parent.$ref),i.connect(o,[t]),t.targets().add(o)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const o in e.data){const a=n.data[o]||(n.data[o]={});e.data[o].forEach(s=>a[s]=t)}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this},operator(e,t){this.add(e,this.dataflow.add(e.value,t))},transform(e,t){this.add(e,this.dataflow.add(this.transforms[Y_(t)]))},stream(e,t){this.set(e.id,t)},update(e,t,n,i,r){this.dataflow.on(t,n,i,r,e.options)},operatorExpression(e){return this.expr.operator(this,e)},parameterExpression(e){return this.expr.parameter(this,e)},eventExpression(e){return this.expr.event(this,e)},handlerExpression(e){return this.expr.handler(this,e)},encodeExpression(e){return this.expr.encode(this,e)},parse:Uie,parseOperator:Xie,parseOperatorParameters:Kie,parseParameters:Jie,parseStream:sre,parseUpdate:ure,getState:cre,setState:fre};function dre(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),Bj(t,e.description()))}function Bj(e,t){e&&(t==null?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}function hre(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background})}const X_="default";function gre(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:X_,item:null}));e.on(e.events("view","mousemove"),t,(n,i)=>{const r=t.value,o=r?K(r)?r:r.user:X_,a=i.item&&i.item.cursor||null;return r&&o===r.user&&a==r.item?r:{user:o,item:a}}),e.add(null,function(n){let i=n.cursor,r=this.value;return K(i)||(r=i.item,i=i.user),K_(e,i&&i!==X_?i:r||i),r},{cursor:t})}function K_(e,t){const n=e.globalCursor()?typeof document!="undefined"&&document.body:e.container();if(n)return t==null?n.style.removeProperty("cursor"):n.style.cursor=t}function d0(e,t){var n=e._runtime.data;return re(n,t)||L("Unrecognized data set: "+t),n[t]}function pre(e,t){return arguments.length<2?d0(this,e).values.value:h0.call(this,e,Ls().remove(Ni).insert(t))}function h0(e,t){LT(t)||L("Second argument to changes must be a changeset.");const n=d0(this,e);return n.modified=!0,this.pulse(n.input,t)}function mre(e,t){return h0.call(this,e,Ls().insert(t))}function yre(e,t){return h0.call(this,e,Ls().remove(t))}function Uj(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function qj(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function g0(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function vre(e){var t=g0(e),n=Uj(e),i=qj(e);e._renderer.background(e.background()),e._renderer.resize(n,i,t),e._handler.origin(t),e._resizeListeners.forEach(r=>{try{r(n,i)}catch(o){e.error(o)}})}function bre(e,t,n){var i=e._renderer,r=i&&i.canvas(),o,a,s;return r&&(s=g0(e),a=t.changedTouches?t.changedTouches[0]:t,o=Hp(a,r),o[0]-=s[0],o[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=xre(e,n,o),t}function xre(e,t,n){const i=t?t.mark.marktype==="group"?t:t.mark.group:null;function r(a){var s=i,u;if(a){for(u=t;u;u=u.mark.group)if(u.mark.name===a){s=u;break}}return s&&s.mark&&s.mark.interactive?s:{}}function o(a){if(!a)return n;K(a)&&(a=r(a));const s=n.slice();for(;a;)s[0]-=a.x||0,s[1]-=a.y||0,a=a.mark&&a.mark.group;return s}return{view:gn(e),item:gn(t||{}),group:r,xy:o,x:a=>o(a)[0],y:a=>o(a)[1]}}const Wj="view",wre="timer",_re="window",Ere={trap:!1};function Ore(e){const t=Ee({defaults:{}},e),n=(i,r)=>{r.forEach(o=>{P(i[o])&&(i[o]=nr(i[o]))})};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}function Hj(e,t,n,i){e._eventListeners.push({type:n,sources:J(t),handler:i})}function Sre(e,t){var n=e._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[t]:r?!r[t]:e.preventDefault()}function p0(e,t,n){const i=e._eventConfig&&e._eventConfig[t];return i===!1||Q(i)&&!i[n]?(e.warn(`Blocked ${t} ${n} event listener.`),!1):!0}function Are(e,t,n){var i=this,r=new Gg(n),o=function(l,c){i.runAsync(null,()=>{e===Wj&&Sre(i,t)&&l.preventDefault(),r.receive(bre(i,l,c))})},a;if(e===wre)p0(i,"timer",t)&&i.timer(o,t);else if(e===Wj)p0(i,"view",t)&&i.addEventListener(t,o,Ere);else if(e===_re?p0(i,"window",t)&&typeof window!="undefined"&&(a=[window]):typeof document!="undefined"&&p0(i,"selector",t)&&(a=document.querySelectorAll(e)),!a)i.warn("Can not resolve event source: "+e);else{for(var s=0,u=a.length;s<u;++s)a[s].addEventListener(t,o);Hj(i,a,t,o)}return r}function Gj(e){return e.item}function Vj(e){return e.item.mark.source}function Yj(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function kre(e,t){return e=[e||"hover"],t=[t||"update",e[0]],this.on(this.events("view","mouseover",Gj),Vj,Yj(e)),this.on(this.events("view","mouseout",Gj),Vj,Yj(t)),this}function Cre(){var e=this._tooltip,t=this._timers,n=this._eventListeners,i,r,o;for(i=t.length;--i>=0;)t[i].stop();for(i=n.length;--i>=0;)for(o=n[i],r=o.sources.length;--r>=0;)o.sources[r].removeEventListener(o.type,o.handler);return e&&e.call(this,this._handler,null,null,null),this}function Ei(e,t,n){const i=document.createElement(e);for(const r in t)i.setAttribute(r,t[r]);return n!=null&&(i.textContent=n),i}const Tre="vega-bind",Fre="vega-bind-name",Mre="vega-bind-radio";function Dre(e,t,n){if(!t)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:a=>{a!=e.signal(i.signal)&&e.runAsync(null,()=>{r.source=!0,e.signal(i.signal,a)})}},i.debounce&&(r.update=Xy(i.debounce,r.update))),(i.input==null&&i.element?Nre:jre)(r,t,i,e),r.active||(e.on(e._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(e.signal(i.signal))}),r.active=!0),r}function Nre(e,t,n,i){const r=n.event||"input",o=()=>e.update(t.value);i.signal(n.signal,t.value),t.addEventListener(r,o),Hj(i,t,r,o),e.set=a=>{t.value=a,t.dispatchEvent(Rre(r))}}function Rre(e){return typeof Event!="undefined"?new Event(e):{type:e}}function jre(e,t,n,i){const r=i.signal(n.signal),o=Ei("div",{class:Tre}),a=n.input==="radio"?o:o.appendChild(Ei("label"));a.appendChild(Ei("span",{class:Fre},n.name||n.signal)),t.appendChild(o);let s=$re;switch(n.input){case"checkbox":s=Lre;break;case"select":s=Ire;break;case"radio":s=Pre;break;case"range":s=zre;break}s(e,a,n,r)}function $re(e,t,n,i){const r=Ei("input");for(const o in n)o!=="signal"&&o!=="element"&&r.setAttribute(o==="input"?"type":o,n[o]);r.setAttribute("name",n.signal),r.value=i,t.appendChild(r),r.addEventListener("input",()=>e.update(r.value)),e.elements=[r],e.set=o=>r.value=o}function Lre(e,t,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const o=Ei("input",r);t.appendChild(o),o.addEventListener("change",()=>e.update(o.checked)),e.elements=[o],e.set=a=>o.checked=!!a||null}function Ire(e,t,n,i){const r=Ei("select",{name:n.signal}),o=n.labels||[];n.options.forEach((a,s)=>{const u={value:a};m0(a,i)&&(u.selected=!0),r.appendChild(Ei("option",u,(o[s]||a)+""))}),t.appendChild(r),r.addEventListener("change",()=>{e.update(n.options[r.selectedIndex])}),e.elements=[r],e.set=a=>{for(let s=0,u=n.options.length;s<u;++s)if(m0(n.options[s],a)){r.selectedIndex=s;return}}}function Pre(e,t,n,i){const r=Ei("span",{class:Mre}),o=n.labels||[];t.appendChild(r),e.elements=n.options.map((a,s)=>{const u={type:"radio",name:n.signal,value:a};m0(a,i)&&(u.checked=!0);const l=Ei("input",u);l.addEventListener("change",()=>e.update(a));const c=Ei("label",{},(o[s]||a)+"");return c.prepend(l),r.appendChild(c),l}),e.set=a=>{const s=e.elements,u=s.length;for(let l=0;l<u;++l)m0(s[l].value,a)&&(s[l].checked=!0)}}function zre(e,t,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,a=n.step||ya(o,r,100),s=Ei("input",{type:"range",name:n.signal,min:o,max:r,step:a});s.value=i;const u=Ei("span",{},+i);t.appendChild(s),t.appendChild(u);const l=()=>{u.textContent=s.value,e.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),e.elements=[s],e.set=c=>{s.value=c,u.textContent=c}}function m0(e,t){return e===t||e+""==t+""}function Xj(e,t,n,i,r,o){return t=t||new i(e.loader()),t.initialize(n,Uj(e),qj(e),g0(e),r,o).background(e.background())}function J_(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function Bre(e,t,n,i){const r=new i(e.loader(),J_(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,g0(e),e);return t&&t.handlers().forEach(o=>{r.on(o.type,o.handler)}),r}function Ure(e,t){const n=this,i=n._renderType,r=n._eventConfig.bind,o=em(i);e=n._el=e?Q_(n,e,!0):null,dre(n),o||n.error("Unrecognized renderer type: "+i);const a=o.handler||yd,s=e?o.renderer:o.headless;return n._renderer=s?Xj(n,n._renderer,e,s):null,n._handler=Bre(n,n._handler,e,a),n._redraw=!0,e&&r!=="none"&&(t=t?n._elBind=Q_(n,t,!0):e.appendChild(Ei("form",{class:"vega-bindings"})),n._bind.forEach(u=>{u.param.element&&r!=="container"&&(u.element=Q_(n,u.param.element,!!u.param.input))}),n._bind.forEach(u=>{Dre(n,u.element||t,u)})),n}function Q_(e,t,n){if(typeof t=="string")if(typeof document!="undefined"){if(t=document.querySelector(t),!t)return e.error("Signal bind element not found: "+t),null}else return e.error("DOM document instance not found."),null;if(t&&n)try{t.innerHTML=""}catch(i){t=null,e.error(i)}return t}const ih=e=>+e||0,qre=e=>({top:e,bottom:e,left:e,right:e});function Kj(e){return Q(e)?{top:ih(e.top),bottom:ih(e.bottom),left:ih(e.left),right:ih(e.right)}:qre(ih(e))}async function Z_(e,t,n,i){const r=em(t),o=r&&r.headless;return o||L("Unrecognized renderer type: "+t),await e.runAsync(),Xj(e,null,null,o,n,i).renderAsync(e._scenegraph.root)}async function Wre(e,t){e!==Ua.Canvas&&e!==Ua.SVG&&e!==Ua.PNG&&L("Unrecognized image type: "+e);const n=await Z_(this,e,t);return e===Ua.SVG?Hre(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function Hre(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}async function Gre(e,t){return(await Z_(this,Ua.Canvas,e,t)).canvas()}async function Vre(e){return(await Z_(this,Ua.SVG,e)).svg()}function Yre(e,t,n){return Ij(e,Sl,th,n).parse(t)}function Xre(e){var t=this._runtime.scales;return re(t,e)||L("Unrecognized scale or projection: "+e),t[e].value}var Jj="width",Qj="height",eE="padding",Zj={skip:!0};function e$(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===eE?i.left+i.right:0)}function t$(e,t){var n=e.autosize(),i=e.padding();return t-(n&&n.contains===eE?i.top+i.bottom:0)}function Kre(e){var t=e._signals,n=t[Jj],i=t[Qj],r=t[eE];function o(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,s=>{e._width=s.size,e._viewWidth=e$(e,s.size),o()},{size:n}),e._resizeHeight=e.add(null,s=>{e._height=s.size,e._viewHeight=t$(e,s.size),o()},{size:i});const a=e.add(null,o,{pad:r});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=i.rank+1,a.rank=r.rank+1}function Jre(e,t,n,i,r,o){this.runAfter(a=>{let s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal(Jj,n,Zj),a._resizeWidth.skip(!0)),a.height()!==i&&(s=1,a.signal(Qj,i,Zj),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),(a._origin[0]!==r[0]||a._origin[1]!==r[1])&&(a._resize=1,a._origin=r),s&&a.run("enter"),o&&a.runAfter(u=>u.resize())},!1,1)}function Qre(e){return this._runtime.getState(e||{data:Zre,signals:eoe,recurse:!0})}function Zre(e,t){return t.modified&&P(t.input.value)&&e.indexOf("_:vega:_")}function eoe(e,t){return!(e==="parent"||t instanceof Sl.proxy)}function toe(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},t=>{t._trigger=!0}),this}function noe(e,t){function n(i){e({timestamp:Date.now(),elapsed:i})}this._timers.push(jQ(n,t))}function ioe(e,t,n,i){const r=e.element();r&&r.setAttribute("title",roe(i))}function roe(e){return e==null?"":P(e)?n$(e):Q(e)&&!pa(e)?ooe(e):e+""}function ooe(e){return Object.keys(e).map(t=>{const n=e[t];return t+": "+(P(n)?n$(n):i$(n))}).join(`
`)}function n$(e){return"["+e.map(i$).join(", ")+"]"}function i$(e){return P(e)?"[\u2026]":Q(e)&&!pa(e)?"{\u2026}":e}function r$(e,t){const n=this;if(t=t||{},Ol.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),t.logLevel!=null&&n.logLevel(t.logLevel),t.locale||e.locale){const o=Ee({},e.locale,t.locale);n.locale(ST(o.number,o.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||Ua.Canvas,n._scenegraph=new d2;const i=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||ioe,n._redraw=!0,n._handler=new yd().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=Ore(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=Yre(n,e,t.expr);n._runtime=r,n._signals=r.signals,n._bind=(e.bindings||[]).map(o=>({state:null,param:Ee({},o)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=e$(n,n._width),n._viewHeight=t$(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,Kre(n),hre(n),gre(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function y0(e,t){return re(e._signals,t)?e._signals[t]:L("Unrecognized signal name: "+H(t))}function o$(e,t){const n=(e._targets||[]).filter(i=>i._update&&i._update.handler===t);return n.length?n[0]:null}function a$(e,t,n,i){let r=o$(n,i);return r||(r=J_(e,()=>i(t,n.value)),r.handler=i,e.on(n,null,r)),e}function s$(e,t,n){const i=o$(t,n);return i&&t._targets.remove(i),e}W(r$,Ol,{async evaluate(e,t,n){if(await Ol.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,vre(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&Bg(this,n),this},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description(e){if(arguments.length){const t=e!=null?e+"":null;return t!==this._desc&&Bj(this._el,this._desc=t),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(e,t,n){const i=y0(this,e);return arguments.length===1?i.value:this.update(i,t,n)},width(e){return arguments.length?this.signal("width",e):this.signal("width")},height(e){return arguments.length?this.signal("height",e):this.signal("height")},padding(e){return arguments.length?this.signal("padding",Kj(e)):Kj(this.signal("padding"))},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer(e){return arguments.length?(em(e)||L("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader(e){return arguments.length?(e!==this._loader&&(Ol.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(y0(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:Jre,addEventListener(e,t,n){let i=t;return n&&n.trap===!1||(i=J_(this,t),i.raw=t),this._handler.on(e,i),this},removeEventListener(e,t){for(var n=this._handler.handlers(e),i=n.length,r,o;--i>=0;)if(o=n[i].type,r=n[i].handler,e===o&&(t===r||t===r.raw)){this._handler.off(o,r);break}return this},addResizeListener(e){const t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener(e,t){return a$(this,e,y0(this,e),t)},removeSignalListener(e,t){return s$(this,y0(this,e),t)},addDataListener(e,t){return a$(this,e,d0(this,e).values,t)},removeDataListener(e,t){return s$(this,d0(this,e).values,t)},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=K_(this,null);this._globalCursor=!!e,t&&K_(this,t)}return this}else return this._globalCursor},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:noe,events:Are,finalize:Cre,hover:kre,data:pre,change:h0,insert:mre,remove:yre,scale:Xre,initialize:Ure,toImageURL:Wre,toCanvas:Gre,toSVG:Vre,getState:Qre,setState:toe});const aoe="view",v0="[",b0="]",u$="{",l$="}",soe=":",c$=",",uoe="@",loe=">",coe=/[[\]{}]/,foe={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let f$,d$;function Ja(e,t,n){return f$=t||aoe,d$=n||foe,h$(e.trim()).map(tE)}function doe(e){return d$[e]}function rh(e,t,n,i,r){const o=e.length;let a=0,s;for(;t<o;++t){if(s=e[t],!a&&s===n)return t;r&&r.indexOf(s)>=0?--a:i&&i.indexOf(s)>=0&&++a}return t}function h$(e){const t=[],n=e.length;let i=0,r=0;for(;r<n;)r=rh(e,r,c$,v0+u$,b0+l$),t.push(e.substring(i,r).trim()),i=++r;if(t.length===0)throw"Empty event selector: "+e;return t}function tE(e){return e[0]==="["?hoe(e):goe(e)}function hoe(e){const t=e.length;let n=1,i;if(n=rh(e,n,b0,v0,b0),n===t)throw"Empty between selector: "+e;if(i=h$(e.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+e;if(e=e.slice(n+1).trim(),e[0]!==loe)throw"Expected '>' after between selector: "+e;i=i.map(tE);const r=tE(e.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function goe(e){const t={source:f$},n=[];let i=[0,0],r=0,o=0,a=e.length,s=0,u,l;if(e[a-1]===l$){if(s=e.lastIndexOf(u$),s>=0){try{i=poe(e.substring(s+1,a-1))}catch{throw"Invalid throttle specification: "+e}e=e.slice(0,s).trim(),a=e.length}else throw"Unmatched right brace: "+e;s=0}if(!a)throw e;if(e[0]===uoe&&(r=++s),u=rh(e,s,soe),u<a&&(n.push(e.substring(o,u).trim()),o=s=++u),s=rh(e,s,v0),s===a)n.push(e.substring(o,a).trim());else if(n.push(e.substring(o,s).trim()),l=[],o=++s,o===a)throw"Unmatched left bracket: "+e;for(;s<a;){if(s=rh(e,s,b0),s===a)throw"Unmatched left bracket: "+e;if(l.push(e.substring(o,s).trim()),s<a-1&&e[++s]!==v0)throw"Expected left bracket: "+e;o=++s}if(!(a=n.length)||coe.test(n[a-1]))throw"Invalid event selector: "+e;return a>1?(t.type=n[1],r?t.markname=n[0].slice(1):doe(n[0])?t.marktype=n[0]:t.source=n[0]):t.type=n[0],t.type.slice(-1)==="!"&&(t.consume=!0,t.type=t.type.slice(0,-1)),l!=null&&(t.filter=l),i[0]&&(t.throttle=i[0]),i[1]&&(t.debounce=i[1]),t}function poe(e){const t=e.split(c$);if(!e.length||t.length>2)throw e;return t.map(n=>{const i=+n;if(i!==i)throw e;return i})}function moe(e){return Q(e)?e:{type:e||"pad"}}const oh=e=>+e||0,yoe=e=>({top:e,bottom:e,left:e,right:e});function voe(e){return Q(e)?e.signal?e:{top:oh(e.top),bottom:oh(e.bottom),left:oh(e.left),right:oh(e.right)}:yoe(oh(e))}const Ut=e=>Q(e)&&!P(e)?Ee({},e):{value:e};function g$(e,t,n,i){return n!=null?(Q(n)&&!P(n)||P(n)&&n.length&&Q(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1):0}function nn(e,t,n){for(const i in t)g$(e,i,t[i]);for(const i in n)g$(e,i,n[i],"update")}function ac(e,t,n){for(const i in t)n&&re(n,i)||(e[i]=Ee(e[i]||{},t[i]));return e}function sc(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}const nE="mark",iE="frame",rE="scope",boe="axis",xoe="axis-domain",woe="axis-grid",_oe="axis-label",Eoe="axis-tick",Ooe="axis-title",Soe="legend",Aoe="legend-band",koe="legend-entry",Coe="legend-gradient",p$="legend-label",Toe="legend-symbol",Foe="legend-title",Moe="title",Doe="title-text",Noe="title-subtitle";function Roe(e,t,n,i,r){const o={},a={};let s,u,l,c;u="lineBreak",t==="text"&&r[u]!=null&&!sc(u,e)&&oE(o,u,r[u]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),c=n===iE?r.group:n===nE?Ee({},r.mark,r[t]):null;for(u in c)l=sc(u,e)||(u==="fill"||u==="stroke")&&(sc("fill",e)||sc("stroke",e)),l||oE(o,u,c[u]);J(i).forEach(f=>{const d=r.style&&r.style[f];for(const h in d)sc(h,e)||oE(o,h,d[h])}),e=Ee({},e);for(u in o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return e.enter=Ee(a,e.enter),s&&(e.update=Ee(s,e.update)),e}function oE(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}const m$=e=>K(e)?H(e):e.signal?`(${e.signal})`:y$(e);function x0(e){if(e.gradient!=null)return $oe(e);let t=e.signal?`(${e.signal})`:e.color?joe(e.color):e.field!=null?y$(e.field):e.value!==void 0?H(e.value):void 0;return e.scale!=null&&(t=Loe(e,t)),t===void 0&&(t=null),e.exponent!=null&&(t=`pow(${t},${_0(e.exponent)})`),e.mult!=null&&(t+=`*${_0(e.mult)}`),e.offset!=null&&(t+=`+${_0(e.offset)}`),e.round&&(t=`round(${t})`),t}const w0=(e,t,n,i)=>`(${e}(${[t,n,i].map(x0).join(",")})+'')`;function joe(e){return e.c?w0("hcl",e.h,e.c,e.l):e.h||e.s?w0("hsl",e.h,e.s,e.l):e.l||e.a?w0("lab",e.l,e.a,e.b):e.r||e.g||e.b?w0("rgb",e.r,e.g,e.b):null}function $oe(e){const t=[e.start,e.stop,e.count].map(n=>n==null?null:H(n));for(;t.length&&Fe(t)==null;)t.pop();return t.unshift(m$(e.gradient)),`gradient(${t.join(",")})`}function _0(e){return Q(e)?"("+x0(e)+")":e}function y$(e){return v$(Q(e)?e:{datum:e})}function v$(e){let t,n,i;if(e.signal)t="datum",i=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(i=e.parent,t+=".datum"):i=e.group}else e.datum?(t="datum",i=e.datum):L("Invalid field reference: "+H(e));return e.signal||(i=K(i)?jr(i).map(H).join("]["):v$(i)),t+"["+i+"]"}function Loe(e,t){const n=m$(e.scale);return e.range!=null?t=`lerp(_range(${n}), ${+e.range})`:(t!==void 0&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(+e.band==1?"":"*"+_0(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),t==null&&(t="0")),t}function Ioe(e){let t="";return e.forEach(n=>{const i=x0(n);t+=n.test?`(${n.test})?${i}:`:i}),Fe(t)===":"&&(t+="null"),t}function b$(e,t,n,i,r,o){const a={};o=o||{},o.encoders={$encode:a},e=Roe(e,t,n,i,r.config);for(const s in e)a[s]=Poe(e[s],t,o,r);return o}function Poe(e,t,n,i){const r={},o={};for(const a in e)e[a]!=null&&(r[a]=Boe(zoe(e[a]),i,n,o));return{$expr:{marktype:t,channels:r},$fields:Object.keys(o),$output:Object.keys(e)}}function zoe(e){return P(e)?Ioe(e):x0(e)}function Boe(e,t,n,i){const r=to(e,t);return r.$fields.forEach(o=>i[o]=1),Ee(n,r.$params),r.$expr}const Uoe="outer",qoe=["value","update","init","react","bind"];function x$(e,t){L(e+' for "outer" push: '+H(t))}function w$(e,t){const n=e.name;if(e.push===Uoe)t.signals[n]||x$("No prior signal definition",n),qoe.forEach(i=>{e[i]!==void 0&&x$("Invalid property ",i)});else{const i=t.addSignal(n,e.value);e.react===!1&&(i.react=!1),e.bind&&t.addBinding(n,e.bind)}}function aE(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i)}function E0(e,t,n,i){return new aE(e,t,n,i)}function O0(e,t){return E0("operator",e,t)}function ue(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function ah(e,t){return t?{$field:e,$name:t}:{$field:e}}const sE=ah("key");function _$(e,t){return{$compare:e,$order:t}}function Woe(e,t){const n={$key:e};return t&&(n.$flat=!0),n}const Hoe="ascending",Goe="descending";function Voe(e){return Q(e)?(e.order===Goe?"-":"+")+S0(e.op,e.field):""}function S0(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}const uE="scope",lE="view";function jt(e){return e&&e.signal}function Yoe(e){return e&&e.expr}function A0(e){if(jt(e))return!0;if(Q(e)){for(const t in e)if(A0(e[t]))return!0}return!1}function gr(e,t){return e!=null?e:t}function lu(e){return e&&e.signal||e}const E$="timer";function sh(e,t){return(e.merge?Koe:e.stream?Joe:e.type?Qoe:L("Invalid stream specification: "+H(e)))(e,t)}function Xoe(e){return e===uE?lE:e||lE}function Koe(e,t){const n=e.merge.map(r=>sh(r,t)),i=cE({merge:n},e,t);return t.addStream(i).id}function Joe(e,t){const n=sh(e.stream,t),i=cE({stream:n},e,t);return t.addStream(i).id}function Qoe(e,t){let n;e.type===E$?(n=t.event(E$,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Xoe(e.source),e.type);const i=cE({stream:n},e,t);return Object.keys(i).length===1?n:t.addStream(i).id}function cE(e,t,n){let i=t.between;return i&&(i.length!==2&&L('Stream "between" parameter must have 2 entries: '+H(t)),e.between=[sh(i[0],n),sh(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(Zoe(t.marktype,t.markname,t.markrole)),t.source===uE&&i.push("inScope(event.item)"),i.length&&(e.filter=to("("+i.join(")&&(")+")",n).$expr),(i=t.throttle)!=null&&(e.throttle=+i),(i=t.debounce)!=null&&(e.debounce=+i),t.consume&&(e.consume=!0),e}function Zoe(e,t,n){const i="event.item";return i+(e&&e!=="*"?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"")}const eae={code:"_.$value",ast:{type:"Identifier",value:"value"}};function tae(e,t,n){const i=e.encode,r={target:n};let o=e.events,a=e.update,s=[];o||L("Signal update missing events specification."),K(o)&&(o=Ja(o,t.isSubscope()?uE:lE)),o=J(o).filter(u=>u.signal||u.scale?(s.push(u),0):1),s.length>1&&(s=[iae(s)]),o.length&&s.push(o.length>1?{merge:o}:o[0]),i!=null&&(a&&L("Signal encode and update are mutually exclusive."),a="encode(item(),"+H(i)+")"),r.update=K(a)?to(a,t):a.expr!=null?to(a.expr,t):a.value!=null?a.value:a.signal!=null?{$expr:eae,$params:{$value:t.signalRef(a.signal)}}:L("Invalid signal update specification."),e.force&&(r.options={force:!0}),s.forEach(u=>t.addUpdate(Ee(nae(u,t),r)))}function nae(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):sh(e,t)}}function iae(e){return{signal:"["+e.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}function rae(e,t){const n=t.getSignal(e.name);let i=e.update;e.init&&(i?L("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=to(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach(r=>tae(r,t,n.id))}const Qe=e=>(t,n,i)=>E0(e,n,t||void 0,i),O$=Qe("aggregate"),oae=Qe("axisticks"),S$=Qe("bound"),pr=Qe("collect"),A$=Qe("compare"),aae=Qe("datajoin"),k$=Qe("encode"),sae=Qe("expression"),uae=Qe("facet"),lae=Qe("field"),cae=Qe("key"),fae=Qe("legendentries"),dae=Qe("load"),hae=Qe("mark"),gae=Qe("multiextent"),pae=Qe("multivalues"),mae=Qe("overlap"),yae=Qe("params"),C$=Qe("prefacet"),vae=Qe("projection"),bae=Qe("proxy"),xae=Qe("relay"),T$=Qe("render"),wae=Qe("scale"),cu=Qe("sieve"),_ae=Qe("sortitems"),F$=Qe("viewlayout"),Eae=Qe("values");let Oae=0;const M$={min:"min",max:"max",count:"sum"};function Sae(e,t){const n=e.type||"linear";mD(n)||L("Unrecognized scale type: "+H(n)),t.addScale(e.name,{type:n,domain:void 0})}function Aae(e,t){const n=t.getScale(e.name).params;let i;n.domain=D$(e.domain,e,t),e.range!=null&&(n.range=R$(e,t,n)),e.interpolate!=null&&$ae(e.interpolate,n),e.nice!=null&&(n.nice=jae(e.nice)),e.bins!=null&&(n.bins=Rae(e.bins,t));for(i in e)re(n,i)||i==="name"||(n[i]=Bi(e[i],t))}function Bi(e,t){return Q(e)?e.signal?t.signalRef(e.signal):L("Unsupported object: "+H(e)):e}function k0(e,t){return e.signal?t.signalRef(e.signal):e.map(n=>Bi(n,t))}function C0(e){L("Can not find data set: "+H(e))}function D$(e,t,n){if(!e){(t.domainMin!=null||t.domainMax!=null)&&L("No scale domain defined for domainMin/domainMax to override.");return}return e.signal?n.signalRef(e.signal):(P(e)?kae:e.fields?Tae:Cae)(e,t,n)}function kae(e,t,n){return e.map(i=>Bi(i,n))}function Cae(e,t,n){const i=n.getData(e.data);return i||C0(e.data),Ll(t.type)?i.valuesRef(n,e.field,N$(e.sort,!1)):bD(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field)}function Tae(e,t,n){const i=e.data,r=e.fields.reduce((o,a)=>(a=K(a)?{data:i,field:a}:P(a)||a.signal?Fae(a,n):a,o.push(a),o),[]);return(Ll(t.type)?Mae:bD(t.type)?Dae:Nae)(e,n,r)}function Fae(e,t){const n="_:vega:_"+Oae++,i=pr({});if(P(e))i.value={$ingest:e};else if(e.signal){const r="setdata("+H(n)+","+e.signal+")";i.params.input=t.signalRef(r)}return t.addDataPipeline(n,[i,cu({})]),{data:n,field:"data"}}function Mae(e,t,n){const i=N$(e.sort,!0);let r,o;const a=n.map(l=>{const c=t.getData(l.data);return c||C0(l.data),c.countsRef(t,l.field,i)}),s={groupby:sE,pulse:a};i&&(r=i.op||"count",o=i.field?S0(r,i.field):"count",s.ops=[M$[r]],s.fields=[t.fieldRef(o)],s.as=[o]),r=t.add(O$(s));const u=t.add(pr({pulse:ue(r)}));return o=t.add(Eae({field:sE,sort:t.sortRef(i),pulse:ue(u)})),ue(o)}function N$(e,t){return e&&(!e.field&&!e.op?Q(e)?e.field="key":e={field:"key"}:!e.field&&e.op!=="count"?L("No field provided for sort aggregate op: "+e.op):t&&e.field&&e.op&&!M$[e.op]&&L("Multiple domain scales can not be sorted using "+e.op)),e}function Dae(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||C0(r.data),o.domainRef(t,r.field)});return ue(t.add(pae({values:i})))}function Nae(e,t,n){const i=n.map(r=>{const o=t.getData(r.data);return o||C0(r.data),o.extentRef(t,r.field)});return ue(t.add(gae({extents:i})))}function Rae(e,t){return e.signal||P(e)?k0(e,t):t.objectProperty(e)}function jae(e){return Q(e)?{interval:Bi(e.interval),step:Bi(e.step)}:Bi(e)}function $ae(e,t){t.interpolate=Bi(e.type||e),e.gamma!=null&&(t.interpolateGamma=Bi(e.gamma))}function R$(e,t,n){const i=t.config.range;let r=e.range;if(r.signal)return t.signalRef(r.signal);if(K(r)){if(i&&re(i,r))return e=Ee({},e,{range:i[r]}),R$(e,t,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Ll(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:L("Unrecognized scale range value: "+H(r))}else if(r.scheme){n.scheme=P(r.scheme)?k0(r.scheme,t):Bi(r.scheme,t),r.extent&&(n.schemeExtent=k0(r.extent,t)),r.count&&(n.schemeCount=Bi(r.count,t));return}else if(r.step){n.rangeStep=Bi(r.step,t);return}else{if(Ll(e.type)&&!P(r))return D$(r,e,t);P(r)||L("Unsupported range type: "+H(r))}return r.map(o=>(P(o)?k0:Bi)(o,t))}function Lae(e,t){const n=t.config.projection||{},i={};for(const r in e)r!=="name"&&(i[r]=fE(e[r],r,t));for(const r in n)i[r]==null&&(i[r]=fE(n[r],r,t));t.addProjection(e.name,i)}function fE(e,t,n){return P(e)?e.map(i=>fE(i,t,n)):Q(e)?e.signal?n.signalRef(e.signal):t==="fit"?e:L("Unsupported parameter object: "+H(e)):e}const mr="top",uc="left",lc="right",Qa="bottom",j$="center",Iae="vertical",Pae="start",zae="middle",Bae="end",dE="index",hE="label",Uae="offset",cc="perc",qae="perc2",Ui="value",uh="guide-label",gE="guide-title",Wae="group-title",Hae="group-subtitle",$$="symbol",T0="gradient",pE="discrete",mE="size",Gae="shape",Vae="fill",Yae="stroke",Xae="strokeWidth",Kae="strokeDash",Jae="opacity",yE=[mE,Gae,Vae,Yae,Xae,Kae,Jae],lh={name:1,style:1,interactive:1},Re={value:0},qi={value:1},F0="group",L$="rect",vE="rule",Qae="symbol",fu="text";function ch(e){return e.type=F0,e.interactive=e.interactive||!1,e}function oi(e,t){const n=(i,r)=>gr(e[i],gr(t[i],r));return n.isVertical=i=>Iae===gr(e.direction,t.direction||(i?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>gr(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>gr(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>gr(e.columns,gr(t.columns,+n.isVertical(!0))),n}function I$(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Zae(e,t,n){const i=t.config.style[n];return i&&i[e]}function M0(e,t,n){return`item.anchor === '${Pae}' ? ${e} : item.anchor === '${Bae}' ? ${t} : ${n}`}const bE=M0(H(uc),H(lc),H(j$));function ese(e){const t=e("tickBand");let n=e("tickOffset"),i,r;return t?t.signal?(i={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${t.signal}) === 'extent'`},Q(n)||(n={signal:`(${t.signal}) === 'extent' ? 0 : ${n}`})):t==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=e("bandPosition"),r=e("tickExtra")),{extra:r,band:i,offset:n}}function P$(e,t){return t?e?Q(e)?Object.assign({},e,{offset:P$(e.offset,t)}):{value:e,offset:t}:t:e}function Oi(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=ac(e.encode,t,lh)):e.interactive=!1,e}function tse(e,t,n,i){const r=oi(e,n),o=r.isVertical(),a=r.gradientThickness(),s=r.gradientLength();let u,l,c,f,d;o?(l=[0,1],c=[0,0],f=a,d=s):(l=[0,0],c=[1,0],f=s,d=a);const h={enter:u={opacity:Re,x:Re,y:Re,width:Ut(f),height:Ut(d)},update:Ee({},u,{opacity:qi,fill:{gradient:t,start:l,stop:c}}),exit:{opacity:Re}};return nn(h,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Oi({type:L$,role:Coe,encode:h},i)}function nse(e,t,n,i,r){const o=oi(e,n),a=o.isVertical(),s=o.gradientThickness(),u=o.gradientLength();let l,c,f,d,h="";a?(l="y",f="y2",c="x",d="width",h="1-"):(l="x",f="x2",c="y",d="height");const g={opacity:Re,fill:{scale:t,field:Ui}};g[l]={signal:h+"datum."+cc,mult:u},g[c]=Re,g[f]={signal:h+"datum."+qae,mult:u},g[d]=Ut(s);const p={enter:g,update:Ee({},g,{opacity:qi}),exit:{opacity:Re}};return nn(p,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),Oi({type:L$,role:Aoe,key:Ui,from:r,encode:p},i)}const ise=`datum.${cc}<=0?"${uc}":datum.${cc}>=1?"${lc}":"${j$}"`,rse=`datum.${cc}<=0?"${Qa}":datum.${cc}>=1?"${mr}":"${zae}"`;function z$(e,t,n,i){const r=oi(e,t),o=r.isVertical(),a=Ut(r.gradientThickness()),s=r.gradientLength();let u=r("labelOverlap"),l,c,f,d,h="";const g={enter:l={opacity:Re},update:c={opacity:qi,text:{field:hE}},exit:{opacity:Re}};return nn(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:gr(e.labelLimit,t.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=c.baseline={signal:rse},f="y",d="x",h="1-"):(l.align=c.align={signal:ise},l.baseline={value:"top"},f="x",d="y"),l[f]=c[f]={signal:h+"datum."+cc,mult:s},l[d]=c[d]=a,a.offset=gr(e.labelOffset,t.gradientLabelOffset)||0,u=u?{separation:r("labelSeparation"),method:u,order:"datum."+dE}:void 0,Oi({type:fu,role:p$,style:uh,key:Ui,from:i,encode:g,overlap:u},n)}function ose(e,t,n,i,r){const o=oi(e,t),a=n.entries,s=!!(a&&a.interactive),u=a?a.name:void 0,l=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},d=`(${r}) ? datum.${Uae} : datum.${mE}`,h=l?Ut(l):{field:mE},g=`datum.${dE}`,p=`max(1, ${r})`;let m,y,v,x,b;h.mult=.5,m={enter:y={opacity:Re,x:{signal:d,mult:.5,offset:c},y:h},update:v={opacity:qi,x:y.x,y:y.y},exit:{opacity:Re}};let _=null,E=null;e.fill||(_=t.symbolBaseFillColor,E=t.symbolBaseStrokeColor),nn(m,{fill:o("symbolFillColor",_),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",E),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),yE.forEach(k=>{e[k]&&(v[k]=y[k]={scale:e[k],field:Ui})});const w=Oi({type:Qae,role:Toe,key:Ui,from:f,clip:l?!0:void 0,encode:m},n.symbols),O=Ut(c);O.offset=o("labelOffset"),m={enter:y={opacity:Re,x:{signal:d,offset:O},y:h},update:v={opacity:qi,text:{field:hE},x:y.x,y:y.y},exit:{opacity:Re}},nn(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const S=Oi({type:fu,role:p$,style:uh,key:Ui,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:Re,height:l?Ut(l):Re,opacity:Re},exit:{opacity:Re},update:v={opacity:qi,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(x=`ceil(item.mark.items.length / ${p})`,v.row.signal=`${g}%${x}`,v.column.signal=`floor(${g} / ${x})`,b={field:["row",g]}):(v.row.signal=`floor(${g} / ${p})`,v.column.signal=`${g} % ${p}`,b={field:g}),v.column.signal=`(${r})?${v.column.signal}:${g}`,i={facet:{data:i,name:"value",groupby:dE}},ch({role:rE,from:i,encode:ac(m,a,lh),marks:[w,S],name:u,interactive:s,sort:b})}function ase(e,t){const n=oi(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const xE='item.orient === "left"',wE='item.orient === "right"',D0=`(${xE} || ${wE})`,sse=`datum.vgrad && ${D0}`,use=M0('"top"','"bottom"','"middle"'),lse=M0('"right"','"left"','"center"'),cse=`datum.vgrad && ${wE} ? (${lse}) : (${D0} && !(datum.vgrad && ${xE})) ? "left" : ${bE}`,fse=`item._anchor || (${D0} ? "middle" : "start")`,dse=`${sse} ? (${xE} ? -90 : 90) : 0`,hse=`${D0} ? (datum.vgrad ? (${wE} ? "bottom" : "top") : ${use}) : "top"`;function gse(e,t,n,i){const r=oi(e,t),o={enter:{opacity:Re},update:{opacity:qi,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Re}};return nn(o,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:fse},angle:{signal:dse},align:{signal:cse},baseline:{signal:hse},text:e.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Oi({type:fu,role:Foe,style:gE,from:i,encode:o},n)}function pse(e,t){let n;return Q(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+B$(e.path)+")":e.sphere&&(n="geoShape("+B$(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function B$(e){return Q(e)&&e.signal?e.signal:H(e)}function U$(e){const t=e.role||"";return!t.indexOf("axis")||!t.indexOf("legend")||!t.indexOf("title")?t:e.type===F0?rE:t||nE}function mse(e){return{marktype:e.type,name:e.name||void 0,role:e.role||U$(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function yse(e,t){return e&&e.signal?t.signalRef(e.signal):e!==!1}function _E(e,t){const n=GT(e.type);n||L("Unrecognized transform type: "+H(e.type));const i=E0(n.type.toLowerCase(),null,q$(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(i)),i.metadata=n.metadata||{},i}function q$(e,t,n){const i={},r=e.params.length;for(let o=0;o<r;++o){const a=e.params[o];i[a.name]=vse(a,t,n)}return i}function vse(e,t,n){const i=e.type,r=t[e.name];if(i==="index")return bse(e,t,n);if(r===void 0){e.required&&L("Missing required "+H(t.type)+" parameter: "+H(e.name));return}else{if(i==="param")return xse(e,t,n);if(i==="projection")return n.projectionRef(t[e.name])}return e.array&&!jt(r)?r.map(o=>W$(e,o,n)):W$(e,r,n)}function W$(e,t,n){const i=e.type;if(jt(t))return G$(i)?L("Expression references can not be signals."):EE(i)?n.fieldRef(t):V$(i)?n.compareRef(t):n.signalRef(t.signal);{const r=e.expr||EE(i);return r&&wse(t)?n.exprRef(t.expr,t.as):r&&_se(t)?ah(t.field,t.as):G$(i)?to(t,n):Ese(i)?ue(n.getData(t).values):EE(i)?ah(t):V$(i)?n.compareRef(t):t}}function bse(e,t,n){return K(t.from)||L('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}function xse(e,t,n){const i=t[e.name];return e.array?(P(i)||L("Expected an array of sub-parameters. Instead: "+H(i)),i.map(r=>H$(e,r,n))):H$(e,i,n)}function H$(e,t,n){const i=e.params.length;let r;for(let a=0;a<i;++a){r=e.params[a];for(const s in r.key)if(r.key[s]!==t[s]){r=null;break}if(r)break}r||L("Unsupported parameter: "+H(t));const o=Ee(q$(r,t,n),r.key);return ue(n.add(yae(o)))}const wse=e=>e&&e.expr,_se=e=>e&&e.field,Ese=e=>e==="data",G$=e=>e==="expr",EE=e=>e==="field",V$=e=>e==="compare";function Ose(e,t,n){let i,r,o,a,s;return e?(i=e.facet)&&(t||L("Only group marks can be faceted."),i.field!=null?a=s=N0(i,n):(e.data?s=ue(n.getData(e.data).aggregate):(o=_E(Ee({type:"aggregate",groupby:J(i.groupby)},i.aggregate),n),o.params.key=n.keyRef(i.groupby),o.params.pulse=N0(i,n),a=s=ue(n.add(o))),r=n.keyRef(i.groupby,!0))):a=ue(n.add(pr(null,[{}]))),a||(a=N0(e,n)),{key:r,pulse:a,parent:s}}function N0(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:ue(t.getData(e.data).output)}function du(e,t,n,i,r){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=r,this.index={}}du.fromEntries=function(e,t){const n=t.length,i=t[n-1],r=t[n-2];let o=t[0],a=null,s=1;for(o&&o.type==="load"&&(o=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=ue(t[s-1]),e.add(t[s]),t[s].type==="aggregate"&&(a=t[s]);return new du(e,o,r,i,a)};function Y$(e){return K(e)?e:null}function X$(e,t,n){const i=S0(n.op,n.field);let r;if(t.ops){for(let o=0,a=t.as.length;o<a;++o)if(t.as[o]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function fh(e,t,n,i,r,o,a){const s=t[n]||(t[n]={}),u=Voe(o);let l=Y$(r),c,f;if(l!=null&&(e=t.scope,l=l+(u?"|"+u:""),c=s[l]),!c){const d=o?{field:sE,pulse:t.countsRef(e,r,o)}:{field:e.fieldRef(r),pulse:ue(t.output)};u&&(d.sort=e.sortRef(o)),f=e.add(E0(i,void 0,d)),a&&(t.index[r]=f),c=ue(f),l!=null&&(s[l]=c)}return c}du.prototype={countsRef(e,t,n){const i=this,r=i.counts||(i.counts={}),o=Y$(t);let a,s,u;return o!=null&&(e=i.scope,a=r[o]),a?n&&n.field&&X$(e,a.agg.params,n):(u={groupby:e.fieldRef(t,"key"),pulse:ue(i.output)},n&&n.field&&X$(e,u,n),s=e.add(O$(u)),a=e.add(pr({pulse:ue(s)})),a={agg:s,ref:ue(a)},o!=null&&(r[o]=a)),a.ref},tuplesRef(){return ue(this.values)},extentRef(e,t){return fh(e,this,"extent","extent",t,!1)},domainRef(e,t){return fh(e,this,"domain","values",t,!1)},valuesRef(e,t,n){return fh(e,this,"vals","values",t,n||!0)},lookupRef(e,t){return fh(e,this,"lookup","tupleindex",t,!1)},indataRef(e,t){return fh(e,this,"indata","tupleindex",t,!0,!0)}};function Sse(e,t,n){const i=e.from.facet,r=i.name,o=N0(i,t);let a;i.name||L("Facet must have a name: "+H(i)),i.data||L("Facet must reference a data set: "+H(i)),i.field?a=t.add(C$({field:t.fieldRef(i.field),pulse:o})):i.groupby?a=t.add(uae({key:t.keyRef(i.groupby),group:ue(t.proxy(n.parent)),pulse:o})):L("Facet must specify groupby or field: "+H(i));const s=t.fork(),u=s.add(pr()),l=s.add(cu({pulse:ue(u)}));s.addData(r,new du(s,u,u,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}function Ase(e,t,n){const i=t.add(C$({pulse:n.pulse})),r=t.fork();r.add(cu()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(e).toRuntime()}}function K$(e,t,n){const i=e.remove,r=e.insert,o=e.toggle,a=e.modify,s=e.values,u=t.add(O0()),l="if("+e.trigger+',modify("'+n+'",'+[r,i,o,a,s].map(f=>f==null?"null":f).join(",")+"),0)",c=to(l,t);u.update=c.$expr,u.params=c.$params}function R0(e,t){const n=U$(e),i=e.type===F0,r=e.from&&e.from.facet,o=e.overlap;let a=e.layout||n===rE||n===iE,s,u,l,c,f,d,h;const g=n===nE||a||r,p=Ose(e.from,i,t);u=t.add(aae({key:p.key||(e.key?ah(e.key):void 0),pulse:p.pulse,clean:!i}));const m=ue(u);u=l=t.add(pr({pulse:m})),u=t.add(hae({markdef:mse(e),interactive:yse(e.interactive,t),clip:pse(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:ue(u)}));const y=ue(u);u=c=t.add(k$(b$(e.encode,e.type,n,e.style,t,{mod:!1,pulse:y}))),u.params.parent=t.encode(),e.transform&&e.transform.forEach(E=>{const w=_E(E,t),O=w.metadata;(O.generates||O.changes)&&L("Mark transforms should not generate new data."),O.nomod||(c.params.mod=!0),w.params.pulse=ue(u),t.add(u=w)}),e.sort&&(u=t.add(_ae({sort:t.compareRef(e.sort),pulse:ue(u)})));const v=ue(u);(r||a)&&(a=t.add(F$({layout:t.objectProperty(e.layout),legends:t.legends,mark:y,pulse:v})),d=ue(a));const x=t.add(S$({mark:y,pulse:d||v}));h=ue(x),i&&(g&&(s=t.operators,s.pop(),a&&s.pop()),t.pushState(v,d||h,m),r?Sse(e,t,p):g?Ase(e,t,p):t.parse(e),t.popState(),g&&(a&&s.push(a),s.push(x))),o&&(h=kse(o,h,t));const b=t.add(T$({pulse:h})),_=t.add(cu({pulse:ue(b)},void 0,t.parent()));e.name!=null&&(f=e.name,t.addData(f,new du(t,l,b,_)),e.on&&e.on.forEach(E=>{(E.insert||E.remove||E.toggle)&&L("Marks only support modify triggers."),K$(E,t,f)}))}function kse(e,t,n){const i=e.method,r=e.bound,o=e.separation,a={separation:jt(o)?n.signalRef(o.signal):o,method:jt(i)?n.signalRef(i.signal):i,pulse:t};if(e.order&&(a.sort=n.compareRef({field:e.order})),r){const s=r.tolerance;a.boundTolerance=jt(s)?n.signalRef(s.signal):+s,a.boundScale=n.scaleRef(r.scale),a.boundOrient=r.orient}return ue(n.add(mae(a)))}function Cse(e,t){const n=t.config.legend,i=e.encode||{},r=oi(e,n),o=i.legend||{},a=o.name||void 0,s=o.interactive,u=o.style,l={};let c=0,f,d,h;yE.forEach(x=>e[x]?(l[x]=e[x],c=c||e[x]):0),c||L("Missing valid scale for legend.");const g=Tse(e,t.scaleType(c)),p={title:e.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},m=ue(t.add(pr(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=ue(t.add(fae(d={type:g,scale:t.scaleRef(c),count:t.objectProperty(r("tickCount")),limit:t.property(r("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return g===T0?(h=[tse(e,c,n,i.gradient),z$(e,n,i.labels,v)],d.count=d.count||t.signalRef(`max(2,2*floor((${lu(r.gradientLength())})/100))`)):g===pE?h=[nse(e,c,n,i.gradient,v),z$(e,n,i.labels,v)]:(f=ase(e,n),h=[ose(e,n,i,v,lu(f.columns))],d.size=Dse(e,t,h[0].marks)),h=[ch({role:koe,from:m,encode:y,marks:h,layout:f,interactive:s})],p.title&&h.push(gse(e,n,i.title,m)),R0(ch({role:Soe,from:m,encode:ac(Mse(r,e,n),o,lh),marks:h,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:a,interactive:s,style:u}),t)}function Tse(e,t){let n=e.type||$$;return!e.type&&Fse(e)===1&&(e.fill||e.stroke)&&(n=Cx(t)?T0:Tx(t)?pE:$$),n!==T0?n:Tx(t)?pE:T0}function Fse(e){return yE.reduce((t,n)=>t+(e[n]?1:0),0)}function Mse(e,t,n){const i={enter:{},update:{}};return nn(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i}function Dse(e,t,n){const i=lu(J$("size",e,n)),r=lu(J$("strokeWidth",e,n)),o=lu(Nse(n[1].encode,t,uh));return to(`max(ceil(sqrt(${i})+${r}),${o})`,t)}function J$(e,t,n){return t[e]?`scale("${t[e]}",datum)`:I$(e,n[0].encode)}function Nse(e,t,n){return I$("fontSize",e)||Zae("fontSize",t,n)}const Rse=`item.orient==="${uc}"?-90:item.orient==="${lc}"?90:0`;function jse(e,t){e=K(e)?{text:e}:e;const n=oi(e,t.config.title),i=e.encode||{},r=i.group||{},o=r.name||void 0,a=r.interactive,s=r.style,u=[],l={},c=ue(t.add(pr(null,[l])));return u.push(Ise(e,n,$se(e),c)),e.subtitle&&u.push(Pse(e,n,i.subtitle,c)),R0(ch({role:Moe,from:c,encode:Lse(n,r),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:a,style:s}),t)}function $se(e){const t=e.encode;return t&&t.title||Ee({name:e.name,interactive:e.interactive,style:e.style},t)}function Lse(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:bE},angle:{signal:Rse},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),ac(n,t,lh)}function Ise(e,t,n,i){const r={value:0},o=e.text,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return nn(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Oi({type:fu,role:Doe,style:Wae,from:i,encode:a},n)}function Pse(e,t,n,i){const r={value:0},o=e.subtitle,a={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return nn(a,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Oi({type:fu,role:Noe,style:Hae,from:i,encode:a},n)}function zse(e,t){const n=[];e.transform&&e.transform.forEach(i=>{n.push(_E(i,t))}),e.on&&e.on.forEach(i=>{K$(i,t,e.name)}),t.addDataPipeline(e.name,Bse(e,t,n))}function Bse(e,t,n){const i=[];let r=null,o=!1,a=!1,s,u,l,c,f;for(e.values?jt(e.values)||A0(e.format)?(i.push(Q$(t,e)),i.push(r=hu())):i.push(r=hu({$ingest:e.values,$format:e.format})):e.url?A0(e.url)||A0(e.format)?(i.push(Q$(t,e)),i.push(r=hu())):i.push(r=hu({$request:e.url,$format:e.format})):e.source&&(r=s=J(e.source).map(d=>ue(t.getData(d).output)),i.push(null)),u=0,l=n.length;u<l;++u)c=n[u],f=c.metadata,!r&&!f.source&&i.push(r=hu()),i.push(c),f.generates&&(a=!0),f.modifies&&!a&&(o=!0),f.source?r=c:f.changes&&(r=null);return s&&(l=s.length-1,i[0]=xae({derive:o,pulse:l?s:s[0]}),(o||l)&&i.splice(1,0,hu())),r||i.push(hu()),i.push(cu({})),i}function hu(e){const t=pr({},e);return t.metadata={source:!0},t}function Q$(e,t){return dae({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}const Z$=e=>e===Qa||e===mr,j0=(e,t,n)=>jt(e)?Hse(e.signal,t,n):e===uc||e===mr?t:n,qt=(e,t,n)=>jt(e)?qse(e.signal,t,n):Z$(e)?t:n,yr=(e,t,n)=>jt(e)?Wse(e.signal,t,n):Z$(e)?n:t,eL=(e,t,n)=>jt(e)?Gse(e.signal,t,n):e===mr?{value:t}:{value:n},Use=(e,t,n)=>jt(e)?Vse(e.signal,t,n):e===lc?{value:t}:{value:n},qse=(e,t,n)=>tL(`${e} === '${mr}' || ${e} === '${Qa}'`,t,n),Wse=(e,t,n)=>tL(`${e} !== '${mr}' && ${e} !== '${Qa}'`,t,n),Hse=(e,t,n)=>OE(`${e} === '${uc}' || ${e} === '${mr}'`,t,n),Gse=(e,t,n)=>OE(`${e} === '${mr}'`,t,n),Vse=(e,t,n)=>OE(`${e} === '${lc}'`,t,n),tL=(e,t,n)=>(t=t!=null?Ut(t):t,n=n!=null?Ut(n):n,nL(t)&&nL(n)?(t=t?t.signal||H(t.value):null,n=n?n.signal||H(n.value):null,{signal:`${e} ? (${t}) : (${n})`}):[Ee({test:e},t)].concat(n||[])),nL=e=>e==null||Object.keys(e).length===1,OE=(e,t,n)=>({signal:`${e} ? (${fc(t)}) : (${fc(n)})`}),Yse=(e,t,n,i,r)=>({signal:(i!=null?`${e} === '${uc}' ? (${fc(i)}) : `:"")+(n!=null?`${e} === '${Qa}' ? (${fc(n)}) : `:"")+(r!=null?`${e} === '${lc}' ? (${fc(r)}) : `:"")+(t!=null?`${e} === '${mr}' ? (${fc(t)}) : `:"")+"(null)"}),fc=e=>jt(e)?e.signal:e==null?null:H(e),Xse=(e,t)=>t===0?0:jt(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t},dc=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function hc(e,t,n,i){let r;if(t&&re(t,e))return t[e];if(re(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=e[5].toLowerCase()+e.slice(6)}return i[gE][r]}else if(e.startsWith("label")){switch(e){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=e[5].toLowerCase()+e.slice(6)}return i[uh][r]}return null}function iL(e){const t={};for(const n of e)if(!!n)for(const i in n)t[i]=1;return Object.keys(t)}function Kse(e,t){var n=t.config,i=n.style,r=n.axis,o=t.scaleType(e.scale)==="band"&&n.axisBand,a=e.orient,s,u,l;if(jt(a)){const f=iL([n.axisX,n.axisY]),d=iL([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);s={};for(l of f)s[l]=qt(a,hc(l,n.axisX,r,i),hc(l,n.axisY,r,i));u={};for(l of d)u[l]=Yse(a.signal,hc(l,n.axisTop,r,i),hc(l,n.axisBottom,r,i),hc(l,n.axisLeft,r,i),hc(l,n.axisRight,r,i))}else s=a===mr||a===Qa?n.axisX:n.axisY,u=n["axis"+a[0].toUpperCase()+a.slice(1)];return s||u||o?Ee({},r,s,u,o):r}function Jse(e,t,n,i){const r=oi(e,t),o=e.orient;let a,s;const u={enter:a={opacity:Re},update:s={opacity:qi},exit:{opacity:Re}};nn(u,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=rL(e,0),c=rL(e,1);return a.x=s.x=qt(o,l,Re),a.x2=s.x2=qt(o,c),a.y=s.y=yr(o,l,Re),a.y2=s.y2=yr(o,c),Oi({type:vE,role:xoe,from:i,encode:u},n)}function rL(e,t){return{scale:e.scale,range:t}}function Qse(e,t,n,i,r){const o=oi(e,t),a=e.orient,s=e.gridScale,u=j0(a,1,-1),l=Zse(e.offset,u);let c,f,d;const h={enter:c={opacity:Re},update:d={opacity:qi},exit:f={opacity:Re}};nn(h,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const g={scale:e.scale,field:Ui,band:r.band,extra:r.extra,offset:r.offset,round:o("tickRound")},p=qt(a,{signal:"height"},{signal:"width"}),m=s?{scale:s,range:0,mult:u,offset:l}:{value:0,offset:l},y=s?{scale:s,range:1,mult:u,offset:l}:Ee(p,{mult:u,offset:l});return c.x=d.x=qt(a,g,m),c.y=d.y=yr(a,g,m),c.x2=d.x2=yr(a,y),c.y2=d.y2=qt(a,y),f.x=qt(a,g),f.y=yr(a,g),Oi({type:vE,role:woe,key:Ui,from:i,encode:h},n)}function Zse(e,t){if(t!==1)if(!Q(e))e=jt(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);else{let n=e=Ee({},e);for(;n.mult!=null;)if(Q(n.mult))n=n.mult=Ee({},n.mult);else return n.mult=jt(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n.mult=t}return e}function eue(e,t,n,i,r,o){const a=oi(e,t),s=e.orient,u=j0(s,-1,1);let l,c,f;const d={enter:l={opacity:Re},update:f={opacity:qi},exit:c={opacity:Re}};nn(d,{stroke:a("tickColor"),strokeCap:a("tickCap"),strokeDash:a("tickDash"),strokeDashOffset:a("tickDashOffset"),strokeOpacity:a("tickOpacity"),strokeWidth:a("tickWidth")});const h=Ut(r);h.mult=u;const g={scale:e.scale,field:Ui,band:o.band,extra:o.extra,offset:o.offset,round:a("tickRound")};return f.y=l.y=qt(s,Re,g),f.y2=l.y2=qt(s,h),c.x=qt(s,g),f.x=l.x=yr(s,Re,g),f.x2=l.x2=yr(s,h),c.y=yr(s,g),Oi({type:vE,role:Eoe,key:Ui,from:i,encode:d},n)}function SE(e,t,n,i,r){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+r+")"}}function tue(e,t,n,i,r,o){const a=oi(e,t),s=e.orient,u=e.scale,l=j0(s,-1,1),c=lu(a("labelFlush")),f=lu(a("labelFlushOffset")),d=a("labelAlign"),h=a("labelBaseline");let g=c===0||!!c,p;const m=Ut(r);m.mult=l,m.offset=Ut(a("labelPadding")||0),m.offset.mult=l;const y={scale:u,field:Ui,band:.5,offset:P$(o.offset,a("labelOffset"))},v=qt(s,g?SE(u,c,'"left"','"right"','"center"'):{value:"center"},Use(s,"left","right")),x=qt(s,eL(s,"bottom","top"),g?SE(u,c,'"top"','"bottom"','"middle"'):{value:"middle"}),b=SE(u,c,`-(${f})`,f,0);g=g&&f;const _={opacity:Re,x:qt(s,y,m),y:yr(s,y,m)},E={enter:_,update:p={opacity:qi,text:{field:hE},x:_.x,y:_.y,align:v,baseline:x},exit:{opacity:Re,x:_.x,y:_.y}};nn(E,{dx:!d&&g?qt(s,b):null,dy:!h&&g?yr(s,b):null}),nn(E,{angle:a("labelAngle"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontWeight:a("labelFontWeight"),fontStyle:a("labelFontStyle"),limit:a("labelLimit"),lineHeight:a("labelLineHeight")},{align:d,baseline:h});const w=a("labelBound");let O=a("labelOverlap");return O=O||w?{separation:a("labelSeparation"),method:O,order:"datum.index",bound:w?{scale:u,orient:s,tolerance:w}:null}:void 0,p.align!==v&&(p.align=dc(p.align,v)),p.baseline!==x&&(p.baseline=dc(p.baseline,x)),Oi({type:fu,role:_oe,style:uh,key:Ui,from:i,encode:E,overlap:O},n)}function nue(e,t,n,i){const r=oi(e,t),o=e.orient,a=j0(o,-1,1);let s,u;const l={enter:s={opacity:Re,anchor:Ut(r("titleAnchor",null)),align:{signal:bE}},update:u=Ee({},s,{opacity:qi,text:Ut(e.title)}),exit:{opacity:Re}},c={signal:`lerp(range("${e.scale}"), ${M0(0,1,.5)})`};return u.x=qt(o,c),u.y=yr(o,c),s.angle=qt(o,Re,Xse(a,90)),s.baseline=qt(o,eL(o,Qa,mr),{value:Qa}),u.angle=s.angle,u.baseline=s.baseline,nn(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),iue(r,o,l,n),l.update.align=dc(l.update.align,s.align),l.update.angle=dc(l.update.angle,s.angle),l.update.baseline=dc(l.update.baseline,s.baseline),Oi({type:fu,role:Ooe,style:gE,from:i,encode:l},n)}function iue(e,t,n,i){const r=(s,u)=>s!=null?(n.update[u]=dc(Ut(s),n.update[u]),!1):!sc(u,i),o=r(e("titleX"),"x"),a=r(e("titleY"),"y");n.enter.auto=a===o?Ut(a):qt(t,Ut(a),Ut(o))}function rue(e,t){const n=Kse(e,t),i=e.encode||{},r=i.axis||{},o=r.name||void 0,a=r.interactive,s=r.style,u=oi(e,n),l=ese(u),c={scale:e.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:e.title!=null},f=ue(t.add(pr({},[c]))),d=ue(t.add(oae({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),h=[];let g;return c.grid&&h.push(Qse(e,n,i.grid,d,l)),c.ticks&&(g=u("tickSize"),h.push(eue(e,n,i.ticks,d,g,l))),c.labels&&(g=c.ticks?g:0,h.push(tue(e,n,i.labels,d,g,l))),c.domain&&h.push(Jse(e,n,i.domain,f)),c.title&&h.push(nue(e,n,i.title,f)),R0(ch({role:boe,from:f,encode:ac(oue(u,e),r,lh),marks:h,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:a,style:s}),t)}function oue(e,t){const n={enter:{},update:{}};return nn(n,{orient:e("orient"),offset:e("offset")||0,position:gr(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function oL(e,t,n){const i=J(e.signals),r=J(e.scales);return n||i.forEach(o=>w$(o,t)),J(e.projections).forEach(o=>Lae(o,t)),r.forEach(o=>Sae(o,t)),J(e.data).forEach(o=>zse(o,t)),r.forEach(o=>Aae(o,t)),(n||i).forEach(o=>rae(o,t)),J(e.axes).forEach(o=>rue(o,t)),J(e.marks).forEach(o=>R0(o,t)),J(e.legends).forEach(o=>Cse(o,t)),e.title&&jse(e.title,t),t.parseLambdas(),t}const aue=e=>ac({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e);function sue(e,t){const n=t.config,i=ue(t.root=t.add(O0())),r=uue(e,n);r.forEach(l=>w$(l,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const o=t.add(pr()),a=t.add(k$(b$(aue(e.encode),F0,iE,e.style,t,{pulse:ue(o)}))),s=t.add(F$({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:ue(a)}));t.operators.pop(),t.pushState(ue(a),ue(s),null),oL(e,t,r),t.operators.push(s);let u=t.add(S$({mark:i,pulse:ue(s)}));return u=t.add(T$({pulse:ue(u)})),u=t.add(cu({pulse:ue(u)})),t.addData("root",new du(t,o,o,u)),t}function dh(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function uue(e,t){const n=a=>gr(e[a],t[a]),i=[dh("background",n("background")),dh("autosize",moe(n("autosize"))),dh("padding",voe(n("padding"))),dh("width",n("width")||0),dh("height",n("height")||0)],r=i.reduce((a,s)=>(a[s.name]=s,a),{}),o={};return J(e.signals).forEach(a=>{re(r,a.name)?a=Ee(r[a.name],a):i.push(a),o[a.name]=a}),J(t.signals).forEach(a=>{!re(o,a.name)&&!re(r,a.name)&&i.push(a)}),i}function aL(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function sL(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}aL.prototype=sL.prototype={parse(e){return oL(e,this)},fork(){return new sL(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id}),e.refs=null),e},proxy(e){const t=e instanceof aE?ue(e):e;return this.add(bae({value:t}))},addStream(e){return this.streams.push(e),e.id=this.id(),e},addUpdate(e){return this.updates.push(e),e},finish(){let e,t;this.root&&(this.root.root=!0);for(e in this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(i,r,o){let a,s;i&&(a=i.data||(i.data={}),s=a[r]||(a[r]=[]),s.push(o))}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i)}return this},pushState(e,t,n){this._encode.push(ue(this.add(cu({pulse:e})))),this._parent.push(t),this._lookup.push(n?ue(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return Fe(this._parent)},encode(){return Fe(this._encode)},lookup(){return Fe(this._lookup)},markpath(){const e=this._markpath;return++e[e.length-1]},fieldRef(e,t){if(K(e))return ah(e,t);e.signal||L("Unsupported field reference: "+H(e));const n=e.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};t&&(r.as=t),this.field[n]=i=ue(this.add(lae(r)))}return i},compareRef(e){let t=!1;const n=o=>jt(o)?(t=!0,this.signalRef(o.signal)):Yoe(o)?(t=!0,this.exprRef(o.expr)):o,i=J(e.field).map(n),r=J(e.order).map(n);return t?ue(this.add(A$({fields:i,orders:r}))):_$(i,r)},keyRef(e,t){let n=!1;const i=o=>jt(o)?(n=!0,ue(r[o.signal])):o,r=this.signals;return e=J(e).map(i),n?ue(this.add(cae({fields:e,flat:t}))):Woe(e,t)},sortRef(e){if(!e)return e;const t=S0(e.op,e.field),n=e.order||Hoe;return n.signal?ue(this.add(A$({fields:t,orders:this.signalRef(n.signal)}))):_$(t,n)},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i}return this.events[n]},hasOwnSignal(e){return re(this.signals,e)},addSignal(e,t){this.hasOwnSignal(e)&&L("Duplicate signal name: "+H(e));const n=t instanceof aE?t:this.add(O0(t));return this.signals[e]=n},getSignal(e){return this.signals[e]||L("Unrecognized signal name: "+H(e)),this.signals[e]},signalRef(e){return this.signals[e]?ue(this.signals[e]):(re(this.lambdas,e)||(this.lambdas[e]=this.add(O0(null))),ue(this.lambdas[e]))},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const i=e[t],r=to(i,this),o=this.lambdas[i];o.params=r.$params,o.update=r.$expr}},property(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty(e){return!e||!Q(e)?e:this.signalRef(e.signal||AE(e))},exprRef(e,t){const n={expr:to(e,this)};return t&&(n.expr.$name=t),ue(this.add(sae(n)))},addBinding(e,t){this.bindings||L("Nested signals do not support binding: "+H(e)),this.bindings.push(Ee({signal:e},t))},addScaleProj(e,t){re(this.scales,e)&&L("Duplicate scale or projection name: "+H(e)),this.scales[e]=this.add(t)},addScale(e,t){this.addScaleProj(e,wae(t))},addProjection(e,t){this.addScaleProj(e,vae(t))},getScale(e){return this.scales[e]||L("Unrecognized scale name: "+H(e)),this.scales[e]},scaleRef(e){return ue(this.getScale(e))},scaleType(e){return this.getScale(e).params.type},projectionRef(e){return this.scaleRef(e)},projectionType(e){return this.scaleType(e)},addData(e,t){return re(this.data,e)&&L("Duplicate data set name: "+H(e)),this.data[e]=t},getData(e){return this.data[e]||L("Undefined data set name: "+H(e)),this.data[e]},addDataPipeline(e,t){return re(this.data,e)&&L("Duplicate data set name: "+H(e)),this.addData(e,du.fromEntries(this,t))}};function AE(e){return(P(e)?lue:cue)(e)}function lue(e){const t=e.length;let n="[";for(let i=0;i<t;++i){const r=e[i];n+=(i>0?",":"")+(Q(r)?r.signal||AE(r):H(r))}return n+"]"}function cue(e){let t="{",n=0,i,r;for(i in e)r=e[i],t+=(++n>1?",":"")+H(i)+":"+(Q(r)?r.signal||AE(r):H(r));return t+"}"}function fue(){const e="sans-serif",t=30,n=2,i="#4c78a8",r="#000",o="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:e,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:e,fontSize:10},"guide-title":{fill:r,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:e,fontSize:12},point:{size:t,strokeWidth:n,shape:"circle"},circle:{size:t,strokeWidth:n},square:{size:t,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:o,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:o,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function due(e,t,n){return Q(e)||L("Input Vega specification must be an object."),t=dl(fue(),t,e.config),sue(e,new aL(t,n)).toRuntime()}var hue="vega",gue="5.21.0",pue="The Vega visualization grammar.",mue=["vega","visualization","interaction","dataflow","library","data","d3"],yue="BSD-3-Clause",vue="UW Interactive Data Lab (http://idl.cs.washington.edu)",bue="build/vega-node.js",xue="build/vega.module.js",wue="build/vega.min.js",_ue="build/vega.min.js",Eue="index.d.ts",Oue="vega/vega",Sue={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Aue={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.1","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.1.0","vega-loader":"~4.4.1","vega-parser":"~6.1.4","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.10","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.22.0","vega-util":"~1.17.0","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},kue={"vega-schema":"*"},Cue="774165e29850b66ec8b79ba52a7955f1ab936ea6",Tue={name:hue,version:gue,description:pue,keywords:mue,license:yue,author:vue,main:bue,module:xue,unpkg:wue,jsdelivr:_ue,types:Eue,repository:Oue,scripts:Sue,dependencies:Aue,devDependencies:kue,gitHead:Cue};Ee(Sl,TW,UX,xK,oQ,ZQ,Mee,nee,Nee,Kee,ate,hte);const Fue=Tue.version;var Mue=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Fue,Dataflow:Ol,EventStream:Gg,MultiPulse:Gv,Operator:it,Parameters:Hg,Pulse:Sa,Transform:R,changeset:Ls,definition:GT,ingest:Ue,isTuple:Ug,transform:VT,transforms:Sl,tupleid:ae,interpolate:Fx,interpolateColors:Sp,interpolateRange:xD,quantizeInterpolator:wD,scale:Ie,scheme:Mx,projection:Ow,View:r$,defaultLocale:Pv,formatLocale:$g,locale:ST,resetDefaultLocale:TU,timeFormatLocale:Lf,expressionFunction:St,parse:due,runtimeContext:Ij,codegenExpression:mj,parseExpression:R_,parseSelector:Ja,Debug:Pk,Error:Uy,Info:Ik,None:Lk,Warn:qy,accessor:Vn,accessorFields:fn,accessorName:yt,array:J,ascending:kg,clampRange:Jk,compare:Yy,constant:gn,debounce:Xy,error:L,extend:Ee,extent:$r,extentIndex:Qk,falsy:ha,fastmap:gl,field:Yn,flush:Zk,hasOwnProperty:re,id:pf,identity:dn,inherits:W,inrange:pl,isArray:P,isBoolean:ga,isDate:pa,isFunction:_e,isIterable:eC,isNumber:Je,isObject:Q,isRegExp:tC,isString:K,key:Ky,lerp:nC,logger:Wy,lruCache:iC,merge:rC,mergeConfig:dl,one:fl,pad:oC,panLinear:Hk,panLog:Gk,panPow:Vk,panSymlog:Yk,peek:Fe,quarter:Xk,repeat:mf,span:yf,splitAccessPath:jr,stringValue:H,toBoolean:Jy,toDate:Qy,toNumber:hn,toSet:nr,toString:Zy,truncate:aC,truthy:Ni,utcquarter:Kk,visitArray:ma,writeConfig:hl,zero:da,zoomLinear:Hy,zoomLog:Gy,zoomPow:Ag,zoomSymlog:Vy,bandwidthNRD:Kv,bin:XT,bootstrapCI:KT,cumulativeLogNormal:nb,cumulativeNormal:Kg,cumulativeUniform:ab,densityLogNormal:tb,densityNormal:Jv,densityUniform:ob,dotbin:JT,quantileLogNormal:ib,quantileNormal:Jg,quantileUniform:sb,quantiles:Yv,quartiles:Xv,get random(){return $i},randomInteger:Nq,randomKDE:Zv,randomLCG:Dq,randomLogNormal:ZT,randomMixture:eF,randomNormal:Qv,randomUniform:tF,regressionExp:iF,regressionLinear:ub,regressionLoess:uF,regressionLog:nF,regressionPoly:oF,regressionPow:rF,regressionQuad:lb,sampleCurve:Zg,sampleLogNormal:eb,sampleNormal:Xg,sampleUniform:rb,setRandom:Fq,DATE:Jn,DAY:mn,DAYOFYEAR:Lr,HOURS:vi,MILLISECONDS:ir,MINUTES:bi,MONTH:pn,QUARTER:Kn,SECONDS:ji,TIME_UNITS:Ev,WEEK:Mt,YEAR:Jt,dayofyear:jC,timeBin:eT,timeFloor:UC,timeInterval:xl,timeOffset:HC,timeSequence:YC,timeUnitSpecifier:RC,timeUnits:Sv,utcFloor:qC,utcInterval:wl,utcOffset:GC,utcSequence:XC,utcdayofyear:IC,utcweek:PC,week:$C,format:Ig,formats:qv,inferType:CT,inferTypes:TT,loader:Pg,read:NT,responseType:DT,typeParsers:zv,Bounds:Nt,CanvasHandler:yd,CanvasRenderer:Qp,Gradient:LD,GroupItem:Mp,Handler:za,Item:Fp,Marks:xi,RenderType:Ua,Renderer:Xr,ResourceLoader:Ux,SVGHandler:y2,SVGRenderer:O2,SVGStringRenderer:k2,Scenegraph:d2,boundClip:tN,boundContext:ud,boundItem:f2,boundMark:m3,boundStroke:jo,domChild:Zn,domClear:sr,domCreate:Pa,domFind:h2,font:qp,fontFamily:hd,fontSize:Yr,intersect:J3,intersectBoxLine:Bl,intersectPath:Xx,intersectPoint:Kx,intersectRule:t3,lineHeight:La,markup:E2,multiLineOffset:u2,pathCurves:$x,pathEqual:nN,pathParse:Il,pathRectangle:WD,pathRender:id,pathSymbols:qD,pathTrail:HD,point:Hp,renderModule:em,resetSVGClipId:VD,resetSVGDefIds:rX,sceneEqual:T2,sceneFromJSON:v3,scenePickVisit:Ip,sceneToJSON:y3,sceneVisit:ar,sceneZOrder:Jx,serializeXML:z3,textMetrics:Vr});function Due(e,t,n){let i;t.x2&&(t.x?(n&&e.x>e.x2&&(i=e.x,e.x=e.x2,e.x2=i),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(i=e.y,e.y=e.y2,e.y2=i),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2)}var Nue={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},Rue={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},jue={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const $ue=Array.prototype.slice,gu=(e,t,n)=>{const i=n?n(t[0]):t[0];return i[e].apply(i,$ue.call(t,1))},Lue=(e,t,n,i,r,o,a)=>new Date(e,t||0,n!=null?n:1,i||0,r||0,o||0,a||0);var Iue={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:Lue,date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return gu("join",arguments)},indexof:function(){return gu("indexOf",arguments)},lastindexof:function(){return gu("lastIndexOf",arguments)},slice:function(){return gu("slice",arguments)},reverse:e=>e.slice().reverse(),parseFloat,parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return gu("substring",arguments,String)},split:function(){return gu("split",arguments,String)},replace:function(){return gu("replace",arguments,String)},trim:e=>String(e).trim(),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const Pue=["view","item","group","xy","x","y"],zue={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const n=t.name;return e.memberDepth>0?n:n==="datum"?e.datum:n==="event"?e.event:n==="item"?e.item:Nue[n]||e.params["$"+n]},MemberExpression:(e,t)=>{const n=!t.computed,i=e(t.object);n&&(e.memberDepth+=1);const r=e(t.property);return n&&(e.memberDepth-=1),i[r]},CallExpression:(e,t)=>{const n=t.arguments;let i=t.callee.name;return i.startsWith("_")&&(i=i.slice(1)),i==="if"?e(n[0])?e(n[1]):e(n[2]):(e.fn[i]||Iue[i]).apply(e.fn,n.map(e))},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>Rue[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>jue[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>t.operator==="&&"?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((n,i)=>{e.memberDepth+=1;const r=e(i.key);return e.memberDepth-=1,n[r]=e(i.value),n},{})};function hh(e,t,n,i,r,o){const a=s=>zue[s.type](a,s);return a.memberDepth=0,a.fn=Object.create(t),a.params=n,a.datum=i,a.event=r,a.item=o,Pue.forEach(s=>a.fn[s]=(...u)=>r.vega[s](...u)),a(e)}var Bue={operator(e,t){const n=t.ast,i=e.functions;return r=>hh(n,i,r)},parameter(e,t){const n=t.ast,i=e.functions;return(r,o)=>hh(n,i,o,r)},event(e,t){const n=t.ast,i=e.functions;return r=>hh(n,i,void 0,void 0,r)},handler(e,t){const n=t.ast,i=e.functions;return(r,o)=>{const a=o.item&&o.item.datum;return hh(n,i,r,a,o)}},encode(e,t){const{marktype:n,channels:i}=t,r=e.functions,o=n==="group"||n==="image"||n==="rect";return(a,s)=>{const u=a.datum;let l=0,c;for(const f in i)c=hh(i[f].ast,r,s,u,void 0,a),a[f]!==c&&(a[f]=c,l=1);return n!=="rule"&&Due(a,i,o),l}}};const Uue="vega-lite",que='Dominik Moritz, Kanit "Ham" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer',Wue="5.2.0",Hue=["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],Gue="https://vega.github.io/vega-lite/",Vue="Vega-Lite is a concise high-level language for interactive visualization.",Yue="build/vega-lite.js",Xue="build/vega-lite.min.js",Kue="build/vega-lite.min.js",Jue="build/src/index",Que="build/src/index.d.ts",Zue={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2pdf:"./bin/vl2pdf",vl2vg:"./bin/vl2vg"},ele={test:"test"},tle=["bin","build","src","vega-lite*","tsconfig.json"],nle={changelog:"conventional-changelog -p angular -r 2",prebuild:"yarn clean:build",build:"yarn build:only","build:only":"tsc -p tsconfig.build.json && rollup -c","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh",clean:"yarn clean:build && del-cli 'site/data/*' 'examples/compiled/*.png' && find site/examples ! -name 'index.md' ! -name 'data' -type f -delete","clean:build":"del-cli 'build/*' !build/vega-lite-schema.json","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site",data:"rsync -r node_modules/vega-datasets/data/* site/data",schema:"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/",renameschema:"scripts/rename-schema.sh",presite:"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh",site:"yarn site:only","site:only":"pushd site && bundle exec jekyll serve -I -l && popd",prettierbase:"prettier '**/*.{md,css,yml}'",eslintbase:"eslint .",format:"yarn eslintbase --fix && yarn prettierbase --write",lint:"yarn eslintbase && yarn prettierbase --check",jest:"NODE_OPTIONS=--experimental-vm-modules npx jest",test:"yarn jest test/ && yarn lint && yarn schema && yarn jest examples/ && yarn test:runtime","test:cover":"yarn jest --collectCoverage test/","test:inspect":"node --inspect-brk --experimental-vm-modules ./node_modules/.bin/jest --runInBand test","test:runtime":"NODE_OPTIONS=--experimental-vm-modules TZ=America/Los_Angeles npx jest test-runtime/ --config test-runtime/jest-config.json","test:runtime:generate":"yarn build:only && del-cli test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime",watch:"tsc -p tsconfig.build.json -w","watch:site":"yarn build:site -w","watch:test":"yarn jest --watch test/"},ile={type:"git",url:"https://github.com/vega/vega-lite.git"},rle="BSD-3-Clause",ole={url:"https://github.com/vega/vega-lite/issues"},ale={"@babel/core":"^7.16.0","@babel/preset-env":"^7.16.0","@babel/preset-typescript":"^7.16.0","@rollup/plugin-alias":"^3.1.8","@rollup/plugin-babel":"^5.3.0","@rollup/plugin-commonjs":"^21.0.1","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^13.0.6","@types/chai":"^4.2.22","@types/d3":"^7.1.0","@types/jest":"^27.0.2","@types/mkdirp":"^1.0.2","@types/pako":"^1.0.2","@typescript-eslint/eslint-plugin":"^5.4.0","@typescript-eslint/parser":"^5.4.0",ajv:"^8.8.0","ajv-formats":"^2.1.1",chai:"^4.3.4",cheerio:"^1.0.0-rc.10","conventional-changelog-cli":"^2.1.1",d3:"^7.1.1","del-cli":"^4.0.1",eslint:"^8.2.0","eslint-config-prettier":"^8.3.0","eslint-plugin-jest":"^25.2.4","eslint-plugin-prettier":"^4.0.0","gh-pages":"^3.2.3","highlight.js":"^11.3.1",jest:"^27.3.1","jest-dev-server":"^6.0.0",mkdirp:"^1.0.4",pako:"^2.0.4",prettier:"^2.4.1",puppeteer:"^11.0.0",rollup:"^2.60.0","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-sourcemaps":"^0.6.3","rollup-plugin-terser":"^7.0.2",serve:"^13.0.2",terser:"^5.10.0","ts-jest":"^27.0.7","ts-json-schema-generator":"^0.97.0",typescript:"~4.5.2","vega-cli":"^5.21.0","vega-datasets":"~2.2.0","vega-embed":"^6.20.2","vega-tooltip":"^0.27.0","yaml-front-matter":"^4.1.1"},sle={"@types/clone":"~2.1.1","array-flat-polyfill":"^1.0.1",clone:"~2.1.2","fast-deep-equal":"~3.1.3","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~3.0.0",tslib:"~2.3.1","vega-event-selector":"~3.0.0","vega-expression":"~5.0.0","vega-util":"~1.17.0",yargs:"~17.2.1"},ule={vega:"^5.21.0"},lle={node:">=12"};var cle={name:Uue,author:que,version:Wue,collaborators:Hue,homepage:Gue,description:Vue,main:Yue,unpkg:Xue,jsdelivr:Kue,module:Jue,types:Que,bin:Zue,directories:ele,files:tle,scripts:nle,repository:ile,license:rle,bugs:ole,devDependencies:ale,dependencies:sle,peerDependencies:ule,engines:lle};Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,i){return Array.isArray(i)?n.push.apply(n,e.call(i,t-1)):n.push(i),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var uL={exports:{}};(function(e){var t=function(){function n(d,h){return h!=null&&d instanceof h}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var o;try{o=Promise}catch{o=function(){}}function a(d,h,g,p,m){typeof h=="object"&&(g=h.depth,p=h.prototype,m=h.includeNonEnumerable,h=h.circular);var y=[],v=[],x=typeof Buffer!="undefined";typeof h=="undefined"&&(h=!0),typeof g=="undefined"&&(g=1/0);function b(_,E){if(_===null)return null;if(E===0)return _;var w,O;if(typeof _!="object")return _;if(n(_,i))w=new i;else if(n(_,r))w=new r;else if(n(_,o))w=new o(function(I,z){_.then(function(X){I(b(X,E-1))},function(X){z(b(X,E-1))})});else if(a.__isArray(_))w=[];else if(a.__isRegExp(_))w=new RegExp(_.source,f(_)),_.lastIndex&&(w.lastIndex=_.lastIndex);else if(a.__isDate(_))w=new Date(_.getTime());else{if(x&&Buffer.isBuffer(_))return Buffer.allocUnsafe?w=Buffer.allocUnsafe(_.length):w=new Buffer(_.length),_.copy(w),w;n(_,Error)?w=Object.create(_):typeof p=="undefined"?(O=Object.getPrototypeOf(_),w=Object.create(O)):(w=Object.create(p),O=p)}if(h){var S=y.indexOf(_);if(S!=-1)return v[S];y.push(_),v.push(w)}n(_,i)&&_.forEach(function(I,z){var X=b(z,E-1),te=b(I,E-1);w.set(X,te)}),n(_,r)&&_.forEach(function(I){var z=b(I,E-1);w.add(z)});for(var k in _){var A;O&&(A=Object.getOwnPropertyDescriptor(O,k)),!(A&&A.set==null)&&(w[k]=b(_[k],E-1))}if(Object.getOwnPropertySymbols)for(var M=Object.getOwnPropertySymbols(_),k=0;k<M.length;k++){var C=M[k],D=Object.getOwnPropertyDescriptor(_,C);D&&!D.enumerable&&!m||(w[C]=b(_[C],E-1),D.enumerable||Object.defineProperty(w,C,{enumerable:!1}))}if(m)for(var F=Object.getOwnPropertyNames(_),k=0;k<F.length;k++){var N=F[k],D=Object.getOwnPropertyDescriptor(_,N);D&&D.enumerable||(w[N]=b(_[N],E-1),Object.defineProperty(w,N,{enumerable:!1}))}return w}return b(d,g)}a.clonePrototype=function(h){if(h===null)return null;var g=function(){};return g.prototype=h,new g};function s(d){return Object.prototype.toString.call(d)}a.__objToStr=s;function u(d){return typeof d=="object"&&s(d)==="[object Date]"}a.__isDate=u;function l(d){return typeof d=="object"&&s(d)==="[object Array]"}a.__isArray=l;function c(d){return typeof d=="object"&&s(d)==="[object RegExp]"}a.__isRegExp=c;function f(d){var h="";return d.global&&(h+="g"),d.ignoreCase&&(h+="i"),d.multiline&&(h+="m"),h}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(uL);var fle=uL.exports,dle=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var i,r,o;if(Array.isArray(t)){if(i=t.length,i!=n.length)return!1;for(r=i;r--!=0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),i=o.length,i!==Object.keys(n).length)return!1;for(r=i;r--!=0;)if(!Object.prototype.hasOwnProperty.call(n,o[r]))return!1;for(r=i;r--!=0;){var a=o[r];if(!e(t[a],n[a]))return!1}return!0}return t!==t&&n!==n},kE=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.cmp&&function(o){return function(a){return function(s,u){var l={key:s,value:a[s]},c={key:u,value:a[u]};return o(l,c)}}}(t.cmp),r=[];return function o(a){if(a&&a.toJSON&&typeof a.toJSON=="function"&&(a=a.toJSON()),a!==void 0){if(typeof a=="number")return isFinite(a)?""+a:"null";if(typeof a!="object")return JSON.stringify(a);var s,u;if(Array.isArray(a)){for(u="[",s=0;s<a.length;s++)s&&(u+=","),u+=o(a[s])||"null";return u+"]"}if(a===null)return"null";if(r.indexOf(a)!==-1){if(n)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var l=r.push(a)-1,c=Object.keys(a).sort(i&&i(a));for(u="",s=0;s<c.length;s++){var f=c[s],d=o(a[f]);!d||(u&&(u+=","),u+=JSON.stringify(f)+":"+d)}return r.splice(l,1),"{"+u+"}"}}(e)};function CE(e){return!!e.or}function TE(e){return!!e.and}function FE(e){return!!e.not}function $0(e,t){if(FE(e))$0(e.not,t);else if(TE(e))for(const n of e.and)$0(n,t);else if(CE(e))for(const n of e.or)$0(n,t);else t(e)}function gc(e,t){return FE(e)?{not:gc(e.not,t)}:TE(e)?{and:e.and.map(n=>gc(n,t))}:CE(e)?{or:e.or.map(n=>gc(n,t))}:t(e)}const no=dle,be=fle;function lL(e){throw new Error(e)}function pc(e,t){const n={};for(const i of t)re(e,i)&&(n[i]=e[i]);return n}function Si(e,t){const n=Object.assign({},e);for(const i of t)delete n[i];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>kE(e)).join(",")})`};const rt=kE;function Me(e){if(Je(e))return e;const t=K(e)?e:kE(e);if(t.length<250)return t;let n=0;for(let i=0;i<t.length;i++){const r=t.charCodeAt(i);n=(n<<5)-n+r,n=n&n}return n}function ME(e){return e===!1||e===null}function De(e,t){return e.includes(t)}function pu(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1}function DE(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0}function cL(e,...t){for(const n of t)hle(e,n!=null?n:{});return e}function hle(e,t){for(const n of U(t))hl(e,n,t[n],!0)}function io(e,t){const n=[],i={};let r;for(const o of e)r=t(o),!(r in i)&&(i[r]=1,n.push(o));return n}function gle(e,t){const n=U(e),i=U(t);if(n.length!==i.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0}function fL(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function NE(e,t){for(const n of e)if(t.has(n))return!0;return!1}function RE(e){const t=new Set;for(const n of e){const r=jr(n).map((a,s)=>s===0?a:`[${a}]`),o=r.map((a,s)=>r.slice(0,s+1).join(""));for(const a of o)t.add(a)}return t}function jE(e,t){return e===void 0||t===void 0?!0:NE(RE(e),RE(t))}function Ze(e){return U(e).length===0}const U=Object.keys,En=Object.values,Za=Object.entries;function gh(e){return e===!0||e===!1}function ht(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function ph(e,t){return FE(e)?`!(${ph(e.not,t)})`:TE(e)?`(${e.and.map(n=>ph(n,t)).join(") && (")})`:CE(e)?`(${e.or.map(n=>ph(n,t)).join(") || (")})`:t(e)}function L0(e,t){if(t.length===0)return!0;const n=t.shift();return n in e&&L0(e[n],t)&&delete e[n],Ze(e)}function mh(e){return e.charAt(0).toUpperCase()+e.substr(1)}function $E(e,t="datum"){const n=jr(e),i=[];for(let r=1;r<=n.length;r++){const o=`[${n.slice(0,r).map(H).join("][")}]`;i.push(`${t}${o}`)}return i.join(" && ")}function dL(e,t="datum"){return`${t}[${H(jr(e).join("."))}]`}function ple(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function Wi(e){return`${jr(e).map(ple).join("\\.")}`}function mu(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function LE(e){return`${jr(e).join(".")}`}function mc(e){return e?jr(e).length:0}function At(...e){for(const t of e)if(t!==void 0)return t}let hL=42;function gL(e){const t=++hL;return e?String(e)+t:t}function mle(){hL=42}function pL(e){return mL(e)?e:`__${e}`}function mL(e){return e.startsWith("__")}function yh(e){if(e!==void 0)return(e%360+360)%360}function I0(e){return Je(e)?!0:!isNaN(e)&&!isNaN(parseFloat(e))}var vh=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Ho="row",Go="column",P0="facet",pt="x",Wt="y",vr="x2",ro="y2",es="xOffset",yc="yOffset",oo="radius",Vo="radius2",br="theta",Yo="theta2",ao="latitude",so="longitude",xr="latitude2",Hi="longitude2",ai="color",uo="fill",lo="stroke",si="shape",Xo="size",yu="angle",Ko="opacity",ts="fillOpacity",ns="strokeOpacity",is="strokeWidth",rs="strokeDash",bh="text",xh="order",wh="detail",z0="key",vu="tooltip",B0="href",U0="url",q0="description",yle={x:1,y:1,x2:1,y2:1},yL={theta:1,theta2:1,radius:1,radius2:1};function vL(e){return e in yL}const IE={longitude:1,longitude2:1,latitude:1,latitude2:1};function vle(e){switch(e){case ao:return"y";case xr:return"y2";case so:return"x";case Hi:return"x2"}}function ble(e){return e in IE}const xle=U(IE),PE=Object.assign(Object.assign(Object.assign(Object.assign({},yle),yL),IE),{xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function vc(e){return e===ai||e===uo||e===lo}const bL={row:1,column:1,facet:1},Gi=U(bL),zE=Object.assign(Object.assign({},PE),bL),wle=U(zE),_le=vh(zE,["order","detail","tooltip"]),Ele=vh(_le,["row","column","facet"]);function Ole(e){return!!Ele[e]}function xL(e){return!!zE[e]}const Sle=[vr,ro,xr,Hi,Yo,Vo];function wL(e){return bu(e)!==e}function bu(e){switch(e){case vr:return pt;case ro:return Wt;case xr:return ao;case Hi:return so;case Yo:return br;case Vo:return oo}return e}function os(e){if(vL(e))switch(e){case br:return"startAngle";case Yo:return"endAngle";case oo:return"outerRadius";case Vo:return"innerRadius"}return e}function Jo(e){switch(e){case pt:return vr;case Wt:return ro;case ao:return xr;case so:return Hi;case br:return Yo;case oo:return Vo}}function ui(e){switch(e){case pt:case vr:return"width";case Wt:case ro:return"height"}}function Ale(e){switch(e){case pt:return"xOffset";case Wt:return"yOffset";case vr:return"x2Offset";case ro:return"y2Offset";case br:return"thetaOffset";case oo:return"radiusOffset";case Yo:return"theta2Offset";case Vo:return"radius2Offset"}}function _L(e){switch(e){case pt:return"xOffset";case Wt:return"yOffset"}}function EL(e){switch(e){case"xOffset":return"x";case"yOffset":return"y"}}const kle=U(PE),BE=vh(PE,["x","y","x2","y2","xOffset","yOffset","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Cle=U(BE),UE={x:1,y:1},co=U(UE);function rn(e){return e in UE}const qE={theta:1,radius:1},Tle=U(qE);function W0(e){return e==="width"?pt:Wt}const OL={xOffset:1,yOffset:1};function bc(e){return e in OL}const SL=vh(BE,["text","tooltip","href","url","description","detail","key","order"]),Fle=U(SL);function Mle(e){return!!BE[e]}function Dle(e){switch(e){case ai:case uo:case lo:case Xo:case si:case Ko:case is:case rs:return!0;case ts:case ns:case yu:return!1}}const AL=Object.assign(Object.assign(Object.assign(Object.assign({},UE),qE),OL),SL),H0=U(AL);function as(e){return!!AL[e]}function Nle(e,t){return jle(e)[t]}const kL={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Rle=vh(kL,["geoshape"]);function jle(e){switch(e){case ai:case uo:case lo:case q0:case wh:case z0:case vu:case B0:case xh:case Ko:case ts:case ns:case is:case P0:case Ho:case Go:return kL;case pt:case Wt:case es:case yc:case ao:case so:return Rle;case vr:case ro:case xr:case Hi:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Xo:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case rs:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case si:return{point:"always",geoshape:"always"};case bh:return{text:"always"};case yu:return{point:"always",square:"always",text:"always"};case U0:return{image:"always"};case br:return{text:"always",arc:"always"};case oo:return{text:"always",arc:"always"};case Yo:case Vo:return{arc:"always"}}}function WE(e){switch(e){case pt:case Wt:case br:case oo:case es:case yc:case Xo:case yu:case is:case Ko:case ts:case ns:case vr:case ro:case Yo:case Vo:return;case P0:case Ho:case Go:case si:case rs:case bh:case vu:case B0:case U0:case q0:return"discrete";case ai:case uo:case lo:return"flexible";case ao:case so:case xr:case Hi:case wh:case z0:case xh:return}}const $le={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Lle={count:1,min:1,max:1};function Qo(e){return!!e&&!!e.argmin}function ss(e){return!!e&&!!e.argmax}function HE(e){return K(e)&&!!$le[e]}const Ile=new Set(["count","valid","missing","distinct"]);function CL(e){return K(e)&&Ile.has(e)}function Ple(e){return K(e)&&De(["min","max"],e)}const zle=new Set(["count","sum","distinct","valid","missing"]),Ble=new Set(["mean","average","median","q1","q3","min","max"]);function TL(e){return ga(e)&&(e=c1(e,void 0)),"bin"+U(e).map(t=>G0(e[t])?ht(`_${t}_${Za(e[t])}`):ht(`_${t}_${e[t]}`)).join("")}function ot(e){return e===!0||xu(e)&&!e.binned}function zn(e){return e==="binned"||xu(e)&&e.binned===!0}function xu(e){return Q(e)}function G0(e){return e==null?void 0:e.param}function FL(e){switch(e){case Ho:case Go:case Xo:case ai:case uo:case lo:case is:case Ko:case ts:case ns:case si:return 6;case rs:return 4;default:return 10}}function _h(e){return e&&!!e.expr}function li(e){const t=U(e||{}),n={};for(const i of t)n[i]=Ai(e[i]);return n}var Ule=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function ML(e){const{anchor:t,frame:n,offset:i,orient:r,angle:o,limit:a,color:s,subtitleColor:u,subtitleFont:l,subtitleFontSize:c,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:h,subtitlePadding:g}=e,p=Ule(e,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},p),s?{fill:s}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),i?{offset:i}:{}),r?{orient:r}:{}),o!==void 0?{angle:o}:{}),a!==void 0?{limit:a}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),l?{subtitleFont:l}:{}),c?{subtitleFontSize:c}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),h?{subtitleLineHeight:h}:{}),g?{subtitlePadding:g}:{}),x=pc(e,["align","baseline","dx","dy","limit"]);return{titleMarkConfig:m,subtitleMarkConfig:x,nonMarkTitleProperties:y,subtitle:v}}function us(e){return K(e)||P(e)&&K(e[0])}function oe(e){return e&&!!e.signal}function ls(e){return!!e.step}function qle(e){return P(e)?!1:"fields"in e&&!("data"in e)}function Wle(e){return P(e)?!1:"fields"in e&&"data"in e}function Zo(e){return P(e)?!1:"field"in e&&"data"in e}const Hle={aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1},Gle=U(Hle),Vle={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},GE=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var VE=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function DL(e){const t=P(e.condition)?e.condition.map(NL):NL(e.condition);return Object.assign(Object.assign({},Ai(e)),{condition:t})}function Ai(e){if(_h(e)){const{expr:t}=e,n=VE(e,["expr"]);return Object.assign({signal:t},n)}return e}function NL(e){if(_h(e)){const{expr:t}=e,n=VE(e,["expr"]);return Object.assign({signal:t},n)}return e}function lt(e){if(_h(e)){const{expr:t}=e,n=VE(e,["expr"]);return Object.assign({signal:t},n)}return oe(e)?e:e!==void 0?{value:e}:void 0}function Yle(e){return oe(e)?e.signal:H(e)}function RL(e){return oe(e)?e.signal:H(e.value)}function ea(e){return oe(e)?e.signal:e==null?null:H(e)}function Xle(e,t,n){for(const i of n){const r=wu(i,t.markDef,t.config);r!==void 0&&(e[i]=lt(r))}return e}function jL(e){var t;return[].concat(e.type,(t=e.style)!==null&&t!==void 0?t:[])}function He(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&t[r]!==void 0?t[r]:t[e]!==void 0?t[e]:o&&(!r||r===e)?void 0:wu(e,t,n,i)}function wu(e,t,n,{vgChannel:i}={}){return At(i?V0(e,t,n.style):void 0,V0(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e])}function V0(e,t,n){return $L(e,jL(t),n)}function $L(e,t,n){t=J(t);let i;for(const r of t){const o=n[r];o&&o[e]!==void 0&&(i=o[e])}return i}function LL(e,t){return J(e).reduce((n,i)=>{var r;return n.field.push(V(i,t)),n.order.push((r=i.sort)!==null&&r!==void 0?r:"ascending"),n},{field:[],order:[]})}function IL(e,t){const n=[...e];return t.forEach(i=>{for(const r of n)if(no(r,i))return;n.push(i)}),n}function PL(e,t){return no(e,t)||!t?e:e?[...J(e),...J(t)].join(", "):t}function zL(e,t){const n=e.value,i=t.value;if(n==null||i===null)return{explicit:e.explicit,value:null};if((us(n)||oe(n))&&(us(i)||oe(i)))return{explicit:e.explicit,value:PL(n,i)};if(us(n)||oe(n))return{explicit:e.explicit,value:n};if(us(i)||oe(i))return{explicit:e.explicit,value:i};if(!us(n)&&!oe(n)&&!us(i)&&!oe(i))return{explicit:e.explicit,value:IL(n,i)};throw new Error("It should never reach here")}function YE(e){return`Invalid specification ${rt(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const Kle='Autosize "fit" only works for single views and layered views.';function BL(e){return`${e=="width"?"Width":"Height"} "container" only works for single views and layered views.`}function UL(e){const t=e=="width"?"Width":"Height",n=e=="width"?"x":"y";return`${t} "container" only works well with autosize "fit" or "fit-${n}".`}function qL(e){return e?`Dropping "fit-${e}" because spec has discrete ${ui(e)}.`:'Dropping "fit" because spec has discrete size.'}function XE(e){return`Unknown field for ${e}. Cannot calculate view size.`}function WL(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`}function Jle(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`}function Qle(e){return`The "nearest" transform is not supported for ${e} marks.`}function HL(e){return`Selection not supported for ${e} yet.`}function Zle(e){return`Cannot find a selection named "${e}".`}const ece="Scale bindings are currently only supported for scales with unbinned, continuous domains.",tce="Legend bindings are only supported for selections over an individual field or encoding channel.";function nce(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`}function ice(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`}const rce="The same selection must be used to override scale domains in a layered view.",oce='Interval selections should be initialized using "x" and/or "y" keys.';function ace(e){return`Unknown repeated value "${e}".`}function GL(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`}const sce="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function uce(e){return`Unrecognized parse "${e}".`}function VL(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`}const lce="Attempt to add the same child twice.";function cce(e){return`Ignoring an invalid transform: ${rt(e)}.`}const fce='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function YL(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`}function dce(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${rt(t)} is overridden by a child projection ${rt(n)}.`}const hce="Arc marks uses theta channel rather than angle, replacing angle with theta.";function gce(e){return`${e}Offset dropped because ${e} is continuous`}function pce(e){return`There is no ${e} encoding. Replacing ${e}Offset encoding as ${e}.`}function mce(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${rt(n)}}.`}function XL(e){return`Invalid field type "${e}".`}function yce(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`}function vce(e){return`Invalid aggregation operator "${e}".`}function KL(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`}function bce(e){return`Position range does not support relative band size for ${e}.`}function KE(e,t){return`Dropping ${rt(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`}const xce="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function Y0(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`}function wce(e){return`${e} encoding has no scale, so specified scale is ignored.`}function _ce(e){return`${e}-encoding is dropped as ${e} is not a valid encoding channel.`}function Ece(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`}function Oce(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Sce(e){return`Facet encoding dropped as ${e.join(" and ")} ${e.length>1?"are":"is"} also specified.`}function JE(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${t==="ordinal"?"order":"magnitude"}.`}function Ace(e){return`The ${e} for range marks cannot be an expression`}function kce(e,t){return`Line mark is for continuous lines and thus cannot be used with ${e&&t?"x2 and y2":e?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function Cce(e,t){return`Specified orient "${e}" overridden with "${t}".`}function Tce(e){return`Cannot use the scale property "${e}" with non-color channel.`}function Fce(e){return`Cannot use the relative band size with ${e} scale.`}function Mce(e){return`Using unaggregated domain with raw field has no effect (${rt(e)}).`}function Dce(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`}function Nce(e){return`Unaggregated domain is currently unsupported for log scale (${rt(e)}).`}function Rce(e){return`Cannot apply size to non-oriented mark "${e}".`}function jce(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`}function $ce(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`}function JL(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`}function QL(e){return`The step for "${e}" is dropped because the ${e==="width"?"x":"y"} is continuous.`}function Lce(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${rt(n)} and ${rt(i)}). Using ${rt(n)}.`}function Ice(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${rt(n)} and ${rt(i)}). Using the union of the two domains.`}function Pce(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`}function zce(e){return`Dropping sort property ${rt(e)} as unioned domains only support boolean or op "count", "min", and "max".`}const ZL="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",Bce="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",Uce="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",qce="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.";function Wce(e){return`Cannot stack "${e}" if there is already "${e}2".`}function Hce(e){return`Cannot stack non-linear scale (${e}).`}function Gce(e){return`Stacking is applied even though the aggregate function is non-summative ("${e}").`}function X0(e,t){return`Invalid ${e}: ${rt(t)}.`}function Vce(e){return`Dropping day from datetime ${rt(e)} as day cannot be combined with other units.`}function Yce(e,t){return`${t?"extent ":""}${t&&e?"and ":""}${e?"center ":""}${t&&e?"are ":"is "}not needed when data are aggregated.`}function Xce(e,t,n){return`${e} is not usually used with ${t} for ${n}.`}function Kce(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`}function eI(e){return`1D error band does not support ${e}.`}function tI(e){return`Channel ${e} is required for "binned" bin.`}function Jce(e){return`Channel ${e} should not be used with "binned" bin.`}function Qce(e){return`Domain for ${e} is required for threshold scale.`}globalThis&&globalThis.__classPrivateFieldSet;globalThis&&globalThis.__classPrivateFieldGet;const nI=Wy(qy);let xc=nI;function Zce(e){return xc=e,xc}function efe(){return xc=nI,xc}function q(...e){xc.warn(...e)}function tfe(...e){xc.debug(...e)}function _u(e){if(e&&Q(e)){for(const t of ZE)if(t in e)return!0}return!1}const iI=["january","february","march","april","may","june","july","august","september","october","november","december"],nfe=iI.map(e=>e.substr(0,3)),rI=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],ife=rI.map(e=>e.substr(0,3));function rfe(e){if(I0(e)&&(e=+e),Je(e))return e>4&&q(X0("quarter",e)),e-1;throw new Error(X0("quarter",e))}function ofe(e){if(I0(e)&&(e=+e),Je(e))return e-1;{const t=e.toLowerCase(),n=iI.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=nfe.indexOf(i);if(r!==-1)return r;throw new Error(X0("month",e))}}function afe(e){if(I0(e)&&(e=+e),Je(e))return e%7;{const t=e.toLowerCase(),n=rI.indexOf(t);if(n!==-1)return n;const i=t.substr(0,3),r=ife.indexOf(i);if(r!==-1)return r;throw new Error(X0("day",e))}}function QE(e,t){const n=[];if(t&&e.day!==void 0&&U(e).length>1&&(q(Vce(e)),e=be(e),delete e.day),e.year!==void 0?n.push(e.year):n.push(2012),e.month!==void 0){const i=t?ofe(e.month):e.month;n.push(i)}else if(e.quarter!==void 0){const i=t?rfe(e.quarter):e.quarter;n.push(Je(i)?i*3:`${i}*3`)}else n.push(0);if(e.date!==void 0)n.push(e.date);else if(e.day!==void 0){const i=t?afe(e.day):e.day;n.push(Je(i)?i+1:`${i}+1`)}else n.push(1);for(const i of["hours","minutes","seconds","milliseconds"]){const r=e[i];n.push(typeof r=="undefined"?0:r)}return n}function Eh(e){const n=QE(e,!0).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function sfe(e){const n=QE(e,!1).join(", ");return e.utc?`utc(${n})`:`datetime(${n})`}function ufe(e){const t=QE(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t)}var lfe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const oI={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},ZE=U(oI);function cfe(e){return!!oI[e]}function eO(e){return e.startsWith("utc")}function ffe(e){return e.substr(3)}const dfe={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function tO(e){return ZE.filter(t=>aI(e,t))}function aI(e,t){const n=e.indexOf(t);return!(n<0||n>0&&t==="seconds"&&e.charAt(n-1)==="i"||e.length>n+3&&t==="day"&&e.charAt(n+3)==="o"||n>0&&t==="year"&&e.charAt(n-1)==="f")}function hfe(e,t,{end:n}={end:!1}){const i=$E(t),r=eO(e)?"utc":"";function o(u){return u==="quarter"?`(${r}quarter(${i})-1)`:`${r}${u}(${i})`}let a;const s={};for(const u of ZE)aI(e,u)&&(s[u]=o(u),a=u);return n&&(s[a]+="+1"),sfe(s)}function sI(e){if(!e)return;const t=tO(e);return`timeUnitSpecifier(${rt(t)}, ${rt(dfe)})`}function gfe(e,t,n){if(!e)return;const i=sI(e);return`${n||eO(e)?"utc":"time"}Format(${t}, ${i})`}function Bn(e){if(!e)return;let t;return K(e)?t={unit:e}:Q(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),eO(t.unit)&&(t.utc=!0,t.unit=ffe(t.unit)),t}function pfe(e){const t=Bn(e),{utc:n}=t,i=lfe(t,["utc"]);return i.unit?(n?"utc":"")+U(i).map(r=>ht(`${r==="unit"?"":`_${r}_`}${i[r]}`)).join(""):(n?"utc":"")+"timeunit"+U(i).map(r=>ht(`_${r}_${i[r]}`)).join("")}function mfe(e){return e==null?void 0:e.param}function nO(e){return e&&!!e.field&&e.equal!==void 0}function iO(e){return e&&!!e.field&&e.lt!==void 0}function rO(e){return e&&!!e.field&&e.lte!==void 0}function oO(e){return e&&!!e.field&&e.gt!==void 0}function aO(e){return e&&!!e.field&&e.gte!==void 0}function sO(e){if(e==null?void 0:e.field){if(P(e.range)&&e.range.length===2)return!0;if(oe(e.range))return!0}return!1}function uO(e){return e&&!!e.field&&(P(e.oneOf)||P(e.in))}function yfe(e){return e&&!!e.field&&e.valid!==void 0}function uI(e){return uO(e)||nO(e)||sO(e)||iO(e)||oO(e)||rO(e)||aO(e)}function fo(e,t){return f1(e,{timeUnit:t,wrapTime:!0})}function vfe(e,t){return e.map(n=>fo(n,t))}function lI(e,t=!0){var n;const{field:i}=e,r=(n=Bn(e.timeUnit))===null||n===void 0?void 0:n.unit,o=r?`time(${hfe(r,i)})`:V(e,{expr:"datum"});if(nO(e))return`${o}===${fo(e.equal,r)}`;if(iO(e)){const a=e.lt;return`${o}<${fo(a,r)}`}else if(oO(e)){const a=e.gt;return`${o}>${fo(a,r)}`}else if(rO(e)){const a=e.lte;return`${o}<=${fo(a,r)}`}else if(aO(e)){const a=e.gte;return`${o}>=${fo(a,r)}`}else{if(uO(e))return`indexof([${vfe(e.oneOf,r).join(",")}], ${o}) !== -1`;if(yfe(e))return lO(o,e.valid);if(sO(e)){const{range:a}=e,s=oe(a)?{signal:`${a.signal}[0]`}:a[0],u=oe(a)?{signal:`${a.signal}[1]`}:a[1];if(s!==null&&u!==null&&t)return"inrange("+o+", ["+fo(s,r)+", "+fo(u,r)+"])";const l=[];return s!==null&&l.push(`${o} >= ${fo(s,r)}`),u!==null&&l.push(`${o} <= ${fo(u,r)}`),l.length>0?l.join(" && "):"true"}}throw new Error(`Invalid field predicate: ${rt(e)}`)}function lO(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`}function bfe(e){var t;return uI(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:(t=Bn(e.timeUnit))===null||t===void 0?void 0:t.unit}):e}const Oh={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function xfe(e){return e==="quantitative"||e==="temporal"}function cI(e){return e==="ordinal"||e==="nominal"}const Eu=Oh.quantitative,cO=Oh.ordinal,wc=Oh.temporal,fO=Oh.nominal,_c=Oh.geojson;function wfe(e){if(e)switch(e=e.toLowerCase(),e){case"q":case Eu:return"quantitative";case"t":case wc:return"temporal";case"o":case cO:return"ordinal";case"n":case fO:return"nominal";case _c:return"geojson"}}var _fe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const ci={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},dO={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Efe(e,t){const n=dO[e],i=dO[t];return n===i||n==="ordinal-position"&&i==="time"||i==="ordinal-position"&&n==="time"}const Ofe={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function fI(e){return Ofe[e]}const dI=new Set(["linear","log","pow","sqrt","symlog"]),hI=new Set([...dI,"time","utc"]);function gI(e){return dI.has(e)}const pI=new Set(["quantile","quantize","threshold"]),Sfe=new Set([...hI,...pI,"sequential","identity"]),Afe=new Set(["ordinal","bin-ordinal","point","band"]);function Ht(e){return Afe.has(e)}function ki(e){return Sfe.has(e)}function wr(e){return hI.has(e)}function Ec(e){return pI.has(e)}const kfe={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function Cfe(e){return!K(e)&&!!e.name}function mI(e){return e==null?void 0:e.param}function Tfe(e){return e&&e.unionWith}function Ffe(e){return Q(e)&&"field"in e}const Mfe={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Dfe=_fe(Mfe,["type","domain","range","rangeMax","rangeMin","scheme"]),Nfe=U(Dfe);function hO(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return wr(e)||e==="band"||e==="point";case"padding":case"rangeMin":case"rangeMax":return wr(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return e==="band";case"domainMax":case"domainMid":case"domainMin":case"clamp":return wr(e);case"nice":return wr(e)||e==="quantize"||e==="threshold";case"exponent":return e==="pow";case"base":return e==="log";case"constant":return e==="symlog";case"zero":return ki(e)&&!De(["log","time","utc","threshold","quantile"],e)}}function yI(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return vc(e)?void 0:Tce(e);case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function Rfe(e,t){return De([cO,fO],t)?e===void 0||Ht(e):t===wc?De([ci.TIME,ci.UTC,void 0],e):t===Eu?gI(e)||Ec(e)||e===void 0:!0}function jfe(e,t,n=!1){if(!as(e))return!1;switch(e){case pt:case Wt:case es:case yc:case br:case oo:return wr(t)||t==="band"?!0:t==="point"?!n:!1;case Xo:case is:case Ko:case ts:case ns:case yu:return wr(t)||Ec(t)||De(["band","point","ordinal"],t);case ai:case uo:case lo:return t!=="band";case rs:case si:return t==="ordinal"||Ec(t)}}const Un={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},vI=Un.arc,K0=Un.area,J0=Un.bar,$fe=Un.image,Q0=Un.line,Z0=Un.point,Lfe=Un.rect,e1=Un.rule,bI=Un.text,gO=Un.tick,Ife=Un.trail,pO=Un.circle,mO=Un.square,xI=Un.geoshape;function cs(e){return["line","area","trail"].includes(e)}function wI(e){return["rect","bar","image","arc"].includes(e)}const Pfe=new Set(U(Un));function ho(e){return e.type}const zfe=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],Bfe=["fill","fillOpacity"],Ufe=[...zfe,...Bfe],qfe={color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1},_I=U(qfe),Wfe={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},Hfe={color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},Gfe={mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1},EI=U(Gfe);function Oc(e){return e&&e.band!=null}const Vfe={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},OI=5,Yfe={binSpacing:1,continuousBandSize:OI,timeUnitBandPosition:.5},Xfe={binSpacing:0,continuousBandSize:OI,timeUnitBandPosition:.5},Kfe={thickness:1};function Jfe(e){return ho(e)?e.type:e}function yO(e){const{channel:t,channelDef:n,markDef:i,scale:r,config:o}=e,a=bO(e);return G(n)&&!CL(n.aggregate)&&r&&wr(r.get("type"))?Qfe({fieldDef:n,channel:t,markDef:i,ref:a,config:o}):a}function Qfe({fieldDef:e,channel:t,markDef:n,ref:i,config:r}){return cs(n.type)?i:He("invalid",n,r)===null?[Zfe(e,t),i]:i}function Zfe(e,t){const n=vO(e,!0),r=bu(t)==="y"?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function vO(e,t=!0){return lO(K(e)?e:V(e,{expr:"datum"}),!t)}function ede(e){const{datum:t}=e;return _u(t)?Eh(t):`${rt(t)}`}function Ou(e,t,n,i){const r={};if(t&&(r.scale=t),po(e)){const{datum:o}=e;_u(o)?r.signal=Eh(o):oe(o)?r.signal=o.signal:_h(o)?r.signal=o.expr:r.value=o}else r.field=V(e,n);if(i){const{offset:o,band:a}=i;o&&(r.offset=o),a&&(r.band=a)}return r}function t1({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,bandPosition:o=.5}){const a=0<o&&o<1?"datum":void 0,s=V(t,{expr:a,suffix:r}),u=n!==void 0?V(n,{expr:a}):V(t,{suffix:"end",expr:a}),l={};if(o===0||o===1){l.scale=e;const c=o===0?s:u;l.field=c}else{const c=oe(o)?`${o.signal} * ${s} + (1-${o.signal}) * ${u}`:`${o} * ${s} + ${1-o} * ${u}`;l.signal=`scale("${e}", ${c})`}return i&&(l.offset=i),l}function bO({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,bandPosition:c}){var f;if(t){if(ye(t)){const d=a==null?void 0:a.get("type");if(Vi(t)){c!=null||(c=$I({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:h,timeUnit:g,type:p}=t;if(ot(h)||c&&g&&p===wc)return(s==null?void 0:s.impute)?Ou(t,o,{binSuffix:"mid"},{offset:u}):c&&!Ht(d)?t1({scaleName:o,fieldOrDatumDef:t,bandPosition:c,offset:u}):Ou(t,o,Ch(t,e)?{binSuffix:"range"}:{},{offset:u});if(zn(h)){if(G(n))return t1({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:c,offset:u});q(tI(e===pt?vr:ro))}}return Ou(t,o,Ht(d)?{binSuffix:"range"}:{},{offset:u,band:d==="band"?(f=c!=null?c:t.bandPosition)!==null&&f!==void 0?f:.5:void 0})}else if(_r(t)){const d=t.value,h=u?{offset:u}:{};return Object.assign(Object.assign({},Sh(e,d)),h)}}return _e(l)&&(l=l()),l&&Object.assign(Object.assign({},l),u?{offset:u}:{})}function Sh(e,t){return De(["x","x2"],e)&&t==="width"?{field:{group:"width"}}:De(["y","y2"],e)&&t==="height"?{field:{group:"height"}}:lt(t)}function Su(e){return e&&e!=="number"&&e!=="time"}function SI(e,t,n){return`${e}(${t}${n?`, ${rt(n)}`:""})`}const tde=" \u2013 ";function xO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o}){var a,s;if(Su(n))return wO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,config:o});const u=AI(e,i,r);if(kc(e)){const l=ide(u,G(e)?(a=Bn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0,t,o.timeFormat,Au(e)&&((s=e.scale)===null||s===void 0?void 0:s.type)===ci.UTC);return l?{signal:l}:void 0}if(t=TI(SO(e),t,o),G(e)&&ot(e.bin)){const l=V(e,{expr:i,binSuffix:"end"});return{signal:n1(u,l,t,n,o)}}else return t||SO(e)==="quantitative"?{signal:`${FI(u,t)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function AI(e,t,n){return G(e)?n?`${V(e,{expr:t,suffix:"end"})}-${V(e,{expr:t,suffix:"start"})}`:V(e,{expr:t}):ede(e)}function wO({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:a}){if(a!=null||(a=AI(e,i,r)),G(e)&&ot(e.bin)){const s=V(e,{expr:i,binSuffix:"end"});return{signal:n1(a,s,t,n,o)}}return{signal:SI(n,a,t)}}function kI(e,t,n,i,r,o){var a;if(!Su(i)){if(kc(e)){const s=G(e)?(a=Bn(e.timeUnit))===null||a===void 0?void 0:a.unit:void 0;return nde(n,s,r,o)}return TI(t,n,r)}}function CI(e,t,n){if(e&&(oe(e)||e==="number"||e==="time"))return e;if(kc(t)&&n!=="time"&&n!=="utc")return"time"}function TI(e,t,n){if(K(t))return t;if(e===Eu)return n.numberFormat}function nde(e,t,n,i){return e||(t?{signal:sI(t)}:i?void 0:n.timeFormat)}function FI(e,t){return`format(${e}, "${t||""}")`}function MI(e,t,n,i){var r;return Su(n)?SI(n,e,t):FI(e,(r=K(t)?t:void 0)!==null&&r!==void 0?r:i.numberFormat)}function n1(e,t,n,i,r){const o=MI(e,n,i,r),a=MI(t,n,i,r);return`${lO(e,!1)} ? "null" : ${o} + "${tde}" + ${a}`}function ide(e,t,n,i,r){return!t||n?(n=K(n)?n:i,`${r?"utc":"time"}Format(${e}, '${n}')`):gfe(t,e,r)}const i1="min",rde={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function DI(e){return e in rde}function NI(e){return!!e&&!!e.encoding}function go(e){return!!e&&(e.op==="count"||!!e.field)}function RI(e){return!!e&&P(e)}function Ah(e){return"row"in e||"column"in e}function _O(e){return!!e&&"header"in e}function r1(e){return"facet"in e}var EO=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function ode(e){return e.param}function ade(e){return e&&!K(e)&&"repeat"in e}function jI(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),i?{bin:i}:{}),r?{aggregate:r}:{}),{field:t})}function OO(e){return"sort"in e}function $I({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(ye(e)&&e.bandPosition!==void 0)return e.bandPosition;if(G(e)){const{timeUnit:r,bin:o}=e;if(r&&!t)return wI(n.type)?0:wu("timeUnitBandPosition",n,i);if(ot(o))return .5}}function LI({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:o,useVlSizeChannel:a}){var s,u,l;const c=ui(e),f=He(a?"size":c,i,r,{vgChannel:c});if(f!==void 0)return f;if(G(t)){const{timeUnit:d,bin:h}=t;if(d&&!n)return{band:wu("timeUnitBandSize",i,r)};if(ot(h)&&!Ht(o))return{band:1}}if(wI(i.type))return o?Ht(o)?((s=r[i.type])===null||s===void 0?void 0:s.discreteBandSize)||{band:1}:(u=r[i.type])===null||u===void 0?void 0:u.continuousBandSize:(l=r[i.type])===null||l===void 0?void 0:l.discreteBandSize}function II(e,t,n,i){return ot(e.bin)||e.timeUnit&&Vi(e)&&e.type==="temporal"?$I({fieldDef:e,fieldDef2:t,markDef:n,config:i})!==void 0:!1}function o1(e){return e&&"condition"in e}function a1(e){const t=e&&e.condition;return!!t&&!P(t)&&G(t)}function kh(e){const t=e&&e.condition;return!!t&&!P(t)&&ye(t)}function sde(e){const t=e&&e.condition;return!!t&&(P(t)||_r(t))}function G(e){return e&&(!!e.field||e.aggregate==="count")}function SO(e){return e&&e.type}function po(e){return e&&"datum"in e}function mo(e){return Vi(e)&&!s1(e)||AO(e)}function AO(e){return po(e)&&Je(e.datum)}function ye(e){return G(e)||po(e)}function Vi(e){return e&&("field"in e||e.aggregate==="count")&&"type"in e}function _r(e){return e&&"value"in e&&"value"in e}function Au(e){return e&&("scale"in e||"sort"in e)}function kO(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function PI(e){return e&&"legend"in e}function zI(e){return e&&("format"in e||"formatType"in e)}function ude(e){return Si(e,["legend","axis","header","scale"])}function lde(e){return"op"in e}function V(e,t={}){var n,i,r;let o=e.field;const a=t.prefix;let s=t.suffix,u="";if(fde(e))o=pL("count");else{let l;if(!t.nofn)if(lde(e))l=e.op;else{const{bin:c,aggregate:f,timeUnit:d}=e;ot(c)?(l=TL(c),s=((n=t.binSuffix)!==null&&n!==void 0?n:"")+((i=t.suffix)!==null&&i!==void 0?i:"")):f?ss(f)?(u=`["${o}"]`,o=`argmax_${f.argmax}`):Qo(f)?(u=`["${o}"]`,o=`argmin_${f.argmin}`):l=String(f):d&&(l=pfe(d),s=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+((r=t.suffix)!==null&&r!==void 0?r:""))}l&&(o=o?`${l}_${o}`:l)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),t.forAs?LE(o):t.expr?dL(o,t.expr)+u:Wi(o)+u}function s1(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return G(e)&&!!e.bin;case"temporal":return!1}throw new Error(XL(e.type))}function cde(e){var t;return Au(e)&&Ec((t=e.scale)===null||t===void 0?void 0:t.type)}function fde(e){return e.aggregate==="count"}function dde(e,t){var n;const{field:i,bin:r,timeUnit:o,aggregate:a}=e;if(a==="count")return t.countTitle;if(ot(r))return`${i} (binned)`;if(o){const s=(n=Bn(o))===null||n===void 0?void 0:n.unit;if(s)return`${i} (${tO(s).join("-")})`}else if(a)return ss(a)?`${i} for max ${a.argmax}`:Qo(a)?`${i} for min ${a.argmin}`:`${mh(a)} of ${i}`;return i}function hde(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(ss(t))return`${r} for argmax(${t.argmax})`;if(Qo(t))return`${r} for argmin(${t.argmin})`;const o=Bn(i),a=t||(o==null?void 0:o.unit)||(o==null?void 0:o.maxbins)&&"timeunit"||ot(n)&&"bin";return a?`${a.toUpperCase()}(${r})`:r}const BI=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return hde(e);default:return dde(e,t)}};let UI=BI;function qI(e){UI=e}function gde(){qI(BI)}function Sc(e,t,{allowDisabling:n,includeDefault:i=!0}){var r,o;const a=(r=CO(e))===null||r===void 0?void 0:r.title;if(!G(e))return a!=null?a:e.title;const s=e,u=i?TO(s,t):void 0;return n?At(a,s.title,u):(o=a!=null?a:s.title)!==null&&o!==void 0?o:u}function CO(e){if(kO(e)&&e.axis)return e.axis;if(PI(e)&&e.legend)return e.legend;if(_O(e)&&e.header)return e.header}function TO(e,t){return UI(e,t)}function u1(e){var t;if(zI(e)){const{format:n,formatType:i}=e;return{format:n,formatType:i}}else{const n=(t=CO(e))!==null&&t!==void 0?t:{},{format:i,formatType:r}=n;return{format:i,formatType:r}}}function pde(e,t){var n;switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(OO(e)&&P(e.sort))return"ordinal";const{aggregate:i,bin:r,timeUnit:o}=e;if(o)return"temporal";if(r||i&&!ss(i)&&!Qo(i))return"quantitative";if(Au(e)&&((n=e.scale)===null||n===void 0?void 0:n.type))switch(dO[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}function yo(e){if(G(e))return e;if(a1(e))return e.condition}function $t(e){if(ye(e))return e;if(kh(e))return e.condition}function WI(e,t,n,i={}){if(K(e)||Je(e)||ga(e)){const r=K(e)?"string":Je(e)?"number":"boolean";return q(mce(t,r,e)),{value:e}}return ye(e)?l1(e,t,n,i):kh(e)?Object.assign(Object.assign({},e),{condition:l1(e.condition,t,n,i)}):e}function l1(e,t,n,i){if(zI(e)){const{format:r,formatType:o}=e,a=EO(e,["format","formatType"]);if(Su(o)&&!n.customFormatTypes)return q(YL(t)),l1(a,t,n,i)}else{const r=kO(e)?"axis":PI(e)?"legend":_O(e)?"header":null;if(r&&e[r]){const o=e[r],{format:a,formatType:s}=o,u=EO(o,["format","formatType"]);if(Su(s)&&!n.customFormatTypes)return q(YL(t)),l1(Object.assign(Object.assign({},e),{[r]:u}),t,n,i)}}return G(e)?FO(e,t,i):mde(e)}function mde(e){let t=e.type;if(t)return e;const{datum:n}=e;return t=Je(n)?"quantitative":K(n)?"nominal":_u(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}function FO(e,t,{compositeMark:n=!1}={}){const{aggregate:i,timeUnit:r,bin:o,field:a}=e,s=Object.assign({},e);if(!n&&i&&!HE(i)&&!ss(i)&&!Qo(i)&&(q(vce(i)),delete s.aggregate),r&&(s.timeUnit=Bn(r)),a&&(s.field=`${a}`),ot(o)&&(s.bin=c1(o,t)),zn(o)&&!rn(t)&&q(Jce(t)),Vi(s)){const{type:u}=s,l=wfe(u);u!==l&&(s.type=l),u!=="quantitative"&&CL(i)&&(q(yce(u,i)),s.type="quantitative")}else if(!wL(t)){const u=pde(s,t);s.type=u}if(Vi(s)){const{compatible:u,warning:l}=yde(s,t)||{};u===!1&&q(l)}if(OO(s)&&K(s.sort)){const{sort:u}=s;if(DI(u))return Object.assign(Object.assign({},s),{sort:{encoding:u}});const l=u.substr(1);if(u.charAt(0)==="-"&&DI(l))return Object.assign(Object.assign({},s),{sort:{encoding:l,order:"descending"}})}if(_O(s)){const{header:u}=s;if(u){const{orient:l}=u,c=EO(u,["orient"]);if(l)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},c),{labelOrient:u.labelOrient||l,titleOrient:u.titleOrient||l})})}}return s}function c1(e,t){return ga(e)?{maxbins:FL(t)}:e==="binned"?{binned:!0}:!e.maxbins&&!e.step?Object.assign(Object.assign({},e),{maxbins:FL(t)}):e}const Ac={compatible:!0};function yde(e,t){const n=e.type;if(n==="geojson"&&t!=="shape")return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case Ho:case Go:case P0:return s1(e)?Ac:{compatible:!1,warning:Ece(t)};case pt:case Wt:case es:case yc:case ai:case uo:case lo:case bh:case wh:case z0:case vu:case B0:case U0:case yu:case br:case oo:case q0:return Ac;case so:case Hi:case ao:case xr:return n!==Eu?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Ac;case Ko:case ts:case ns:case is:case Xo:case Yo:case Vo:case vr:case ro:return n==="nominal"&&!e.sort?{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`}:Ac;case si:case rs:return!s1(e)&&!cde(e)?{compatible:!1,warning:Oce(t)}:Ac;case xh:return e.type==="nominal"&&!("sort"in e)?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Ac}}function kc(e){const{formatType:t}=u1(e);return t==="time"||!t&&vde(e)}function vde(e){return e&&(e.type==="temporal"||G(e)&&!!e.timeUnit)}function f1(e,{timeUnit:t,type:n,wrapTime:i,undefinedIfExprNotRequired:r}){var o;const a=t&&((o=Bn(t))===null||o===void 0?void 0:o.unit);let s=a||n==="temporal",u;return _h(e)?u=e.expr:oe(e)?u=e.signal:_u(e)?(s=!0,u=Eh(e)):(K(e)||Je(e))&&s&&(u=`datetime(${rt(e)})`,cfe(a)&&(Je(e)&&e<1e4||K(e)&&isNaN(Date.parse(e)))&&(u=Eh({[a]:e}))),u?i&&s?`time(${u})`:u:r?void 0:rt(e)}function HI(e,t){const{type:n}=e;return t.map(i=>{const r=f1(i,{timeUnit:G(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return r!==void 0?{signal:r}:i})}function Ch(e,t){return ot(e.bin)?as(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1)}const GI={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Th(e){return e&&e.condition}const VI=["domain","grid","labels","ticks","title"],bde={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},YI={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},xde=Object.assign(Object.assign({},YI),{style:1,labelExpr:1,encoding:1});function XI(e){return!!xde[e]}const wde={axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1},KI=U(wde);function ta(e){return"mark"in e}class d1{constructor(t,n){this.name=t,this.run=n}hasMatchingType(t){return ta(t)?Jfe(t.mark)===this.name:!1}}var _de=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function ku(e,t){const n=e&&e[t];return n?P(n)?pu(n,i=>!!i.field):G(n)||a1(n):!1}function JI(e,t){const n=e&&e[t];return n?P(n)?pu(n,i=>!!i.field):G(n)||po(n)||kh(n):!1}function MO(e,t){if(rn(t)){const n=e[t];if((G(n)||po(n))&&cI(n.type)){const i=_L(t);return JI(e,i)}}return!1}function DO(e){return pu(wle,t=>{if(ku(e,t)){const n=e[t];if(P(n))return pu(n,i=>!!i.aggregate);{const i=yo(n);return i&&!!i.aggregate}}return!1})}function QI(e,t){const n=[],i=[],r=[],o=[],a={};return NO(e,(s,u)=>{if(G(s)){const{field:l,aggregate:c,bin:f,timeUnit:d}=s,h=_de(s,["field","aggregate","bin","timeUnit"]);if(c||d||f){const g=CO(s),p=g==null?void 0:g.title;let m=V(s,{forAs:!0});const y=Object.assign(Object.assign(Object.assign({},p?[]:{title:Sc(s,t,{allowDisabling:!0})}),h),{field:m});if(c){let v;if(ss(c)?(v="argmax",m=V({op:"argmax",field:c.argmax},{forAs:!0}),y.field=`${m}.${l}`):Qo(c)?(v="argmin",m=V({op:"argmin",field:c.argmin},{forAs:!0}),y.field=`${m}.${l}`):c!=="boxplot"&&c!=="errorbar"&&c!=="errorband"&&(v=c),v){const x={op:v,as:m};l&&(x.field=l),o.push(x)}}else if(n.push(m),Vi(s)&&ot(f)){if(i.push({bin:f,field:l,as:m}),n.push(V(s,{binSuffix:"end"})),Ch(s,u)&&n.push(V(s,{binSuffix:"range"})),rn(u)){const v={field:`${m}_end`};a[`${u}2`]=v}y.bin="binned",wL(u)||(y.type=Eu)}else if(d){r.push({timeUnit:d,field:l,as:m});const v=Vi(s)&&s.type!==wc&&"time";v&&(u===bh||u===vu?y.formatType=v:Mle(u)?y.legend=Object.assign({formatType:v},y.legend):rn(u)&&(y.axis=Object.assign({formatType:v},y.axis)))}a[u]=y}else n.push(l),a[u]=e[u]}else a[u]=e[u]}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:a}}function Ede(e,t,n){const i=Nle(t,n);if(i){if(i==="binned"){const r=e[t===vr?pt:Wt];return!!(G(r)&&G(e[t])&&zn(r.bin))}}else return!1;return!0}function Ode(e,t,n,i){const r={};for(const o of U(e))xL(o)||q(_ce(o));for(let o of kle){if(!e[o])continue;const a=e[o];if(bc(o)){const s=EL(o),u=r[s];if(G(u)){if(xfe(u.type)&&G(a)){q(gce(s));continue}}else o=s,q(pce(s))}if(o==="angle"&&t==="arc"&&!e.theta&&(q(hce),o=br),!Ede(e,o,t)){q(Y0(o,t));continue}if(o===Xo&&t==="line"){const s=yo(e[o]);if(s==null?void 0:s.aggregate){q(xce);continue}}if(o===ai&&(n?"fill"in e:"stroke"in e)){q(KL("encoding",{fill:"fill"in e,stroke:"stroke"in e}));continue}if(o===wh||o===xh&&!P(a)&&!_r(a)||o===vu&&P(a))a&&(r[o]=J(a).reduce((s,u)=>(G(u)?s.push(FO(u,o)):q(KE(u,o)),s),[]));else{if(o===vu&&a===null)r[o]=null;else if(!G(a)&&!po(a)&&!_r(a)&&!o1(a)&&!oe(a)){q(KE(a,o));continue}r[o]=WI(a,o,i)}}return r}function h1(e,t){const n={};for(const i of U(e)){const r=WI(e[i],i,t,{compositeMark:!0});n[i]=r}return n}function Sde(e){const t=[];for(const n of U(e))if(ku(e,n)){const i=e[n],r=J(i);for(const o of r)G(o)?t.push(o):a1(o)&&t.push(o.condition)}return t}function NO(e,t,n){if(!!e)for(const i of U(e)){const r=e[i];if(P(r))for(const o of r)t.call(n,o,i);else t.call(n,r,i)}}function Ade(e,t,n,i){return e?U(e).reduce((r,o)=>{const a=e[o];return P(a)?a.reduce((s,u)=>t.call(i,s,u,o),r):t.call(i,r,a,o)},n):n}function ZI(e,t){return U(t).reduce((n,i)=>{switch(i){case pt:case Wt:case B0:case q0:case U0:case vr:case ro:case es:case yc:case br:case Yo:case oo:case Vo:case ao:case so:case xr:case Hi:case bh:case si:case yu:case vu:return n;case xh:if(e==="line"||e==="trail")return n;case wh:case z0:{const r=t[i];if(P(r)||G(r))for(const o of J(r))o.aggregate||n.push(V(o,{}));return n}case Xo:if(e==="trail")return n;case ai:case uo:case lo:case Ko:case ts:case ns:case rs:case is:{const r=yo(t[i]);return r&&!r.aggregate&&n.push(V(r,{})),n}}},[])}var eP=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function kde(e){const{tooltip:t}=e,n=eP(e,["tooltip"]);if(!t)return{filteredEncoding:n};let i,r;if(P(t)){for(const o of t)o.aggregate?(i||(i=[]),i.push(o)):(r||(r=[]),r.push(o));i&&(n.tooltip=i)}else t.aggregate?n.tooltip=t:r=t;return P(r)&&r.length===1&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n}}function RO(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};const r=e.map(({fieldPrefix:a,titlePrefix:s})=>{const u=i?` of ${jO(t)}`:"";return{field:a+t.field,type:t.type,title:oe(s)?{signal:`${s}"${escape(u)}"`}:s+u}}),o=Sde(n).map(ude);return{tooltip:[...r,...io(o,Me)]}}function jO(e){const{title:t,field:n}=e;return At(t,n)}function $O(e,t,n,i,r){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c=void 0,extraEncoding:f={}})=>{const d=jO(n);return tP(e,s,r,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[t]:Object.assign(Object.assign(Object.assign({field:`${l}_${n.field}`,type:n.type},d!==void 0?{title:d}:{}),o!==void 0?{scale:o}:{}),a!==void 0?{axis:a}:{})},K(c)?{[`${t}2`]:{field:`${c}_${n.field}`}}:{}),i),f)})}}function tP(e,t,n,i){const{clip:r,color:o,opacity:a}=e,s=e.type;return e[t]||e[t]===void 0&&n[t]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),r?{clip:r}:{}),o?{color:o}:{}),a?{opacity:a}:{}),ho(i.mark)?i.mark:{type:i.mark}),{style:`${s}-${t}`}),ga(e[t])?{}:e[t])})]:[]}function nP(e,t,n){const{encoding:i}=e,r=t==="vertical"?"y":"x",o=i[r],a=i[`${r}2`],s=i[`${r}Error`],u=i[`${r}Error2`];return{continuousAxisChannelDef:g1(o,n),continuousAxisChannelDef2:g1(a,n),continuousAxisChannelDefError:g1(s,n),continuousAxisChannelDefError2:g1(u,n),continuousAxis:r}}function g1(e,t){if(e==null?void 0:e.aggregate){const{aggregate:n}=e,i=eP(e,["aggregate"]);return n!==t&&q(Kce(n,t)),i}else return e}function iP(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(ho(n)&&n.orient)return n.orient;if(mo(r)){if(mo(o)){const a=G(r)&&r.aggregate,s=G(o)&&o.aggregate;if(!a&&s===t)return"vertical";if(!s&&a===t)return"horizontal";if(a===t&&s===t)throw new Error("Both x and y cannot have aggregate");return kc(o)&&!kc(r)?"horizontal":"vertical"}return"horizontal"}else{if(mo(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`)}}var p1=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const m1="boxplot",Cde=["box","median","outliers","rule","ticks"],Tde=new d1(m1,oP);function rP(e){return Je(e)?"tukey":e}function oP(e,{config:t}){var n,i;e=Object.assign(Object.assign({},e),{encoding:h1(e.encoding,t)});const{mark:r,encoding:o,params:a,projection:s}=e,u=p1(e,["mark","encoding","params","projection"]),l=ho(r)?r:{type:r};a&&q(HL("boxplot"));const c=(n=l.extent)!==null&&n!==void 0?n:t.boxplot.extent,f=He("size",l,t),d=rP(c),{bins:h,timeUnits:g,transform:p,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:x,encodingWithoutContinuousAxis:b,ticksOrient:_,boxOrient:E,customTooltipWithoutAggregatedField:w}=Fde(e,c,t),{color:O,size:S}=b,k=p1(b,["color","size"]),A=qe=>$O(l,y,m,qe,t.boxplot),M=A(k),C=A(b),D=A(Object.assign(Object.assign({},k),S?{size:S}:{})),F=RO([{fieldPrefix:d==="min-max"?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:d==="min-max"?"lower_whisker_":"min_",titlePrefix:"Min"}],m,b),N={type:"tick",color:"black",opacity:1,orient:_,invalid:null,aria:!1},I=d==="min-max"?F:RO([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,b),z=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:I}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:I}),...M({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:I}),...M({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:I})],X=[...d!=="tukey"?z:[],...C({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:E,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:F}),...D({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},Q(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{}),f?{size:f}:{}),{orient:_,aria:!1}),positionPrefix:"mid_box",extraEncoding:F})];if(d==="min-max")return Object.assign(Object.assign({},u),{transform:((i=u.transform)!==null&&i!==void 0?i:[]).concat(p),layer:X});const te=`datum["lower_box_${m.field}"]`,xe=`datum["upper_box_${m.field}"]`,ge=`(${xe} - ${te})`,je=`${te} - ${c} * ${ge}`,Oe=`${xe} + ${c} * ${ge}`,ke=`datum["${m.field}"]`,Xe={joinaggregate:aP(m.field),groupby:v},xt={transform:[{filter:`(${je} <= ${ke}) && (${ke} <= ${Oe})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...x],groupby:v}],layer:z},Ge=p1(k,["tooltip"]),{scale:Y,axis:ne}=m,fe=jO(m),B=Si(ne,["title"]),Ve=tP(l,"outliers",t.boxplot,{transform:[{filter:`(${ke} < ${je}) || (${ke} > ${Oe})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},fe!==void 0?{title:fe}:{}),Y!==void 0?{scale:Y}:{}),Ze(B)?{}:{axis:B})},Ge),O?{color:O}:{}),w?{tooltip:w}:{})})[0];let pe;const tt=[...h,...g,Xe];return Ve?pe={transform:tt,layer:[Ve,xt]}:(pe=xt,pe.transform.unshift(...tt)),Object.assign(Object.assign({},u),{layer:[pe,{transform:p,layer:X}]})}function aP(e){return[{op:"q1",field:e,as:`lower_box_${e}`},{op:"q3",field:e,as:`upper_box_${e}`}]}function Fde(e,t,n){const i=iP(e,m1),{continuousAxisChannelDef:r,continuousAxis:o}=nP(e,i,m1),a=r.field,s=rP(t),u=[...aP(a),{op:"median",field:a,as:`mid_box_${a}`},{op:"min",field:a,as:(s==="min-max"?"lower_whisker_":"min_")+a},{op:"max",field:a,as:(s==="min-max"?"upper_whisker_":"max_")+a}],l=s==="min-max"||s==="tukey"?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${t}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${t}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],c=e.encoding,f=o;c[f];const d=p1(c,[typeof f=="symbol"?f:f+""]),{customTooltipWithoutAggregatedField:h,filteredEncoding:g}=kde(d),{bins:p,timeUnits:m,aggregate:y,groupby:v,encoding:x}=QI(g,n),b=i==="vertical"?"horizontal":"vertical",_=i,E=[...p,...m,{aggregate:[...y,...u],groupby:v},...l];return{bins:p,timeUnits:m,transform:E,groupby:v,aggregate:y,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:b,boxOrient:_,customTooltipWithoutAggregatedField:h}}var sP=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const LO="errorbar",Mde=["ticks","rule"],Dde=new d1(LO,uP);function uP(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:h1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=lP(e,LO,t);delete o.size;const c=$O(s,r,i,o,t.errorbar),f=s.thickness,d=s.size,h=Object.assign(Object.assign({type:"tick",orient:a,aria:!1},f!==void 0?{thickness:f}:{}),d!==void 0?{size:d}:{}),g=[...c({partName:"ticks",mark:h,positionPrefix:"lower",extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",extraEncoding:l}),...c({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},f!==void 0?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),g.length>1?{layer:g}:Object.assign({},g[0]))}function Nde(e,t){const{encoding:n}=e;if(Rde(n))return{orient:iP(e,t),inputType:"raw"};const i=jde(n),r=$de(n),o=n.x,a=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const s=n.x2,u=n.y2;if(ye(s)&&ye(u))throw new Error(`${t} cannot have both x2 and y2`);if(ye(s)){if(mo(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`)}else if(ye(u)){if(mo(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`)}throw new Error("No ranged axis")}else{const s=n.xError,u=n.xError2,l=n.yError,c=n.yError2;if(ye(u)&&!ye(s))throw new Error(`${t} cannot have xError2 without xError`);if(ye(c)&&!ye(l))throw new Error(`${t} cannot have yError2 without yError`);if(ye(s)&&ye(l))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ye(s)){if(mo(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}else if(ye(l)){if(mo(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Rde(e){return(ye(e.x)||ye(e.y))&&!ye(e.x2)&&!ye(e.y2)&&!ye(e.xError)&&!ye(e.xError2)&&!ye(e.yError)&&!ye(e.yError2)}function jde(e){return ye(e.x2)||ye(e.y2)}function $de(e){return ye(e.xError)||ye(e.xError2)||ye(e.yError)||ye(e.yError2)}function lP(e,t,n){var i;const{mark:r,encoding:o,params:a,projection:s}=e,u=sP(e,["mark","encoding","params","projection"]),l=ho(r)?r:{type:r};a&&q(HL(t));const{orient:c,inputType:f}=Nde(e,t),{continuousAxisChannelDef:d,continuousAxisChannelDef2:h,continuousAxisChannelDefError:g,continuousAxisChannelDefError2:p,continuousAxis:m}=nP(e,c,t),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:x,tooltipTitleWithFieldName:b}=Lde(l,d,h,g,p,f,t,n),_=o,E=m;_[E];const w=m==="x"?"x2":"y2";_[w];const O=m==="x"?"xError":"yError";_[O];const S=m==="x"?"xError2":"yError2";_[S];const k=sP(_,[typeof E=="symbol"?E:E+"",typeof w=="symbol"?w:w+"",typeof O=="symbol"?O:O+"",typeof S=="symbol"?S:S+""]),{bins:A,timeUnits:M,aggregate:C,groupby:D,encoding:F}=QI(k,n),N=[...C,...y],I=f!=="raw"?[]:D,z=RO(x,d,F,b);return{transform:[...(i=u.transform)!==null&&i!==void 0?i:[],...A,...M,...N.length===0?[]:[{aggregate:N,groupby:I}],...v],groupby:I,continuousAxisChannelDef:d,continuousAxis:m,encodingWithoutContinuousAxis:F,ticksOrient:c==="vertical"?"horizontal":"vertical",markDef:l,outerSpec:u,tooltipEncoding:z}}function Lde(e,t,n,i,r,o,a,s){let u=[],l=[];const c=t.field;let f,d=!1;if(o==="raw"){const h=e.center?e.center:e.extent?e.extent==="iqr"?"median":"mean":s.errorbar.center,g=e.extent?e.extent:h==="mean"?"stderr":"iqr";if(h==="median"!=(g==="iqr")&&q(Xce(h,g,a)),g==="stderr"||g==="stdev")u=[{op:g,field:c,as:`extent_${c}`},{op:h,field:c,as:`center_${c}`}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],f=[{fieldPrefix:"center_",titlePrefix:mh(h)},{fieldPrefix:"upper_",titlePrefix:cP(h,g,"+")},{fieldPrefix:"lower_",titlePrefix:cP(h,g,"-")}],d=!0;else{let p,m,y;g==="ci"?(p="mean",m="ci0",y="ci1"):(p="median",m="q1",y="q3"),u=[{op:m,field:c,as:`lower_${c}`},{op:y,field:c,as:`upper_${c}`},{op:p,field:c,as:`center_${c}`}],f=[{fieldPrefix:"upper_",titlePrefix:Sc({field:c,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Sc({field:c,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Sc({field:c,aggregate:p,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(e.center||e.extent)&&q(Yce(e.center,e.extent)),o==="aggregated-upper-lower"?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):o==="aggregated-error"&&(f=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${i.field}"]`,as:`upper_${c}`}],r?l.push({calculate:`datum["${c}"] + datum["${r.field}"]`,as:`lower_${c}`}):l.push({calculate:`datum["${c}"] - datum["${i.field}"]`,as:`lower_${c}`}));for(const h of l)f.push({fieldPrefix:h.as.substring(0,6),titlePrefix:mu(mu(h.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:d}}function cP(e,t,n){return`${mh(e)} ${n} ${t}`}const IO="errorband",Ide=["band","borders"],Pde=new d1(IO,fP);function fP(e,{config:t}){e=Object.assign(Object.assign({},e),{encoding:h1(e.encoding,t)});const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=lP(e,IO,t),l=a,c=$O(l,r,i,o,t.errorband),f=e.encoding.x!==void 0&&e.encoding.y!==void 0;let d={type:f?"area":"rect"},h={type:f?"line":"rule"};const g=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return f?(d=Object.assign(Object.assign(Object.assign({},d),g),{ariaRoleDescription:"errorband"}),h=Object.assign(Object.assign(Object.assign({},h),g),{aria:!1})):l.interpolate?q(eI("interpolate")):l.tension&&q(eI("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"lower",extraEncoding:u}),...c({partName:"borders",mark:h,positionPrefix:"upper",extraEncoding:u})]})}const dP={};function PO(e,t,n){const i=new d1(e,t);dP[e]={normalizer:i,parts:n}}function zde(){return U(dP)}PO(m1,oP,Cde);PO(LO,uP,Mde);PO(IO,fP,Ide);const Bde=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],hP={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},gP={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Ude=U(hP),qde=U(gP),Wde={header:1,headerRow:1,headerColumn:1,headerFacet:1},pP=U(Wde),mP=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Hde={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},Gde={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Fh="_vgsid_",Vde={point:{on:"click",fields:[Fh],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function zO(e){return!!e&&(e==="legend"||!!e.legend)}function BO(e){return zO(e)&&Q(e)}function UO(e){return!!e.select}var Yde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function yP(e){const t=[];for(const n of e||[]){if(UO(n))continue;const{expr:i,bind:r}=n,o=Yde(n,["expr","bind"]);if(r&&i){const a=Object.assign(Object.assign({},o),{bind:r,init:i});t.push(a)}else{const a=Object.assign(Object.assign(Object.assign({},o),i?{update:i}:{}),r?{bind:r}:{});t.push(a)}}return t}function Xde(e){return y1(e)||WO(e)||qO(e)}function qO(e){return"concat"in e}function y1(e){return"vconcat"in e}function WO(e){return"hconcat"in e}function vP({step:e,offsetIsDiscrete:t}){var n;return t?(n=e.for)!==null&&n!==void 0?n:"offset":"position"}function vo(e){return Q(e)&&e.step!==void 0}function bP(e){return e.view||e.width||e.height}const xP=20,Kde={align:1,bounds:1,center:1,columns:1,spacing:1},Jde=U(Kde);function Qde(e,t,n){var i,r;const o=n[t],a={},{spacing:s,columns:u}=o;s!==void 0&&(a.spacing=s),u!==void 0&&(r1(e)&&!Ah(e.facet)||qO(e))&&(a.columns=u),y1(e)&&(a.columns=1);for(const l of Jde)if(e[l]!==void 0)if(l==="spacing"){const c=e[l];a[l]=Je(c)?c:{row:(i=c.row)!==null&&i!==void 0?i:s,column:(r=c.column)!==null&&r!==void 0?r:s}}else a[l]=e[l];return a}var Zde=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function HO(e,t){var n;return(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"continuousWidth":"continuousHeight"]}function v1(e,t){const n=b1(e,t);return vo(n)?n.step:wP}function b1(e,t){var n;const i=(n=e[t])!==null&&n!==void 0?n:e[t==="width"?"discreteWidth":"discreteHeight"];return At(i,{step:e.step})}const wP=20,ehe={continuousWidth:200,continuousHeight:200,step:wP},the={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:ehe,mark:Hfe,arc:{},area:{},bar:Yfe,circle:{},geoshape:{},image:{},line:{},point:{},rect:Xfe,rule:{color:"black"},square:{},text:{color:"black"},tick:Kfe,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:kfe,projection:{},legend:Hde,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Vde,style:{},title:{},facet:{spacing:xP},concat:{spacing:xP}},na=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],_P={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},EP={blue:na[0],orange:na[1],red:na[2],teal:na[3],green:na[4],yellow:na[5],purple:na[6],pink:na[7],brown:na[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function nhe(e={}){return{signals:[{name:"color",value:Q(e)?Object.assign(Object.assign({},EP),e):EP}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function ihe(e){return{signals:[{name:"fontSize",value:Q(e)?Object.assign(Object.assign({},_P),e):_P}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function rhe(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function OP(e){const t=U(e||{}),n={};for(const i of t){const r=e[i];n[i]=Th(r)?DL(r):Ai(r)}return n}function ohe(e){const t=U(e),n={};for(const i of t)n[i]=OP(e[i]);return n}const ahe=[...EI,...KI,...pP,"background","padding","legend","lineBreak","scale","style","title","view"];function SP(e={}){const{color:t,font:n,fontSize:i,selection:r}=e,o=Zde(e,["color","font","fontSize","selection"]),a=dl({},be(the),n?rhe(n):{},t?nhe(t):{},i?ihe(i):{},o||{});r&&hl(a,"selection",r,!0);const s=Si(a,ahe);for(const u of["background","lineBreak","padding"])a[u]&&(s[u]=Ai(a[u]));for(const u of EI)a[u]&&(s[u]=li(a[u]));for(const u of KI)a[u]&&(s[u]=OP(a[u]));for(const u of pP)a[u]&&(s[u]=li(a[u]));return a.legend&&(s.legend=li(a.legend)),a.scale&&(s.scale=li(a.scale)),a.style&&(s.style=ohe(a.style)),a.title&&(s.title=li(a.title)),a.view&&(s.view=li(a.view)),s}const she=new Set(["view",...Pfe]),uhe=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],lhe=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},Wfe);function che(e){e=be(e);for(const t of uhe)delete e[t];if(e.axis)for(const t in e.axis)Th(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of Bde)delete e.legend[t];if(e.mark){for(const t of _I)delete e.mark[t];e.mark.tooltip&&Q(e.mark.tooltip)&&delete e.mark.tooltip}e.params&&(e.signals=(e.signals||[]).concat(yP(e.params)),delete e.params);for(const t of she){for(const i of _I)delete e[t][i];const n=lhe[t];if(n)for(const i of n)delete e[t][i];dhe(e,t)}for(const t of zde())delete e[t];fhe(e);for(const t in e)Q(e[t])&&Ze(e[t])&&delete e[t];return Ze(e)?void 0:e}function fhe(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=ML(e.title);Ze(t)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),t)),Ze(n)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),n)),Ze(i)?delete e.title:e.title=i}function dhe(e,t,n,i){const r=i?e[t][i]:e[t];t==="view"&&(n="cell");const o=Object.assign(Object.assign({},r),e.style[n!=null?n:t]);Ze(o)||(e.style[n!=null?n:t]=o),i||delete e[t]}function x1(e){return"layer"in e}function hhe(e){return"repeat"in e}function ghe(e){return!P(e.repeat)&&e.repeat.layer}var phe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class GO{map(t,n){return r1(t)?this.mapFacet(t,n):hhe(t)?this.mapRepeat(t,n):WO(t)?this.mapHConcat(t,n):y1(t)?this.mapVConcat(t,n):qO(t)?this.mapConcat(t,n):this.mapLayerOrUnit(t,n)}mapLayerOrUnit(t,n){if(x1(t))return this.mapLayer(t,n);if(ta(t))return this.mapUnit(t,n);throw new Error(YE(t))}mapLayer(t,n){return Object.assign(Object.assign({},t),{layer:t.layer.map(i=>this.mapLayerOrUnit(i,n))})}mapHConcat(t,n){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(i=>this.map(i,n))})}mapVConcat(t,n){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(i=>this.map(i,n))})}mapConcat(t,n){const{concat:i}=t,r=phe(t,["concat"]);return Object.assign(Object.assign({},r),{concat:i.map(o=>this.map(o,n))})}mapFacet(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}mapRepeat(t,n){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,n)})}}const mhe={zero:1,center:1,normalize:1};function yhe(e){return e in mhe}const vhe=new Set([vI,J0,K0,e1,Z0,pO,mO,Q0,bI,gO]),bhe=new Set([J0,K0,vI]);function Cc(e){return G(e)&&SO(e)==="quantitative"&&!e.bin}function AP(e,t){var n,i;const r=t==="x"?"y":"radius",o=e[t],a=e[r];if(G(o)&&G(a))if(Cc(o)&&Cc(a)){if(o.stack)return t;if(a.stack)return r;const s=G(o)&&!!o.aggregate,u=G(a)&&!!a.aggregate;if(s!==u)return s?t:r;{const l=(n=o.scale)===null||n===void 0?void 0:n.type,c=(i=a.scale)===null||i===void 0?void 0:i.type;if(l&&l!=="linear")return r;if(c&&c!=="linear")return t}}else{if(Cc(o))return t;if(Cc(a))return r}else{if(Cc(o))return t;if(Cc(a))return r}}function xhe(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function kP(e,t,n={}){var i,r;const o=ho(e)?e.type:e;if(!vhe.has(o))return null;const a=AP(t,"x")||AP(t,"theta");if(!a)return null;const s=t[a],u=G(s)?V(s,{}):void 0,l=xhe(a),c=[],f=new Set;if(t[l]){const g=t[l],p=G(g)?V(g,{}):void 0;p&&p!==u&&(c.push(l),f.add(p));const m=l==="x"?"xOffset":"yOffset",y=t[m],v=G(y)?V(y,{}):void 0;v&&v!==u&&(c.push(m),f.add(v))}const d=Cle.reduce((g,p)=>{if(p!=="tooltip"&&ku(t,p)){const m=t[p];for(const y of J(m)){const v=yo(y);if(v.aggregate)continue;const x=V(v,{});(!x||!f.has(x))&&g.push({channel:p,fieldDef:v})}}return g},[]);let h;if(s.stack!==void 0?ga(s.stack)?h=s.stack?"zero":null:h=s.stack:bhe.has(o)&&(h="zero"),!h||!yhe(h)||DO(t)&&d.length===0)return null;if(((i=s==null?void 0:s.scale)===null||i===void 0?void 0:i.type)&&((r=s==null?void 0:s.scale)===null||r===void 0?void 0:r.type)!==ci.LINEAR){if(n.disallowNonLinearStack)return null;q(Hce(s.scale.type))}return ye(t[Jo(a)])?(s.stack!==void 0&&q(Wce(a)),null):(G(s)&&s.aggregate&&!zle.has(s.aggregate)&&q(Gce(s.aggregate)),{groupbyChannels:c,groupbyFields:f,fieldChannel:a,impute:s.impute===null?!1:cs(o),stackBy:d,offset:h})}var CP=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function whe(e){const t=CP(e,["point","line"]);return U(t).length>1?t:t.type}function _he(e){for(const t of["line","area","rule","trail"])e[t]&&(e=Object.assign(Object.assign({},e),{[t]:Si(e[t],["point","line"])}));return e}function VO(e,t={},n){return e.point==="transparent"?{opacity:0}:e.point?Q(e.point)?e.point:{}:e.point!==void 0?null:t.point||n.shape?Q(t.point)?t.point:{}:void 0}function TP(e,t={}){return e.line?e.line===!0?{}:e.line:e.line!==void 0?null:t.line?t.line===!0?{}:t.line:void 0}class Ehe{constructor(){this.name="path-overlay"}hasMatchingType(t,n){if(ta(t)){const{mark:i,encoding:r}=t,o=ho(i)?i:{type:i};switch(o.type){case"line":case"rule":case"trail":return!!VO(o,n[o.type],r);case"area":return!!VO(o,n[o.type],r)||!!TP(o,n[o.type])}}return!1}run(t,n,i){const{config:r}=n,{params:o,projection:a,mark:s,encoding:u}=t,l=CP(t,["params","projection","mark","encoding"]),c=h1(u,r),f=ho(s)?s:{type:s},d=VO(f,r[f.type],c),h=f.type==="area"&&TP(f,r[f.type]),g=[Object.assign(Object.assign({},o?{params:o}:{}),{mark:whe(Object.assign(Object.assign({},f.type==="area"&&f.opacity===void 0&&f.fillOpacity===void 0?{opacity:.7}:{}),f)),encoding:Si(c,["shape"])})],p=kP(f,c);let m=c;if(p){const{fieldChannel:y,offset:v}=p;m=Object.assign(Object.assign({},c),{[y]:Object.assign(Object.assign({},c[y]),v?{stack:v}:{})})}return h&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},pc(f,["clip","interpolate","tension","tooltip"])),h),encoding:m})),d&&g.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},pc(f,["clip","tooltip"])),d),encoding:m})),i(Object.assign(Object.assign({},l),{layer:g}),Object.assign(Object.assign({},n),{config:_he(r)}))}}var Ohe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function She(e,t){return t?Ah(e)?NP(e,t):FP(e,t):e}function YO(e,t){return t?NP(e,t):e}function XO(e,t,n){const i=t[e];if(ade(i)){if(i.repeat in n)return Object.assign(Object.assign({},t),{[e]:n[i.repeat]});q(ace(i.repeat));return}return t}function FP(e,t){if(e=XO("field",e,t),e!==void 0){if(e===null)return null;if(OO(e)&&go(e.sort)){const n=XO("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function MP(e,t){if(G(e))return FP(e,t);{const n=XO("datum",e,t);return n!==e&&!n.type&&(n.type="nominal"),n}}function DP(e,t){if(ye(e)){const n=MP(e,t);if(n)return n;if(o1(e))return{condition:e.condition}}else{if(kh(e)){const n=MP(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):Ohe(e,["condition"])}return e}}function NP(e,t){const n={};for(const i in e)if(re(e,i)){const r=e[i];if(P(r))n[i]=r.map(o=>DP(o,t)).filter(o=>o);else{const o=DP(r,t);o!==void 0&&(n[i]=o)}}return n}class Ahe{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(ta(t)){const{encoding:n,mark:i}=t;if(i==="line"||ho(i)&&i.type==="line")for(const r of Sle){const o=bu(r),a=n[o];if(n[r]&&(G(a)&&!zn(a.bin)||po(a)))return!0}}return!1}run(t,n,i){const{encoding:r,mark:o}=t;return q(kce(!!r.x2,!!r.y2)),i(Object.assign(Object.assign({},t),{mark:Q(o)?Object.assign(Object.assign({},o),{type:"rule"}):"rule"}),n)}}var fs=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class khe extends GO{constructor(){super(...arguments);this.nonFacetUnitNormalizers=[Tde,Dde,Pde,new Ehe,new Ahe]}map(t,n){if(ta(t)){const i=ku(t.encoding,Ho),r=ku(t.encoding,Go),o=ku(t.encoding,P0);if(i||r||o)return this.mapFacetedUnit(t,n)}return super.map(t,n)}mapUnit(t,n){const{parentEncoding:i,parentProjection:r}=n,o=YO(t.encoding,n.repeater),a=Object.assign(Object.assign({},t),o?{encoding:o}:{});if(i||r)return this.mapUnitWithParentEncodingOrProjection(a,n);const s=this.mapLayerOrUnit.bind(this);for(const u of this.nonFacetUnitNormalizers)if(u.hasMatchingType(a,n.config))return u.run(a,n,s);return a}mapRepeat(t,n){return ghe(t)?this.mapLayerRepeat(t,n):this.mapNonLayerRepeat(t,n)}mapLayerRepeat(t,n){const{repeat:i,spec:r}=t,o=fs(t,["repeat","spec"]),{row:a,column:s,layer:u}=i,{repeater:l={},repeaterPrefix:c=""}=n;return a||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},a?{row:a}:{}),s?{column:s}:{}),spec:{repeat:{layer:u},spec:r}}),n):Object.assign(Object.assign({},o),{layer:u.map(f=>{const d=Object.assign(Object.assign({},l),{layer:f}),h=`${(r.name||"")+c}child__layer_${ht(f)}`,g=this.mapLayerOrUnit(r,Object.assign(Object.assign({},n),{repeater:d,repeaterPrefix:h}));return g.name=h,g})})}mapNonLayerRepeat(t,n){var i;const{repeat:r,spec:o,data:a}=t,s=fs(t,["repeat","spec","data"]);!P(r)&&t.columns&&(t=Si(t,["columns"]),q(GL("repeat")));const u=[],{repeater:l={},repeaterPrefix:c=""}=n,f=!P(r)&&r.row||[l?l.row:null],d=!P(r)&&r.column||[l?l.column:null],h=P(r)&&r||[l?l.repeat:null];for(const p of h)for(const m of f)for(const y of d){const v={repeat:p,row:m,column:y,layer:l.layer},x=(o.name||"")+c+"child__"+(P(r)?`${ht(p)}`:(r.row?`row_${ht(m)}`:"")+(r.column?`column_${ht(y)}`:"")),b=this.map(o,Object.assign(Object.assign({},n),{repeater:v,repeaterPrefix:x}));b.name=x,u.push(Si(b,["data"]))}const g=P(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:(i=o.data)!==null&&i!==void 0?i:a,align:"all"},s),{columns:g,concat:u})}mapFacet(t,n){const{facet:i}=t;return Ah(i)&&t.columns&&(t=Si(t,["columns"]),q(GL("facet"))),super.mapFacet(t,n)}mapUnitWithParentEncodingOrProjection(t,n){const{encoding:i,projection:r}=t,{parentEncoding:o,parentProjection:a,config:s}=n,u=jP({parentProjection:a,projection:r}),l=RP({parentEncoding:o,encoding:YO(i,n.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),u?{projection:u}:{}),l?{encoding:l}:{}),{config:s})}mapFacetedUnit(t,n){const i=t.encoding,{row:r,column:o,facet:a}=i,s=fs(i,["row","column","facet"]),{mark:u,width:l,projection:c,height:f,view:d,params:h,encoding:g}=t,p=fs(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:m,layout:y}=this.getFacetMappingAndLayout({row:r,column:o,facet:a},n),v=YO(s,n.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),y),{facet:m,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{width:l}:{}),f?{height:f}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:v}),h?{params:h}:{})}),n)}getFacetMappingAndLayout(t,n){var i;const{row:r,column:o,facet:a}=t;if(r||o){a&&q(Sce([...r?[Ho]:[],...o?[Go]:[]]));const s={},u={};for(const l of[Ho,Go]){const c=t[l];if(c){const f=fs(c,["align","center","spacing","columns"]);s[l]=f;for(const d of["align","center","spacing"])c[d]!==void 0&&((i=u[d])!==null&&i!==void 0||(u[d]={}),u[d][l]=c[d])}}return{facetMapping:s,layout:u}}else{const{align:s,center:u,spacing:l,columns:c}=a,f=fs(a,["align","center","spacing","columns"]);return{facetMapping:She(f,n.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},s?{align:s}:{}),u?{center:u}:{}),l?{spacing:l}:{}),c?{columns:c}:{})}}}mapLayer(t,n){var{parentEncoding:i,parentProjection:r}=n,o=fs(n,["parentEncoding","parentProjection"]);const{encoding:a,projection:s}=t,u=fs(t,["encoding","projection"]),l=Object.assign(Object.assign({},o),{parentEncoding:RP({parentEncoding:i,encoding:a,layer:!0}),parentProjection:jP({parentProjection:r,projection:s})});return super.mapLayer(u,l)}}function RP({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...U(e),...U(t)]);for(const o of r){const a=t[o],s=e[o];if(ye(a)){const u=Object.assign(Object.assign({},s),a);i[o]=u}else kh(a)?i[o]=Object.assign(Object.assign({},a),{condition:Object.assign(Object.assign({},s),a.condition)}):a||a===null?i[o]=a:(n||_r(s)||oe(s)||ye(s)||P(s))&&(i[o]=s)}}else i=t;return!i||Ze(i)?void 0:i}function jP(e){const{parentProjection:t,projection:n}=e;return t&&n&&q(dce({parentProjection:t,projection:n})),n!=null?n:t}function KO(e){return"filter"in e}function Che(e){return(e==null?void 0:e.stop)!==void 0}function $P(e){return"lookup"in e}function The(e){return"data"in e}function Fhe(e){return"param"in e}function Mhe(e){return"pivot"in e}function Dhe(e){return"density"in e}function Nhe(e){return"quantile"in e}function Rhe(e){return"regression"in e}function jhe(e){return"loess"in e}function $he(e){return"sample"in e}function Lhe(e){return"window"in e}function Ihe(e){return"joinaggregate"in e}function Phe(e){return"flatten"in e}function zhe(e){return"calculate"in e}function LP(e){return"bin"in e}function Bhe(e){return"impute"in e}function Uhe(e){return"timeUnit"in e}function qhe(e){return"aggregate"in e}function Whe(e){return"stack"in e}function Hhe(e){return"fold"in e}function Ghe(e){return e.map(t=>KO(t)?{filter:gc(t.filter,bfe)}:t)}var ds=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class Vhe extends GO{map(t,n){var i,r;return(i=n.emptySelections)!==null&&i!==void 0||(n.emptySelections={}),(r=n.selectionPredicates)!==null&&r!==void 0||(n.selectionPredicates={}),t=IP(t,n),super.map(t,n)}mapLayerOrUnit(t,n){if(t=IP(t,n),t.encoding){const i={};for(const[r,o]of Za(t.encoding))i[r]=PP(o,n);t=Object.assign(Object.assign({},t),{encoding:i})}return super.mapLayerOrUnit(t,n)}mapUnit(t,n){const i=t,{selection:r}=i,o=ds(i,["selection"]);return r?Object.assign(Object.assign({},o),{params:Za(r).map(([a,s])=>{var u;const l=s,{init:c,bind:f,empty:d}=l,h=ds(l,["init","bind","empty"]);h.type==="single"?(h.type="point",h.toggle=!1):h.type==="multi"&&(h.type="point"),n.emptySelections[a]=d!=="none";for(const g of En((u=n.selectionPredicates[a])!==null&&u!==void 0?u:{}))g.empty=d!=="none";return{name:a,value:c,select:h,bind:f}})}):t}}function IP(e,t){const{transform:n}=e,i=ds(e,["transform"]);if(n){const r=n.map(o=>{if(KO(o))return{filter:JO(o,t)};if(LP(o)&&xu(o.bin))return Object.assign(Object.assign({},o),{bin:zP(o.bin)});if($P(o)){const a=o.from,{selection:s}=a,u=ds(a,["selection"]);return s?Object.assign(Object.assign({},o),{from:Object.assign({param:s},u)}):o}return o});return Object.assign(Object.assign({},i),{transform:r})}return e}function PP(e,t){var n,i;const r=be(e);if(G(r)&&xu(r.bin)&&(r.bin=zP(r.bin)),Au(r)&&((i=(n=r.scale)===null||n===void 0?void 0:n.domain)===null||i===void 0?void 0:i.selection)){const o=r.scale.domain,{selection:a}=o,s=ds(o,["selection"]);r.scale.domain=Object.assign(Object.assign({},s),a?{param:a}:{})}if(o1(r))if(P(r.condition))r.condition=r.condition.map(o=>{const{selection:a,param:s,test:u}=o,l=ds(o,["selection","param","test"]);return s?o:Object.assign(Object.assign({},l),{test:JO(o,t)})});else{const o=PP(r.condition,t),{selection:a,param:s,test:u}=o,l=ds(o,["selection","param","test"]);r.condition=s?r.condition:Object.assign(Object.assign({},l),{test:JO(r.condition,t)})}return r}function zP(e){const t=e.extent;if(t==null?void 0:t.selection){const{selection:n}=t,i=ds(t,["selection"]);return Object.assign(Object.assign({},e),{extent:Object.assign(Object.assign({},i),{param:n})})}return e}function JO(e,t){const n=i=>gc(i,r=>{var o,a,s;const u=(o=t.emptySelections[r])!==null&&o!==void 0?o:!0,l={param:r,empty:u};return(a=(s=t.selectionPredicates)[r])!==null&&a!==void 0||(s[r]=[]),t.selectionPredicates[r].push(l),l});return e.selection?n(e.selection):gc(e.test||e.filter,i=>i.selection?n(i.selection):i)}class QO extends GO{map(t,n){var i;const r=(i=n.selections)!==null&&i!==void 0?i:[];if(t.params&&!ta(t)){const o=[];for(const a of t.params)UO(a)?r.push(a):o.push(a);t.params=o}return n.selections=r,super.map(t,BP(t,n))}mapUnit(t,n){var i;const r=n.selections;if(!r||!r.length)return t;const o=((i=n.path)!==null&&i!==void 0?i:[]).concat(t.name),a=[];for(const s of r)if(!s.views||!s.views.length)a.push(s);else for(const u of s.views)(K(u)&&(u===t.name||o.indexOf(u)>=0)||P(u)&&u.map(l=>o.indexOf(l)).every((l,c,f)=>l!==-1&&(c===0||l>f[c-1])))&&a.push(s);return a.length&&(t.params=a),t}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=QO.prototype[e];QO.prototype[e]=function(n,i){return t.call(this,n,BP(n,i))}}function BP(e,t){var n;return e.name?Object.assign(Object.assign({},t),{path:((n=t.path)!==null&&n!==void 0?n:[]).concat(e.name)}):t}function UP(e,t){t===void 0&&(t=SP(e.config));const n=Jhe(e,t),{width:i,height:r}=e,o=Qhe(n,{width:i,height:r,autosize:e.autosize},t);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const Yhe=new khe,Xhe=new Vhe,Khe=new QO;function Jhe(e,t={}){const n={config:t};return Khe.map(Yhe.map(Xhe.map(e,n),n),n)}function qP(e){return K(e)?{type:e}:e!=null?e:{}}function Qhe(e,t,n){let{width:i,height:r}=t;const o=ta(e)||x1(e),a={};o?i=="container"&&r=="container"?(a.type="fit",a.contains="padding"):i=="container"?(a.type="fit-x",a.contains="padding"):r=="container"&&(a.type="fit-y",a.contains="padding"):(i=="container"&&(q(BL("width")),i=void 0),r=="container"&&(q(BL("height")),r=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?qP(n.autosize):{}),qP(e.autosize));if(s.type==="fit"&&!o&&(q(Kle),s.type="pad"),i=="container"&&!(s.type=="fit"||s.type=="fit-x")&&q(UL("width")),r=="container"&&!(s.type=="fit"||s.type=="fit-y")&&q(UL("height")),!no(s,{type:"pad"}))return s}function Zhe(e){return e==="fit"||e==="fit-x"||e==="fit-y"}function ege(e){return e?`fit-${W0(e)}`:"fit"}const tge=["background","padding"];function WP(e,t){const n={};for(const i of tge)e&&e[i]!==void 0&&(n[i]=Ai(e[i]));return t&&(n.params=e.params),n}class ia{constructor(t={},n={}){this.explicit=t,this.implicit=n}clone(){return new ia(be(this.explicit),be(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return At(this.explicit[t],this.implicit[t])}getWithExplicit(t){return this.explicit[t]!==void 0?{explicit:!0,value:this.explicit[t]}:this.implicit[t]!==void 0?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:n,explicit:i}){n!==void 0&&this.set(t,n,i)}set(t,n,i){return delete this[i?"implicit":"explicit"][t],this[i?"explicit":"implicit"][t]=n,this}copyKeyFromSplit(t,{explicit:n,implicit:i}){n[t]!==void 0?this.set(t,n[t],!0):i[t]!==void 0&&this.set(t,i[t],!1)}copyKeyFromObject(t,n){n[t]!==void 0&&this.set(t,n[t],!0)}copyAll(t){for(const n of U(t.combine())){const i=t.getWithExplicit(n);this.setWithExplicit(n,i)}}}function bo(e){return{explicit:!0,value:e}}function Ci(e){return{explicit:!1,value:e}}function HP(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:w1(t,n,i,r)}}function w1(e,t,n,i){return e.explicit&&t.explicit&&q(Lce(n,i,e.value,t.value)),e}function hs(e,t,n,i,r=w1){return e===void 0||e.value===void 0?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:no(e.value,t.value)?e:r(e,t,n,i)}class nge extends ia{constructor(t={},n={},i=!1){super(t,n);this.explicit=t,this.implicit=n,this.parseNothing=i}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Tc(e){return"url"in e}function Mh(e){return"values"in e}function GP(e){return"name"in e&&!Tc(e)&&!Mh(e)&&!gs(e)}function gs(e){return e&&(VP(e)||YP(e)||ZO(e))}function VP(e){return"sequence"in e}function YP(e){return"sphere"in e}function ZO(e){return"graticule"in e}var at;(function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup"})(at||(at={}));var ige=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Fc(e,t=!0,n=dn){if(P(e)){const i=e.map(r=>Fc(r,t,n));return t?`[${i.join(", ")}]`:i}else if(_u(e))return n(t?Eh(e):ufe(e));return t?n(rt(e)):e}function rge(e,t){var n;for(const i of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const r=i.name;let o=`${r}${ys}, ${i.resolve==="global"?"true":`{unit: ${Nc(e)}}`}`;for(const a of A1)!a.defined(i)||(a.signals&&(t=a.signals(e,i,t)),a.modifyExpr&&(o=a.modifyExpr(e,i,o)));t.push({name:r+Lge,on:[{events:{signal:i.name+ys},update:`modify(${H(i.name+Cu)}, ${o})`}]})}return eS(t)}function oge(e,t){if(e.component.selection&&U(e.component.selection).length){const n=H(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Ja("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return eS(t)}function age(e,t){var n;let i=!1;for(const r of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=r.name,a=H(o+Cu);if(t.filter(u=>u.name===o).length===0){const u=r.resolve==="global"?"union":r.resolve,l=r.type==="point"?", true, true)":")";t.push({name:r.name,update:`${y6}(${a}, ${H(u)}${l}`})}i=!0;for(const u of A1)u.defined(r)&&u.topLevelSignals&&(t=u.topLevelSignals(e,r,t))}return i&&t.filter(o=>o.name==="unit").length===0&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),eS(t)}function sge(e,t){var n;const i=[...t];for(const r of En((n=e.component.selection)!==null&&n!==void 0?n:{})){const o={name:r.name+Cu};if(r.init){const s=r.project.items.map(u=>ige(u,["signals"]));o.values=r.init.map(u=>({unit:Nc(e,{escape:!1}),fields:s,values:Fc(u,!1)}))}i.filter(s=>s.name===r.name+Cu).length||i.push(o)}return i}function XP(e,t){var n;for(const i of En((n=e.component.selection)!==null&&n!==void 0?n:{}))for(const r of A1)r.defined(i)&&r.marks&&(t=r.marks(e,i,t));return t}function uge(e,t){for(const n of e.children)kt(n)&&(t=XP(n,t));return t}function lge(e,t,n,i){const r=_6(e,t.param,t);return{signal:ki(n.get("type"))&&P(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r}}function eS(e){return e.map(t=>(t.on&&!t.on.length&&delete t.on,t))}class et{constructor(t,n){this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,n){if(this._children.includes(t)){q(lce);return}n!==void 0?this._children.splice(n,0,t):this._children.push(t)}removeChild(t){const n=this._children.indexOf(t);return this._children.splice(n,1),n}remove(){let t=this._parent.removeChild(this);for(const n of this._children)n._parent=this._parent,this._parent.addChild(n,t++)}insertAsParentOf(t){const n=t.parent;n.removeChild(this),this.parent=n,t.parent=this}swapWithParent(){const t=this._parent,n=t.parent;for(const i of this._children)i.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}class qn extends et{constructor(t,n,i,r){super(t,n);this.type=i,this.refCounts=r,this._source=this._name=n,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return this._hash===void 0&&(this._hash=`Output ${gL()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var KP=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class xo extends et{constructor(t,n){super(t);this.formula=n}clone(){return new xo(null,be(this.formula))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o)=>{const{field:a,timeUnit:s}=o;if(s){const u=V(o,{forAs:!0});r[Me({as:u,field:a,timeUnit:s})]={as:u,field:a,timeUnit:s}}return r},{});return Ze(i)?null:new xo(t,i)}static makeFromTransform(t,n){const i=Object.assign({},n),{timeUnit:r}=i,o=KP(i,["timeUnit"]),a=Bn(r),s=Object.assign(Object.assign({},o),{timeUnit:a});return new xo(t,{[Me(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const n in t.formula)this.formula[n]||(this.formula[n]=t.formula[n]);for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}removeFormulas(t){const n={};for(const[i,r]of Za(this.formula))t.has(r.as)||(n[i]=r);this.formula=n}producedFields(){return new Set(En(this.formula).map(t=>t.as))}dependentFields(){return new Set(En(this.formula).map(t=>t.field))}hash(){return`TimeUnit ${Me(this.formula)}`}assemble(){const t=[];for(const n of En(this.formula)){const{field:i,as:r,timeUnit:o}=n,a=Bn(o),{unit:s,utc:u}=a,l=KP(a,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:Wi(i),type:"timeunit"},s?{units:tO(s)}:{}),u?{timezone:"utc"}:{}),l),{as:[r,`${r}_end`]}))}return t}}var cge=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Dh="_tuple_fields";class fge{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}const dge={defined:()=>!0,parse:(e,t,n)=>{var i;const r=t.name,o=(i=t.project)!==null&&i!==void 0?i:t.project=new fge,a={},s={},u=new Set,l=(p,m)=>{const y=m==="visual"?p.channel:p.field;let v=ht(`${r}_${y}`);for(let x=1;u.has(v);x++)v=ht(`${r}_${y}_${x}`);return u.add(v),{[m]:v}},c=t.type,f=e.config.selection[c],d=n.value!==void 0?J(n.value):null;let{fields:h,encodings:g}=Q(n.select)?n.select:{};if(!h&&!g&&d){for(const p of d)if(!!Q(p))for(const m of U(p))Ole(m)?(g||(g=[])).push(m):c==="interval"?(q(oce),g=f.encodings):(h||(h=[])).push(m)}!h&&!g&&(g=f.encodings,"fields"in f&&(h=f.fields));for(const p of g!=null?g:[]){const m=e.fieldDef(p);if(m){let y=m.field;if(m.aggregate){q(Jle(p,m.aggregate));continue}else if(!y){q(WL(p));continue}if(m.timeUnit){y=e.vgField(p);const v={timeUnit:m.timeUnit,as:y,field:m.field};s[Me(v)]=v}if(!a[y]){let v="E";if(c==="interval"){const b=e.getScaleComponent(p).get("type");ki(b)&&(v="R")}else m.bin&&(v="R-RE");const x={field:y,channel:p,type:v};x.signals=Object.assign(Object.assign({},l(x,"data")),l(x,"visual")),o.items.push(a[y]=x),o.hasField[y]=o.hasChannel[p]=a[y]}}else q(WL(p))}for(const p of h!=null?h:[]){if(o.hasField[p])continue;const m={type:"E",field:p};m.signals=Object.assign({},l(m,"data")),o.items.push(m),o.hasField[p]=m}d&&(t.init=d.map(p=>o.items.map(m=>Q(p)?p[m.channel]!==void 0?p[m.channel]:p[m.field]:p))),Ze(s)||(o.timeUnit=new xo(null,s))},signals:(e,t,n)=>{const i=t.name+Dh;return n.filter(o=>o.name===i).length>0?n:n.concat({name:i,value:t.project.items.map(o=>{const a=cge(o,["signals","hasLegend"]);return a.field=Wi(a.field),a})})}},ps={defined:e=>e.type==="interval"&&e.resolve==="global"&&e.bind&&e.bind==="scales",parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!as(r))continue;const o=e.getScaleComponent(r),a=o?o.get("type"):void 0;if(!o||!ki(a)){q(ece);continue}o.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(a=>n.filter(s=>s.name===a.signals.data).length===0);if(!e.parent||nS(e)||i.length===0)return n;const r=n.filter(a=>a.name===t.name)[0];let o=r.update;if(o.indexOf(y6)>=0)r.update=`{${i.map(a=>`${H(Wi(a.field))}: ${a.signals.data}`).join(", ")}}`;else{for(const a of i){const s=`${H(Wi(a.field))}: ${a.signals.data}`;o.includes(s)||(o=`${o.substring(0,o.length-1)}, ${s}}`)}r.update=o}return n.concat(i.map(a=>({name:a.signals.data})))},signals:(e,t,n)=>{if(e.parent&&!nS(e))for(const i of t.scales){const r=n.filter(o=>o.name===i.signals.data)[0];r.push="outer",delete r.value,delete r.update}return n}};function tS(e,t){return`domain(${H(e.scaleName(t))})`}function nS(e){var t;return e.parent&&zc(e.parent)&&((t=!e.parent.parent)!==null&&t!==void 0?t:nS(e.parent.parent))}var hge=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};const Mc="_brush",iS="_scale_trigger",gge={defined:e=>e.type==="interval",signals:(e,t,n)=>{const i=t.name,r=i+Dh,o=ps.defined(t),a=t.init?t.init[0]:null,s=[],u=[];if(t.translate&&!o){const c=`!event.item || event.item.mark.name !== ${H(i+Mc)}`;JP(t,(f,d)=>{var h,g;const p=J((h=(g=d.between[0]).filter)!==null&&h!==void 0?h:g.filter=[]);return p.includes(c)||p.push(c),f})}t.project.items.forEach((c,f)=>{const d=c.channel;if(d!==pt&&d!==Wt){q("Interval selections only support x and y encoding channels.");return}const h=a?a[f]:null,g=pge(e,t,c,h),p=c.signals.data,m=c.signals.visual,y=H(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),x=ki(v)?"+":"";n.push(...g),s.push(p),u.push({scaleName:e.scaleName(d),expr:`(!isArray(${p}) || (${x}invert(${y}, ${m})[0] === ${x}${p}[0] && ${x}invert(${y}, ${m})[1] === ${x}${p}[1]))`})}),!o&&u.length&&n.push({name:i+iS,value:{},on:[{events:u.map(c=>({scale:c.scaleName})),update:`${u.map(c=>c.expr).join(" && ")} ? ${i+iS} : {}`}]});const l=`unit: ${Nc(e)}, fields: ${r}, values`;return n.concat(Object.assign(Object.assign({name:i+ys},a?{init:`{${l}: ${Fc(a)}}`}:{}),s.length?{on:[{events:[{signal:s.join(" || ")}],update:`${s.join(" && ")} ? {${l}: [${s}]} : null`}]}:{}))},marks:(e,t,n)=>{const i=t.name,{x:r,y:o}=t.project.hasChannel,a=r==null?void 0:r.signals.visual,s=o==null?void 0:o.signals.visual,u=`data(${H(t.name+Cu)})`;if(ps.defined(t)||!r&&!o)return n;const l={x:r!==void 0?{signal:`${a}[0]`}:{value:0},y:o!==void 0?{signal:`${s}[0]`}:{value:0},x2:r!==void 0?{signal:`${a}[1]`}:{field:{group:"width"}},y2:o!==void 0?{signal:`${s}[1]`}:{field:{group:"height"}}};if(t.resolve==="global")for(const m of U(l))l[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${Nc(e)}`},l[m]),{value:0}];const c=t.mark,{fill:f,fillOpacity:d,cursor:h}=c,g=hge(c,["fill","fillOpacity","cursor"]),p=U(g).reduce((m,y)=>(m[y]=[{test:[r!==void 0&&`${a}[0] !== ${a}[1]`,o!==void 0&&`${s}[0] !== ${s}[1]`].filter(v=>v).join(" && "),value:g[y]},{value:null}],m),{});return[{name:`${i+Mc}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:l}},...n,{name:i+Mc,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},h?{cursor:{value:h}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),p)}}]}};function pge(e,t,n,i){const r=n.channel,o=n.signals.visual,a=n.signals.data,s=ps.defined(t),u=H(e.scaleName(r)),l=e.getScaleComponent(r),c=l?l.get("type"):void 0,f=p=>`scale(${u}, ${p})`,d=e.getSizeSignalRef(r===pt?"width":"height").signal,h=`${r}(unit)`,g=JP(t,(p,m)=>[...p,{events:m.between[0],update:`[${h}, ${h}]`},{events:m,update:`[${o}[0], clamp(${h}, 0, ${d})]`}]);return g.push({events:{signal:t.name+iS},update:ki(c)?`[${f(`${a}[0]`)}, ${f(`${a}[1]`)}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},i?{init:Fc(i,!0,f)}:{value:[]}),{on:g}),Object.assign(Object.assign({name:a},i?{init:Fc(i)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}function JP(e,t){return e.events.reduce((n,i)=>i.between?t(n,i):(q(`${i} is not an ordered event stream for interval selections.`),n),[])}const mge={defined:e=>e.type==="point",signals:(e,t,n)=>{var i;const r=t.name,o=r+Dh,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",u=a.items.map(h=>{const g=e.fieldDef(h.channel);return(g==null?void 0:g.bin)?`[${s}[${H(e.vgField(h.channel,{}))}], ${s}[${H(e.vgField(h.channel,{binSuffix:"end"}))}]]`:`${s}[${H(h.field)}]`}).join(", "),l=`unit: ${Nc(e)}, fields: ${o}, values`,c=t.events,f=En((i=e.component.selection)!==null&&i!==void 0?i:{}).reduce((h,g)=>g.type==="interval"?h.concat(g.name+Mc):h,[]).map(h=>`indexof(item().mark.name, '${h}') < 0`).join(" && "),d=`datum && item().mark.marktype !== 'group'${f?` && ${f}`:""}`;return n.concat([{name:r+ys,on:c?[{events:c,update:`${d} ? {${l}: [${u}]} : null`,force:!0}]:[]}])}};function Dc(e,t,n,i){const r=o1(t)&&t.condition,o=i(t);if(r){const s=J(r).map(u=>{const l=i(u);if(ode(u)){const{param:c,empty:f}=u,d=w6(e,{param:c,empty:f});return Object.assign({test:d},l)}else{const c=k1(e,u.test);return Object.assign({test:c},l)}});return{[n]:[...s,...o!==void 0?[o]:[]]}}else return o!==void 0?{[n]:o}:{}}function rS(e,t="text"){const n=e.encoding[t];return Dc(e,n,t,i=>_1(i,e.config))}function _1(e,t,n="datum"){if(e){if(_r(e))return lt(e.value);if(ye(e)){const{format:i,formatType:r}=u1(e);return xO({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t})}}}function QP(e,t={}){const{encoding:n,markDef:i,config:r,stack:o}=e,a=n.tooltip;if(P(a))return{tooltip:e6({tooltip:a},o,r,t)};{const s=t.reactiveGeom?"datum.datum":"datum";return Dc(e,a,"tooltip",u=>{const l=_1(u,r,s);if(l)return l;if(u===null)return;let c=He("tooltip",i,r);if(c===!0&&(c={content:"encoding"}),K(c))return{value:c};if(Q(c))return oe(c)?c:c.content==="encoding"?e6(n,o,r,t):{signal:s}})}}function ZP(e,t,n,{reactiveGeom:i}={}){const r={},o=i?"datum.datum":"datum",a=[];function s(l,c){const f=bu(c),d=Vi(l)?l:Object.assign(Object.assign({},l),{type:e[f].type}),h=d.title||TO(d,n),g=J(h).join(", ");let p;if(rn(c)){const m=c==="x"?"x2":"y2",y=yo(e[m]);if(zn(d.bin)&&y){const v=V(d,{expr:o}),x=V(y,{expr:o}),{format:b,formatType:_}=u1(d);p=n1(v,x,b,_,n),r[m]=!0}else if(t&&t.fieldChannel===c&&t.offset==="normalize"){const{format:v,formatType:x}=u1(d);p=xO({fieldOrDatumDef:d,format:v,formatType:x,expr:o,config:n,normalizeStack:!0}).signal}}p!=null||(p=_1(d,n,o).signal),a.push({channel:c,key:g,value:p})}NO(e,(l,c)=>{G(l)?s(l,c):a1(l)&&s(l.condition,c)});const u={};for(const{channel:l,key:c,value:f}of a)!r[l]&&!u[c]&&(u[c]=f);return u}function e6(e,t,n,{reactiveGeom:i}={}){const r=ZP(e,t,n,{reactiveGeom:i}),o=Za(r).map(([a,s])=>`"${a}": ${s}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function yge(e){const{markDef:t,config:n}=e,i=He("aria",t,n);return i===!1?{}:Object.assign(Object.assign(Object.assign({},i?{aria:i}:{}),vge(e)),bge(e))}function vge(e){const{mark:t,markDef:n,config:i}=e;if(i.aria===!1)return{};const r=He("ariaRoleDescription",n,i);return r!=null?{ariaRoleDescription:{value:r}}:t in Vle?{}:{ariaRoleDescription:{value:t}}}function bge(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return Dc(e,o,"description",u=>_1(u,e.config));const a=He("description",n,i);if(a!=null)return{description:lt(a)};if(i.aria===!1)return{};const s=ZP(t,r,i);if(!Ze(s))return{description:{signal:Za(s).map(([u,l],c)=>`"${c>0?"; ":""}${u}: " + (${l})`).join(" + ")}}}function Gt(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;s===void 0&&(u!=null||(u=He(e,i,o,{vgChannel:a,ignoreVgConfig:!0})),u!==void 0&&(s=lt(u)));const l=r[e];return Dc(t,l,a!=null?a:e,c=>bO({channel:e,channelDef:c,markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s}))}function t6(e,t={filled:void 0}){var n,i,r,o;const{markDef:a,encoding:s,config:u}=e,{type:l}=a,c=(n=t.filled)!==null&&n!==void 0?n:He("filled",a,u),f=De(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=(r=(i=He(c===!0?"color":void 0,a,u,{vgChannel:"fill"}))!==null&&i!==void 0?i:u.mark[c===!0&&"color"])!==null&&r!==void 0?r:f,h=(o=He(c===!1?"color":void 0,a,u,{vgChannel:"stroke"}))!==null&&o!==void 0?o:u.mark[c===!1&&"color"],g=c?"fill":"stroke",p=Object.assign(Object.assign({},d?{fill:lt(d)}:{}),h?{stroke:lt(h)}:{});return a.color&&(c?a.fill:a.stroke)&&q(KL("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},p),Gt("color",e,{vgChannel:g,defaultValue:c?d:h})),Gt("fill",e,{defaultValue:s.fill?d:void 0})),Gt("stroke",e,{defaultValue:s.stroke?h:void 0}))}function xge(e){const{encoding:t,mark:n}=e,i=t.order;return!cs(n)&&_r(i)?Dc(e,i,"zindex",r=>lt(r.value)):{}}function Nh({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const o=`${e}Offset`,a=t[o],s=n[o];if((o==="xOffset"||o==="yOffset")&&s){const l=bO({channel:o,channelDef:s,markDef:t,config:i==null?void 0:i.config,scaleName:i.scaleName(o),scale:i.getScaleComponent(o),stack:null,defaultRef:lt(a),bandPosition:r});return{offsetType:"encoding",offset:l}}const u=t[o];return u?{offsetType:"visual",offset:u}:{}}function On(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:o,config:a,stack:s}=t,u=r[e],l=r[Jo(e)],c=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:h}=Nh({channel:e,markDef:o,encoding:r,model:t,bandPosition:.5}),g=oS({model:t,defaultPos:n,channel:e,scaleName:c,scale:f}),p=!u&&rn(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:wge({channel:e,channelDef:u,channel2Def:l,markDef:o,config:a,scaleName:c,scale:f,stack:s,offset:d,defaultRef:g,bandPosition:h==="encoding"?0:void 0});return p?{[i||e]:p}:void 0}function wge(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:o,markDef:a}=e;if(ye(n)&&r&&t===r.fieldChannel){if(G(n)){let s=n.bandPosition;if(s===void 0&&a.type==="text"&&(t==="radius"||t==="theta")&&(s=.5),s!==void 0)return t1({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:s,offset:o})}return Ou(n,i,{suffix:"end"},{offset:o})}return yO(e)}function oS({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:a}=e;return()=>{const s=bu(n),u=os(n),l=He(n,o,a,{vgChannel:u});if(l!==void 0)return Sh(n,l);switch(t){case"zeroOrMin":case"zeroOrMax":if(i){const c=r.get("type");if(!De([ci.LOG,ci.TIME,ci.UTC],c)){if(r.domainDefinitelyIncludesZero())return{scale:i,value:0}}}if(t==="zeroOrMin")return s==="y"?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${e.width.signal},${e.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const c=e[ui(n)];return Object.assign(Object.assign({},c),{mult:.5})}}}}const _ge={left:"x",center:"xc",right:"x2"},Ege={top:"y",middle:"yc",bottom:"y2"};function n6(e,t,n,i="middle"){if(e==="radius"||e==="theta")return os(e);const r=e==="x"?"align":"baseline",o=He(r,t,n);let a;return oe(o)?(q(Ace(r)),a=void 0):a=o,e==="x"?_ge[a||(i==="top"?"left":"center")]:Ege[a||i]}function E1(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?i6(e,t,{defaultPos:n,defaultPos2:i}):On(e,t,{defaultPos:n})}function i6(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,a=Jo(e),s=ui(e),u=Oge(t,i,a),l=u[s]?n6(e,r,o):os(e);return Object.assign(Object.assign({},On(e,t,{defaultPos:n,vgChannel:l})),u)}function Oge(e,t,n){const{encoding:i,mark:r,markDef:o,stack:a,config:s}=e,u=bu(n),l=ui(n),c=os(n),f=i[u],d=e.scaleName(u),h=e.getScaleComponent(u),{offset:g}=n in i||n in o?Nh({channel:n,markDef:o,encoding:i,model:e}):Nh({channel:u,markDef:o,encoding:i,model:e});if(!f&&(n==="x2"||n==="y2")&&(i.latitude||i.longitude)){const m=ui(n),y=e.markDef[m];return y!=null?{[m]:{value:y}}:{[c]:{field:e.getName(n)}}}const p=Sge({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:h,stack:a,offset:g,defaultRef:void 0});return p!==void 0?{[c]:p}:O1(n,o)||O1(n,{[n]:V0(n,o,s.style),[l]:V0(l,o,s.style)})||O1(n,s[r])||O1(n,s.mark)||{[c]:oS({model:e,defaultPos:t,channel:n,scaleName:d,scale:h})()}}function Sge({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return ye(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0)?Ou(t,o,{suffix:"start"},{offset:u}):yO({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:i,config:r,offset:u,defaultRef:l})}function O1(e,t){const n=ui(e),i=os(e);if(t[i]!==void 0)return{[i]:Sh(e,t[i])};if(t[e]!==void 0)return{[i]:Sh(e,t[e])};if(t[n]){const r=t[n];if(Oc(r))q(bce(n));else return{[n]:Sh(e,r)}}}function ms(e,t){var n,i;const{config:r,encoding:o,markDef:a}=e,s=a.type,u=Jo(t),l=ui(t),c=o[t],f=o[u],d=e.getScaleComponent(t),h=d?d.get("type"):void 0,g=a.orient,p=(i=(n=o[l])!==null&&n!==void 0?n:o.size)!==null&&i!==void 0?i:He("size",a,r,{vgChannel:l}),m=s==="bar"&&(t==="x"?g==="vertical":g==="horizontal");return G(c)&&(ot(c.bin)||zn(c.bin)||c.timeUnit&&!f)&&!(p&&!Oc(p))&&!Ht(h)?Cge({fieldDef:c,fieldDef2:f,channel:t,model:e}):(ye(c)&&Ht(h)||m)&&!f?kge(c,t,e):i6(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Age(e,t,n,i,r){if(Oc(r))if(n){const a=n.get("type");if(a==="band")return{scale:t,band:r.band};r.band!==1&&(q(Fce(a)),r=void 0)}else return{mult:r.band,field:{group:e}};else{if(oe(r))return r;if(r)return{value:r}}if(n){const a=n.get("range");if(ls(a)&&Je(a.step))return{value:a.step-2}}return{value:v1(i.view,e)-2}}function kge(e,t,n){const{markDef:i,encoding:r,config:o,stack:a}=n,s=i.orient,u=n.scaleName(t),l=n.getScaleComponent(t),c=ui(t),f=Jo(t),d=Ale(t),h=n.scaleName(d),g=s==="horizontal"&&t==="y"||s==="vertical"&&t==="x";let p;(r.size||i.size)&&(g?p=Gt("size",n,{vgChannel:c,defaultRef:lt(i.size)}):q(Rce(i.type)));const m=LI({channel:t,fieldDef:e,markDef:i,config:o,scaleType:l==null?void 0:l.get("type"),useVlSizeChannel:g});p=p||{[c]:Age(c,h||u,l,o,m)};const y=(l==null?void 0:l.get("type"))!=="band"||!("band"in p[c])?"middle":"top",v=n6(t,i,o,y),x=v==="xc"||v==="yc",{offset:b,offsetType:_}=Nh({channel:t,markDef:i,encoding:r,model:n,bandPosition:x?.5:0}),E=yO({channel:t,channelDef:e,markDef:i,config:o,scaleName:u,scale:l,stack:a,offset:b,defaultRef:oS({model:n,defaultPos:"mid",channel:t,scaleName:u,scale:l}),bandPosition:x?_==="encoding"?0:.5:oe(m)?{signal:`(1-${m})/2`}:Oc(m)?(1-m.band)/2:0});if(c)return Object.assign({[v]:E},p);{const w=os(f),O=p[c],S=b?Object.assign(Object.assign({},O),{offset:b}):O;return{[v]:E,[w]:P(E)?[E[0],Object.assign(Object.assign({},E[1]),{offset:S})]:Object.assign(Object.assign({},E),{offset:S})}}}function Rh(e,t,n,i,r){if(vL(e))return 0;const o=e==="x"||e==="y2"?-t/2:t/2;if(oe(n)||oe(r)||oe(i)){const a=ea(n),s=ea(r),u=ea(i),l=u?`${u} + `:"",c=a?`(${a} ? -1 : 1) * `:"",f=s?`(${s} + ${o})`:o;return{signal:l+c+f}}else return r=r||0,i+(n?-r-o:+r+o)}function Cge({fieldDef:e,fieldDef2:t,channel:n,model:i}){var r,o,a;const{config:s,markDef:u,encoding:l}=i,c=i.getScaleComponent(n),f=i.scaleName(n),d=c?c.get("type"):void 0,h=c.get("reverse"),g=LI({channel:n,fieldDef:e,markDef:u,config:s,scaleType:d}),p=(r=i.component.axes[n])===null||r===void 0?void 0:r[0],m=(o=p==null?void 0:p.get("translate"))!==null&&o!==void 0?o:.5,y=rn(n)&&(a=He("binSpacing",u,s))!==null&&a!==void 0?a:0,v=Jo(n),x=os(n),b=os(v),{offset:_}=Nh({channel:n,markDef:u,encoding:l,model:i,bandPosition:0}),E=oe(g)?{signal:`(1-${g.signal})/2`}:Oc(g)?(1-g.band)/2:.5;if(ot(e.bin)||e.timeUnit)return{[b]:r6({fieldDef:e,scaleName:f,bandPosition:E,offset:Rh(v,y,h,m,_)}),[x]:r6({fieldDef:e,scaleName:f,bandPosition:oe(E)?{signal:`1-${E.signal}`}:1-E,offset:Rh(n,y,h,m,_)})};if(zn(e.bin)){const w=Ou(e,f,{},{offset:Rh(v,y,h,m,_)});if(G(t))return{[b]:w,[x]:Ou(t,f,{},{offset:Rh(n,y,h,m,_)})};if(xu(e.bin)&&e.bin.step)return{[b]:w,[x]:{signal:`scale("${f}", ${V(e,{expr:"datum"})} + ${e.bin.step})`,offset:Rh(n,y,h,m,_)}}}q(tI(v))}function r6({fieldDef:e,scaleName:t,bandPosition:n,offset:i}){return t1({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i})}const Tge=new Set(["aria","width","height"]);function Yi(e,t){const{fill:n=void 0,stroke:i=void 0}=t.color==="include"?t6(e):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Fge(e.markDef,t)),o6(e,"fill",n)),o6(e,"stroke",i)),Gt("opacity",e)),Gt("fillOpacity",e)),Gt("strokeOpacity",e)),Gt("strokeWidth",e)),Gt("strokeDash",e)),xge(e)),QP(e)),rS(e,"href")),yge(e))}function o6(e,t,n){const{config:i,mark:r,markDef:o}=e;if(He("invalid",o,i)==="hide"&&n&&!cs(r)){const s=Mge(e,{invalid:!0,channels:H0});if(s)return{[t]:[{test:s,value:null},...J(n)]}}return n?{[t]:n}:{}}function Fge(e,t){return Gle.reduce((n,i)=>(!Tge.has(i)&&e[i]!==void 0&&t[i]!=="ignore"&&(n[i]=lt(e[i])),n),{})}function Mge(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&ki(u)&&(o[l]=!0)}return o},{}),r=U(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>vO(a,t)).join(` ${o} `)}}function aS(e){const{config:t,markDef:n}=e;if(He("invalid",n,t)){const r=Dge(e,{channels:co});if(r)return{defined:{signal:r}}}return{}}function Dge(e,{invalid:t=!1,channels:n}){const i=n.reduce((o,a)=>{const s=e.getScaleComponent(a);if(s){const u=s.get("type"),l=e.vgField(a,{expr:"datum"});l&&ki(u)&&(o[l]=!0)}return o},{}),r=U(i);if(r.length>0){const o=t?"||":"&&";return r.map(a=>vO(a,t)).join(` ${o} `)}}function a6(e,t){if(t!==void 0)return{[e]:lt(t)}}const sS="voronoi",s6={defined:e=>e.type==="point"&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(sS)},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,o=e.mark;if(cs(o))return q(Qle(o)),n;const a={name:e.getName(sS),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},QP(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((l,c)=>{var f;const d=(f=l.name)!==null&&f!==void 0?f:"";d===e.component.mark[0].name?s=c:d.indexOf(sS)>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}},u6={defined:e=>e.type==="point"&&e.resolve==="global"&&e.bind&&e.bind!=="scales"&&!zO(e.bind),parse:(e,t,n)=>v6(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,o=t.bind,a=t.init&&t.init[0],s=s6.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((u,l)=>{var c,f;const d=ht(`${i}_${u.field}`);n.filter(g=>g.name===d).length||n.unshift(Object.assign(Object.assign({name:d},a?{init:Fc(a[l])}:{value:null}),{on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${H(u.field)}] : null`}]:[],bind:(f=(c=o[u.field])!==null&&c!==void 0?c:o[u.channel])!==null&&f!==void 0?f:o}))}),n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.filter(l=>l.name===i+ys)[0],a=i+Dh,s=r.items.map(l=>ht(`${i}_${l.field}`)),u=s.map(l=>`${l} !== null`).join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},S1="_toggle",l6={defined:e=>e.type==="point"&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+S1,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+ys,i=t.name+S1;return`${i} ? null : ${n}, `+(t.resolve==="global"?`${i} ? null : true, `:`${i} ? null : {unit: ${Nc(e)}}, `)+`${i} ? ${n} : null`}},Nge={defined:e=>e.clear!==void 0&&e.clear!==!1,parse:(e,t)=>{t.clear&&(t.clear=K(t.clear)?Ja(t.clear,"view"):t.clear)},topLevelSignals:(e,t,n)=>{if(u6.defined(t))for(const i of t.project.items){const r=n.findIndex(o=>o.name===ht(`${t.name}_${i.field}`));r!==-1&&n[r].on.push({events:t.clear,update:"null"})}return n},signals:(e,t,n)=>{function i(r,o){r!==-1&&n[r].on&&n[r].on.push({events:t.clear,update:o})}if(t.type==="interval")for(const r of t.project.items){const o=n.findIndex(a=>a.name===r.signals.visual);if(i(o,"[0, 0]"),o===-1){const a=n.findIndex(s=>s.name===r.signals.data);i(a,"null")}}else{let r=n.findIndex(o=>o.name===t.name+ys);i(r,"null"),l6.defined(t)&&(r=n.findIndex(o=>o.name===t.name+S1),i(r,"false"))}return n}},c6={defined:e=>{const t=e.resolve==="global"&&e.bind&&zO(e.bind),n=e.project.items.length===1&&e.project.items[0].field!==Fh;return t&&!n&&q(tce),t&&n},parse:(e,t,n)=>{var i;const r=be(n);if(r.select=K(r.select)?{type:r.select,toggle:t.toggle}:Object.assign(Object.assign({},r.select),{toggle:t.toggle}),v6(t,r),Q(n.select)&&(n.select.on||n.select.clear)){const s='event.item && indexof(event.item.mark.role, "legend") < 0';for(const u of t.events)u.filter=J((i=u.filter)!==null&&i!==void 0?i:[]),u.filter.includes(s)||u.filter.push(s)}const o=BO(t.bind)?t.bind.legend:"click",a=K(o)?Ja(o,"view"):J(o);t.bind={legend:{merge:a}}},topLevelSignals:(e,t,n)=>{const i=t.name,r=BO(t.bind)&&t.bind.legend,o=a=>s=>{const u=be(s);return u.markname=a,u};for(const a of t.project.items){if(!a.hasLegend)continue;const s=`${ht(a.field)}_legend`,u=`${i}_${s}`;if(n.filter(c=>c.name===u).length===0){const c=r.merge.map(o(`${s}_symbols`)).concat(r.merge.map(o(`${s}_labels`))).concat(r.merge.map(o(`${s}_entries`)));n.unshift(Object.assign(Object.assign({name:u},t.init?{}:{value:null}),{on:[{events:c,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${u}`,force:!0}]}))}}return n},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(d=>d.name===i+ys),a=i+Dh,s=r.items.filter(d=>d.hasLegend).map(d=>ht(`${i}_${ht(d.field)}_legend`)),l=`${s.map(d=>`${d} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(d=>({signal:d})),update:l}):s.length>0&&(o.update=l,delete o.value,delete o.on);const c=n.find(d=>d.name===i+S1),f=BO(t.bind)&&t.bind.legend;return c&&(t.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:f})):c.on[0].events=f),n}};function Rge(e,t,n){var i,r,o,a;const s=(i=e.fieldDef(t))===null||i===void 0?void 0:i.field;for(const u of En((r=e.component.selection)!==null&&r!==void 0?r:{})){const l=(o=u.project.hasField[s])!==null&&o!==void 0?o:u.project.hasChannel[t];if(l&&c6.defined(u)){const c=(a=n.get("selections"))!==null&&a!==void 0?a:[];c.push(u.name),n.set("selections",c,!1),l.hasLegend=!0}}}const f6="_translate_anchor",d6="_translate_delta",jge={defined:e=>e.type==="interval"&&e.translate,signals:(e,t,n)=>{const i=t.name,r=ps.defined(t),o=i+f6,{x:a,y:s}=t.project.hasChannel;let u=Ja(t.translate,"scope");return r||(u=u.map(l=>(l.between[0].markname=i+Mc,l))),n.push({name:o,value:{},on:[{events:u.map(l=>l.between[0]),update:"{x: x(unit), y: y(unit)"+(a!==void 0?`, extent_x: ${r?tS(e,pt):`slice(${a.signals.visual})`}`:"")+(s!==void 0?`, extent_y: ${r?tS(e,Wt):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:i+d6,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),a!==void 0&&h6(e,t,a,"width",n),s!==void 0&&h6(e,t,s,"height",n),n}};function h6(e,t,n,i,r){var o,a;const s=t.name,u=s+f6,l=s+d6,c=n.channel,f=ps.defined(t),d=r.filter(w=>w.name===n.signals[f?"data":"visual"])[0],h=e.getSizeSignalRef(i).signal,g=e.getScaleComponent(c),p=g.get("type"),m=g.get("reverse"),y=f?c===pt?m?"":"-":m?"-":"":"",v=`${u}.extent_${c}`,x=`${y}${l}.${c} / ${f?`${h}`:`span(${v})`}`,b=f?p==="log"?"panLog":p==="symlog"?"panSymlog":p==="pow"?"panPow":"panLinear":"panLinear",_=f?p==="pow"?`, ${(o=g.get("exponent"))!==null&&o!==void 0?o:1}`:p==="symlog"?`, ${(a=g.get("constant"))!==null&&a!==void 0?a:1}`:"":"",E=`${b}(${v}, ${x}${_})`;d.on.push({events:{signal:l},update:f?E:`clampRange(${E}, 0, ${h})`})}const g6="_zoom_anchor",p6="_zoom_delta",$ge={defined:e=>e.type==="interval"&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=ps.defined(t),o=i+p6,{x:a,y:s}=t.project.hasChannel,u=H(e.scaleName(pt)),l=H(e.scaleName(Wt));let c=Ja(t.zoom,"scope");return r||(c=c.map(f=>(f.markname=i+Mc,f))),n.push({name:i+g6,on:[{events:c,update:r?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(f=>!!f).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),a!==void 0&&m6(e,t,a,"width",n),s!==void 0&&m6(e,t,s,"height",n),n}};function m6(e,t,n,i,r){var o,a;const s=t.name,u=n.channel,l=ps.defined(t),c=r.filter(b=>b.name===n.signals[l?"data":"visual"])[0],f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(u),h=d.get("type"),g=l?tS(e,u):c.name,p=s+p6,m=`${s}${g6}.${u}`,y=l?h==="log"?"zoomLog":h==="symlog"?"zoomSymlog":h==="pow"?"zoomPow":"zoomLinear":"zoomLinear",v=l?h==="pow"?`, ${(o=d.get("exponent"))!==null&&o!==void 0?o:1}`:h==="symlog"?`, ${(a=d.get("constant"))!==null&&a!==void 0?a:1}`:"":"",x=`${y}(${g}, ${m}, ${p}${v})`;c.on.push({events:{signal:p},update:l?x:`clampRange(${x}, 0, ${f})`})}const Cu="_store",ys="_tuple",Lge="_modify",y6="vlSelectionResolve",A1=[mge,gge,dge,l6,u6,ps,c6,Nge,jge,$ge,s6];function Ige(e){let t=e.parent;for(;t&&!Sr(t);)t=t.parent;return t}function Nc(e,{escape:t}={escape:!0}){let n=t?H(e.name):e.name;const i=Ige(e);if(i){const{facet:r}=i;for(const o of Gi)r[o]&&(n+=` + '__facet_${o}_' + (facet[${H(i.vgField(o))}])`)}return n}function uS(e){var t;return En((t=e.component.selection)!==null&&t!==void 0?t:{}).reduce((n,i)=>n||i.project.items.some(r=>r.field===Fh),!1)}function v6(e,t){(K(t.select)||!t.select.on)&&delete e.events,(K(t.select)||!t.select.clear)&&delete e.clear,(K(t.select)||!t.select.toggle)&&delete e.toggle}function lS(e){const t=[];return e.type==="Identifier"?[e.name]:e.type==="Literal"?[e.value]:(e.type==="MemberExpression"&&(t.push(...lS(e.object)),t.push(...lS(e.property))),t)}function b6(e){return e.object.type==="MemberExpression"?b6(e.object):e.object.name==="datum"}function x6(e){const t=R_(e),n=new Set;return t.visit(i=>{i.type==="MemberExpression"&&b6(i)&&n.add(lS(i).slice(1).join("."))}),n}class Rc extends et{constructor(t,n,i){super(t);this.model=n,this.filter=i,this.expr=k1(this.model,this.filter,this),this._dependentFields=x6(this.expr)}clone(){return new Rc(null,this.model,be(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Pge(e,t){var n;const i={},r=e.config.selection;if(!t||!t.length)return i;for(const o of t){const a=ht(o.name),s=o.select,u=K(s)?s:s.type,l=Q(s)?be(s):{type:u},c=r[u];for(const d in c)d==="fields"||d==="encodings"||(d==="mark"&&(l[d]=Object.assign(Object.assign({},c[d]),l[d])),(l[d]===void 0||l[d]===!0)&&(l[d]=(n=c[d])!==null&&n!==void 0?n:l[d]));const f=i[a]=Object.assign(Object.assign({},l),{name:a,type:u,init:o.value,bind:o.bind,events:K(l.on)?Ja(l.on,"scope"):J(be(l.on))});for(const d of A1)d.defined(f)&&d.parse&&d.parse(e,f,o)}return i}function w6(e,t,n,i="datum"){const r=K(t)?t:t.param,o=ht(r),a=H(o+Cu);let s;try{s=e.getSelectionComponent(o,r)}catch{return`!!${o}`}if(s.project.timeUnit){const c=n!=null?n:e.component.data.raw,f=s.project.timeUnit.clone();c.parent?f.insertAsParentOf(c):c.parent=f}const u=`vlSelectionTest(${a}, ${i}${s.resolve==="global"?")":`, ${H(s.resolve)})`}`,l=`length(data(${a}))`;return t.empty===!1?`${l} && ${u}`:`!${l} || ${u}`}function _6(e,t,n){const i=ht(t),r=n.encoding;let o=n.field,a;try{a=e.getSelectionComponent(i,t)}catch{return i}if(!r&&!o)o=a.project.items[0].field,a.project.items.length>1&&q(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${H(o)}.`);else if(r&&!o){const s=a.project.items.filter(u=>u.channel===r);!s.length||s.length>1?(o=a.project.items[0].field,q((s.length?"Multiple ":"No ")+`matching ${H(r)} encoding found for selection ${H(n.param)}. Using "field": ${H(o)}.`)):o=s[0].field}return`${a.name}[${H(Wi(o))}]`}function zge(e,t){var n;for(const[i,r]of Za((n=e.component.selection)!==null&&n!==void 0?n:{})){const o=e.getName(`lookup_${i}`);e.component.data.outputNodes[o]=r.materialized=new qn(new Rc(t,e,{param:i}),o,at.Lookup,e.component.data.outputNodeRefCounts)}}function k1(e,t,n){return ph(t,i=>K(i)?i:mfe(i)?w6(e,i,n):lI(i))}var C1=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Bge(e,t){if(!!e)return P(e)&&!us(e)?e.map(n=>TO(n,t)).join(", "):e}function cS(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function jh(e,t,n,i={header:!1}){var r,o;const a=e.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:f,zindex:d}=a,h=C1(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const g in h){const p=bde[g],m=h[g];if(p&&p!==t&&p!=="both")delete h[g];else if(Th(m)){const{condition:y}=m,v=C1(m,["condition"]),x=J(y),b=GI[g];if(b){const{vgProp:_,part:E}=b,w=[...x.map(O=>{const{test:S}=O,k=C1(O,["test"]);return Object.assign({test:k1(null,S)},k)}),v];cS(h,E,_,w),delete h[g]}else if(b===null){const _={signal:x.map(E=>{const{test:w}=E,O=C1(E,["test"]);return`${k1(null,w)} ? ${RL(O)} : `}).join("")+RL(v)};h[g]=_}}else if(oe(m)){const y=GI[g];if(y){const{vgProp:v,part:x}=y;cS(h,x,v,m),delete h[g]}}De(["labelAlign","labelBaseline"],g)&&h[g]===null&&delete h[g]}if(t==="grid"){if(!h.grid)return;if(h.encode){const{grid:g}=h.encode;h.encode=Object.assign({},g?{grid:g}:{}),Ze(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:l,orient:u},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:At(d,0)})}else{if(!i.header&&e.mainExtracted)return;if(c!==void 0){let p=c;((o=(r=h.encode)===null||r===void 0?void 0:r.labels)===null||o===void 0?void 0:o.update)&&oe(h.encode.labels.update.text)&&(p=mu(c,"datum.label",h.encode.labels.update.text.signal)),cS(h,"labels","text",{signal:p})}if(h.labelAlign===null&&delete h.labelAlign,h.encode){for(const p of VI)e.hasAxisPart(p)||delete h.encode[p];Ze(h.encode)&&delete h.encode}const g=Bge(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},g?{title:g}:{}),h),n.aria===!1?{aria:!1}:{}),{zindex:At(d,0)})}}}function E6(e){const{axes:t}=e.component,n=[];for(const i of co)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const o=i==="x"?"height":"width",a=e.getSizeSignalRef(o).signal;o!==a&&n.push({name:o,update:a})}}return n}function Uge(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(r=>jh(r,"grid",t)),...i.map(r=>jh(r,"grid",t)),...n.map(r=>jh(r,"main",t)),...i.map(r=>jh(r,"main",t))].filter(r=>r)}function O6(e,t,n,i){return Object.assign.apply(null,[{},...e.map(r=>{if(r==="axisOrient"){const o=n==="x"?"bottom":"left",a=t[n==="x"?"axisBottom":"axisLeft"]||{},s=t[n==="x"?"axisTop":"axisRight"]||{},u=new Set([...U(a),...U(s)]),l={};for(const c of u.values())l[c]={signal:`${i.signal} === "${o}" ? ${ea(a[c])} : ${ea(s[c])}`};return l}return t[r]})])}function qge(e,t,n,i){const r=t==="band"?["axisDiscrete","axisBand"]:t==="point"?["axisDiscrete","axisPoint"]:gI(t)?["axisQuantitative"]:t==="time"||t==="utc"?["axisTemporal"]:[],o=e==="x"?"axisX":"axisY",a=oe(n)?"axisOrient":`axis${mh(n)}`,s=[...r,...r.map(l=>o+l.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:O6(s,i,e,n),vgAxisConfig:O6(u,i,e,n),axisConfigStyle:Wge([...u,...s],i)}}function Wge(e,t){var n;const i=[{}];for(const r of e){let o=(n=t[r])===null||n===void 0?void 0:n.style;if(o){o=J(o);for(const a of o)i.push(t.style[a])}}return Object.assign.apply(null,i)}function fS(e,t,n,i={}){var r;const o=$L(e,n,t);if(o!==void 0)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(((r=i[a])===null||r===void 0?void 0:r[e])!==void 0)return{configFrom:a,configValue:i[a][e]};return{}}const S6={scale:({model:e,channel:t})=>e.scaleName(t),format:({fieldOrDatumDef:e,config:t,axis:n})=>{const{format:i,formatType:r}=n;return kI(e,e.type,i,r,t,!0)},formatType:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return CI(i,t,n)},grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>{var i;return(i=t.grid)!==null&&i!==void 0?i:Hge(n,e)},gridScale:({model:e,channel:t})=>Gge(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||k6(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||A6(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>{var i;return(i=e.labelFlush)!==null&&i!==void 0?i:Yge(t.type,n)},labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>{var i;return(i=e.labelOverlap)!==null&&i!==void 0?i:Xge(t.type,n,G(t)&&!!t.timeUnit,G(t)?t.sort:void 0)},orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{var o;const a=e==="x"?"width":e==="y"?"height":void 0,s=a?t.getSizeSignalRef(a):void 0;return(o=n.tickCount)!==null&&o!==void 0?o:Jge({fieldOrDatumDef:i,scaleType:r,size:s,values:n.values})},title:({axis:e,model:t,channel:n})=>{if(e.title!==void 0)return e.title;const i=C6(t,n);if(i!==void 0)return i;const r=t.typedFieldDef(n),o=n==="x"?"x2":"y2",a=t.fieldDef(o);return IL(r?[jI(r)]:[],G(a)?[jI(a)]:[])},values:({axis:e,fieldOrDatumDef:t})=>Qge(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>{var i;return(i=e.zindex)!==null&&i!==void 0?i:Zge(n,t)}};function Hge(e,t){return!Ht(e)&&G(t)&&!ot(t==null?void 0:t.bin)&&!zn(t==null?void 0:t.bin)}function Gge(e,t){const n=t==="x"?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}function Vge(e,t,n,i,r){const o=t==null?void 0:t.labelAngle;if(o!==void 0)return oe(o)?o:yh(o);{const{configValue:a}=fS("labelAngle",i,t==null?void 0:t.style,r);return a!==void 0?yh(a):n===pt&&De([fO,cO],e.type)&&!(G(e)&&e.timeUnit)?270:void 0}}function dS(e){return`(((${e.signal} % 360) + 360) % 360)`}function A6(e,t,n,i){if(e!==void 0)if(n==="x"){if(oe(e)){const r=dS(e),o=oe(t)?`(${t.signal} === "top")`:t==="top";return{signal:`(45 < ${r} && ${r} < 135) || (225 < ${r} && ${r} < 315) ? "middle" :(${r} <= 45 || 315 <= ${r}) === ${o} ? "bottom" : "top"`}}if(45<e&&e<135||225<e&&e<315)return"middle";if(oe(t)){const r=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${r} "top" ? "bottom" : "top"`}}return(e<=45||315<=e)==(t==="top")?"bottom":"top"}else{if(oe(e)){const r=dS(e),o=oe(t)?`(${t.signal} === "left")`:t==="left";return{signal:`${r} <= 45 || 315 <= ${r} || (135 <= ${r} && ${r} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${r} && ${r} <= 135) === ${o} ? "top" : "bottom"`}}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(oe(t)){const r=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${r} "left" ? "top" : "bottom"`}}return(45<=e&&e<=135)==(t==="left")?"top":"bottom"}}function k6(e,t,n){if(e===void 0)return;const i=n==="x",r=i?0:90,o=i?"bottom":"left";if(oe(e)){const a=dS(e),s=oe(t)?`(${t.signal} === "${o}")`:t===o;return{signal:`(${r?`(${a} + 90)`:a} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${a} && ${a} < ${180+r}) === ${s} ? "left" : "right"`}}if((e+r)%180==0)return i?null:"center";if(oe(t)){const a=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${a} "${o}"`} ? "left" : "right"`}}return(r<e&&e<180+r)==(t===o)?"left":"right"}function Yge(e,t){if(t==="x"&&De(["quantitative","temporal"],e))return!0}function Xge(e,t,n,i){if(n&&!Q(i)||e!=="nominal"&&e!=="ordinal")return t==="log"||t==="symlog"?"greedy":!0}function Kge(e){return e==="x"?"bottom":"left"}function Jge({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){var r;if(!i&&!Ht(t)&&t!=="log"){if(G(e)){if(ot(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&De(["month","hours","day","quarter"],(r=Bn(e.timeUnit))===null||r===void 0?void 0:r.unit))return}return{signal:`ceil(${n.signal}/40)`}}}function C6(e,t){const n=t==="x"?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,a=r?r.title:void 0;if(o&&a)return PL(o,a);if(o)return o;if(a)return a;if(o!==void 0)return o;if(a!==void 0)return a}function Qge(e,t){const n=e.values;if(P(n))return HI(t,n);if(oe(n))return n}function Zge(e,t){return e==="rect"&&s1(t)?1:0}class jc extends et{constructor(t,n){super(t);this.transform=n,this._dependentFields=x6(this.transform.calculate)}clone(){return new jc(null,be(this.transform))}static parseAllForSortIndex(t,n){return n.forEachFieldDef((i,r)=>{if(!!Au(i)&&RI(i.sort)){const{field:o,timeUnit:a}=i,s=i.sort,u=s.map((l,c)=>`${lI({field:o,timeUnit:a,equal:l})} ? ${c} : `).join("")+s.length;t=new jc(t,{calculate:u,as:$c(i,r,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Me(this.transform)}`}}function $c(e,t,n){return V(e,Object.assign({prefix:t,suffix:"sort_index"},n!=null?n:{}))}function T1(e,t){return De(["top","bottom"],t)?"column":De(["left","right"],t)||e==="row"?"row":"column"}function Lc(e,t,n,i){const r=i==="row"?n.headerRow:i==="column"?n.headerColumn:n.headerFacet;return At((t||{})[e],r[e],n.header[e])}function F1(e,t,n,i){const r={};for(const o of e){const a=Lc(o,t||{},n,i);a!==void 0&&(r[o]=a)}return r}const hS=["row","column"],gS=["header","footer"];function epe(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=F1(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),u=T1(t,s),l=yh(a);return{name:`${t}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},t==="row"?{orient:"left"}:{}),{style:"guide-title"}),F6(l,u)),T6(u,l,o)),M6(i,r,t,Ude,hP))}}function T6(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const i=k6(t,e==="row"?"left":"top",e==="row"?"y":"x");return i?{align:i}:{}}function F6(e,t){const n=A6(e,t==="row"?"left":"top",t==="row"?"y":"x",!0);return n?{baseline:n}:{}}function tpe(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of gS)if(n[r])for(const o of n[r]){const a=ipe(e,t,r,n,o);a!=null&&i.push(a)}return i}function npe(e,t){var n;const{sort:i}=e;return go(i)?{field:V(i,{expr:"datum"}),order:(n=i.order)!==null&&n!==void 0?n:"ascending"}:P(i)?{field:$c(e,t,{expr:"datum"}),order:"ascending"}:{field:V(e,{expr:"datum"}),order:i!=null?i:"ascending"}}function pS(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=F1(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=xO({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,c=T1(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?mu(mu(u,"datum.label",l),"datum.value",V(e,{expr:"parent"})):l}},t==="row"?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),F6(o,c)),T6(c,o,a)),M6(n,e,t,qde,gP))}function ipe(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:a}=i,s=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:f}=F1(["labelOrient"],a.header,s,t);(t==="row"&&!De(["top","bottom"],f)||t==="column"&&!De(["left","right"],f))&&(o=pS(a,t,s))}const u=Sr(e)&&!Ah(e.facet),l=r.axes,c=(l==null?void 0:l.length)>0;if(o||c){const f=t==="row"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`},i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:npe(a,t)}:{}),c&&u?{from:{data:e.getName(`facet_domain_${t}`)}}:{}),o?{title:o}:{}),r.sizeSignal?{encode:{update:{[f]:r.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const rpe={column:{start:0,end:1},row:{start:1,end:0}};function ope(e,t){return rpe[t][e]}function ape(e,t){const n={};for(const i of Gi){const r=e[i];if(r==null?void 0:r.facetFieldDef){const{titleAnchor:o,titleOrient:a}=F1(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),s=T1(i,a),u=ope(o,s);u!==void 0&&(n[s]=u)}}return Ze(n)?void 0:n}function M6(e,t,n,i,r){const o={};for(const a of i){if(!r[a])continue;const s=Lc(a,t==null?void 0:t.header,e,n);s!==void 0&&(o[r[a]]=s)}return o}function mS(e){return[...M1(e,"width"),...M1(e,"height"),...M1(e,"childWidth"),...M1(e,"childHeight")]}function M1(e,t){const n=t==="width"?"x":"y",i=e.component.layoutSize.get(t);if(!i||i==="merged")return[];const r=e.getSizeSignalRef(t).signal;if(i==="step"){const o=e.getScaleComponent(n);if(o){const a=o.get("type"),s=o.get("range");if(Ht(a)&&ls(s)){const u=e.scaleName(n);return Sr(e.parent)&&e.parent.component.resolve.scale[n]==="independent"?[D6(u,s)]:[D6(u,s),{name:r,update:N6(u,o,`domain('${u}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}else if(i=="container"){const o=r.endsWith("width"),a=o?"containerSize()[0]":"containerSize()[1]",s=HO(e.config.view,o?"width":"height"),u=`isFinite(${a}) ? ${a} : ${s}`;return[{name:r,init:u,on:[{update:u,events:"window:resize"}]}]}else return[{name:r,value:i}]}function D6(e,t){const n=`${e}_step`;return oe(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step}}function N6(e,t,n){const i=t.get("type"),r=t.get("padding"),o=At(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a=i==="band"?a!==void 0?a:r:1,`bandspace(${n}, ${ea(a)}, ${ea(o)}) * ${e}_step`}function R6(e){return e==="childWidth"?"width":e==="childHeight"?"height":e}function j6(e,t){return U(e).reduce((n,i)=>{const r=e[i];return Object.assign(Object.assign({},n),Dc(t,r,i,o=>lt(o.value)))},{})}function $6(e,t){if(Sr(t))return e==="theta"?"independent":"shared";if(zc(t))return"shared";if(DS(t))return rn(e)||e==="theta"||e==="radius"?"independent":"shared";throw new Error("invalid model type for resolve")}function yS(e,t){const n=e.scale[t],i=rn(t)?"axis":"legend";return n==="independent"?(e[i][t]==="shared"&&q(Pce(t)),"independent"):e[i][t]||"shared"}const spe=Object.assign(Object.assign({},Gde),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),L6=U(spe);class upe extends ia{}const I6={symbols:lpe,gradient:cpe,labels:fpe,entries:dpe};function lpe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){var a,s,u,l,c,f,d,h;if(o!=="symbol")return;const{markDef:g,encoding:p,config:m,mark:y}=n,v=g.filled&&y!=="trail";let x=Object.assign(Object.assign({},Xle({},n,Ufe)),t6(n,{filled:v}));const b=(a=r.get("symbolOpacity"))!==null&&a!==void 0?a:m.legend.symbolOpacity,_=(s=r.get("symbolFillColor"))!==null&&s!==void 0?s:m.legend.symbolFillColor,E=(u=r.get("symbolStrokeColor"))!==null&&u!==void 0?u:m.legend.symbolStrokeColor,w=b===void 0?(l=P6(p.opacity))!==null&&l!==void 0?l:g.opacity:void 0;if(x.fill){if(i==="fill"||v&&i===ai)delete x.fill;else if(x.fill.field)_?delete x.fill:(x.fill=lt((c=m.legend.symbolBaseFillColor)!==null&&c!==void 0?c:"black"),x.fillOpacity=lt(w!=null?w:1));else if(P(x.fill)){const O=(h=(d=vS((f=p.fill)!==null&&f!==void 0?f:p.color))!==null&&d!==void 0?d:g.fill)!==null&&h!==void 0?h:v&&g.color;O&&(x.fill=lt(O))}}if(x.stroke){if(i==="stroke"||!v&&i===ai)delete x.stroke;else if(x.stroke.field||E)delete x.stroke;else if(P(x.stroke)){const O=At(vS(p.stroke||p.color),g.stroke,v?g.color:void 0);O&&(x.stroke={value:O})}}if(i!==Ko){const O=G(t)&&B6(n,r,t);O?x.opacity=[Object.assign({test:O},lt(w!=null?w:1)),lt(m.legend.unselectedOpacity)]:w&&(x.opacity=lt(w))}return x=Object.assign(Object.assign({},x),e),Ze(x)?void 0:x}function cpe(e,{model:t,legendType:n,legendCmpt:i}){var r;if(n!=="gradient")return;const{config:o,markDef:a,encoding:s}=t;let u={};const c=((r=i.get("gradientOpacity"))!==null&&r!==void 0?r:o.legend.gradientOpacity)===void 0?P6(s.opacity)||a.opacity:void 0;return c&&(u.opacity=lt(c)),u=Object.assign(Object.assign({},u),e),Ze(u)?void 0:u}function fpe(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},a=n.config,s=G(t)?B6(n,r,t):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,f=Su(c)?wO({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),e);return Ze(d)?void 0:d}function dpe(e,{legendCmpt:t}){const n=t.get("selections");return(n==null?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}function P6(e){return z6(e,(t,n)=>Math.max(t,n.value))}function vS(e){return z6(e,(t,n)=>At(t,n.value))}function z6(e,t){if(sde(e))return J(e.condition).reduce(t,e.value);if(_r(e))return e.value}function B6(e,t,n){const i=t.get("selections");if(!(i==null?void 0:i.length))return;const r=H(n.field);return i.map(o=>`(!length(data(${H(ht(o)+Cu)})) || (${o}[${r}] && indexof(${o}[${r}], datum.value) >= 0))`).join(" || ")}const U6={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return kI(e,e.type,i,r,n,!1)},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return CI(i,t,n)},gradientLength:e=>{var t,n;const{legend:i,legendConfig:r}=e;return(n=(t=i.gradientLength)!==null&&t!==void 0?t:r.gradientLength)!==null&&n!==void 0?n:bpe(e)},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>{var i,r;return(r=(i=e.labelOverlap)!==null&&i!==void 0?i:t.labelOverlap)!==null&&r!==void 0?r:xpe(n)},symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>{var r;return(r=e.symbolType)!==null&&r!==void 0?r:gpe(t.type,n,i.shape,t.shape)},title:({fieldOrDatumDef:e,config:t})=>Sc(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(vc(n)&&wr(t)){if(e==="gradient")return}else if(e==="symbol")return;return e},values:({fieldOrDatumDef:e,legend:t})=>hpe(t,e)};function hpe(e,t){const n=e.values;if(P(n))return HI(t,n);if(oe(n))return n}function gpe(e,t,n,i){var r;if(t!=="shape"){const o=(r=vS(n))!==null&&r!==void 0?r:i;if(o)return o}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}function ppe(e){const{legend:t}=e;return At(t.type,mpe(e))}function mpe({channel:e,timeUnit:t,scaleType:n}){if(vc(e)){if(De(["quarter","month","day"],t))return"symbol";if(wr(n))return"gradient"}return"symbol"}function ype({legendConfig:e,legendType:t,orient:n,legend:i}){var r,o;return(o=(r=i.direction)!==null&&r!==void 0?r:e[t?"gradientDirection":"symbolDirection"])!==null&&o!==void 0?o:vpe(n,t)}function vpe(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return t==="gradient"?"horizontal":void 0}}function bpe({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=e;if(wr(r))return n==="horizontal"?i==="top"||i==="bottom"?q6(t,"width",a,o):a:q6(t,"height",u,s)}function q6(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`}}function xpe(e){if(De(["quantile","threshold","log","symlog"],e))return"greedy"}function W6(e){const t=kt(e)?wpe(e):Spe(e);return e.component.legends=t,t}function wpe(e){const{encoding:t}=e,n={};for(const i of[ai,...mP]){const r=$t(t[i]);!r||!e.getScaleComponent(i)||i===si&&G(r)&&r.type===_c||(n[i]=Ope(e,i))}return n}function _pe(e,t){const n=e.scaleName(t);if(e.mark==="trail"){if(t==="color")return{stroke:n};if(t==="size")return{strokeWidth:n}}return t==="color"?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n}}function Epe(e,t,n,i){switch(t){case"disable":return n!==void 0;case"values":return!!(n==null?void 0:n.values);case"title":if(t==="title"&&e===(i==null?void 0:i.title))return!0}return e===(n||{})[t]}function Ope(e,t){var n,i,r;let o=e.legend(t);const{markDef:a,encoding:s,config:u}=e,l=u.legend,c=new upe({},_pe(e,t));Rge(e,t,c);const f=o!==void 0?!o:l.disable;if(c.set("disable",f,o!==void 0),f)return c;o=o||{};const d=e.getScaleComponent(t).get("type"),h=$t(s[t]),g=G(h)?(n=Bn(h.timeUnit))===null||n===void 0?void 0:n.unit:void 0,p=o.orient||u.legend.orient||"right",m=ppe({legend:o,channel:t,timeUnit:g,scaleType:d}),y=ype({legend:o,legendType:m,orient:p,legendConfig:l}),v={legend:o,channel:t,model:e,markDef:a,encoding:s,fieldOrDatumDef:h,legendConfig:l,config:u,scaleType:d,orient:p,legendType:m,direction:y};for(const w of L6){if(m==="gradient"&&w.startsWith("symbol")||m==="symbol"&&w.startsWith("gradient"))continue;const O=w in U6?U6[w](v):o[w];if(O!==void 0){const S=Epe(O,w,o,e.fieldDef(t));(S||u.legend[w]===void 0)&&c.set(w,O,S)}}const x=(i=o==null?void 0:o.encoding)!==null&&i!==void 0?i:{},b=c.get("selections"),_={},E={fieldOrDatumDef:h,model:e,channel:t,legendCmpt:c,legendType:m};for(const w of["labels","legend","title","symbols","gradient","entries"]){const O=j6((r=x[w])!==null&&r!==void 0?r:{},e),S=w in I6?I6[w](O,E):O;S!==void 0&&!Ze(S)&&(_[w]=Object.assign(Object.assign(Object.assign({},(b==null?void 0:b.length)&&G(h)?{name:`${ht(h.field)}_legend_${w}`}:{}),(b==null?void 0:b.length)?{interactive:!!b}:{}),{update:S}))}return Ze(_)||c.set("encode",_,!!(o==null?void 0:o.encoding)),c}function Spe(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){W6(i);for(const r of U(i.component.legends))n.legend[r]=yS(e.component.resolve,r),n.legend[r]==="shared"&&(t[r]=H6(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]))}for(const i of U(t))for(const r of e.children)!r.component.legends[i]||n.legend[i]==="shared"&&delete r.component.legends[i];return t}function H6(e,t){var n,i,r,o;if(!e)return t.clone();const a=e.getWithExplicit("orient"),s=t.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of L6){const c=hs(e.getWithExplicit(l),t.getWithExplicit(l),l,"legend",(f,d)=>{switch(l){case"symbolType":return Ape(f,d);case"title":return zL(f,d);case"type":return u=!0,Ci("symbol")}return w1(f,d,l,"legend")});e.setWithExplicit(l,c)}return u&&(((i=(n=e.implicit)===null||n===void 0?void 0:n.encode)===null||i===void 0?void 0:i.gradient)&&L0(e.implicit,["encode","gradient"]),((o=(r=e.explicit)===null||r===void 0?void 0:r.encode)===null||o===void 0?void 0:o.gradient)&&L0(e.explicit,["encode","gradient"])),e}function Ape(e,t){return t.value==="circle"?t:e}var kpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Cpe(e,t,n,i){var r,o,a,s,u;(r=e.encode)!==null&&r!==void 0||(e.encode={}),(o=(s=e.encode)[t])!==null&&o!==void 0||(s[t]={}),(a=(u=e.encode[t]).update)!==null&&a!==void 0||(u.update={}),e.encode[t].update[n]=i}function G6(e){const t=e.component.legends,n={};for(const r of U(t)){const o=e.getScaleComponent(r),a=rt(o.get("domains"));if(n[a])for(const s of n[a])H6(s,t[r])||n[a].push(t[r]);else n[a]=[t[r].clone()]}return En(n).flat().map(r=>Tpe(r,e.config)).filter(r=>r!==void 0)}function Tpe(e,t){var n,i,r;const o=e.combine(),{disable:a,labelExpr:s,selections:u}=o,l=kpe(o,["disable","labelExpr","selections"]);if(!a){if(t.aria===!1&&l.aria==null&&(l.aria=!1),(n=l.encode)===null||n===void 0?void 0:n.symbols){const c=l.encode.symbols.update;c.fill&&c.fill.value!=="transparent"&&!c.stroke&&!l.stroke&&(c.stroke={value:"transparent"});for(const f of mP)l[f]&&delete c[f]}if(l.title||delete l.title,s!==void 0){let c=s;((r=(i=l.encode)===null||i===void 0?void 0:i.labels)===null||r===void 0?void 0:r.update)&&oe(l.encode.labels.update.text)&&(c=mu(s,"datum.label",l.encode.labels.update.text.signal)),Cpe(l,"labels","text",{signal:c})}return l}}function Fpe(e){return zc(e)||DS(e)?Mpe(e):V6(e)}function Mpe(e){return e.children.reduce((t,n)=>t.concat(n.assembleProjections()),V6(e))}function V6(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(a=>a.signal).join(", ")}]`},o=t.data.reduce((a,s)=>{const u=oe(s)?s.signal:`data('${e.lookupDataSource(s)}')`;return De(a,u)||a.push(u),a},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}else return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Dpe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Y6 extends ia{constructor(t,n,i,r){super(Object.assign({},n),{name:t});this.specifiedProjection=n,this.size=i,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function X6(e){e.component.projection=kt(e)?Npe(e):$pe(e)}function Npe(e){var t;if(e.hasProjection){const n=li(e.specifiedProjection),i=!(n&&(n.scale!=null||n.translate!=null)),r=i?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,o=i?Rpe(e):void 0,a=new Y6(e.projectionName(!0),Object.assign(Object.assign({},(t=li(e.config.projection))!==null&&t!==void 0?t:{}),n!=null?n:{}),r,o);return a.get("type")||a.set("type","equalEarth",!1),a}}function Rpe(e){const t=[],{encoding:n}=e;for(const i of[[so,ao],[Hi,xr]])($t(n[i[0]])||$t(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});return e.channelHasField(si)&&e.typedFieldDef(si).type===_c&&t.push({signal:e.getName(`geojson_${t.length}`)}),t.length===0&&t.push(e.requestDataName(at.Main)),t}function jpe(e,t){const n=DE(Dpe,r=>!!(!re(e.explicit,r)&&!re(t.explicit,r)||re(e.explicit,r)&&re(t.explicit,r)&&no(e.get(r),t.get(r))));if(no(e.size,t.size)){if(n)return e;if(no(e.explicit,{}))return t;if(no(t.explicit,{}))return e}return null}function $pe(e){if(e.children.length===0)return;let t;for(const i of e.children)X6(i);const n=DE(e.children,i=>{const r=i.component.projection;if(r)if(t){const o=jpe(t,r);return o&&(t=o),!!o}else return t=r,!0;else return!0});if(t&&n){const i=e.projectionName(!0),r=new Y6(i,t.specifiedProjection,t.size,be(t.data));for(const o of e.children){const a=o.component.projection;a&&(a.isFit&&r.data.push(...o.component.projection.data),o.renameProjection(a.get("name"),i),a.merged=!0)}return r}}var Lpe=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function Ipe(e,t,n,i){var r,o;if(Ch(t,n)){const a=kt(e)?(o=(r=e.axis(n))!==null&&r!==void 0?r:e.legend(n))!==null&&o!==void 0?o:{}:{},s=V(t,{expr:"datum"}),u=V(t,{expr:"datum",binSuffix:"end"});return{formulaAs:V(t,{binSuffix:"range",forAs:!0}),formula:n1(s,u,a.format,a.formatType,i)}}return{}}function K6(e,t){return`${TL(e)}_${t}`}function Ppe(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)}}function bS(e,t,n){var i;const r=(i=c1(n,void 0))!==null&&i!==void 0?i:{},o=K6(r,t);return e.getName(`${o}_bins`)}function zpe(e){return"as"in e}function J6(e,t,n){let i,r;zpe(e)?i=K(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:i=[V(e,{forAs:!0}),V(e,{binSuffix:"end",forAs:!0})];const o=Object.assign({},c1(t,void 0)),a=K6(o,e.field),{signal:s,extentSignal:u}=Ppe(n,a);if(G0(o.extent)){const c=o.extent;r=_6(n,c.param,c),delete o.extent}const l=Object.assign(Object.assign(Object.assign({bin:o,field:e.field,as:[i]},s?{signal:s}:{}),u?{extentSignal:u}:{}),r?{span:r}:{});return{key:a,binComponent:l}}class wo extends et{constructor(t,n){super(t);this.bins=n}clone(){return new wo(null,be(this.bins))}static makeFromEncoding(t,n){const i=n.reduceFieldDef((r,o,a)=>{if(Vi(o)&&ot(o.bin)){const{key:s,binComponent:u}=J6(o,o.bin,n);r[s]=Object.assign(Object.assign(Object.assign({},u),r[s]),Ipe(n,o,a,n.config))}return r},{});return Ze(i)?null:new wo(t,i)}static makeFromTransform(t,n,i){const{key:r,binComponent:o}=J6(n,n.bin,i);return new wo(t,{[r]:o})}merge(t,n){for(const i of U(t.bins))i in this.bins?(n(t.bins[i].signal,this.bins[i].signal),this.bins[i].as=io([...this.bins[i].as,...t.bins[i].as],Me)):this.bins[i]=t.bins[i];for(const i of t.children)t.removeChild(i),i.parent=this;t.remove()}producedFields(){return new Set(En(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(En(this.bins).map(t=>t.field))}hash(){return`Bin ${Me(this.bins)}`}assemble(){return En(this.bins).flatMap(t=>{const n=[],[i,...r]=t.as,o=t.bin,{extent:a}=o,s=Lpe(o,["extent"]),u=Object.assign(Object.assign(Object.assign({type:"bin",field:Wi(t.field),as:i,signal:t.signal},G0(a)?{extent:null}:{extent:a}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!a&&t.extentSignal&&(n.push({type:"extent",field:Wi(t.field),signal:t.extentSignal}),u.extent={signal:t.extentSignal}),n.push(u);for(const l of r)for(let c=0;c<2;c++)n.push({type:"formula",expr:V({field:i[c]},{expr:"datum"}),as:l[c]});return t.formula&&n.push({type:"formula",expr:t.formula,as:t.formulaAs}),n})}}function Bpe(e,t,n,i){var r;const o=kt(i)?i.encoding[Jo(t)]:void 0;if(Vi(n)&&kt(i)&&II(n,o,i.markDef,i.config))e.add(V(n,{})),e.add(V(n,{suffix:"end"})),n.bin&&Ch(n,t)&&e.add(V(n,{binSuffix:"range"}));else if(ble(t)){const a=vle(t);e.add(i.getName(a))}else e.add(V(n));return Au(n)&&Ffe((r=n.scale)===null||r===void 0?void 0:r.range)&&e.add(n.scale.range.field),e}function Upe(e,t){var n;for(const i of U(t)){const r=t[i];for(const o of U(r))i in e?e[i][o]=new Set([...(n=e[i][o])!==null&&n!==void 0?n:[],...r[o]]):e[i]={[o]:r[o]}}}class Er extends et{constructor(t,n,i){super(t);this.dimensions=n,this.measures=i}clone(){return new Er(null,new Set(this.dimensions),be(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,n){let i=!1;n.forEachFieldDef(a=>{a.aggregate&&(i=!0)});const r={},o=new Set;return!i||(n.forEachFieldDef((a,s)=>{var u,l,c,f;const{aggregate:d,field:h}=a;if(d)if(d==="count")(u=r["*"])!==null&&u!==void 0||(r["*"]={}),r["*"].count=new Set([V(a,{forAs:!0})]);else{if(Qo(d)||ss(d)){const g=Qo(d)?"argmin":"argmax",p=d[g];(l=r[p])!==null&&l!==void 0||(r[p]={}),r[p][g]=new Set([V({op:g,field:p},{forAs:!0})])}else(c=r[h])!==null&&c!==void 0||(r[h]={}),r[h][d]=new Set([V(a,{forAs:!0})]);as(s)&&n.scaleDomain(s)==="unaggregated"&&((f=r[h])!==null&&f!==void 0||(r[h]={}),r[h].min=new Set([V({field:h,aggregate:"min"},{forAs:!0})]),r[h].max=new Set([V({field:h,aggregate:"max"},{forAs:!0})]))}else Bpe(o,s,a,n)}),o.size+U(r).length===0)?null:new Er(t,o,r)}static makeFromTransform(t,n){var i,r,o;const a=new Set,s={};for(const u of n.aggregate){const{op:l,field:c,as:f}=u;l&&(l==="count"?((i=s["*"])!==null&&i!==void 0||(s["*"]={}),s["*"].count=new Set([f||V(u,{forAs:!0})])):((r=s[c])!==null&&r!==void 0||(s[c]={}),s[c][l]=new Set([f||V(u,{forAs:!0})])))}for(const u of(o=n.groupby)!==null&&o!==void 0?o:[])a.add(u);return a.size+U(s).length===0?null:new Er(t,a,s)}merge(t){return fL(this.dimensions,t.dimensions)?(Upe(this.measures,t.measures),!0):(tfe("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...U(this.measures)])}producedFields(){const t=new Set;for(const n of U(this.measures))for(const i of U(this.measures[n])){const r=this.measures[n][i];r.size===0?t.add(`${i}_${n}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${Me({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],n=[],i=[];for(const o of U(this.measures))for(const a of U(this.measures[o]))for(const s of this.measures[o][a])i.push(s),t.push(a),n.push(o==="*"?null:Wi(o));return{type:"aggregate",groupby:[...this.dimensions].map(Wi),ops:t,fields:n,as:i}}}class Ic extends et{constructor(t,n,i,r){super(t);this.model=n,this.name=i,this.data=r;for(const o of Gi){const a=n.facet[o];if(a){const{bin:s,sort:u}=a;this[o]=Object.assign({name:n.getName(`${o}_domain`),fields:[V(a),...ot(s)?[V(a,{binSuffix:"end"})]:[]]},go(u)?{sortField:u}:P(u)?{sortIndexField:$c(a,o)}:{})}}this.childModel=n.child}hash(){let t="Facet";for(const n of Gi)this[n]&&(t+=` ${n.charAt(0)}:${Me(this[n])}`);return t}get fields(){var t;const n=[];for(const i of Gi)((t=this[i])===null||t===void 0?void 0:t.fields)&&n.push(...this[i].fields);return n}dependentFields(){const t=new Set(this.fields);for(const n of Gi)this[n]&&(this[n].sortField&&t.add(this[n].sortField.field),this[n].sortIndexField&&t.add(this[n].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const n of co){const i=this.childModel.component.scales[n];if(i&&!i.merged){const r=i.get("type"),o=i.get("range");if(Ht(r)&&ls(o)){const a=N1(this.childModel,n),s=TS(a);s?t[n]=s:q(XE(n))}}}return t}assembleRowColumnHeaderData(t,n,i){const r={row:"y",column:"x",facet:void 0}[t],o=[],a=[],s=[];r&&i&&i[r]&&(n?(o.push(`distinct_${i[r]}`),a.push("max")):(o.push(i[r]),a.push("distinct")),s.push(`distinct_${i[r]}`));const{sortField:u,sortIndexField:l}=this[t];if(u){const{op:c=i1,field:f}=u;o.push(f),a.push(c),s.push(V(u,{forAs:!0}))}else l&&(o.push(l),a.push("max"),s.push(l));return{name:this[t].name,source:n!=null?n:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},o.length?{fields:o,ops:a,as:s}:{})]}}assembleFacetHeaderData(t){var n,i;const{columns:r}=this.model.layout,{layoutHeaders:o}=this.model.component,a=[],s={};for(const c of hS){for(const f of gS){const d=(n=o[c]&&o[c][f])!==null&&n!==void 0?n:[];for(const h of d)if(((i=h.axes)===null||i===void 0?void 0:i.length)>0){s[c]=!0;break}}if(s[c]){const f=`length(data("${this.facet.name}"))`,d=c==="row"?r?{signal:`ceil(${f} / ${r})`}:1:r?{signal:`min(${f}, ${r})`}:{signal:f};a.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:d}]})}}const{row:u,column:l}=s;return(u||l)&&a.unshift(this.assembleRowColumnHeaderData("facet",null,t)),a}assemble(){var t,n;const i=[];let r=null;const o=this.getChildIndependentFieldsWithStep(),{column:a,row:s,facet:u}=this;if(a&&s&&(o.x||o.y)){r=`cross_${this.column.name}_${this.row.name}`;const l=[].concat((t=o.x)!==null&&t!==void 0?t:[],(n=o.y)!==null&&n!==void 0?n:[]),c=l.map(()=>"distinct");i.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:c}]})}for(const l of[Go,Ho])this[l]&&i.push(this.assembleRowColumnHeaderData(l,r,o));if(u){const l=this.assembleFacetHeaderData(o);l&&i.push(...l)}return i}}function Q6(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e}function qpe(e,t){const n=$E(e);if(t==="number")return`toNumber(${n})`;if(t==="boolean")return`toBoolean(${n})`;if(t==="string")return`toString(${n})`;if(t==="date")return`toDate(${n})`;if(t==="flatten")return n;if(t.startsWith("date:")){const i=Q6(t.slice(5,t.length));return`timeParse(${n},'${i}')`}else if(t.startsWith("utc:")){const i=Q6(t.slice(4,t.length));return`utcParse(${n},'${i}')`}else return q(uce(t)),null}function Wpe(e){const t={};return $0(e.filter,n=>{var i;if(uI(n)){let r=null;nO(n)?r=Ai(n.equal):rO(n)?r=Ai(n.lte):iO(n)?r=Ai(n.lt):oO(n)?r=Ai(n.gt):aO(n)?r=Ai(n.gte):sO(n)?r=n.range[0]:uO(n)&&(r=((i=n.oneOf)!==null&&i!==void 0?i:n.in)[0]),r&&(_u(r)?t[n.field]="date":Je(r)?t[n.field]="number":K(r)&&(t[n.field]="string")),n.timeUnit&&(t[n.field]="date")}}),t}function Hpe(e){const t={};function n(i){kc(i)?t[i.field]="date":i.type==="quantitative"&&Ple(i.aggregate)?t[i.field]="number":mc(i.field)>1?i.field in t||(t[i.field]="flatten"):Au(i)&&go(i.sort)&&mc(i.sort.field)>1&&(i.sort.field in t||(t[i.sort.field]="flatten"))}if((kt(e)||Sr(e))&&e.forEachFieldDef((i,r)=>{if(Vi(i))n(i);else{const o=bu(r),a=e.fieldDef(o);n(Object.assign(Object.assign({},i),{type:a.type}))}}),kt(e)){const{mark:i,markDef:r,encoding:o}=e;if(cs(i)&&!e.encoding.order){const a=r.orient==="horizontal"?"y":"x",s=o[a];G(s)&&s.type==="quantitative"&&!(s.field in t)&&(t[s.field]="number")}}return t}function Gpe(e){const t={};if(kt(e)&&e.component.selection)for(const n of U(e.component.selection)){const i=e.component.selection[n];for(const r of i.project.items)!r.channel&&mc(r.field)>1&&(t[r.field]="flatten")}return t}class Sn extends et{constructor(t,n){super(t);this._parse=n}clone(){return new Sn(null,be(this._parse))}hash(){return`Parse ${Me(this._parse)}`}static makeExplicit(t,n,i){var r;let o={};const a=n.data;return!gs(a)&&((r=a==null?void 0:a.format)===null||r===void 0?void 0:r.parse)&&(o=a.format.parse),this.makeWithAncestors(t,o,{},i)}static makeWithAncestors(t,n,i,r){for(const s of U(i)){const u=r.getWithExplicit(s);u.value!==void 0&&(u.explicit||u.value===i[s]||u.value==="derived"||i[s]==="flatten"?delete i[s]:q(VL(s,i[s],u.value)))}for(const s of U(n)){const u=r.get(s);u!==void 0&&(u===n[s]?delete n[s]:q(VL(s,n[s],u)))}const o=new ia(n,i);r.copyAll(o);const a={};for(const s of U(o.combine())){const u=o.get(s);u!==null&&(a[s]=u)}return U(a).length===0||r.parseNothing?null:new Sn(t,a)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const n of U(this._parse)){const i=this._parse[n];mc(n)===1&&(t[n]=i)}return t}producedFields(){return new Set(U(this._parse))}dependentFields(){return new Set(U(this._parse))}assembleTransforms(t=!1){return U(this._parse).filter(n=>t?mc(n)>1:!0).map(n=>{const i=qpe(n,this._parse[n]);return i?{type:"formula",expr:i,as:LE(n)}:null}).filter(n=>n!==null)}}class vs extends et{clone(){return new vs(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Fh])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Fh}}}class $h extends et{constructor(t,n){super(t);this.params=n}clone(){return new $h(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Me(this.params)}`}assemble(){return Object.assign({type:"graticule"},this.params===!0?{}:this.params)}}class Lh extends et{constructor(t,n){super(t);this.params=n}clone(){return new Lh(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([(t=this.params.as)!==null&&t!==void 0?t:"data"])}hash(){return`Hash ${Me(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class Tu extends et{constructor(t){super(null);t!=null||(t={name:"source"});let n;if(gs(t)||(n=t.format?Object.assign({},Si(t.format,["parse"])):{}),Mh(t))this._data={values:t.values};else if(Tc(t)){if(this._data={url:t.url},!n.type){let i=/(?:\.([^.]+))?$/.exec(t.url)[1];De(["json","csv","tsv","dsv","topojson"],i)||(i="json"),n.type=i}}else YP(t)?this._data={values:[{type:"Sphere"}]}:(GP(t)||gs(t))&&(this._data={});this._generator=gs(t),t.name&&(this._name=t.name),n&&!Ze(n)&&(this._data.format=n)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var Z6=globalThis&&globalThis.__classPrivateFieldSet||function(e,t,n,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(e,n):r?r.value=n:t.set(e,n),n},Vpe=globalThis&&globalThis.__classPrivateFieldGet||function(e,t,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(e):i?i.value:t.get(e)},Ih;function xS(e){return e instanceof Tu||e instanceof $h||e instanceof Lh}class wS{constructor(){Ih.set(this,void 0),Z6(this,Ih,!1,"f")}setModified(){Z6(this,Ih,!0,"f")}get modifiedFlag(){return Vpe(this,Ih,"f")}}Ih=new WeakMap;class Fu extends wS{getNodeDepths(t,n,i){i.set(t,n);for(const r of t.children)this.getNodeDepths(r,n+1,i);return i}optimize(t){const i=[...this.getNodeDepths(t,0,new Map).entries()].sort((r,o)=>o[1]-r[1]);for(const r of i)this.run(r[0]);return this.modifiedFlag}}class _S extends wS{optimize(t){this.run(t);for(const n of t.children)this.optimize(n);return this.modifiedFlag}}class Ype extends _S{mergeNodes(t,n){const i=n.shift();for(const r of n)t.removeChild(r),r.parent=i,r.remove()}run(t){const n=t.children.map(r=>r.hash()),i={};for(let r=0;r<n.length;r++)i[n[r]]===void 0?i[n[r]]=[t.children[r]]:i[n[r]].push(t.children[r]);for(const r of U(i))i[r].length>1&&(this.setModified(),this.mergeNodes(t,i[r]))}}class Xpe extends _S{constructor(t){super();this.requiresSelectionId=t&&uS(t)}run(t){t instanceof vs&&(this.requiresSelectionId&&(xS(t.parent)||t.parent instanceof Er||t.parent instanceof Sn)||(this.setModified(),t.remove()))}}class Kpe extends wS{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,n){let i=new Set;t instanceof xo&&(i=t.producedFields(),NE(i,n)&&(this.setModified(),t.removeFormulas(n),t.producedFields.length===0&&t.remove()));for(const r of t.children)this.run(r,new Set([...n,...i]))}}class Jpe extends _S{constructor(){super()}run(t){t instanceof qn&&!t.isRequired()&&(this.setModified(),t.remove())}}class Qpe extends Fu{run(t){if(!xS(t)&&!(t.numChildren()>1)){for(const n of t.children)if(n instanceof Sn)if(t instanceof Sn)this.setModified(),t.merge(n);else{if(jE(t.producedFields(),n.dependentFields()))continue;this.setModified(),n.swapWithParent()}}}}class Zpe extends Fu{run(t){const n=[...t.children],i=t.children.filter(r=>r instanceof Sn);if(t.numChildren()>1&&i.length>=1){const r={},o=new Set;for(const a of i){const s=a.parse;for(const u of U(s))u in r?r[u]!==s[u]&&o.add(u):r[u]=s[u]}for(const a of o)delete r[a];if(!Ze(r)){this.setModified();const a=new Sn(t,r);for(const s of n){if(s instanceof Sn)for(const u of U(r))delete s.parse[u];t.removeChild(s),s.parent=a,s instanceof Sn&&U(s.parse).length===0&&s.remove()}}}}}class eme extends Fu{run(t){t instanceof qn||t.numChildren()>0||t instanceof Ic||t instanceof Tu||(this.setModified(),t.remove())}}class tme extends Fu{run(t){const n=t.children.filter(r=>r instanceof xo),i=n.pop();for(const r of n)this.setModified(),i.merge(r)}}class nme extends Fu{run(t){const n=t.children.filter(r=>r instanceof Er),i={};for(const r of n){const o=Me(r.groupBy);o in i||(i[o]=[]),i[o].push(r)}for(const r of U(i)){const o=i[r];if(o.length>1){const a=o.pop();for(const s of o)a.merge(s)&&(t.removeChild(s),s.parent=a,s.remove(),this.setModified())}}}}class ime extends Fu{constructor(t){super();this.model=t}run(t){const n=!(xS(t)||t instanceof Rc||t instanceof Sn||t instanceof vs),i=[],r=[];for(const o of t.children)o instanceof wo&&(n&&!jE(t.producedFields(),o.dependentFields())?i.push(o):r.push(o));if(i.length>0){const o=i.pop();for(const a of i)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof wo?t.merge(o,this.model.renameSignal.bind(this.model)):o.swapWithParent()}if(r.length>1){const o=r.pop();for(const a of r)o.merge(a,this.model.renameSignal.bind(this.model));this.setModified()}}}class rme extends Fu{run(t){const n=[...t.children];if(!pu(n,a=>a instanceof qn)||t.numChildren()<=1)return;const r=[];let o;for(const a of n)if(a instanceof qn){let s=a;for(;s.numChildren()===1;){const[u]=s.children;if(u instanceof qn)s=u;else break}r.push(...s.children),o?(t.removeChild(a),a.parent=o.parent,o.parent.removeChild(o),o.parent=s,this.setModified()):o=s}else r.push(a);if(r.length){this.setModified();for(const a of r)a.parent.removeChild(a),a.parent=o}}}class Mu extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Mu(null,be(this.transform))}addDimensions(t){this.transform.groupby=io(this.transform.groupby.concat(t),n=>n)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(n=>n.field).filter(n=>n!==void 0).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:V(t)}hash(){return`JoinAggregateTransform ${Me(this.transform)}`}assemble(){const t=[],n=[],i=[];for(const o of this.transform.joinaggregate)n.push(o.op),i.push(this.getDefaultName(o)),t.push(o.field===void 0?null:o.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:i,ops:n,fields:t},r!==void 0?{groupby:r}:{})}}function ome(e){return e.stack.stackBy.reduce((t,n)=>{const i=n.fieldDef,r=V(i);return r&&t.push(r),t},[])}function ame(e){return P(e)&&e.every(t=>K(t))&&e.length>1}class ra extends et{constructor(t,n){super(t);this._stack=n}clone(){return new ra(null,be(this._stack))}static makeFromTransform(t,n){const{stack:i,groupby:r,as:o,offset:a="zero"}=n,s=[],u=[];if(n.sort!==void 0)for(const f of n.sort)s.push(f.field),u.push(At(f.order,"ascending"));const l={field:s,order:u};let c;return ame(o)?c=o:K(o)?c=[o,`${o}_end`]:c=[`${n.stack}_start`,`${n.stack}_end`],new ra(t,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:a,sort:l,facetby:[],as:c})}static makeFromEncoding(t,n){const i=n.stack,{encoding:r}=n;if(!i)return null;const{groupbyChannels:o,fieldChannel:a,offset:s,impute:u}=i,l=o.map(h=>{const g=r[h];return yo(g)}).filter(h=>!!h),c=ome(n),f=n.encoding.order;let d;return P(f)||G(f)?d=LL(f):d=c.reduce((h,g)=>(h.field.push(g),h.order.push(a==="y"?"descending":"ascending"),h),{field:[],order:[]}),new ra(t,{dimensionFieldDefs:l,stackField:n.vgField(a),facetby:[],stackby:c,sort:d,offset:s,impute:u,as:[n.vgField(a,{suffix:"start",forAs:!0}),n.vgField(a,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Me(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:n,groupby:i}=this._stack;return t.length>0?t.map(r=>r.bin?n?[V(r,{binSuffix:"mid"})]:[V(r,{}),V(r,{binSuffix:"end"})]:[V(r)]).flat():i!=null?i:[]}assemble(){const t=[],{facetby:n,dimensionFieldDefs:i,stackField:r,stackby:o,sort:a,offset:s,impute:u,as:l}=this._stack;if(u)for(const c of i){const{bandPosition:f=.5,bin:d}=c;if(d){const h=V(c,{expr:"datum"}),g=V(c,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${f}*${h}+${1-f}*${g}`,as:V(c,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...o,...n],key:V(c,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...n],field:r,sort:a,as:l,offset:s}),t}}class Pc extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Pc(null,be(this.transform))}addDimensions(t){this.transform.groupby=io(this.transform.groupby.concat(t),n=>n)}dependentFields(){var t,n;const i=new Set;return((t=this.transform.groupby)!==null&&t!==void 0?t:[]).forEach(i.add,i),((n=this.transform.sort)!==null&&n!==void 0?n:[]).forEach(r=>i.add(r.field)),this.transform.window.map(r=>r.field).filter(r=>r!==void 0).forEach(i.add,i),i}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var n;return(n=t.as)!==null&&n!==void 0?n:V(t)}hash(){return`WindowTransform ${Me(this.transform)}`}assemble(){var t;const n=[],i=[],r=[],o=[];for(const d of this.transform.window)i.push(d.op),r.push(this.getDefaultName(d)),o.push(d.param===void 0?null:d.param),n.push(d.field===void 0?null:d.field);const a=this.transform.frame,s=this.transform.groupby;if(a&&a[0]===null&&a[1]===null&&i.every(d=>HE(d)))return Object.assign({type:"joinaggregate",as:r,ops:i,fields:n},s!==void 0?{groupby:s}:{});const u=[],l=[];if(this.transform.sort!==void 0)for(const d of this.transform.sort)u.push(d.field),l.push((t=d.order)!==null&&t!==void 0?t:"ascending");const c={field:u,order:l},f=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:o,as:r,ops:i,fields:n,sort:c},f!==void 0?{ignorePeers:f}:{}),s!==void 0?{groupby:s}:{}),a!==void 0?{frame:a}:{})}}function sme(e){function t(n){if(!(n instanceof Ic)){const i=n.clone();if(i instanceof qn){const r=OS+i.getSource();i.setSource(r),e.model.component.data.outputNodes[r]=i}else(i instanceof Er||i instanceof ra||i instanceof Pc||i instanceof Mu)&&i.addDimensions(e.fields);for(const r of n.children.flatMap(t))r.parent=i;return[i]}return n.children.flatMap(t)}return t}function ES(e){if(e instanceof Ic)if(e.numChildren()===1&&!(e.children[0]instanceof qn)){const t=e.children[0];(t instanceof Er||t instanceof ra||t instanceof Pc||t instanceof Mu)&&t.addDimensions(e.fields),t.swapWithParent(),ES(e)}else{const t=e.model.component.data.main;e4(t);const n=sme(e),i=e.children.map(n).flat();for(const r of i)r.parent=t}else e.children.map(ES)}function e4(e){if(e instanceof qn&&e.type===at.Main&&e.numChildren()===1){const t=e.children[0];t instanceof Ic||(t.swapWithParent(),e4(e))}}const OS="scale_",D1=5;function SS(e){for(const t of e){for(const n of t.children)if(n.parent!==t)return!1;if(!SS(t.children))return!1}return!0}function Or(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n}function t4(e,t,n){let i=e.sources,r=!1;return r=Or(new Jpe,i)||r,r=Or(new Xpe(t),i)||r,i=i.filter(o=>o.numChildren()>0),r=Or(new eme,i)||r,i=i.filter(o=>o.numChildren()>0),n||(r=Or(new Qpe,i)||r,r=Or(new ime(t),i)||r,r=Or(new Kpe,i)||r,r=Or(new Zpe,i)||r,r=Or(new nme,i)||r,r=Or(new tme,i)||r,r=Or(new Ype,i)||r,r=Or(new rme,i)||r),e.sources=i,r}function ume(e,t){SS(e.sources);let n=0,i=0;for(let r=0;r<D1&&t4(e,t,!0);r++)n++;e.sources.map(ES);for(let r=0;r<D1&&t4(e,t,!1);r++)i++;SS(e.sources),Math.max(n,i)===D1&&q(`Maximum optimization runs(${D1}) reached.`)}class fi{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,n){return new fi(()=>t(n))}}var lme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function n4(e){kt(e)?cme(e):fme(e)}function cme(e){const t=e.component.scales;for(const n of U(t)){const i=hme(e,n);if(t[n].setWithExplicit("domains",i),pme(e,n),e.component.data.isFaceted){let o=e;for(;!Sr(o)&&o.parent;)o=o.parent;if(o.component.resolve.scale[n]==="shared")for(const s of i.value)Zo(s)&&(s.data=OS+s.data.replace(OS,""))}}}function fme(e){for(const n of e.children)n4(n);const t=e.component.scales;for(const n of U(t)){let i,r=null;for(const o of e.children){const a=o.component.scales[n];if(a){i===void 0?i=a.getWithExplicit("domains"):i=hs(i,a.getWithExplicit("domains"),"domains","scale",CS);const s=a.get("selectionExtent");r&&s&&r.param!==s.param&&q(rce),r=s}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0)}}function dme(e,t,n,i){if(e==="unaggregated"){const{valid:r,reason:o}=i4(t,n);if(!r){q(o);return}}else if(e===void 0&&i.useUnaggregatedDomain){const{valid:r}=i4(t,n);if(r)return"unaggregated"}return e}function hme(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=dme(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),t==="x"&&$t(i.x2)?$t(i.x)?hs(bs(n,r,e,"x"),bs(n,r,e,"x2"),"domain","scale",CS):bs(n,r,e,"x2"):t==="y"&&$t(i.y2)?$t(i.y)?hs(bs(n,r,e,"y"),bs(n,r,e,"y2"),"domain","scale",CS):bs(n,r,e,"y2"):bs(n,r,e,t)}function gme(e,t,n){return e.map(i=>({signal:`{data: ${f1(i,{timeUnit:n,type:t})}}`}))}function AS(e,t,n){var i;const r=(i=Bn(n))===null||i===void 0?void 0:i.unit;return t==="temporal"||r?gme(e,t,r):[e]}function bs(e,t,n,i){const{encoding:r}=n,o=$t(r[i]),{type:a}=o,s=o.timeUnit;if(Tfe(t)){const f=bs(e,void 0,n,i),d=AS(t.unionWith,a,s);return bo([...f.value,...d])}else{if(oe(t))return bo([t]);if(t&&t!=="unaggregated"&&!mI(t))return bo(AS(t,a,s))}const u=n.stack;if(u&&i===u.fieldChannel){if(u.offset==="normalize")return Ci([[0,1]]);const f=n.requestDataName(at.Main);return Ci([{data:f,field:n.vgField(i,{suffix:"start"})},{data:f,field:n.vgField(i,{suffix:"end"})}])}const l=as(i)&&G(o)?mme(n,i,e):void 0;if(po(o)){const f=AS([o.datum],a,s);return Ci(f)}const c=o;if(t==="unaggregated"){const f=n.requestDataName(at.Main),{field:d}=o;return Ci([{data:f,field:V({field:d,aggregate:"min"})},{data:f,field:V({field:d,aggregate:"max"})}])}else if(ot(c.bin)){if(Ht(e))return Ci(e==="bin-ordinal"?[]:[{data:gh(l)?n.requestDataName(at.Main):n.requestDataName(at.Raw),field:n.vgField(i,Ch(c,i)?{binSuffix:"range"}:{}),sort:l===!0||!Q(l)?{field:n.vgField(i,{}),op:"min"}:l}]);{const{bin:f}=c;if(ot(f)){const d=bS(n,c.field,f);return Ci([new fi(()=>{const h=n.getSignalName(d);return`[${h}.start, ${h}.stop]`})])}else return Ci([{data:n.requestDataName(at.Main),field:n.vgField(i,{})}])}}else if(c.timeUnit&&De(["time","utc"],e)&&II(c,kt(n)?n.encoding[Jo(i)]:void 0,n.markDef,n.config)){const f=n.requestDataName(at.Main);return Ci([{data:f,field:n.vgField(i)},{data:f,field:n.vgField(i,{suffix:"end"})}])}else return Ci(l?[{data:gh(l)?n.requestDataName(at.Main):n.requestDataName(at.Raw),field:n.vgField(i),sort:l}]:[{data:n.requestDataName(at.Main),field:n.vgField(i)}])}function kS(e,t){const{op:n,field:i,order:r}=e;return Object.assign(Object.assign({op:n!=null?n:t?"sum":i1},i?{field:Wi(i)}:{}),r?{order:r}:{})}function pme(e,t){var n;const i=e.component.scales[t],r=e.specifiedScales[t].domain,o=(n=e.fieldDef(t))===null||n===void 0?void 0:n.bin,a=mI(r)&&r,s=xu(o)&&G0(o.extent)&&o.extent;(a||s)&&i.set("selectionExtent",a!=null?a:s,!0)}function mme(e,t,n){if(!Ht(n))return;const i=e.fieldDef(t),r=i.sort;if(RI(r))return{op:"min",field:$c(i,t),order:"ascending"};const{stack:o}=e,a=o?new Set([...o.groupbyFields,...o.stackBy.map(s=>s.fieldDef.field)]):void 0;if(go(r)){const s=o&&!a.has(r.field);return kS(r,s)}else if(NI(r)){const{encoding:s,order:u}=r,l=e.fieldDef(s),{aggregate:c,field:f}=l,d=o&&!a.has(f);if(Qo(c)||ss(c))return kS({field:V(l),order:u},d);if(HE(c)||!c)return kS({op:c,field:f,order:u},d)}else{if(r==="descending")return{op:"min",field:e.vgField(t),order:"descending"};if(De(["ascending",void 0],r))return!0}}function i4(e,t){const{aggregate:n,type:i}=e;return n?K(n)&&!Ble.has(n)?{valid:!1,reason:Dce(n)}:i==="quantitative"&&t==="log"?{valid:!1,reason:Nce(e)}:{valid:!0}:{valid:!1,reason:Mce(e)}}function CS(e,t,n,i){return e.explicit&&t.explicit&&q(Ice(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]}}function yme(e){const t=io(e.map(a=>Zo(a)?lme(a,["sort"]):a),Me),n=io(e.map(a=>{if(Zo(a)){const s=a.sort;return s!==void 0&&!gh(s)&&("op"in s&&s.op==="count"&&delete s.field,s.order==="ascending"&&delete s.order),s}}).filter(a=>a!==void 0),Me);if(t.length===0)return;if(t.length===1){const a=e[0];if(Zo(a)&&n.length>0){let s=n[0];if(n.length>1)q(ZL),s=!0;else if(Q(s)&&"field"in s){const u=s.field;a.field===u&&(s=s.order?{order:s.order}:!0)}return Object.assign(Object.assign({},a),{sort:s})}return a}const i=io(n.map(a=>gh(a)||!("op"in a)||K(a.op)&&a.op in Lle?a:(q(zce(a)),!0)),Me);let r;i.length===1?r=i[0]:i.length>1&&(q(ZL),r=!0);const o=io(e.map(a=>Zo(a)?a.data:null),a=>a);return o.length===1&&o[0]!==null?Object.assign({data:o[0],fields:t.map(s=>s.field)},r?{sort:r}:{}):Object.assign({fields:t},r?{sort:r}:{})}function TS(e){if(Zo(e)&&K(e.field))return e.field;if(qle(e)){let t;for(const n of e.fields)if(Zo(n)&&K(n.field)){if(!t)t=n.field;else if(t!==n.field)return q(Bce),t}return q(Uce),t}else if(Wle(e)){q(qce);const t=e.fields[0];return K(t)?t:void 0}}function N1(e,t){const i=e.component.scales[t].get("domains").map(r=>(Zo(r)&&(r.data=e.lookupDataSource(r.data)),r));return yme(i)}var vme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function r4(e){return zc(e)||DS(e)?e.children.reduce((t,n)=>t.concat(r4(n)),o4(e)):o4(e)}function o4(e){return U(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:a,selectionExtent:s,domains:u,range:l,reverse:c}=r,f=vme(r,["name","type","selectionExtent","domains","range","reverse"]),d=bme(r.range,o,n,e),h=N1(e,n),g=s?lge(e,s,i,h):null;return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},h?{domain:h}:{}),g?{domainRaw:g}:{}),{range:d}),c!==void 0?{reverse:c}:{}),f)),t},[])}function bme(e,t,n,i){if(rn(n)){if(ls(e))return{step:{signal:`${t}_step`}}}else if(Q(e)&&Zo(e))return Object.assign(Object.assign({},e),{data:i.lookupDataSource(e.data)});return e}class a4 extends ia{constructor(t,n){super({},{name:t});this.merged=!1,this.setWithExplicit("type",n)}domainDefinitelyIncludesZero(){return this.get("zero")!==!1?!0:pu(this.get("domains"),t=>P(t)&&t.length===2&&t[0]<=0&&t[1]>=0)}}const xme=["range","scheme"];function wme(e){const t=e.component.scales;for(const n of H0){const i=t[n];if(!i)continue;const r=_me(n,e);i.setWithExplicit("range",r)}}function s4(e,t){const n=e.fieldDef(t);if(n==null?void 0:n.bin){const{bin:i,field:r}=n,o=ui(t),a=e.getName(o);if(Q(i)&&i.binned&&i.step!==void 0)return new fi(()=>{const s=e.scaleName(t),u=`(domain("${s}")[1] - domain("${s}")[0]) / ${i.step}`;return`${e.getSignalName(a)} / (${u})`});if(ot(i)){const s=bS(e,r,i);return new fi(()=>{const u=e.getSignalName(s),l=`(${u}.stop - ${u}.start) / ${u}.step`;return`${e.getSignalName(a)} / (${l})`})}}}function _me(e,t){const n=t.specifiedScales[e],{size:i}=t,o=t.getScaleComponent(e).get("type");for(const f of xme)if(n[f]!==void 0){const d=hO(o,f),h=yI(e,f);if(!d)q(JL(o,f,e));else if(h)q(h);else switch(f){case"range":{const g=n.range;if(P(g)){if(rn(e))return bo(g.map(p=>{if(p==="width"||p==="height"){const m=t.getName(p),y=t.getSignalName.bind(t);return fi.fromName(y,m)}return p}))}else if(Q(g))return bo({data:t.requestDataName(at.Main),field:g.field,sort:{op:"min",field:t.vgField(e)}});return bo(g)}case"scheme":return bo(Eme(n[f]))}}const a=e===pt||e==="xOffset"?"width":"height",s=i[a];if(vo(s)){if(rn(e))if(Ht(o)){const f=u4(s,t,e);if(f)return bo({step:f})}else q(QL(a));else if(bc(e)){const f=e===es?"x":"y";if(t.getScaleComponent(f).get("type")==="band"){const g=l4(s,o);if(g)return bo(g)}}}const{rangeMin:u,rangeMax:l}=n,c=Ome(e,t);return(u!==void 0||l!==void 0)&&hO(o,"rangeMin")&&P(c)&&c.length===2?bo([u!=null?u:c[0],l!=null?l:c[1]]):Ci(c)}function Eme(e){return Cfe(e)?Object.assign({scheme:e.name},Si(e,["name"])):{scheme:e}}function Ome(e,t){const{size:n,config:i,mark:r,encoding:o}=t,a=t.getSignalName.bind(t),{type:s}=$t(o[e]),l=t.getScaleComponent(e).get("type"),{domain:c,domainMid:f}=t.specifiedScales[e];switch(e){case pt:case Wt:{if(De(["point","band"],l)){const g=c4(e,n,i.view);if(vo(g))return{step:u4(g,t,e)}}const d=ui(e),h=t.getName(d);return e===Wt&&ki(l)?[fi.fromName(a,h),0]:[0,fi.fromName(a,h)]}case es:case yc:return Sme(e,t,l);case Xo:{const d=t.component.scales[e].get("zero"),h=f4(r,d,i),g=Cme(r,n,t,i);return Ec(l)?kme(h,g,Ame(l,i,c,e)):[h,g]}case br:return[0,Math.PI*2];case yu:return[0,360];case oo:return[0,new fi(()=>{const d=t.getSignalName("width"),h=t.getSignalName("height");return`min(${d},${h})/2`})];case is:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case rs:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case si:return"symbol";case ai:case uo:case lo:return l==="ordinal"?s==="nominal"?"category":"ordinal":f!==void 0?"diverging":r==="rect"||r==="geoshape"?"heatmap":"ramp";case Ko:case ts:case ns:return[i.scale.minOpacity,i.scale.maxOpacity]}}function u4(e,t,n){var i,r,o,a,s;const{encoding:u}=t,l=t.getScaleComponent(n),c=_L(n),f=u[c];if(vP({step:e,offsetIsDiscrete:ye(f)&&cI(f.type)})==="offset"&&JI(u,c)){const h=t.getScaleComponent(c);let p=`domain('${t.scaleName(c)}').length`;if(h.get("type")==="band"){const y=(r=(i=h.get("paddingInner"))!==null&&i!==void 0?i:h.get("padding"))!==null&&r!==void 0?r:0,v=(a=(o=h.get("paddingOuter"))!==null&&o!==void 0?o:h.get("padding"))!==null&&a!==void 0?a:0;p=`bandspace(${p}, ${y}, ${v})`}const m=(s=l.get("paddingInner"))!==null&&s!==void 0?s:l.get("padding");return{signal:`${e.step} * ${p} / (1-${Yle(m)})`}}else return e.step}function l4(e,t){if(vP({step:e,offsetIsDiscrete:Ht(t)})==="offset")return{step:e.step}}function Sme(e,t,n){const i=e===es?"x":"y",o=t.getScaleComponent(i).get("type"),a=t.scaleName(i);if(o==="band"){const s=c4(i,t.size,t.config.view);if(vo(s)){const u=l4(s,n);if(u)return u}return[0,{signal:`bandwidth('${a}')`}]}else return lL(`Cannot use ${e} scale if ${i} scale is not discrete.`)}function c4(e,t,n){const i=e===pt?"width":"height",r=t[i];return r||b1(n,i)}function Ame(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return n!==void 0&&P(n)?n.length+1:(q(Qce(i)),3)}}function kme(e,t,n){const i=()=>{const r=ea(t),o=ea(e),a=`(${r} - ${o}) / (${n} - 1)`;return`sequence(${o}, ${r} + ${a}, ${a})`};return oe(t)?new fi(i):{signal:i()}}function f4(e,t,n){if(t)return oe(t)?{signal:`${t.signal} ? 0 : ${f4(e,!1,n)}`}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Y0("size",e))}const d4=.95;function Cme(e,t,n,i){const r={x:s4(n,"x"),y:s4(n,"y")};switch(e){case"bar":case"tick":{if(i.scale.maxBandSize!==void 0)return i.scale.maxBandSize;const o=h4(t,r,i.view);return Je(o)?o-1:new fi(()=>`${o.signal} - 1`)}case"line":case"trail":case"rule":return i.scale.maxStrokeWidth;case"text":return i.scale.maxFontSize;case"point":case"square":case"circle":{if(i.scale.maxSize)return i.scale.maxSize;const o=h4(t,r,i.view);return Je(o)?Math.pow(d4*o,2):new fi(()=>`pow(${d4} * ${o.signal}, 2)`)}}throw new Error(Y0("size",e))}function h4(e,t,n){const i=vo(e.width)?e.width.step:v1(n,"width"),r=vo(e.height)?e.height.step:v1(n,"height");return t.x||t.y?new fi(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r)}function g4(e,t){kt(e)?Tme(e,t):y4(e,t)}function Tme(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:o,specifiedScales:a}=e;for(const s of U(n)){const u=a[s],l=n[s],c=e.getScaleComponent(s),f=$t(r[s]),d=u[t],h=c.get("type"),g=c.get("padding"),p=c.get("paddingInner"),m=hO(h,t),y=yI(s,t);if(d!==void 0&&(m?y&&q(y):q(JL(h,t,s))),m&&y===void 0)if(d!==void 0){const v=f.timeUnit,x=f.type;switch(t){case"domainMax":case"domainMin":_u(u[t])||x==="temporal"||v?l.set(t,{signal:f1(u[t],{type:x,timeUnit:v})},!0):l.set(t,u[t],!0);break;default:l.copyKeyFromObject(t,u)}}else{const v=t in p4?p4[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:h,scalePadding:g,scalePaddingInner:p,domain:u.domain,domainMin:u.domainMin,domainMax:u.domainMax,markDef:o,config:i,hasNestedOffsetScale:MO(r,s)}):i.scale[t];v!==void 0&&l.set(t,v,!1)}}}const p4={bins:({model:e,fieldOrDatumDef:t})=>G(t)?Fme(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>Mme(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:o})=>Dme(e,t,n,i,r,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>Nme(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:o})=>Rme(e,t,n.type,i,r.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:o})=>jme(e,t,n,i,r.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>{const r=G(e)?e.sort:void 0;return $me(t,r,n,i.scale)},zero:({channel:e,fieldOrDatumDef:t,domain:n,markDef:i,scaleType:r})=>Lme(e,t,n,i,r)};function m4(e){kt(e)?wme(e):y4(e,"range")}function y4(e,t){const n=e.component.scales;for(const i of e.children)t==="range"?m4(i):g4(i,t);for(const i of U(n)){let r;for(const o of e.children){const a=o.component.scales[i];if(a){const s=a.getWithExplicit(t);r=hs(r,s,t,"scale",HP((u,l)=>{switch(t){case"range":return u.step&&l.step?u.step-l.step:0}return 0}))}}n[i].setWithExplicit(t,r)}}function Fme(e,t){const n=t.bin;if(ot(n)){const i=bS(e,t.field,n);return new fi(()=>e.getSignalName(i))}else if(zn(n)&&xu(n)&&n.step!==void 0)return{step:n.step}}function Mme(e,t){if(De([ai,uo,lo],e)&&t!=="nominal")return"hcl"}function Dme(e,t,n,i,r,o){var a;if(!(((a=yo(o))===null||a===void 0?void 0:a.bin)||P(n)||r!=null||i!=null||De([ci.TIME,ci.UTC],e)))return rn(t)?!0:void 0}function Nme(e,t,n,i,r,o){if(rn(e)){if(wr(t)){if(n.continuousPadding!==void 0)return n.continuousPadding;const{type:a,orient:s}=r;if(a==="bar"&&!(G(i)&&(i.bin||i.timeUnit))&&(s==="vertical"&&e==="x"||s==="horizontal"&&e==="y"))return o.continuousBandSize}if(t===ci.POINT)return n.pointPadding}}function Rme(e,t,n,i,r,o=!1){if(e===void 0){if(rn(t)){const{bandPaddingInner:a,barBandPaddingInner:s,rectBandPaddingInner:u,bandWithNestedOffsetPaddingInner:l}=r;return o?l:At(a,n==="bar"?s:u)}else if(bc(t)&&i===ci.BAND)return r.offsetBandPaddingInner}}function jme(e,t,n,i,r,o=!1){if(e===void 0){if(rn(t)){const{bandPaddingOuter:a,bandWithNestedOffsetPaddingOuter:s}=r;if(o)return s;if(n===ci.BAND)return At(a,oe(i)?{signal:`${i.signal}/2`}:i/2)}else if(bc(t)){if(n===ci.POINT)return .5;if(n===ci.BAND)return r.offsetBandPaddingOuter}}}function $me(e,t,n,i){if(n==="x"&&i.xReverse!==void 0)return ki(e)&&t==="descending"?oe(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(ki(e)&&t==="descending")return!0}function Lme(e,t,n,i,r){if(!!n&&n!=="unaggregated"&&ki(r)){if(P(n)){const a=n[0],s=n[n.length-1];if(a<=0&&s>=0)return!0}return!1}if(e==="size"&&t.type==="quantitative"&&!Ec(r))return!0;if(!(G(t)&&t.bin)&&De([...co,...Tle],e)){const{orient:a,type:s}=i;return!(De(["bar","area","line","trail"],s)&&(a==="horizontal"&&e==="y"||a==="vertical"&&e==="x"))}return!1}function Ime(e,t,n,i,r=!1){const o=Pme(t,n,i,r),{type:a}=e;return as(t)?a!==void 0?jfe(t,a)?G(n)&&!Rfe(a,n.type)?(q($ce(a,o)),o):a:(q(jce(t,a,o)),o):o:null}function Pme(e,t,n,i){var r;switch(t.type){case"nominal":case"ordinal":{if(vc(e)||WE(e)==="discrete")return e==="shape"&&t.type==="ordinal"&&q(JE(e,"ordinal")),"ordinal";if(rn(e)||bc(e)){if(De(["rect","bar","image","rule"],n.type)||i)return"band"}else if(n.type==="arc"&&e in qE)return"band";const o=n[ui(e)];return Oc(o)||kO(t)&&((r=t.axis)===null||r===void 0?void 0:r.tickBand)?"band":"point"}case"temporal":return vc(e)?"time":WE(e)==="discrete"?(q(JE(e,"temporal")),"ordinal"):G(t)&&t.timeUnit&&Bn(t.timeUnit).utc?"utc":"time";case"quantitative":return vc(e)?G(t)&&ot(t.bin)?"bin-ordinal":"linear":WE(e)==="discrete"?(q(JE(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(XL(t.type))}function zme(e,{ignoreRange:t}={}){v4(e),n4(e);for(const n of Nfe)g4(e,n);t||m4(e)}function v4(e){kt(e)?e.component.scales=Bme(e):e.component.scales=qme(e)}function Bme(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const o of H0){const a=$t(t[o]);if(a&&n===xI&&o===si&&a.type===_c)continue;let s=a&&a.scale;if(bc(o)){const u=EL(o);if(!MO(t,u)){s&&q(wce(o));continue}}if(a&&s!==null&&s!==!1){s!=null||(s={});const u=MO(t,o),l=Ime(s,o,a,i,u);r[o]=new a4(e.scaleName(`${o}`,!0),{value:l,explicit:s.type===l})}}return r}const Ume=HP((e,t)=>fI(e)-fI(t));function qme(e){var t,n;const i=e.component.scales={},r={},o=e.component.resolve;for(const a of e.children){v4(a);for(const s of U(a.component.scales))if((t=(n=o.scale)[s])!==null&&t!==void 0||(n[s]=$6(s,e)),o.scale[s]==="shared"){const u=r[s],l=a.component.scales[s].getWithExplicit("type");u?Efe(u.value,l.value)?r[s]=hs(u,l,"type","scale",Ume):(o.scale[s]="independent",delete r[s]):r[s]=l}}for(const a of U(r)){const s=e.scaleName(a,!0),u=r[a];i[a]=new a4(s,u);for(const l of e.children){const c=l.component.scales[a];c&&(l.renameScale(c.get("name"),s),c.merged=!0)}}return i}var FS=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class MS{constructor(){this.nameMap={}}rename(t,n){this.nameMap[t]=n}has(t){return this.nameMap[t]!==void 0}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function kt(e){return(e==null?void 0:e.type)==="unit"}function Sr(e){return(e==null?void 0:e.type)==="facet"}function DS(e){return(e==null?void 0:e.type)==="concat"}function zc(e){return(e==null?void 0:e.type)==="layer"}class NS{constructor(t,n,i,r,o,a,s){var u,l;this.type=n,this.parent=i,this.config=o,this.correctDataNames=c=>{var f,d,h;return((f=c.from)===null||f===void 0?void 0:f.data)&&(c.from.data=this.lookupDataSource(c.from.data)),((h=(d=c.from)===null||d===void 0?void 0:d.facet)===null||h===void 0?void 0:h.data)&&(c.from.facet.data=this.lookupDataSource(c.from.facet.data)),c},this.parent=i,this.config=o,this.view=li(s),this.name=(u=t.name)!==null&&u!==void 0?u:r,this.title=us(t.title)?{text:t.title}:t.title?li(t.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new MS,this.projectionNameMap=i?i.projectionNameMap:new MS,this.signalNameMap=i?i.signalNameMap:new MS,this.data=t.data,this.description=t.description,this.transforms=Ghe((l=t.transform)!==null&&l!==void 0?l:[]),this.layout=n==="layer"||n==="unit"?{}:Qde(t,n,o),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:r1(t)||(i==null?void 0:i.component.data.isFaceted)&&t.data===void 0},layoutSize:new ia,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},a?be(a):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){zme(this)}parseProjection(){X6(this)}renameTopLevelLayoutSizeSignal(){this.getName("width")!=="width"&&this.renameSignal(this.getName("width"),"width"),this.getName("height")!=="height"&&this.renameSignal(this.getName("height"),"height")}parseLegends(){W6(this)}assembleEncodeFromView(t){const n=FS(t,["style"]),i={};for(const r of U(n)){const o=n[r];o!==void 0&&(i[r]=lt(o))}return i}assembleGroupEncodeEntry(t){let n={};return this.view&&(n=this.assembleEncodeFromView(this.view)),!t&&(this.description&&(n.description=lt(this.description)),this.type==="unit"||this.type==="layer")?Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},n!=null?n:{}):Ze(n)?void 0:n}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:n}=t,i=FS(t,["spacing"]),{component:r,config:o}=this,a=ape(r.layoutHeaders,o);return Object.assign(Object.assign(Object.assign({padding:n},this.assembleDefaultLayout()),i),a?{titleBand:a}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let n=[];for(const i of Gi)t[i].title&&n.push(epe(this,i));for(const i of hS)n=n.concat(tpe(this,i));return n}assembleAxes(){return Uge(this.component.axes,this.config)}assembleLegends(){return G6(this)}assembleProjections(){return Fpe(this)}assembleTitle(){var t,n,i;const r=(t=this.title)!==null&&t!==void 0?t:{},{encoding:o}=r,a=FS(r,["encoding"]),s=Object.assign(Object.assign(Object.assign({},ML(this.config.title).nonMarkTitleProperties),a),o?{encode:{update:o}}:{});if(s.text)return De(["unit","layer"],this.type)?De(["middle",void 0],s.anchor)&&((n=s.frame)!==null&&n!==void 0||(s.frame="group")):(i=s.anchor)!==null&&i!==void 0||(s.anchor="start"),Ze(s)?void 0:s}assembleGroup(t=[]){const n={};t=t.concat(this.assembleSignals()),t.length>0&&(n.signals=t);const i=this.assembleLayout();i&&(n.layout=i),n.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Sr(this.parent)?r4(this):[];r.length>0&&(n.scales=r);const o=this.assembleAxes();o.length>0&&(n.axes=o);const a=this.assembleLegends();return a.length>0&&(n.legends=a),n}getName(t){return ht((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(at[t].toLowerCase())}requestDataName(t){const n=this.getDataName(t),i=this.component.data.outputNodeRefCounts;return i[n]=(i[n]||0)+1,n}getSizeSignalRef(t){if(Sr(this.parent)){const n=R6(t),i=W0(n),r=this.component.scales[i];if(r&&!r.merged){const o=r.get("type"),a=r.get("range");if(Ht(o)&&ls(a)){const s=r.get("name"),u=N1(this,i),l=TS(u);if(l){const c=V({aggregate:"distinct",field:l},{expr:"datum"});return{signal:N6(s,r,c)}}else return q(XE(i)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const n=this.component.data.outputNodes[t];return n?n.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,n){this.signalNameMap.rename(t,n)}renameScale(t,n){this.scaleNameMap.rename(t,n)}renameProjection(t,n){this.projectionNameMap.rename(t,n)}scaleName(t,n){if(n)return this.getName(t);if(xL(t)&&as(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t)))return this.scaleNameMap.get(this.getName(t))}projectionName(t){if(t)return this.getName("projection");if(this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection")))return this.projectionNameMap.get(this.getName("projection"))}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const n=this.component.scales[t];return n&&!n.merged?n:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,n){let i=this.component.selection[t];if(!i&&this.parent&&(i=this.parent.getSelectionComponent(t,n)),!i)throw new Error(Zle(n));return i}hasAxisOrientSignalRef(){var t,n;return((t=this.component.axes.x)===null||t===void 0?void 0:t.some(i=>i.hasOrientSignalRef()))||((n=this.component.axes.y)===null||n===void 0?void 0:n.some(i=>i.hasOrientSignalRef()))}}class b4 extends NS{vgField(t,n={}){const i=this.fieldDef(t);if(!!i)return V(i,n)}reduceFieldDef(t,n){return Ade(this.getMapping(),(i,r,o)=>{const a=yo(r);return a?t(i,a,o):i},n)}forEachFieldDef(t,n){NO(this.getMapping(),(i,r)=>{const o=yo(i);o&&t(o,r)},n)}}var Wme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class R1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"value",(o=a[1])!==null&&o!==void 0?o:"density"]}clone(){return new R1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Me(this.transform)}`}assemble(){const t=this.transform,{density:n}=t,i=Wme(t,["density"]);return Object.assign({type:"kde",field:n},i)}}class Ph extends et{constructor(t,n){super(t);this.filter=n}clone(){return new Ph(null,Object.assign({},this.filter))}static make(t,n){const{config:i,mark:r,markDef:o}=n;if(He("invalid",o,i)!=="filter")return null;const s=n.reduceFieldDef((u,l,c)=>{const f=as(c)&&n.getScaleComponent(c);if(f){const d=f.get("type");ki(d)&&l.aggregate!=="count"&&!cs(r)&&(u[l.field]=l)}return u},{});return U(s).length?new Ph(t,s):null}dependentFields(){return new Set(U(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Me(this.filter)}`}assemble(){const t=U(this.filter).reduce((n,i)=>{const r=this.filter[i],o=V(r,{expr:"datum"});return r!==null&&(r.type==="temporal"?n.push(`(isDate(${o}) || (isValid(${o}) && isFinite(+${o})))`):r.type==="quantitative"&&(n.push(`isValid(${o})`),n.push(`isFinite(+${o})`))),n},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class j1 extends et{constructor(t,n){super(t);this.transform=n,this.transform=be(n);const{flatten:i,as:r=[]}=this.transform;this.transform.as=i.map((o,a)=>{var s;return(s=r[a])!==null&&s!==void 0?s:o})}clone(){return new j1(this.parent,be(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Me(this.transform)}`}assemble(){const{flatten:t,as:n}=this.transform;return{type:"flatten",fields:t,as:n}}}class $1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"key",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new $1(null,be(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Me(this.transform)}`}assemble(){const{fold:t,as:n}=this.transform;return{type:"fold",fields:t,as:n}}}class Bc extends et{constructor(t,n,i,r){super(t);this.fields=n,this.geojson=i,this.signal=r}clone(){return new Bc(null,be(this.fields),this.geojson,this.signal)}static parseAll(t,n){if(n.component.projection&&!n.component.projection.isFit)return t;let i=0;for(const r of[[so,ao],[Hi,xr]]){const o=r.map(a=>{const s=$t(n.encoding[a]);return G(s)?s.field:po(s)?{expr:`${s.datum}`}:_r(s)?{expr:`${s.value}`}:void 0});(o[0]||o[1])&&(t=new Bc(t,o,null,n.getName(`geojson_${i++}`)))}if(n.channelHasField(si)){const r=n.typedFieldDef(si);r.type===_c&&(t=new Bc(t,null,r.field,n.getName(`geojson_${i++}`)))}return t}dependentFields(){var t;const n=((t=this.fields)!==null&&t!==void 0?t:[]).filter(K);return new Set([...this.geojson?[this.geojson]:[],...n])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Me(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class zh extends et{constructor(t,n,i,r){super(t);this.projection=n,this.fields=i,this.as=r}clone(){return new zh(null,this.projection,be(this.fields),be(this.as))}static parseAll(t,n){if(!n.projectionName())return t;for(const i of[[so,ao],[Hi,xr]]){const r=i.map(a=>{const s=$t(n.encoding[a]);return G(s)?s.field:po(s)?{expr:`${s.datum}`}:_r(s)?{expr:`${s.value}`}:void 0}),o=i[0]===Hi?"2":"";(r[0]||r[1])&&(t=new zh(t,n.projectionName(),r,[n.getName(`x${o}`),n.getName(`y${o}`)]))}return t}dependentFields(){return new Set(this.fields.filter(K))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Me(this.fields)} ${Me(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Du extends et{constructor(t,n){super(t);this.transform=n}clone(){return new Du(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:n=0,stop:i,step:r}=t;return{signal:`sequence(${[n,i,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,n){return new Du(t,n)}static makeFromEncoding(t,n){const i=n.encoding,r=i.x,o=i.y;if(G(r)&&G(o)){const a=r.impute?r:o.impute?o:void 0;if(a===void 0)return;const s=r.impute?o:o.impute?r:void 0,{method:u,value:l,frame:c,keyvals:f}=a.impute,d=ZI(n.mark,i);return new Du(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:a.field,key:s.field},u?{method:u}:{}),l!==void 0?{value:l}:{}),c?{frame:c}:{}),f!==void 0?{keyvals:f}:{}),d.length?{groupby:d}:{}))}return null}hash(){return`Impute ${Me(this.transform)}`}assemble(){const{impute:t,key:n,keyvals:i,method:r,groupby:o,value:a,frame:s=[null,null]}=this.transform,u=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},i?{keyvals:Che(i)?this.processSequence(i):i}:{}),{method:"value"}),o?{groupby:o}:{}),{value:!r||r==="value"?a:null});if(r&&r!=="value"){const l=Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:s,ignorePeers:!1},o?{groupby:o}:{}),c={type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t};return[u,l,c]}else return[u]}}var Hme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class L1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.loess]}clone(){return new L1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Me(this.transform)}`}assemble(){const t=this.transform,{loess:n,on:i}=t,r=Hme(t,["loess","on"]);return Object.assign({type:"loess",x:i,y:n},r)}}class Bh extends et{constructor(t,n,i){super(t);this.transform=n,this.secondary=i}clone(){return new Bh(null,be(this.transform),this.secondary)}static make(t,n,i,r){const o=n.component.data.sources,{from:a}=i;let s=null;if(The(a)){let u=E4(a.data,o);u||(u=new Tu(a.data),o.push(u));const l=n.getName(`lookup_${r}`);s=new qn(u,l,at.Lookup,n.component.data.outputNodeRefCounts),n.component.data.outputNodes[l]=s}else if(Fhe(a)){const u=a.param;i=Object.assign({as:u},i);let l;try{l=n.getSelectionComponent(ht(u),u)}catch{throw new Error(nce(u))}if(s=l.materialized,!s)throw new Error(ice(u))}return new Bh(t,i,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?J(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Me({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:J(this.transform.as)}:{});else{let n=this.transform.as;K(n)||(q(fce),n="_lookup"),t={as:[n]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var Gme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class I1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:"prob",(o=a[1])!==null&&o!==void 0?o:"value"]}clone(){return new I1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Me(this.transform)}`}assemble(){const t=this.transform,{quantile:n}=t,i=Gme(t,["quantile"]);return Object.assign({type:"quantile",field:n},i)}}var Vme=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};class P1 extends et{constructor(t,n){var i,r,o;super(t);this.transform=n,this.transform=be(n);const a=(i=this.transform.as)!==null&&i!==void 0?i:[void 0,void 0];this.transform.as=[(r=a[0])!==null&&r!==void 0?r:n.on,(o=a[1])!==null&&o!==void 0?o:n.regression]}clone(){return new P1(null,be(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Me(this.transform)}`}assemble(){const t=this.transform,{regression:n,on:i}=t,r=Vme(t,["regression","on"]);return Object.assign({type:"regression",x:i,y:n},r)}}class z1 extends et{constructor(t,n){super(t);this.transform=n}clone(){return new z1(null,be(this.transform))}addDimensions(t){var n;this.transform.groupby=io(((n=this.transform.groupby)!==null&&n!==void 0?n:[]).concat(t),i=>i)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...(t=this.transform.groupby)!==null&&t!==void 0?t:[]])}hash(){return`PivotTransform ${Me(this.transform)}`}assemble(){const{pivot:t,value:n,groupby:i,limit:r,op:o}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},r!==void 0?{limit:r}:{}),o!==void 0?{op:o}:{}),i!==void 0?{groupby:i}:{})}}class B1 extends et{constructor(t,n){super(t);this.transform=n}clone(){return new B1(null,be(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Me(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function x4(e){let t=0;function n(i,r){var o;if(i instanceof Tu&&!i.isGenerator&&!Tc(i.data)&&(e.push(r),r={name:null,source:r.name,transform:[]}),i instanceof Sn&&(i.parent instanceof Tu&&!r.source?(r.format=Object.assign(Object.assign({},(o=r.format)!==null&&o!==void 0?o:{}),{parse:i.assembleFormatParse()}),r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Ic){r.name||(r.name=`data_${t++}`),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,e.push(...i.assemble());return}switch((i instanceof $h||i instanceof Lh||i instanceof Ph||i instanceof Rc||i instanceof jc||i instanceof zh||i instanceof Er||i instanceof Bh||i instanceof Pc||i instanceof Mu||i instanceof $1||i instanceof j1||i instanceof R1||i instanceof L1||i instanceof I1||i instanceof P1||i instanceof vs||i instanceof B1||i instanceof z1)&&r.transform.push(i.assemble()),(i instanceof wo||i instanceof xo||i instanceof Du||i instanceof ra||i instanceof Bc)&&r.transform.push(...i.assemble()),i instanceof qn&&(r.source&&r.transform.length===0?i.setSource(r.source):i.parent instanceof qn?i.setSource(r.name):(r.name||(r.name=`data_${t++}`),i.setSource(r.name),i.numChildren()===1&&(e.push(r),r={name:null,source:r.name,transform:[]}))),i.numChildren()){case 0:i instanceof qn&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name=`data_${t++}`);let a=r.name;!r.source||r.transform.length>0?e.push(r):a=r.source;for(const s of i.children)n(s,{name:null,source:a,transform:[]});break}}}return n}function Yme(e){const t=[],n=x4(t);for(const i of e.children)n(i,{source:e.name,name:null,transform:[]});return t}function Xme(e,t){var n,i;const r=[],o=x4(r);let a=0;for(const u of e.sources){u.hasName()||(u.dataName=`source_${a++}`);const l=u.assemble();o(u,l)}for(const u of r)u.transform.length===0&&delete u.transform;let s=0;for(const[u,l]of r.entries())((n=l.transform)!==null&&n!==void 0?n:[]).length===0&&!l.source&&r.splice(s++,0,r.splice(u,1)[0]);for(const u of r)for(const l of(i=u.transform)!==null&&i!==void 0?i:[])l.type==="lookup"&&(l.from=e.outputNodes[l.from].getSource());for(const u of r)u.name in t&&(u.values=t[u.name]);return r}function Kme(e){return e==="top"||e==="left"||oe(e)?"header":"footer"}function Jme(e){for(const t of Gi)Qme(e,t);_4(e,"x"),_4(e,"y")}function Qme(e,t){var n;const{facet:i,config:r,child:o,component:a}=e;if(e.channelHasField(t)){const s=i[t],u=Lc("title",null,r,t);let l=Sc(s,r,{allowDisabling:!0,includeDefault:u===void 0||!!u});o.component.layoutHeaders[t].title&&(l=P(l)?l.join(", "):l,l+=` / ${o.component.layoutHeaders[t].title}`,o.component.layoutHeaders[t].title=null);const c=Lc("labelOrient",s.header,r,t),f=s.header!==null?At((n=s.header)===null||n===void 0?void 0:n.labels,r.header.labels,!0):!1,d=De(["bottom","right"],c)?"footer":"header";a.layoutHeaders[t]={title:s.header!==null?l:null,facetFieldDef:s,[d]:t==="facet"?[]:[w4(e,t,f)]}}}function w4(e,t,n){const i=t==="row"?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]}}function _4(e,t){var n;const{child:i}=e;if(i.component.axes[t]){const{layoutHeaders:r,resolve:o}=e.component;if(o.axis[t]=yS(o,t),o.axis[t]==="shared"){const a=t==="x"?"column":"row",s=r[a];for(const u of i.component.axes[t]){const l=Kme(u.get("orient"));(n=s[l])!==null&&n!==void 0||(s[l]=[w4(e,a,!1)]);const c=jh(u,"main",e.config,{header:!0});c&&s[l][0].axes.push(c),u.mainExtracted=!0}}}}function Zme(e){RS(e),U1(e,"width"),U1(e,"height")}function e0e(e){RS(e);const t=e.layout.columns===1?"width":"childWidth",n=e.layout.columns===void 0?"height":"childHeight";U1(e,t),U1(e,n)}function RS(e){for(const t of e.children)t.parseLayoutSize()}function U1(e,t){var n;const i=R6(t),r=W0(i),o=e.component.resolve,a=e.component.layoutSize;let s;for(const u of e.children){const l=u.component.layoutSize.getWithExplicit(i),c=(n=o.scale[r])!==null&&n!==void 0?n:$6(r,e);if(c==="independent"&&l.value==="step"){s=void 0;break}if(s){if(c==="independent"&&s.value!==l.value){s=void 0;break}s=hs(s,l,i,"")}else s=l}if(s){for(const u of e.children)e.renameSignal(u.getName(i),e.getName(t)),u.component.layoutSize.set(i,"merged",!1);a.setWithExplicit(t,s)}else a.setWithExplicit(t,{explicit:!1,value:void 0})}function t0e(e){const{size:t,component:n}=e;for(const i of co){const r=ui(i);if(t[r]){const o=t[r];n.layoutSize.set(r,vo(o)?"step":o,!0)}else{const o=n0e(e,r);n.layoutSize.set(r,o,!1)}}}function n0e(e,t){const n=t==="width"?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const o=r.get("type"),a=r.get("range");if(Ht(o)){const s=b1(i.view,t);return ls(a)||vo(s)?"step":s}else return HO(i.view,t)}else{if(e.hasProjection||e.mark==="arc")return HO(i.view,t);{const o=b1(i.view,t);return vo(o)?o.step:o}}}function jS(e,t,n){return V(t,Object.assign({suffix:`by_${V(e)}`},n!=null?n:{}))}class Uh extends b4{constructor(t,n,i,r){super(t,"facet",n,i,r,t.resolve);this.child=zS(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Ah(t))return{facet:this.initFacetFieldDef(t,"facet")};const n=U(t),i={};for(const r of n){if(![Ho,Go].includes(r)){q(Y0(r,"facet"));break}const o=t[r];if(o.field===void 0){q(KE(o,r));break}i[r]=this.initFacetFieldDef(o,r)}return i}initFacetFieldDef(t,n){const i=FO(t,n);return i.header?i.header=li(i.header):i.header===null&&(i.header=null),i}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=q1(this),this.child.parseData()}parseLayoutSize(){RS(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),Jme(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,n,i;const r={};for(const o of Gi)for(const a of gS){const s=this.component.layoutHeaders[o],u=s[a],{facetFieldDef:l}=s;if(l){const c=Lc("titleOrient",l.header,this.config,o);if(["right","bottom"].includes(c)){const f=T1(o,c);(t=r.titleAnchor)!==null&&t!==void 0||(r.titleAnchor={}),r.titleAnchor[f]="end"}}if(u==null?void 0:u[0]){const c=o==="row"?"height":"width",f=a==="header"?"headerBand":"footerBand";o!=="facet"&&!this.child.component.layoutSize.get(c)&&((n=r[f])!==null&&n!==void 0||(r[f]={}),r[f][o]=.5),s.title&&((i=r.offset)!==null&&i!==void 0||(r.offset={}),r.offset[o==="row"?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:n}=this.facet,i=t?this.columnDistinctSignal():n?1:void 0;let r="all";return(!n&&this.component.resolve.scale.x==="independent"||!t&&this.component.resolve.scale.y==="independent")&&(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),i?{columns:i}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Uh))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof Uh?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:V(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],n=[],i=[];if(this.child instanceof Uh){if(this.child.channelHasField("column")){const r=V(this.child.facet.column);t.push(r),n.push("distinct"),i.push(`distinct_${r}`)}}else for(const r of co){const o=this.child.component.scales[r];if(o&&!o.merged){const a=o.get("type"),s=o.get("range");if(Ht(a)&&ls(s)){const u=N1(this.child,r),l=TS(u);l?(t.push(l),n.push("distinct"),i.push(`distinct_${l}`)):q(XE(r))}}}return{fields:t,ops:n,as:i}}assembleFacet(){const{name:t,data:n}=this.component.data.facetRoot,{row:i,column:r}=this.facet,{fields:o,ops:a,as:s}=this.getCardinalityAggregateForChild(),u=[];for(const c of Gi){const f=this.facet[c];if(f){u.push(V(f));const{bin:d,sort:h}=f;if(ot(d)&&u.push(V(f,{binSuffix:"end"})),go(h)){const{field:g,op:p=i1}=h,m=jS(f,h);i&&r?(o.push(m),a.push("max"),s.push(m)):(o.push(g),a.push(p),s.push(m))}else if(P(h)){const g=$c(f,c);o.push(g),a.push("max"),s.push(g)}}}const l=!!i&&!!r;return Object.assign({name:t,data:n,groupby:u},l||o.length>0?{aggregate:Object.assign(Object.assign({},l?{cross:l}:{}),o.length?{fields:o,ops:a,as:s}:{})}:{})}facetSortFields(t){const{facet:n}=this,i=n[t];return i?go(i.sort)?[jS(i,i.sort,{expr:"datum"})]:P(i.sort)?[$c(i,t,{expr:"datum"})]:[V(i,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:n}=this,i=n[t];if(i){const{sort:r}=i;return[(go(r)?r.order:!P(r)&&r)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:n,config:i}=this;if(n.facet)return pS(n.facet,"facet",i);const r={row:["top","bottom"],column:["left","right"]};for(const o of hS)if(n[o]){const a=Lc("labelOrient",(t=n[o])===null||t===void 0?void 0:t.header,i,o);if(r[o].includes(a))return pS(n[o],o,i)}}assembleMarks(){const{child:t}=this,n=this.component.data.facetRoot,i=Yme(n),r=t.assembleGroupEncodeEntry(!1),o=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},o?{title:o}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:Gi.map(u=>this.facetSortFields(u)).flat(),order:Gi.map(u=>this.facetSortOrder(u)).flat()}}),i.length>0?{data:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(oge(this,[])))]}getMapping(){return this.facet}}function i0e(e,t){const{row:n,column:i}=t;if(n&&i){let r=null;for(const o of[n,i])if(go(o.sort)){const{field:a,op:s=i1}=o.sort;e=r=new Mu(e,{joinaggregate:[{op:s,field:a,as:jS(o,o.sort,{forAs:!0})}],groupby:[V(o)]})}return r}return null}function E4(e,t){var n,i,r,o;for(const a of t){const s=a.data;if(e.name&&a.hasName()&&e.name!==a.dataName)continue;const u=(n=e.format)===null||n===void 0?void 0:n.mesh,l=(i=s.format)===null||i===void 0?void 0:i.feature;if(u&&l)continue;const c=(r=e.format)===null||r===void 0?void 0:r.feature;if((c||l)&&c!==l)continue;const f=(o=s.format)===null||o===void 0?void 0:o.mesh;if(!((u||f)&&u!==f)){if(Mh(e)&&Mh(s)){if(no(e.values,s.values))return a}else if(Tc(e)&&Tc(s)){if(e.url===s.url)return a}else if(GP(e)&&e.name===a.dataName)return a}}return null}function r0e(e,t){if(e.data||!e.parent){if(e.data===null){const i=new Tu({values:[]});return t.push(i),i}const n=E4(e.data,t);if(n)return gs(e.data)||(n.data.format=cL({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const i=new Tu(e.data);return t.push(i),i}}else return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function o0e(e,t,n){var i,r;let o=0;for(const a of t.transforms){let s,u;if(zhe(a))u=e=new jc(e,a),s="derived";else if(KO(a)){const l=Wpe(a);u=e=(i=Sn.makeWithAncestors(e,{},l,n))!==null&&i!==void 0?i:e,e=new Rc(e,t,a.filter)}else if(LP(a))u=e=wo.makeFromTransform(e,a,t),s="number";else if(Uhe(a))s="date",n.getWithExplicit(a.field).value===void 0&&(e=new Sn(e,{[a.field]:s}),n.set(a.field,s,!1)),u=e=xo.makeFromTransform(e,a);else if(qhe(a))u=e=Er.makeFromTransform(e,a),s="number",uS(t)&&(e=new vs(e));else if($P(a))u=e=Bh.make(e,t,a,o++),s="derived";else if(Lhe(a))u=e=new Pc(e,a),s="number";else if(Ihe(a))u=e=new Mu(e,a),s="number";else if(Whe(a))u=e=ra.makeFromTransform(e,a),s="derived";else if(Hhe(a))u=e=new $1(e,a),s="derived";else if(Phe(a))u=e=new j1(e,a),s="derived";else if(Mhe(a))u=e=new z1(e,a),s="derived";else if($he(a))e=new B1(e,a);else if(Bhe(a))u=e=Du.makeFromTransform(e,a),s="derived";else if(Dhe(a))u=e=new R1(e,a),s="derived";else if(Nhe(a))u=e=new I1(e,a),s="derived";else if(Rhe(a))u=e=new P1(e,a),s="derived";else if(jhe(a))u=e=new L1(e,a),s="derived";else{q(cce(a));continue}if(u&&s!==void 0)for(const l of(r=u.producedFields())!==null&&r!==void 0?r:[])n.set(l,s,!1)}return e}function q1(e){var t,n,i,r,o,a,s,u,l,c;let f=r0e(e,e.component.data.sources);const{outputNodes:d,outputNodeRefCounts:h}=e.component.data,g=e.data,m=!(g&&(gs(g)||Tc(g)||Mh(g)))&&e.parent?e.parent.component.data.ancestorParse.clone():new nge;gs(g)?(VP(g)?f=new Lh(f,g.sequence):ZO(g)&&(f=new $h(f,g.graticule)),m.parseNothing=!0):((t=g==null?void 0:g.format)===null||t===void 0?void 0:t.parse)===null&&(m.parseNothing=!0),f=(n=Sn.makeExplicit(f,e,m))!==null&&n!==void 0?n:f,f=new vs(f);const y=e.parent&&zc(e.parent);(kt(e)||Sr(e))&&y&&(f=(i=wo.makeFromEncoding(f,e))!==null&&i!==void 0?i:f),e.transforms.length>0&&(f=o0e(f,e,m));const v=Gpe(e),x=Hpe(e);f=(r=Sn.makeWithAncestors(f,{},Object.assign(Object.assign({},v),x),m))!==null&&r!==void 0?r:f,kt(e)&&(f=Bc.parseAll(f,e),f=zh.parseAll(f,e)),(kt(e)||Sr(e))&&(y||(f=(o=wo.makeFromEncoding(f,e))!==null&&o!==void 0?o:f),f=(a=xo.makeFromEncoding(f,e))!==null&&a!==void 0?a:f,f=jc.parseAllForSortIndex(f,e));const b=e.getDataName(at.Raw),_=new qn(f,b,at.Raw,h);if(d[b]=_,f=_,kt(e)){const S=Er.makeFromEncoding(f,e);S&&(f=S,uS(e)&&(f=new vs(f))),f=(s=Du.makeFromEncoding(f,e))!==null&&s!==void 0?s:f,f=(u=ra.makeFromEncoding(f,e))!==null&&u!==void 0?u:f}kt(e)&&(f=(l=Ph.make(f,e))!==null&&l!==void 0?l:f);const E=e.getDataName(at.Main),w=new qn(f,E,at.Main,h);d[E]=w,f=w,kt(e)&&zge(e,w);let O=null;if(Sr(e)){const S=e.getName("facet");f=(c=i0e(f,e.facet))!==null&&c!==void 0?c:f,O=new Ic(f,e,S,w.getSource()),d[S]=O}return Object.assign(Object.assign({},e.component.data),{outputNodes:d,outputNodeRefCounts:h,raw:_,main:w,facetRoot:O,ancestorParse:m})}class a0e extends NS{constructor(t,n,i,r){var o,a,s,u;super(t,"concat",n,i,r,t.resolve);(((a=(o=t.resolve)===null||o===void 0?void 0:o.axis)===null||a===void 0?void 0:a.x)==="shared"||((u=(s=t.resolve)===null||s===void 0?void 0:s.axis)===null||u===void 0?void 0:u.y)==="shared")&&q(sce),this.children=this.getChildren(t).map((l,c)=>zS(l,this,this.getName(`concat_${c}`),void 0,r))}parseData(){this.component.data=q1(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return y1(t)?t.vconcat:WO(t)?t.hconcat:t.concat}parseLayoutSize(){e0e(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=mS(this);for(const n of this.children)t.push(...n.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleMarks(){return this.children.map(t=>{const n=t.assembleTitle(),i=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},n?{title:n}:{}),i?{style:i}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},t!=null?{columns:t}:{}),{bounds:"full",align:"each"})}}function s0e(e){return e===!1||e===null}const u0e=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},YI),{labelExpr:1,encode:1}),O4=U(u0e);class $S extends ia{constructor(t={},n={},i=!1){super();this.explicit=t,this.implicit=n,this.mainExtracted=i}clone(){return new $S(be(this.explicit),be(this.implicit),this.mainExtracted)}hasAxisPart(t){return t==="axis"?!0:t==="grid"||t==="title"?!!this.get(t):!s0e(this.get(t))}hasOrientSignalRef(){return oe(this.explicit.orient)}}function l0e(e,t,n){var i;const{encoding:r,config:o}=e,a=(i=$t(r[t]))!==null&&i!==void 0?i:$t(r[Jo(t)]),s=e.axis(t)||{},{format:u,formatType:l}=s;return Su(l)?Object.assign({text:wO({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}function c0e(e){return co.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[y0e(n,e)]),t),{})}const f0e={bottom:"top",top:"bottom",left:"right",right:"left"};function d0e(e){var t;const{axes:n,resolve:i}=e.component,r={top:0,bottom:0,right:0,left:0};for(const o of e.children){o.parseAxesAndHeaders();for(const a of U(o.component.axes))i.axis[a]=yS(e.component.resolve,a),i.axis[a]==="shared"&&(n[a]=h0e(n[a],o.component.axes[a]),n[a]||(i.axis[a]="independent",delete n[a]))}for(const o of co){for(const a of e.children)if(!!a.component.axes[o]){if(i.axis[o]==="independent"){n[o]=((t=n[o])!==null&&t!==void 0?t:[]).concat(a.component.axes[o]);for(const s of a.component.axes[o]){const{value:u,explicit:l}=s.getWithExplicit("orient");if(!oe(u)){if(r[u]>0&&!l){const c=f0e[u];r[u]>r[c]&&s.set("orient",c,!1)}r[u]++}}}delete a.component.axes[o]}if(i.axis[o]==="independent"&&n[o]&&n[o].length>1)for(const a of n[o])!!a.get("grid")&&!a.explicit.grid&&(a.implicit.grid=!1)}}function h0e(e,t){if(e){if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const r=e[i],o=t[i];if(!!r!=!!o)return;if(r&&o){const a=r.getWithExplicit("orient"),s=o.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;e[i]=g0e(r,o)}}}else return t.map(n=>n.clone());return e}function g0e(e,t){for(const n of O4){const i=hs(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(r,o)=>{switch(n){case"title":return zL(r,o);case"gridScale":return{explicit:r.explicit,value:At(r.value,o.value)}}return w1(r,o,n,"axis")});e.setWithExplicit(n,i)}return e}function p0e(e,t,n,i,r){if(t==="disable")return n!==void 0;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(oe(n.labelAngle)?n.labelAngle:yh(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===C6(i,r))return!0}return e===n[t]}const m0e=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function y0e(e,t){var n,i,r;let o=t.axis(e);const a=new $S,s=$t(t.encoding[e]),{mark:u,config:l}=t,c=(o==null?void 0:o.orient)||((n=l[e==="x"?"axisX":"axisY"])===null||n===void 0?void 0:n.orient)||((i=l.axis)===null||i===void 0?void 0:i.orient)||Kge(e),f=t.getScaleComponent(e).get("type"),d=qge(e,f,c,t.config),h=o!==void 0?!o:fS("disable",l.style,o==null?void 0:o.style,d).configValue;if(a.set("disable",h,o!==void 0),h)return a;o=o||{};const g=Vge(s,o,e,l.style,d),p={fieldOrDatumDef:s,axis:o,channel:e,model:t,scaleType:f,orient:c,labelAngle:g,mark:u,config:l};for(const v of O4){const x=v in S6?S6[v](p):XI(v)?o[v]:void 0,b=x!==void 0,_=p0e(x,v,o,t,e);if(b&&_)a.set(v,x,_);else{const{configValue:E=void 0,configFrom:w=void 0}=XI(v)&&v!=="values"?fS(v,l.style,o.style,d):{},O=E!==void 0;b&&!O?a.set(v,x,_):(w!=="vgAxisConfig"||m0e.has(v)&&O||Th(E)||oe(E))&&a.set(v,E,!1)}}const m=(r=o.encoding)!==null&&r!==void 0?r:{},y=VI.reduce((v,x)=>{var b;if(!a.hasAxisPart(x))return v;const _=j6((b=m[x])!==null&&b!==void 0?b:{},t),E=x==="labels"?l0e(t,e,_):_;return E!==void 0&&!Ze(E)&&(v[x]={update:E}),v},{});return Ze(y)||a.set("encode",y,!!o.encoding||o.labelAngle!==void 0),a}function v0e({encoding:e,size:t}){for(const n of co){const i=ui(n);vo(t[i])&&mo(e[n])&&(delete t[i],q(QL(i)))}return t}function b0e(e,t,n){const i=li(e),r=He("orient",i,n);if(i.orient=E0e(i.type,t,r),r!==void 0&&r!==i.orient&&q(Cce(i.orient,r)),i.type==="bar"&&i.orient){const s=He("cornerRadiusEnd",i,n);if(s!==void 0){const u=i.orient==="horizontal"&&t.x2||i.orient==="vertical"&&t.y2?["cornerRadius"]:Vfe[i.orient];for(const l of u)i[l]=s;i.cornerRadiusEnd!==void 0&&delete i.cornerRadiusEnd}}return He("opacity",i,n)===void 0&&(i.opacity=w0e(i.type,t)),He("cursor",i,n)===void 0&&(i.cursor=x0e(i,t,n)),i}function x0e(e,t,n){return t.href||e.href||He("href",e,n)?"pointer":e.cursor}function w0e(e,t){if(De([Z0,gO,pO,mO],e)&&!DO(t))return .7}function _0e(e,t,{graticule:n}){if(n)return!1;const i=wu("filled",e,t),r=e.type;return At(i,r!==Z0&&r!==Q0&&r!==e1)}function E0e(e,t,n){switch(e){case Z0:case pO:case mO:case bI:case Lfe:case $fe:return}const{x:i,y:r,x2:o,y2:a}=t;switch(e){case J0:if(G(i)&&(zn(i.bin)||G(r)&&r.aggregate&&!i.aggregate))return"vertical";if(G(r)&&(zn(r.bin)||G(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(G(i)&&i.type===Eu&&!ot(i.bin)||AO(i)))return"horizontal";if(!a&&(G(r)&&r.type===Eu&&!ot(r.bin)||AO(r)))return"vertical"}case e1:if(o&&!(G(i)&&zn(i.bin))&&a&&!(G(r)&&zn(r.bin)))return;case K0:if(a)return G(r)&&zn(r.bin)?"horizontal":"vertical";if(o)return G(i)&&zn(i.bin)?"vertical":"horizontal";if(e===e1){if(i&&!r)return"vertical";if(r&&!i)return"horizontal"}case Q0:case gO:{const s=mo(i),u=mo(r);if(n)return n;if(s&&!u)return e!=="tick"?"horizontal":"vertical";if(!s&&u)return e!=="tick"?"vertical":"horizontal";if(s&&u){const l=i,c=r,f=l.type===wc,d=c.type===wc;return f&&!d?e!=="tick"?"vertical":"horizontal":!f&&d?e!=="tick"?"horizontal":"vertical":!l.aggregate&&c.aggregate?e!=="tick"?"vertical":"horizontal":l.aggregate&&!c.aggregate&&e!=="tick"?"horizontal":"vertical"}else return}}return"vertical"}const O0e={vgMark:"arc",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),ms(e,"radius")),ms(e,"theta"))},S0e={vgMark:"area",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),E1("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="horizontal"})),E1("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:e.markDef.orient==="vertical"})),aS(e))},A0e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ms(e,"x")),ms(e,"y"))},k0e={vgMark:"shape",encodeEntry:e=>Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},n&&G(n)&&n.type===_c?{field:V(n,{expr:"datum"})}:{})]}},C0e={vgMark:"image",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),ms(e,"x")),ms(e,"y")),rS(e,"url"))},T0e={vgMark:"line",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e,{vgChannel:"strokeWidth"})),aS(e))},F0e={vgMark:"trail",encodeEntry:e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e)),aS(e))};function LS(e,t){const{config:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),Gt("size",e)),Gt("angle",e)),M0e(e,n,t))}function M0e(e,t,n){return n?{shape:{value:n}}:Gt("shape",e)}const D0e={vgMark:"symbol",encodeEntry:e=>LS(e)},N0e={vgMark:"symbol",encodeEntry:e=>LS(e,"circle")},R0e={vgMark:"symbol",encodeEntry:e=>LS(e,"square")},j0e={vgMark:"rect",encodeEntry:e=>Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),ms(e,"x")),ms(e,"y"))},$0e={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return!e.encoding.x&&!e.encoding.y&&!e.encoding.latitude&&!e.encoding.longitude?{}:Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),E1("x",e,{defaultPos:n==="horizontal"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="vertical"})),E1("y",e,{defaultPos:n==="vertical"?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:n!=="horizontal"})),Gt("size",e,{vgChannel:"strokeWidth"}))}},L0e={vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),On("x",e,{defaultPos:"mid"})),On("y",e,{defaultPos:"mid"})),rS(e)),Gt("size",e,{vgChannel:"fontSize"})),Gt("angle",e)),a6("align",I0e(e.markDef,n,t))),a6("baseline",P0e(e.markDef,n,t))),On("radius",e,{defaultPos:null})),On("theta",e,{defaultPos:null}))}};function I0e(e,t,n){if(He("align",e,n)===void 0)return"center"}function P0e(e,t,n){if(He("baseline",e,n)===void 0)return"middle"}const z0e={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r=i==="horizontal"?"width":"height",o=i==="horizontal"?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Yi(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),On("x",e,{defaultPos:"mid",vgChannel:"xc"})),On("y",e,{defaultPos:"mid",vgChannel:"yc"})),Gt("size",e,{defaultValue:B0e(e),vgChannel:r})),{[o]:lt(He("thickness",n,t))})}};function B0e(e){var t;const{config:n,markDef:i}=e,{orient:r}=i,o=r==="horizontal"?"width":"height",a=e.getScaleComponent(r==="horizontal"?"x":"y"),s=(t=He("size",i,n,{vgChannel:o}))!==null&&t!==void 0?t:n.tick.bandSize;if(s!==void 0)return s;{const u=a?a.get("range"):void 0;return u&&ls(u)&&Je(u.step)?u.step*3/4:v1(n.view,o)*3/4}}const W1={arc:O0e,area:S0e,bar:A0e,circle:N0e,geoshape:k0e,image:C0e,line:T0e,point:D0e,rect:j0e,rule:$0e,square:R0e,text:L0e,tick:z0e,trail:F0e};function U0e(e){if(De([Q0,K0,Ife],e.mark)){const t=ZI(e.mark,e.encoding);if(t.length>0)return q0e(e,t)}else if(e.mark===J0){const t=GE.some(n=>He(n,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return W0e(e)}return IS(e)}const S4="faceted_path_";function q0e(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:S4+e.requestDataName(at.Main),data:e.requestDataName(at.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:IS(e,{fromPrefix:S4})}]}const A4="stack_group_";function W0e(e){var t;const[n]=IS(e,{fromPrefix:A4}),i=e.scaleName(e.stack.fieldChannel),r=(c={})=>e.vgField(e.stack.fieldChannel,c),o=(c,f)=>{const d=[r({prefix:"min",suffix:"start",expr:f}),r({prefix:"max",suffix:"start",expr:f}),r({prefix:"min",suffix:"end",expr:f}),r({prefix:"max",suffix:"end",expr:f})];return`${c}(${d.map(h=>`scale('${i}',${h})`).join(",")})`};let a,s;e.stack.fieldChannel==="x"?(a=Object.assign(Object.assign({},pc(n.encode.update,["y","yc","y2","height",...GE])),{x:{signal:o("min","datum")},x2:{signal:o("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},n.encode.update=Object.assign(Object.assign({},Si(n.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(a=Object.assign(Object.assign({},pc(n.encode.update,["x","xc","x2","width"])),{y:{signal:o("min","datum")},y2:{signal:o("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},n.encode.update=Object.assign(Object.assign({},Si(n.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const c of GE){const f=wu(c,e.markDef,e.config);n.encode.update[c]?(a[c]=n.encode.update[c],delete n.encode.update[c]):f&&(a[c]=lt(f)),f&&(n.encode.update[c]={value:0})}const u=[];if(((t=e.stack.groupbyChannels)===null||t===void 0?void 0:t.length)>0)for(const c of e.stack.groupbyChannels){const f=e.fieldDef(c),d=V(f);d&&u.push(d),((f==null?void 0:f.bin)||(f==null?void 0:f.timeUnit))&&u.push(V(f,{binSuffix:"end"}))}return a=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((c,f)=>{if(n.encode.update[f])return Object.assign(Object.assign({},c),{[f]:n.encode.update[f]});{const d=wu(f,e.markDef,e.config);return d!==void 0?Object.assign(Object.assign({},c),{[f]:lt(d)}):c}},a),a.stroke&&(a.strokeForeground={value:!0},a.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(at.Main),name:A4+e.requestDataName(at.Main),groupby:u,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:a},marks:[{type:"group",encode:{update:s},marks:[n]}]}]}function H0e(e){var t;const{encoding:n,stack:i,mark:r,markDef:o,config:a}=e,s=n.order;if(!(!P(s)&&_r(s)&&ME(s.value)||!s&&ME(He("order",o,a)))){if((P(s)||G(s))&&!i)return LL(s,{expr:"datum"});if(cs(r)){const u=o.orient==="horizontal"?"y":"x",l=n[u];if(G(l)){const c=l.sort;if(P(c))return{field:V(l,{prefix:u,suffix:"sort_index",expr:"datum"})};if(go(c))return{field:V({aggregate:DO(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})};if(NI(c)){const f=e.fieldDef(c.encoding);return{field:V(f,{expr:"datum"}),order:c.order}}else return c===null?void 0:{field:V(l,{binSuffix:((t=e.stack)===null||t===void 0?void 0:t.impute)?"mid":void 0,expr:"datum"})}}return}}}function IS(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,a=At(i.clip,G0e(e),V0e(e)),s=jL(i),u=r.key,l=H0e(e),c=Y0e(e),f=He("aria",i,o),d=W1[n].postEncodingTransform?W1[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:W1[n].vgMark},a?{clip:!0}:{}),s?{style:s}:{}),u?{key:u.field}:{}),l?{sort:l}:{}),c||{}),f===!1?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(at.Main)},encode:{update:W1[n].encodeEntry(e)}}),d?{transform:d}:{})]}function G0e(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return(t==null?void 0:t.get("selectionExtent"))||(n==null?void 0:n.get("selectionExtent"))?!0:void 0}function V0e(e){const t=e.component.projection;return t&&!t.isFit?!0:void 0}function Y0e(e){if(!e.component.selection)return null;const t=U(e.component.selection).length;let n=t,i=e.parent;for(;i&&n===0;)n=U(i.component.selection).length,i=i.parent;return n?{interactive:t>0||!!e.encoding.tooltip}:null}class k4 extends b4{constructor(t,n,i,r={},o){var a;super(t,"unit",n,i,o,void 0,bP(t)?t.view:void 0);this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=ho(t.mark)?Object.assign({},t.mark):{type:t.mark},u=s.type;s.filled===void 0&&(s.filled=_0e(s,o,{graticule:t.data&&ZO(t.data)}));const l=this.encoding=Ode(t.encoding||{},u,s.filled,o);this.markDef=b0e(s,l,o),this.size=v0e({encoding:l,size:bP(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=kP(u,l),this.specifiedScales=this.initScales(u,l),this.specifiedAxes=this.initAxes(l),this.specifiedLegends=this.initLegends(l),this.specifiedProjection=t.projection,this.selection=((a=t.params)!==null&&a!==void 0?a:[]).filter(c=>UO(c))}get hasProjection(){const{encoding:t}=this,n=this.mark===xI,i=t&&xle.some(r=>ye(t[r]));return n||i}scaleDomain(t){const n=this.specifiedScales[t];return n?n.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,n){return H0.reduce((i,r)=>{var o;const a=$t(n[r]);return a&&(i[r]=this.initScale((o=a.scale)!==null&&o!==void 0?o:{})),i},{})}initScale(t){const{domain:n,range:i}=t,r=li(t);return P(n)&&(r.domain=n.map(Ai)),P(i)&&(r.range=i.map(Ai)),r}initAxes(t){return co.reduce((n,i)=>{const r=t[i];if(ye(r)||i===pt&&ye(t.x2)||i===Wt&&ye(t.y2)){const o=ye(r)?r.axis:void 0;n[i]=o&&this.initAxis(Object.assign({},o))}return n},{})}initAxis(t){const n=U(t),i={};for(const r of n){const o=t[r];i[r]=Th(o)?DL(o):Ai(o)}return i}initLegends(t){return Fle.reduce((n,i)=>{const r=$t(t[i]);if(r&&Dle(i)){const o=r.legend;n[i]=o&&li(o)}return n},{})}parseData(){this.component.data=q1(this)}parseLayoutSize(){t0e(this)}parseSelections(){this.component.selection=Pge(this,this.selection)}parseMarkGroup(){this.component.mark=U0e(this)}parseAxesAndHeaders(){this.component.axes=c0e(this)}assembleSelectionTopLevelSignals(t){return age(this,t)}assembleSignals(){return[...E6(this),...rge(this,[])]}assembleSelectionData(t){return sge(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return mS(this)}assembleMarks(){var t;let n=(t=this.component.mark)!==null&&t!==void 0?t:[];return(!this.parent||!zc(this.parent))&&(n=XP(this,n)),n.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};if(t!==void 0)return t;if(this.encoding.x||this.encoding.y)return"cell"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ku(this.encoding,t)}fieldDef(t){const n=this.encoding[t];return yo(n)}typedFieldDef(t){const n=this.fieldDef(t);return Vi(n)?n:null}}class PS extends NS{constructor(t,n,i,r,o){super(t,"layer",n,i,o,t.resolve,t.view);const a=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((s,u)=>{if(x1(s))return new PS(s,this,this.getName(`layer_${u}`),a,o);if(ta(s))return new k4(s,this,this.getName(`layer_${u}`),a,o);throw new Error(YE(s))})}parseData(){this.component.data=q1(this);for(const t of this.children)t.parseData()}parseLayoutSize(){Zme(this)}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const n of U(t.component.selection))this.component.selection[n]=t.component.selection[n]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){d0e(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((n,i)=>i.assembleSelectionTopLevelSignals(n),t)}assembleSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleSignals()),E6(this))}assembleLayoutSignals(){return this.children.reduce((t,n)=>t.concat(n.assembleLayoutSignals()),mS(this))}assembleSelectionData(t){return this.children.reduce((n,i)=>i.assembleSelectionData(n),t)}assembleGroupStyle(){const t=new Set;for(const i of this.children)for(const r of J(i.assembleGroupStyle()))t.add(r);const n=Array.from(t);return n.length>1?n:n.length===1?n[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const n of this.children)if(t=n.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return uge(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,n)=>t.concat(n.assembleLegends()),G6(this))}}function zS(e,t,n,i,r){if(r1(e))return new Uh(e,t,n,r);if(x1(e))return new PS(e,t,n,i,r);if(ta(e))return new k4(e,t,n,i,r);if(Xde(e))return new a0e(e,t,n,r);throw new Error(YE(e))}var X0e=globalThis&&globalThis.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n};function K0e(e,t={}){t.logger&&Zce(t.logger),t.fieldTitle&&qI(t.fieldTitle);try{const n=SP(dl(t.config,e.config)),i=UP(e,n),r=zS(i,null,"",void 0,n);return r.parse(),ume(r.component.data,r),{spec:Q0e(r,J0e(e,i.autosize,n,r),e.datasets,e.usermeta),normalized:i}}finally{t.logger&&efe(),t.fieldTitle&&gde()}}function J0e(e,t,n,i){const r=i.component.layoutSize.get("width"),o=i.component.layoutSize.get("height");if(t===void 0?(t={type:"pad"},i.hasAxisOrientSignalRef()&&(t.resize=!0)):K(t)&&(t={type:t}),r&&o&&Zhe(t.type)){if(r==="step"&&o==="step")q(qL()),t.type="pad";else if(r==="step"||o==="step"){const a=r==="step"?"width":"height";q(qL(W0(a)));const s=a==="width"?"height":"width";t.type=ege(s)}}return Object.assign(Object.assign(Object.assign({},U(t).length===1&&t.type?t.type==="pad"?{}:{autosize:t.type}:{autosize:t}),WP(n,!1)),WP(e,!0))}function Q0e(e,t,n={},i){const r=e.config?che(e.config):void 0,o=[].concat(e.assembleSelectionData([]),Xme(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),u=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let c=e.assembleLayoutSignals();c=c.filter(h=>(h.name==="width"||h.name==="height")&&h.value!==void 0?(t[h.name]=+h.value,!1):!0);const{params:f}=t,d=X0e(t,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),d),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),e.assembleGroup([...c,...e.assembleSelectionTopLevelSignals([]),...yP(f)])),r?{config:r}:{}),i?{usermeta:i}:{})}const Z0e=cle.version;var e1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Z0e,compile:K0e,normalize:UP,deepEqual:no,duplicate:be,never:lL,pick:pc,omit:Si,stringify:rt,hash:Me,isNullOrFalse:ME,contains:De,some:pu,every:DE,mergeDeep:cL,unique:io,isEqual:gle,setEqual:fL,hasIntersection:NE,prefixGenerator:RE,fieldIntersection:jE,isEmpty:Ze,keys:U,vals:En,entries:Za,isBoolean:gh,varName:ht,logicalExpr:ph,deleteNestedProperty:L0,titleCase:mh,accessPathWithDatum:$E,flatAccessWithDatum:dL,replacePathInField:Wi,replaceAll:mu,removePathFromField:LE,accessPathDepth:mc,getFirstDefined:At,uniqueId:gL,resetIdCounter:mle,internalField:pL,isInternalField:mL,normalizeAngle:yh,isNumeric:I0});function C4(e){const[t,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t,version:n}}var t1e="vega-themes",n1e="2.10.0",i1e="Themes for stylized Vega and Vega-Lite visualizations.",r1e=["vega","vega-lite","themes","style"],o1e="BSD-3-Clause",a1e={name:"UW Interactive Data Lab",url:"https://idl.cs.washington.edu"},s1e=[{name:"Emily Gu",url:"https://github.com/emilygu"},{name:"Arvind Satyanarayan",url:"http://arvindsatya.com"},{name:"Jeffrey Heer",url:"https://idl.cs.washington.edu"},{name:"Dominik Moritz",url:"https://www.domoritz.de"}],u1e="build/vega-themes.js",l1e="build/vega-themes.module.js",c1e="build/vega-themes.min.js",f1e="build/vega-themes.min.js",d1e="build/vega-themes.module.d.ts",h1e={type:"git",url:"https://github.com/vega/vega-themes.git"},g1e=["src","build"],p1e={prebuild:"yarn clean",build:"rollup -c",clean:"rimraf build && rimraf examples/build","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples",prepublishOnly:"yarn clean && yarn build",preversion:"yarn lint",serve:"browser-sync start -s -f build examples --serveStatic examples",start:"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'",prepare:"beemo create-config",eslintbase:"beemo eslint .",format:"yarn eslintbase --fix",lint:"yarn eslintbase"},m1e={"@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^11.2.0","@wessberg/rollup-plugin-ts":"^1.3.8","browser-sync":"^2.26.14",concurrently:"^6.0.0","gh-pages":"^3.1.0",rollup:"^2.39.1","rollup-plugin-bundle-size":"^1.0.3","rollup-plugin-terser":"^7.0.2",typescript:"^4.2.2",vega:"^5.19.1","vega-lite":"^5.0.0","vega-lite-dev-config":"^0.16.1"},y1e={vega:"*","vega-lite":"*"},v1e={name:t1e,version:n1e,description:i1e,keywords:r1e,license:o1e,author:a1e,contributors:s1e,main:u1e,module:l1e,unpkg:c1e,jsdelivr:f1e,types:d1e,repository:h1e,files:g1e,scripts:p1e,devDependencies:m1e,peerDependencies:y1e};const Uc="#fff",b1e="#888",x1e={background:"#333",title:{color:Uc,subtitleColor:Uc},style:{"guide-label":{fill:Uc},"guide-title":{fill:Uc}},axis:{domainColor:Uc,gridColor:b1e,tickColor:Uc}},Nu="#4572a7",w1e={background:"#fff",arc:{fill:Nu},area:{fill:Nu},line:{stroke:Nu,strokeWidth:2},path:{stroke:Nu},rect:{fill:Nu},shape:{stroke:Nu},symbol:{fill:Nu,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ru="#30a2da",BS="#cbcbcb",_1e="#999",E1e="#333",T4="#f0f0f0",F4="#333",O1e={arc:{fill:Ru},area:{fill:Ru},axis:{domainColor:BS,grid:!0,gridColor:BS,gridWidth:1,labelColor:_1e,labelFontSize:10,titleColor:E1e,tickColor:BS,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:T4,group:{fill:T4},legend:{labelColor:F4,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:F4,titleFontSize:14,titlePadding:10},line:{stroke:Ru,strokeWidth:2},path:{stroke:Ru,strokeWidth:.5},rect:{fill:Ru},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ru},bar:{binSpacing:2,fill:Ru,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},ju="#000",S1e={group:{fill:"#e5e5e5"},arc:{fill:ju},area:{fill:ju},line:{stroke:ju},path:{stroke:ju},rect:{fill:ju},shape:{stroke:ju},symbol:{fill:ju,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},A1e=22,k1e="normal",M4="Benton Gothic, sans-serif",D4=11.5,C1e="normal",$u="#82c6df",US="Benton Gothic Bold, sans-serif",N4="normal",R4=13,qh={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},T1e={background:"#ffffff",title:{anchor:"start",color:"#000000",font:US,fontSize:A1e,fontWeight:k1e},arc:{fill:$u},area:{fill:$u},line:{stroke:$u,strokeWidth:2},path:{stroke:$u},rect:{fill:$u},shape:{stroke:$u},symbol:{fill:$u,size:30},axis:{labelFont:M4,labelFontSize:D4,labelFontWeight:C1e,titleFont:US,titleFontSize:R4,titleFontWeight:N4},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:M4,labelFontSize:D4,symbolType:"square",titleFont:US,titleFontSize:R4,titleFontWeight:N4},range:{category:qh["category-6"],diverging:qh["fireandice-6"],heatmap:qh["fire-7"],ordinal:qh["fire-7"],ramp:qh["fire-7"]}},Lu="#ab5787",H1="#979797",F1e={background:"#f9f9f9",arc:{fill:Lu},area:{fill:Lu},line:{stroke:Lu},path:{stroke:Lu},rect:{fill:Lu},shape:{stroke:Lu},symbol:{fill:Lu,size:30},axis:{domainColor:H1,domainWidth:.5,gridWidth:.2,labelColor:H1,tickColor:H1,tickWidth:.2,titleColor:H1},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Iu="#3e5c69",M1e={background:"#fff",arc:{fill:Iu},area:{fill:Iu},line:{stroke:Iu},path:{stroke:Iu},rect:{fill:Iu},shape:{stroke:Iu},symbol:{fill:Iu},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Xi="#1696d2",j4="#000000",D1e="#FFFFFF",G1="Lato",qS="Lato",N1e="Lato",R1e="#DEDDDD",j1e=18,Wh={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},$1e={background:D1e,title:{anchor:"start",fontSize:j1e,font:G1},axisX:{domain:!0,domainColor:j4,domainWidth:1,grid:!1,labelFontSize:12,labelFont:qS,labelAngle:0,tickColor:j4,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:G1},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:R1e,gridWidth:1,labelFontSize:12,labelFont:qS,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:G1,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:qS,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:G1,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Wh["six-groups-cat-1"],diverging:Wh["diverging-colors"],heatmap:Wh["diverging-colors"],ordinal:Wh["six-groups-seq"],ramp:Wh["shades-blue"]},area:{fill:Xi},rect:{fill:Xi},line:{color:Xi,stroke:Xi,strokeWidth:5},trail:{color:Xi,stroke:Xi,strokeWidth:0,size:1},path:{stroke:Xi,strokeWidth:.5},point:{filled:!0},text:{font:N1e,color:Xi,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Xi,stroke:null}},arc:{fill:Xi},shape:{stroke:Xi},symbol:{fill:Xi,size:30}},Pu="#3366CC",$4="#ccc",V1="Arial, sans-serif",L1e={arc:{fill:Pu},area:{fill:Pu},path:{stroke:Pu},rect:{fill:Pu},shape:{stroke:Pu},symbol:{stroke:Pu},circle:{fill:Pu},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:V1,fontSize:12},"guide-title":{font:V1,fontSize:12},"group-title":{font:V1,fontSize:12}},title:{font:V1,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:$4,tickColor:$4,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},I1e=v1e.version;var P1e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",dark:x1e,excel:w1e,fivethirtyeight:O1e,ggplot2:S1e,googlecharts:L1e,latimes:T1e,quartz:F1e,urbaninstitute:$1e,version:I1e,vox:M1e});/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function z1e(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n}function B1e(e,t,n){if(P(e))return`[${e.map(i=>t(K(i)?i:L4(i,n))).join(", ")}]`;if(Q(e)){let i="";const r=e,{title:o,image:a}=r,s=z1e(r,["title","image"]);o&&(i+=`<h2>${t(o)}</h2>`),a&&(i+=`<img src="${t(a)}">`);const u=Object.keys(s);if(u.length>0){i+="<table>";for(const l of u){let c=s[l];c!==void 0&&(Q(c)&&(c=L4(c,n)),i+=`<tr><td class="key">${t(l)}:</td><td class="value">${t(c)}</td></tr>`)}i+="</table>"}return i||"{}"}return t(e)}function U1e(e){const t=[];return function(n,i){if(typeof i!="object"||i===null)return i;const r=t.indexOf(this)+1;return t.length=r,t.length>e?"[Object]":t.indexOf(i)>=0?"[Circular]":(t.push(i),i)}}function L4(e,t){return JSON.stringify(e,U1e(t))}var q1e=`#vg-tooltip-element {
  visibility: hidden;
  padding: 8px;
  position: fixed;
  z-index: 1000;
  font-family: sans-serif;
  font-size: 11px;
  border-radius: 3px;
  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  /* The default theme is the light theme. */
  background-color: rgba(255, 255, 255, 0.95);
  border: 1px solid #d9d9d9;
  color: black; }
  #vg-tooltip-element.visible {
    visibility: visible; }
  #vg-tooltip-element h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 13px; }
  #vg-tooltip-element img {
    max-width: 200px;
    max-height: 200px; }
  #vg-tooltip-element table {
    border-spacing: 0; }
    #vg-tooltip-element table tr {
      border: none; }
      #vg-tooltip-element table tr td {
        overflow: hidden;
        text-overflow: ellipsis;
        padding-top: 2px;
        padding-bottom: 2px; }
        #vg-tooltip-element table tr td.key {
          color: #808080;
          max-width: 150px;
          text-align: right;
          padding-right: 4px; }
        #vg-tooltip-element table tr td.value {
          display: block;
          max-width: 300px;
          max-height: 7em;
          text-align: left; }
  #vg-tooltip-element.dark-theme {
    background-color: rgba(32, 32, 32, 0.9);
    border: 1px solid #f5f5f5;
    color: white; }
    #vg-tooltip-element.dark-theme td.key {
      color: #bfbfbf; }
`;const I4="vg-tooltip-element",W1e={offsetX:10,offsetY:10,id:I4,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:H1e,maxDepth:2,formatTooltip:B1e};function H1e(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")}function G1e(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return q1e.toString().replace(I4,e)}function V1e(e,t,n,i){let r=e.clientX+n;r+t.width>window.innerWidth&&(r=+e.clientX-n-t.width);let o=e.clientY+i;return o+t.height>window.innerHeight&&(o=+e.clientY-i-t.height),{x:r,y:o}}class Y1e{constructor(t){this.options=Object.assign(Object.assign({},W1e),t);const n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const i=document.createElement("style");i.setAttribute("id",this.options.styleId),i.innerHTML=G1e(n);const r=document.head;r.childNodes.length>0?r.insertBefore(i,r.childNodes[0]):r.appendChild(i)}}tooltipHandler(t,n,i,r){var o;if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),((o=document.fullscreenElement)!==null&&o!==void 0?o:document.body).appendChild(this.el),r==null||r===""){this.el.classList.remove("visible",`${this.options.theme}-theme`);return}this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:s,y:u}=V1e(n,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${u}px; left: ${s}px`)}}function X1e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P4(e,t,n,i,r,o,a){try{var s=e[o](a),u=s.value}catch(l){n(l);return}s.done?t(u):Promise.resolve(u).then(i,r)}function Y1(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(u){P4(o,i,r,a,s,"next",u)}function s(u){P4(o,i,r,a,s,"throw",u)}a(void 0)})}}var z4=Object.prototype,zu=z4.hasOwnProperty,_o,WS=typeof Symbol=="function"?Symbol:{},X1=WS.iterator||"@@iterator",K1e=WS.asyncIterator||"@@asyncIterator",K1=WS.toStringTag||"@@toStringTag";function B4(e,t,n,i){var r=t&&t.prototype instanceof GS?t:GS,o=Object.create(r.prototype),a=new KS(i||[]);return o._invoke=tye(e,n,a),o}function HS(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}var U4="suspendedStart",J1e="suspendedYield",q4="executing",J1="completed",Ar={};function GS(){}function Q1(){}function qc(){}var VS={};VS[X1]=function(){return this};var YS=Object.getPrototypeOf,Z1=YS&&YS(YS(JS([])));Z1&&Z1!==z4&&zu.call(Z1,X1)&&(VS=Z1);var Wc=qc.prototype=GS.prototype=Object.create(VS);Q1.prototype=Wc.constructor=qc;qc.constructor=Q1;qc[K1]=Q1.displayName="GeneratorFunction";function W4(e){["next","throw","return"].forEach(function(t){e[t]=function(n){return this._invoke(t,n)}})}function H4(e){var t=typeof e=="function"&&e.constructor;return t?t===Q1||(t.displayName||t.name)==="GeneratorFunction":!1}function Q1e(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,qc):(e.__proto__=qc,K1 in e||(e[K1]="GeneratorFunction")),e.prototype=Object.create(Wc),e}function Z1e(e){return{__await:e}}function ey(e,t){function n(o,a,s,u){var l=HS(e[o],e,a);if(l.type==="throw")u(l.arg);else{var c=l.arg,f=c.value;return f&&typeof f=="object"&&zu.call(f,"__await")?t.resolve(f.__await).then(function(d){n("next",d,s,u)},function(d){n("throw",d,s,u)}):t.resolve(f).then(function(d){c.value=d,s(c)},function(d){return n("throw",d,s,u)})}}var i;function r(o,a){function s(){return new t(function(u,l){n(o,a,u,l)})}return i=i?i.then(s,s):s()}this._invoke=r}W4(ey.prototype);ey.prototype[K1e]=function(){return this};function eye(e,t,n,i,r){r===void 0&&(r=Promise);var o=new ey(B4(e,t,n,i),r);return H4(t)?o:o.next().then(function(a){return a.done?a.value:o.next()})}function tye(e,t,n){var i=U4;return function(o,a){if(i===q4)throw new Error("Generator is already running");if(i===J1){if(o==="throw")throw a;return V4()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=G4(s,n);if(u){if(u===Ar)continue;return u}}if(n.method==="next")n.sent=n._sent=n.arg;else if(n.method==="throw"){if(i===U4)throw i=J1,n.arg;n.dispatchException(n.arg)}else n.method==="return"&&n.abrupt("return",n.arg);i=q4;var l=HS(e,t,n);if(l.type==="normal"){if(i=n.done?J1:J1e,l.arg===Ar)continue;return{value:l.arg,done:n.done}}else l.type==="throw"&&(i=J1,n.method="throw",n.arg=l.arg)}}}function G4(e,t){var n=e.iterator[t.method];if(n===_o){if(t.delegate=null,t.method==="throw"){if(e.iterator.return&&(t.method="return",t.arg=_o,G4(e,t),t.method==="throw"))return Ar;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return Ar}var i=HS(n,e.iterator,t.arg);if(i.type==="throw")return t.method="throw",t.arg=i.arg,t.delegate=null,Ar;var r=i.arg;if(!r)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,Ar;if(r.done)t[e.resultName]=r.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=_o);else return r;return t.delegate=null,Ar}W4(Wc);Wc[K1]="Generator";Wc[X1]=function(){return this};Wc.toString=function(){return"[object Generator]"};function nye(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function XS(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function KS(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(nye,this),this.reset(!0)}function iye(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}}function JS(e){if(e){var t=e[X1];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(zu.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=_o,r.done=!0,r};return i.next=i}}return{next:V4}}function V4(){return{value:_o,done:!0}}KS.prototype={constructor:KS,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=_o,this.done=!1,this.delegate=null,this.method="next",this.arg=_o,this.tryEntries.forEach(XS),!t)for(var n in this)n.charAt(0)==="t"&&zu.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=_o)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if(n.type==="throw")throw n.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(l,c){return a.type="throw",a.arg=t,n.next=l,c&&(n.method="next",n.arg=_o),!!c}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if(o.tryLoc==="root")return i("end");if(o.tryLoc<=this.prev){var s=zu.call(o,"catchLoc"),u=zu.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else if(u){if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&zu.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&(t==="break"||t==="continue")&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=n,o?(this.method="next",this.next=o.finallyLoc,Ar):this.complete(a)},complete:function(t,n){if(t.type==="throw")throw t.arg;return t.type==="break"||t.type==="continue"?this.next=t.arg:t.type==="return"?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):t.type==="normal"&&n&&(this.next=n),Ar},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),XS(i),Ar}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if(r.type==="throw"){var o=r.arg;XS(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:JS(t),resultName:n,nextLoc:i},this.method==="next"&&(this.arg=_o),Ar}};var Eo={wrap:B4,isGeneratorFunction:H4,AsyncIterator:ey,mark:Q1e,awrap:Z1e,async:eye,keys:iye,values:JS},rye=ze;ze.Node=Bu;ze.create=ze;function ze(e){var t=this;if(t instanceof ze||(t=new ze),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(r){t.push(r)});else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}ze.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};ze.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};ze.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};ze.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)aye(this,arguments[e]);return this.length};ze.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)sye(this,arguments[e]);return this.length};ze.prototype.pop=function(){if(!!this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};ze.prototype.shift=function(){if(!!this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};ze.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,i=0;n!==null;i++)e.call(t,n.value,i,this),n=n.next};ze.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,i=this.length-1;n!==null;i--)e.call(t,n.value,i,this),n=n.prev};ze.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};ze.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};ze.prototype.map=function(e,t){t=t||this;for(var n=new ze,i=this.head;i!==null;)n.push(e.call(t,i.value,this)),i=i.next;return n};ze.prototype.mapReverse=function(e,t){t=t||this;for(var n=new ze,i=this.tail;i!==null;)n.push(e.call(t,i.value,this)),i=i.prev;return n};ze.prototype.reduce=function(e,t){var n,i=this.head;if(arguments.length>1)n=t;else if(this.head)i=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=0;i!==null;r++)n=e(n,i.value,r),i=i.next;return n};ze.prototype.reduceReverse=function(e,t){var n,i=this.tail;if(arguments.length>1)n=t;else if(this.tail)i=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var r=this.length-1;i!==null;r--)n=e(n,i.value,r),i=i.prev;return n};ze.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};ze.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};ze.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ze;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;r!==null&&i<e;i++)r=r.next;for(;r!==null&&i<t;i++,r=r.next)n.push(r.value);return n};ze.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new ze;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;r!==null&&i>t;i--)r=r.prev;for(;r!==null&&i>e;i--,r=r.prev)n.push(r.value);return n};ze.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var r=[],n=0;i&&n<t;n++)r.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<(arguments.length<=2?0:arguments.length-2);n++)i=oye(this,i,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return r};ze.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var i=n.prev;n.prev=n.next,n.next=i}return this.head=t,this.tail=e,this};function oye(e,t,n){var i=t===e.head?new Bu(n,null,t,e):new Bu(n,t,t.next,e);return i.next===null&&(e.tail=i),i.prev===null&&(e.head=i),e.length++,i}function aye(e,t){e.tail=new Bu(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function sye(e,t){e.head=new Bu(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Bu(e,t,n,i){if(!(this instanceof Bu))return new Bu(e,t,n,i);this.list=i,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{ze.prototype[Symbol.iterator]=Eo.mark(function e(){var t;return Eo.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:t=this.head;case 1:if(!t){i.next=7;break}return i.next=4,t.value;case 4:t=t.next,i.next=1;break;case 7:case"end":return i.stop()}},e,this)})}catch{}var uye=rye,Uu=Symbol("max"),oa=Symbol("length"),Hc=Symbol("lengthCalculator"),Hh=Symbol("allowStale"),qu=Symbol("maxAge"),aa=Symbol("dispose"),Y4=Symbol("noDisposeOnSet"),Vt=Symbol("lruList"),kr=Symbol("cache"),X4=Symbol("updateAgeOnGet"),QS=()=>1;class lye{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Uu]=t.max||1/0;var n=t.length||QS;if(this[Hc]=typeof n!="function"?QS:n,this[Hh]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[qu]=t.maxAge||0,this[aa]=t.dispose,this[Y4]=t.noDisposeOnSet||!1,this[X4]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Uu]=t||1/0,Gh(this)}get max(){return this[Uu]}set allowStale(t){this[Hh]=!!t}get allowStale(){return this[Hh]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[qu]=t,Gh(this)}get maxAge(){return this[qu]}set lengthCalculator(t){typeof t!="function"&&(t=QS),t!==this[Hc]&&(this[Hc]=t,this[oa]=0,this[Vt].forEach(n=>{n.length=this[Hc](n.value,n.key),this[oa]+=n.length})),Gh(this)}get lengthCalculator(){return this[Hc]}get length(){return this[oa]}get itemCount(){return this[Vt].length}rforEach(t,n){n=n||this;for(var i=this[Vt].tail;i!==null;){var r=i.prev;K4(this,t,i,n),i=r}}forEach(t,n){n=n||this;for(var i=this[Vt].head;i!==null;){var r=i.next;K4(this,t,i,n),i=r}}keys(){return this[Vt].toArray().map(t=>t.key)}values(){return this[Vt].toArray().map(t=>t.value)}reset(){this[aa]&&this[Vt]&&this[Vt].length&&this[Vt].forEach(t=>this[aa](t.key,t.value)),this[kr]=new Map,this[Vt]=new uye,this[oa]=0}dump(){return this[Vt].map(t=>ty(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[Vt]}set(t,n,i){if(i=i||this[qu],i&&typeof i!="number")throw new TypeError("maxAge must be a number");var r=i?Date.now():0,o=this[Hc](n,t);if(this[kr].has(t)){if(o>this[Uu])return Gc(this,this[kr].get(t)),!1;var a=this[kr].get(t),s=a.value;return this[aa]&&(this[Y4]||this[aa](t,s.value)),s.now=r,s.maxAge=i,s.value=n,this[oa]+=o-s.length,s.length=o,this.get(t),Gh(this),!0}var u=new cye(t,n,o,r,i);return u.length>this[Uu]?(this[aa]&&this[aa](t,n),!1):(this[oa]+=u.length,this[Vt].unshift(u),this[kr].set(t,this[Vt].head),Gh(this),!0)}has(t){if(!this[kr].has(t))return!1;var n=this[kr].get(t).value;return!ty(this,n)}get(t){return ZS(this,t,!0)}peek(t){return ZS(this,t,!1)}pop(){var t=this[Vt].tail;return t?(Gc(this,t),t.value):null}del(t){Gc(this,this[kr].get(t))}load(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],o=r.e||0;if(o===0)this.set(r.k,r.v);else{var a=o-n;a>0&&this.set(r.k,r.v,a)}}}prune(){this[kr].forEach((t,n)=>ZS(this,n,!1))}}var ZS=(e,t,n)=>{var i=e[kr].get(t);if(i){var r=i.value;if(ty(e,r)){if(Gc(e,i),!e[Hh])return}else n&&(e[X4]&&(i.value.now=Date.now()),e[Vt].unshiftNode(i));return r.value}},ty=(e,t)=>{if(!t||!t.maxAge&&!e[qu])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[qu]&&n>e[qu]},Gh=e=>{if(e[oa]>e[Uu])for(var t=e[Vt].tail;e[oa]>e[Uu]&&t!==null;){var n=t.prev;Gc(e,t),t=n}},Gc=(e,t)=>{if(t){var n=t.value;e[aa]&&e[aa](n.key,n.value),e[oa]-=n.length,e[kr].delete(n.key),e[Vt].removeNode(t)}};class cye{constructor(t,n,i,r,o){this.key=t,this.value=n,this.length=i,this.now=r,this.maxAge=o||0}}var K4=(e,t,n,i)=>{var r=n.value;ty(e,r)&&(Gc(e,n),e[Hh]||(r=void 0)),r&&t.call(i,r.value,r.key,e)},fye=lye,dye=["includePrerelease","loose","rtl"],hye=e=>e?typeof e!="object"?{loose:!0}:dye.filter(t=>e[t]).reduce((t,n)=>(t[n]=!0,t),{}):{},eA=hye,Cr={exports:{}},gye="2.0.0",pye=256,mye=Number.MAX_SAFE_INTEGER||9007199254740991,yye=16,tA={SEMVER_SPEC_VERSION:gye,MAX_LENGTH:pye,MAX_SAFE_INTEGER:mye,MAX_SAFE_COMPONENT_LENGTH:yye},vye=typeof process=="object"&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return console.error("SEMVER",...t)}:()=>{},ny=vye;(function(e,t){var n=tA.MAX_SAFE_COMPONENT_LENGTH,i=ny;t=e.exports={};var r=t.re=[],o=t.src=[],a=t.t={},s=0,u=(l,c,f)=>{var d=s++;i(d,c),a[l]=d,o[d]=c,r[d]=new RegExp(c,f?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION","(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")\\.")+"(".concat(o[a.NUMERICIDENTIFIER],")")),u("MAINVERSIONLOOSE","(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[a.NUMERICIDENTIFIERLOOSE],")")),u("PRERELEASEIDENTIFIER","(?:".concat(o[a.NUMERICIDENTIFIER],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[a.NUMERICIDENTIFIERLOOSE],"|").concat(o[a.NONNUMERICIDENTIFIER],")")),u("PRERELEASE","(?:-(".concat(o[a.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIER],")*))")),u("PRERELEASELOOSE","(?:-?(".concat(o[a.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[a.PRERELEASEIDENTIFIERLOOSE],")*))")),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD","(?:\\+(".concat(o[a.BUILDIDENTIFIER],"(?:\\.").concat(o[a.BUILDIDENTIFIER],")*))")),u("FULLPLAIN","v?".concat(o[a.MAINVERSION]).concat(o[a.PRERELEASE],"?").concat(o[a.BUILD],"?")),u("FULL","^".concat(o[a.FULLPLAIN],"$")),u("LOOSEPLAIN","[v=\\s]*".concat(o[a.MAINVERSIONLOOSE]).concat(o[a.PRERELEASELOOSE],"?").concat(o[a.BUILD],"?")),u("LOOSE","^".concat(o[a.LOOSEPLAIN],"$")),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE","".concat(o[a.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),u("XRANGEIDENTIFIER","".concat(o[a.NUMERICIDENTIFIER],"|x|X|\\*")),u("XRANGEPLAIN","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIER],")")+"(?:".concat(o[a.PRERELEASE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[a.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[a.PRERELEASELOOSE],")?").concat(o[a.BUILD],"?")+")?)?"),u("XRANGE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAIN],"$")),u("XRANGELOOSE","^".concat(o[a.GTLT],"\\s*").concat(o[a.XRANGEPLAINLOOSE],"$")),u("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),u("COERCERTL",o[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM","(\\s*)".concat(o[a.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",u("TILDE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAIN],"$")),u("TILDELOOSE","^".concat(o[a.LONETILDE]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("LONECARET","(?:\\^)"),u("CARETTRIM","(\\s*)".concat(o[a.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",u("CARET","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAIN],"$")),u("CARETLOOSE","^".concat(o[a.LONECARET]).concat(o[a.XRANGEPLAINLOOSE],"$")),u("COMPARATORLOOSE","^".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],")$|^$")),u("COMPARATOR","^".concat(o[a.GTLT],"\\s*(").concat(o[a.FULLPLAIN],")$|^$")),u("COMPARATORTRIM","(\\s*)".concat(o[a.GTLT],"\\s*(").concat(o[a.LOOSEPLAIN],"|").concat(o[a.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE","^\\s*(".concat(o[a.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAIN],")")+"\\s*$"),u("HYPHENRANGELOOSE","^\\s*(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[a.XRANGEPLAINLOOSE],")")+"\\s*$"),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")})(Cr,Cr.exports);var J4=/^[0-9]+$/,Q4=(e,t)=>{var n=J4.test(e),i=J4.test(t);return n&&i&&(e=+e,t=+t),e===t?0:n&&!i?-1:i&&!n?1:e<t?-1:1},bye=(e,t)=>Q4(t,e),xye={compareIdentifiers:Q4,rcompareIdentifiers:bye},iy=ny,Z4=tA.MAX_LENGTH,ry=tA.MAX_SAFE_INTEGER,e8=Cr.exports.re,t8=Cr.exports.t,wye=eA,Vh=xye.compareIdentifiers;class Tr{constructor(t,n){if(n=wye(n),t instanceof Tr){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: ".concat(t));if(t.length>Z4)throw new TypeError("version is longer than ".concat(Z4," characters"));iy("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var i=t.trim().match(n.loose?e8[t8.LOOSE]:e8[t8.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>ry||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ry||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ry||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){var o=+r;if(o>=0&&o<ry)return o}return r}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(t){if(iy("SemVer.compare",this.version,this.options,t),!(t instanceof Tr)){if(typeof t=="string"&&t===this.version)return 0;t=new Tr(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Tr||(t=new Tr(t,this.options)),Vh(this.major,t.major)||Vh(this.minor,t.minor)||Vh(this.patch,t.patch)}comparePre(t){if(t instanceof Tr||(t=new Tr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var i=this.prerelease[n],r=t.prerelease[n];if(iy("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return Vh(i,r)}while(++n)}compareBuild(t){t instanceof Tr||(t=new Tr(t,this.options));var n=0;do{var i=this.build[n],r=t.build[n];if(iy("prerelease compare",n,i,r),i===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(i===void 0)return-1;if(i===r)continue;return Vh(i,r)}while(++n)}inc(t,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n),this.inc("pre",n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n),this.inc("pre",n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);i===-1&&this.prerelease.push(0)}n&&(this.prerelease[0]===n?isNaN(this.prerelease[1])&&(this.prerelease=[n,0]):this.prerelease=[n,0]);break;default:throw new Error("invalid increment argument: ".concat(t))}return this.format(),this.raw=this.version,this}}var nA=Tr,n8=nA,_ye=(e,t,n)=>new n8(e,n).compare(new n8(t,n)),Vc=_ye,Eye=Vc,Oye=(e,t,n)=>Eye(e,t,n)===0,Sye=Oye,Aye=Vc,kye=(e,t,n)=>Aye(e,t,n)!==0,Cye=kye,Tye=Vc,Fye=(e,t,n)=>Tye(e,t,n)>0,Mye=Fye,Dye=Vc,Nye=(e,t,n)=>Dye(e,t,n)>=0,Rye=Nye,jye=Vc,$ye=(e,t,n)=>jye(e,t,n)<0,Lye=$ye,Iye=Vc,Pye=(e,t,n)=>Iye(e,t,n)<=0,zye=Pye,Bye=Sye,Uye=Cye,qye=Mye,Wye=Rye,Hye=Lye,Gye=zye,Vye=(e,t,n,i)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e===n;case"!==":return typeof e=="object"&&(e=e.version),typeof n=="object"&&(n=n.version),e!==n;case"":case"=":case"==":return Bye(e,n,i);case"!=":return Uye(e,n,i);case">":return qye(e,n,i);case">=":return Wye(e,n,i);case"<":return Hye(e,n,i);case"<=":return Gye(e,n,i);default:throw new TypeError("Invalid operator: ".concat(t))}},Yye=Vye,Yh=Symbol("SemVer ANY");class oy{static get ANY(){return Yh}constructor(t,n){if(n=Kye(n),t instanceof oy){if(t.loose===!!n.loose)return t;t=t.value}rA("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===Yh?this.value="":this.value=this.operator+this.semver.version,rA("comp",this)}parse(t){var n=this.options.loose?i8[r8.COMPARATORLOOSE]:i8[r8.COMPARATOR],i=t.match(n);if(!i)throw new TypeError("Invalid comparator: ".concat(t));this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new o8(i[2],this.options.loose):this.semver=Yh}toString(){return this.value}test(t){if(rA("Comparator.test",t,this.options.loose),this.semver===Yh||t===Yh)return!0;if(typeof t=="string")try{t=new o8(t,this.options)}catch{return!1}return iA(t,this.operator,this.semver,this.options)}intersects(t,n){if(!(t instanceof oy))throw new TypeError("a Comparator is required");if((!n||typeof n!="object")&&(n={loose:!!n,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new a8(t.value,n).test(this.value);if(t.operator==="")return t.value===""?!0:new a8(this.value,n).test(t.semver);var i=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),r=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),o=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),s=iA(this.semver,"<",t.semver,n)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=iA(this.semver,">",t.semver,n)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return i||r||o&&a||s||u}}var Xye=oy,Kye=eA,i8=Cr.exports.re,r8=Cr.exports.t,iA=Yye,rA=ny,o8=nA,a8=l8;function s8(e,t){var n=typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Jye(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,a=!1,s;return{s:function(){n=n.call(e)},n:function(){var l=n.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(a)throw s}}}}function Jye(e,t){if(!!e){if(typeof e=="string")return u8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u8(e,t)}}function u8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}class Xh{constructor(t,n){if(n=Zye(n),t instanceof Xh)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new Xh(t.raw,n);if(t instanceof oA)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(s=>this.parseRange(s.trim())).filter(s=>s.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter(s=>!f8(s[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){var r=s8(this.set),o;try{for(r.s();!(o=r.n()).done;){var a=o.value;if(a.length===1&&rve(a[0])){this.set=[a];break}}}catch(s){r.e(s)}finally{r.f()}}}this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(t),r=c8.get(i);if(r)return r;var o=this.options.loose,a=o?An[on.HYPHENRANGELOOSE]:An[on.HYPHENRANGE];t=t.replace(a,gve(this.options.includePrerelease)),Et("hyphen replace",t),t=t.replace(An[on.COMPARATORTRIM],tve),Et("comparator trim",t,An[on.COMPARATORTRIM]),t=t.replace(An[on.TILDETRIM],nve),t=t.replace(An[on.CARETTRIM],ive),t=t.split(/\s+/).join(" ");var s=o?An[on.COMPARATORLOOSE]:An[on.COMPARATOR],u=t.split(" ").map(g=>ove(g,this.options)).join(" ").split(/\s+/).map(g=>hve(g,this.options)).filter(this.options.loose?g=>!!g.match(s):()=>!0).map(g=>new oA(g,this.options));u.length;var l=new Map,c=s8(u),f;try{for(c.s();!(f=c.n()).done;){var d=f.value;if(f8(d))return[d];l.set(d.value,d)}}catch(g){c.e(g)}finally{c.f()}l.size>1&&l.has("")&&l.delete("");var h=[...l.values()];return c8.set(i,h),h}intersects(t,n){if(!(t instanceof Xh))throw new TypeError("a Range is required");return this.set.some(i=>d8(i,n)&&t.set.some(r=>d8(r,n)&&i.every(o=>r.every(a=>o.intersects(a,n)))))}test(t){if(!t)return!1;if(typeof t=="string")try{t=new eve(t,this.options)}catch{return!1}for(var n=0;n<this.set.length;n++)if(pve(this.set[n],t,this.options))return!0;return!1}}var l8=Xh,Qye=fye,c8=new Qye({max:1e3}),Zye=eA,oA=Xye,Et=ny,eve=nA,An=Cr.exports.re,on=Cr.exports.t,tve=Cr.exports.comparatorTrimReplace,nve=Cr.exports.tildeTrimReplace,ive=Cr.exports.caretTrimReplace,f8=e=>e.value==="<0.0.0-0",rve=e=>e.value==="",d8=(e,t)=>{for(var n=!0,i=e.slice(),r=i.pop();n&&i.length;)n=i.every(o=>r.intersects(o,t)),r=i.pop();return n},ove=(e,t)=>(Et("comp",e,t),e=uve(e,t),Et("caret",e),e=ave(e,t),Et("tildes",e),e=cve(e,t),Et("xrange",e),e=dve(e,t),Et("stars",e),e),Wn=e=>!e||e.toLowerCase()==="x"||e==="*",ave=(e,t)=>e.trim().split(/\s+/).map(n=>sve(n,t)).join(" "),sve=(e,t)=>{var n=t.loose?An[on.TILDELOOSE]:An[on.TILDE];return e.replace(n,(i,r,o,a,s)=>{Et("tilde",e,i,r,o,a,s);var u;return Wn(r)?u="":Wn(o)?u=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):Wn(a)?u=">=".concat(r,".").concat(o,".0 <").concat(r,".").concat(+o+1,".0-0"):s?(Et("replaceTilde pr",s),u=">=".concat(r,".").concat(o,".").concat(a,"-").concat(s," <").concat(r,".").concat(+o+1,".0-0")):u=">=".concat(r,".").concat(o,".").concat(a," <").concat(r,".").concat(+o+1,".0-0"),Et("tilde return",u),u})},uve=(e,t)=>e.trim().split(/\s+/).map(n=>lve(n,t)).join(" "),lve=(e,t)=>{Et("caret",e,t);var n=t.loose?An[on.CARETLOOSE]:An[on.CARET],i=t.includePrerelease?"-0":"";return e.replace(n,(r,o,a,s,u)=>{Et("caret",e,r,o,a,s,u);var l;return Wn(o)?l="":Wn(a)?l=">=".concat(o,".0.0").concat(i," <").concat(+o+1,".0.0-0"):Wn(s)?o==="0"?l=">=".concat(o,".").concat(a,".0").concat(i," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".0").concat(i," <").concat(+o+1,".0.0-0"):u?(Et("replaceCaret pr",u),o==="0"?a==="0"?l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(o,".").concat(a,".").concat(+s+1,"-0"):l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".").concat(s,"-").concat(u," <").concat(+o+1,".0.0-0")):(Et("no pr"),o==="0"?a==="0"?l=">=".concat(o,".").concat(a,".").concat(s).concat(i," <").concat(o,".").concat(a,".").concat(+s+1,"-0"):l=">=".concat(o,".").concat(a,".").concat(s).concat(i," <").concat(o,".").concat(+a+1,".0-0"):l=">=".concat(o,".").concat(a,".").concat(s," <").concat(+o+1,".0.0-0")),Et("caret return",l),l})},cve=(e,t)=>(Et("replaceXRanges",e,t),e.split(/\s+/).map(n=>fve(n,t)).join(" ")),fve=(e,t)=>{e=e.trim();var n=t.loose?An[on.XRANGELOOSE]:An[on.XRANGE];return e.replace(n,(i,r,o,a,s,u)=>{Et("xRange",e,i,r,o,a,s,u);var l=Wn(o),c=l||Wn(a),f=c||Wn(s),d=f;return r==="="&&d&&(r=""),u=t.includePrerelease?"-0":"",l?r===">"||r==="<"?i="<0.0.0-0":i="*":r&&d?(c&&(a=0),s=0,r===">"?(r=">=",c?(o=+o+1,a=0,s=0):(a=+a+1,s=0)):r==="<="&&(r="<",c?o=+o+1:a=+a+1),r==="<"&&(u="-0"),i="".concat(r+o,".").concat(a,".").concat(s).concat(u)):c?i=">=".concat(o,".0.0").concat(u," <").concat(+o+1,".0.0-0"):f&&(i=">=".concat(o,".").concat(a,".0").concat(u," <").concat(o,".").concat(+a+1,".0-0")),Et("xRange return",i),i})},dve=(e,t)=>(Et("replaceStars",e,t),e.trim().replace(An[on.STAR],"")),hve=(e,t)=>(Et("replaceGTE0",e,t),e.trim().replace(An[t.includePrerelease?on.GTE0PRE:on.GTE0],"")),gve=e=>(t,n,i,r,o,a,s,u,l,c,f,d,h)=>(Wn(i)?n="":Wn(r)?n=">=".concat(i,".0.0").concat(e?"-0":""):Wn(o)?n=">=".concat(i,".").concat(r,".0").concat(e?"-0":""):a?n=">=".concat(n):n=">=".concat(n).concat(e?"-0":""),Wn(l)?u="":Wn(c)?u="<".concat(+l+1,".0.0-0"):Wn(f)?u="<".concat(l,".").concat(+c+1,".0-0"):d?u="<=".concat(l,".").concat(c,".").concat(f,"-").concat(d):e?u="<".concat(l,".").concat(c,".").concat(+f+1,"-0"):u="<=".concat(u),"".concat(n," ").concat(u).trim()),pve=(e,t,n)=>{for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var r=0;r<e.length;r++)if(Et(e[r].semver),e[r].semver!==oA.ANY&&e[r].semver.prerelease.length>0){var o=e[r].semver;if(o.major===t.major&&o.minor===t.minor&&o.patch===t.patch)return!0}return!1}return!0},mve=l8,yve=(e,t,n)=>{try{t=new mve(t,n)}catch{return!1}return t.test(e)},h8=yve;function vve(e,t,n){var i=e.open(t),r=1e4,o=250,a=new URL(t),s=a.origin,u=~~(r/o);function l(f){f.source===i&&(u=0,e.removeEventListener("message",l,!1))}e.addEventListener("message",l,!1);function c(){u<=0||(i.postMessage(n,s),setTimeout(c,o),u-=1)}setTimeout(c,o)}var bve=`.vega-embed {
  position: relative;
  display: inline-block;
  box-sizing: border-box;
}
.vega-embed.has-actions {
  padding-right: 38px;
}
.vega-embed details:not([open]) > :not(summary) {
  display: none !important;
}
.vega-embed summary {
  list-style: none;
  position: absolute;
  top: 0;
  right: 0;
  padding: 6px;
  z-index: 1000;
  background: white;
  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
  color: #1b1e23;
  border: 1px solid #aaa;
  border-radius: 999px;
  opacity: 0.2;
  transition: opacity 0.4s ease-in;
  outline: none;
  cursor: pointer;
  line-height: 0px;
}
.vega-embed summary::-webkit-details-marker {
  display: none;
}
.vega-embed summary:active {
  box-shadow: #aaa 0px 0px 0px 1px inset;
}
.vega-embed summary svg {
  width: 14px;
  height: 14px;
}
.vega-embed details[open] summary {
  opacity: 0.7;
}
.vega-embed:hover summary, .vega-embed:focus summary {
  opacity: 1 !important;
  transition: opacity 0.2s ease;
}
.vega-embed .vega-actions {
  position: absolute;
  z-index: 1001;
  top: 35px;
  right: -9px;
  display: flex;
  flex-direction: column;
  padding-bottom: 8px;
  padding-top: 8px;
  border-radius: 4px;
  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);
  border: 1px solid #d9d9d9;
  background: white;
  animation-duration: 0.15s;
  animation-name: scale-in;
  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);
  text-align: left;
}
.vega-embed .vega-actions a {
  padding: 8px 16px;
  font-family: sans-serif;
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  color: #434a56;
  text-decoration: none;
}
.vega-embed .vega-actions a:hover {
  background-color: #f7f7f9;
  color: black;
}
.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {
  content: "";
  display: inline-block;
  position: absolute;
}
.vega-embed .vega-actions::before {
  left: auto;
  right: 14px;
  top: -16px;
  border: 8px solid #0000;
  border-bottom-color: #d9d9d9;
}
.vega-embed .vega-actions::after {
  left: auto;
  right: 15px;
  top: -14px;
  border: 7px solid #0000;
  border-bottom-color: #fff;
}
.vega-embed .chart-wrapper.fit-x {
  width: 100%;
}
.vega-embed .chart-wrapper.fit-y {
  height: 100%;
}

.vega-embed-wrapper {
  max-width: 100%;
  overflow: auto;
  padding-right: 14px;
}

@keyframes scale-in {
  from {
    opacity: 0;
    transform: scale(0.6);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
`;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});function g8(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r];xve(e,a)}return e}function xve(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];hl(e,r,t[r],!0)}}var aA;function p8(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,i)}return n}function xs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?p8(Object(n),!0).forEach(function(i){X1e(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p8(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var ws=Mue,Kh=e1e,ay=typeof window!="undefined"?window:void 0;Kh===void 0&&ay!==null&&ay!==void 0&&(aA=ay.vl)!==null&&aA!==void 0&&aA.compile&&(Kh=ay.vl);var wve={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},_ve={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Jh={vega:"Vega","vega-lite":"Vega-Lite"},sy={vega:ws.version,"vega-lite":Kh?Kh.version:"not available"},Eve={vega:e=>e,"vega-lite":(e,t)=>Kh.compile(e,{config:t}).spec},Ove=`
<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
  <circle r="2" cy="8" cx="2"></circle>
  <circle r="2" cy="8" cx="8"></circle>
  <circle r="2" cy="8" cx="14"></circle>
</svg>`,Sve="chart-wrapper";function Ave(e){return typeof e=="function"}function m8(e,t,n,i){var r="<html><head>".concat(t,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),a=window.open("");a.document.write(r+e+o),a.document.title="".concat(Jh[i]," JSON Source")}function kve(e,t){if(e.$schema){var n=C4(e.$schema);if(t&&t!==n.library){var i;console.warn("The given visualization spec is written in ".concat(Jh[n.library],", but mode argument sets ").concat((i=Jh[t])!==null&&i!==void 0?i:t,"."))}var r=n.library;return h8(sy[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(Jh[r]," ").concat(n.version,", but the current version of ").concat(Jh[r]," is v").concat(sy[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t!=null?t:"vega"}function Cve(e){return!!(e&&"load"in e)}function y8(e){return Cve(e)?e:ws.loader(e)}function v8(e){var t;return(t=e.usermeta&&e.usermeta.embedOptions)!==null&&t!==void 0?t:{}}function lbe(e,t){return sA.apply(this,arguments)}function sA(){return sA=Y1(Eo.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h=arguments;return Eo.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:{},!K(n)){p.next=10;break}return s=y8(o.loader),p.t0=JSON,p.next=6,s.load(n);case 6:p.t1=p.sent,a=p.t0.parse.call(p.t0,p.t1),p.next=11;break;case 10:a=n;case 11:return u=v8(a).loader,(!s||u)&&(s=y8((l=o.loader)!==null&&l!==void 0?l:u)),p.next=15,b8(v8(a),s);case 15:return c=p.sent,p.next=18,b8(o,s);case 18:return f=p.sent,d=xs(xs({},g8(f,c)),{},{config:dl((i=f.config)!==null&&i!==void 0?i:{},(r=c.config)!==null&&r!==void 0?r:{})}),p.next=22,Fve(t,a,d,s);case 22:return p.abrupt("return",p.sent);case 23:case"end":return p.stop()}},e)})),sA.apply(this,arguments)}function b8(e,t){return uA.apply(this,arguments)}function uA(){return uA=Y1(Eo.mark(function e(t,n){var i,r,o;return Eo.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!K(t.config)){s.next=8;break}return s.t1=JSON,s.next=4,n.load(t.config);case 4:s.t2=s.sent,s.t0=s.t1.parse.call(s.t1,s.t2),s.next=9;break;case 8:s.t0=(i=t.config)!==null&&i!==void 0?i:{};case 9:if(r=s.t0,!K(t.patch)){s.next=18;break}return s.t4=JSON,s.next=14,n.load(t.patch);case 14:s.t5=s.sent,s.t3=s.t4.parse.call(s.t4,s.t5),s.next=19;break;case 18:s.t3=t.patch;case 19:return o=s.t3,s.abrupt("return",xs(xs(xs({},t),o?{patch:o}:{}),r?{config:r}:{}));case 21:case"end":return s.stop()}},e)})),uA.apply(this,arguments)}function Tve(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:(t=document.head)!==null&&t!==void 0?t:document.body}}function Fve(e,t){return lA.apply(this,arguments)}function lA(){return lA=Y1(Eo.mark(function e(t,n){var i,r,o,a,s,u,l,c,f,d,h,g,p,m,y,v,x,b,_,E,w,O,S,k,A,M,C,D,F,N,I,z,X,te,xe,ge,je,Oe,ke,Xe,xt,Ge,Y,ne,fe,B,Ve,pe,tt,qe=arguments;return Eo.wrap(function(me){for(;;)switch(me.prev=me.next){case 0:if(tt=function(){ge&&document.removeEventListener("click",ge),N.finalize()},c=qe.length>2&&qe[2]!==void 0?qe[2]:{},f=qe.length>3?qe[3]:void 0,d=c.theme?dl(P1e[c.theme],(i=c.config)!==null&&i!==void 0?i:{}):c.config,h=ga(c.actions)?c.actions:g8({},wve,(r=c.actions)!==null&&r!==void 0?r:{}),g=xs(xs({},_ve),c.i18n),p=(o=c.renderer)!==null&&o!==void 0?o:"canvas",m=(a=c.logLevel)!==null&&a!==void 0?a:ws.Warn,y=(s=c.downloadFileName)!==null&&s!==void 0?s:"visualization",v=typeof t=="string"?document.querySelector(t):t,v){me.next=12;break}throw new Error("".concat(t," does not exist"));case 12:return c.defaultStyle!==!1&&(x="vega-embed-style",b=Tve(v),_=b.root,E=b.rootContainer,_.getElementById(x)||(w=document.createElement("style"),w.id=x,w.innerText=c.defaultStyle===void 0||c.defaultStyle===!0?bve.toString():c.defaultStyle,E.appendChild(w))),O=kve(n,c.mode),S=Eve[O](n,d),O==="vega-lite"&&S.$schema&&(k=C4(S.$schema),h8(sy.vega,"^".concat(k.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(k.version,", but current version is v").concat(sy.vega,"."))),v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="",A=v,h&&(M=document.createElement("div"),M.classList.add(Sve),v.appendChild(M),A=M),C=c.patch,C&&(S=C instanceof Function?C(S):wg(S,C,!0,!1).newDocument),c.formatLocale&&ws.formatLocale(c.formatLocale),c.timeFormatLocale&&ws.timeFormatLocale(c.timeFormatLocale),D=c.ast,F=ws.parse(S,O==="vega-lite"?{}:d,{ast:D}),N=new(c.viewClass||ws.View)(F,xs({loader:f,logLevel:m,renderer:p},D?{expr:(u=(l=ws.expressionInterpreter)!==null&&l!==void 0?l:c.expr)!==null&&u!==void 0?u:Bue}:{})),N.addSignalListener("autosize",(Ct,Ke)=>{var st=Ke.type;st=="fit-x"?(A.classList.add("fit-x"),A.classList.remove("fit-y")):st=="fit-y"?(A.classList.remove("fit-x"),A.classList.add("fit-y")):st=="fit"?A.classList.add("fit-x","fit-y"):A.classList.remove("fit-x","fit-y")}),c.tooltip!==!1&&(I=Ave(c.tooltip)?c.tooltip:new Y1e(c.tooltip===!0?{}:c.tooltip).call,N.tooltip(I)),z=c.hover,z===void 0&&(z=O==="vega"),z&&(X=typeof z=="boolean"?{}:z,te=X.hoverSet,xe=X.updateSet,N.hover(te,xe)),c&&(c.width!=null&&N.width(c.width),c.height!=null&&N.height(c.height),c.padding!=null&&N.padding(c.padding)),me.next=36,N.initialize(A,c.bind).runAsync();case 36:if(h!==!1){if(je=v,c.defaultStyle!==!1&&(Oe=document.createElement("details"),Oe.title=g.CLICK_TO_VIEW_ACTIONS,v.append(Oe),je=Oe,ke=document.createElement("summary"),ke.innerHTML=Ove,Oe.append(ke),ge=Ct=>{Oe.contains(Ct.target)||Oe.removeAttribute("open")},document.addEventListener("click",ge)),Xe=document.createElement("div"),je.append(Xe),Xe.classList.add("vega-actions"),h===!0||h.export!==!1)for(xt=function(){var Ke=Y[Ge];if(h===!0||h.export===!0||h.export[Ke]){var st=g["".concat(Ke.toUpperCase(),"_ACTION")],wt=document.createElement("a");wt.text=st,wt.href="#",wt.target="_blank",wt.download="".concat(y,".").concat(Ke),wt.addEventListener("mousedown",function(){var an=Y1(Eo.mark(function Yt(Ki){var nt;return Eo.wrap(function(sn){for(;;)switch(sn.prev=sn.next){case 0:return Ki.preventDefault(),sn.next=3,N.toImageURL(Ke,c.scaleFactor);case 3:nt=sn.sent,this.href=nt;case 5:case"end":return sn.stop()}},Yt,this)}));return function(Yt){return an.apply(this,arguments)}}()),Xe.append(wt)}},Ge=0,Y=["svg","png"];Ge<Y.length;Ge++)xt();(h===!0||h.source!==!1)&&(ne=document.createElement("a"),ne.text=g.SOURCE_ACTION,ne.href="#",ne.addEventListener("click",function(Ct){var Ke,st;m8(By(n),(Ke=c.sourceHeader)!==null&&Ke!==void 0?Ke:"",(st=c.sourceFooter)!==null&&st!==void 0?st:"",O),Ct.preventDefault()}),Xe.append(ne)),O==="vega-lite"&&(h===!0||h.compiled!==!1)&&(fe=document.createElement("a"),fe.text=g.COMPILED_ACTION,fe.href="#",fe.addEventListener("click",function(Ct){var Ke,st;m8(By(S),(Ke=c.sourceHeader)!==null&&Ke!==void 0?Ke:"",(st=c.sourceFooter)!==null&&st!==void 0?st:"","vega"),Ct.preventDefault()}),Xe.append(fe)),(h===!0||h.editor!==!1)&&(Ve=(B=c.editorUrl)!==null&&B!==void 0?B:"https://vega.github.io/editor/",pe=document.createElement("a"),pe.text=g.EDITOR_ACTION,pe.href="#",pe.addEventListener("click",function(Ct){vve(window,Ve,{config:d,mode:O,renderer:p,spec:By(n)}),Ct.preventDefault()}),Xe.append(pe))}return me.abrupt("return",{view:N,spec:n,vgSpec:S,finalize:tt});case 38:case"end":return me.stop()}},e)})),lA.apply(this,arguments)}export{Kve as $,t7 as A,L8 as B,obe as C,Gve as D,Jc as E,Ot as F,Zc as G,ef as H,Qc as I,Ti as J,Mve as K,fy as L,Wve as M,Qu as N,$ve as O,Dve as P,pi as Q,el as R,r7 as S,Yve as T,Xve as U,ko as V,Ku as W,abe as X,Uve as Y,Nve as Z,Vve as _,ln as a,Zve as a0,sbe as a1,sg as a2,nbe as a3,Qve as a4,Jve as a5,bg as a6,lbe as a7,Y8 as a8,jve as a9,Rve as aa,Lve as ab,Ive as ac,Hve as ad,ig as ae,CA as af,Bve as ag,ube as ah,Te as b,cn as c,we as d,Ft as e,ct as f,Zi as g,Ss as h,i7 as i,la as j,un as k,ca as l,tl as m,Lt as n,nl as o,ft as p,qve as q,zve as r,bA as s,gi as t,Pve as u,ibe as v,rbe as w,e7 as x,ebe as y,tbe as z};
