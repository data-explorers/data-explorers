import{S as pt,i as _t,s as ht,e as w,t as ie,c as T,a as E,g as fe,d as p,b as O,f as C,F as k,Z as Ne,J as Ae,k as H,m as pe,n as b,o as _e,p as g,j as I,v as P,l as D,w as U,O as Qe,x as z,Q as Be,h as $e,A as J,Y as gt,u as dt,V as Ge,a7 as kt,a2 as Ye,L as Oe}from"./vendor-181e6373.js";import{a as bt}from"./index-3e2e77ec.js";import{i as Ze,r as vt,e as St,s as Ct,c as Mt}from"./mapUtils-e9636914.js";import{s as Lt,d as Ot,u as wt,e as Tt,h as Ke,i as yt,j as Et,m as Ie}from"./observation_data-5a0f0216.js";import{t as He,M as $t,e as It,b as Dt,f as We,g as Xe,h as xe,I as et}from"./bar_chart-3f1158c2.js";import{M as Vt,a as jt,b as Nt,S as At,c as Bt,R as Yt}from"./map_toggle_marker_type_button-05cd7001.js";import{C as Pe}from"./CircleMarker-ae9b1e84.js";import"./formatUtils-77b182ad.js";import"./constants-3d7024b8.js";function tt(l,o,r){const a=l.slice();return a[59]=o[r][0],a[0]=o[r][1],a}function lt(l,o,r){const a=l.slice();return a[51]=o[r],a}function ot(l,o,r){const a=l.slice();return a[54]=o[r][0],a[0]=o[r][1],a}function rt(l,o,r){const a=l.slice();return a[51]=o[r],a}function nt(l,o,r){const a=l.slice();return a[51]=o[r],a}function st(l){let o,r,a,e,i,t;return{c(){o=w("span"),r=ie("*"),this.h()},l(s){o=T(s,"SPAN",{class:!0,title:!0});var n=E(o);r=fe(n,"*"),n.forEach(p),this.h()},h(){O(o,"class","text-red-600"),O(o,"title",a="Since there are over "+Ve+" observations on the map, the map uses clustered markers.")},m(s,n){C(s,o,n),k(o,r),i||(t=Ne(e=He.call(null,o)),i=!0)},p:Ae,d(s){s&&p(o),i=!1,t()}}}function at(l){let o,r,a,e;const i=[Ht,Zt],t=[];function s(n,c){return n[23]?0:1}return o=s(l),r=t[o]=i[o](l),{c(){r.c(),a=H()},l(n){r.l(n),a=H()},m(n,c){t[o].m(n,c),C(n,a,c),e=!0},p(n,c){let _=o;o=s(n),o===_?t[o].p(n,c):(pe(),b(t[_],1,1,()=>{t[_]=null}),_e(),r=t[o],r?r.p(n,c):(r=t[o]=i[o](n),r.c()),g(r,1),r.m(a.parentNode,a))},i(n){e||(g(r),e=!0)},o(n){b(r),e=!1},d(n){t[o].d(n),n&&p(a)}}}function Zt(l){let o,r,a,e,i;return r=new et({}),{c(){o=w("span"),P(r.$$.fragment),this.h()},l(t){o=T(t,"SPAN",{title:!0});var s=E(o);U(r.$$.fragment,s),s.forEach(p),this.h()},h(){O(o,"title","click show to species list")},m(t,s){C(t,o,s),z(r,o,null),a=!0,e||(i=[Ne(He.call(null,o)),Be(o,"click",l[27])],e=!0)},p:Ae,i(t){a||(g(r.$$.fragment,t),a=!0)},o(t){b(r.$$.fragment,t),a=!1},d(t){t&&p(o),J(r),e=!1,Ge(i)}}}function Ht(l){let o,r,a,e,i;return r=new et({}),{c(){o=w("span"),P(r.$$.fragment),this.h()},l(t){o=T(t,"SPAN",{title:!0});var s=E(o);U(r.$$.fragment,s),s.forEach(p),this.h()},h(){O(o,"title","click hide to species list")},m(t,s){C(t,o,s),z(r,o,null),a=!0,e||(i=[Ne(He.call(null,o)),Be(o,"click",l[27])],e=!0)},p:Ae,i(t){a||(g(r.$$.fragment,t),a=!0)},o(t){b(r.$$.fragment,t),a=!1},d(t){t&&p(o),J(r),e=!1,Ge(i)}}}function Pt(l){let o,r,a=[...l[8]],e=[];for(let t=0;t<a.length;t+=1)e[t]=ft(tt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=H()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=H()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073754370){a=[...t[8]];let n;for(n=0;n<a.length;n+=1){const c=tt(t,a,n);e[n]?(e[n].p(c,s),g(e[n],1)):(e[n]=ft(c),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function Ut(l){let o,r,a=[...l[8]],e=[];for(let t=0;t<a.length;t+=1)e[t]=ut(ot(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=H()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=H()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=[...t[8]];let n;for(n=0;n<a.length;n+=1){const c=ot(t,a,n);e[n]?(e[n].p(c,s),g(e[n],1)):(e[n]=ut(c),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function zt(l){let o,r,a=l[8],e=[];for(let t=0;t<a.length;t+=1)e[t]=mt(nt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=H()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=H()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=t[8];let n;for(n=0;n<a.length;n+=1){const c=nt(t,a,n);e[n]?(e[n].p(c,s),g(e[n],1)):(e[n]=mt(c),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function Jt(l){let o,r;return o=new Bt({props:{items:l[8]}}),{c(){P(o.$$.fragment)},l(a){U(o.$$.fragment,a)},m(a,e){z(o,a,e),r=!0},p(a,e){const i={};e[0]&256&&(i.items=a[8]),o.$set(i)},i(a){r||(g(o.$$.fragment,a),r=!0)},o(a){b(o.$$.fragment,a),r=!1},d(a){J(o,a)}}}function Rt(l){let o,r;function a(...e){return l[40](l[51],...e)}return o=new Yt({props:{events:["click"],latLngBounds:[[l[51].latitude-l[12],l[51].longitude-l[13]],[l[51].latitude+l[12],l[51].longitude+l[13]]],color:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor,fillColor:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor}}),o.$on("click",a),{c(){P(o.$$.fragment)},l(e){U(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&12544&&(t.latLngBounds=[[l[51].latitude-l[12],l[51].longitude-l[13]],[l[51].latitude+l[12],l[51].longitude+l[13]]]),i[0]&258&&(t.color=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),o.$set(t)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function Ft(l){let o,r;function a(...e){return l[39](l[51],...e)}return o=new Pe({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:Ue,color:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor,fillColor:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor}}),o.$on("click",a),{c(){P(o.$$.fragment)},l(e){U(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&258&&(t.color=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),o.$set(t)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function it(l){let o,r,a,e,i;const t=[Ft,Rt],s=[];function n(c,_){return _[0]&256&&(o=null),o==null&&(o=!!Mt.includes(c[51].month+1)),o?0:1}return r=n(l,[-1,-1,-1]),a=s[r]=t[r](l),{c(){a.c(),e=H()},l(c){a.l(c),e=H()},m(c,_){s[r].m(c,_),C(c,e,_),i=!0},p(c,_){let S=r;r=n(c,_),r===S?s[r].p(c,_):(pe(),b(s[S],1,1,()=>{s[S]=null}),_e(),a=s[r],a?a.p(c,_):(a=s[r]=t[r](c),a.c()),g(a,1),a.m(e.parentNode,e))},i(c){i||(g(a),i=!0)},o(c){b(a),i=!1},d(c){s[r].d(c),c&&p(e)}}}function ft(l){let o,r,a=l[0],e=[];for(let t=0;t<a.length;t+=1)e[t]=it(lt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=H()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=H()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073754370){a=t[0];let n;for(n=0;n<a.length;n+=1){const c=lt(t,a,n);e[n]?(e[n].p(c,s),g(e[n],1)):(e[n]=it(c),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function ct(l){let o,r;function a(...e){return l[38](l[51],...e)}return o=new Pe({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:Ue,color:l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor,fillColor:l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor}}),o.$on("click",a),{c(){P(o.$$.fragment)},l(e){U(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&258&&(t.color=l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor),o.$set(t)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function ut(l){let o,r,a=l[0],e=[];for(let t=0;t<a.length;t+=1)e[t]=ct(rt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=H()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=H()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=t[0];let n;for(n=0;n<a.length;n+=1){const c=rt(t,a,n);e[n]?(e[n].p(c,s),g(e[n],1)):(e[n]=ct(c),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function mt(l){let o,r;function a(...e){return l[37](l[51],...e)}return o=new Pe({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:Ue,color:l[1].defaultColor,fillColor:l[1].defaultColor}}),o.$on("click",a),{c(){P(o.$$.fragment)},l(e){U(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&2&&(t.color=l[1].defaultColor),i[0]&2&&(t.fillColor=l[1].defaultColor),o.$set(t)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function qt(l){let o,r,a,e,i,t,s,n,c,_,S,x;o=new Vt({props:{country:l[2].country}});const G=[Jt,zt,Ut,Pt],V=[];function A(u,d){return d[0]&256&&(a=null),u[15]?0:(a==null&&(a=!!Array.isArray(u[8])),a?1:u[1].observationsTimeSpan==="year"?2:3)}e=A(l,[-1,-1,-1]),i=V[e]=G[e](l),s=new jt({props:{map:l[4],coordinates:l[6]}});let B={coordinates:l[6],useMarkerCluster:l[15],observationsOnMapCount:l[18],clusterLimit:Ve,userSelectedMarkerType:l[16],zoomLevel:l[11],maxZoom:l[20]};c=new Nt({props:B}),l[41](c),c.$on("changeMarkerModeOnClick",l[25]),c.$on("changeMarkerModeAutomatic",l[26]);let K={position:"bottomleft",options:Ct};return S=new At({props:K}),l[42](S),{c(){P(o.$$.fragment),r=I(),i.c(),t=I(),P(s.$$.fragment),n=I(),P(c.$$.fragment),_=I(),P(S.$$.fragment)},l(u){U(o.$$.fragment,u),r=D(u),i.l(u),t=D(u),U(s.$$.fragment,u),n=D(u),U(c.$$.fragment,u),_=D(u),U(S.$$.fragment,u)},m(u,d){z(o,u,d),C(u,r,d),V[e].m(u,d),C(u,t,d),z(s,u,d),C(u,n,d),z(c,u,d),C(u,_,d),z(S,u,d),x=!0},p(u,d){const R={};d[0]&4&&(R.country=u[2].country),o.$set(R);let F=e;e=A(u,d),e===F?V[e].p(u,d):(pe(),b(V[F],1,1,()=>{V[F]=null}),_e(),i=V[e],i?i.p(u,d):(i=V[e]=G[e](u),i.c()),g(i,1),i.m(t.parentNode,t));const le={};d[0]&16&&(le.map=u[4]),d[0]&64&&(le.coordinates=u[6]),s.$set(le);const y={};d[0]&64&&(y.coordinates=u[6]),d[0]&32768&&(y.useMarkerCluster=u[15]),d[0]&262144&&(y.observationsOnMapCount=u[18]),d[0]&65536&&(y.userSelectedMarkerType=u[16]),d[0]&2048&&(y.zoomLevel=u[11]),d[0]&1048576&&(y.maxZoom=u[20]),c.$set(y);const Y={};S.$set(Y)},i(u){x||(g(o.$$.fragment,u),g(i),g(s.$$.fragment,u),g(c.$$.fragment,u),g(S.$$.fragment,u),x=!0)},o(u){b(o.$$.fragment,u),b(i),b(s.$$.fragment,u),b(c.$$.fragment,u),b(S.$$.fragment,u),x=!1},d(u){J(o,u),u&&p(r),V[e].d(u),u&&p(t),J(s,u),u&&p(n),l[41](null),J(c,u),u&&p(_),l[42](null),J(S,u)}}}function Qt(l){let o,r,a,e,i,t,s,n,c,_,S,x,G,V,A,B,K,u,d,R,F,le,y,Y,j,de,W,ce,ke,he,X,q,ee,te,oe,re,be,Q,ne,Se,ge,Ce,se,ue,N,Me,we,$=l[18]>=Ve&&st(),M=l[24]&&at(l),je={options:l[1],$$slots:{default:[qt]},$$scope:{ctx:l}};return q=new bt({props:je}),l[43](q),te=new $t({props:{showSpeciesList:l[23],speciesList:l[9]}}),re=new It({props:{mapOptions:l[1],selectTimeSpanHandler:l[29],groupedObservations:l[7],toggleTimeSpans:l[28],timeSpanHistory:l[5],activeTaxaCount:1}}),{c(){o=w("div"),r=w("div"),a=w("div"),e=ie("Observations"),i=I(),t=w("div"),s=ie(l[19]),n=I(),c=w("div"),_=w("div"),S=ie(`Observations on map
      `),$&&$.c(),x=I(),G=w("div"),V=ie(l[18]),A=I(),B=w("div"),K=w("div"),u=ie("Species"),d=I(),R=w("div"),F=ie(l[21]),le=I(),y=w("div"),Y=w("div"),j=ie("Species on map"),de=I(),W=w("div"),ce=ie(l[22]),ke=I(),M&&M.c(),he=I(),X=w("div"),P(q.$$.fragment),ee=I(),P(te.$$.fragment),oe=I(),P(re.$$.fragment),be=I(),Q=w("label"),ne=w("input"),Se=I(),ge=w("span"),Ce=ie("Update charts as map changes"),se=I(),ue=w("div"),this.h()},l(m){o=T(m,"DIV",{class:!0});var h=E(o);r=T(h,"DIV",{class:!0});var ae=E(r);a=T(ae,"DIV",{class:!0});var f=E(a);e=fe(f,"Observations"),f.forEach(p),i=D(ae),t=T(ae,"DIV",{class:!0});var v=E(t);s=fe(v,l[19]),v.forEach(p),ae.forEach(p),n=D(h),c=T(h,"DIV",{class:!0});var Z=E(c);_=T(Z,"DIV",{class:!0});var me=E(_);S=fe(me,`Observations on map
      `),$&&$.l(me),me.forEach(p),x=D(Z),G=T(Z,"DIV",{class:!0});var Le=E(G);V=fe(Le,l[18]),Le.forEach(p),Z.forEach(p),A=D(h),B=T(h,"DIV",{class:!0});var ve=E(B);K=T(ve,"DIV",{class:!0});var ze=E(K);u=fe(ze,"Species"),ze.forEach(p),d=D(ve),R=T(ve,"DIV",{class:!0});var Je=E(R);F=fe(Je,l[21]),Je.forEach(p),ve.forEach(p),le=D(h),y=T(h,"DIV",{class:!0});var Te=E(y);Y=T(Te,"DIV",{class:!0});var Re=E(Y);j=fe(Re,"Species on map"),Re.forEach(p),de=D(Te),W=T(Te,"DIV",{class:!0});var ye=E(W);ce=fe(ye,l[22]),ke=D(ye),M&&M.l(ye),ye.forEach(p),Te.forEach(p),h.forEach(p),he=D(m),X=T(m,"DIV",{id:!0,style:!0});var Fe=E(X);U(q.$$.fragment,Fe),Fe.forEach(p),ee=D(m),U(te.$$.fragment,m),oe=D(m),U(re.$$.fragment,m),be=D(m),Q=T(m,"LABEL",{class:!0});var Ee=E(Q);ne=T(Ee,"INPUT",{type:!0}),Se=D(Ee),ge=T(Ee,"SPAN",{});var qe=E(ge);Ce=fe(qe,"Update charts as map changes"),qe.forEach(p),Ee.forEach(p),se=D(m),ue=T(m,"DIV",{id:!0,class:!0}),E(ue).forEach(p),this.h()},h(){O(a,"class","stat-title svelte-2kul5f"),O(t,"class","stat-value svelte-2kul5f"),O(r,"class","stat place-items-center place-content-center svelte-2kul5f"),O(_,"class","stat-title svelte-2kul5f"),O(G,"class","stat-value svelte-2kul5f"),O(c,"class","stat place-items-center place-content-center svelte-2kul5f"),O(K,"class","stat-title svelte-2kul5f"),O(R,"class","stat-value svelte-2kul5f"),O(B,"class","stat place-items-center place-content-center svelte-2kul5f"),O(Y,"class","stat-title svelte-2kul5f"),O(W,"class","stat-value svelte-2kul5f"),O(y,"class","stat place-items-center place-content-center svelte-2kul5f"),O(o,"class","w-full rounded-none border stats"),O(X,"id","taxa-map"),Qe(X,"width","100%"),Qe(X,"height","400px"),O(ne,"type","checkbox"),O(Q,"class","cursor-pointer mt-2 inline-block"),O(ue,"id","observations-chart"),O(ue,"class","w-full mt-4")},m(m,h){C(m,o,h),k(o,r),k(r,a),k(a,e),k(r,i),k(r,t),k(t,s),k(o,n),k(o,c),k(c,_),k(_,S),$&&$.m(_,null),k(c,x),k(c,G),k(G,V),k(o,A),k(o,B),k(B,K),k(K,u),k(B,d),k(B,R),k(R,F),k(o,le),k(o,y),k(y,Y),k(Y,j),k(y,de),k(y,W),k(W,ce),k(W,ke),M&&M.m(W,null),C(m,he,h),C(m,X,h),z(q,X,null),C(m,ee,h),z(te,m,h),C(m,oe,h),z(re,m,h),C(m,be,h),C(m,Q,h),k(Q,ne),ne.checked=l[10],k(Q,Se),k(Q,ge),k(ge,Ce),C(m,se,h),C(m,ue,h),N=!0,Me||(we=Be(ne,"change",l[44]),Me=!0)},p(m,h){(!N||h[0]&524288)&&$e(s,m[19]),m[18]>=Ve?$?$.p(m,h):($=st(),$.c(),$.m(_,null)):$&&($.d(1),$=null),(!N||h[0]&262144)&&$e(V,m[18]),(!N||h[0]&2097152)&&$e(F,m[21]),(!N||h[0]&4194304)&&$e(ce,m[22]),m[24]?M?(M.p(m,h),h[0]&16777216&&g(M,1)):(M=at(m),M.c(),g(M,1),M.m(W,null)):M&&(pe(),b(M,1,1,()=>{M=null}),_e());const ae={};h[0]&2&&(ae.options=m[1]),h[0]&1571158|h[2]&4&&(ae.$$scope={dirty:h,ctx:m}),q.$set(ae);const f={};h[0]&8388608&&(f.showSpeciesList=m[23]),h[0]&512&&(f.speciesList=m[9]),te.$set(f);const v={};h[0]&2&&(v.mapOptions=m[1]),h[0]&128&&(v.groupedObservations=m[7]),h[0]&32&&(v.timeSpanHistory=m[5]),re.$set(v),h[0]&1024&&(ne.checked=m[10])},i(m){N||(g(M),g(q.$$.fragment,m),g(te.$$.fragment,m),g(re.$$.fragment,m),N=!0)},o(m){b(M),b(q.$$.fragment,m),b(te.$$.fragment,m),b(re.$$.fragment,m),N=!1},d(m){m&&p(o),$&&$.d(),M&&M.d(),m&&p(he),m&&p(X),l[43](null),J(q),m&&p(ee),J(te,m),m&&p(oe),J(re,m),m&&p(be),m&&p(Q),m&&p(se),m&&p(ue),Me=!1,we()}}}let Ue=8,Gt="oldest",De=.25,Ve=1e3;function Kt(l,o,r){let{observations:a}=o,{mapOptions:e}=o,{mapCenter:i}=o,{project:t}=o,{taxon:s}=o,n,c,_={},S=0,x=1,G=1,V=[],A=[],B=[];const K=gt();let u=!1,d=JSON.parse(JSON.stringify(Dt)),R,F=!1,le="markers",y,Y=[],j=[],de=0,W=0,ce=!1,ke=0,he=0,X=0,q=!1,ee=[],te=!1,oe=!1;function re(f){r(15,F=f.detail.useMarkerCluster),r(16,le=f.detail.userSelectedMarkerType),r(8,j=Q(j))}function be(f){r(15,F=f.detail.useMarkerCluster),r(8,j=Q(j))}function Q(f){let v;if(Array.isArray(f))v=f.filter(Z=>Ze(Z,c,L));else if(F){let Z=[];f.forEach((me,Le)=>{me=me.filter(ve=>Ze(ve,c,L)),Z=Z.concat(me)}),v=Z}else v=new Map,f.forEach((Z,me)=>{Z=Z.filter(Le=>Ze(Le,c,L)),v.set(me,Z)});return v}function ne(f){r(12,x=vt(f)),r(13,G=St(f))}function Se(){r(23,q=!q)}function ge(f){r(5,_=wt(f,_))}function Ce(){r(5,_={})}function se(f,v){K("markerClick",{observation_id:v.id,latlng:f.detail.latlng})}function ue(f){f.length>0&&c.fitBounds(f),K("doneLoading")}function N(f){kt("#observations-chart",f,{actions:!1}).then(v=>{}).catch(console.warn)}dt(()=>{r(34,u=!0),r(4,c=n.getMap()),r(11,S=c.getZoom()),r(20,ke=c.getMaxZoom()),ne(S),c.on("zoomend",function(){r(11,S=c.getZoom()),r(36,ce=!0),ne(S)}),c.on("moveend",function(){r(36,ce=!0)})});const Me=(f,v)=>se(v,f),we=(f,v)=>se(v,f),$=(f,v)=>se(v,f),M=(f,v)=>se(v,f);function je(f){Ye[f?"unshift":"push"](()=>{y=f,r(17,y)})}function m(f){Ye[f?"unshift":"push"](()=>{R=f,r(14,R)})}function h(f){Ye[f?"unshift":"push"](()=>{n=f,r(3,n)})}function ae(){oe=this.checked,r(10,oe)}return l.$$set=f=>{"observations"in f&&r(0,a=f.observations),"mapOptions"in f&&r(1,e=f.mapOptions),"mapCenter"in f&&r(31,i=f.mapCenter),"project"in f&&r(2,t=f.project),"taxon"in f&&r(32,s=f.taxon)},l.$$.update=()=>{if(l.$$.dirty[0]&1&&(r(0,a=a.filter(f=>f.latitude&&f.longitude)),r(6,V=a.map(f=>[f.latitude,f.longitude])),r(5,_={})),l.$$.dirty[0]&163|l.$$.dirty[1]&4&&(r(33,B=Lt(a,Gt,e.observationsTimeSpan)),r(7,A=Ot(B,e.observationsTimeSpan)),e.observationsTimeSpan!=="all"&&Object.keys(_).length===0&&A.forEach((f,v)=>r(5,_[v]=!0,_))),l.$$.dirty[0]&72&&n&&ue(V),l.$$.dirty[0]&936|l.$$.dirty[1]&50&&n&&(r(35,Y=Tt(A,_)),r(19,W=Ke(Y)),r(8,j=Q(Y)),r(18,de=Ke(j)),r(21,he=yt(Y)),r(9,ee=Et(j)),r(22,X=ee.length),r(24,te=ee.length>1||ee.length==1&&ee[0].taxon_id!==s.taxon_id),r(36,ce=!1)),l.$$.dirty[0]&1190|l.$$.dirty[1]&8&&u&&!oe){if(e.observationsTimeSpan==="month"){let f=We(d,De,_,e,A,t);N(f)}else if(e.observationsTimeSpan==="year"){let f=Xe(d,De,_,e,A,t);N(f)}else if(e.observationsTimeSpan==="all"){let f=xe(d,e,A);N(f)}}if(l.$$.dirty[0]&1318|l.$$.dirty[1]&8&&u&&oe){if(e.observationsTimeSpan==="month"){let f=We(d,De,_,e,j,t);N(f)}else if(e.observationsTimeSpan==="year"){let f=Xe(d,De,_,e,j,t);N(f)}else if(e.observationsTimeSpan==="all"){let f=xe(d,e,j);N(f)}}l.$$.dirty[0]&24|l.$$.dirty[1]&1&&n&&i&&i.longitude&&(document.getElementById("taxa-map").scrollIntoView(),c.flyTo([i.latitude,i.longitude],c.getMaxZoom()-1),r(31,i={}))},[a,e,t,n,c,_,V,A,j,ee,oe,S,x,G,R,F,le,y,de,W,ke,he,X,q,te,re,be,Se,ge,Ce,se,i,s,B,u,Y,ce,Me,we,$,M,je,m,h,ae]}class sl extends pt{constructor(o){super();_t(this,o,Kt,Qt,ht,{observations:0,mapOptions:1,mapCenter:31,project:2,taxon:32},null,[-1,-1,-1])}}export{sl as default};
