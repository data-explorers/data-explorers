var W=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var I=(r,t,n)=>t in r?W(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n,N=(r,t)=>{for(var n in t||(t={}))X.call(t,n)&&I(r,n,t[n]);if(G)for(var n of G(t))Y.call(t,n)&&I(r,n,t[n]);return r},z=(r,t)=>K(r,Q(t));import{S as _,i as M,s as b,af as S,ag as O,G as v,H as p,I as $,p as L,n as B,e as tt,c as et,a as nt,d as F,f as at,m as rt,o as lt,q as ot,W as Z,E as st,v as E,w as A,x as j,A as R,a0 as P}from"./vendor-35134e52.js";import{L as m,E as it}from"./index-4cf94f11.js";import{f as ct,g as ut}from"./mapUtils-e9636914.js";function ft(r,t,n){const{getMap:a}=S(m);let{icon:e}=t,{callback:l}=t,{states:s}=t,{title:c}=t,o;O(()=>{o.remove()});function y(){return o}return r.$$set=i=>{"icon"in i&&n(0,e=i.icon),"callback"in i&&n(1,l=i.callback),"states"in i&&n(2,s=i.states),"title"in i&&n(3,c=i.title)},r.$$.update=()=>{r.$$.dirty&47&&(o||(e&&l?n(5,o=m.easyButton(e,l,c).addTo(a())):n(5,o=m.easyButton(s).addTo(a()))))},[e,l,s,c,y,o]}class U extends _{constructor(t){super();M(this,t,ft,null,b,{icon:0,callback:1,states:2,title:3,getButton:4})}get getButton(){return this.$$.ctx[4]}}function gt(r,t,n){if(r.properties){let a="";n.popup_fields?(a+=`<table class="popup-table not-prose">
`,n.popup_fields.forEach(e=>{a+=`<tr>
`,a+="<th>"+e.name+"</th>",a+="<td>"+r.properties[e.original_name]+"</td>",a+=`</tr>
`}),a+="</table>"):a=JSON.stringify(r.properties),t.bindPopup(a)}}function mt(r,t,n){const{getMap:a}=S(m);let{baseLayersData:e={}}=t,{overlayLayersData:l=[]}=t,s={},c={};Object.entries(e).forEach(([i,g],h)=>{let d=m.tileLayer(g.url,g.options);n(3,s[i]=d,s),h===0&&d.addTo(a())}),l.forEach(i=>{let g,h=z(N({},i.options),{onEachFeature:(d,C)=>gt(d,C,i),style(d){return{color:d.properties.color,opacity:i.opacity||1,fillOpacity:i.fillOpacity||.2}}});i.type==="geojson"&&(g=m.geoJSON(i.data,h),n(4,c[i.name]=g,c))});let o;O(()=>{o.remove()});function y(){return o}return r.$$set=i=>{"baseLayersData"in i&&n(0,e=i.baseLayersData),"overlayLayersData"in i&&n(1,l=i.overlayLayersData)},r.$$.update=()=>{r.$$.dirty&56&&(o||n(5,o=m.control.layers(s,c).addTo(a())))},[e,l,y,s,c,o]}class yt extends _{constructor(t){super();M(this,t,mt,null,b,{baseLayersData:0,overlayLayersData:1,getLayerControl:2})}get getLayerControl(){return this.$$.ctx[2]}}function dt(r,t,n){const{getMap:a}=S(m);let{items:e}=t,l;O(()=>{l.remove()});function s(){return l}return r.$$set=c=>{"items"in c&&n(0,e=c.items)},r.$$.update=()=>{r.$$.dirty&5&&(l&&(l.remove(),n(2,l=null)),l||n(2,l=m.markerClusterGroup({singleMarkerMode:!0}).addTo(a())),e.length>0&&e.forEach(c=>{l.addLayer(m.marker([c.latitude,c.longitude]))}))},[e,s,l]}class Dt extends _{constructor(t){super();M(this,t,dt,null,b,{items:0,getLayerControl:1})}get getLayerControl(){return this.$$.ctx[1]}}function q(r){let t;const n=r[17].default,a=st(n,r,r[16],null);return{c(){a&&a.c()},l(e){a&&a.l(e)},m(e,l){a&&a.m(e,l),t=!0},p(e,l){a&&a.p&&(!t||l&65536)&&v(a,n,e,e[16],t?$(n,e[16],l,null):p(e[16]),null)},i(e){t||(L(a,e),t=!0)},o(e){B(a,e),t=!1},d(e){a&&a.d(e)}}}function ht(r){let t,n,a=r[0]&&q(r);return{c(){t=tt("div"),a&&a.c()},l(e){t=et(e,"DIV",{});var l=nt(t);a&&a.l(l),l.forEach(F)},m(e,l){at(e,t,l),a&&a.m(t,null),n=!0},p(e,[l]){e[0]?a?(a.p(e,l),l&1&&L(a,1)):(a=q(e),a.c(),L(a,1),a.m(t,null)):a&&(rt(),B(a,1,1,()=>{a=null}),lt())},i(e){n||(L(a),n=!0)},o(e){B(a),n=!1},d(e){e&&F(t),a&&a.d()}}}function kt(r,t,n){let{$$slots:a={},$$scope:e}=t;const{getMap:l}=S(m);let{latLngBounds:s}=t,{color:c="#3388ff"}=t,{weight:o=3}=t,{opacity:y=1}=t,{lineCap:i="round"}=t,{lineJoin:g="round"}=t,{dashArray:h=null}=t,{dashOffset:d=null}=t,{fill:C=!0}=t,{fillColor:f="#3388ff"}=t,{fillOpacity:w=.2}=t,{fillRule:T="evenodd"}=t,{options:x={}}=t,{events:D=[]}=t,k;ot(m.Layer,{getLayer:()=>k});const H=Z();let J;O(()=>{J.unregister(),k.removeFrom(l())});function V(){return k}return r.$$set=u=>{"latLngBounds"in u&&n(1,s=u.latLngBounds),"color"in u&&n(2,c=u.color),"weight"in u&&n(3,o=u.weight),"opacity"in u&&n(4,y=u.opacity),"lineCap"in u&&n(5,i=u.lineCap),"lineJoin"in u&&n(6,g=u.lineJoin),"dashArray"in u&&n(7,h=u.dashArray),"dashOffset"in u&&n(8,d=u.dashOffset),"fill"in u&&n(9,C=u.fill),"fillColor"in u&&n(10,f=u.fillColor),"fillOpacity"in u&&n(11,w=u.fillOpacity),"fillRule"in u&&n(12,T=u.fillRule),"options"in u&&n(13,x=u.options),"events"in u&&n(14,D=u.events),"$$scope"in u&&n(16,e=u.$$scope)},r.$$.update=()=>{r.$$.dirty&32767&&(k||(n(0,k=m.rectangle(s,x).addTo(l())),J=new it(k,H,D)),k.setBounds(s),k.setStyle({color:c,weight:o,opacity:y,lineCap:i,lineJoin:g,dashArray:h,dashOffset:d,fill:C,fillColor:f,fillOpacity:w,fillRule:T}))},[k,s,c,o,y,i,g,h,d,C,f,w,T,x,D,V,e,a]}class Et extends _{constructor(t){super();M(this,t,kt,ht,b,{latLngBounds:1,color:2,weight:3,opacity:4,lineCap:5,lineJoin:6,dashArray:7,dashOffset:8,fill:9,fillColor:10,fillOpacity:11,fillRule:12,options:13,events:14,getRectangle:15})}get getRectangle(){return this.$$.ctx[15]}}function _t(r,t,n){const{getMap:a}=S(m);let{position:e="topright"}=t,{options:l={}}=t,s;O(()=>{s.remove()});function c(){return s}return r.$$set=o=>{"position"in o&&n(0,e=o.position),"options"in o&&n(1,l=o.options)},r.$$.update=()=>{r.$$.dirty&11&&(s||n(3,s=m.control.scale(l).addTo(a())),s.setPosition(e))},[e,l,c,s]}class At extends _{constructor(t){super();M(this,t,_t,null,b,{position:0,options:1,getScaleControl:2})}get getScaleControl(){return this.$$.ctx[2]}}function Mt(r){let t,n,a={icon:'<span class="text-3xl leading-6">&sdotb;</span>',callback:r[3],title:"click to fit all observations on map"};return t=new U({props:a}),r[4](t),{c(){E(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,l){j(t,e,l),n=!0},p(e,[l]){const s={};l&3&&(s.callback=e[3]),t.$set(s)},i(e){n||(L(t.$$.fragment,e),n=!0)},o(e){B(t.$$.fragment,e),n=!1},d(e){r[4](null),R(t,e)}}}function bt(r,t,n){let{coordinates:a}=t,{map:e}=t,l;const s=()=>ct(a,e);function c(o){P[o?"unshift":"push"](()=>{l=o,n(2,l)})}return r.$$set=o=>{"coordinates"in o&&n(0,a=o.coordinates),"map"in o&&n(1,e=o.map)},r.$$.update=()=>{r.$$.dirty&5&&l&&(a.length===0?l.getButton().disable():l.getButton().enable())},[a,e,l,s,c]}class jt extends _{constructor(t){super();M(this,t,bt,Mt,b,{coordinates:0,map:1})}}function Ct(r){let t,n;return t=new yt({props:{baseLayersData:r[1],overlayLayersData:r[0]}}),{c(){E(t.$$.fragment)},l(a){A(t.$$.fragment,a)},m(a,e){j(t,a,e),n=!0},p(a,[e]){const l={};e&2&&(l.baseLayersData=a[1]),e&1&&(l.overlayLayersData=a[0]),t.$set(l)},i(a){n||(L(t.$$.fragment,a),n=!0)},o(a){B(t.$$.fragment,a),n=!1},d(a){R(t,a)}}}function Lt(r,t,n){let{country:a}=t,{project:e}=t,l=ut(),s=[];e&&e.map_layers&&(s=e.map_layers);let c={Street:l.OpenStreetMap,Minimal:l.GBIFGeyser,Terrain:l.StamenTerrain};return a==="USA"&&(c.Satellite=l.USGSImagery),c.None={url:"",options:{}},r.$$set=o=>{"country"in o&&n(2,a=o.country),"project"in o&&n(3,e=o.project)},[s,c,a,e]}class Rt extends _{constructor(t){super();M(this,t,Lt,Ct,b,{country:2,project:3})}}function Bt(r){let t,n,a={states:r[1]};return t=new U({props:a}),r[10](t),{c(){E(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,l){j(t,e,l),n=!0},p(e,[l]){const s={};t.$set(s)},i(e){n||(L(t.$$.fragment,e),n=!0)},o(e){B(t.$$.fragment,e),n=!1},d(e){r[10](null),R(t,e)}}}function St(r,t,n){let{useMarkerCluster:a}=t,{observationsOnMapCount:e}=t,{clusterLimit:l}=t,{userSelectedMarkerType:s}=t,{coordinates:c}=t,{zoomLevel:o}=t,{maxZoom:y}=t;const i=Z();let g,h={states:[{stateName:"show-markers",icon:'<span class="text-4xl font-black leading-5">&Colon;</span>',title:"click to show clustered markers",onClick(f){i("changeMarkerModeOnClick",{useMarkerCluster:!0,userSelectedMarkerType:"clusters"}),f.state("show-clusters")}},{stateName:"show-clusters",icon:'<span class="text-6xl leading-6">&middot;</span>',title:"click to show individual markers",onClick(f){i("changeMarkerModeOnClick",{useMarkerCluster:!1,userSelectedMarkerType:"markers"}),f.state("show-markers")}}]};function d(){return g.getButton()}function C(f){P[f?"unshift":"push"](()=>{g=f,n(0,g)})}return r.$$set=f=>{"useMarkerCluster"in f&&n(2,a=f.useMarkerCluster),"observationsOnMapCount"in f&&n(3,e=f.observationsOnMapCount),"clusterLimit"in f&&n(4,l=f.clusterLimit),"userSelectedMarkerType"in f&&n(5,s=f.userSelectedMarkerType),"coordinates"in f&&n(6,c=f.coordinates),"zoomLevel"in f&&n(7,o=f.zoomLevel),"maxZoom"in f&&n(8,y=f.maxZoom)},r.$$.update=()=>{r.$$.dirty&421&&o&&y&&(a&&o+1>=y?(g.getButton().state("show-markers"),i("changeMarkerModeAutomatic",{useMarkerCluster:!1})):!a&&s==="clusters"&&o===y-2&&(g.getButton().state("show-clusters"),i("changeMarkerModeAutomatic",{useMarkerCluster:!0}))),r.$$.dirty&61&&e>0&&(!a&&e>=l?(g.getButton().state("show-clusters"),i("changeMarkerModeAutomatic",{useMarkerCluster:!0})):a&&s==="markers"&&e<l&&(g.getButton().state("show-markers"),i("changeMarkerModeAutomatic",{useMarkerCluster:!1}))),r.$$.dirty&89&&g&&(c.length===0||e>l?g.getButton().disable():g.getButton().enable())},[g,h,a,e,l,s,c,o,y,d,C]}class Jt extends _{constructor(t){super();M(this,t,St,Bt,b,{useMarkerCluster:2,observationsOnMapCount:3,clusterLimit:4,userSelectedMarkerType:5,coordinates:6,zoomLevel:7,maxZoom:8,getButton:9})}get getButton(){return this.$$.ctx[9]}}export{Rt as M,Et as R,At as S,jt as a,Jt as b,Dt as c};
