import{S as ct,i as ut,s as pt,e as C,t as ee,c as M,a as w,g as te,d as m,b as O,f as v,F as h,Z as mt,J as _t,j as E,l as y,Q as Fe,v as Q,w as G,O as qe,x as K,h as Ie,p as g,n as k,A as W,Y as ht,u as dt,m as he,o as de,a7 as gt,a2 as Ae,k as X,L as Oe}from"./vendor-ac733917.js";import{a as bt}from"./index-0ee43062.js";import{i as Be,r as kt,e as vt,s as St,c as Ct}from"./mapUtils-e9636914.js";import{s as Mt,d as Lt,u as Ot,e as Tt,h as Qe,i as wt,j as Et,m as De}from"./observation_data-90cf8ccf.js";import{t as yt,M as It,e as Dt,b as Vt,f as Ge,g as Ke,h as We}from"./bar_chart-7b26ba54.js";import{M as jt,a as Nt,b as At,S as Bt,c as Yt,R as Zt}from"./map_toggle_marker_type_button-8e34cd5a.js";import{C as Ye}from"./CircleMarker-a705a7f9.js";import"./formatUtils-77b182ad.js";import"./constants-3d7024b8.js";function Xe(t,o,r){const a=t.slice();return a[59]=o[r][0],a[0]=o[r][1],a}function xe(t,o,r){const a=t.slice();return a[51]=o[r],a}function et(t,o,r){const a=t.slice();return a[54]=o[r][0],a[0]=o[r][1],a}function tt(t,o,r){const a=t.slice();return a[51]=o[r],a}function lt(t,o,r){const a=t.slice();return a[51]=o[r],a}function ot(t){let o,r,a,e,u,l;return{c(){o=C("span"),r=ee("*"),this.h()},l(s){o=M(s,"SPAN",{class:!0,title:!0});var n=w(o);r=te(n,"*"),n.forEach(m),this.h()},h(){O(o,"class","text-red-600"),O(o,"title",a="Since there are over "+je+" observations on the map, the map uses clustered markers.")},m(s,n){v(s,o,n),h(o,r),u||(l=mt(e=yt.call(null,o)),u=!0)},p:_t,d(s){s&&m(o),u=!1,l()}}}function $t(t){let o,r,a=[...t[8]],e=[];for(let l=0;l<a.length;l+=1)e[l]=nt(Xe(t,a,l));const u=l=>k(e[l],1,1,()=>{e[l]=null});return{c(){for(let l=0;l<e.length;l+=1)e[l].c();o=X()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);o=X()},m(l,s){for(let n=0;n<e.length;n+=1)e[n].m(l,s);v(l,o,s),r=!0},p(l,s){if(s[0]&536883458){a=[...l[8]];let n;for(n=0;n<a.length;n+=1){const f=Xe(l,a,n);e[n]?(e[n].p(f,s),g(e[n],1)):(e[n]=nt(f),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(he(),n=a.length;n<e.length;n+=1)u(n);de()}},i(l){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(l){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)k(e[s]);r=!1},d(l){Oe(e,l),l&&m(o)}}}function Ut(t){let o,r,a=[...t[8]],e=[];for(let l=0;l<a.length;l+=1)e[l]=at(et(t,a,l));const u=l=>k(e[l],1,1,()=>{e[l]=null});return{c(){for(let l=0;l<e.length;l+=1)e[l].c();o=X()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);o=X()},m(l,s){for(let n=0;n<e.length;n+=1)e[n].m(l,s);v(l,o,s),r=!0},p(l,s){if(s[0]&536871170){a=[...l[8]];let n;for(n=0;n<a.length;n+=1){const f=et(l,a,n);e[n]?(e[n].p(f,s),g(e[n],1)):(e[n]=at(f),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(he(),n=a.length;n<e.length;n+=1)u(n);de()}},i(l){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(l){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)k(e[s]);r=!1},d(l){Oe(e,l),l&&m(o)}}}function Ht(t){let o,r,a=t[8],e=[];for(let l=0;l<a.length;l+=1)e[l]=it(lt(t,a,l));const u=l=>k(e[l],1,1,()=>{e[l]=null});return{c(){for(let l=0;l<e.length;l+=1)e[l].c();o=X()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);o=X()},m(l,s){for(let n=0;n<e.length;n+=1)e[n].m(l,s);v(l,o,s),r=!0},p(l,s){if(s[0]&536871170){a=l[8];let n;for(n=0;n<a.length;n+=1){const f=lt(l,a,n);e[n]?(e[n].p(f,s),g(e[n],1)):(e[n]=it(f),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(he(),n=a.length;n<e.length;n+=1)u(n);de()}},i(l){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(l){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)k(e[s]);r=!1},d(l){Oe(e,l),l&&m(o)}}}function Pt(t){let o,r;return o=new Yt({props:{items:t[8]}}),{c(){Q(o.$$.fragment)},l(a){G(o.$$.fragment,a)},m(a,e){K(o,a,e),r=!0},p(a,e){const u={};e[0]&256&&(u.items=a[8]),o.$set(u)},i(a){r||(g(o.$$.fragment,a),r=!0)},o(a){k(o.$$.fragment,a),r=!1},d(a){W(o,a)}}}function zt(t){let o,r;function a(...e){return t[39](t[51],...e)}return o=new Zt({props:{events:["click"],latLngBounds:[[t[51].latitude-t[12],t[51].longitude-t[13]],[t[51].latitude+t[12],t[51].longitude+t[13]]],color:t[1].colorSchemeMonth[t[59]]||t[1].defaultColor,fillColor:t[1].colorSchemeMonth[t[59]]||t[1].defaultColor}}),o.$on("click",a),{c(){Q(o.$$.fragment)},l(e){G(o.$$.fragment,e)},m(e,u){K(o,e,u),r=!0},p(e,u){t=e;const l={};u[0]&12544&&(l.latLngBounds=[[t[51].latitude-t[12],t[51].longitude-t[13]],[t[51].latitude+t[12],t[51].longitude+t[13]]]),u[0]&258&&(l.color=t[1].colorSchemeMonth[t[59]]||t[1].defaultColor),u[0]&258&&(l.fillColor=t[1].colorSchemeMonth[t[59]]||t[1].defaultColor),o.$set(l)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){k(o.$$.fragment,e),r=!1},d(e){W(o,e)}}}function Jt(t){let o,r;function a(...e){return t[38](t[51],...e)}return o=new Ye({props:{events:["click"],latLng:[t[51].latitude,t[51].longitude],radius:Ze,color:t[1].colorSchemeMonth[t[59]]||t[1].defaultColor,fillColor:t[1].colorSchemeMonth[t[59]]||t[1].defaultColor}}),o.$on("click",a),{c(){Q(o.$$.fragment)},l(e){G(o.$$.fragment,e)},m(e,u){K(o,e,u),r=!0},p(e,u){t=e;const l={};u[0]&256&&(l.latLng=[t[51].latitude,t[51].longitude]),u[0]&258&&(l.color=t[1].colorSchemeMonth[t[59]]||t[1].defaultColor),u[0]&258&&(l.fillColor=t[1].colorSchemeMonth[t[59]]||t[1].defaultColor),o.$set(l)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){k(o.$$.fragment,e),r=!1},d(e){W(o,e)}}}function rt(t){let o,r,a,e,u;const l=[Jt,zt],s=[];function n(f,_){return _[0]&256&&(o=null),o==null&&(o=!!Ct.includes(f[51].month+1)),o?0:1}return r=n(t,[-1,-1,-1]),a=s[r]=l[r](t),{c(){a.c(),e=X()},l(f){a.l(f),e=X()},m(f,_){s[r].m(f,_),v(f,e,_),u=!0},p(f,_){let S=r;r=n(f,_),r===S?s[r].p(f,_):(he(),k(s[S],1,1,()=>{s[S]=null}),de(),a=s[r],a?a.p(f,_):(a=s[r]=l[r](f),a.c()),g(a,1),a.m(e.parentNode,e))},i(f){u||(g(a),u=!0)},o(f){k(a),u=!1},d(f){s[r].d(f),f&&m(e)}}}function nt(t){let o,r,a=t[0],e=[];for(let l=0;l<a.length;l+=1)e[l]=rt(xe(t,a,l));const u=l=>k(e[l],1,1,()=>{e[l]=null});return{c(){for(let l=0;l<e.length;l+=1)e[l].c();o=X()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);o=X()},m(l,s){for(let n=0;n<e.length;n+=1)e[n].m(l,s);v(l,o,s),r=!0},p(l,s){if(s[0]&536883458){a=l[0];let n;for(n=0;n<a.length;n+=1){const f=xe(l,a,n);e[n]?(e[n].p(f,s),g(e[n],1)):(e[n]=rt(f),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(he(),n=a.length;n<e.length;n+=1)u(n);de()}},i(l){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(l){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)k(e[s]);r=!1},d(l){Oe(e,l),l&&m(o)}}}function st(t){let o,r;function a(...e){return t[37](t[51],...e)}return o=new Ye({props:{events:["click"],latLng:[t[51].latitude,t[51].longitude],radius:Ze,color:t[1].colorSchemeYear[De(t[54],t[1].colorSchemeYear.length)]||t[1].defaultColor,fillColor:t[1].colorSchemeYear[De(t[54],t[1].colorSchemeYear.length)]||t[1].defaultColor}}),o.$on("click",a),{c(){Q(o.$$.fragment)},l(e){G(o.$$.fragment,e)},m(e,u){K(o,e,u),r=!0},p(e,u){t=e;const l={};u[0]&256&&(l.latLng=[t[51].latitude,t[51].longitude]),u[0]&258&&(l.color=t[1].colorSchemeYear[De(t[54],t[1].colorSchemeYear.length)]||t[1].defaultColor),u[0]&258&&(l.fillColor=t[1].colorSchemeYear[De(t[54],t[1].colorSchemeYear.length)]||t[1].defaultColor),o.$set(l)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){k(o.$$.fragment,e),r=!1},d(e){W(o,e)}}}function at(t){let o,r,a=t[0],e=[];for(let l=0;l<a.length;l+=1)e[l]=st(tt(t,a,l));const u=l=>k(e[l],1,1,()=>{e[l]=null});return{c(){for(let l=0;l<e.length;l+=1)e[l].c();o=X()},l(l){for(let s=0;s<e.length;s+=1)e[s].l(l);o=X()},m(l,s){for(let n=0;n<e.length;n+=1)e[n].m(l,s);v(l,o,s),r=!0},p(l,s){if(s[0]&536871170){a=l[0];let n;for(n=0;n<a.length;n+=1){const f=tt(l,a,n);e[n]?(e[n].p(f,s),g(e[n],1)):(e[n]=st(f),e[n].c(),g(e[n],1),e[n].m(o.parentNode,o))}for(he(),n=a.length;n<e.length;n+=1)u(n);de()}},i(l){if(!r){for(let s=0;s<a.length;s+=1)g(e[s]);r=!0}},o(l){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)k(e[s]);r=!1},d(l){Oe(e,l),l&&m(o)}}}function it(t){let o,r;function a(...e){return t[36](t[51],...e)}return o=new Ye({props:{events:["click"],latLng:[t[51].latitude,t[51].longitude],radius:Ze,color:t[1].defaultColor,fillColor:t[1].defaultColor}}),o.$on("click",a),{c(){Q(o.$$.fragment)},l(e){G(o.$$.fragment,e)},m(e,u){K(o,e,u),r=!0},p(e,u){t=e;const l={};u[0]&256&&(l.latLng=[t[51].latitude,t[51].longitude]),u[0]&2&&(l.color=t[1].defaultColor),u[0]&2&&(l.fillColor=t[1].defaultColor),o.$set(l)},i(e){r||(g(o.$$.fragment,e),r=!0)},o(e){k(o.$$.fragment,e),r=!1},d(e){W(o,e)}}}function Rt(t){let o,r,a,e,u,l,s,n,f,_,S,x;o=new jt({props:{country:t[2].country}});const J=[Pt,Ht,Ut,$t],V=[];function Y(p,d){return d[0]&256&&(a=null),p[15]?0:(a==null&&(a=!!Array.isArray(p[8])),a?1:p[1].observationsTimeSpan==="year"?2:3)}e=Y(t,[-1,-1,-1]),u=V[e]=J[e](t),s=new Nt({props:{map:t[4],coordinates:t[6]}});let Z={coordinates:t[6],useMarkerCluster:t[15],observationsOnMapCount:t[18],clusterLimit:je,userSelectedMarkerType:t[16],zoomLevel:t[11],maxZoom:t[20]};f=new At({props:Z}),t[40](f),f.$on("changeMarkerModeOnClick",t[25]),f.$on("changeMarkerModeAutomatic",t[26]);let R={position:"bottomleft",options:St};return S=new Bt({props:R}),t[41](S),{c(){Q(o.$$.fragment),r=E(),u.c(),l=E(),Q(s.$$.fragment),n=E(),Q(f.$$.fragment),_=E(),Q(S.$$.fragment)},l(p){G(o.$$.fragment,p),r=y(p),u.l(p),l=y(p),G(s.$$.fragment,p),n=y(p),G(f.$$.fragment,p),_=y(p),G(S.$$.fragment,p)},m(p,d){K(o,p,d),v(p,r,d),V[e].m(p,d),v(p,l,d),K(s,p,d),v(p,n,d),K(f,p,d),v(p,_,d),K(S,p,d),x=!0},p(p,d){const H={};d[0]&4&&(H.country=p[2].country),o.$set(H);let P=e;e=Y(p,d),e===P?V[e].p(p,d):(he(),k(V[P],1,1,()=>{V[P]=null}),de(),u=V[e],u?u.p(p,d):(u=V[e]=J[e](p),u.c()),g(u,1),u.m(l.parentNode,l));const le={};d[0]&16&&(le.map=p[4]),d[0]&64&&(le.coordinates=p[6]),s.$set(le);const T={};d[0]&64&&(T.coordinates=p[6]),d[0]&32768&&(T.useMarkerCluster=p[15]),d[0]&262144&&(T.observationsOnMapCount=p[18]),d[0]&65536&&(T.userSelectedMarkerType=p[16]),d[0]&2048&&(T.zoomLevel=p[11]),d[0]&1048576&&(T.maxZoom=p[20]),f.$set(T);const $={};S.$set($)},i(p){x||(g(o.$$.fragment,p),g(u),g(s.$$.fragment,p),g(f.$$.fragment,p),g(S.$$.fragment,p),x=!0)},o(p){k(o.$$.fragment,p),k(u),k(s.$$.fragment,p),k(f.$$.fragment,p),k(S.$$.fragment,p),x=!1},d(p){W(o,p),p&&m(r),V[e].d(p),p&&m(l),W(s,p),p&&m(n),t[40](null),W(f,p),p&&m(_),t[41](null),W(S,p)}}}function ft(t){let o,r,a,e,u,l,s;return{c(){o=C("label"),r=C("input"),a=E(),e=C("span"),u=ee("Show species list"),this.h()},l(n){o=M(n,"LABEL",{class:!0});var f=w(o);r=M(f,"INPUT",{type:!0}),a=y(f),e=M(f,"SPAN",{});var _=w(e);u=te(_,"Show species list"),_.forEach(m),f.forEach(m),this.h()},h(){O(r,"type","checkbox"),O(o,"class","cursor-pointer mt-2 inline-block")},m(n,f){v(n,o,f),h(o,r),r.checked=t[23],h(o,a),h(o,e),h(e,u),l||(s=Fe(r,"change",t[44]),l=!0)},p(n,f){f[0]&8388608&&(r.checked=n[23])},d(n){n&&m(o),l=!1,s()}}}function Ft(t){let o,r,a,e,u,l,s,n,f,_,S,x,J,V,Y,Z,R,p,d,H,P,le,T,$,A,ge,ne,se,pe,F,q,ce,j,oe,ae,me,Ce,ue,ie,be,ke,U,ve,B,Se,fe,re,Me,Te,I=t[18]>=je&&ot(),Ne={options:t[1],$$slots:{default:[Rt]},$$scope:{ctx:t}};q=new bt({props:Ne}),t[42](q);let D=t[24]&&ft(t);return U=new It({props:{showSpeciesList:t[23],speciesList:t[9]}}),B=new Dt({props:{mapOptions:t[1],selectTimeSpanHandler:t[28],groupedObservations:t[7],toggleTimeSpans:t[27],timeSpanHistory:t[5],activeTaxaCount:1}}),{c(){o=C("div"),r=C("div"),a=C("div"),e=ee("Observations"),u=E(),l=C("div"),s=ee(t[19]),n=E(),f=C("div"),_=C("div"),S=ee(`Observations on map
      `),I&&I.c(),x=E(),J=C("div"),V=ee(t[18]),Y=E(),Z=C("div"),R=C("div"),p=ee("Species"),d=E(),H=C("div"),P=ee(t[21]),le=E(),T=C("div"),$=C("div"),A=ee("Species on map"),ge=E(),ne=C("div"),se=ee(t[22]),pe=E(),F=C("div"),Q(q.$$.fragment),ce=E(),j=C("label"),oe=C("input"),ae=E(),me=C("span"),Ce=ee("Update charts as map changes"),ue=E(),D&&D.c(),ie=E(),be=C("br"),ke=E(),Q(U.$$.fragment),ve=E(),Q(B.$$.fragment),Se=E(),fe=C("div"),this.h()},l(c){o=M(c,"DIV",{class:!0});var i=w(o);r=M(i,"DIV",{class:!0});var b=w(r);a=M(b,"DIV",{class:!0});var N=w(a);e=te(N,"Observations"),N.forEach(m),u=y(b),l=M(b,"DIV",{class:!0});var z=w(l);s=te(z,t[19]),z.forEach(m),b.forEach(m),n=y(i),f=M(i,"DIV",{class:!0});var _e=w(f);_=M(_e,"DIV",{class:!0});var Le=w(_);S=te(Le,`Observations on map
      `),I&&I.l(Le),Le.forEach(m),x=y(_e),J=M(_e,"DIV",{class:!0});var $e=w(J);V=te($e,t[18]),$e.forEach(m),_e.forEach(m),Y=y(i),Z=M(i,"DIV",{class:!0});var we=w(Z);R=M(we,"DIV",{class:!0});var Ue=w(R);p=te(Ue,"Species"),Ue.forEach(m),d=y(we),H=M(we,"DIV",{class:!0});var He=w(H);P=te(He,t[21]),He.forEach(m),we.forEach(m),le=y(i),T=M(i,"DIV",{class:!0});var Ee=w(T);$=M(Ee,"DIV",{class:!0});var Pe=w($);A=te(Pe,"Species on map"),Pe.forEach(m),ge=y(Ee),ne=M(Ee,"DIV",{class:!0});var ze=w(ne);se=te(ze,t[22]),ze.forEach(m),Ee.forEach(m),i.forEach(m),pe=y(c),F=M(c,"DIV",{id:!0,style:!0});var Je=w(F);G(q.$$.fragment,Je),Je.forEach(m),ce=y(c),j=M(c,"LABEL",{class:!0});var ye=w(j);oe=M(ye,"INPUT",{type:!0}),ae=y(ye),me=M(ye,"SPAN",{});var Re=w(me);Ce=te(Re,"Update charts as map changes"),Re.forEach(m),ye.forEach(m),ue=y(c),D&&D.l(c),ie=y(c),be=M(c,"BR",{}),ke=y(c),G(U.$$.fragment,c),ve=y(c),G(B.$$.fragment,c),Se=y(c),fe=M(c,"DIV",{id:!0,class:!0}),w(fe).forEach(m),this.h()},h(){O(a,"class","stat-title svelte-oe1iet"),O(l,"class","stat-value svelte-oe1iet"),O(r,"class","stat place-items-center place-content-center svelte-oe1iet"),O(_,"class","stat-title svelte-oe1iet"),O(J,"class","stat-value svelte-oe1iet"),O(f,"class","stat place-items-center place-content-center svelte-oe1iet"),O(R,"class","stat-title svelte-oe1iet"),O(H,"class","stat-value svelte-oe1iet"),O(Z,"class","stat place-items-center place-content-center svelte-oe1iet"),O($,"class","stat-title svelte-oe1iet"),O(ne,"class","stat-value svelte-oe1iet"),O(T,"class","stat place-items-center place-content-center svelte-oe1iet"),O(o,"class","w-full rounded-none border stats"),O(F,"id","taxa-map"),qe(F,"width","100%"),qe(F,"height","400px"),O(oe,"type","checkbox"),O(j,"class","cursor-pointer mt-2 mr-3 inline-block"),O(fe,"id","observations-chart"),O(fe,"class","w-full mt-4")},m(c,i){v(c,o,i),h(o,r),h(r,a),h(a,e),h(r,u),h(r,l),h(l,s),h(o,n),h(o,f),h(f,_),h(_,S),I&&I.m(_,null),h(f,x),h(f,J),h(J,V),h(o,Y),h(o,Z),h(Z,R),h(R,p),h(Z,d),h(Z,H),h(H,P),h(o,le),h(o,T),h(T,$),h($,A),h(T,ge),h(T,ne),h(ne,se),v(c,pe,i),v(c,F,i),K(q,F,null),v(c,ce,i),v(c,j,i),h(j,oe),oe.checked=t[10],h(j,ae),h(j,me),h(me,Ce),v(c,ue,i),D&&D.m(c,i),v(c,ie,i),v(c,be,i),v(c,ke,i),K(U,c,i),v(c,ve,i),K(B,c,i),v(c,Se,i),v(c,fe,i),re=!0,Me||(Te=Fe(oe,"change",t[43]),Me=!0)},p(c,i){(!re||i[0]&524288)&&Ie(s,c[19]),c[18]>=je?I?I.p(c,i):(I=ot(),I.c(),I.m(_,null)):I&&(I.d(1),I=null),(!re||i[0]&262144)&&Ie(V,c[18]),(!re||i[0]&2097152)&&Ie(P,c[21]),(!re||i[0]&4194304)&&Ie(se,c[22]);const b={};i[0]&2&&(b.options=c[1]),i[0]&1571158|i[2]&4&&(b.$$scope={dirty:i,ctx:c}),q.$set(b),i[0]&1024&&(oe.checked=c[10]),c[24]?D?D.p(c,i):(D=ft(c),D.c(),D.m(ie.parentNode,ie)):D&&(D.d(1),D=null);const N={};i[0]&8388608&&(N.showSpeciesList=c[23]),i[0]&512&&(N.speciesList=c[9]),U.$set(N);const z={};i[0]&2&&(z.mapOptions=c[1]),i[0]&128&&(z.groupedObservations=c[7]),i[0]&32&&(z.timeSpanHistory=c[5]),B.$set(z)},i(c){re||(g(q.$$.fragment,c),g(U.$$.fragment,c),g(B.$$.fragment,c),re=!0)},o(c){k(q.$$.fragment,c),k(U.$$.fragment,c),k(B.$$.fragment,c),re=!1},d(c){c&&m(o),I&&I.d(),c&&m(pe),c&&m(F),t[42](null),W(q),c&&m(ce),c&&m(j),c&&m(ue),D&&D.d(c),c&&m(ie),c&&m(be),c&&m(ke),W(U,c),c&&m(ve),W(B,c),c&&m(Se),c&&m(fe),Me=!1,Te()}}}let Ze=8,qt="oldest",Ve=.25,je=1e3;function Qt(t,o,r){let{observations:a}=o,{mapOptions:e}=o,{mapCenter:u}=o,{project:l}=o,{taxon:s}=o,n,f,_={},S=0,x=1,J=1,V=[],Y=[],Z=[];const R=ht();let p=!1,d=JSON.parse(JSON.stringify(Vt)),H,P=!1,le="markers",T,$=[],A=[],ge=0,ne=0,se=!1,pe=0,F=0,q=0,ce=!1,j=[],oe=!1,ae=!1;function me(i){r(15,P=i.detail.useMarkerCluster),r(16,le=i.detail.userSelectedMarkerType),r(8,A=ue(A))}function Ce(i){r(15,P=i.detail.useMarkerCluster),r(8,A=ue(A))}function ue(i){let b;if(Array.isArray(i))b=i.filter(N=>Be(N,f,L));else if(P){let N=[];i.forEach((z,_e)=>{z=z.filter(Le=>Be(Le,f,L)),N=N.concat(z)}),b=N}else b=new Map,i.forEach((N,z)=>{N=N.filter(_e=>Be(_e,f,L)),b.set(z,N)});return b}function ie(i){r(12,x=kt(i)),r(13,J=vt(i))}function be(i){r(5,_=Ot(i,_))}function ke(){r(5,_={})}function U(i,b){R("markerClick",{observation_id:b.id,latlng:i.detail.latlng})}function ve(i){i.length>0&&f.fitBounds(i),R("doneLoading")}function B(i){gt("#observations-chart",i,{actions:!1}).then(b=>{}).catch(console.warn)}dt(()=>{r(33,p=!0),r(4,f=n.getMap()),r(11,S=f.getZoom()),r(20,pe=f.getMaxZoom()),ie(S),f.on("zoomend",function(){r(11,S=f.getZoom()),r(35,se=!0),ie(S)}),f.on("moveend",function(){r(35,se=!0)})});const Se=(i,b)=>U(b,i),fe=(i,b)=>U(b,i),re=(i,b)=>U(b,i),Me=(i,b)=>U(b,i);function Te(i){Ae[i?"unshift":"push"](()=>{T=i,r(17,T)})}function I(i){Ae[i?"unshift":"push"](()=>{H=i,r(14,H)})}function Ne(i){Ae[i?"unshift":"push"](()=>{n=i,r(3,n)})}function D(){ae=this.checked,r(10,ae)}function c(){ce=this.checked,r(23,ce)}return t.$$set=i=>{"observations"in i&&r(0,a=i.observations),"mapOptions"in i&&r(1,e=i.mapOptions),"mapCenter"in i&&r(30,u=i.mapCenter),"project"in i&&r(2,l=i.project),"taxon"in i&&r(31,s=i.taxon)},t.$$.update=()=>{if(t.$$.dirty[0]&1&&(r(0,a=a.filter(i=>i.latitude&&i.longitude)),r(6,V=a.map(i=>[i.latitude,i.longitude])),r(5,_={})),t.$$.dirty[0]&163|t.$$.dirty[1]&2&&(r(32,Z=Mt(a,qt,e.observationsTimeSpan)),r(7,Y=Lt(Z,e.observationsTimeSpan)),e.observationsTimeSpan!=="all"&&Object.keys(_).length===0&&Y.forEach((i,b)=>r(5,_[b]=!0,_))),t.$$.dirty[0]&72&&n&&ve(V),t.$$.dirty[0]&936|t.$$.dirty[1]&25&&n&&(r(34,$=Tt(Y,_)),r(19,ne=Qe($)),r(8,A=ue($)),r(18,ge=Qe(A)),r(21,F=wt($)),r(9,j=Et(A)),r(22,q=j.length),r(24,oe=j.length>1||j.length==1&&j[0].taxon_id!==s.taxon_id),r(35,se=!1)),t.$$.dirty[0]&1190|t.$$.dirty[1]&4&&p&&!ae){if(e.observationsTimeSpan==="month"){let i=Ge(d,Ve,_,e,Y,l);B(i)}else if(e.observationsTimeSpan==="year"){let i=Ke(d,Ve,_,e,Y,l);B(i)}else if(e.observationsTimeSpan==="all"){let i=We(d,e,Y);B(i)}}if(t.$$.dirty[0]&1318|t.$$.dirty[1]&4&&p&&ae){if(e.observationsTimeSpan==="month"){let i=Ge(d,Ve,_,e,A,l);B(i)}else if(e.observationsTimeSpan==="year"){let i=Ke(d,Ve,_,e,A,l);B(i)}else if(e.observationsTimeSpan==="all"){let i=We(d,e,A);B(i)}}t.$$.dirty[0]&1073741848&&n&&u&&u.longitude&&(document.getElementById("taxa-map").scrollIntoView(),f.flyTo([u.latitude,u.longitude],f.getMaxZoom()-1),r(30,u={}))},[a,e,l,n,f,_,V,Y,A,j,ae,S,x,J,H,P,le,T,ge,ne,pe,F,q,ce,oe,me,Ce,be,ke,U,u,s,Z,p,$,se,Se,fe,re,Me,Te,I,Ne,D,c]}class rl extends ct{constructor(o){super();ut(this,o,Qt,Ft,pt,{observations:0,mapOptions:1,mapCenter:30,project:2,taxon:31},null,[-1,-1,-1])}}export{rl as default};
