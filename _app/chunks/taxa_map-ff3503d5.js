import{S as pt,i as _t,s as ht,e as w,t as ie,c as T,a as y,g as fe,d as p,b as O,f as C,E as k,Y as Ne,I as Ae,l as P,r as pe,u as b,w as _e,x as d,k as I,j as U,n as D,m as H,N as Ke,o as z,P as Be,h as $e,v as J,X as dt,A as gt,U as Xe,a6 as kt,a1 as Ye,K as Oe}from"./vendor-a1a75673.js";import{a as bt}from"./index-362d2c56.js";import{i as Ze,r as vt,e as St,s as Ct,c as Mt}from"./mapUtils-e9636914.js";import{s as Lt,d as Ot,u as wt,e as Tt,h as Ge,i as Et,j as yt,m as Ie}from"./observation_data-2b3f5cba.js";import{t as Pe,M as $t,e as It,b as Dt,f as Qe,g as We,h as xe,I as et}from"./bar_chart-b6332b1b.js";import{M as Vt,a as jt,b as Nt,S as At,c as Bt,R as Yt}from"./map_toggle_marker_type_button-08db13d1.js";import{C as Ue}from"./CircleMarker-7510bcf0.js";import"./formatUtils-77b182ad.js";import"./constants-3d7024b8.js";function tt(l,o,r){const a=l.slice();return a[59]=o[r][0],a[0]=o[r][1],a}function lt(l,o,r){const a=l.slice();return a[51]=o[r],a}function ot(l,o,r){const a=l.slice();return a[54]=o[r][0],a[0]=o[r][1],a}function rt(l,o,r){const a=l.slice();return a[51]=o[r],a}function nt(l,o,r){const a=l.slice();return a[51]=o[r],a}function st(l){let o,r,a,e,i,t;return{c(){o=w("span"),r=ie("*"),this.h()},l(s){o=T(s,"SPAN",{class:!0,title:!0});var n=y(o);r=fe(n,"*"),n.forEach(p),this.h()},h(){O(o,"class","text-red-600"),O(o,"title",a="Since there are over "+Ve+" observations on the map, the map uses clustered markers.")},m(s,n){C(s,o,n),k(o,r),i||(t=Ne(e=Pe.call(null,o)),i=!0)},p:Ae,d(s){s&&p(o),i=!1,t()}}}function at(l){let o,r,a,e;const i=[Pt,Zt],t=[];function s(n,c){return n[23]?0:1}return o=s(l),r=t[o]=i[o](l),{c(){r.c(),a=P()},l(n){r.l(n),a=P()},m(n,c){t[o].m(n,c),C(n,a,c),e=!0},p(n,c){let _=o;o=s(n),o===_?t[o].p(n,c):(pe(),b(t[_],1,1,()=>{t[_]=null}),_e(),r=t[o],r?r.p(n,c):(r=t[o]=i[o](n),r.c()),d(r,1),r.m(a.parentNode,a))},i(n){e||(d(r),e=!0)},o(n){b(r),e=!1},d(n){t[o].d(n),n&&p(a)}}}function Zt(l){let o,r,a,e,i;return r=new et({}),{c(){o=w("span"),U(r.$$.fragment),this.h()},l(t){o=T(t,"SPAN",{title:!0});var s=y(o);H(r.$$.fragment,s),s.forEach(p),this.h()},h(){O(o,"title","click show to species list")},m(t,s){C(t,o,s),z(r,o,null),a=!0,e||(i=[Ne(Pe.call(null,o)),Be(o,"click",l[27])],e=!0)},p:Ae,i(t){a||(d(r.$$.fragment,t),a=!0)},o(t){b(r.$$.fragment,t),a=!1},d(t){t&&p(o),J(r),e=!1,Xe(i)}}}function Pt(l){let o,r,a,e,i;return r=new et({}),{c(){o=w("span"),U(r.$$.fragment),this.h()},l(t){o=T(t,"SPAN",{title:!0});var s=y(o);H(r.$$.fragment,s),s.forEach(p),this.h()},h(){O(o,"title","click hide to species list")},m(t,s){C(t,o,s),z(r,o,null),a=!0,e||(i=[Ne(Pe.call(null,o)),Be(o,"click",l[27])],e=!0)},p:Ae,i(t){a||(d(r.$$.fragment,t),a=!0)},o(t){b(r.$$.fragment,t),a=!1},d(t){t&&p(o),J(r),e=!1,Xe(i)}}}function Ut(l){let o,r,a=[...l[8]],e=[];for(let t=0;t<a.length;t+=1)e[t]=ft(tt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=P()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=P()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073754370){a=[...t[8]];let n;for(n=0;n<a.length;n+=1){const c=tt(t,a,n);e[n]?(e[n].p(c,s),d(e[n],1)):(e[n]=ft(c),e[n].c(),d(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)d(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function Ht(l){let o,r,a=[...l[8]],e=[];for(let t=0;t<a.length;t+=1)e[t]=ut(ot(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=P()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=P()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=[...t[8]];let n;for(n=0;n<a.length;n+=1){const c=ot(t,a,n);e[n]?(e[n].p(c,s),d(e[n],1)):(e[n]=ut(c),e[n].c(),d(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)d(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function zt(l){let o,r,a=l[8],e=[];for(let t=0;t<a.length;t+=1)e[t]=mt(nt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=P()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=P()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=t[8];let n;for(n=0;n<a.length;n+=1){const c=nt(t,a,n);e[n]?(e[n].p(c,s),d(e[n],1)):(e[n]=mt(c),e[n].c(),d(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)d(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function Jt(l){let o,r;return o=new Bt({props:{items:l[8]}}),{c(){U(o.$$.fragment)},l(a){H(o.$$.fragment,a)},m(a,e){z(o,a,e),r=!0},p(a,e){const i={};e[0]&256&&(i.items=a[8]),o.$set(i)},i(a){r||(d(o.$$.fragment,a),r=!0)},o(a){b(o.$$.fragment,a),r=!1},d(a){J(o,a)}}}function Rt(l){let o,r;function a(...e){return l[40](l[51],...e)}return o=new Yt({props:{events:["click"],latLngBounds:[[l[51].latitude-l[12],l[51].longitude-l[13]],[l[51].latitude+l[12],l[51].longitude+l[13]]],color:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor,fillColor:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor}}),o.$on("click",a),{c(){U(o.$$.fragment)},l(e){H(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&12544&&(t.latLngBounds=[[l[51].latitude-l[12],l[51].longitude-l[13]],[l[51].latitude+l[12],l[51].longitude+l[13]]]),i[0]&258&&(t.color=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),o.$set(t)},i(e){r||(d(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function qt(l){let o,r;function a(...e){return l[39](l[51],...e)}return o=new Ue({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:He,color:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor,fillColor:l[1].colorSchemeMonth[l[59]]||l[1].defaultColor}}),o.$on("click",a),{c(){U(o.$$.fragment)},l(e){H(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&258&&(t.color=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeMonth[l[59]]||l[1].defaultColor),o.$set(t)},i(e){r||(d(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function it(l){let o,r,a,e,i;const t=[qt,Rt],s=[];function n(c,_){return(o==null||_[0]&256)&&(o=!!Mt.includes(c[51].month+1)),o?0:1}return r=n(l,[-1,-1,-1]),a=s[r]=t[r](l),{c(){a.c(),e=P()},l(c){a.l(c),e=P()},m(c,_){s[r].m(c,_),C(c,e,_),i=!0},p(c,_){let S=r;r=n(c,_),r===S?s[r].p(c,_):(pe(),b(s[S],1,1,()=>{s[S]=null}),_e(),a=s[r],a?a.p(c,_):(a=s[r]=t[r](c),a.c()),d(a,1),a.m(e.parentNode,e))},i(c){i||(d(a),i=!0)},o(c){b(a),i=!1},d(c){s[r].d(c),c&&p(e)}}}function ft(l){let o,r,a=l[0],e=[];for(let t=0;t<a.length;t+=1)e[t]=it(lt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=P()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=P()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073754370){a=t[0];let n;for(n=0;n<a.length;n+=1){const c=lt(t,a,n);e[n]?(e[n].p(c,s),d(e[n],1)):(e[n]=it(c),e[n].c(),d(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)d(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function ct(l){let o,r;function a(...e){return l[38](l[51],...e)}return o=new Ue({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:He,color:l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor,fillColor:l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor}}),o.$on("click",a),{c(){U(o.$$.fragment)},l(e){H(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&258&&(t.color=l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor),i[0]&258&&(t.fillColor=l[1].colorSchemeYear[Ie(l[54],l[1].colorSchemeYear.length)]||l[1].defaultColor),o.$set(t)},i(e){r||(d(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function ut(l){let o,r,a=l[0],e=[];for(let t=0;t<a.length;t+=1)e[t]=ct(rt(l,a,t));const i=t=>b(e[t],1,1,()=>{e[t]=null});return{c(){for(let t=0;t<e.length;t+=1)e[t].c();o=P()},l(t){for(let s=0;s<e.length;s+=1)e[s].l(t);o=P()},m(t,s){for(let n=0;n<e.length;n+=1)e[n].m(t,s);C(t,o,s),r=!0},p(t,s){if(s[0]&1073742082){a=t[0];let n;for(n=0;n<a.length;n+=1){const c=rt(t,a,n);e[n]?(e[n].p(c,s),d(e[n],1)):(e[n]=ct(c),e[n].c(),d(e[n],1),e[n].m(o.parentNode,o))}for(pe(),n=a.length;n<e.length;n+=1)i(n);_e()}},i(t){if(!r){for(let s=0;s<a.length;s+=1)d(e[s]);r=!0}},o(t){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)b(e[s]);r=!1},d(t){Oe(e,t),t&&p(o)}}}function mt(l){let o,r;function a(...e){return l[37](l[51],...e)}return o=new Ue({props:{events:["click"],latLng:[l[51].latitude,l[51].longitude],radius:He,color:l[1].defaultColor,fillColor:l[1].defaultColor}}),o.$on("click",a),{c(){U(o.$$.fragment)},l(e){H(o.$$.fragment,e)},m(e,i){z(o,e,i),r=!0},p(e,i){l=e;const t={};i[0]&256&&(t.latLng=[l[51].latitude,l[51].longitude]),i[0]&2&&(t.color=l[1].defaultColor),i[0]&2&&(t.fillColor=l[1].defaultColor),o.$set(t)},i(e){r||(d(o.$$.fragment,e),r=!0)},o(e){b(o.$$.fragment,e),r=!1},d(e){J(o,e)}}}function Ft(l){let o,r,a,e,i,t,s,n,c,_,S,x;o=new Vt({props:{country:l[2].country}});const X=[Jt,zt,Ht,Ut],V=[];function A(u,g){return u[15]?0:((a==null||g[0]&256)&&(a=!!Array.isArray(u[8])),a?1:u[1].observationsTimeSpan==="year"?2:3)}e=A(l,[-1,-1,-1]),i=V[e]=X[e](l),s=new jt({props:{map:l[4],coordinates:l[6]}});let B={coordinates:l[6],useMarkerCluster:l[15],observationsOnMapCount:l[18],clusterLimit:Ve,userSelectedMarkerType:l[16],zoomLevel:l[11],maxZoom:l[20]};c=new Nt({props:B}),l[41](c),c.$on("changeMarkerModeOnClick",l[25]),c.$on("changeMarkerModeAutomatic",l[26]);let G={position:"bottomleft",options:Ct};return S=new At({props:G}),l[42](S),{c(){U(o.$$.fragment),r=I(),i.c(),t=I(),U(s.$$.fragment),n=I(),U(c.$$.fragment),_=I(),U(S.$$.fragment)},l(u){H(o.$$.fragment,u),r=D(u),i.l(u),t=D(u),H(s.$$.fragment,u),n=D(u),H(c.$$.fragment,u),_=D(u),H(S.$$.fragment,u)},m(u,g){z(o,u,g),C(u,r,g),V[e].m(u,g),C(u,t,g),z(s,u,g),C(u,n,g),z(c,u,g),C(u,_,g),z(S,u,g),x=!0},p(u,g){const R={};g[0]&4&&(R.country=u[2].country),o.$set(R);let q=e;e=A(u,g),e===q?V[e].p(u,g):(pe(),b(V[q],1,1,()=>{V[q]=null}),_e(),i=V[e],i?i.p(u,g):(i=V[e]=X[e](u),i.c()),d(i,1),i.m(t.parentNode,t));const le={};g[0]&16&&(le.map=u[4]),g[0]&64&&(le.coordinates=u[6]),s.$set(le);const E={};g[0]&64&&(E.coordinates=u[6]),g[0]&32768&&(E.useMarkerCluster=u[15]),g[0]&262144&&(E.observationsOnMapCount=u[18]),g[0]&65536&&(E.userSelectedMarkerType=u[16]),g[0]&2048&&(E.zoomLevel=u[11]),g[0]&1048576&&(E.maxZoom=u[20]),c.$set(E);const Y={};S.$set(Y)},i(u){x||(d(o.$$.fragment,u),d(i),d(s.$$.fragment,u),d(c.$$.fragment,u),d(S.$$.fragment,u),x=!0)},o(u){b(o.$$.fragment,u),b(i),b(s.$$.fragment,u),b(c.$$.fragment,u),b(S.$$.fragment,u),x=!1},d(u){J(o,u),u&&p(r),V[e].d(u),u&&p(t),J(s,u),u&&p(n),l[41](null),J(c,u),u&&p(_),l[42](null),J(S,u)}}}function Kt(l){let o,r,a,e,i,t,s,n,c,_,S,x,X,V,A,B,G,u,g,R,q,le,E,Y,j,ge,Q,ce,ke,he,W,F,ee,te,oe,re,be,K,ne,Se,de,Ce,se,ue,N,Me,we,$=l[18]>=Ve&&st(),M=l[24]&&at(l),je={options:l[1],$$slots:{default:[Ft]},$$scope:{ctx:l}};return F=new bt({props:je}),l[43](F),te=new $t({props:{showSpeciesList:l[23],speciesList:l[9]}}),re=new It({props:{mapOptions:l[1],selectTimeSpanHandler:l[29],groupedObservations:l[7],toggleTimeSpans:l[28],timeSpanHistory:l[5],activeTaxaCount:1}}),{c(){o=w("div"),r=w("div"),a=w("div"),e=ie("Observations"),i=I(),t=w("div"),s=ie(l[19]),n=I(),c=w("div"),_=w("div"),S=ie(`Observations on map
      `),$&&$.c(),x=I(),X=w("div"),V=ie(l[18]),A=I(),B=w("div"),G=w("div"),u=ie("Species"),g=I(),R=w("div"),q=ie(l[21]),le=I(),E=w("div"),Y=w("div"),j=ie("Species on map"),ge=I(),Q=w("div"),ce=ie(l[22]),ke=I(),M&&M.c(),he=I(),W=w("div"),U(F.$$.fragment),ee=I(),U(te.$$.fragment),oe=I(),U(re.$$.fragment),be=I(),K=w("label"),ne=w("input"),Se=I(),de=w("span"),Ce=ie("Update charts as map changes"),se=I(),ue=w("div"),this.h()},l(m){o=T(m,"DIV",{class:!0});var h=y(o);r=T(h,"DIV",{class:!0});var ae=y(r);a=T(ae,"DIV",{class:!0});var f=y(a);e=fe(f,"Observations"),f.forEach(p),i=D(ae),t=T(ae,"DIV",{class:!0});var v=y(t);s=fe(v,l[19]),v.forEach(p),ae.forEach(p),n=D(h),c=T(h,"DIV",{class:!0});var Z=y(c);_=T(Z,"DIV",{class:!0});var me=y(_);S=fe(me,`Observations on map
      `),$&&$.l(me),me.forEach(p),x=D(Z),X=T(Z,"DIV",{class:!0});var Le=y(X);V=fe(Le,l[18]),Le.forEach(p),Z.forEach(p),A=D(h),B=T(h,"DIV",{class:!0});var ve=y(B);G=T(ve,"DIV",{class:!0});var ze=y(G);u=fe(ze,"Species"),ze.forEach(p),g=D(ve),R=T(ve,"DIV",{class:!0});var Je=y(R);q=fe(Je,l[21]),Je.forEach(p),ve.forEach(p),le=D(h),E=T(h,"DIV",{class:!0});var Te=y(E);Y=T(Te,"DIV",{class:!0});var Re=y(Y);j=fe(Re,"Species on map"),Re.forEach(p),ge=D(Te),Q=T(Te,"DIV",{class:!0});var Ee=y(Q);ce=fe(Ee,l[22]),ke=D(Ee),M&&M.l(Ee),Ee.forEach(p),Te.forEach(p),h.forEach(p),he=D(m),W=T(m,"DIV",{id:!0,style:!0});var qe=y(W);H(F.$$.fragment,qe),qe.forEach(p),ee=D(m),H(te.$$.fragment,m),oe=D(m),H(re.$$.fragment,m),be=D(m),K=T(m,"LABEL",{class:!0});var ye=y(K);ne=T(ye,"INPUT",{type:!0}),Se=D(ye),de=T(ye,"SPAN",{});var Fe=y(de);Ce=fe(Fe,"Update charts as map changes"),Fe.forEach(p),ye.forEach(p),se=D(m),ue=T(m,"DIV",{id:!0,class:!0}),y(ue).forEach(p),this.h()},h(){O(a,"class","stat-title svelte-2kul5f"),O(t,"class","stat-value svelte-2kul5f"),O(r,"class","stat place-items-center place-content-center svelte-2kul5f"),O(_,"class","stat-title svelte-2kul5f"),O(X,"class","stat-value svelte-2kul5f"),O(c,"class","stat place-items-center place-content-center svelte-2kul5f"),O(G,"class","stat-title svelte-2kul5f"),O(R,"class","stat-value svelte-2kul5f"),O(B,"class","stat place-items-center place-content-center svelte-2kul5f"),O(Y,"class","stat-title svelte-2kul5f"),O(Q,"class","stat-value svelte-2kul5f"),O(E,"class","stat place-items-center place-content-center svelte-2kul5f"),O(o,"class","w-full rounded-none border stats"),O(W,"id","taxa-map"),Ke(W,"width","100%"),Ke(W,"height","400px"),O(ne,"type","checkbox"),O(K,"class","cursor-pointer mt-2 inline-block"),O(ue,"id","observations-chart"),O(ue,"class","w-full mt-4")},m(m,h){C(m,o,h),k(o,r),k(r,a),k(a,e),k(r,i),k(r,t),k(t,s),k(o,n),k(o,c),k(c,_),k(_,S),$&&$.m(_,null),k(c,x),k(c,X),k(X,V),k(o,A),k(o,B),k(B,G),k(G,u),k(B,g),k(B,R),k(R,q),k(o,le),k(o,E),k(E,Y),k(Y,j),k(E,ge),k(E,Q),k(Q,ce),k(Q,ke),M&&M.m(Q,null),C(m,he,h),C(m,W,h),z(F,W,null),C(m,ee,h),z(te,m,h),C(m,oe,h),z(re,m,h),C(m,be,h),C(m,K,h),k(K,ne),ne.checked=l[10],k(K,Se),k(K,de),k(de,Ce),C(m,se,h),C(m,ue,h),N=!0,Me||(we=Be(ne,"change",l[44]),Me=!0)},p(m,h){(!N||h[0]&524288)&&$e(s,m[19]),m[18]>=Ve?$?$.p(m,h):($=st(),$.c(),$.m(_,null)):$&&($.d(1),$=null),(!N||h[0]&262144)&&$e(V,m[18]),(!N||h[0]&2097152)&&$e(q,m[21]),(!N||h[0]&4194304)&&$e(ce,m[22]),m[24]?M?(M.p(m,h),h[0]&16777216&&d(M,1)):(M=at(m),M.c(),d(M,1),M.m(Q,null)):M&&(pe(),b(M,1,1,()=>{M=null}),_e());const ae={};h[0]&2&&(ae.options=m[1]),h[0]&1571158|h[2]&4&&(ae.$$scope={dirty:h,ctx:m}),F.$set(ae);const f={};h[0]&8388608&&(f.showSpeciesList=m[23]),h[0]&512&&(f.speciesList=m[9]),te.$set(f);const v={};h[0]&2&&(v.mapOptions=m[1]),h[0]&128&&(v.groupedObservations=m[7]),h[0]&32&&(v.timeSpanHistory=m[5]),re.$set(v),h[0]&1024&&(ne.checked=m[10])},i(m){N||(d(M),d(F.$$.fragment,m),d(te.$$.fragment,m),d(re.$$.fragment,m),N=!0)},o(m){b(M),b(F.$$.fragment,m),b(te.$$.fragment,m),b(re.$$.fragment,m),N=!1},d(m){m&&p(o),$&&$.d(),M&&M.d(),m&&p(he),m&&p(W),l[43](null),J(F),m&&p(ee),J(te,m),m&&p(oe),J(re,m),m&&p(be),m&&p(K),m&&p(se),m&&p(ue),Me=!1,we()}}}let He=8,Xt="oldest",De=.25,Ve=1e3;function Gt(l,o,r){let{observations:a}=o,{mapOptions:e}=o,{mapCenter:i}=o,{project:t}=o,{taxon:s}=o,n,c,_={},S=0,x=1,X=1,V=[],A=[],B=[];const G=dt();let u=!1,g=JSON.parse(JSON.stringify(Dt)),R,q=!1,le="markers",E,Y=[],j=[],ge=0,Q=0,ce=!1,ke=0,he=0,W=0,F=!1,ee=[],te=!1,oe=!1;function re(f){r(15,q=f.detail.useMarkerCluster),r(16,le=f.detail.userSelectedMarkerType),r(8,j=K(j))}function be(f){r(15,q=f.detail.useMarkerCluster),r(8,j=K(j))}function K(f){let v;if(Array.isArray(f))v=f.filter(Z=>Ze(Z,c,L));else if(q){let Z=[];f.forEach((me,Le)=>{me=me.filter(ve=>Ze(ve,c,L)),Z=Z.concat(me)}),v=Z}else v=new Map,f.forEach((Z,me)=>{Z=Z.filter(Le=>Ze(Le,c,L)),v.set(me,Z)});return v}function ne(f){r(12,x=vt(f)),r(13,X=St(f))}function Se(){r(23,F=!F)}function de(f){r(5,_=wt(f,_))}function Ce(){r(5,_={})}function se(f,v){G("markerClick",{observation_id:v.id,latlng:f.detail.latlng})}function ue(f){f.length>0&&c.fitBounds(f),G("doneLoading")}function N(f){kt("#observations-chart",f,{actions:!1}).then(v=>{}).catch(console.warn)}gt(()=>{r(34,u=!0),r(4,c=n.getMap()),r(11,S=c.getZoom()),r(20,ke=c.getMaxZoom()),ne(S),c.on("zoomend",function(){r(11,S=c.getZoom()),r(36,ce=!0),ne(S)}),c.on("moveend",function(){r(36,ce=!0)})});const Me=(f,v)=>se(v,f),we=(f,v)=>se(v,f),$=(f,v)=>se(v,f),M=(f,v)=>se(v,f);function je(f){Ye[f?"unshift":"push"](()=>{E=f,r(17,E)})}function m(f){Ye[f?"unshift":"push"](()=>{R=f,r(14,R)})}function h(f){Ye[f?"unshift":"push"](()=>{n=f,r(3,n)})}function ae(){oe=this.checked,r(10,oe)}return l.$$set=f=>{"observations"in f&&r(0,a=f.observations),"mapOptions"in f&&r(1,e=f.mapOptions),"mapCenter"in f&&r(31,i=f.mapCenter),"project"in f&&r(2,t=f.project),"taxon"in f&&r(32,s=f.taxon)},l.$$.update=()=>{if(l.$$.dirty[0]&1&&(r(0,a=a.filter(f=>f.latitude&&f.longitude)),r(6,V=a.map(f=>[f.latitude,f.longitude])),r(5,_={})),l.$$.dirty[0]&163|l.$$.dirty[1]&4&&(r(33,B=Lt(a,Xt,e.observationsTimeSpan)),r(7,A=Ot(B,e.observationsTimeSpan)),e.observationsTimeSpan!=="all"&&Object.keys(_).length===0&&A.forEach((f,v)=>r(5,_[v]=!0,_))),l.$$.dirty[0]&72&&n&&ue(V),l.$$.dirty[0]&936|l.$$.dirty[1]&50&&n&&(r(35,Y=Tt(A,_)),r(19,Q=Ge(Y)),r(8,j=K(Y)),r(18,ge=Ge(j)),r(21,he=Et(Y)),r(9,ee=yt(j)),r(22,W=ee.length),r(24,te=ee.length>1||ee.length==1&&ee[0].taxon_id!==s.taxon_id),r(36,ce=!1)),l.$$.dirty[0]&1190|l.$$.dirty[1]&8&&u&&!oe){if(e.observationsTimeSpan==="month"){let f=Qe(g,De,_,e,A,t);N(f)}else if(e.observationsTimeSpan==="year"){let f=We(g,De,_,e,A,t);N(f)}else if(e.observationsTimeSpan==="all"){let f=xe(g,e,A);N(f)}}if(l.$$.dirty[0]&1318|l.$$.dirty[1]&8&&u&&oe){if(e.observationsTimeSpan==="month"){let f=Qe(g,De,_,e,j,t);N(f)}else if(e.observationsTimeSpan==="year"){let f=We(g,De,_,e,j,t);N(f)}else if(e.observationsTimeSpan==="all"){let f=xe(g,e,j);N(f)}}l.$$.dirty[0]&24|l.$$.dirty[1]&1&&n&&i&&i.longitude&&(document.getElementById("taxa-map").scrollIntoView(),c.flyTo([i.latitude,i.longitude],c.getMaxZoom()-1),r(31,i={}))},[a,e,t,n,c,_,V,A,j,ee,oe,S,x,X,R,q,le,E,ge,Q,ke,he,W,F,te,re,be,Se,de,Ce,se,i,s,B,u,Y,ce,Me,we,$,M,je,m,h,ae]}class sl extends pt{constructor(o){super();_t(this,o,Gt,Kt,ht,{observations:0,mapOptions:1,mapCenter:31,project:2,taxon:32},null,[-1,-1,-1])}}export{sl as default};
