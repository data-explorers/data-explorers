var h=Object.defineProperty,b=Object.defineProperties;var g=Object.getOwnPropertyDescriptors;var c=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var m=(t,e,n)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,o=(t,e)=>{for(var n in e||(e={}))v.call(e,n)&&m(t,n,e[n]);if(c)for(var n of c(e))w.call(e,n)&&m(t,n,e[n]);return t},_=(t,e)=>b(t,g(e));import{f as l}from"./formatUtils-b852786f.js";import{s as f}from"./constants-3d7024b8.js";function d(t,e){let n=new Map;return t.forEach(r=>{n.get(r[e])?n.get(r[e]).push(r):n.set(r[e],[r])}),n}function A(t,e){return(t%e+e)%e}function F(t,e){return e?Array.from({length:e-t+1},(n,r)=>t+r):Array.from({length:t+1},(n,r)=>r)}function N(t,e){function n(i){var u=parseInt(i,16);return u=parseInt(u*(100+e)/100),u=u<255?u:255,u.toString(16).length==1?"0"+u.toString(16):u.toString(16)}t=t.replace("#","");var r=n(t.substring(0,2)),a=n(t.substring(2,4)),s=n(t.substring(4,6));return r+a+s}const T=(t,e)=>new Promise((n,r)=>{e=e.toLowerCase();let a=[],s=[];t.forEach(i=>{i.common_name&&new RegExp("\\b"+e).test(i.common_name.toLowerCase())&&!s.includes(i.taxon_id)&&(a.push({taxon_id:Number(i.taxon_id),common_name:i.common_name,scientific_name:i.scientific_name,taxa_count:i.taxa_count,image_url:i.image_url,rank:i.rank}),s.push(i.taxon_id))}),t.forEach(i=>{i.scientific_name&&new RegExp("\\b"+e).test(i.scientific_name.toLowerCase())&&!s.includes(i.taxon_id)&&(a.push({taxon_id:Number(i.taxon_id),common_name:i.common_name,scientific_name:i.scientific_name,taxa_count:i.taxa_count,image_url:i.image_url}),s.push(i.taxon_id))}),a.sort((i,u)=>u.observations_count-i.observations_count||u.taxa_count-i.taxa_count),a=a.map(i=>_(o({},i),{label:l(i)})),n(a)}),q=(t,e,n)=>t.filter(a=>a.taxon_ids).filter(a=>a.taxon_ids.split("|").includes(""+e)).map(a=>{let s=a.time_observed_at&&new Date(a.time_observed_at),i=a.time_observed_at?s.getMonth():"unknown",u=a.time_observed_at?s.getFullYear():"unknown";return _(o({},a),{month:i,year:u,color:n,fillColor:n})});function p(t,e){return new Date(e.time_observed_at)-new Date(t.time_observed_at)}function O(t,e){return new Date(t.time_observed_at)-new Date(e.time_observed_at)}function D(t,e){return new Date(e.time_observed_at).getMonth()-new Date(t.time_observed_at).getMonth()||new Date(e.time_observed_at)-new Date(t.time_observed_at)}function k(t,e){return new Date(t.time_observed_at).getMonth()-new Date(e.time_observed_at).getMonth()||new Date(t.time_observed_at)-new Date(e.time_observed_at)}function C(t,e,n){let r,a=[],s=[];return t.forEach(i=>{i.time_observed_at?a.push(i):s.push(i)}),e==="oldest"?n==="month"?r=a.sort(k):r=a.sort(O):n==="month"?r=a.sort(D):r=a.sort(p),s.length>0&&(r=r.concat(s)),r}function I(t,e){let n=new Map,r=[],a=[];if(t.forEach(s=>{s.time_observed_at?r.push(s):a.push(s)}),e==="month")n=d(r.map(s=>_(o({},s),{month:new Date(s.time_observed_at).getMonth()})),"month");else if(e==="year")n=d(r.map(s=>_(o({},s),{year:new Date(s.time_observed_at).getFullYear()})),"year");else return t;return a.length>0&&n.set("unknown",a),n}function j(t){if(Array.isArray(t))return new Set(t.map(e=>e.id)).size;{let e=new Set;return t.forEach((n,r)=>{n.forEach(a=>e.add(a.id))}),e.size}}function R(t,e=!1){if(Array.isArray(t)){let n={};return e&&(t=t.filter(r=>f.includes(r.rank))),t.forEach(r=>{n[r.taxon_id]={taxon_id:r.taxon_id,name:l(r,!0,!1,!0),rank:r.rank}}),Object.values(n)}else{let n={};return t.forEach((r,a)=>{e&&(r=r.filter(s=>f.includes(s.rank))),r.forEach(s=>{n[s.taxon_id]={taxon_id:s.taxon_id,name:l(s,!0,!1,!0),rank:s.rank}})}),Object.values(n)}}function S(t,e=!1){return E(t,e).length}function E(t,e=!1){if(Array.isArray(t)){let n=new Set;return e&&(t=t.filter(r=>f.includes(r.rank))),t.forEach(r=>{n.add(r.user_login)}),[...n]}else{let n=new Set;return t.forEach((r,a)=>{e&&(r=r.filter(s=>f.includes(s.rank))),r.forEach(s=>{n.add(s.user_login)})}),[...n]}}function B(t,e){let n;return Object.keys(e).length===0?n=[...t]:(n=new Map,t.forEach((r,a)=>{e[a]&&n.set(a,r)})),n}function L(t,e){return t.filter(n=>f.includes(n.rank)).filter(n=>n.observations_count>0).filter(n=>n.taxon_ids.split("|").includes(""+e.taxon_id))}function z(t,e){let n=t.target.dataset.filter;return n=n==="unknown"?"unknown":Number(n),e[n]=!e[n],e}export{q as a,I as b,B as c,j as d,R as e,T as f,L as g,S as h,E as i,N as l,A as m,F as r,C as s,z as u};
